// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0040101F: void fn0040101F(Register byte al, Register byte ah, Register word32 ecx, Register word16 dx, Register byte bh, Register byte bl, Register word32 ebp, Register word32 esi, Register word32 edi, Stack word32 dwArg00, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C, Stack word32 dwArg14, Stack word32 dwArg18, Stack word32 dwArg1C, Stack word32 dwArg20)
void fn0040101F(byte al, byte ah, word32 ecx, word16 dx, byte bh, byte bl, word32 ebp, word32 esi, word32 edi, word32 dwArg00, word32 dwArg04, word32 dwArg08, word32 dwArg0C, word32 dwArg14, word32 dwArg18, word32 dwArg1C, word32 dwArg20)
{
	word32 edi_23;
	byte v15_26 = Mem0[fn0040106A(al, ah, ecx, bl | ch, ebp, esi + ecx, edi, esi, out edi_23) + 0x00:byte];
	Mem27[edi_23 + 0x00:byte] = v15_26;
	Mem51[dwArg04 + 0x00:word32] = __in(dwArg18);
}

// 00401038: Register byte fn00401038(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi, Stack word32 dwArg00, Register out ptr32 ahOut, Register out ptr32 chOut, Register out ptr32 clOut, Register out ptr32 bhOut, Register out ptr32 blOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
byte fn00401038(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, word32 dwArg00, ptr32 & ahOut, ptr32 & chOut, ptr32 & clOut, ptr32 & bhOut, ptr32 & blOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	word32 edi_10 = edi + 0x01 + (ebx - 0x01);
	word32 ebp_15 = Mem0[ebp + 0x00:word32];
	*ebpOut = ebp_15;
	word32 edx_18 = edx | edi_10 + 0x01;
	byte ah_25;
	byte ch_26;
	byte cl_27;
	byte bh_28;
	byte bl_29;
	word32 esi_30;
	word32 edi_31;
	return fn0040110E(eax, ecx, edx_18, ebx - 0x01, ebp_15, esi, edi_10, out ah_25, out ch_26, out cl_27, out bh_28, out bl_29, out esi_30, out edi_31);
}

// 00401051: FlagGroup byte fn00401051(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi, Stack word32 dwArg00, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
byte fn00401051(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, word32 dwArg00, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	word32 edx_18 = edx + 0x01 | esi;
	byte ah_25;
	byte ch_26;
	byte cl_27;
	byte bh_28;
	byte bl_29;
	word32 ebp_30;
	word32 esi_31;
	word32 edi_32;
	byte al_33 = fn00401038(eax, ecx, edx_18, ebx, ebp, esi, edx_18, eax, out ah_25, out ch_26, out cl_27, out bh_28, out bl_29, out ebp_30, out esi_31, out edi_32);
	word32 ecx_38 = DPB(ecx, ch_26 & bh_28, 8);
	word32 ecx_45;
	word32 edx_46;
	word32 ebx_47;
	word32 ebp_48;
	word32 esi_49;
	word32 edi_50;
	return fn0040106D(al_33, ah_25, ecx_38, bl_29, ebp_30 - 0x01, esi_31, edi_32, eax, out ecx_45, out edx_46, out ebx_47, out ebp_48, out esi_49, out edi_50);
}

// 0040106A: Register word32 fn0040106A(Register byte al, Register byte ah, Register word32 ecx, Register byte bl, Register word32 ebp, Register word32 esi, Register word32 edi, Stack word32 dwArg00, Register out ptr32 ediOut)
word32 fn0040106A(byte al, byte ah, word32 ecx, byte bl, word32 ebp, word32 esi, word32 edi, word32 dwArg00, ptr32 & ediOut)
{
fn0040106A_entry:
	def fp
	def dwArg00
	def edx
	def al
	def ah
	def ecx
	def bl
	def ebp
	def esi
	def edi
	def ediOut
	esp_1 = fp
	v3_3 = dwArg00
	dwArg00_5 = edx
	edx_6 = v3_3
	C_20 = fn0040106D(al, ah, ecx, bl, ebp, esi, edi, dwArg00_5, out ecx_14, out edx_15, out ebx_16, out ebp_17, out esi_18, out edi_19)
	return esi_18
l0040106A:
l0040106A_thunk_fn0040106D:
l00401081_thunk_fn004010F1:
	C = fn004010F1(eax, ecx, edx, ebx, ebp, esi, edi, out ecx, out edx, out ebx, out ebp, out esi, out edi)
	return esi
fn0040106A_exit:
	ecx_21 = PHI(ecx_14, ecx)
	edx_22 = PHI(edx_15, edx)
	ebx_23 = PHI(ebx_16, ebx)
	ebp_24 = PHI(ebp_17, ebp)
	esi_25 = PHI(esi_18, esi)
	edi_26 = PHI(edi_19, edi)
	C_27 = PHI(C_20, C)
	use edi_26 (=> ediOut)
}

// 0040106D: FlagGroup byte fn0040106D(Register byte al, Register byte ah, Register word32 ecx, Register byte bl, Register word32 ebp, Register word32 esi, Register word32 edi, Stack word32 dwArg00, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
byte fn0040106D(byte al, byte ah, word32 ecx, byte bl, word32 ebp, word32 esi, word32 edi, word32 dwArg00, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
fn0040106D_entry:
	esp = fp
	esp = fp - 0x02
	wLoc02 = bx
	bx = wLoc02
	ebx = DPB(ebx, bx, 0) (alias)
	esp = fp
	v4 = ah
	ah = v4
	eax = DPB(eax, ah, 8) (alias)
	edx = dwArg00
	dh = SLICE(edx, byte, 8) (alias)
	dl = (byte) edx (alias)
	esp = fp + 0x04
	ebx = ebx + 0x01
	bl = (byte) ebx (alias)
	dh = -dh
	bh = dl
	bh = bh | dl
	bx = DPB(bx, bh, 8) (alias)
	ebx = DPB(ebx, bh, 8) (alias)
	dl = bh
	dh = al
	edx = DPB(edx, dh, 8) (alias)
	edx = edx ^ edi
	dh = SLICE(edx, byte, 8) (alias)
	dl = (byte) edx (alias)
	SZO = cond(edx)
	C = false
l0040106D:
l0040106D:
	esp = esp - 0x02
	Mem0[esp + 0x00:word16] = bx
	bx = Mem0[esp + 0x00:word16]
	ebx = DPB(ebx, bx, 0) (alias)
	esp = esp + 0x02
	v16 = ah
	ah = v16
	edx = Mem0[esp + 0x00:word32]
	dh = SLICE(edx, byte, 8) (alias)
	dl = (byte) edx (alias)
	esp = esp + 0x04
	ebx = ebx + 0x01
	dh = -dh
	bh = dl
	bh = bh | dl
	dl = bh
	dh = al
	edx = DPB(edx, dh, 8) (alias)
	edx = edx ^ edi
	SZO = cond(edx)
	C = false
l00401081_thunk_fn004010F1:
	C = fn004010F1(eax, ecx, edx, ebx, ebp, esi, edi, out ecx, out edx, out ebx, out ebp, out esi, out edi)
	SCZO = C (alias)
	return C
fn0040106D_exit:
	use ecx (=> ecxOut)
	use edx (=> edxOut)
	use ebx (=> ebxOut)
	use ebp (=> ebpOut)
	use esi (=> esiOut)
	use edi (=> ediOut)
}

// 004010B7: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	if (!P)
	{
		if (!P)
			;
	}
}

// 004010F1: FlagGroup byte fn004010F1(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
byte fn004010F1(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	word32 ebx_10 = DPB(ebx, bh ^ bl, 8);
	word32 esi_13 = esi ^ ebx ^ ebx_10;
	word32 ecx_26;
	word32 edx_27;
	word32 ebx_28;
	word32 ebp_29;
	word32 esi_30;
	word32 edi_31;
	byte C_32 = fn00401051(eax, ecx, esi_13, ebx_10 | eax, ebp, esi_13, edi, dwLoc04, out ecx_26, out edx_27, out ebx_28, out ebp_29, out esi_30, out edi_31);
	word32 ecx_34 = ecx_26 + Mem0[esi_30 + 0x00:word32] + C_32;
	Mem36[eax + 0x00:word32] = Mem0[eax + 0x00:word32] - eax;
	word32 eax_39 = DPB(eax, Mem36[0x40CE334E:byte], 0);
	byte al_40;
	byte ah_41;
	word32 ecx_42;
	word32 edx_43;
	word32 ebx_44;
	word32 esi_45;
	word32 edi_46;
	return fn00401112(eax_39, ecx_34, edx_27, ebx_28, ebp_29, esi_30, edi_31, out al_40, out ah_41, out ecx_42, out edx_43, out ebx_44, out esi_45, out edi_46);
}

// 0040110E: Register byte fn0040110E(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi, Register out ptr32 ahOut, Register out ptr32 chOut, Register out ptr32 clOut, Register out ptr32 bhOut, Register out ptr32 blOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
byte fn0040110E(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, ptr32 & ahOut, ptr32 & chOut, ptr32 & clOut, ptr32 & bhOut, ptr32 & blOut, ptr32 & esiOut, ptr32 & ediOut)
{
	*bhOut = bh;
	*blOut = bl;
	word32 ecx_5 = ecx ^ esi - 0x01;
	byte ch_6;
	*chOut = SLICE(ecx_5, byte, 8);
	byte cl_7;
	*clOut = (byte) ecx_5;
	byte al_18;
	byte ah_19;
	word32 ecx_20;
	word32 edx_21;
	word32 ebx_22;
	word32 esi_23;
	word32 edi_24;
	fn00401112(eax + 0x01, ecx_5, edx, ebx, ebp, esi - 0x01, edi, out al_18, out ah_19, out ecx_20, out edx_21, out ebx_22, out esi_23, out edi_24);
	return al_18;
}

// 00401112: FlagGroup byte fn00401112(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi, Register out ptr32 alOut, Register out ptr32 ahOut, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
byte fn00401112(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, ptr32 & alOut, ptr32 & ahOut, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
fn00401112_entry:
	def fp
	def esi
	def edx
	def ebx
	def eax
	def edi
	def ecx
	def ebp
	def rArg0
	def alOut
	def ahOut
	def ecxOut
	def edxOut
	def ebxOut
	def esiOut
	def ediOut
	esp_1 = fp
	esi_3 = esi + 0x01
	edx_6 = edx | ebx
	edx_7 = edx_6 | ebx
	ebx_9 = ebx | eax
	ebx_10 = ebx_9 + 0x01
	edx_12 = edx_7 - edi
	SCZO_13 = cond(edx_12)
	C_24 = fn00401168(eax, ecx, edx_12, ebx_10, ebp, esi_3, rArg0, out al_17, out ah_18, out ecx_19, out ebx_20, out esi_21, out edi_22, out rArg0_23)
	SCZO_25 = C_24 (alias)
	return C_24
l00401112:
l00401112:
	esi = esi + 0x01
	edx = edx | ebx
	edx = edx | ebx
	ebx = ebx | eax
	ebx = ebx + 0x01
	edx = edx - edi
	SCZO = cond(edx)
	C = fn00401168(eax, ecx, edx, ebx, ebp, esi, rArg0, out al, out ah, out ecx, out ebx, out esi, out edi, out rArg0)
	SCZO = C (alias)
	return C
l0040111C_thunk_fn00401168:
l0040111C_thunk_fn00401168:
fn00401112_exit:
	al_26 = PHI(al_17, al)
	ah_27 = PHI(ah_18, ah)
	ecx_28 = PHI(ecx_19, ecx)
	ebx_29 = PHI(ebx_20, ebx)
	esi_30 = PHI(esi_21, esi)
	edi_31 = PHI(edi_22, edi)
	rArg0_32 = PHI(rArg0_23, rArg0)
	C_33 = PHI(C_24, C)
	SCZO_34 = PHI(SCZO_25, SCZO)
	use al_26 (=> alOut)
	use ah_27 (=> ahOut)
	use ecx_28 (=> ecxOut)
	use edx_12 (=> edxOut)
	use ebx_29 (=> ebxOut)
	use esi_30 (=> esiOut)
	use edi_31 (=> ediOut)
}

// 00401168: FlagGroup byte fn00401168(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 ebp, Register word32 esi, FpuStack real64 rArg0, Register out ptr32 alOut, Register out ptr32 ahOut, Register out ptr32 ecxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut, FpuStack out ptr32 rArg0Out)
byte fn00401168(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, real64 rArg0, ptr32 & alOut, ptr32 & ahOut, ptr32 & ecxOut, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut, ptr32 & rArg0Out)
{
	word32 ebx_7 = ebx | eax;
	*ebxOut = ebx_7;
	word32 eax_8 = eax - ecx + ebx_7;
	word32 esi_10 = esi ^ eax_8;
	word32 ecx_14 = ecx - ebx_7;
	byte al_20 = (byte) eax_8;
	*alOut = al_20;
	word16 ax_21 = (word16) eax_8;
	byte ah_22;
	*ahOut = SLICE(eax_8, byte, 8);
	if (eax_8 != 0x00)
	{
		if (eax_8 == 0x00)
		{
			word32 esi_73;
			*esiOut = esi_10 + 0x01;
			if (Mem0[esi_10 + 0x00:byte] <u Mem0[ebx_7 + 0x00:byte])
			{
				Mem81[ebx_7 + 0x01:byte] = __in(edx);
				if (Mem0[esi_10 + 0x00:byte] != Mem0[ebx_7 + 0x00:byte] && ecx_14 != 0x01)
				{
					word32 ecx_113;
					*ecxOut = ecx_14 - 0x02;
					if (ecx_14 != 0x02)
					{
						word32 edi_119;
						*ediOut = ebx_7 + 0x03;
						if (al_20 == Mem81[ebx_7 + 0x02:byte])
							return es;
					}
				}
				else
				{
					Mem90[0xE6E28020:byte] = Mem81[0xE6E28020:byte] << 242;
					word32 eax_94 = eax_8 & Mem90[edx + 0x00:word32];
					byte al_95 = (byte) eax_94;
					if (eax_94 > 0x00)
						(eax_94 + 0x20)[(ebp + 0x02) * 0x02] = (eax_94 + 0x20)[(ebp + 0x02) * 0x02] + al_95;
					else
						__hlt();
				}
			}
			Mem77[ebp + 3907592925:byte] = 0x44;
l00401188:
			Mem41[eax_8 + 0x00:byte] = Mem0[eax_8 + 0x00:byte] + al_20;
			__aad(ax_21);
		}
	}
	goto l00401188;
}

