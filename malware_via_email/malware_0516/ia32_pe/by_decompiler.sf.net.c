// subject.c
// Generated on 5/4/2015 1:15:08 AM by decompiling malware_via_email/malware_0516/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401004(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, word32 dwArg00)
{
	word32 edx_18 = DPB(edx + 0x00000001, SLICE(edx + 0x00000001, byte, 8) - cl, 8, 8);
	word32 ebx_19 = ebx | edx_18;
	word32 ebx_23 = DPB(ebx_19, SLICE(ebx_19, byte, 8) + (byte) ebx_19, 8, 8);
	fn0040109E(eax, ecx, edx_18, ebx_23, ebp, esi, edi, eax);
	Mem38[edi + 0x00000000:byte] = Mem0[esi + 0x00000000:byte];
	byte dl_15 = (byte) (edx + 0x00000001);
	fn0040101F(eax, ecx, ebx_23, ebp, esi + 0x00000001, edi + 0x00000001, dl_15 * 0x02, fp, dwArg04, dwArg08, dwArg0C, dwArg14, dwArg18, dwArg1C, dwArg20);
	return;
}

void fn0040101F(word32 eax, word32 ecx, word32 ebx, word32 ebp, word32 esi, word32 edi, byte dl, word32 dwArg00, word32 dwArg04, word32 dwArg08, word32 dwArg0C, word32 dwArg14, word32 dwArg18, word32 dwArg1C, word32 dwArg20)
{
	word32 edi_25;
	byte v15_28 = Mem0[fn0040106A(eax, ecx, DPB(ebx, bl | ch, 0, 8), ebp, esi + ecx, edi, esi, out edi_25):byte];
	Mem29[edi_25 + 0x00000000:byte] = v15_28;
	Mem53[dwArg04 + 0x00000000:word32] = __in(dwArg18);
}

word32 fn00401038(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, word32 dwArg00, ptr32 ecxOut, ptr32 ebxOut, ptr32 ebpOut, ptr32 esiOut, ptr32 ediOut)
{
	word32 edi_8 = edi + 0x00000001 + (ebx - 0x00000001);
	word32 ebp_13 = Mem0[ebp + 0x00000000:word32];
	*ebpOut = ebp_13;
	word32 edx_16 = edx | edi_8 + 0x00000001;
	word32 ecx_23;
	word32 ebx_24;
	word32 esi_25;
	word32 edi_26;
	return fn0040110E(eax, ecx, edx_16, ebx - 0x00000001, ebp_13, esi, edi_8, out ecx_23, out ebx_24, out esi_25, out edi_26);
}

byte fn00401051(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, word32 dwArg00, ptr32 ecxOut, ptr32 edxOut, ptr32 ebxOut, ptr32 ebpOut, ptr32 esiOut, ptr32 ediOut)
{
fn00401051_entry:
l00401051:
	branch SZO l00401056
l00401056:
	branch Z l00401058
l00401058:
	word32 edx_17 = edx + 0x00000001 | esi
	word32 ecx_24
	word32 ebx_25
	word32 ebp_26
	word32 esi_27
	word32 edi_28
	word32 eax_29 = fn00401038(eax, ecx, edx_17, ebx, ebp, esi, edx_17, eax, out ecx_24, out ebx_25, out ebp_26, out esi_27, out edi_28)
	word32 ecx_35 = DPB(ecx_24, ch & bh, 8, 8)
l00401069_thunk_fn0040106D:
	word32 ecx_42
	word32 edx_43
	word32 ebx_44
	word32 ebp_45
	word32 esi_46
	word32 edi_47
	return fn0040106D(eax_29, ecx_35, ebx_25, ebp_26 - 0x00000001, esi_27, edi_28, eax, out ecx_42, out edx_43, out ebx_44, out ebp_45, out esi_46, out edi_47)
fn00401051_exit:
}

word32 fn0040106A(word32 eax, word32 ecx, word32 ebx, word32 ebp, word32 esi, word32 edi, word32 dwArg00, ptr32 ediOut)
{
	esp = fp;
	v3 = dwArg00;
	dwArg00 = edx;
	edx = v3;
	C = fn0040106D(eax, ecx, ebx, ebp, esi, edi, dwArg00, out ecx, out edx, out ebx, out ebp, out esi, out edi);
	return esi;
}

byte fn0040106D(word32 eax, word32 ecx, word32 ebx, word32 ebp, word32 esi, word32 edi, word32 dwArg00, ptr32 ecxOut, ptr32 edxOut, ptr32 ebxOut, ptr32 ebpOut, ptr32 esiOut, ptr32 ediOut)
{
fn0040106D_entry:
l0040106D:
	esp = fp
	esp = fp - 0x00000002
	wLoc02 = bx
	bx = wLoc02
	ebx = DPB(ebx, bx, 0, 16) (alias)
	esp = fp
	v4 = ah
	ah = v4
	eax = DPB(eax, ah, 8, 8) (alias)
	edx = dwArg00
	dh = SLICE(edx, byte, 8) (alias)
	dl = (byte) edx (alias)
	esp = fp + 0x00000004
	ebx = ebx + 0x00000001
	dh = -dh
	bh = dl
	bh = bh | dl
	bx = DPB(bx, bh, 8, 8) (alias)
	ebx = DPB(ebx, bh, 8, 8) (alias)
	dl = bh
	dh = al
	edx = DPB(edx, dh, 8, 8) (alias)
	edx = edx ^ edi
	dh = SLICE(edx, byte, 8) (alias)
	dl = (byte) edx (alias)
	SZO = cond(edx)
	C = false
l0040106D:
	esp = esp - 0x00000002
	Mem0[esp + 0x00000000:word16] = bx
	bx = Mem0[esp + 0x00000000:word16]
	ebx = DPB(ebx, bx, 0, 16) (alias)
	esp = esp + 0x00000002
	v16 = ah
	ah = v16
	edx = Mem0[esp + 0x00000000:word32]
	dh = SLICE(edx, byte, 8) (alias)
	dl = (byte) edx (alias)
	esp = esp + 0x00000004
	ebx = ebx + 0x00000001
	dh = -dh
	bh = dl
	bh = bh | dl
	dl = bh
	dh = al
	edx = DPB(edx, dh, 8, 8) (alias)
	edx = edx ^ edi
	SZO = cond(edx)
	C = false
l00401081_thunk_fn004010F1:
	C = fn004010F1(eax, ecx, edx, ebx, ebp, esi, edi, out ecx, out edx, out ebx, out ebp, out esi, out edi)
	SCZO = C (alias)
	return C
fn0040106D_exit:
	use ecx (=> ecxOut)
	use edx (=> edxOut)
	use ebx (=> ebxOut)
	use ebp (=> ebpOut)
	use esi (=> esiOut)
	use edi (=> ediOut)
}

void fn00401087(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 edi)
{
fn00401087_entry:
l00401087:
	word32 ebx_11 = (ebx + ecx | edi) + edi
l00401124:
	byte dh_26 = dh + SLICE(ebx_11, byte, 8)
	word32 esi_17 = 0xFFFFFFFF - ecx | ecx
	fn00401004(eax, ecx, DPB(edx, dh_26, 8, 8), ebx_11, ebp, esi_17, edx, dwArg00)
	branch dh_26 == 0x00 && ecx != 0x00000001 l004011B7
l00401139:
	Mem35[ebp + 0x2BCB2EC8:word32] = Mem0[ebp + 0x2BCB2EC8:word32] >>u 0xFFFFFFDE
l00401139_thunk_fn00401140:
	fn00401140(eax, ebx_11, esi_17, edx, bp)
	return
l004011B7:
fn00401087_exit:
}

void fn0040109E(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, word32 dwArg00)
{
	word32 edx_14 = DPB(edx, dh - dl, 8, 8) + esi;
	word32 ebx_16 = ebx + eax | esi;
	word32 edx_19 = DPB(edx_14, SLICE(edx_14, byte, 8) | SLICE(ebx_16, byte, 8), 8, 8);
	fn004010D8(eax, ecx, edx_19, ebx_16, ebp, esi, edi);
	Mem25[0x34A91918:word32] = eax;
	word32 edx_26 = edx_19 | Mem25[ebp - 0x00000075:word32];
	fn004010B9(eax, ecx, edx_26, ebx_16, ebp, esi, edi);
	return;
}

void fn004010B7(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 esi, word32 edi)
{
	fn004010B9(eax, ecx, edx, ebx, fp - 0x00000004, esi, edi);
	return;
}

void fn004010B9(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi)
{
	esp = fp;
	al = __inb(dx);
	eax = DPB(eax, al, 0, 8);
	ebx = ebx - esi;
	ebx = ebx | edi;
	edx = edx ^ eax;
	dx = (word16) edx;
	esi = esi | ebx;
	esi = esi + 0x00000001;
	edi = ebx;
	ebx = ebx - edi;
	SCZO = cond(ebx);
	SZO = SCZO;
	C = SCZO;
	if (Test(PO,P))
		fn004010CD(eax, ecx, edx, ebx, ebp, esi, edi);
}

void fn004010CD(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi)
{
fn004010CD_entry:
l004010CD:
	word32 ebx_3 = DPB(ebx, bx, 0, 16)
	branch Z l004010D2
l004010D2:
	branch P l0040114E
	goto l004010D4
l004010D2_thunk_fn0040114E:
	fn0040114E(eax, ecx, edx, ebx_3, ebp, esi, edi)
	return
l004010D4:
	fn0040101F(eax, DPB(ecx, 0x26, 8, 8), DPB(ebx_3, ah, 8, 8), ebp, esi, (edi | ebx_3) + edx ^ edx, dl, dwArg00, dwArg04, dwArg08, dwArg0C, dwArg14, dwArg18, dwArg1C, dwArg20)
fn004010CD_exit:
}

void fn004010D8(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi)
{
	fn0040101F(eax, ecx, DPB(ebx, ah, 8, 8), ebp, esi, (edi | ebx) + edx ^ edx, dl, dwArg00, dwArg04, dwArg08, dwArg0C, dwArg14, dwArg18, dwArg1C, dwArg20);
}

byte fn004010F1(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, ptr32 ecxOut, ptr32 edxOut, ptr32 ebxOut, ptr32 ebpOut, ptr32 esiOut, ptr32 ediOut)
{
	word32 ebx_10 = DPB(ebx, bh ^ bl, 8, 8);
	word32 esi_13 = esi ^ ebx ^ ebx_10;
	word32 ecx_26;
	word32 edx_27;
	word32 ebx_28;
	word32 ebp_29;
	word32 esi_30;
	word32 edi_31;
	byte C_32 = fn00401051(eax, ecx, esi_13, ebx_10 | eax, ebp, esi_13, edi, dwLoc04, out ecx_26, out edx_27, out ebx_28, out ebp_29, out esi_30, out edi_31);
	word32 ecx_34 = ecx_26 + Mem0[esi_30 + 0x00000000:word32] + C_32;
	Mem37[eax + 0x00000000:word32] = Mem0[eax + 0x00000000:word32] - eax;
	word32 eax_40 = DPB(eax, Mem37[0x40CE334E:byte], 0, 8);
	word32 eax_41;
	word32 ecx_42;
	word32 edx_43;
	word32 ebx_44;
	word32 esi_45;
	word32 edi_46;
	return fn00401112(eax_40, ecx_34, edx_27, ebx_28, ebp_29, esi_30, edi_31, out eax_41, out ecx_42, out edx_43, out ebx_44, out esi_45, out edi_46);
}

word32 fn0040110E(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, ptr32 ecxOut, ptr32 ebxOut, ptr32 esiOut, ptr32 ediOut)
{
	word32 ecx_5 = ecx ^ esi - 0x00000001;
	word32 eax_14;
	word32 ecx_15;
	word32 edx_16;
	word32 ebx_17;
	word32 esi_18;
	word32 edi_19;
	fn00401112(eax + 0x00000001, ecx_5, edx, ebx, ebp, esi - 0x00000001, edi, out eax_14, out ecx_15, out edx_16, out ebx_17, out esi_18, out edi_19);
	return eax_14;
}

byte fn00401112(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, ptr32 eaxOut, ptr32 ecxOut, ptr32 edxOut, ptr32 ebxOut, ptr32 esiOut, ptr32 ediOut)
{
	esp = fp;
	esi = esi + 0x00000001;
	edx = edx | ebx;
	edx = edx | ebx;
	ebx = ebx | eax;
	ebx = ebx + 0x00000001;
	edx = edx - edi;
	SCZO = cond(edx);
	C = fn00401168(eax, ecx, edx, ebx, ebp, esi, rArg0, out eax, out ecx, out ebx, out esi, out edi, out rArg0);
	SCZO = C;
	return C;
}

void fn00401140(word32 eax, word32 ebx, word32 esi, word32 edi, word16 bp)
{
	esp = fp;
	ebx = ebx ^ esi;
	esi = eax;
	esi = esi | edi;
	esi = edi;
	ecx = ebx;
	ebx = ebx ^ ecx;
	SZO = cond(ebx);
	C = false;
	rArg0 = fn00401188(eax, bp, di, rArg0);
	return;
}

void fn0040114E(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi)
{
fn0040114E_entry:
l0040114E:
	fn00401087(eax, ecx, (edx + 0x00000001 ^ eax) + 0x00000001, ebx - 0x00000001, ebp, (edi ^ ebx) + (ebx - 0x00000001) ^ ecx)
	branch CZ TMP!
fn0040114E_exit:
}

byte fn00401168(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, real64 rArg0, ptr32 eaxOut, ptr32 ecxOut, ptr32 ebxOut, ptr32 esiOut, ptr32 ediOut, ptr32 rArg0Out)
{
fn00401168_entry:
	goto l00401168
l0040113E:
	word32 ebx_47 = ebx_7 - esi_10
	*ebxOut = ebx_47
	byte SCZO_48 = cond(ebx_47)
l0040113E_thunk_fn00401140:
	fn00401140(eax_8, ebx_47, esi_10, ebx_7, bp)
	return SCZO_48
l00401168:
	word32 ebx_7 = ebx | eax
	*ebxOut = ebx_7
	word32 eax_8 = eax - ecx + ebx_7
	word32 esi_10 = esi ^ eax_8
	*esiOut = esi_10
	word32 edi_11
	*ediOut = ebx_7
	word32 ecx_14 = ecx - ebx_7
	*ecxOut = ecx_14
	word32 eax_19
	*eaxOut = eax_8
	byte al_20 = (byte) eax_8
	branch eax_8 == 0x00000000 l0040113E
	goto l0040117A
l00401168:
l0040117A:
	branch !OVERFLOW(eax_8) l0040117C
l0040117C:
	word32 ecx_57 = ecx_14
	*ecxOut = ecx_57
	branch eax_8 != 0x00000000 l0040113E
l00401180:
	byte SCZO_60 = cond(Mem0[esi_10 + 0x00000000:byte] - Mem0[ebx_7 + 0x00000000:byte])
	word32 esi_65
	*esiOut = esi_10 + 0x00000001
	word32 edi_66
	*ediOut = ebx_7 + 0x00000001
	word16 di_68 = (word16) (ebx_7 + 0x00000001)
	branch Mem0[esi_10 + 0x00000000:byte] <u Mem0[ebx_7 + 0x00000000:byte] l004011E9
l00401183:
	Mem69[ebp + 0xE8E922DD:byte] = 0x44
l00401183_thunk_fn00401188:
	fn00401188(eax_8, bp, di_68, rArg0)
	return SCZO_60
l004011AE:
	return es
l004011D3:
	word32 edi_112
	*ediOut = ebx_7 + 0x00000003
	branch al_20 == Mem76[ebx_7 + 0x00000002:byte] l004011AE
l004011D6:
l004011E9:
	Mem76[ebx_7 + 0x00000001:byte] = __in(edx)
	branch Mem0[esi_10 + 0x00000000:byte] != Mem0[ebx_7 + 0x00000000:byte] && ecx_14 != 0x00000001 l00401221
l004011ED:
	Mem85[0xE6E28020:byte] = Mem76[0xE6E28020:byte] << 0xF2
	word32 eax_89 = eax_8 & Mem85[edx + 0x00000000:word32]
	byte al_90 = (byte) eax_89
	branch eax_89 > 0x00000000 l0040124B
l004011FE:
	__hlt()
l00401221:
	word32 ecx_106
	*ecxOut = ecx_14 - 0x00000002
	branch ecx_14 != 0x00000002 l004011D3
l00401223:
l0040124B:
	(eax_89 + 0x00000020)[(ebp + 0x00000002) * 0x02] = (eax_89 + 0x00000020)[(ebp + 0x00000002) * 0x02] + al_90
fn00401168_exit:
}

real64 fn00401188(word32 eax, word16 bp, word16 di, real64 rArg0)
{
	Mem8[eax + 0x00000000:byte] = Mem0[eax + 0x00000000:byte] + al;
}

