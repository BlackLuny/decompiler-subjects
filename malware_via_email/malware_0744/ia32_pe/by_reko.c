// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 004011CB: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 ecx_9;
	word32 ebx_10;
	word32 esi_11;
	word32 edi_12;
	word32 eax_13 = fn004011D9(eax, ecx, dx, ebx, ebp, dwLoc04, dwArg00, out ecx_9, out ebx_10, out esi_11, out edi_12);
	Mem18[eax_13 + 0x00:byte] = Mem0[eax_13 + 0x00:byte] + (byte) eax_13;
	Mem28[ebx_10 + 0x00:byte] = Mem18[ebx_10 + 0x00:byte] + ch;
	int64 edx_eax_22 = (int64) eax_13;
	word32 eax_23 = (word32) edx_eax_22;
	word16 dx_25 = SLICE(edx_eax_22, word16, 32);
	word32 ecx_30;
	word32 ebx_31;
	word32 esi_32;
	word32 edi_33;
	return fn004011D9(eax_23, ecx_9, dx_25, ebx_10, ebp, dwLoc04, dwArg00, out ecx_30, out ebx_31, out esi_32, out edi_33);
}

// 004011D9: Register word32 fn004011D9(Register word32 eax, Register word32 ecx, Register word16 dx, Register word32 ebx, Register word32 ebp, Stack word32 dwArg00, Stack word32 dwArg04, Register out ptr32 ecxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn004011D9(word32 eax, word32 ecx, word16 dx, word32 ebx, word32 ebp, word32 dwArg00, word32 dwArg04, ptr32 & ecxOut, ptr32 & ebxOut, ptr32 & esiOut, ptr32 & ediOut)
{
fn004011D9_entry:
	def fp
	def dx
	def dwArg00
	def dwArg04
	def ecx
	def Mem0
	def edx
	def ebp
	def fs
	def ebx
	__ror((word16) dwArg00, 0x01)
	esp_7 = fp + 0x04
	eax_24 = (word32) Mem0[dwArg04 - ~0x06 + 0x00:byte] (alias)
	edx_29 = DPB(edx, dx | ~0x3B, 0) (alias)
	dl_30 = (byte) (dx | ~0x3B) (alias)
	branch eax_24 == 0x90 l0040122D
	goto l00401208
l004011D9:
l00401208:
	eax_209 = __ror(eax_24, 22)
	Mem213[(ecx | 0x9E1501B5) + eax_209:word32] = dwArg04
	__lock()
	al_210 = (byte) eax_209 (alias)
	Mem219[eax_209 + 0x00:byte] = Mem213[eax_209 + 0x00:byte] + al_210
	Mem221[eax_209 + 0x00:byte] = Mem219[eax_209 + 0x00:byte] + al_210
	Mem223[ebx + 0x00:byte] = Mem221[ebx + 0x00:byte] + dl_30
	v21_224 = Mem223[eax_209 + 0x00:byte] + al_210
	Mem225[eax_209 + 0x00:byte] = v21_224
	ax_211 = (word16) eax_209 (alias)
	esp_214 = fp + 0x08
	edi_216 = dwArg04 - ~0x06 >> 0x19 ^ ebx
	branch v21_224 > 0x00 l004012C0
	goto l004012D5
l0040122D:
	dx_258 = (word16) (fp + 0x04) (alias)
	ax_262 = dx_258
	ecx_266 = Mem0[DPB(1206072, dx_258, 0) + 0x00:word32]
	edi_271 = Mem0[0x004010C8:word32]
l00401253:
	edi_139 = PHI(edi_271, edi_153)
	ecx_141 = PHI(ecx_266, ecx_155)
	ax_144 = PHI(ax_262, ax_164)
	esp_145 = PHI(esp_7, esp_158)
	ecx_148 = ecx_141 - ~0x00
l00401258:
	edi_153 = PHI(edi_139, edi_216)
	ecx_155 = PHI(ecx_148, ecx_230)
	ax_157 = PHI(ax_144, ax_211)
	esp_158 = PHI(esp_145, esp_214)
	esi_162 = Mem0[ecx_155 + 0x00:word32]
	ax_164 = __rol(ax_157, 0x07)
	branch esi_162 - edi_153 != 0x00 l00401253
l00401268:
	ebx_187 = (word32) Mem0[ecx_155 - 0x03 + 0x00:word16]
	esp_193 = esp_158 - 0x04
	Mem194[esp_193 + 0x00:word32] = Mem0[esp_158 + 0x00:word32]
	edx_195 = Mem194[esp_193 + 0x00:word32]
	esp_198 = esp_193 + 0x04
	eax_202 = Mem194[0x0040102B:word32]
l004012B7:
	ebx_114 = PHI(ebx_187, ebx_88)
	edx_117 = PHI(edx_195, edx_90)
	eax_119 = PHI(eax_202, eax_93)
	esp_122 = PHI(esp_198, esp_96)
	edi_125 = Mem0[edx_117 + 0x00:word32]
	edx_129 = edx_117 + 0x01
l004012C0:
	ebx_88 = PHI(ebx, ebx_114)
	edx_90 = PHI(edx_29, edx_129)
	edi_91 = PHI(edi_216, edi_125)
	eax_93 = PHI(eax_209, eax_119)
	esp_96 = PHI(esp_214, esp_122)
	branch (edi_91 ^ eax_93) == 0x00 l004012DC
	goto l004012B7
l004012D3:
l004012D4:
l004012D5:
	ecx_230 = (ecx | 0x9E1501B5) - 0x01
	branch v21_224 == 0x00 && ecx_230 != 0x00 l00401258
l004012D7:
	__outb(dx | ~0x3B, al_210)
	call fnD837FD69 (retsize: 4;)
		uses: al_233,ax_211,C_232,di_217,dl_30,dx_27,eax_209,ebp,ebx,ecx_230,edi_216,edx_29,esi_20,esp_214,fs,SCZO_234,si_21,SZO_228,Z_229
		defs: al_245,ax_250,C_238,di_252,dl_248,dx_236,eax_242,ebp_251,ebx_247,ecx_244,edi_241,edx_249,esi_239,esp_235,fs_253,SCZO_243,si_240,SZO_237,Z_246
	goto l004012DE
l004012DD:
l004012DE:
	fs_33 = PHI(fs_253, fs)
	ebp_34 = PHI(ebp_251, ebp)
	ebx_36 = PHI(ebx_247, ebx_88)
	esp_44 = PHI(esp_235, esp_96)
	eax_49 = ebx_36 + 4163496
	esp_51 = esp_44 - 0x04
	Mem52[esp_51 + 0x00:word32] = eax_49
	Mem59[esp_51 - 0x04 + 0x00:word32] = Mem52[fs_33:0x00:word32]
	Mem63[esp_51 - 0x08 + 0x00:word32] = esp_51 - 0x04
	edi_64 = Mem63[esp_51 - 0x08 + 0x00:word32]
	Mem67[fs_33:0x00:word32] = edi_64
	Mem70[esp_51 - 0x08 + 0x00:word32] = 0x00
	edi_72 = __rol(edi_64, 0x12)
	Mem79[esp_51 - 0x0C + 0x00:word32] = ebp_34
	ecx_74 = ebp_34
	esi_80 = ebp_34
	return (eax_49 + 0x01 >> 0x07) + ~0x7EA2A602
fn004011D9_exit:
	use ecx_74 (=> ecxOut)
	use ebx_36 (=> ebxOut)
	use esi_80 (=> esiOut)
	use edi_72 (=> ediOut)
}

