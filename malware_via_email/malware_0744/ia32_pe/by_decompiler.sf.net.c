// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0744/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn004011CB(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, selector fs)
{
	word32 ecx_10;
	word32 ebx_11;
	word32 esi_12;
	word32 edi_13;
	word32 eax_14 = fn004011D9(eax, ecx, edx, ebx, ebp, fs, dwLoc04, dwArg00, out ecx_10, out ebx_11, out esi_12, out edi_13);
	Mem19[eax_14 + 0x00000000:byte] = Mem0[eax_14 + 0x00000000:byte] + (byte) eax_14;
	Mem29[ebx_11 + 0x00000000:byte] = Mem19[ebx_11 + 0x00000000:byte] + ch;
	int64 edx_eax_23 = (int64) eax_14;
	word32 eax_24 = (word32) edx_eax_23;
	word32 edx_26 = SLICE(edx_eax_23, word32, 32);
	word32 ecx_31;
	word32 ebx_32;
	word32 esi_33;
	word32 edi_34;
	fn004011D9(eax_24, ecx_10, edx_26, ebx_11, ebp, fs, dwLoc04, dwArg00, out ecx_31, out ebx_32, out esi_33, out edi_34);
	return;
}

word32 fn004011D9(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, selector fs, word32 dwArg00, word32 dwArg04, ptr32 ecxOut, ptr32 ebxOut, ptr32 esiOut, ptr32 ediOut)
{
fn004011D9_entry:
	def fp
	def dx
	def dwArg00
	def dwArg04
	def ecx
	def Mem0
	def edx
	def fs
	def ebx
l004011D9:
	__ror((word16) dwArg00, 0x01)
	dx_27 = dx | 0xFFC4 | 0x0000
	esp_7 = fp + 0x00000004
	eax_24 = (word32) Mem0[dwArg04 - 0xFFFFFFF9:byte] (alias)
	edx_29 = DPB(edx, dx_27, 0, 16) (alias)
	dl_30 = (byte) dx_27 (alias)
	branch eax_24 == 0x00000090 l0040122D
l00401208:
	eax_199 = __ror(eax_24, 0x16)
	Mem203[(ecx | 0x9E1501B5) + eax_199:word32] = dwArg04
	__lock()
	al_200 = (byte) eax_199 (alias)
	Mem209[eax_199 + 0x00000000:byte] = Mem203[eax_199 + 0x00000000:byte] + al_200
	Mem211[eax_199 + 0x00000000:byte] = Mem209[eax_199 + 0x00000000:byte] + al_200
	Mem213[ebx + 0x00000000:byte] = Mem211[ebx + 0x00000000:byte] + dl_30
	v21_214 = Mem213[eax_199 + 0x00000000:byte] + al_200
	Mem215[eax_199 + 0x00000000:byte] = v21_214
	ax_201 = (word16) eax_199 (alias)
	esp_204 = fp + 0x00000008
	edi_206 = dwArg04 - 0xFFFFFFF9 >> 0x00000019 ^ ebx
	goto l004012D3
l0040122D:
	dx_229 = (word16) (fp + 0x00000004) (alias)
	ax_233 = dx_229
	ecx_237 = Mem0[DPB(0x00126738, dx_229, 0, 16):word32]
	edi_242 = Mem0[0x004010C8:word32]
l00401253:
	ecx_129 = PHI(ecx_237, ecx_144)
	ax_131 = PHI(ax_233, ax_154)
	esp_132 = PHI(esp_7, esp_147)
	edi_135 = PHI(edi_242, edi_149)
	ecx_138 = ecx_129 - 0xFFFFFFFF
l00401258:
	ecx_144 = PHI(ecx_138, ecx_220)
	ax_146 = PHI(ax_131, ax_201)
	esp_147 = PHI(esp_132, esp_204)
	edi_149 = PHI(edi_135, edi_206)
	esi_152 = Mem0[ecx_144 + 0x00000000:word32]
	ax_154 = __rol(ax_146, 0x07)
	branch esi_152 - edi_149 != 0x00000000 l00401253
l00401268:
	ebx_177 = (word32) Mem0[ecx_144 - 0x00000003:word16]
	esp_183 = esp_147 - 0x00000004
	Mem184[esp_183 + 0x00000000:word32] = Mem0[esp_147 + 0x00000000:word32]
	edx_185 = Mem184[esp_183 + 0x00000000:word32]
	esp_188 = esp_183 + 0x00000004
	eax_192 = Mem184[0x0040102B:word32]
l004012B7:
	ebx_104 = PHI(ebx_177, ebx_33)
	edx_106 = PHI(edx_185, edx_36)
	eax_108 = PHI(eax_192, eax_38)
	esp_110 = PHI(esp_188, esp_40)
	edi_115 = Mem0[edx_106 + 0x00000000:word32]
	edx_119 = edx_106 + 0x00000001
l004012C0:
	ebx_33 = PHI(ebx, ebx_104)
	edx_36 = PHI(edx_29, edx_119)
	eax_38 = PHI(eax_199, eax_108)
	esp_40 = PHI(esp_204, esp_110)
	edi_41 = PHI(edi_206, edi_115)
	branch (edi_41 ^ eax_38) == 0x00000000 l004012DC
l004012CE:
	goto l004012D4
l004012D3:
	branch v21_214 > 0x00 l004012C0
	goto l004012D5
l004012D4:
	goto l004012B7
l004012D5:
	ecx_220 = (ecx | 0x9E1501B5) - 0x00000001
	branch v21_214 == 0x00 && ecx_220 != 0x00000000 l00401258
l004012D7:
	__outb(dx_27, al_200)
	goto l004012DD
l004012DC:
	goto l004012DE
l004012DD:
l004012DE:
	eax_66 = ebx_33 + 0x003F87A8
	esp_68 = esp_40 - 0x00000004
	Mem69[esp_68 + 0x00000000:word32] = eax_66
	Mem77[esp_68 - 0x00000004:word32] = Mem69[fs:0x00000000:word32]
	Mem80[esp_68 - 0x00000008:word32] = esp_68 - 0x00000008
	edi_81 = Mem80[esp_68 - 0x00000008:word32]
	Mem84[fs:0x00000000:word32] = edi_81
	Mem87[esp_68 - 0x00000008:word32] = 0x00000000
	edi_89 = __rol(edi_81, 0x12)
	Mem96[esp_68 - 0x0000000C:word32] = edx_36
	ecx_91 = edx_36
	esi_97 = edx_36
	return (eax_66 + 0x00000001 >> 0x00000007) + 0x815D59FD
fn004011D9_exit:
	use ecx_91 (=> ecxOut)
	use ebx_33 (=> ebxOut)
	use esi_97 (=> esiOut)
	use edi_89 (=> ediOut)
}

