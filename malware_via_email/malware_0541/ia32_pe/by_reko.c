// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 1310E000: Register word32 fn1310E000(Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C, Stack word32 dwArg10, Stack word32 dwArg14, Stack word32 dwArg18)
word32 fn1310E000(word32 dwArg04, word32 dwArg08, word32 dwArg0C, word32 dwArg10, word32 dwArg14, word32 dwArg18)
{
	*dwArg10 = dwArg0C;
	word16 wLoc10_104 = (word16) (uint32) ((uint64) (uint32) dwArg14 % 0x05);
	byte * dwArg08_28 = dwArg08 + dwArg14;
	while (true)
	{
		dwArg0C = dwArg0C - 0x01;
		if (dwArg0C == 0x00)
			break;
		*dwArg04 = (byte) ((int32) *dwArg08_28 ^ (word32) (*((word32) ((int32) wLoc10_104) + dwArg18)));
		word16 cx_83 = wLoc10_104 + 0x01;
		wLoc10_104 = cx_83;
		if ((int32) cx_83 == 0x05)
			wLoc10_104 = 0x00;
		dwArg04 = dwArg04 + 0x01;
		dwArg08_28 = dwArg08_28 + 0x01;
	}
	return dwArg0C;
}

// 1310E09B: Register word32 fn1310E09B(Register word32 ebp)
word32 fn1310E09B(word32 ebp)
{
	SetErrorMode(0x5C000000);
	word32 esp_26;
	word32 ebp_27;
	byte SCZO_28;
	word32 eax_29;
	word32 edi_30;
	word32 ecx_31;
	byte SZO_32;
	byte C_33;
	word32 edx_34;
	byte Z_35;
	word32 esi_36;
	word32 ebx_37;
	byte dl_38;
	ADVAPI32.dll!WmiReceiveNotificationsA();
	GetStartupInfoA(fp - 660);
	ptr32 esp_67;
	word32 ebp_68;
	byte SCZO_69;
	word32 eax_70;
	word32 edi_71;
	word32 ecx_72;
	byte SZO_73;
	byte C_74;
	word32 edx_75;
	byte Z_76;
	word32 esi_77;
	word32 ebx_78;
	byte dl_79;
	ADVAPI32.dll!WmiSetSingleInstanceW();
	HRESULT eax_49 = SafeArrayGetUBound(null, 0x0006C000, (LONG *) 0x00012C00);
	if (edx_75 != 0x03EC0000 && eax_70 + 0x80040199 == eax_49 + ~0x0002FE66)
	{
		word32 ebx_325 = *((word32) eax_49 - 1828067671);
		*(esp_67 - 0x04) = fp - 0x0234;
		*(esp_67 - 0x08) = 0x00;
		*(esp_67 - 0x0C) = fp - 0x10;
		*(esp_67 - 0x10) = 0x04;
		*(esp_67 - 0x14) = fp - 0x023C;
		*(esp_67 - 0x18) = fp - 0x023C;
		fn1310E000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
		Eq_170 edi_350 = *((word32) eax_49 - 1828067667);
		*(esp_67 - 0x04) = fp - 0x0234;
		*(esp_67 - 0x08) = 0x04;
		*(esp_67 - 0x0C) = fp - 0x10;
		*(esp_67 - 0x10) = 0x04;
		*(esp_67 - 0x14) = fp - 0x025C;
		*(esp_67 - 0x18) = fp - 600;
		fn1310E000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
		Eq_216 edi_373 = *((word32) eax_49 - 0x6CF6194F);
		*(esp_67 - 0x04) = fp - 0x0234;
		*(esp_67 - 0x08) = 0x08;
		*(esp_67 - 0x0C) = fp - 0x10;
		*(esp_67 - 0x10) = 0x04;
		*(esp_67 - 0x14) = fp - 0x1C;
		*(esp_67 - 0x18) = fp - 0x14;
		fn1310E000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
		*(esp_67 - 0x04) = 0x00;
		Eq_268 eax_400 = GetModuleHandleA(*(esp_67 - 0x04));
		Eq_277 eax_408 = *((word32) eax_49 - 0x6CF6194B);
		*(esp_67 - 0x04) = fp - 0x0234;
		*(esp_67 - 0x08) = 0x0C;
		*(esp_67 - 0x0C) = fp - 0x10;
		*(esp_67 - 0x10) = 0x04;
		*(esp_67 - 0x14) = fp - 0x28;
		*(esp_67 - 0x18) = fp - 0x1C;
		fn1310E000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
		dwLoc0248 = (Eq_325) *((word32) eax_49 - 1828067655);
		*(esp_67 - 0x04) = fp - 0x0234;
		*(esp_67 - 0x08) = 0x10;
		*(esp_67 - 0x0C) = fp - 0x10;
		*(esp_67 - 0x10) = 0x04;
		*(esp_67 - 0x14) = fp - 600;
		*(esp_67 - 0x18) = fp - 0x0248;
		fn1310E000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
		*(esp_67 - 0x04) = 0x40;
		*(esp_67 - 0x08) = 0x3000;
		Eq_325 eax_471 = edi_373 * 0x08 + 0x0C;
		Mem481[esp_67 - 0x0C + 0x00:word32] = eax_471 + edi_350 + ebx_325;
		*(esp_67 - 0x10) = 0x00;
		dwLoc023C = ebx_325;
		dwLoc0258 = edi_350;
		dwLoc14 = edi_373;
		dwLoc20 = eax_400;
		dwLoc024C = 0x14;
		dwLoc24 = eax_49 + 2466899645;
		dwLoc2C = eax_471;
		dwLoc0260 = VirtualAlloc(*(esp_67 - 0x10), *(esp_67 - 0x0C), *(esp_67 - 0x08), *(esp_67 - 0x04));
		dwLoc0C = eax_408 + eax_400 + eax_471;
		dwLoc0264 = eax_471;
		dwLoc08 = 0x00;
		dwLoc18 = 0x00;
	}
	while (0x01 != 0x00)
	{
		if (dwLoc0264 == dwLoc0248)
		{
			Eq_216 edx_243 = (word32) dwLoc08.dw0000 + 0x01;
			dwLoc08 = edx_243;
			if (edx_243 == dwLoc14)
				break;
			Eq_546 edx_249 = *((char *) &dwLoc24->t9309E6B9->t0000->t0000 + 1828067655);
			*(esp_67 - 0x04) = fp - 0x0234;
			*(esp_67 - 0x08) = dwLoc024C;
			*(esp_67 - 0x0C) = fp - 0x10;
			*(esp_67 - 0x10) = 0x04;
			*(esp_67 - 0x14) = fp - 0x1C - dwLoc024C;
			*(esp_67 - 0x18) = fp - 0x1C;
			fn1310E000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
			word32 esi_279 = dwLoc24 + 0x04;
			dwLoc0248 = (Eq_325) esi_279->t0000->t0000;
			*(esp_67 - 0x04) = fp - 0x0234;
			ui32 ebx_276 = dwLoc024C + 0x04;
			*(esp_67 - 0x08) = ebx_276;
			*(esp_67 - 0x0C) = fp - 0x10;
			*(esp_67 - 0x10) = 0x04;
			*(esp_67 - 0x14) = fp - 0x0248 - ebx_276;
			*(esp_67 - 0x18) = fp - 0x0248;
			fn1310E000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
			dwLoc024C = ebx_276 + 0x04;
			dwLoc24 = esi_279 + 0x04;
			dwLoc0264 = 0x00;
			dwLoc0C = edx_249 + dwLoc20;
		}
		*((char *) dwLoc0260 + dwLoc18) = (Eq_411) dwLoc0C.t0000->unused;
		dwLoc0C = dwLoc0C + 0x01;
		dwLoc18 = dwLoc18 + 0x01;
		dwLoc0264 = dwLoc0264 + 0x01;
	}
	*(esp_67 - 0x04) = fp - 0x0234;
	(esp_67 - 0x08)->t0000->t0000 = dwLoc2C;
	*(esp_67 - 0x0C) = fp - 0x0238;
	(esp_67 - 0x10)->t0000 = (LPVOID) dwLoc0258;
	*(esp_67 - 0x14) = (LPVOID *) (dwLoc0260 - dwLoc2C);
	*(esp_67 - 0x18) = (LPVOID *) dwLoc0260;
	word32 eax_164 = fn1310E000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
	*(esp_67 - 0x04) = fp;
	*(esp_67 - 0x08) = fp - 0x0234;
	(esp_67 - 0x0C)->t0000 = (LPVOID) dwLoc0258;
	*(esp_67 - 0x10) = dwLoc023C;
	*(esp_67 - 0x14) = (LPVOID *) dwLoc0260;
	word32 esi_187 = dwLoc0260 + dwLoc0258;
	*(esp_67 - 0x18) = (LPVOID *) esi_187;
	word32 esp_191;
	word32 ebp_192;
	byte SCZO_193;
	word32 eax_194;
	word32 edi_195;
	word32 ecx_196;
	byte SZO_197;
	byte C_198;
	word32 edx_199;
	byte Z_200;
	word32 esi_201;
	word32 ebx_202;
	byte dl_203;
	(dwLoc0260 + 0x0F50)();
	return eax_194;
}

// 1310E4E5: Register Eq_413 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	fs->ptr0000 = fp - 0x14;
	word32 esp_36;
	word32 ebp_37;
	word32 eax_38;
	struct Eq_658 * fs_39;
	byte SCZO_40;
	word32 ebx_41;
	word32 esi_42;
	word32 edi_43;
	byte SZO_44;
	byte C_45;
	word32 ecx_46;
	byte Z_47;
	byte al_48;
	byte bl_49;
	byte CZ_50;
	_set_app_type();
	word32 esp_55;
	word32 ebp_56;
	word32 * eax_57;
	struct Eq_675 * fs_58;
	byte SCZO_59;
	word32 ebx_60;
	word32 esi_61;
	word32 edi_62;
	byte SZO_63;
	byte C_64;
	word32 ecx_65;
	byte Z_66;
	byte al_67;
	byte bl_68;
	byte CZ_69;
	_p__fmode();
	*eax_57 = 0x00;
	word32 esp_75;
	word32 ebp_76;
	word32 * eax_77;
	struct Eq_696 * fs_78;
	byte SCZO_79;
	word32 ebx_80;
	word32 esi_81;
	word32 edi_82;
	byte SZO_83;
	byte C_84;
	word32 ecx_85;
	byte Z_86;
	byte al_87;
	byte bl_88;
	byte CZ_89;
	_p__commode();
	*eax_77 = 0x00;
	word32 eax_96 = *adjust_fdiv;
	fn1310E63E();
	ptr32 esp_100 = fp - 0x98;
	if (eax_96 == 0x00)
	{
		*(fp - 0x9C) = 0x0DA00000;
		ptr32 esp_270;
		word32 ebp_271;
		word32 eax_272;
		struct Eq_862 * fs_273;
		byte SCZO_274;
		word32 ebx_275;
		word32 esi_276;
		word32 edi_277;
		byte SZO_278;
		byte C_279;
		word32 ecx_280;
		byte Z_281;
		byte al_282;
		byte bl_283;
		byte CZ_284;
		_setusermatherr();
		esp_100 = esp_270;
	}
	fn1310E629();
	ptr32 * esp_102 = esp_100 - 0x04;
	*esp_102 = fp - 0x80;
	*(esp_102 - 0x04) = fp - 0x80;
	ptr32 esp_106;
	word32 ebp_107;
	word32 eax_108;
	struct Eq_748 * fs_109;
	byte SCZO_110;
	word32 ebx_111;
	word32 esi_112;
	word32 edi_113;
	byte SZO_114;
	byte C_115;
	word32 ecx_116;
	byte Z_117;
	byte al_118;
	byte bl_119;
	byte CZ_120;
	initterm();
	*(esp_106 - 0x08) = fp - 0x70;
	*(esp_106 - 0x0C) = eax_96;
	*(esp_106 - 0x10) = fp - 0x68;
	*(esp_106 - 0x14) = fp - 116;
	*(esp_106 - 0x18) = fp - 100;
	ptr32 esp_139;
	word32 ebp_140;
	word32 eax_141;
	struct Eq_798 * fs_142;
	byte SCZO_143;
	word32 ebx_144;
	word32 esi_145;
	word32 edi_146;
	byte SZO_147;
	byte C_148;
	word32 ecx_149;
	byte Z_150;
	byte al_151;
	byte bl_152;
	byte CZ_153;
	_getmainargs();
	*(esp_139 - 0x08) = fp - 0x80;
	*(esp_139 - 0x0C) = fp - 0x80;
	struct Eq_825 * esp_160;
	word32 ebp_161;
	word32 eax_162;
	struct Eq_828 * fs_163;
	byte SCZO_164;
	word32 ebx_165;
	word32 esi_166;
	word32 edi_167;
	byte SZO_168;
	byte C_169;
	word32 ecx_170;
	byte Z_171;
	byte al_172;
	cu8 bl_173;
	byte CZ_174;
	initterm();
	cu8 * esi_178 = *acmdln;
	if (*esi_178 == 0x22)
	{
		do
		{
			esi_178 = esi_178 + 0x01;
			cu8 al_247 = *esi_178;
		} while (al_247 == bl_173 || al_247 == 0x22);
		if (*esi_178 == 0x22)
		{
l1310E5AA:
			esi_178 = esi_178 + 0x01;
		}
	}
	else
	{
		while (*esi_178 > 0x20)
			esi_178 = esi_178 + 0x01;
	}
	cu8 al_187 = *esi_178;
	if (al_187 == bl_173 || al_187 > 0x20)
	{
		Eq_78 eax_203;
		esp_160->t001C = fp - 0x60;
		GetStartupInfoA(esp_160->t001C);
		if (0x00 != 0x00)
			eax_203 = (word32) wLoc30;
		else
		{
			esp_160->t001C = (struct _STARTUPINFOA *) 0x0A;
			eax_203 = esp_160->t001C;
		}
		esp_160->t001C = eax_203;
		esp_160->ptr0018 = esi_178;
		esp_160->dw0014 = 0x00;
		&esp_160->t0010.u0->unused = 0x00;
		esp_160->t0010 = GetModuleHandleA(esp_160->t0010);
		esp_160->dw0032 = fn1310E09B(ebp_161);
		exit(esp_160->dw0032);
	}
	goto l1310E5AA;
}

// 1310E629: void fn1310E629()
void fn1310E629()
{
	word32 esp_6;
	word32 ecx_7;
	controlfp();
	return;
}

// 1310E63E: void fn1310E63E()
void fn1310E63E()
{
	return;
}

