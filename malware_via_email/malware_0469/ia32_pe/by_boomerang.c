__size32 global13 = 0x5b280733;// 4 bytes

// address: 0x401000
void _start(unsigned int param1, unsigned int param2, unsigned int param3, unsigned int param4) {
    unsigned char cl; 		// r9
    unsigned char cl_1; 		// r9{69}
    int dx; 		// r2
    unsigned int dx_1; 		// r2{122}
    __size32 eax; 		// r24
    unsigned int eax_1; 		// r24{269}
    unsigned int eax_2; 		// r24{105}
    union { unsigned int x15; HANDLE x16; } eax_3; 		// r24{353}
    HANDLE eax_4; 		// r24{181}
    __size32 eax_5; 		// r24{136}
    __size32 ebp; 		// r29
    unsigned int ebx; 		// r27
    int ecx; 		// r25
    unsigned int edi; 		// r31
    __size32 *edi_1; 		// r31
    __size32 *edi_2; 		// r31{289}
    unsigned short *edi_3; 		// r31{358}
    int edx; 		// r26
    void *edx_1; 		// r26
    union { unsigned int x1; void * x2; } edx_2; 		// r26{287}
    union { unsigned int x1; void * x2; } edx_3; 		// r26{212}
    unsigned int esi; 		// r30
    unsigned int *esi_1; 		// r30
    unsigned int esi_2; 		// r30{273}
    __size32 *esi_3; 		// r30{387}
    int esp; 		// r28
    unsigned int local0; 		// m[esp - 40]
    unsigned int local1; 		// m[esp - 36]
    __size32 local15; 		// m[esp - 24]
    int local18; 		// m[esp - 8]
    unsigned int local19; 		// m[esp - 36]{102}
    __size32 *local2; 		// m[esp - 40]
    unsigned int local20; 		// m[esp - 36]{157}
    unsigned int local21; 		// m[esp - 36]{416}
    __size32 *local22; 		// m[esp - 40]{438}
    unsigned int local23; 		// m[esp - 40]{418}
    unsigned int local24; 		// m[esp - 76]{441}
    unsigned int local25; 		// param2{271}
    unsigned int local26; 		// esi_2{273}
    unsigned int local27; 		// param4{274}
    unsigned int local28; 		// local21{416}
    union { unsigned int x1; void * x2; } local29; 		// edx{308}
    unsigned int local3; 		// m[esp - 76]
    unsigned int local30; 		// param1{425}
    unsigned int local31; 		// local3{434}
    unsigned int local32; 		// local3{437}
    union { unsigned int x15; HANDLE x16; } local33; 		// eax_4{395}
    HANDLE local5; 		// m[esp - 72]

    ebp = 0;
    local0 = 0;
    eax = AddUsersToEncryptedFile();
    local25 = param2;
    local26 = param3;
    local27 = param4;
    local30 = param1;
    if (eax != 0) {
        eax = AreAllAccessesGranted();
        if (eax == 0) {
        }
        ecx = VirtualProtect(); /* Warning: also results in edx */
        eax = 0;
        do {
            eax_1 = eax;
            param2 = local25;
            esi_2 = local26;
            param4 = local27;
            esi = edx + esi_2 * 2;
            local26 = esi;
            if (ebp == 0) {
                ebp = 0;
            }
            ebx = edx + esi_2 * 2 + param2 * 8;
            cl_1 = *(ebp + 0x404000);
            cl = (cl_1 ^ *(eax_1 + 0x4015c8));
            ecx = ((ecx >> 8 & 0xffffff | (cl_1)) >> 8 & 0xffffff | (cl)) >> 8 & 0xffffff | (cl ^ -54);
            *(char*)(eax_1 + 0x4015c8) = cl ^ -54;
            edi = edx + param4 * 8;
            eax = eax_1 + 1;
            ebp++;
            local25 = ebx;
            local27 = edi;
        } while (eax_1 + 1 < 0x1440);
        ecx = 0;
        edi_1 = 0x4028c8;
        ebp = 0xf0401348;
        local19 = 0;
        local28 = local19;
        do {
            edx_2 = edx;
            edi_2 = edi_1;
            local21 = local28;
            eax_2 = *(edi_2 + 4);
            eax = (eax_2 - 8) / 2;
            edx = edx_2 * 9;
            dx = (unsigned short) edx_2 * 9;
            esi_1 = edi_2 + 8;
            if ((int)((eax_2 - 8) / 2) > 0) {
                local0 = (eax_2 - 8) / 2;
                do {
                    local23 = local0;
                    ecx = ecx * 3;
                    dx_1 = *esi_1;
                    dx = dx_1 & 0xfffff000;
                    edx = (edx >> 16 & 0xffff | (dx_1)) >> 16 & 0xffff | (dx_1 & 0xfffff000);
                    tmph = (dx_1 & 0xfffff000) - 0x3000;
                    local29 = edx;
                    if ((dx_1 & 0xfffff000) == 0x3000) {
                        edx_1 = edx + esi_1;
                        dx = (unsigned short) edx + esi_1;
                        eax = *(unsigned short*)esi_1;
                        eax_5 = (eax & 0xfff) + *edi_2;
                        eax = eax_5 + 0x401348;
                        *(__size32*)(eax_5 + 0x401348) = *(eax_5 + 0x401348) - 0xfbfecb8;
                        local29 = edx_1;
                    }
                    edx = local29;
                    esi_1 += 2;
                    local0 = local23 - 1;
                } while (local23 != 1);
                ecx = local21;
            }
            ecx += *(edi_2 + 4);
            local20 = ecx;
            edi_1 = edi_2 + *(edi_2 + 4);
            local28 = local20;
        } while (ecx < (unsigned int)-1);
        edi_1 = edi_2 + *(edi_2 + 4);
        flags = SUBFLAGS32(*0x4020c4, 0, global13);
        esi_1 = 0x4020b4;
        local2 = 0x4020b4;
        local33 = eax;
        if (*0x4020c4 != 0) {
            do {
                param1 = local30;
                ecx = *(esi_1 + 12);
                cl = (unsigned char) ecx + 0x401348;
                eax_4 = LoadLibraryA(ecx + 0x401348); /* Warning: also results in ecx, edx */
                local31 = param1;
                local32 = param1;
                ebp = eax_4;
                if (eax_4 != 0) {
                    edi = *esi_1;
                    if (edi == 0) {
                        edi = *(esi_1 + 16);
                    }
                    esi = *(esi_1 + 16);
                    eax = *(edi + 0x401348);
                    edi_1 = edi + 0x401348;
                    esi_1 = esi + 0x401348;
                    flags = LOGICALFLAGS32(eax);
                    if (eax != 0) {
                        do {
                            eax_3 = eax;
                            edi_3 = edi_1;
                            if ( !flags) {
                                edx = *(unsigned short*)edi_3;
                                eax = GetProcAddress(eax_4, edx); /* Warning: also results in ecx, edx_3 */
                                edx = edx_3 + ecx;
                                dx = (unsigned short) edx_3 + ecx;
                                goto L4;
                            }
                            cl = (unsigned char) ecx * 5;
                            eax = GetProcAddress(eax_4, eax_3 + 0x40134a); /* Warning: also results in ecx, edx */
L4:
                            edi_1 = edi_3 + 4;
                            *(__size32*)esi_1 = eax;
                            eax = *(edi_3 + 4);
                            esi_1++;
                            flags = LOGICALFLAGS32(eax);
                            local31 = local3;
                        } while (eax != 0);
                    }
                    eax_4 = eax;
                    local3 = local31;
                    esi_1 = local2;
                    local32 = local3;
                }
                esi_3 = esi_1;
                local3 = local32;
                esi_1 = esi_3 + 20;
                tmp1 = *(esi_3 + 36);
                flags = SUBFLAGS32(*(esi_3 + 36), 0, tmp1);
                local2 = esi_3 + 20;
                local30 = local3;
                local33 = eax_4;
            } while (*(esi_3 + 36) != 0);
        }
        eax_4 = local33;
        (*0x401da8)(local24, local5, pc, 0x401000, 0x3000, 64, esp - 28, -1, -1, local22, local1, param4, param3, local15, param2, 228, 37, dx, 168, eax_4, 0x401da8, edx, 0x401348, ebp, esi_1, edi_1, flags, ZF, CF);
        *(__size32*)(esp - 4) = 0;
        ExitProcess(*(esp - 4));
    }
    return;
}

