// subject.c
// Generated on 5/4/2015 12:22:39 AM by decompiling malware_via_email/malware_0091/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn10009990(word32 ebp, selector es)
{
fn10009990_entry:
	def fp
	def ebp
	def Mem0
	def es
	def dwLocAD
	goto l10009990
l10001000:
l10005FFE:
	eax_31094 = PHI(eax_10604, eax_31100)
	al_31095 = PHI(al_10605, al_31101)
	v10256_31096 = Mem10609[eax_31094 + 0x00000000:byte] + al_31095
	Mem31097[eax_31094 + 0x00000000:byte] = v10256_31096
	eax_31100 = __indw(0x0004)
	al_31101 = (byte) eax_31100 (alias)
	ah_31102 = SLICE(eax_31100, byte, 8) (alias)
	branch v10256_31096 > 0x00 l10005FFE
l10006003:
	call dwLocAD (retsize: 4; depth: 4)
	eax_31105 = DPB(eax_31100, __inb(0x0004), 0, 8) (alias)
	Mem31107[fp - 0x00000040:word32] = 0x00006000
	Mem31109[esp_10608 - 0xFFFFFF98:word32] = es
	Mem31112[eax_31105 + 0x00000000:byte] = Mem31109[eax_31105 + 0x00000000:byte] + ah_31102
	Mem31114[eax_31105 + 0x00000000:byte] = Mem31112[eax_31105 + 0x00000000:byte] + 0x04
l10009990:
	esi_25 = 0x10006000
	edi_27 = 0x10001000
	goto l100099AA
l100099A0:
	Mem31143[edi_70 + 0x00000000:byte] = Mem0[esi_64 + 0x00000000:byte]
	esi_31141 = esi_64 + 0x00000001
	edi_31144 = edi_70 + 0x00000001
l100099A6:
	ebp_81 = PHI(ebp_63, ebp_140, ebp_140)
	esi_82 = PHI(esi_31141, esi_174, esi_174)
	edi_88 = PHI(edi_31144, edi_197, edi_213)
	ebx_90 = PHI(ebx_72, ebx_176, ebx_176)
	ebx_91 = ebx_90 * 0x00000002
	C_97 = cond(ebx_91) (alias)
	branch ebx_91 != 0x00000000 l100099B1
l100099AA:
	ebp_35 = PHI(ebp, ebp_81)
	esi_36 = PHI(esi_25, esi_82)
	edi_42 = PHI(edi_27, edi_88)
	esi_46 = esi_36 - 0xFFFFFFFC
	ebx_54 = Mem0[esi_46 + 0x00000000:word32] * 0x00000002 + (esi_46 <u 0xFFFFFFFC)
	esi_51 = esi_46 - 0xFFFFFFFC
	C_60 = cond(ebx_54) (alias)
l100099B1:
	ebp_63 = PHI(ebp_35, ebp_81)
	esi_64 = PHI(esi_51, esi_82)
	edi_70 = PHI(edi_42, edi_88)
	ebx_72 = PHI(ebx_54, ebx_91)
	C_78 = PHI(C_60, C_97)
	branch C_78 l100099A0
l100099B3:
	eax_99 = 0x00000001
l100099B8:
	esi_103 = PHI(esi_64, esi_115, esi_31120)
	eax_104 = PHI(eax_99, eax_118, eax_118)
	ebx_106 = PHI(ebx_72, ebx_121, ebx_31123)
	ebx_107 = ebx_106 * 0x00000002
	C_113 = cond(ebx_107) (alias)
	branch ebx_107 != 0x00000000 l100099C3
l100099BC:
	esi_31129 = esi_103 - 0xFFFFFFFC
	ebx_31132 = Mem0[esi_103 + 0x00000000:word32] * 0x00000002 + (esi_31129 <u 0x00000000)
	C_31138 = cond(ebx_31132) (alias)
l100099C3:
	esi_115 = PHI(esi_31129, esi_103)
	ebx_116 = PHI(ebx_31132, ebx_107)
	C_117 = PHI(C_31138, C_113)
	eax_118 = eax_104 * 0x00000002 + C_117
	ebx_121 = ebx_116 * 0x00000002
	branch ebx_121 >=u 0x00000000 l100099B8
l100099C9:
	branch ebx_121 != 0x00000000 l100099D4
l100099CB:
	esi_31120 = esi_115 - 0xFFFFFFFC
	ebx_31123 = Mem0[esi_115 + 0x00000000:word32] * 0x00000002 + (esi_31120 <u 0x00000000)
	branch ebx_31123 >=u 0x00000000 l100099B8
l100099D4:
	esi_129 = PHI(esi_115, esi_31120)
	ebx_130 = PHI(ebx_121, ebx_31123)
	branch eax_118 <u 0x00000003 l100099E8
l100099DB:
	eax_294 = DPB(eax_118 - 0x00000003 << 0x00000008, Mem0[esi_129 + 0x00000000:byte], 0, 8) (alias)
	esi_295 = esi_129 + 0x00000001
	branch (eax_294 ^ 0xFFFFFFFF) == 0x00000000 l10009A5A
l100099E6:
	ebp_303 = eax_294 ^ 0xFFFFFFFF
l100099E8:
	ebp_140 = PHI(ebp_63, ebp_303)
	esi_141 = PHI(esi_129, esi_295)
	ebx_144 = ebx_130 * 0x00000002
	C_150 = cond(ebx_144) (alias)
	branch ebx_144 != 0x00000000 l100099F3
l100099EC:
	esi_281 = esi_141 - 0xFFFFFFFC
	ebx_284 = Mem0[esi_141 + 0x00000000:word32] * 0x00000002 + (esi_281 <u 0x00000000)
	C_290 = cond(ebx_284) (alias)
l100099F3:
	esi_152 = PHI(esi_141, esi_281)
	ebx_153 = PHI(ebx_144, ebx_284)
	C_154 = PHI(C_150, C_290)
	ebx_156 = ebx_153 * 0x00000002
	C_162 = cond(ebx_156) (alias)
	branch ebx_156 != 0x00000000 l10009A00
l100099F9:
	esi_269 = esi_152 - 0xFFFFFFFC
	ebx_272 = Mem0[esi_152 + 0x00000000:word32] * 0x00000002 + (esi_269 <u 0x00000000)
	C_278 = cond(ebx_272) (alias)
l10009A00:
	esi_164 = PHI(esi_152, esi_269)
	ebx_165 = PHI(ebx_156, ebx_272)
	C_169 = PHI(C_162, C_278)
	ecx_171 = C_154 * 0x00000002 + C_169
	branch ecx_171 != 0x00000000 l10009A24
l10009A04:
	ecx_215 = ecx_171 + 0x00000001
l10009A05:
	esi_217 = PHI(esi_164, esi_228, esi_248)
	ecx_218 = PHI(ecx_215, ecx_231, ecx_231)
	ebx_219 = PHI(ebx_165, ebx_232, ebx_251)
	ebx_220 = ebx_219 * 0x00000002
	C_226 = cond(ebx_220) (alias)
	branch ebx_220 != 0x00000000 l10009A10
l10009A09:
	esi_257 = esi_217 - 0xFFFFFFFC
	ebx_260 = Mem0[esi_217 + 0x00000000:word32] * 0x00000002 + (esi_257 <u 0x00000000)
	C_266 = cond(ebx_260) (alias)
l10009A10:
	esi_228 = PHI(esi_257, esi_217)
	ebx_229 = PHI(ebx_260, ebx_220)
	C_230 = PHI(C_266, C_226)
	ecx_231 = ecx_218 * 0x00000002 + C_230
	ebx_232 = ebx_229 * 0x00000002
	branch ebx_232 >=u 0x00000000 l10009A05
l10009A16:
	branch ebx_232 != 0x00000000 l10009A21
l10009A18:
	esi_248 = esi_228 - 0xFFFFFFFC
	ebx_251 = Mem0[esi_228 + 0x00000000:word32] * 0x00000002 + (esi_248 <u 0x00000000)
	branch ebx_251 >=u 0x00000000 l10009A05
l10009A21:
	esi_240 = PHI(esi_228, esi_248)
	ebx_241 = PHI(ebx_232, ebx_251)
	ecx_245 = ecx_231 + 0x00000002
l10009A24:
	esi_174 = PHI(esi_164, esi_240)
	ecx_175 = PHI(ecx_171, ecx_245)
	ebx_176 = PHI(ebx_165, ebx_241)
	ecx_183 = ecx_175 + 0x01 + (ebp_140 <u 0xFFFFF300)
	edx_184 = edi_70 + ebp_140
	branch ebp_140 <=u 0xFFFFFFFC l10009A44
l10009A35:
	edx_189 = PHI(edx_184, edx_193)
	edi_190 = PHI(edi_70, edi_197)
	ecx_191 = PHI(ecx_183, ecx_198)
	Mem196[edi_190 + 0x00000000:byte] = Mem0[edx_189 + 0x00000000:byte]
	edx_193 = edx_189 + 0x00000001
	edi_197 = edi_190 + 0x00000001
	ecx_198 = ecx_191 - 0x00000001
	branch ecx_198 != 0x00000000 l10009A35
l10009A3E:
	goto l100099A6
l10009A44:
	edx_201 = PHI(edx_184, edx_205)
	edi_202 = PHI(edi_70, edi_209)
	ecx_203 = PHI(ecx_183, ecx_210)
	Mem208[edi_202 + 0x00000000:word32] = Mem0[edx_201 + 0x00000000:word32]
	edx_205 = edx_201 + 0x00000004
	edi_209 = edi_202 + 0x00000004
	ecx_210 = ecx_203 - 0x00000004
	branch ecx_210 >u 0x00000000 l10009A44
l10009A53:
	edi_213 = edi_209 + ecx_210
	goto l100099A6
l10009A5A:
	ebp_306 = Mem0[0x1000A030:word32]
	Mem310[fp - 0x00000024:word32] = eax_294 ^ 0xFFFFFFFF
	call ebp_306 (retsize: 4; depth: 56)
	v15_10566 = Mem310[0x100001EF:byte] & 0x7F
	Mem10567[0x100001EF:byte] = v15_10566
	v16_10569 = Mem10567[0x10000217:byte] & 0x7F
	Mem10570[0x10000217:byte] = v16_10569
	call ebp_306 (retsize: 4; depth: 72)
	esp_10603 = fp - 0x00000020
	eax_10604 = fp - 0x000000A0
	al_10605 = (byte) (fp - 0x000000A0) (alias)
l10009A8F:
	esp_10607 = PHI(esp_10603, esp_10608)
	esp_10608 = esp_10607 - 0x00000004
	Mem10609[esp_10608 + 0x00000000:word32] = 0x00000000
	branch esp_10608 != fp - 0x000000A0 l10009A8F
l10009A95:
	goto l10001000
fn10009990_exit:
}

