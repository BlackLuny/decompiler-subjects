// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1050/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

real64 fn00401108(word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, selector fs, real64 rArg0)
{
fn00401108_entry:
	def rArg0
	def dl
	def ebp
	def ecx
	def edx
	def esi
	def ebx
	def fp
	def fs
	def ss
	def edi
	def P
	def cs
	goto l00401108
l00401102:
l00401108:
	rArg0_8 = PHI(rArg0, rArg0_39)
	dl_9 = PHI(dl, dl_53)
	ebp_11 = PHI(ebp, ebp_69)
	ecx_12 = PHI(ecx, ecx_74)
	edx_13 = PHI(edx, edx_54)
	esi_14 = PHI(esi, esi_70)
	ebx_15 = PHI(ebx, ebx_31)
	Mem20[fp - 0x00000004:word32] = 0x00410214
	psegLoc08_24 = (selector) Mem20[fs:0x00000000:word32] (alias)
	Mem25[fs:0x00000000:word32] = fp - 0x00000008
	Mem27[0x00000000:word32] = ecx_12
	Mem29[fp - 0x0000000C:word32] = 0x00000000
	ebx_31 = ebx_15 + 0x00000001
	al_34 = Mem29[0x00000000:byte] ^ 0x00
	rArg0_39 = rArg0_8 - Mem29[edi + 0x0010DC7F:real32]
	Mem41[ebx_31 + 0x00000000:byte] = Mem29[ebx_31 + 0x00000000:byte] | dl_9
	__das(al_34, &al_43)
	dl_53 = dl_9 | (byte) ss
	ebp_30 = ebp_11 + 0x00000001
	bh_32 = SLICE(ebx_31, byte, 8) (alias)
	edx_54 = DPB(edx_13, dl_53, 0, 8) (alias)
	ds_64 = psegLoc08_24
	branch OVERFLOW(dl_53) l00401138
	goto l00401139
l00401138:
	ebp_553 = ebp_30 + 0x00000001
	goto l0040113A
l00401139:
	ds_esi_550 = Mem41[ss + 0x0000:segptr32]
	ds_551 = SLICE(ds_esi_550, selector, 32) (alias)
	esi_552 = ds_esi_550 (alias)
l0040113A:
	ds_67 = PHI(ds_551, ds_64)
	ebp_69 = PHI(ebp_30, ebp_553)
	esi_70 = PHI(esi_552, esi_14)
	al_76 = Mem41[0x965DE6C4:byte] + 0xC4
	ecx_74 = ss + 0x00000001
	cl_75 = (byte) (ss + 0x00000001) (alias)
	eax_78 = DPB(0x965DE6C4, al_76 ^ 0x1E, 0, 8) (alias)
	branch (al_76 ^ 0x1E) < 0x00 l004011B6
l00401147:
	branch ss == 0x00000001 l00401102
l00401149:
	esp_91 = fp - 0xFFFFECBB | Mem41[ss + 0x00000001:word32]
	O_94 = cond(esp_91) (alias)
	branch false l00401155
l00401151:
	ebx_153 = DPB(ebx_31, bh_32 - 0xE6, 8, 8) (alias)
	O_156 = cond(bh_32 - 0xE6) (alias)
l00401153:
	O_139 = PHI(O_156, O_102)
	esp_145 = PHI(esp_91, esp_128)
	ecx_146 = PHI(ecx_74, ecx_130)
	ebx_149 = PHI(ebx_153, ebx_111)
	branch O_139 l00401171
l00401155:
	O_102 = PHI(O_94, O_139)
	esp_108 = PHI(esp_91, esp_145)
	ecx_109 = PHI(ecx_74, ecx_146)
	ebx_111 = PHI(ebx_31, ebx_149)
	esp_112 = esp_108 - 0x00000004
	Mem113[esp_112 + 0x00000000:word32] = ss
	Mem115[esp_112 - 0x00000004:word32] = eax_78
	Mem117[esp_112 - 0x00000008:word32] = ecx_109
	Mem119[esp_112 - 0x0000000C:word32] = edx_54
	Mem121[esp_112 - 0x00000010:word32] = ebx_111
	Mem123[esp_112 - 0x00000014:word32] = esp_112 - 0x00000014
	Mem125[esp_112 - 0x00000018:word32] = fp - 0x0000000A
	Mem127[esp_112 - 0x0000001C:word32] = esi_70
	Mem129[esp_112 - 0x00000020:word32] = edi
	esp_128 = esp_112 - 0x00000020
	ecx_130 = ecx_109 - 0x00000001
	branch ecx_130 != 0x00000000 l00401169
l00401159:
l00401169:
	branch ecx_130 == 0x00000000 l00401153
l0040116B:
	goto l00401174
l00401171:
l00401174:
l004011B6:
	eax_179 = DPB(eax_78, 0xE6 - cl_75, 8, 8) ^ edx_54 + 0x00000001
	edx_174 = edx_54 + 0x00000001
	dx_177 = (word16) (edx_54 + 0x00000001) (alias)
	esp_178 = fp - 0x0000000B
	al_180 = (byte) eax_179 (alias)
	ah_181 = SLICE(eax_179, byte, 8) (alias)
	ecx_190 = ss
	branch ss != 0x00000000 l0040122F
l004011BF:
	Mem439[eax_179 + 0x00000000:word32] = Mem41[eax_179 + 0x00000000:word32] - ebx_31
	v28_447 = Mem439[esi_70 + 0x69DB8DD9:word32] - 0x7C - (DPB(eax_179, al_180 & 0xBA, 0, 8) <u ebx_31)
	Mem448[esi_70 + 0x69DB8DD9:word32] = v28_447
	branch v28_447 <= 0x00000000 l004011F3
l004011D7:
	__outb(0x00, al_180 & 0xBA)
	return rArg0_39
l004011E5:
	Mem335[edx_290 + 0xF037BA88:byte] = Mem298[edx_290 + 0xF037BA88:byte] + 0x11
	return rArg0_39
l004011F3:
	al_468 = (al_180 & 0xBA) + 0x15
	Mem483[DPB(eax_179, al_468, 0, 8):byte] = 0x5B
	ebx_479 = DPB(ebx_31, 0x11, 8, 8) (alias)
	branch al_468 >= 0x00 l0040121B
l004011FF:
	al_489 = al_468 - 0x1B - (al_468 <u 0x00)
	eax_495 = DPB(eax_179, al_489, 0, 8) - 0x0E789A94 - (al_489 <u 0x00)
	ebp_487 = cs
	C_499 = cond(eax_495) (alias)
	goto l00401209
l00401207:
	branch (eax_302 & 0x2B542A34) < 0x00000000 l00401217
l00401209:
	edi_407 = PHI(edi_301, edi)
	ebp_409 = PHI(ebp_285, ebp_487)
	C_411 = PHI(C_310, C_499)
	eax_412 = PHI(eax_314, eax_495)
	ecx_413 = PHI(ecx_317, ecx_190)
	esi_415 = PHI(esi_299, esi_70)
	ebx_416 = PHI(ebx_293, ebx_479)
	eax_419 = eax_412 + 0x10A07058 + C_411
	al_424 = (byte) eax_419 - 0xFE - (eax_419 <u 0x00000000)
	esp_418 = ebx_416 - 0x00000001
	eax_425 = DPB(eax_419, al_424, 0, 8) (alias)
	S_433 = cond(al_424) (alias)
	ecx_434 = ecx_413 - 0x00000001
	branch al_424 == 0x00 && ecx_434 != 0x00000000 l00401256
l00401216:
	goto l0040121B
l00401217:
	branch (eax_302 & 0x2B542A34) < 0x00000000 l0040122E
l00401219:
	goto l0040121C
l0040121B:
l0040121C:
l0040121E:
l0040122E:
	return rArg0_39
l0040122F:
	ecx_506 = ss - 0x00000001
	branch eax_179 == 0x00000000 && ss != 0x00000001 l004012A1
l00401231:
	edi_284 = PHI(edi, edi_344)
	ebp_285 = PHI(ebp_69, ebp_347)
	eax_287 = PHI(eax_179, eax_356)
	esp_288 = PHI(esp_178, esp_357)
	ecx_289 = PHI(ecx_506, ecx_358)
	edx_290 = PHI(edx_174, edx_370)
	al_291 = PHI(al_180, al_361)
	esi_292 = PHI(esi_70, esi_362)
	ebx_293 = PHI(ebx_31, ebx_363)
	Mem298[edi_284 + 0x00000000:byte] = Mem41[esi_292 + 0x00000000:byte]
	__inb(0x2E)
	esi_299 = esi_292 + 0x00000001
	edi_301 = edi_284 + 0x00000001
	eax_302 = (DPB(eax_287, al_291 & 0x44, 0, 8) & 0x30744F94) - 0x0E1C3870
	C_310 = false
	eax_314 = 0xF037BB26
	al_315 = 0x26 (alias)
	ecx_317 = ecx_289 - 0x00000001
	branch ecx_317 != 0x00000000 l00401207
l0040124D:
	branch ecx_317 == 0x00000000 l004011E5
l0040124F:
	v33_319 = Mem298[edi_301 + 0xDC4C83A4:word32] - 0x30
	Mem320[edi_301 + 0xDC4C83A4:word32] = v33_319
	S_328 = cond(v33_319) (alias)
l00401253:
	edi_257 = PHI(edi_301, edi_344)
	ebp_260 = PHI(ebp_285, ebp_347)
	S_268 = PHI(S_328, S_391)
	eax_269 = PHI(eax_314, eax_372)
	esp_270 = PHI(esp_288, esp_375)
	ecx_271 = PHI(ecx_317, ecx_358)
	al_275 = PHI(al_315, al_373)
	esi_276 = PHI(esi_299, esi_362)
	ebx_277 = PHI(ebx_293, ebx_363)
l00401256:
	edi_344 = PHI(edi_257, edi_407)
	ebp_347 = PHI(ebp_260, ebp_409)
	S_355 = PHI(S_268, S_433)
	eax_356 = PHI(eax_269, eax_425)
	esp_357 = PHI(esp_270, esp_418)
	ecx_358 = PHI(ecx_271, ecx_434)
	al_361 = PHI(al_275, al_424)
	esi_362 = PHI(esi_276, esi_415)
	ebx_363 = PHI(ebx_277, ebx_416)
	branch P l0040126C
l0040125D:
	edx_370 = 0x96E5DC72 (alias)
	branch S_355 l0040121E
l00401261:
	branch ecx_358 == 0x00000000 l00401231
l00401263:
	eax_372 = eax_356 - 0xF72F83FC
	esp_375 = esp_357 - 0x00000004
	Mem376[esp_375 + 0x00000000:word32] = ds_67
	al_373 = (byte) eax_372 (alias)
	goto l0040126E
l0040126C:
l0040126E:
	(esi_362 + 0x0000006D)[ebp_347 * 0x00000008] = (esi_362 + 0x0000006D)[ebp_347 * 0x00000008] | 0xFFFFFF98
	S_391 = cond((esi_362 + 0x0000006D)[ebp_347 * 0x00000008]) (alias)
	branch (esi_362 + 0x0000006D)[ebp_347 * 0x00000008] != 0x00000000 l00401253
l00401275:
l004012A1:
	__outb(dx_177, al_180)
	al_519 = __inb(dx_177)
	Mem521[0xD6E83C86:word16] = fs
	branch edi[(ss - 0x00000001) * 0x04] != 0x86 && ss != 0x00000002 || edi[(ss - 0x00000001) * 0x04] == 0x86 l004012E4
	goto l004012B3
l004012B1:
l004012B3:
	int3()
	branch edi[(ss - 0x00000001) * 0x04] == 0x86 && ss != 0x00000003 l00401326
l004012B6:
	__daa(al_519, &al_530)
	Mem547[0xA7D0DFCB:word32] = __indw(0xB3)
l004012E4:
	__aaa(al_519, ah_181, &al_524, &ah_525)
	return rArg0_39
l00401326:
fn00401108_exit:
}

