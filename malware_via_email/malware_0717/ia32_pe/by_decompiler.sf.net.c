// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0717/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00406098(up32 eax, word32 ecx, word32 edx, Eq_188 * fs)
{
fn00406098_entry:
l00406098:
	Eq_2 * esp_13 = fp - 0x00000028
	up32 esi_26 = globals->dw40746F
	word32 edi_10 = 0x000000AE
l004060C0:
	esp_13 = esp_13 - 0x00000004;
	esp_13->dw0000 = edi_10;
	esp_13->dw0000 = 0x0000006D;
	edi_10 = 0x0000000E;
	branch false l004060C0
l004060D4:
	branch eax <u esi_26 l004060EB
l004060DA:
	esi_26 = 0x845E08BC;
l004060EB:
l004060F1:
	branch globals->dw407168 != globals->dw407168 l004060F1
l00406105:
	Mem35[esp_13 - 0x00000004:word32] = 0x15D3ABA8
	Mem39[esp_13 - 0x00000004:word32] = 0x00000007
	__rol(esi_26, 0x16)
	Eq_2 * esp_276 = esp_13 + 1
	up32 esi_280 = globals->dw407056 + 0x00407056
	branch false l0040613C
l00406130:
	esi_280 = globals->dw40741C;
l0040613C:
	branch esi_280 >u 0x00407056 l00406155
l00406140:
	esp_13->dw0000 = 0x78843108;
	esp_276 = esp_13;
l00406155:
	word32 * esp_122 = esp_276 - 0x00000004
	*esp_122 = 0x0023C708;
	word32 esi_271 = 0x00000000
	branch true l00406177
l0040616B:
	esi_271 = globals->dw407165;
l00406177:
l0040617A:
	up32 ebx_266 = globals->dw407070
	branch ebx_266 != globals->dw407070 l0040617A
l00406190:
	branch ecx == 0x00000065 l004061A7
l00406195:
	ebx_266 = globals->dw407092;
l004061A7:
	word32 esi_85 = esi_271 - 0x93C18783
	branch ebx_266 >u 0xB7586EB1 l004061C6
l004061BB:
	__rol(ecx, 0x33)
l004061C6:
l004061C8:
	branch globals->dw4071F4 != globals->dw4071F4 l004061C8
l004061DC:
	__ror(esi_85 - globals->dw40737F, 0x05)
l004061ED:
	branch 0xFFFFFFFE == 0x00000000 l004061ED
l004061FF:
	word32 edi_112 = 0x0000101A
l00406206:
	word32 esi_113 = globals->dw4070CC
	branch esi_113 != globals->dw4070CC l00406206
l00406214:
l0040621A:
l0040621C:
	word32 ebx_132 = esi_113 + 0x002712CF
	branch 0x70FBA2BB == 0x00000000 l0040621C
l00406231:
	Eq_117 * eax_135 = &globals->a407000
	branch ebx_132 == 0x00318F44 l00406241
l0040623F:
l00406241:
l00406244:
	eax_135->dw0000 = eax_135->dw0000 + 0x0000080D;
	word32 esi_158 = globals->dw4073D7
	branch esi_158 != 0x00000000 l00406281
l00406272:
	__rol(esi_158, 0x50)
l00406281:
	int32 ebx_169 = globals->dw40733C
	Eq_124 * esp_173 = esp_122 - 0x00000004
	esp_173->dw0000 = 0x00407474;
	word32 eax_167 = &eax_135->dw0000
	eax_135 = eax_167 - 0x00000032;
	esp_122 = esp_173 + 0x00000004
	int32 esi_177 = 0x004072A7 - globals->dw407386
	branch eax_167 - 0x00000032 == esp_173->dw0000 l004062D7
l004062BF:
	branch esi_177 > ebx_169 l004062D0
l004062C3:
l004062D0:
	goto l00406244
l004062D7:
	edi_112 = edi_112 - 0x00000001;
	branch false l00406326
l0040631A:
l00406326:
	esp_173->dw0000 = 0x00000000;
	esi_113 = esp_173->dw0000;
	esp_122 = esp_173 + 0x00000004
	branch edi_112 == esi_113 l00406366
l00406342:
l0040635F:
	goto l0040621A
l00406366:
l00406379:
	branch false l00406379
l00406390:
	esp_173->dw0000 = fp - 0x00000004;
	esp_173->dw0004 = 0x00407000;
	esp_173->dw0004 = fs->dw0000;
	fs->dw0000 = esp_173 - 0x00000008;
fn00406098_exit:
}

