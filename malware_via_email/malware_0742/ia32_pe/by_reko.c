// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401040: void fn00401040(Stack word32 dwArg04, Stack (ptr Eq_3) dwArg08, Stack (ptr Eq_4) dwArg0C)
void fn00401040(word32 dwArg04, Eq_3 * dwArg08, Eq_4 * dwArg0C)
{
	globals->t4063FC.u0 = 0x00;
	while (globals->t4063FC < dwArg0C)
	{
		*((word32) globals->t4063FC + dwArg04) = *((word32) globals->t4063FC + dwArg08);
		globals->t4063FC = (word32) globals->t4063FC + 0x01;
	}
	return;
}

// 004010D0: Register Eq_28 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	GetProcAddress(LoadLibraryA(&globals->t406298), &globals->t406280)();
	lstrcatA(fp - 116, &globals->t4062A8);
	Eq_50 eax_70 = CreateFileA(fp - 116, 0x01, 0x03, null, 0x03, 0x80, 0x00);
	if (eax_70 != ~0x00 && eax_70 != 0x00)
	{
		if (GetProcAddress(LoadLibraryA(&globals->t4062C4), &globals->t4062B8)() == 0x00)
		{
			if (GetProcAddress(LoadLibraryA(&globals->t4062E8), &globals->t4062DC)() != 0x00)
			{
				GetModuleHandleA(null);
				struct Eq_97 * eax_205 = globals->ptr402001;
				struct Eq_97 * dwLoc08_210 = null;
				while (dwLoc08_210 < eax_205)
				{
					GetModuleHandleA(null);
					dwLoc08_210->dw402009 = dwLoc08_210->dw402009 ^ 11152423;
					dwLoc08_210 = dwLoc08_210 + 0x01;
				}
				globals->dw40640C = fn004016C0(dwArg00);
				fn00401880(dwArg00, dwArg04, dwArg08);
				globals->dw406400 = edi_184;
				globals->dw4063F8 = esi_183;
				globals->dw406408 = ebx_182;
				globals->ptr406410 = fs_191->ptr0018;
				globals->ptr406404 = fp - 0x04;
				word32 ebp_272 = fn004016F0(ebp_180, dwArg00, dwArg04);
				word32 eax_278 = fn00401300(ebp_272, dwArg00);
				word32 esp_285;
				word32 ebp_286;
				byte SCZO_287;
				word32 ebx_288;
				word32 esi_289;
				word32 edi_290;
				Eq_28 eax_291;
				word32 ecx_292;
				word32 edx_293;
				byte Z_294;
				byte SZO_295;
				byte C_296;
				struct Eq_162 * fs_297;
				globals->ptr406414();
				return eax_291;
			}
		}
	}
	return 0x00;
}

// 004012E0: Register Eq_39 fn004012E0(Stack word32 dwArg04, Stack (ptr Eq_3) dwArg08)
FARPROC fn004012E0(word32 dwArg04, Eq_3 * dwArg08)
{
	return GetProcAddress(dwArg04, dwArg08);
}

// 00401300: Register word32 fn00401300(Register word32 ebp, Stack word32 dwArg04)
word32 fn00401300(word32 ebp, word32 dwArg04)
{
	lstrcpyA(fp - 188, &globals->t40630C);
	Eq_31 eax_16 = GetModuleHandleA(&globals->t406314);
	Eq_39 eax_24 = GetProcAddress(eax_16, &globals->t406324);
	Eq_39 eax_32 = GetProcAddress(eax_16, &globals->t406334);
	Eq_39 eax_40 = GetProcAddress(eax_16, &globals->t406348);
	Eq_39 eax_48 = GetProcAddress(eax_16, &globals->t406358);
	Eq_39 eax_56 = GetProcAddress(eax_16, &globals->t406364);
	struct Eq_219 * edx_65 = dwArg04 + dwArg04->dw003C / 0x0040;
	struct Eq_225 * dwLoc2C_117 = &edx_65->w0014 + 0x02 + (word32) edx_65->w0014 / 22;
	struct Eq_233 * eax_86 = eax_40();
	fn00401040(dwArg00, dwArg04, dwArg08);
	uint32 dwLoc10_112 = 0x00;
	while (dwLoc10_112 < (word32) edx_65->w0006)
	{
		if (dwLoc2C_117->dw0014 != 0x00 && dwLoc2C_117->dw0010 != 0x00)
			fn00401040(dwArg00, dwArg04, dwArg08);
		dwLoc2C_117 = dwLoc2C_117 + 0x01;
		dwLoc10_112 = dwLoc10_112 + 0x01;
	}
	struct Eq_247 * ecx_175 = eax_86 + eax_86->dw003C / 0x0040;
	Eq_50 eax_195 = eax_32();
	struct Eq_254 * dwLocCC_206 = eax_86 + ecx_175->dw0080 / 0x0040;
	while (dwLocCC_206->dw0010 != 0x00)
	{
		word32 * dwLoc38_236;
		ui32 * dwLoc28_235;
		LoadLibraryA(eax_86 + dwLocCC_206->dw000C / 0x0040);
		if (dwLocCC_206->dw0000 != 0x00)
		{
			dwLoc28_235 = (ui32 *) (eax_86 + dwLocCC_206->dw0000 / 0x0040);
			dwLoc38_236 = (word32 *) (eax_86 + dwLocCC_206->dw0010 / 0x0040);
		}
		else
		{
			dwLoc28_235 = (ui32 *) (eax_86 + dwLocCC_206->dw0010 / 0x0040);
			dwLoc38_236 = (word32 *) (eax_86 + dwLocCC_206->dw0000 / 0x0040);
		}
		word32 dwLoc1C_239 = 0x00;
		if (dwLocCC_206->dw0010 != 0x00 && dwLocCC_206->dw0000 != 0x00)
			dwLoc1C_239 = 0x01;
		while (*dwLoc28_235 != 0x00)
		{
			if ((*dwLoc28_235 & 0x80000000) != 0x00)
				*dwLoc28_235 = fn004012E0(dwArg00, dwArg04);
			else
				*dwLoc28_235 = fn004012E0(dwArg00, dwArg04);
			if (dwLoc1C_239 != 0x00)
				*dwLoc38_236 = *dwLoc28_235;
			dwLoc28_235 = dwLoc28_235 + 0x01;
			dwLoc38_236 = dwLoc38_236 + 0x01;
		}
		dwLocCC_206 = dwLocCC_206 + 0x01;
	}
	word32 eax_367;
	globals->t4063F4 = eax_56();
	ptr32 esp_350 = fp - 0x010C;
	if (globals->t4063F4 == 0x00)
	{
		ptr32 esp_413 = fp - 0x0110;
		if (eax_24() == 0x00)
		{
			esp_413 = fp - 0x011C;
			if (eax_48() == 0x00)
			{
				eax_367 = 0x00;
				return eax_367;
			}
		}
		word32 * esp_428 = esp_413 - 0x04;
		*esp_428 = ecx_175->dw0034;
		*(esp_428 - 0x04) = 0x00;
		*(esp_428 - 0x08) = 0x00;
		*(esp_428 - 0x0C) = 0x00;
		*(esp_428 - 0x10) = 0x22;
		*(esp_428 - 0x14) = (union Eq_50 *) eax_195;
		globals->t4063F4 = eax_56();
		esp_350 = esp_428 - 0x14;
		if (globals->t4063F4 == 0x00)
		{
			*(esp_428 - 0x18) = 0x40;
			*(esp_428 - 0x1C) = 0x3000;
			*(esp_428 - 0x20) = (union Eq_50 *) ecx_175->t0050;
			*(esp_428 - 0x24) = ecx_175->dw0034;
			globals->t4063F4 = eax_40();
			esp_350 = esp_428 - 0x24;
		}
	}
	union Eq_50 * esp_379 = esp_350 - 0x04;
	*esp_379 = (union Eq_50 *) eax_195;
	CloseHandle(*esp_379);
	*esp_379 = (union Eq_50 *) ecx_175->t0050;
	*(esp_379 - 0x04) = (struct Eq_233 **) eax_86;
	*(esp_379 - 0x08) = (union Eq_50 *) globals->t4063F4;
	fn00401040(dwArg00, dwArg04, dwArg08);
	*esp_379 = (union Eq_50 *) globals->t4063F4;
	fn00401850(dwArg00);
	Mem403[0x00406414:word32] = Mem397[0x004063F4:word32] + Mem397[ecx_175 + 0x28:word32];
	ecx_175->ptr0028 = globals->ptr406414;
	eax_367 = 0x01;
	return eax_367;
}

// 004016C0: Register Eq_516 fn004016C0(Stack word32 dwArg04)
LPVOID fn004016C0(word32 dwArg04)
{
	return VirtualAlloc(null, dwArg04, 0x3000, 0x04);
}

// 004016F0: Register word32 fn004016F0(Register word32 ebp, Stack word32 dwArg04, Stack word32 dwArg08)
word32 fn004016F0(word32 ebp, word32 dwArg04, word32 dwArg08)
{
	struct Eq_528 * edx_16 = dwArg08 + dwArg08->dw003C / 0x0040;
	globals->t4063F4 = GetProcAddress(GetModuleHandleA(&globals->t406384), &globals->t406374)();
	if (globals->t4063F4 != 0x00)
	{
		fn00401040(dwArg00, dwArg04, dwArg08);
		ui32 eax_92 = globals->t4063F4 - dwArg08;
		if (edx_16->dw00A4 != 0x00)
		{
			struct Eq_574 * dwLoc0C_118 = dwArg08 + edx_16->dw00A0 / 0x0040;
			while (dwLoc0C_118->t0004 != 0x00)
			{
				uint32 eax_133 = dwLoc0C_118->t0004 - 0x08 >> 0x01;
				word16 ecx_136[] = (char *) &dwLoc0C_118->t0004 + 0x04;
				uint32 dwLoc08_139 = 0x00;
				while (dwLoc08_139 < eax_133)
				{
					if ((word32) ecx_136[dwLoc08_139] >> 0x0C == 0x03)
						(word32) globals->t4063F4 + dwLoc0C_118->dw0000 + ((word32) ecx_136[dwLoc08_139] & 0x0FFF) = (struct Eq_619 *) ((word32) globals->t4063F4 + dwLoc0C_118->dw0000 + ((word32) ecx_136[dwLoc08_139] & 0x0FFF) + eax_92);
					dwLoc08_139 = dwLoc08_139 + 0x01;
				}
				dwLoc0C_118 = dwLoc0C_118 + Mem87[dwLoc0C_118 + 0x04:word32];
			}
		}
		word32 ecx_102 = dwArg04 + Mem87[0x004063F4:word32];
		word32 esp_104;
		word32 ebp_105;
		byte SCZO_106;
		word32 esi_107;
		word32 eax_108;
		word32 ecx_109;
		word32 edx_110;
		byte Z_111;
		byte C_112;
		byte SZO_113;
		ecx_102();
		return ebp_105;
	}
	else
		return ebp;
}

// 00401850: void fn00401850(Stack word32 dwArg04)
void fn00401850(word32 dwArg04)
{
	globals->ptr406410->ptr0030->dw0008 = dwArg04;
	return;
}

// 00401880: void fn00401880(Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C)
void fn00401880(word32 dwArg04, word32 dwArg08, word32 dwArg0C)
{
	Eq_650 cl_12 = (&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&dwArg04->a0000[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00];
	lstrcpyA(fp - 0x94, &globals->t4063C4);
	Eq_661 dwLoc0C_124 = 0x01;
	int32 dwLoc18_128 = 0x00;
	do
	{
		Eq_661 edx_40 = (word32) dwLoc0C_124 + 0x01;
		byte cl_37 = Mem0[dwArg04 + dwLoc0C_124:byte];
		dwLoc0C_124 = edx_40;
		if ((word32) cl_37 == (word32) cl_12)
		{
			if ((word32) Mem0[dwArg04 + edx_40:byte] == 0x00)
			{
				(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&dwArg08[dwLoc18_128].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00] = cl_12;
				dwLoc18_128 = dwLoc18_128 + 0x01;
				dwLoc0C_124 = (word32) edx_40.u0 + 0x01;
			}
			else
			{
				word32 eax_110 = fn004019B0(fp - 0x10, dwArg04 + edx_40) + edx_40;
				dwLoc0C_124 = fn004019B0(fp - 0x20, dwArg04 + eax_110) + eax_110;
				uint32 dwLoc1C_125 = 0x00;
				while (dwLoc1C_125 < dwLoc10)
				{
					(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&dwArg08[dwLoc18_128].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00] = (&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&dwArg08[dwLoc18_128 - dwLoc20].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00];
					dwLoc18_128 = dwLoc18_128 + 0x01;
					dwLoc1C_125 = dwLoc1C_125 + 0x01;
				}
			}
		}
		else
		{
			(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&(&dwArg08[dwLoc18_128].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00].a0000)[0x00] = (Eq_650) cl_37;
			dwLoc18_128 = dwLoc18_128 + 0x01;
		}
	} while (dwLoc0C_124 < dwArg0C);
	lstrcpyA(fp - 0x94, &globals->t4063DC);
	return;
}

// 004019B0: Register word32 fn004019B0(Stack ptr32 dwArg04, Stack ptr32 dwArg08)
word32 fn004019B0(ptr32 dwArg04, ptr32 dwArg08)
{
	lstrcpyA(fp - 0x84, &globals->t406394);
	ui32 dwLoc08_19 = 0x00;
	word32 dwLoc10_20 = 0x00;
	do
	{
		ui32 edx_23 = (word32) *dwArg08;
		ui32 edx_33 = edx_23 & 0x7F | dwLoc08_19 << 0x07;
		word32 eax_36 = dwLoc10_20 + 0x01;
		dwArg08 = dwArg08 + 0x01;
		dwLoc08_19 = edx_33;
		dwLoc10_20 = eax_36;
	} while ((edx_23 & 0x80) != 0x00);
	lstrcpyA(fp - 0x84, &globals->t4063AC);
	*dwArg04 = edx_33;
	return eax_36;
}

