// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register word32 fn00401000()
word32 fn00401000()
{
	word64 edx_eax_11 = __rdtsc();
	word32 eax_13 = (word32) edx_eax_11;
	return eax_13 ^ __rol(SLICE(edx_eax_11, word32, 32) *s eax_13 + SCZDOP, (byte) (eax_13 & 0x0F));
}

// 00401017: Register word16 fn00401017(Stack word32 dwArg04)
word16 fn00401017(word32 dwArg04)
{
	word32 ecx_12 = 0x00;
	word32 edi_19 = dwArg04;
	while (true)
	{
		edi_19 = edi_19 + 0x01;
		if (0x00 == Mem0[edi_19 + 0x00:byte])
			break;
		ecx_12 = ecx_12 + 0x01;
	}
	return (word16) ecx_12;
}

// 0040103C: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 eax_35;
	word32 esp_19;
	word32 ebp_20;
	word32 esi_21;
	byte SZO_22;
	byte C_23;
	word32 eax_24;
	byte SCZO_25;
	byte Z_26;
	byte cl_27;
	comdlg32.dll!LoadAlterBitmap();
	if (dwArg0C == 0x00 && (dwArg08 <u 0x04 && (word32) wArg04 == 0x00))
	{
		Mem73[esp_19 - 0x04 + 0x00:word32] = 0x00;
		Mem75[esp_19 - 0x08 + 0x00:word32] = 0x00;
		Mem77[esp_19 - 0x0C + 0x00:word32] = 0x00;
		word32 eax_79 = CreateMutexW(Mem77[esp_19 - 0x0C + 0x00:LPSECURITY_ATTRIBUTES], Mem77[esp_19 - 0x08 + 0x00:BOOL], Mem77[esp_19 - 0x04 + 0x00:LPCWSTR]);
		Mem83[esp_19 - 0x04 + 0x00:word32] = 0x02;
		word32 eax_85 = SetErrorMode(Mem83[esp_19 - 0x04 + 0x00:UINT]);
		Mem88[esp_19 - 0x04 + 0x00:word32] = eax_79;
		Mem90[esp_19 - 0x08 + 0x00:word32] = eax_85;
		Mem93[esp_19 - 0x0C + 0x00:word32] = dwArg08;
		Mem96[esp_19 - 0x10 + 0x00:word32] = dwArg04;
		word32 esi_97;
		eax_35 = fn004014DC(cl_27, ebp_20, dwArg00, dwArg04, dwArg0C, out esi_97);
	}
	else
	{
		Mem47[esp_19 - 0x04 + 0x00:word32] = 0x00;
		Mem49[esp_19 - 0x08 + 0x00:word32] = 0x00;
		Mem51[esp_19 - 0x0C + 0x00:word32] = 0x29;
		Mem53[esp_19 - 0x10 + 0x00:word32] = 0x00;
		word32 esi_56;
		fn004014DC(cl_27, ebp_20, dwArg00, dwArg04, dwArg0C, out esi_56);
		Mem60[esp_19 - 0x04 + 0x00:word32] = esi_56;
		ExitThread(Mem60[esp_19 - 0x04 + 0x00:DWORD]);
		eax_35 = 0x1F00;
	}
	return eax_35;
}

// 004010B5: void fn004010B5(Register word32 ecx, Register word32 edx)
void fn004010B5(word32 ecx, word32 edx)
{
	word32 eax_6 = Mem0[Mem0[edx + 0x3C:word32] + edx + 0x78:word32];
	if (eax_6 != 0x00)
	{
		word32 eax_30 = eax_6 + edx;
		Mem33[eax_30 + 0x1C:word32] = Mem0[eax_30 + 0x1C:word32] + ecx;
		Mem35[eax_30 + 0x24:word32] = Mem33[eax_30 + 0x24:word32] + ecx;
		Mem37[eax_30 + 0x20:word32] = Mem35[eax_30 + 0x20:word32] + ecx;
		Mem39[eax_30 + 0x0C:word32] = Mem37[eax_30 + 0x0C:word32] + ecx;
		word32 edi_45 = Mem39[eax_30 + 0x1C:word32] + edx;
		word32 esi_46 = 0x00;
		if (Mem39[eax_30 + 0x14:word32] >u 0x00)
		{
			do
			{
				edi_45[esi_46 * 0x04] = edi_45[esi_46 * 0x04] + ecx;
				word32 v18_75 = esi_46 + 0x01;
				esi_46 = v18_75;
			} while (v18_75 <u Mem72[eax_30 + 0x14:word32]);
		}
		word32 esi_53 = Mem39[eax_30 + 0x20:word32] + edx;
		word32 edx_54 = 0x00;
		if (Mem39[eax_30 + 0x18:word32] >u 0x00)
		{
			do
			{
				esi_53[edx_54 * 0x04] = esi_53[edx_54 * 0x04] + ecx;
				edx_54 = edx_54 + 0x01;
			} while (edx_54 <u Mem66[eax_30 + 0x18:word32]);
		}
	}
	return;
}

// 00401123: void fn00401123(Register byte cl, Register word32 ebx)
void fn00401123(byte cl, word32 ebx)
{
	word32 ecx_13 = Mem0[ebx + 0x00:word32];
	Mem15[ebx + 0x28:word32] = Mem0[ebx + 0x28:word32] & 0x00;
	word32 eax_19 = Mem15[Mem15[ecx_13 + 0x3C:word32] + 0x10 + ecx_13:word32] + ecx_13;
	word32 dwLoc0C_120 = eax_19;
	word32 edi_35 = ebx + 0x04;
	word32 esi_36 = eax_19 - ~0x0B;
	word32 ecx_37 = 0x24;
	while (ecx_37 != 0x00)
	{
		Mem44[edi_35 + 0x00:byte] = Mem15[esi_36 + 0x00:byte];
		esi_36 = esi_36 + 0x01;
		edi_35 = edi_35 + 0x01;
		ecx_37 = ecx_37 - 0x01;
	}
	word32 eax_49 = Mem15[ebx + 0x04:word32];
	Mem51[ebx + 0x14:word32] = Mem15[ebx + 0x14:word32] - eax_49;
	Mem53[ebx + 0x1C:word32] = Mem51[ebx + 0x1C:word32] + eax_49;
	Mem57[ebx + 0x0C:word32] = Mem53[ebx + 0x0C:word32] + eax_49 *s ~0x07;
	Mem63[ebx + 0x18:word32] = Mem57[ebx + 0x18:word32] + eax_49 *s ~0x0F;
	Mem66[ebx + 0x10:word32] = Mem63[ebx + 0x10:word32] + -eax_49 * 0x02;
	word32 eax_112 = VirtualAlloc(0x00, Mem66[ebx + 0x10:word32] + 0x24, 0x3000, 0x40);
	Mem81[ebx + 0x28:word32] = eax_112;
	word32 dwLoc08_119 = eax_112;
	word32 dwLoc10_116 = 0x04;
	do
	{
		word32 edi_102 = dwLoc08_119;
		word32 esi_101 = dwLoc0C_120 + 0x0C;
		word32 ecx_103 = Mem81[dwLoc0C_120 + 0x08:word32];
		while (ecx_103 != 0x00)
		{
			Mem106[edi_102 + 0x00:byte] = Mem81[esi_101 + 0x00:byte];
			esi_101 = esi_101 + 0x01;
			edi_102 = edi_102 + 0x01;
			ecx_103 = ecx_103 - 0x01;
		}
		word32 v23_115 = dwLoc10_116 - 0x01;
		eax_112 = eax_112 + Mem81[dwLoc0C_120 + 0x08:word32];
		dwLoc10_116 = v23_115;
		dwLoc08_119 = eax_112;
		dwLoc0C_120 = Mem81[dwLoc0C_120 + 0x00:word32] + Mem81[ebx + 0x00:word32];
	} while (v23_115 != 0x00);
	Mem122[ebx + 0x28:word32] = Mem81[ebx + 0x28:word32] + 11;
	Mem124[ebx + 0x28:word32] = Mem122[ebx + 0x28:word32] + 0x19;
	return;
}

// 004011EA: Register word32 fn004011EA(Register word32 edi, Stack word32 dwArg04, Stack word32 dwArg08)
word32 fn004011EA(word32 edi, word32 dwArg04, word32 dwArg08)
{
	word32 eax_109;
	word32 eax_15 = Mem0[dwArg04 + 0x3C:word32] + dwArg04;
	word32 esi_19 = Mem0[eax_15 + 0x78:word32];
	if (esi_19 == 0x00)
	{
		eax_109 = 0x00;
		return eax_109;
	}
	word32 edi_117;
	word32 esi_65 = esi_19 + dwArg04;
	word32 eax_60 = Mem0[eax_15 + 0x7C:word32];
	word32 eax_72 = Mem0[esi_65 + 0x24:word32] + dwArg04;
	word32 ebx_73 = Mem0[esi_65 + 0x20:word32] + dwArg04;
	word32 edi_74 = Mem0[esi_65 + 0x1C:word32] + dwArg04;
	if (dwArg08 < 0x00)
	{
		word32 edx_180 = (dwArg08 & 0x7FFFFFFF) - Mem0[esi_65 + 0x10:word32];
		if (edx_180 >=u Mem0[esi_65 + 0x14:word32])
			goto l00401317;
		edi_117 = edi_74[edx_180 * 0x04];
	}
	else
	{
		word32 edx_184 = 0x00;
		byte Z_187 = cond(0x00 - Mem0[esi_65 + 0x18:word32]);
		word32 dwLoc08_190 = 0x00;
		if (0x00 <u Mem0[esi_65 + 0x18:word32])
		{
			while (dwArg08 != fn0040175F(dwArg04, ebx_73[edx_184 * 0x04] + dwArg04))
			{
				word32 v15_221 = dwLoc08_190 + 0x01;
				dwLoc08_190 = v15_221;
				if (v15_221 >=u Mem0[esi_65 + 0x18:word32])
					break;
				edx_184 = v15_221;
			}
			edx_184 = dwLoc08_190;
			Z_187 = cond(dwLoc08_190 - Mem0[esi_65 + 0x18:word32]);
		}
		if (Z_187)
		{
l00401317:
			eax_109 = 0x00;
			return eax_109;
		}
		edi_117 = edi_74[(word32) eax_72[edx_184 * 0x02] * 0x04];
	}
	word32 edi_120 = edi_117 + dwArg04;
	if (edi_120 <u eax_60 + esi_65 && edi_120 >=u esi_65)
	{
		word32 esi_139 = 0x00;
		if (Mem0[edi_120 + 0x00:byte] != 0x2E)
		{
			do
				esi_139 = esi_139 + 0x01;
			while (Mem0[esi_139 + edi_120:byte] != 0x2E);
		}
		memcpy(fp - 0x0114, edi_120, esi_139);
		Mem159[fp - 0x0114 + esi_139:byte] = 0x00;
		word32 eax_160 = LoadLibraryA(fp - 0x0114);
		if (eax_160 == 0x00)
			goto l00401317;
		edi_120 = fn004011EA(edi_120, eax_160, fn0040175F(dwArg04, esi_139 + 0x01 + edi_120));
	}
	eax_109 = edi_120;
	return eax_109;
}

// 00401339: Register word32 fn00401339(Register word32 ecx, Register word32 ebp, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C, Register out ptr32 ebxOut, Register out ptr32 ediOut)
word32 fn00401339(word32 ecx, word32 ebp, word32 dwArg04, word32 dwArg08, word32 dwArg0C, ptr32 & ebxOut, ptr32 & ediOut)
{
	*ediOut = edi;
	*ebxOut = ebx;
	word32 ecx_19 = (word32) Mem0[dwArg08 + 0x0C:word16];
	word32 dwLoc08_10 = ecx & 0x00;
	word32 eax_20 = (word32) Mem0[dwArg08 + 0x0E:word16] + ecx_19;
	if (eax_20 != 0x00)
	{
		word32 ebx_51 = dwArg0C;
		word32 esp_53 = fp - 0x14;
		word32 edi_56 = dwArg04;
		word32 dwArg08_57 = dwArg08 + 0x14;
		do
		{
			word32 eax_66 = Mem0[dwArg08_57 + 0x00:word32];
			if (eax_66 < 0x00)
			{
				word32 esp_89 = esp_53 - 0x04;
				Mem90[esp_89 + 0x00:word32] = ebx_51;
				Mem94[esp_89 - 0x04 + 0x00:word32] = (eax_66 & 0x7FFFFFFF) + edi_56;
				Mem96[esp_89 - 0x08 + 0x00:word32] = edi_56;
				fn00401339(ecx_19, fp - 0x04, dwArg00, dwArg04, dwArg08_57, out ebx_51, out edi_56);
				esp_53 = esp_89 - 0x08;
			}
			else
			{
				word32 eax_101 = eax_66 + edi_56;
				Mem103[eax_101 + 0x00:word32] = Mem0[eax_101 + 0x00:word32] + ebx_51;
			}
			word32 v15_75 = dwLoc08_10 + 0x01;
			ecx_19 = (word32) Mem0[dwArg08 + 0x0C:word16];
			dwLoc08_10 = v15_75;
			dwArg08_57 = dwArg08_57 + 0x08;
			eax_20 = (word32) Mem0[dwArg08 + 0x0E:word16] + ecx_19;
		} while (v15_75 <u eax_20);
		word32 edi_84;
		*ediOut = Mem0[esp_53 + 0x00:word32];
		word32 ebx_86;
		*ebxOut = Mem0[esp_53 + 0x04:word32];
	}
	return eax_20;
}

// 004013AE: void fn004013AE(Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg10)
void fn004013AE(word32 dwArg04, word32 dwArg08, word32 dwArg10)
{
	word32 edi_17 = fp - 0x010C;
	word32 ecx_18 = 0x0100;
	while (ecx_18 != 0x00)
	{
		Mem24[edi_17 + 0x00:byte] = 0x00;
		edi_17 = edi_17 + 0x01;
		ecx_18 = ecx_18 - 0x01;
	}
	word32 ebx_115 = 0x00;
	byte bl_108 = 0x00;
	word32 eax_42 = VirtualAlloc(0x00, dwArg08, 0x3000, 0x40);
	if (eax_42 != 0x00)
	{
		do
		{
			byte al_99 = (byte) fn00401000();
			word32 eax_102 = fp - 0x010C + (word32) al_99;
			if (Mem0[eax_102 + 0x00:byte] == bl_108)
			{
				Mem185[eax_102 + 0x00:byte] = 0x01;
				word32 edi_186 = eax_42;
				word32 esi_187 = dwArg04;
				word32 ecx_188 = dwArg08;
				while (ecx_188 != 0x00)
				{
					Mem195[edi_186 + 0x00:byte] = Mem185[esi_187 + 0x00:byte];
					esi_187 = esi_187 + 0x01;
					edi_186 = edi_186 + 0x01;
					ecx_188 = ecx_188 - 0x01;
				}
				word32 esi_200 = eax_42;
				word32 edi_201 = eax_42;
				word32 ecx_203 = dwArg08;
				byte cl_204 = (byte) dwArg08;
				byte dl_209 = al_99;
				do
				{
					Mem230[edi_201 + 0x00:byte] = Mem185[esi_200 + 0x00:byte] ^ dl_209;
					ecx_203 = ecx_203 - 0x01;
					esi_200 = esi_200 + 0x01;
					edi_201 = edi_201 + 0x01;
					dl_209 = __rol(dl_209 + cl_204, 0x03);
					cl_204 = (byte) ecx_203;
				} while (ecx_203 != 0x00);
				ebx_115 = 0x00;
				bl_108 = 0x00;
			}
			word32 edx_118 = dwArg08;
			word32 eax_120 = eax_42;
			word32 ecx_123 = 0x3ADE6018;
			do
			{
				ecx_123 = ecx_123 *s 33 ^ (word32) Mem0[eax_120 + 0x00:byte];
				eax_120 = eax_120 + 0x01;
				edx_118 = edx_118 + ~0x00;
			} while (edx_118 != 0x00);
		} while (ecx_123 != dwArg10);
		word32 edi_145 = dwArg04;
		word32 esi_146 = eax_42;
		word32 ecx_147 = dwArg08;
		while (ecx_147 != 0x00)
		{
			Mem154[edi_145 + 0x00:byte] = Mem0[esi_146 + 0x00:byte];
			esi_146 = esi_146 + 0x01;
			edi_145 = edi_145 + 0x01;
			ecx_147 = ecx_147 - 0x01;
		}
		VirtualAlloc(ebx_115, ebx_115, 0x3000, 0x40);
		VirtualFree(eax_42, ebx_115, 0x8000);
	}
	return;
}

// 004014DC: Register word32 fn004014DC(Register byte cl, Register word32 ebp, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg10, Register out ptr32 esiOut)
word32 fn004014DC(byte cl, word32 ebp, word32 dwArg04, word32 dwArg08, word32 dwArg10, ptr32 & esiOut)
{
	word32 ebp_210 = fp - 0x04;
	if (dwArg10 == 0x00)
		GetModuleHandleA(0x00);
	word32 esp_158;
	word32 eax_105;
	if (dwArg10 != 0x00 && dwArg08 != 0x01)
	{
l0040173E:
		Mem71[fp + ~0x67:word32] = Mem0[ebp_210 + 0x10:word32];
		word32 ecx_72 = Mem71[ebp_210 - 0x54 + 0x00:word32];
		Mem75[fp + ~0x6B:word32] = Mem71[ebp_210 + 0x0C:word32];
		word32 eax_76 = Mem75[ecx_72 + 0x3C:word32];
		Mem79[fp + ~0x6F:word32] = Mem75[ebp_210 + 0x08:word32];
		word32 eax_80 = Mem79[eax_76 + 0x28 + ecx_72:word32];
		Mem83[fp + ~0x73:word32] = Mem79[ebp_210 + 0x14:word32];
		word32 eax_84 = eax_80 + ecx_72;
		word32 ebp_97;
		byte SCZO_98;
		word32 ebx_99;
		word32 esi_100;
		byte SZO_101;
		byte C_102;
		word32 edi_103;
		byte Z_104;
		word32 ecx_106;
		byte cl_107;
		bcuiposr0 None_108;
		word32 edx_109;
		byte CZ_110;
		byte ah_111;
		word16 ax_112;
		byte al_113;
		byte bh_114;
		eax_84();
		goto l00401758;
	}
	fn00401123(cl, fp - 88);
	word32 ecx_125 = (word32) (dwLoc48 != dwLoc4C);
	word32 eax_134 = VirtualAlloc(0x00, dwLoc48, 0x3000, 0x40);
	if (eax_134 == 0x00)
	{
l00401550:
		esp_158 = fp + ~0x63;
		eax_105 = 0x00;
l00401758:
		word32 esi_53;
		*esiOut = Mem0[esp_158 + 0x04:word32];
		return eax_105;
	}
	word32 edi_165 = eax_134;
	word32 esi_167 = dwLoc30;
	word32 ecx_168 = dwLoc48;
	while (ecx_168 != 0x00)
	{
		Mem175[edi_165 + 0x00:byte] = Mem0[esi_167 + 0x00:byte];
		esi_167 = esi_167 + 0x01;
		edi_165 = edi_165 + 0x01;
		ecx_168 = ecx_168 - 0x01;
	}
	word32 edi_209;
	fn004013AE(eax_134, dwLoc48, dwLoc34);
	word32 eax_198 = dwLoc48 - dwLoc3C + eax_134;
	if (ecx_125 != 0x00)
	{
		word32 eax_451 = fn00401A31(esi_167, eax_134, dwLoc4C, eax_198, out ebp_210);
		Mem454[ebp_210 - 0x18 + 0x00:word32] = eax_451;
		edi_209 = eax_451;
	}
	else
		edi_209 = eax_134;
	if (edi_209 == 0x00)
		goto l00401550;
	word32 esi_216 = Mem0[edi_209 + 0x3C:word32];
	Mem218[ebp_210 - 0x20 + 0x00:word32] = Mem0[ebp_210 - 0x40 + 0x00:word32] + edi_209;
	word32 eax_219 = Mem218[ebp_210 - 0x54 + 0x00:word32];
	word32 ebx_221 = Mem218[eax_219 + 0x3C:word32] + eax_219;
	Mem225[ebp_210 - 0x14 + 0x00:word32] = (word32) Mem218[ebx_221 + 0x14:word16] + 0x18 + ebx_221;
	word32 esi_226 = esi_216 + edi_209;
	Mem230[ebp_210 - 0x10 + 0x00:word32] = (word32) Mem225[esi_226 + 0x14:word16] + 0x18 + esi_226;
	Mem233[fp + ~0x67:word32] = ebp_210 - 0x1C;
	Mem235[fp + ~0x6B:word32] = 0x04;
	Mem237[fp + ~0x6F:word32] = 0x01;
	Mem239[fp + ~0x73:word32] = ebx_221;
	VirtualProtect(Mem239[fp + ~0x73:LPVOID], Mem239[fp + ~0x6F:SIZE_T], Mem239[fp + ~0x6B:DWORD], Mem239[fp + ~0x67:PDWORD]);
	Mem245[fp + ~0x67:word32] = Mem239[ebp_210 - 0x40 + 0x00:word32];
	Mem247[fp + ~0x6B:word32] = edi_209;
	word32 ebx_250;
	word32 esi_251;
	word32 eax_252 = fn0040188A(ebx_221, ebp_210, dwArg00, dwArg04, out ebx_250, out esi_251);
	Mem255[ebp_210 - 0x04 + 0x00:word32] = eax_252;
	word32 edi_256 = eax_252 - Mem255[(ebp_210 - 0x54) + 0x00:word32];
	Mem260[ebp_210 - 0x24 + 0x00:word32] = edi_256;
	byte bh_222 = SLICE(ebx_221, byte, 8);
	if (Mem255[ebp_210 + 0x14:word32] != 0x00)
	{
		word32 eax_434 = Mem260[esi_251 + 0x78:word32];
		if (eax_434 != 0x00)
		{
			Mem442[ebx_250 + 0x78:word32] = eax_434 + edi_256;
l0040161D:
			word32 ecx_265 = Mem260[esi_251 + 0x88:word32];
			if (ecx_265 != 0x00)
			{
				Mem405[ebx_250 + 0x88:word32] = ecx_265 + edi_256;
				word32 ecx_406 = Mem405[esi_251 + 0x8C:word32];
				word32 eax_407 = Mem405[ebx_250 + 0x88:word32];
				Mem408[ebx_250 + 0x8C:word32] = ecx_406;
				word32 eax_409 = eax_407 + Mem408[(ebp_210 - 0x54) + 0x00:word32];
				Mem412[fp + ~0x67:word32] = edi_256;
				Mem414[fp + ~0x6B:word32] = eax_409;
				Mem416[fp + ~0x6F:word32] = eax_409;
				word32 ebx_418;
				word32 edi_419;
				word32 eax_423 = (fn00401339(ecx_406, ebp_210, dwArg00, dwArg04, dwArg08, out ebx_418, out edi_419) | ~0x00) - Mem416[(ebp_210 - 0x54) + 0x00:word32];
				Mem425[ebx_418 + 0x50:word32] = eax_423;
			}
			word32 eax_273 = Mem260[ebp_210 - 0x20 + 0x00:word32];
			word32 ecx_277 = Mem260[ebp_210 - 0x04 + 0x00:word32] - Mem260[esi_251 + 0x34:word32];
			Mem281[ebp_210 - 0x0C + 0x00:word32] = 0x00;
			if (Mem260[eax_273 + 0x00:word32] >u 0x00)
			{
				Mem384[fp - 0xD1 + 0x00:byte] = Mem281[fp - 0xD1 + 0x00:byte];
				Mem387[ebp_210 - 0x08 + 0x00:word32] = eax_273 - ~0x03;
				do
				{
					word32 eax_390 = Mem387[Mem387[ebp_210 - 0x08 + 0x00:word32] + 0x00:word32] + Mem387[(ebp_210 - 0x04) + 0x00:word32];
					Mem392[ebp_210 - 0x08 + 0x00:word32] = Mem387[ebp_210 - 0x08 + 0x00:word32] + 0x01;
					Mem394[ebp_210 - 0x08 + 0x00:word32] = Mem392[ebp_210 - 0x08 + 0x00:word32] - ~0x02;
					Mem396[eax_390 + 0x00:word32] = Mem394[eax_390 + 0x00:word32] + ecx_277;
					Mem398[ebp_210 - 0x0C + 0x00:word32] = Mem396[ebp_210 - 0x0C + 0x00:word32] + 0x01;
				} while (Mem398[ebp_210 - 0x0C + 0x00:word32] <u Mem398[Mem398[(ebp_210 - 0x20) + 0x00:word32] + 0x00:word32]);
			}
			Mem286[fp + ~0x67:word32] = Mem281[ebp_210 - 0x04 + 0x00:word32];
			if (fn004017C7(dwArg00) != 0x00)
			{
				word32 eax_292 = Mem286[ebp_210 - 0x04 + 0x00:word32];
				Mem294[fp + ~0x67:word32] = eax_292;
				word32 ebx_295;
				word32 esi_297;
				word32 edi_298;
				if (fn00401956(eax_292, bh_222, ebp_210, ebp, dwArg00, dwArg04, out ebx_295, out ebp_210, out esi_297, out edi_298) != 0x00)
				{
					if (Mem294[ebp_210 + 0x14:word32] != 0x00)
						fn004010B5(edi_298, Mem294[ebp_210 - 0x54 + 0x00:word32]);
					Mem309[ebx_295 + 0x28:word32] = Mem294[esi_297 + 0x28:word32] + edi_298;
					Mem316[ebx_295 + 0x06:word16] = (word16) (word32) Mem309[esi_297 + 0x06:word16];
					word32 edx_312 = 0x00;
					if (true)
					{
						do
						{
							word32 eax_344 = Mem316[ebp_210 - 0x14 + 0x00:word32];
							word32 esi_342 = Mem316[ebp_210 - 0x10 + 0x00:word32];
							word32 edi_343 = Mem316[ebp_210 - 0x14 + 0x00:word32];
							Mem348[ebp_210 - 0x10 + 0x00:word32] = Mem316[ebp_210 - 0x10 + 0x00:word32] + 0x10;
							Mem353[ebp_210 - 0x10 + 0x00:word32] = Mem348[ebp_210 - 0x10 + 0x00:word32] - ~0x17;
							Mem356[fp + ~0x67:word32] = 0x0A;
							word32 ecx_357 = Mem356[fp + ~0x67:word32];
							while (ecx_357 != 0x00)
							{
								Mem365[edi_343 + 0x00:word32] = Mem356[esi_342 + 0x00:word32];
								esi_342 = esi_342 + 0x04;
								edi_343 = edi_343 + 0x04;
								ecx_357 = ecx_357 - 0x01;
							}
							Mem372[eax_344 + 0x0C:word32] = Mem356[eax_344 + 0x0C:word32] + Mem356[(ebp_210 - 0x24) + 0x00:word32];
							Mem375[ebp_210 - 0x14 + 0x00:word32] = eax_344 - ~0x27;
							edx_312 = edx_312 + 0x01;
						} while (edx_312 <u (word32) Mem375[ebx_295 + 0x06:word16]);
					}
					Mem329[fp + ~0x67:word32] = 0x8000;
					Mem331[fp + ~0x6B:word32] = 0x00;
					Mem334[fp + ~0x6F:word32] = Mem331[ebp_210 - 0x18 + 0x00:word32];
					VirtualFree(Mem334[fp + ~0x6F:LPVOID], Mem334[fp + ~0x6B:SIZE_T], Mem334[fp + ~0x67:DWORD]);
					goto l0040173E;
				}
			}
			goto l00401550;
		}
	}
	Mem432[ebx_250 + 0x78:word32] = 0x00;
	Mem433[ebx_250 + 0x7C:word32] = 0x00;
	goto l0040161D;
}

// 0040175F: Register word32 fn0040175F(Register word32 ecx, Register word32 edx)
word32 fn0040175F(word32 ecx, word32 edx)
{
	word32 dwLoc08_12 = ecx & 0x00;
	word16 ax_18 = fn00401017(edx);
	while (Mem0[edx + 0x00:byte] != 0x00)
	{
		dwLoc08_12 = dwLoc08_12 *s 65599 + (word32) Mem0[edx + 0x00:word16];
		edx = edx + 0x01;
	}
	if ((dwLoc08_12 & 0x80000000) != 0x00)
		dwLoc08_12 = DPB(dwLoc08_12, (word16) dwLoc08_12 ^ (ax_18 ^ 23232), 0) & 0x7FFFFFFF;
	return dwLoc08_12;
}

// 004017C7: Register word32 fn004017C7(Stack word32 dwArg04)
word32 fn004017C7(word32 dwArg04)
{
	word32 eax_120;
	word32 edi_100 = dwArg04;
	word32 eax_16 = Mem0[Mem0[dwArg04 + 0x3C:word32] + dwArg04 + 0x80:word32];
	if (eax_16 == 0x00)
		eax_120 = eax_16 + 0x01;
	else
	{
		word32 ebx_58 = eax_16 + dwArg04;
		word32 dwLoc0C_138 = dwLoc0C & 0x00;
		word32 eax_142 = ebx_58 + 0x0C;
		if (Mem0[ebx_58 + 0x0C:word32] != 0x00)
		{
			word32 esi_141 = ebx_58;
			do
			{
				word32 eax_106 = LoadLibraryA(Mem0[eax_142 + 0x00:word32] + edi_100);
				if (eax_106 == 0x00)
				{
l00401886:
					eax_120 = 0x00;
					goto l0040187F;
				}
				dwLoc08 = dwLoc08 & 0x00;
				word32 esi_127 = Mem0[esi_141 + 0x10:word32] + edi_100;
				if (Mem0[esi_127 + 0x00:word32] != 0x00)
				{
					word32 edi_145 = esi_127;
					do
					{
						word32 eax_155 = fn004011EA(edi_145, eax_106, Mem0[edi_145 + 0x00:word32]);
						if (eax_155 == 0x00)
							goto l00401886;
						word32 v17_160 = dwLoc08 + 0x01;
						Mem162[edi_145 + 0x00:word32] = eax_155;
						dwLoc08 = v17_160;
						edi_145 = esi_127 + v17_160 * 0x04;
					} while (Mem162[edi_145 + 0x00:word32] != 0x00);
					edi_100 = dwArg04;
				}
				word32 v18_137 = dwLoc0C_138 + 0x01;
				esi_141 = v18_137 *s 0x14 + ebx_58;
				dwLoc0C_138 = v18_137;
				eax_142 = esi_141 + 0x0C;
			} while (Mem0[esi_141 + 0x0C:word32] != 0x00);
		}
		eax_120 = 0x01;
	}
	return eax_120;
}

// 0040188A: Register word32 fn0040188A(Register word32 ebx, Register word32 ebp, Stack word32 dwArg04, Stack word32 dwArg08, Register out ptr32 ebxOut, Register out ptr32 esiOut)
word32 fn0040188A(word32 ebx, word32 ebp, word32 dwArg04, word32 dwArg08, ptr32 & ebxOut, ptr32 & esiOut)
{
	word32 esp_11 = fp + ~0x040F;
	word32 edi_17 = VirtualAlloc;
	do
	{
		word32 eax_101;
		word32 esp_20 = esp_11 - 0x04;
		Mem21[esp_20 + 0x00:word32] = 0x04;
		Mem23[esp_20 - 0x04 + 0x00:word32] = 0x2000;
		Mem27[esp_20 - 0x08 + 0x00:word32] = dwArg08;
		Mem30[esp_20 - 0x0C + 0x00:word32] = 0x00;
		word32 ebp_32;
		byte SCZO_33;
		word32 esi_34;
		byte SZO_36;
		byte C_37;
		word32 eax_38;
		byte Z_39;
		word32 ebx_40;
		word32 ecx_41;
		word32 esp_114;
		edi_17();
		(fp - 0x0408)[esi_34 * 0x04] = eax_38;
		if (eax_38 == 0x00)
		{
			eax_101 = 0x00;
			goto l00401950;
		}
		Mem64[esp_114 - 0x04 + 0x00:word32] = 0x01;
		Mem66[esp_114 - 0x04 + 0x00:word32] = Mem64[esp_114 - 0x04 + 0x00:word32] + esi_34;
		word32 esi_67 = Mem66[esp_114 - 0x04 + 0x00:word32];
		esp_11 = esp_114;
	} while (esi_67 <u 0x0100);
	Mem72[esp_114 - 0x04 + 0x00:word32] = ebx_40;
	Mem74[esp_114 - 0x08 + 0x00:word32] = esi_67;
	word32 eax_76 = fn00401AA2(dwArg00);
	esi_132 = esi_67;
	if (esi_67 != 0x00)
	{
		do
		{
			word32 esi_132;
			if (esi_132 != eax_76)
			{
				Mem143[esp_114 - 0x08 + 0x00:word32] = 0x8000;
				Mem145[esp_114 - 0x0C + 0x00:word32] = 0x00;
				Mem148[esp_114 - 0x10 + 0x00:word32] = (fp - 0x0408)[esi_132 * 0x04];
				VirtualFree(Mem148[esp_114 - 0x10 + 0x00:LPVOID], Mem148[esp_114 - 0x0C + 0x00:SIZE_T], Mem148[esp_114 - 0x08 + 0x00:DWORD]);
			}
			esi_132 = esi_132 - 0x01;
		} while (esi_132 != 0x00);
	}
	word32 ebx_83 = (fp - 0x0408)[eax_76 * 0x04];
	Mem85[esp_114 - 0x08 + 0x00:word32] = 0x04;
	Mem87[esp_114 - 0x0C + 0x00:word32] = 0x1000;
	Mem90[esp_114 - 0x10 + 0x00:word32] = dwArg08;
	Mem92[esp_114 - 0x14 + 0x00:word32] = ebx_83;
	word32 esp_94;
	word32 ebp_95;
	byte SCZO_96;
	word32 esi_97;
	word32 edi_98;
	byte SZO_99;
	byte C_100;
	byte Z_102;
	word32 ebx_103;
	word32 ecx_104;
	edi_17();
	if (eax_101 != 0x00)
	{
		word32 edi_116 = ebx_103;
		word32 esi_118 = dwArg04;
		word32 ecx_119 = dwArg08;
		while (ecx_119 != 0x00)
		{
			Mem124[edi_116 + 0x00:byte] = Mem92[esi_118 + 0x00:byte];
			esi_118 = esi_118 + 0x01;
			edi_116 = edi_116 + 0x01;
			ecx_119 = ecx_119 - 0x01;
		}
		eax_101 = ebx_103;
	}
	word32 ebx_113;
	*ebxOut = Mem92[esp_94 + 0x00:word32];
	esp_114 = esp_94 + 0x04;
l00401950:
	word32 esi_57;
	*esiOut = Mem45[esp_114 + 0x04:word32];
	return eax_101;
}

// 00401956: Register word32 fn00401956(Register word32 eax, Register byte bh, Register word32 ebp, Stack word32 dwArg00, Stack word32 dwArg04, Stack word32 dwArg08, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn00401956(word32 eax, byte bh, word32 ebp, word32 dwArg00, word32 dwArg04, word32 dwArg08, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	word32 eax_100;
	word32 esi_22 = Mem0[eax + 0x3C:word32] + eax;
	word32 eax_30 = (word32) Mem0[esi_22 + 0x14:word16] + 0x18 + esi_22;
	word32 dwLoc08_109 = 0x00;
	if (Mem0[esi_22 + 0x06:word16] <=u 0x00)
	{
l00401A21:
		eax_100 = 0x01;
		return eax_100;
		word32 edi_65;
		*ediOut = dwArg00;
		word32 esi_68;
		*esiOut = dwArg04;
		word32 ebx_71;
		*ebxOut = dwArg08;
		word32 ebp_74;
		*ebpOut = Mem0[ebp + 0x00:word32];
		return eax_100;
	}
	word32 edi_102 = eax_30 + 0x24;
l00401980:
	word32 ecx_116 = Mem0[edi_102 + 0x00:word32];
	word32 eax_118 = 0x00;
	if ((ecx_116 & 0x20000000) != 0x00)
	{
		eax_118 = (0x00 - (-(ecx_116 & 0x80000000) == 0x00) & 0x20) - ~0x1F;
		goto l004019CE;
	}
	word32 dwLoc1C_192;
	if (ecx_116 < 0x00)
		dwLoc1C_192 = 0x04;
	else
	{
		if ((ecx_116 & 0x40000000) == 0x00)
			goto l004019CE;
		dwLoc1C_192 = 0x02;
	}
	eax_118 = dwLoc1C_192;
l004019CE:
	if ((ecx_116 & 0x04000000) != 0x00)
		eax_118 = eax_118 | 0x0200;
	if (eax_118 != 0x00 && VirtualProtect(Mem0[(edi_102 - 0x18) + 0x00:word32] + dwArg04, Mem0[(edi_102 - 0x1C) + 0x00:word32], eax_118, fp - 0x0C) == 0x00)
	{
		eax_100 = 0x00;
		return eax_100;
	}
	word32 v18_146 = dwLoc08_109 + 0x01;
	dwLoc08_109 = v18_146;
	edi_102 = edi_102 + 0x28;
	if (v18_146 <u (word32) Mem0[esi_22 + 0x06:word16])
		goto l00401980;
	goto l00401A21;
}

// 00401A31: Register word32 fn00401A31(Register word32 esi, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C, Register out ptr32 ebpOut)
word32 fn00401A31(word32 esi, word32 dwArg04, word32 dwArg08, word32 dwArg0C, ptr32 & ebpOut)
{
	word32 esp_47;
	word32 eax_100;
	word32 eax_20 = VirtualAlloc(0x00, dwArg08, 0x3000, 0x40);
	word32 esp_30;
	word32 ebp_31;
	word32 edi_32;
	word32 eax_33;
	byte SCZO_34;
	byte Z_35;
	word32 esi_36;
	byte SZO_37;
	byte C_38;
	dwArg0C();
	if (eax_33 != ~0x00 && eax_33 == dwArg08)
	{
		Mem91[esp_30 - 0x04 + 0x00:word32] = 0x8000;
		Mem93[esp_30 - 0x08 + 0x00:word32] = 0x00;
		Mem96[esp_30 - 0x0C + 0x00:word32] = dwArg04;
		VirtualFree(Mem96[esp_30 - 0x0C + 0x00:LPVOID], Mem96[esp_30 - 0x08 + 0x00:SIZE_T], Mem96[esp_30 - 0x04 + 0x00:DWORD]);
		esp_47 = esp_30;
		eax_100 = edi_32;
	}
	else
	{
		Mem55[esp_30 - 0x04 + 0x00:word32] = esi_36;
		Mem58[esp_30 - 0x08 + 0x00:word32] = 0x8000;
		Mem60[esp_30 - 0x0C + 0x00:word32] = 0x00;
		Mem62[esp_30 - 0x10 + 0x00:word32] = edi_32;
		VirtualFree(Mem101[esp_30 - 0x10 + 0x00:LPVOID], Mem102[esp_30 - 0x0C + 0x00:SIZE_T], Mem103[esp_30 - 0x08 + 0x00:DWORD]);
		Mem75[esp_65 - 0x04 + 0x00:word32] = 0x8000;
		Mem77[esp_65 - 0x08 + 0x00:word32] = 0x00;
		Mem80[esp_65 - 0x0C + 0x00:word32] = dwArg04;
		VirtualFree(Mem80[esp_65 - 0x0C + 0x00:LPVOID], Mem80[esp_65 - 0x08 + 0x00:SIZE_T], Mem80[esp_65 - 0x04 + 0x00:DWORD]);
		eax_100 = 0x00;
		esp_47 = esp_65 + 0x04;
	}
	word32 ebp_51;
	*ebpOut = Mem0[esp_47 + 0x04:word32];
	return eax_100;
}

// 00401AA2: Register word32 fn00401AA2(Stack word32 dwArg04)
word32 fn00401AA2(word32 dwArg04)
{
	word32 eax_13;
	if (dwArg04 == 0x00)
		eax_13 = 0x00;
	else
		eax_13 = (uint32) ((uint64) (uint32) fn00401000() % dwArg04);
	return eax_13;
}

