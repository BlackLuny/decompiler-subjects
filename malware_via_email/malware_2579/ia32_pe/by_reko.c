// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: void fn00401000(Register (ptr Eq_2) ebx, Stack Eq_3 dwArg04)
void fn00401000(Eq_2 * ebx, Eq_3 dwArg04)
{
fn00401000_entry:
	*dwArg04 = globals->b405388
	Eq_10 eax_106 = 0x00
	byte * ecx_115 = dwArg04 + 0x01
	byte * ebp_122 = &globals->b405389
	word32 dwLoc7C_116 = 0x00
	word32 dwLoc78_243 = 0x00
	byte * dwLoc88_125 = dwArg04 + 0x01
	byte * dwLoc8C_114 = &globals->b405389
	uint32 edx_110 = dwLoc84
	goto l00401044
l00401000:
l00401040:
	eax_106 = dwLoc80_109
l00401044:
	Eq_10 dwLoc80_109 = eax_106 - 0x01
	branch eax_106 != 0x00 l00401068
l00401051:
	ebp_122 = ebp_122 + 0x01
	edx_110 = (word32) *ebp_122
	dwLoc8C_114 = ebp_122
	dwLoc80_109.u0 = 0x07
l00401068:
	edx_110 = edx_110 * 0x02
	branch (edx_110 >> 0x07 & 0x01) == 0x00 l0040129A
l0040107A:
	Eq_10 esi_132 = dwLoc80_109
	dwLoc80_109 = dwLoc80_109 - 0x01
	branch dwLoc80_109 != 0x00 l004010AC
l00401095:
	ebp_122 = ebp_122 + 0x01
	esi_132 = dwLoc80_109 - edx_110
	edx_110 = (word32) *ebp_122
	dwLoc8C_114 = ebp_122
	dwLoc80_109.u0 = 0x07
l004010AC:
	uint32 eax_146 = edx_110 >> 0x07
	uint32 edx_149 = edx_110 * 0x02
	branch (eax_146 & 0x01) == 0x00 l004011C0
l004010C2:
	dwLoc80_109 = dwLoc80_109 - 0x01
	branch dwLoc80_109 != 0x00 l004010EA
l004010D3:
	edx_149 = (word32) *ebp_122
	ebp_122 = ebp_122 + 0x01
	dwLoc80_109.u0 = 0x07
l004010EA:
	edx_110 = edx_149 * 0x02
	branch (edx_149 >> 0x07 & 0x01) == 0x00 l0040116D
l004010F8:
	ui32 edi_177 = 0x00
	word32 dwLoc7C_180 = 0x04
l00401102:
	dwLoc80_109 = dwLoc80_109 - 0x01
	branch dwLoc80_109 != 0x00 l00401126
l00401113:
	edx_110 = (word32) *ebp_122
	ebp_122 = ebp_122 + 0x01
	dwLoc80_109.u0 = 0x07
l00401126:
	word32 v16_206 = dwLoc7C_180 - 0x01
	edx_110 = edx_110 * 0x02
	dwLoc7C_180 = v16_206
	edi_177 = (edx_110 >> 0x07 & 0x01) + edi_177 * 0x02
	branch v16_206 != 0x00 l00401102
l0040113A:
	dwLoc8C_114 = ebp_122
	branch edi_177 == 0x00 l0040115A
l00401142:
	*ecx_115 = *(ecx_115 - edi_177)
	ecx_115 = ecx_115 + 0x01
	goto l004012AD
l0040115A:
	*ecx_115 = 0x00
	ecx_115 = ecx_115 + 0x01
	goto l004012AD
l0040116D:
	uint32 edi_233 = (word32) *ebp_122
	ebp_122 = ebp_122 + 0x01
	word32 esi_238 = (edi_233 & 0x01) + 0x02
	dwLoc8C_114 = ebp_122
	branch edi_233 >> 0x01 == 0x00 l004011AF
l00401187:
	branch esi_238 == 0x00 l004011B3
l00401190:
	*ecx_115 = *(ecx_115 - (edi_233 >> 0x01))
	ecx_115 = ecx_115 + 0x01
	esi_238 = esi_238 - 0x01
	branch esi_238 != 0x00 l00401190
l0040119E:
	dwLoc88_125 = ecx_115
	dwLoc74 = edi_233 >> 0x01
	dwLoc7C_116 = 0x01
	goto l004012B1
l004011AF:
	dwLoc78_243 = 0x01
l004011B3:
	dwLoc74 = edi_233 >> 0x01
	dwLoc7C_116 = 0x01
	goto l004012B1
l004011C0:
	ui32 eax_297
	Eq_10 eax_275 = fn004015C0(eax_146 & 0x01, esi_132, fp - 0x8C)
	branch dwLoc7C_116 != 0x00 l00401221
l004011D2:
	branch eax_275 != 0x02 l0040121C
l004011D7:
	Eq_10 eax_358 = fn004015C0(eax_275, fp - 0xA0, fp - 0x8C)
	ecx_115 = dwLoc88_125
	branch eax_358 == 0x00 l00401288
l004011F0:
	ecx_115 = ecx_115 + 0x01
	*(ecx_115 - 0x01) = *(ecx_115 - dwLoc74)
	eax_358 = eax_358 - 0x01
	branch eax_358 != 0x00 l004011F0
l00401203:
	edx_110 = edx_149
	ebp_122 = dwLoc8C_114
	dwLoc88_125 = ecx_115
	dwLoc7C_116 = 0x01
	goto l004012B1
l0040121C:
	eax_297 = eax_275 - 0x03
	goto l00401224
l00401221:
	eax_297 = eax_275 - 0x02
l00401224:
	Eq_10 eax_301 = (eax_297 << 0x08) + (word32) (*dwLoc8C_114)
	dwLoc8C_114 = dwLoc8C_114 + 0x01
	Eq_10 eax_307 = fn004015C0(eax_301, eax_301, fp - 0x8C)
	branch eax_301 < 0x7D00 l0040124D
l0040124A:
	eax_307 = (word32) eax_307 + 0x01
l0040124D:
	branch eax_301 < 0x0500 l00401258
l00401255:
	eax_307 = (word32) eax_307 + 0x01
l00401258:
	branch eax_301 >= 0x80 l00401263
l00401260:
	eax_307 = (word32) eax_307 + 0x02
l00401263:
	ecx_115 = dwLoc88_125
	branch eax_307 == 0x00 l00401284
l00401270:
	*ecx_115 = *(ecx_115 - eax_301)
	ecx_115 = ecx_115 + 0x01
	eax_307 = eax_307 - 0x01
	branch eax_307 != 0x00 l00401270
l00401280:
	dwLoc88_125 = ecx_115
l00401284:
	dwLoc74 = eax_301
l00401288:
	edx_110 = edx_149
	ebp_122 = dwLoc8C_114
	dwLoc7C_116 = 0x01
	goto l004012B1
l0040129A:
	*ecx_115 = *ebp_122
	ebp_122 = ebp_122 + 0x01
	ecx_115 = ecx_115 + 0x01
	dwLoc8C_114 = ebp_122
l004012AD:
	dwLoc7C_116 = 0x00
	dwLoc88_125 = ecx_115
l004012B1:
	branch dwLoc78_243 == 0x00 l00401040
l004012BD:
	return
fn00401000_exit:
}

// 00401480: Register Eq_273 fn00401480(Register Eq_273 eax, Register (ptr byte) edx, Register word32 ebx, Register word32 esi, Register word32 edi, Stack Eq_3 dwArg04, Stack word32 dwArg08, Register out ptr32 ecxOut, Register out ptr32 edxOut)
Eq_273 fn00401480(Eq_273 eax, byte * edx, word32 ebx, word32 esi, word32 edi, Eq_3 dwArg04, word32 dwArg08, ptr32 & ecxOut, ptr32 & edxOut)
{
	struct Eq_282 * edi_34 = dwArg04 + (&(dwArg04 + dwArg04->ptr003C / 0x0040)->ptr003C)[0x0F] / 0x0040;
	GetModuleHandleA(0x00);
	byte * ecx_130 = edx;
	word32 dwLoc0138_161 = 0x00;
	word32 eax_43[] = dwArg04 + edi_34->dw001C / 0x0040;
	struct Eq_332 * esi_44[] = dwArg04 + edi_34->dw0020 / 0x0040;
	int32 dwLoc013C_123 = 0x00;
	if (edi_34->dw0018 > 0x00)
	{
		do
		{
			struct Eq_332 * ecx_127 = esi_44[dwLoc013C_123];
			byte al_128 = Mem0[ecx_127 + dwArg04:byte];
			ecx_130 = ecx_127 + dwArg04;
			ui32 edx_131 = 0x00;
			if (al_128 != 0x00)
			{
				do
				{
					ecx_130 = ecx_130 + 0x01;
					edx_131 = __rol(edx_131, 0x03) ^ (int32) al_128;
					al_128 = *ecx_130;
				} while (al_128 != 0x00);
			}
			ui32 eax_140 = 0x7C;
			word32 ebx_142 = 0x0F;
			do
			{
				eax_140 = eax_140 + 0x05;
				ui32 dwLoc0130_150 = eax_140;
				if (eax_140 != 0x00)
				{
					eax_140 = 0x06;
					dwLoc0130_150 = 0x06;
				}
				ecx_130 = ecx_130 - dwLoc0130_150;
				ebx_142 = ebx_142 - 0x01;
			} while (ebx_142 != 0x00);
			if (edx_131 == dwArg08)
			{
				dwLoc0138_161 = 0x01;
				break;
			}
			int32 eax_169 = dwLoc013C_123 + 0x01;
			dwLoc013C_123 = eax_169;
		} while (eax_169 < edi_34->dw0018);
	}
	word32 ecx_60;
	word32 edx_61;
	word16 ebx_62[];
	fn00401980(ecx_130, out ecx_60, out edx_61, out ebx_62);
	if (dwLoc0138_161 != 0x00)
	{
		GetLastError();
		ui32 edx_106 = (word32) ebx_62[dwLoc013C_123];
		*edxOut = edx_106;
		word32 ecx_105;
		*ecxOut = dwLoc013C_123;
		return dwArg04 + eax_43[edx_106] / 0x0040;
	}
	else
		return 0x00;
}

// 004015C0: Register Eq_10 fn004015C0(Register Eq_10 eax, Register Eq_10 esi, Register (ptr Eq_86) edi)
Eq_10 fn004015C0(Eq_10 eax, Eq_10 esi, Eq_86 * edi)
{
	Eq_10 ebp_12 = 0x01;
	word32 ecx_20 = edi->dw000C;
	uint32 eax_21 = edi->dw0008;
	do
	{
		word32 ecx_30 = ecx_20 - 0x01;
		if (ecx_20 == 0x00)
		{
			byte * ecx_82 = edi->ptr0000;
			eax_21 = (word32) *ecx_82;
			edi->ptr0000 = ecx_82 + 0x01;
			ecx_30 = ecx_20 + 0x07;
		}
		ebp_12 = (eax_21 >> 0x07 & 0x01) + ebp_12 * 0x02;
		uint32 eax_44 = eax_21 * 0x02;
		ecx_20 = ecx_30 - 0x01;
		if (ecx_30 == 0x00)
		{
			byte * ecx_74 = edi->ptr0000;
			eax_44 = (word32) *ecx_74;
			edi->ptr0000 = ecx_74 + 0x01;
			ecx_20 = ecx_30 + 0x07;
		}
		eax_21 = eax_44 * 0x02;
	} while ((eax_44 >> 0x07 & 0x01) != 0x00);
	edi->dw0008 = eax_21;
	edi->dw000C = ecx_20;
	return ebp_12;
}

// 00401640: Register Eq_471 fn00401640(Register word32 ebx, Register ptr32 ebp, Register Eq_3 edi, Register out (ptr word32) ebpOut)
LCID fn00401640(word32 ebx, ptr32 ebp, Eq_3 edi, word32 * & ebpOut)
{
	__align(fp - 0x04);
	ui32 ecx_19 = 877;
	word32 edx_20 = 0x06;
	do
	{
		ecx_19 = ecx_19 << 0x04;
		if (ecx_19 == 0x00)
			ecx_19 = 0x09;
		edx_20 = edx_20 - 0x01;
	} while (edx_20 != 0x00);
	Eq_3 edi_37 = globals->t40537C;
	CloseHandle(0x00);
	word32 edi_51;
	fn00401DE0(ecx_19 ^ fp - 0x02F4, edx_20, 0x00, edi_37, out edi_51);
	GetThreadLocale();
	byte * edx_82;
	word32 esi_83;
	word32 edi_84;
	fn00401D70(fp - 0x02D8, fp - 0x02C0, 11, 0x00, edi, out edx_82, out esi_83, out edi_84);
	*(fp - 0x02F8) = fp - 0x02D8;
	Eq_273 eax_89 = LoadLibraryA(*(fp - 0x02F8));
	*(fp - 505) = *(fp - 505) ^ fp - 0x02F4;
	word32 ebx_96 = *(fp - 0x0206) + 11;
	*(fp - 0x02F8) = 3321835334;
	*(fp - 0x02FC) = (union Eq_273 *) eax_89;
	word32 ecx_104;
	word32 edx_105;
	<anonymous> * eax_106 = fn00401480(fp - 0x02F4, edx_82, ebx_96, esi_83, edi_84, dwArg00, dwArg04, out ecx_104, out edx_105);
	*(fp - 0x02F8) = fp - 0x02DC;
	*(fp - 0x02FC) = 0x40;
	*(fp - 0x0300) = 0x00052000;
	*(fp - 772) = edi_84;
	struct Eq_2 * esp_120;
	word32 ebp_121;
	byte SCZO_122;
	word32 ebx_123;
	word32 esi_124;
	word32 ecx_126;
	word32 edx_127;
	byte Z_128;
	word32 eax_129;
	byte SZO_130;
	byte C_131;
	byte al_132;
	byte bl_133;
	word16 si_134;
	byte S_135;
	struct Eq_640 * fs_136;
	union Eq_641 * edi_125;
	eax_106();
	esp_120->dw007B = (word32) GetLastError() + esp_120->dw007B;
	*(esp_120 - 0x04) = (union Eq_641 **) edi_125;
	fn00401000(esp_120, dwArg00);
	union Eq_641 * eax_148 = edi_125;
	word32 ecx_150 = 0x000147FF;
	do
	{
		*eax_148 = (union Eq_641 *) ((char *) *eax_148 + 0x00005C16);
		eax_148 = (union Eq_641 *) ((char *) eax_148 + 0x04);
		ecx_150 = ecx_150 - 0x01;
	} while (ecx_150 != 0x00);
	struct Eq_676 * ecx_161 = (struct Eq_676 *) 0x6B;
	word32 edx_162 = 11;
	do
	{
		ecx_161 = ecx_161 - 0x0A;
		esp_120->ptr002C = ecx_161;
		if (ecx_161 == null)
		{
			esp_120->ptr002C = (struct Eq_676 *) 0x06;
			ecx_161 = (struct Eq_676 *) 0x06;
		}
		edx_162 = edx_162 - 0x01;
	} while (edx_162 != 0x00);
	*(esp_120 - 0x04) = edx_162;
	GetModuleHandleA(*(esp_120 - 0x04));
	Eq_273 eax_182 = esp_120->t0030;
	word32 ebp_183 = Mem178[edi_125 + 0x3C:word32] + edi_125;
	ebp_183->w0016 = si_134;
	struct Eq_719 * esi_185 = ebp_183->ptr00A0;
	esp_120->ptr002C = ebp_183;
	ebp_183->t00C0 = eax_182;
	if (esi_185 != null)
	{
		esi_185 = esi_185 + Mem191[0x0040537C:word32];
		edi_125 = esp_120->ptr01B9;
		esp_120->dw018C = esp_120->dw018C & GetLastError();
		word32 edx_441 = globals->t40537C - ebp_183->dw0034;
		if (esi_185->dw0000 != 0x00)
		{
			do
			{
				Eq_787 eax_452 = esi_185[0x01];
				word16 * ecx_458 = esi_185 + 0x02;
				if (eax_452 - 0x08 >> 0x01 > 0x00)
				{
					edi_125 = eax_452 - 0x08 >> 0x01;
					do
					{
						ui32 eax_475 = (word32) *ecx_458;
						if ((eax_475 & 0xF000) == 0x3000)
						{
							word32 * eax_493 = (word32) globals->t40537C + ((eax_475 & 0x0FFF) + esi_185->dw0000);
							*eax_493 = *eax_493 + edx_441;
						}
						ecx_458 = ecx_458 + 0x01;
						edi_125 = edi_125 - 0x01;
					} while (edi_125 != null);
				}
				word32 esi_465 = esi_185 + Mem437[esi_185 + 0x04:word32];
				esi_185 = (struct Eq_719 *) (esi_465 + esi_465->dw0004 / 0x08);
			} while (esi_185->dw0000 != 0x00);
		}
	}
	if (ebp_183->dw0080 != 0x00)
	{
		*(esp_120 - 0x04) = 0x00;
		esp_120->dw01C5 = (word32) GetModuleHandleA(*(esp_120 - 0x04)) + esp_120->dw01C5;
		word32 esi_277 = esi_185 + edi_125;
		struct Eq_880 * ebp_279 = (word32) globals->t40537C + ebp_183->dw0080;
		*(esp_120 - 0x04) = 0x00;
		esp_120->dw01C5 = (word32) GetModuleHandleA(*(esp_120 - 0x04)) + esp_120->dw01C5;
		esi_185 = esi_277 + edi_125;
		struct Eq_911 * ebp_292 = (word32) globals->t40537C + ebp_279->dw0080;
		if (ebp_292->dw0010 != 0x00)
		{
			do
			{
				*(esp_120 - 0x04) = (word32) globals->t40537C + ebp_292->dw000C;
				Eq_273 eax_326 = LoadLibraryA(*(esp_120 - 0x04));
				esp_120->t0030 = eax_326;
				*(esp_120 - 0x04) = (word32) globals->t40537C + ebp_292->dw000C;
				Eq_273 eax_336 = LoadLibraryA(*(esp_120 - 0x04));
				esp_120->t0030 = eax_336;
				Eq_273 ecx_338 = eax_336;
				if (eax_336 != 0x00)
				{
					word32 edi_365 = ebp_292->dw0000;
					if (edi_365 == 0x00)
						edi_365 = ebp_292->dw0010;
					Eq_3 eax_370 = globals->t40537C;
					word32 * edi_372 = (word32) eax_370 + edi_365;
					esi_185 = (word32) eax_370 + ebp_292->dw0010;
					int32 eax_375 = *edi_372;
					if (eax_375 != 0x00)
					{
						while (true)
						{
							word32 eax_396;
							if (eax_375 < 0x00)
							{
								esp_120->dw0261 = esp_120->dw0261 + eax_375;
								esp_120->dw0276 = esp_120->dw0276 - eax_375;
								eax_396 = (word32) *edi_372;
							}
							else
								eax_396 = (word32) globals->t40537C + (eax_375 + 0x02);
							*(esp_120 - 0x04) = eax_396;
							*(esp_120 - 0x08) = (union Eq_273 *) ecx_338;
							esi_185->dw0000 = (int32) GetProcAddress(*(esp_120 - 0x08), *(esp_120 - 0x04));
							edi_372 = edi_372 + 0x01;
							eax_375 = *edi_372;
							esi_185 = esi_185 + 0x01;
							if (eax_375 == 0x00)
								break;
							ecx_338 = esp_120->t0030;
						}
					}
				}
				struct Eq_972 * ebp_356 = ebp_292 + 0x01;
				ebp_292 = (struct Eq_911 *) (&ebp_356->dw0010 + 0x01);
			} while (ebp_356->dw0024 != 0x00);
		}
		ebp_183 = esp_120->ptr002C;
	}
	<anonymous> * ecx_219 = (word32) globals->t40537C + ebp_183->dw0028;
	esp_120->ptr0014 = null;
	globals->ptr405384 = ecx_219;
	*(esp_120 - 0x04) = (struct Eq_719 **) esi_185;
	esp_120->ptr0014 = fs_136->ptr0030;
	struct Eq_849 * esi_232 = esp_120->ptr0014->ptr000C->ptr000C;
	do
		esi_232 = esi_232->ptr0000;
	while (esi_232->t0018 != globals->t40537C);
	Eq_471 eax_247 = GetThreadLocale();
	esi_232->ptr001C = globals->ptr405384;
	&esp_120->t0030.u0->unused = 0x00;
	word32 ecx_252 = 22;
	do
	{
		eax_247 = eax_247 - esp_120->t0030;
		ecx_252 = ecx_252 - 0x01;
	} while (ecx_252 != 0x00);
	word32 ebp_268;
	*ebpOut = *esp_120->ptr0008;
	return eax_247;
}

// 00401980: Register word32 fn00401980(Register (ptr byte) ecx, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebxOut)
word32 fn00401980(byte * ecx, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebxOut)
{
	CloseHandle(0x00);
	GetLastError();
	GetModuleHandleA(0x00);
	uint32 ecx_39 = 788;
	word32 edx_40 = 0x09;
	do
	{
		ecx_39 = ecx_39 >> 0x07;
		if (ecx_39 == 0x00)
			ecx_39 = 0x08;
		edx_40 = edx_40 - 0x01;
	} while (edx_40 != 0x00);
	Eq_273 eax_65 = GetModuleHandleA(*esp_57);
	word32 esp_75;
	word32 ebp_76;
	byte SCZO_77;
	<anonymous> * ebx_78;
	word32 esi_79;
	word32 edi_80;
	word32 eax_81;
	byte SZO_82;
	byte C_83;
	word32 ecx_84;
	word32 edx_85;
	byte Z_86;
	byte CZ_87;
	ebx_62();
	ptr32 esp_88;
	word32 ebp_89;
	byte SCZO_90;
	word32 ebx_91;
	<anonymous> * esi_92;
	word32 edi_93;
	word32 eax_94;
	byte SZO_95;
	byte C_96;
	word32 ecx_97;
	word32 edx_98;
	byte Z_99;
	byte CZ_100;
	ebx_78();
	uint32 ecx_101 = 0xBA;
	word32 edx_102 = 0x0A;
	do
	{
		ecx_101 = ecx_101 >> 0x01;
		if (ecx_101 == 0x00)
			ecx_101 = 0x00;
		edx_102 = edx_102 - 0x01;
	} while (edx_102 != 0x00);
	*(esp_88 - 0x04) = edx_102;
	ptr32 esp_125;
	word32 ebp_126;
	byte SCZO_127;
	word32 ebx_128;
	word32 esi_129;
	<anonymous> * edi_130;
	word32 eax_131;
	byte SZO_132;
	byte C_133;
	word32 ecx_134;
	word32 edx_135;
	byte Z_136;
	byte CZ_137;
	esi_92();
	word32 edx_140 = 0x30;
	do
		edx_140 = edx_140 - 0x01;
	while (edx_140 != 0x00);
	*(esp_125 - 0x04) = edx_140;
	ptr32 esp_170;
	word32 ebp_171;
	byte SCZO_172;
	word32 ebx_173;
	word32 esi_174;
	<anonymous> * edi_175;
	word32 eax_176;
	byte SZO_177;
	byte C_178;
	word32 ecx_179;
	word32 edx_180;
	byte Z_181;
	byte CZ_182;
	edi_130();
	*(esp_170 - 0x04) = 0x00;
	word32 esp_185;
	word32 ebp_186;
	byte SCZO_187;
	<anonymous> * ebx_188;
	word32 esi_189;
	word32 edi_190;
	word32 eax_191;
	byte SZO_192;
	byte C_193;
	word32 ecx_194;
	word32 edx_195;
	byte Z_196;
	byte CZ_197;
	edi_175();
	word32 eax_202 = 0x02;
	do
		eax_202 = eax_202 - 0x01;
	while (eax_202 != 0x00);
	ptr32 esp_217;
	word32 ebp_218;
	byte SCZO_219;
	word32 ebx_220;
	word32 esi_221;
	<anonymous> * edi_222;
	word32 eax_223;
	byte SZO_224;
	byte C_225;
	word32 ecx_226;
	word32 edx_227;
	byte Z_228;
	byte CZ_229;
	ebx_188();
	Eq_471 eax_239 = GetThreadLocale();
	*(esp_217 - 0x04) = 0x00;
	word32 esp_243;
	word32 ebp_244;
	byte SCZO_245;
	word32 ebx_246;
	<anonymous> * esi_247;
	word32 edi_248;
	word32 eax_249;
	byte SZO_250;
	byte C_251;
	word32 ecx_252;
	word32 edx_253;
	byte Z_254;
	byte CZ_255;
	edi_222();
	word32 ecx_267 = 0x08;
	do
		ecx_267 = ecx_267 - 0x01;
	while (ecx_267 != 0x00);
	ptr32 esp_275;
	word32 ebp_276;
	byte SCZO_277;
	word32 ebx_278;
	word32 esi_279;
	word32 edi_280;
	word32 eax_281;
	byte SZO_282;
	byte C_283;
	word32 ecx_284;
	word32 edx_285;
	byte Z_286;
	byte CZ_287;
	esi_247();
	GetLastError();
	*(esp_275 - 0x04) = 0x00;
	CloseHandle(*(esp_275 - 0x04));
	word32 ecx_307 = 0x14;
	do
		ecx_307 = ecx_307 - 0x01;
	while (ecx_307 != 0x00);
	*(esp_275 - 0x04) = ecx_307;
	GetModuleHandleA(*(esp_275 - 0x04));
	uint32 ecx_324 = 0x030F;
	word32 edi_325 = 0x09;
	do
	{
		uint32 edx_330 = SLICE(ecx_324 * 0x24924925, word32, 32);
		uint32 ecx_333 = (ecx_324 - edx_330 >> 0x01) + edx_330;
		ecx_324 = ecx_333 >> 0x02;
		if (ecx_333 >> 0x02 == 0x00)
			ecx_324 = 0x02;
		edi_325 = edi_325 - 0x01;
	} while (edi_325 != 0x00);
	GetThreadLocale();
	*(esp_275 - 0x04) = edi_325;
	CloseHandle(*(esp_275 - 0x04));
	*(esp_354 - 0x04) = edi_359;
	ptr32 esp_379;
	word32 ebp_380;
	byte SCZO_381;
	word32 ebx_382;
	<anonymous> * esi_383;
	word32 edi_384;
	word32 eax_385;
	byte SZO_386;
	byte C_387;
	word32 ecx_388;
	word32 edx_389;
	byte Z_390;
	byte CZ_391;
	esi_358();
	*(esp_379 - 0x04) = edi_384;
	ptr32 esp_394;
	word32 ebp_395;
	byte SCZO_396;
	word32 ebx_397;
	<anonymous> * esi_398;
	word32 edi_399;
	word32 eax_400;
	byte SZO_401;
	byte C_402;
	word32 ecx_403;
	word32 edx_404;
	byte Z_405;
	byte CZ_406;
	esi_383();
	uint32 ecx_411 = 0x024E;
	word32 edi_412 = 22;
	do
	{
		uint32 edx_417 = SLICE(ecx_411 * 0x24924925, word32, 32);
		uint32 ecx_420 = (ecx_411 - edx_417 >> 0x01) + edx_417;
		ecx_411 = ecx_420 >> 0x02;
		if (ecx_420 >> 0x02 != 0x00)
			ecx_411 = 0x05;
		edi_412 = edi_412 - 0x01;
	} while (edi_412 != 0x00);
	*(esp_394 - 0x04) = 0x00;
	GetModuleHandleA(*(esp_394 - 0x04));
	word32 eax_442 = 0x01CC;
	word32 edx_443 = 0x0E;
	do
	{
		eax_442 = eax_442 - 0x01;
		if (eax_442 != 0x00)
			eax_442 = 0x01;
		edx_443 = edx_443 - 0x01;
	} while (edx_443 != 0x00);
	GetThreadLocale();
	uint32 eax_462 = 900;
	word32 edx_463 = 0x0F;
	do
	{
		eax_462 = eax_462 >> 0x03;
		if (eax_462 == 0x00)
			eax_462 = 0x06;
		edx_463 = edx_463 - 0x01;
	} while (edx_463 != 0x00);
	*(esp_394 - 0x04) = edx_463;
	ptr32 esp_482;
	word32 ebp_483;
	byte SCZO_484;
	word32 ebx_485;
	word32 esi_486;
	<anonymous> * edi_487;
	word32 eax_488;
	byte SZO_489;
	byte C_490;
	word32 ecx_491;
	word32 edx_492;
	byte Z_493;
	byte CZ_494;
	esi_398();
	*(esp_482 - 0x04) = 0x00;
	ptr32 esp_510;
	word32 ebp_511;
	byte SCZO_512;
	word32 ebx_513;
	word32 esi_514;
	word32 edi_515;
	word32 eax_516;
	byte SZO_517;
	byte C_518;
	word32 ecx_519;
	word32 edx_520;
	byte Z_521;
	byte CZ_522;
	edi_487();
	word32 ecx_523 = 0x026A;
	word32 edx_524 = 0x0D;
	do
	{
		ecx_523 = ecx_523 + 0x08;
		if (ecx_523 == 0x00)
			ecx_523 = 0x01;
		edx_524 = edx_524 - 0x01;
	} while (edx_524 != 0x00);
	*(esp_510 - 0x04) = edx_524;
	CloseHandle(*(esp_510 - 0x04));
	GetThreadLocale();
	word32 ecx_561 = 0x0160;
	word32 edx_562 = 0x09;
	do
	{
		ecx_561 = ecx_561 - 0x06;
		if (ecx_561 == 0x00)
			ecx_561 = 0x01;
		edx_562 = edx_562 - 0x01;
	} while (edx_562 != 0x00);
	*(esp_510 - 0x04) = edx_562;
	GetModuleHandleA(*(esp_510 - 0x04));
	*(esp_510 - 0x04) = 0x00;
	GetModuleHandleA(*(esp_510 - 0x04));
	word32 edx_594 = 0x02;
	do
		edx_594 = edx_594 - 0x01;
	while (edx_594 != 0x00);
	GetLastError();
	word32 edx_621 = 0x0F;
	ui32 ecx_623 = 0x0168;
	do
	{
		ui32 ecx_628 = ecx_623 * 0x05;
		ecx_623 = ecx_628 * 0x02;
		if (ecx_628 * 0x02 == 0x00)
			ecx_623 = 0x0A;
		edx_621 = edx_621 - 0x01;
	} while (edx_621 != 0x00);
	GetThreadLocale();
	word32 ecx_643 = 0x09;
	do
		ecx_643 = ecx_643 - 0x01;
	while (ecx_643 != 0x00);
	*(esp_510 - 0x04) = ecx_643;
	GetModuleHandleA(*(esp_510 - 0x04));
	ptr32 esp_672;
	word32 ebp_673;
	byte SCZO_674;
	word32 ebx_675;
	<anonymous> * esi_676;
	word32 edi_677;
	word32 eax_678;
	byte SZO_679;
	byte C_680;
	word32 ecx_681;
	word32 edx_682;
	byte Z_683;
	byte CZ_684;
	ebx_661();
	*(esp_672 - 0x04) = 0x00;
	CloseHandle(*(esp_672 - 0x04));
	*(esp_672 - 0x04) = 0x00;
	CloseHandle(*(esp_672 - 0x04));
	GetThreadLocale();
	ui32 ecx_717 = 0x0204;
	word32 edx_718 = 0x1D;
	do
	{
		ecx_717 = ecx_717 * 0x02 * 0x02 * 0x02;
		if (ecx_717 == 0x00)
			ecx_717 = 0x08;
		edx_718 = edx_718 - 0x01;
	} while (edx_718 != 0x00);
	*(esp_672 - 0x04) = edx_718;
	struct Eq_1693 * esp_739;
	word32 ebp_740;
	byte SCZO_741;
	word32 ebx_742;
	word32 esi_743;
	word32 edi_744;
	word32 eax_745;
	byte SZO_746;
	byte C_747;
	word32 ecx_748;
	word32 edx_749;
	byte Z_750;
	byte CZ_751;
	esi_676();
	word32 ebx_756;
	*ebxOut = esp_739->dw0008;
	return eax_745;
}

// 00401D70: Register (ptr byte) fn00401D70(Register (ptr byte) eax, Register (ptr byte) ecx, Register word32 ebx, Stack ptr32 dwArg00, Stack Eq_3 dwArg04, Register out ptr32 edxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
byte * fn00401D70(byte * eax, byte * ecx, word32 ebx, ptr32 dwArg00, Eq_3 dwArg04, ptr32 & edxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	*edxOut = edx;
	byte * esi_10 = ecx;
	byte * edi_12 = eax;
	cu8 al_14 = *ecx;
	if (al_14 != 0x00)
	{
		do
		{
			ui8 al_101;
			cu8 cl_64 = al_14 - 0x41;
			ecx = DPB(ecx, cl_64, 0);
			if (cl_64 <= 0x19)
			{
				int32 edx_95 = (int32) ((int64) ((int32) al_14 - 0x41 + ebx) % 0x1A);
				byte dl_96 = (byte) edx_95;
				ecx = (byte *) 0x1A;
				*edxOut = DPB(edx_95, dl_96 + 0x41, 0);
				al_101 = dl_96 + 0x41;
			}
			else if (al_14 <= 122)
			{
				int32 edx_115 = (int32) ((int64) ((int32) al_14 - 0x61 + ebx) % 0x1A);
				byte dl_116 = (byte) edx_115;
				ecx = (byte *) 0x1A;
				*edxOut = DPB(edx_115, dl_116 + 0x61, 0);
				al_101 = dl_116 + 0x61;
			}
			else
			{
				byte dl_126 = 0x1A - bl;
				*edxOut = DPB(edx, dl_126, 0);
				al_101 = al_14 ^ dl_126;
			}
			*edi_12 = al_101;
			esi_10 = esi_10 + 0x01;
			al_14 = *esi_10;
			edi_12 = edi_12 + 0x01;
		} while (al_14 != 0x00);
	}
	return ecx;
	word32 edi_42;
	*ediOut = dwArg00;
	word32 esi_45;
	*esiOut = dwArg04;
	return ecx;
}

// 00401DE0: Register word32 fn00401DE0(Register ui32 ecx, Register word32 edx, Register word32 ebx, Register Eq_3 edi, Register out ptr32 ediOut)
word32 fn00401DE0(ui32 ecx, word32 edx, word32 ebx, Eq_3 edi, ptr32 & ediOut)
{
	word32 ebx_114;
	GetModuleHandleA(0x00);
	GetThreadLocale();
	GetLastError();
	word32 edx_66;
	word32 esi_67;
	word32 edi_68;
	fn00401D70(fp - 0x18, fp - 88, 0x13, 0x00, edi, out edx_66, out esi_67, out edi_68);
	Eq_273 eax_73 = LoadLibraryA(fp - 0x18);
	GetLastError();
	Eq_1073 eax_92 = GetProcAddress(eax_73, 202);
	CloseHandle(0x00);
	CloseHandle(0x00);
	<anonymous> * eax_117 = eax_92();
	ptr32 esp_111 = fp - 0x02E4;
	if (eax_117 == null)
	{
		word32 ebp_290;
		byte SCZO_291;
		word32 esi_293;
		word32 edi_294;
		word32 eax_295;
		byte SZO_296;
		byte C_297;
		word32 edx_298;
		word32 ecx_299;
		byte al_300;
		byte Z_301;
		word16 di_302;
		eax_117();
	}
	union Eq_3 * esp_131 = esp_111 - 0x04;
	*esp_131 = (union Eq_3 *) 0x00;
	GetModuleHandleA(*esp_131);
	*esp_131 = (union Eq_3 *) 0xA7;
	*(esp_131 - 0x04) = ebx_114;
	GetProcAddress(*(esp_131 - 0x04), *esp_131);
	GetLastError();
	GetThreadLocale();
	*esp_131 = (union Eq_3 *) (fp - 0x28);
	*(esp_131 - 0x04) = fp - 0x38;
	*(esp_131 - 0x08) = fp - 0x48;
	word32 ebp_168;
	byte SCZO_169;
	word32 ebx_170;
	<anonymous> * esi_171;
	word32 edi_172;
	<anonymous> * eax_173;
	byte SZO_174;
	byte C_175;
	word32 edx_176;
	word32 ecx_177;
	byte al_178;
	byte Z_179;
	word16 di_180;
	word32 esp_167;
	OLEAUT32.dll!Ordinal_318();
	if ((fp - 0x48 & fp - 0x48) != 0x00)
	{
		word32 ebp_274;
		byte SCZO_275;
		word32 ebx_276;
		word32 esi_277;
		word32 edi_278;
		word32 eax_279;
		byte SZO_280;
		byte C_281;
		word32 edx_282;
		word32 ecx_283;
		byte al_284;
		byte Z_285;
		word16 di_286;
		eax_173();
	}
	union Eq_1926 * esp_186 = esp_167 - 0x04;
	*esp_186 = (union Eq_1926 *) (fp - 0x28);
	*(esp_186 - 0x04) = (union Eq_1931 *) (fp - 0x38);
	*(esp_186 - 0x08) = (union Eq_1938 *) (fp - 0x48);
	word32 ebp_195;
	byte SCZO_196;
	word32 ebx_197;
	word32 esi_198;
	word32 edi_199;
	byte SZO_201;
	byte C_202;
	word32 edx_203;
	word32 ecx_204;
	byte al_205;
	byte Z_206;
	<anonymous> * eax_200;
	word16 di_207;
	struct Eq_1957 * esp_194;
	esi_171();
	if (eax_200 != null)
	{
		word32 ebp_260;
		byte SCZO_261;
		word32 ebx_262;
		word32 esi_263;
		word32 edi_264;
		byte SZO_266;
		byte C_267;
		word32 edx_268;
		word32 ecx_269;
		byte al_270;
		byte Z_271;
		eax_200();
	}
	if (wLoc28 != di_207)
	{
		word32 ebp_246;
		byte SCZO_247;
		word32 ebx_248;
		word32 esi_249;
		word32 edi_250;
		word32 eax_251;
		byte SZO_252;
		byte C_253;
		word32 edx_254;
		word32 ecx_255;
		byte al_256;
		byte Z_257;
		word16 di_258;
		eax_200();
	}
	word32 edi_235;
	*ediOut = esp_194->dw0000;
	return esp_194->dw0004;
}

// 00401F50: Register Eq_3 Win32CrtStartup()
Eq_3 Win32CrtStartup()
{
	word32 * ebp_5 = fp - 0x04;
	uint32 ecx_11 = 0x01E5;
	word32 edx_12 = 0x10;
	do
	{
		ecx_11 = ecx_11 >> 0x07;
		if (ecx_11 == 0x00)
			ecx_11 = 0x04;
		edx_12 = edx_12 - 0x01;
	} while (edx_12 != 0x00);
	word32 eax_27 = 400;
	word32 edx_28 = 0x03;
	do
	{
		eax_27 = eax_27 - 0x04;
		if (eax_27 != 0x00)
			eax_27 = 0x00;
		edx_28 = edx_28 - 0x01;
	} while (edx_28 != 0x00);
	word32 ebx_50;
	Eq_3 edi_51;
	if (fn00401FC0(ebx, fp - 0x04, edi, out ebx_50, out edi_51) != 0x00)
		fn00401640(ebx_50, fp - 0x04, edi_51, out ebp_5);
	*ebp_5 = 0x00;
	word32 esp_68;
	word32 ebp_69;
	word32 ecx_70;
	word32 edx_71;
	byte SCZO_72;
	byte Z_73;
	Eq_3 eax_74;
	byte SZO_75;
	byte C_76;
	word32 ebx_77;
	word32 edi_78;
	globals->ptr405384();
	return eax_74;
}

// 00401FC0: Register word32 fn00401FC0(Register word32 ebx, Register ptr32 ebp, Register word32 edi, Register out ptr32 ebxOut, Register out ptr32 ediOut)
word32 fn00401FC0(word32 ebx, ptr32 ebp, word32 edi, ptr32 & ebxOut, ptr32 & ediOut)
{
	word32 ebp_32;
	byte SCZO_33;
	word32 esi_35;
	<anonymous> * eax_36;
	word16 ax_38;
	byte SZO_41;
	byte C_42;
	byte Z_43;
	byte CZ_44;
	byte dl_45;
	ui32 ecx_321;
	word32 edx_322;
	Eq_3 edi_319;
	word32 ebx_316;
	struct Eq_2092 * esp_31;
	OLEAUT32.dll!Ordinal_318();
	if ((fp - 0x44 & fp - 0x44) != 0x00)
	{
		word32 ebp_314;
		byte SCZO_315;
		word32 esi_317;
		word32 eax_318;
		word16 ax_320;
		byte SZO_323;
		byte C_324;
		byte Z_325;
		byte CZ_326;
		byte dl_327;
		eax_36();
	}
	if (globals->dw405378 == 0x00)
	{
		globals->dw405378 = 0x01;
		struct Eq_2118 * esp_100 = esp_31 - 0x04;
		esp_100->t0000.u0 = 4202432;
		word32 edi_102;
		fn00401DE0(ecx_321, edx_322, ebx_316, edi_319, out edi_102);
		globals->t40537C = esp_100->t0000;
		globals->t40537C.u0 = 0x00;
		Eq_3 eax_108 = globals->t40537C;
		struct Eq_2140 * ecx_109 = *((word32) eax_108 + 0x003C);
		word32 esi_110 = Mem107[ecx_109 + 0x50 + eax_108:word32];
		esp_100->t0000.u0 = 0x40;
		*(esp_100 - 0x04) = 0x1000;
		*(esp_100 - 0x08) = esi_110;
		*(esp_100 - 0x0C) = 0x00;
		Eq_2170 eax_122 = VirtualAlloc(*(esp_100 - 0x0C), *(esp_100 - 0x08), *(esp_100 - 0x04), esp_100->t0000);
		globals->t405380 = eax_122;
		word32 ecx_113 = ecx_109 + eax_108;
		struct Eq_2199 * ebx_121 = &globals->dw403038;
		if (true)
		{
			Eq_2170 ecx_302 = eax_122;
			int32 edi_303 = globals->t40537C - eax_122;
			do
			{
				*ecx_302 = *((word32) ecx_302 + edi_303);
				ecx_302 = ecx_302 + 0x01;
				esi_110 = esi_110 - 0x01;
			} while (esi_110 != 0x00);
		}
		Eq_2213 eax_132 = eax_122 - globals->t40537C;
		if (globals->dw403038 != 0x00)
		{
			do
			{
				word32 edx_241 = 0x17;
				do
					edx_241 = edx_241 - 0x01;
				while (edx_241 != 0x00);
				uint32 eax_260 = ebx_121->t0004 - 0x08 >> 0x01;
				word16 * ecx_264 = (char *) &ebx_121->t0004 + 0x04;
				if (eax_260 != 0x00)
				{
					uint32 edx_274 = eax_260;
					do
					{
						ui32 eax_280 = (word32) *ecx_264;
						if ((eax_280 & 0xF000) == 0x3000)
						{
							word32 * eax_296 = (word32) globals->t405380 + (eax_280 & 0x0FFF) + ebx_121->dw0000;
							*eax_296 = (char *) eax_132 + *eax_296;
						}
						ecx_264 = ecx_264 + 0x01;
						edx_274 = edx_274 - 0x01;
					} while (edx_274 != 0x00);
				}
				ebx_121 = ebx_121 + Mem128[ebx_121 + 0x04:word32];
			} while (ebx_121->dw0000 != 0x00);
		}
		esp_100->t0000.u0 = 0x00;
		CloseHandle(esp_100->t0000);
		byte * edx_154;
		word32 esi_155;
		word32 edi_156;
		fn00401D70(fp - 0x10, &globals->b42A8B8, 0x10, ebp, dwArg00, out edx_154, out esi_155, out edi_156);
		esp_100->t0000 = fp - (byte *) 0x10;
		Eq_273 eax_161 = LoadLibraryA(esp_100->t0000);
		esp_100->t0000.u0 = 35392525;
		*(esp_100 - 0x04) = (union Eq_273 *) eax_161;
		word32 ecx_168;
		word32 edx_169;
		esp_100->t0000.u0 = 0x00;
		CloseHandle(esp_100->t0000);
		byte * edx_185;
		word32 esi_186;
		word32 edi_187;
		fn00401D70(fp - (byte *) 0x10, &globals->b42A8B8, 0x10, ebp, dwArg00, out edx_185, out esi_186, out edi_187);
		esp_100->t0000 = fp - (byte *) 0x10;
		Eq_273 eax_192 = LoadLibraryA(esp_100->t0000);
		esp_100->t0000.u0 = 35392525;
		*(esp_100 - 0x04) = (union Eq_273 *) eax_192;
		word32 ecx_198;
		word32 edx_199;
		if (fn00401480(eax_192, edx_185, 0x10, esi_186, edi_187, dwArg00, dwArg04, out ecx_198, out edx_199) == null)
		{
			globals->ptr405384 = (word32) globals->t405380 + ecx_113->dw0028;
			globals->ptr405384 = (word32) globals->t405380 + ecx_113->dw0028;
		}
		word32 edi_210;
		*ediOut = esp_100->dw0004;
		word32 ebx_218;
		*ebxOut = esp_100->dw000C;
		return 0x00;
	}
	else
	{
		word32 edi_87;
		*ediOut = esp_31->dw0000;
		word32 ebx_91;
		*ebxOut = esp_31->dw0008;
		return 0x01;
	}
}

