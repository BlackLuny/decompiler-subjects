// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1220/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn004010DD(word32 eax, word32 ebx, word32 ebp, word32 esi, word32 edi, word16 cx, selector fs, word32 dwArg00)
{
fn004010DD_entry:
l004010DD:
l004010F5:
	word32 edi_23 = ~(edi + 0x00000001)
	word32 esi_5 = DPB(esi, si - 0x0031, 0, 16)
	word32 edx_14 = dwArg00 + 0x00000007
	word32 ecx_22 = DPB(0x000000A5, 0xA5 - Mem0[dwArg00 + 0x00000007:byte], 0, 8)
	word16 di_24 = (word16) edi_23
	branch ecx_22 == 0x00000015 l00401145
l00401116:
	word32 eax_196 = RegOpenKeyA(0x3A3DFDDF, ecx_22, 0x2FDED383) ^ ebp
	byte al_197 = (byte) eax_196
	Mem205[eax_196 + 0x00000000:byte] = Mem0[eax_196 + 0x00000000:byte] + al_197
	Mem207[eax_196 + 0x00000000:byte] = Mem205[eax_196 + 0x00000000:byte] + al_197
	Mem209[eax_196 + 0x00000000:byte] = Mem207[eax_196 + 0x00000000:byte] + al_197
	Mem211[eax_196 + 0x00000000:byte] = Mem209[eax_196 + 0x00000000:byte] + al_197
	Mem213[eax_196 + 0x00000000:byte] = Mem211[eax_196 + 0x00000000:byte] + al_197
	byte v25_215 = Mem213[edi_23 + 0x00000000:byte] + bh
	Mem216[edi_23 + 0x00000000:byte] = v25_215
	edx_14 = DPB(dwArg00 + 0x00000007, 0x00, 0, 8) (alias)
	branch v25_215 != 0x00 l00401140
l00401140:
	Mem220[edx_14 + 0xC1A1002C:word32] = Mem216[edx_14 + 0xC1A1002C:word32] - ebx
	goto l00401146
l00401145:
	goto l00401148
l00401146:
	Mem223[esi_5 - 0x00000001:byte] = Mem220[esi_5 - 0x00000001:byte] - 0x01
l00401148:
	__ror(di_24, 0x03)
	__ror((word16) (edx_14 ^ 0xD50254C5), 0x0A)
	word32 esi_45 = Mem0[DPB(0x0012AA9F, (word16) fp, 0, 16):word32]
	word32 edi_48 = 0x004010A8
	word32 eax_50 = fp + 0x00000001 & 0xE1316335
	word32 edx_55 = Mem0[0x004010D4:word32]
l00401173:
	esi_45 = esi_45 + 0x00000001
	eax_50 = eax_50 >> 0x0000001B
	edi_48 = edi_48 + ebx - esi_45 + eax_50
	word16 di_74 = (word16) edi_48
	branch ~Mem0[esi_45 + 0x00000000:word32] + edx_55 != 0x00000001 l00401173
l00401188:
	word32 edx_91 = DPB(edx_55 + dwArg00, Mem0[esi_45 + 0xFFFFFFFE:word16], 0, 16)
	__rol(di_74 + 0x0062, 0x0C)
	word32 esi_108 = Mem0[0x00401031:word32]
	word32 eax_102 = dwArg00
	word16 si_109 = (word16) esi_108
l004011C3:
	eax_102 = eax_230 + 0x00000001
	word32 eax_230 = eax_102
	branch (Mem0[eax_230 + 0x00000000:word32] ^ esi_108) != 0x00000000 l004011C3
l004011D8:
	__ror(~DPB(esi_108, si_109 - 0x002F, 0, 16), 0x15)
	word32 edx_150 = edx_91 << 0x00000010 >>u 0x00000010
	Mem158[fp - 0x00000004:word32] = edx_150 + 0x003FBC53
	__rol((word16) (edx_150 + 0x003FBC53), 0x09)
	Mem171[fp - 0x0000000C:word32] = fp - 0x0000000C
	Mem175[fs:0x00000000:word32] = 0x3A3DFDDF
	Mem178[fp - 0x0000000C:word32] = 0x00000000
	return
fn004010DD_exit:
}

