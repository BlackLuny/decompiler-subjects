Using options:
00405C3D: warning: Unable to resolve imported reference SHLWAPI.dll!StrSpnA.
00405F6B: warning: Unable to resolve imported reference SHLWAPI.dll!PathMakePrettyW.
004061D5: warning: Multiple different values of stack delta in procedure fn00405C2A when processing RET instruction; was 8 previously.
l00404F94: error: An error occurred while rewriting at linear address 404F94.
    The given key was not present in the dictionary.
       at System.Collections.Generic.Dictionary`2.get_Item(TKey key)
   at Decompiler.Analysis.ExpressionPropagator.GetStackDepthBeforeCall()
   at Decompiler.Analysis.ExpressionPropagator.VisitCallInstruction(CallInstruction ci)
   at Decompiler.Core.Code.CallInstruction.Accept[T](InstructionVisitor`1 visitor)
   at Decompiler.Analysis.TrashedRegisterFinder.RewriteBlock(Block block)
l00404F94: error: An error occurred while rewriting at linear address 404F94.
    The given key was not present in the dictionary.
       at System.Collections.Generic.Dictionary`2.get_Item(TKey key)
   at Decompiler.Analysis.ExpressionPropagator.GetStackDepthBeforeCall()
   at Decompiler.Analysis.ExpressionPropagator.VisitCallInstruction(CallInstruction ci)
   at Decompiler.Core.Code.CallInstruction.Accept[T](InstructionVisitor`1 visitor)
   at Decompiler.Analysis.TrashedRegisterFinder.RewriteBlock(Block block)
fn00404AA0: error: An error occurred during data flow analysis.
    The method or operation is not implemented.
       at Decompiler.Core.Operators.GtOperator.ApplyConstants(Constant c1, Constant c2)
   at Decompiler.Evaluation.ExpressionSimplifier.VisitBinaryExpression(BinaryExpression binExp)
   at Decompiler.Core.Expressions.BinaryExpression.Accept[T](ExpressionVisitor`1 v)
   at Decompiler.Analysis.ValuePropagator.VisitBranch(Branch b)
   at Decompiler.Core.Code.Branch.Accept[T](InstructionVisitor`1 visitor)
   at Decompiler.Analysis.ValuePropagator.Transform(Statement stm)
   at Decompiler.Analysis.ValuePropagator.Transform()
   at Decompiler.Analysis.DataFlowAnalysis.BuildExpressionTrees()
fn00404EC0: error: An error occurred during data flow analysis.
    The given key was not present in the dictionary.
       at System.Collections.Generic.Dictionary`2.get_Item(TKey key)
   at Decompiler.Core.Lib.DominatorGraph`1.BuildDominanceFrontiers(DirectedGraph`1 graph, Dictionary`2 idoms)
   at Decompiler.Core.Lib.DominatorGraph`1..ctor(DirectedGraph`1 graph, T entryNode)
   at Decompiler.Analysis.DataFlowAnalysis.BuildExpressionTrees()
fn00405C2A: error: An error occurred during data flow analysis.
    The given key was not present in the dictionary.
       at System.Collections.Generic.Dictionary`2.get_Item(TKey key)
   at Decompiler.Core.Lib.DominatorGraph`1.BuildDominanceFrontiers(DirectedGraph`1 graph, Dictionary`2 idoms)
   at Decompiler.Core.Lib.DominatorGraph`1..ctor(DirectedGraph`1 graph, T entryNode)
   at Decompiler.Analysis.DataFlowAnalysis.BuildExpressionTrees()
: error: Error when reconstructing types.
    Invalid pointer size.
Parameter name: byteSize
       at Decompiler.Core.Types.Pointer..ctor(DataType pointee, Int32 byteSize)
   at Decompiler.Typing.DataTypeBuilder.MemoryAccessCommon(Expression tBase, Expression tStruct, Int32 offset, DataType tField, Int32 structPtrSize)
   at Decompiler.Typing.DataTypeBuilder.MemAccessTrait(Expression tBase, Expression tStruct, Int32 structPtrSize, Expression tField, Int32 offset)
   at Decompiler.Typing.TraitCollector.VisitDereference(Dereference deref)
   at Decompiler.Core.Expressions.Dereference.Accept[T](ExpressionVisitor`1 v)
   at Decompiler.Typing.TraitCollector.VisitStore(Store store)
   at Decompiler.Core.Code.Store.Accept[T](InstructionVisitor`1 visitor)
   at Decompiler.Typing.TraitCollector.CollectProgramTraits(Program prog)
   at Decompiler.Typing.TypeAnalyzer.RewriteProgram(Program prog)
   at Decompiler.DecompilerDriver.ReconstructTypes()
rewriting: void ?qznlacy@@YGXPAI@Z()
rewriting: void ?x_gYC_SVW_BZcpszCXd@@YGJPA_N@Z()
rewriting: void ?_MP__ipwIML_WGzqh_@@YGXJPAJ@Z(Register word32 ecx, Register word32 ebx, Register word32 esi)
rewriting: void ?RTXjyh_h_o_t_hET_Z@@YGPADPAH@Z()
rewriting: void ?gri__vazkAELP__nI___Z@@YGFF@Z()
rewriting: void ?WWcb_tysgYEF@@YGHE@Z()
rewriting: void ?_sotycly_kwgceopzn_crf@@YGPAIPAF@Z(Register word32 ecx)
rewriting: void ?___P___U_VBXU_VKy@@YGFPAJJ@Z()
rewriting: void fn00403AD0(Register word32 eax)
rewriting: void ?hb___hg_NVCNBjqh@@YGPAXD@Z(Register word32 edx)
rewriting: void ?zrFTwfs_lb@@YGPAKG@Z(Register word32 ecx, Register word32 esi)
rewriting: void ?_g_a_n_jm_q_sx@@YGGKF@Z(Register word32 eax)
rewriting: Register word32 fn00403BC3()
rewriting: Register word32 fn00403DE3(Register word32 edi, Stack word32 dwArg04, Stack byte bArg07, Stack word32 dwArg08)
rewriting: void fn00403FB9(Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C)
fn00403FB9: error: An error occurred while rewriting procedure to high-level language.
    Index was out of range. Must be non-negative and less than the size of the collection.
Parameter name: index
       at System.ThrowHelper.ThrowArgumentOutOfRangeException()
   at Decompiler.Structure.CompoundConditionCoalescer.MaybeCoalesce(Block block)
   at Decompiler.Structure.CompoundConditionCoalescer.Transform()
   at Decompiler.Structure.StructureAnalysis.Structure()
   at Decompiler.DecompilerDriver.StructureProgram()
rewriting: Register word32 fn0040417E(Register word32 ebp, Register word32 esi, Register word32 edi, Stack word32 dwArg00)
fn0040417E: error: An error occurred while rewriting procedure to high-level language.
    Unable to cast object of type 'Decompiler.Core.Code.ReturnInstruction' to type 'Decompiler.Core.Code.Branch'.
       at Decompiler.Structure.AbsynCodeGenerator.BranchCondition(StructureNode node)
   at Decompiler.Structure.IfConditional.GenerateCode(AbsynCodeGenerator codeGen, StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(ProcedureStructure proc, List`1 stms)
   at Decompiler.Structure.StructureAnalysis.GenerateStructuredCode()
   at Decompiler.Structure.StructureAnalysis.Structure()
   at Decompiler.DecompilerDriver.StructureProgram()
rewriting: Register word32 fn0040422E(Register word32 ebx, Register word32 esi, Register word32 edi, Register out ptr32 ecxOut, Register out ptr32 edxOut)
rewriting: Register word32 fn004042D0(Register word32 esi, Register out ptr32 esiOut)
fn004042D0: error: An error occurred while rewriting procedure to high-level language.
    Expression of type ConstantUInt32 doesn't support Invert.
       at Decompiler.Core.Expressions.Expression.Invert()
   at Decompiler.Structure.IfConditional.EmitIfCondition(Expression exp, Conditional cond, AbsynStatementEmitter emitter)
   at Decompiler.Structure.IfConditional.GenerateCode(AbsynCodeGenerator codeGen, StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(ProcedureStructure proc, List`1 stms)
   at Decompiler.Structure.StructureAnalysis.GenerateStructuredCode()
   at Decompiler.Structure.StructureAnalysis.Structure()
   at Decompiler.DecompilerDriver.StructureProgram()
rewriting: FlagGroup byte fn004043E1()
rewriting: Register word32 fn00404505(Register word32 ebp, Register word32 esi, Stack word32 dwArg08, Stack word32 dwArg0C, Stack word32 dwArg10, Register out ptr32 ediOut)
rewriting: void fn00404673(Register word32 ebp, Register word32 edi, Stack word32 dwArg04, Stack word32 dwArg08)
rewriting: Register word32 fn00404AA0(Register word32 ebp, Register word32 esi, Stack word32 dwArg00, Stack word32 dwArg04, Stack word32 dwArg08, Register out ptr32 esiOut)
fn00404AA0: error: An error occurred while rewriting procedure to high-level language.
    Unable to cast object of type 'Decompiler.Core.Code.ReturnInstruction' to type 'Decompiler.Core.Code.Branch'.
       at Decompiler.Structure.AbsynCodeGenerator.BranchCondition(StructureNode node)
   at Decompiler.Structure.IfConditional.GenerateCode(AbsynCodeGenerator codeGen, StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.IfConditional.GenerateCode(AbsynCodeGenerator codeGen, StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.IfConditional.GenerateCode(AbsynCodeGenerator codeGen, StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(ProcedureStructure proc, List`1 stms)
   at Decompiler.Structure.StructureAnalysis.GenerateStructuredCode()
   at Decompiler.Structure.StructureAnalysis.Structure()
   at Decompiler.DecompilerDriver.StructureProgram()
rewriting: void fn00404EC0()
rewriting: void fn004050E5(Register word32 ecx, Register word32 ebx, Register word32 esi, Register word32 edi)
rewriting: Register word32 fn004052AC(Register word32 ebx, Register word32 esi, Register word32 edi, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
rewriting: Register word32 fn004053C3(Register word32 ebx, Register word32 esi, Register word32 edi, Register out ptr32 ebxOut, Register out ptr32 esiOut)
fn004053C3: error: An error occurred while rewriting procedure to high-level language.
    Expression of type ConstantUInt32 doesn't support Invert.
       at Decompiler.Core.Expressions.Expression.Invert()
   at Decompiler.Structure.IfConditional.EmitIfCondition(Expression exp, Conditional cond, AbsynStatementEmitter emitter)
   at Decompiler.Structure.IfConditional.GenerateCode(AbsynCodeGenerator codeGen, StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(ProcedureStructure proc, List`1 stms)
   at Decompiler.Structure.StructureAnalysis.GenerateStructuredCode()
   at Decompiler.Structure.StructureAnalysis.Structure()
   at Decompiler.DecompilerDriver.StructureProgram()
rewriting: void fn004054E3(Register word32 ecx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi)
rewriting: Register word32 fn004059DC(Register word32 esi, Register word32 edi, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C, Stack word32 dwArg10, Stack word32 dwArg14, Stack word32 dwArg18, Stack word32 dwArg1C, Stack word32 dwArg20, Register out ptr32 ecxOut)
rewriting: void fn00405C2A(Register word32 eax, Register word32 ebp)
fn00405C2A: error: An error occurred while rewriting procedure to high-level language.
    The given key was not present in the dictionary.
       at System.Collections.Generic.Dictionary`2.get_Item(TKey key)
   at Decompiler.Core.Lib.DominatorGraph`1.BuildDominanceFrontiers(DirectedGraph`1 graph, Dictionary`2 idoms)
   at Decompiler.Core.Lib.DominatorGraph`1..ctor(DirectedGraph`1 graph, T entryNode)
   at Decompiler.Structure.ProcedureStructureBuilder.AnalyzeGraph()
   at Decompiler.Structure.StructureAnalysis.BuildProcedureStructure()
   at Decompiler.Structure.StructureAnalysis.Structure()
   at Decompiler.DecompilerDriver.StructureProgram()
rewriting: void ?cyflorvyce_a_LBPMgm__@@YGPAFJD@Z(Register word32 ebx)
rewriting: Register word32 fn004068C5(Register word32 ebp, Register word32 edi, Stack word32 dwArg04, Register out ptr32 ecxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut)
rewriting: void ?Cn_zb_kimt@@YGIH@Z(Register word32 ebx)
rewriting: void ?_GB_EN_JsqcfcxodtJ_n_j@@YGIPAG@Z()
rewriting: void ?ti_o__o_s@@YGFPAF@Z(Register word32 eax)
malware_via_email/malware_1345/ia32_pe/subject.exe: error: An internal error occurred while decompiling.
    Unable to cast object of type 'Decompiler.Core.Types.StructureType' to type 'Decompiler.Core.Types.EquivalenceClass'.
       at Decompiler.Core.Output.GlobalDataWriter.WriteGlobals(Formatter formatter)
   at Decompiler.DecompilerDriver.WriteGlobals(Program program, TextWriter w)
   at Decompiler.DecompilerDriver.<>c__DisplayClass1b.<WriteDecompilerProducts>b__17(TextWriter w)
   at Decompiler.CmdLine.CmdLineHost.WriteGlobals(Program program, Action`1 writer)
   at Decompiler.DecompilerDriver.WriteDecompilerProducts()
   at Decompiler.DecompilerDriver.StructureProgram()
   at Decompiler.DecompilerDriver.Decompile(String filename)
