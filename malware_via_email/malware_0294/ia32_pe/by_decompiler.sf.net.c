// subject.c
// Generated on 5/4/2015 12:59:06 AM by decompiling malware_via_email/malware_0294/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00403A23(word32 ebp, Eq_3 * fs)
{
	word32 * eax_14 = fs->ptr0000;
	fs->ptr0000 = fp - 0x00000014;
	__set_app_type();
	globals->dw403D58 = globals->dw403D58 | 0xFFFFFFFF;
	globals->dw403D5C = globals->dw403D5C | 0xFFFFFFFF;
	__p__fmode();
	*eax_14 = globals->dw403C34;
	__p__commode();
	*eax_14 = globals->dw403C30;
	Mem55[0x00403D54:word32] = Mem52[_adjust_fdiv:word32];
	fn00403BB5();
	word32 esp_194 = fp + 0xFFFFFF6C;
	if (globals->dw401230 == 0x00000000)
	{
		__setusermatherr();
		esp_194 = fp + 0xFFFFFF68;
	}
	fn00403BA0();
	Eq_55 * esp_61 = esp_194 - 0x00000004;
	esp_61->dw0000 = 0x00401218;
	esp_61->dw0000 = 0x00401214;
	_initterm();
	esp_61->tFFFFFFF4 = fp - 0x00000070;
	esp_61->dwFFFFFFF0 = globals->dw403C28;
	esp_61->dwFFFFFFEC = fp - 0x00000068;
	esp_61->dwFFFFFFE8 = fp - 0x00000074;
	esp_61->dwFFFFFFE4 = fp - 0x00000064;
	__getmainargs();
	esp_61->dwFFFFFFDC = 0x00401210;
	esp_61->dwFFFFFFD8 = 0x00401204;
	_initterm();
	word32 esi_162 = Mem86[_acmdln:word32];
	if (esi_162->t0000 == 0x22)
	{
l00403AFF:
		do
		{
			esi_162 = esi_162 + 1;
			Eq_111 al_172 = esi_162->t0000;
		} while (al_172 == 0x00 || al_172 == 0x22);
		if (esi_162->t0000 == 0x22)
		{
l00403B12:
			esi_162 = esi_162 + 1;
l00403B16:
			Eq_111 al_99 = esi_162->t0000;
			if (al_99 != 0x00 && al_99 <=u 0x20)
				goto l00403B12;
		}
		else
			goto l00403B16;
	}
	else
		while (esi_162->t0000 >u 0x20)
			esi_162 = esi_162 + 1;
	Eq_69 eax_114;
	esp_61->tFFFFFFF4 = fp - 0x00000060;
	GetStartupInfoA(esp_61->tFFFFFFF4);
	word32 esp_110 = &esp_61->tFFFFFFF4;
	if (0x00 != 0x00)
		eax_114 = (word32) wLoc30;
	else
	{
		esp_61->tFFFFFFF4.u0 = 0x0000000A;
		eax_114 = esp_61->tFFFFFFF4;
		esp_110 = &esp_61->tFFFFFFF4;
	}
	Eq_178 * esp_116 = esp_110 - 0x00000004;
	esp_116->t0000 = eax_114;
	Mem119[esp_116 - 0x00000004:word32] = esi_162;
	Mem121[esp_116 - 0x00000008:word32] = 0x00000000;
	esp_116->t0000.u0 = 0x00000000;
	Eq_69 eax_124 = GetModuleHandleA(esp_116->t0000);
	esp_116->t0000 = eax_124;
	fn00403BBC(ebp, dwArg00, dwArg04, dwArg08);
	esp_116->t0000 = eax_124;
	exit(esp_116->t0000);
	word32 ecx_138 = dwLoc18->t0000;
	Mem141[esp_116 - 0x00000004:word32] = dwLoc18;
	Mem143[esp_116 - 0x00000008:word32] = ecx_138;
	_XcptFilter();
	return;
}

void fn00403BA0()
{
	_controlfp();
	return;
}

void fn00403BB5()
{
	return;
}

void fn00403BBC(word32 dwArg00, word32 dwArg04, word32 dwArg08, word32 dwArg0C)
{
	MFC42.DLL!Ordinal_1576();
	return;
}

