// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0638/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

real64 fn00401008(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 esi, word32 edi, real64 rArg0)
{
	word32 edx_7 = edx + eax;
	fn004011EF(eax, DPB(ecx, ch + (byte) (edx_7 + 0x00000001), 8, 8), edx_7 + 0x00000001, ebx + 0x00000001, esi, edi + 0x00000001, dwArg00);
	__aam(al);
}

void fn0040101D(word32 ecx, word32 edx, word32 ebx, word32 esi, word32 edi, word32 dwArg00)
{
	fn004012D3(dwArg00);
}

void fn00401037(word32 dwArg00)
{
fn00401037_entry:
l00401037:
fn00401037_exit:
}

void fn00401083(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi)
{
	word32 esi_8 = esi | edx;
	word32 ecx_11 = ecx - edi;
	word32 ebx_15 = ebx | esi_8;
	fn0040118C(eax, ecx_11, ecx_11, ebx_15, esi_8, dwLoc08);
	word32 esp_24 = fp - 0x00000004 ^ Mem0[eax + 0x0000005F:word32];
	Mem29[esp_24 - 0x0000000C:word32] = Mem0[esp_24 + 0x00000000:word32];
	word32 eax_26 = (int32) ax;
	word32 edx_32 = DPB(ecx_11 + 0x00000001, (byte) (ecx_11 + 0x00000001) ^ SLICE(eax_26, byte, 8), 0, 8);
	fn0040113D(eax_26, esi_8, edx_32, ebx_15 - 0x00000001 + esi_8, fp - 0x00000004, esi_8, edi + 0x00000001, ebp);
	Mem42[edx_32 + 0x1C893276:word32] = Mem29[esp_24 + 0x00000004:word32];
	fn004010B9(eax_26, esi_8, edx_32, fp - 0x00000004, esi_8, edi + 0x00000001);
	return;
}

void fn004010B7(word32 dwArg00)
{
fn004010B7_entry:
l004010B7:
fn004010B7_exit:
}

void fn004010B9(word32 eax, word32 ecx, word32 edx, word32 ebp, word32 esi, word32 edi)
{
	esp = fp;
	al = al & 0xE9;
	eax = DPB(eax, al, 0, 8);
	v7 = Mem0[eax + 0x00000000:byte] + al;
	Mem0[eax + 0x00000000:byte] = v7;
	v9 = Mem0[eax + 0x00000000:byte] + al;
	Mem0[eax + 0x00000000:byte] = v9;
	SCZO = cond(v9);
	fn004010BF(eax, ecx, edx, ebp, esi, edi, dwArg00);
	return;
}

void fn004010BF(word32 eax, word32 ecx, word32 edx, word32 ebp, word32 esi, word32 edi, word32 dwArg00)
{
	fn00401127(eax, ecx, edx, ecx + 0x00000001, ebp, esi - 0x00000002, edi ^ ecx + 0x00000001, dwArg00, dwArg04);
	Mem30[eax + 0x00000000:word32] = __rol(Mem0[eax + 0x00000000:word32], 0x01);
	Mem33[ecx + 0x00000037:byte] = __ror(Mem30[ecx + 0x00000037:byte], cl);
	fn004010D6(ecx, ecx + 0x00000001, esi - 0x00000002, dl, ah, cs);
	return;
}

void fn004010D6(word32 ecx, word32 ebx, word32 esi, byte dl, byte ah, word32 dwArg00)
{
	fn00401037(dwArg00);
}

void fn004010F1(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi)
{
	word32 esi_20;
	word32 edi_21;
	byte C_22 = fn00401153(eax, ecx - edi, eax, ebx, (esi ^ eax | edi) - 0x00000001, edi, dwArg00, dwArg02, dwArg06, out esi_20, out edi_21);
	int3();
	__rcl(ebp, 0x8E, C_22);
	fn0040110B(esi_20, edi_21, dwArg00, dwArg04);
	return;
}

void fn0040110B(word32 esi, word32 edi, word32 dwArg00, word32 dwArg04)
{
	fn004010B7(ecx);
	Mem31[dwArg04 + 0x00000000:byte] = Mem0[esi + 0x00000001:byte];
}

void fn00401127(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, word32 dwArg00, word32 dwArg04)
{
	__fclex();
	word32 ecx_7 = ecx | esi;
	word32 ebx_11 = ebx + 0x00000001 ^ esi;
	word32 esi_12 = esi - ecx_7;
	fn0040127F(eax, ecx_7, edx, ebx_11, ebp, esi_12, edi, dwArg00);
	int64 edx_eax_19 = (int64) eax;
	fn004010F1((word32) edx_eax_19, (DPB(ecx_7, (byte) ecx_7 + ecx_7[ebx_11 * 0x02] + (esi_12 <u 0x00000000), 0, 8) - 0x00000001 | esi_12) + 0x00000001, SLICE(edx_eax_19, word32, 32), ebx_11 + 0x00000001, ebp, esi_12, edi);
}

void fn0040113D(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, word32 dwArg00)
{
	fn004010F1(eax, (ecx - 0x00000001 | esi) + 0x00000001, edx, ebx + 0x00000001, ebp, esi, edi);
}

byte fn00401153(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 esi, word32 edi, word32 dwArg00, word32 dwArg02, word32 dwArg06, ptr32 esiOut, ptr32 ediOut)
{
	word32 ecx_19 = ecx - esi;
	word32 esi_20 = esi ^ ebx;
	word32 ebx_22 = ebx + 0x00000001;
	fn004011A8(eax, ecx_19, edx, ebx_22, esi_20, edx);
	word32 edi_18;
	*ediOut = edx;
	while ((al & 0xDD) >= 0x00)
	{
		Mem33[eax + 0x00000000:word32] = dwLoc02;
		edx = edx | ecx_19;
		fn004012B8(edx);
		ecx = ecx_19 - eax;
		word32 esi_43 = esi_20 + edx;
		Mem55[(esi_43 ^ ecx) + 0x00000001:byte] = Mem33[esi_43 + 0x00000001:byte];
		ebx = (ebx_22 - ecx | esi_43) + 0x00000001;
		esi = esi_43 + 0x00000002;
		ecx_19 = ecx - esi;
		esi_20 = esi ^ ebx;
		ebx_22 = ebx + 0x00000001;
		fn004011A8(eax, ecx_19, edx, ebx_22, esi_20, edx);
		*ediOut = edx;
	}
	word32 esi_58;
	*esiOut = 0xE024448F;
	fn00401190(eax, ecx_19, edx, ebx_22, 0xE024448F);
	return false;
}

void fn0040118C(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 esi, word32 dwArg00)
{
	fn00401190(eax, ecx, edx, ebx, esi);
	return;
}

void fn00401190(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 esi)
{
	esp = fp;
	edx = edx - esi;
	edi = ecx;
	edx = edx - edi;
	ebx = ebx - 0x00000001;
	edi = edi - edx;
	ecx = ecx - 0x00000001;
	edi = edi | edx;
	edi = edi ^ esi;
	SZO = cond(edi);
	C = false;
	SC = fn00401209(eax, ecx, edx, ebx, esi, edi, dwLoc04, out ebp, out esi, out edi);
	C = SC;
	S = SC;
	SCZO = SC;
	SZO = SC;
	esp = esp + 0x00004B49;
	if (Test(NS,S))
		fn004011A5(eax, ecx, edx, ebx, esi, edi);
}

void fn004011A5(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 esi, word32 edi)
{
	fn0040110B(esi - 0x00000001, edi ^ edx, dwArg00, dwArg04);
	word32 edx_23;
	fn004011BD(esi - 0x00000001, dwArg00, out edx_23);
	return;
}

void fn004011A8(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 esi, word32 edi)
{
	fn0040110B(esi - 0x00000001, edi ^ edx, dwArg00, dwArg04);
	word32 edx_20;
	fn004011BD(esi - 0x00000001, dwArg00, out edx_20);
	return;
}

void fn004011BB()
{
fn004011BB_entry:
l004011BB:
fn004011BB_exit:
}

bool fn004011BD(word32 esi, word32 dwArg00, ptr32 edxOut)
{
	byte v4_4 = Mem0[esi - 0x00000048:byte] >>u 0x89;
	Mem5[esi - 0x00000048:byte] = v4_4;
	word32 edx_9;
	*edxOut = dwArg00;
	return cond(v4_4);
}

void fn004011EF(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 esi, word32 edi, word32 dwArg00)
{
	fn00401298(ah, dh);
	word32 ecx_13 = ecx - edi;
	word32 ebp_24;
	word32 esi_25;
	word32 edi_26;
	fn00401209(eax, ecx_13, edx, edi, esi, edi, eax, out ebp_24, out esi_25, out edi_26);
	return;
}

byte fn00401209(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 esi, word32 edi, word32 dwArg00, ptr32 ebpOut, ptr32 esiOut, ptr32 ediOut)
{
	word32 ebx_19 = (ebx + 0x00000001 ^ eax) - edx;
	word32 edi_9 = edi + eax;
	word32 esi_16 = esi ^ edx;
	fn00401008(eax, edx, edx, ebx_19, esi_16, edi_9, rArg0);
	word32 ebp_30;
	*ebpOut = Mem0[fp + 0x00000004 ^ Mem0[edx + 0x00000000:word32]:word32];
	Mem34[edi_9 + 0x00E92440:byte] = Mem0[edi_9 + 0x00E92440:byte] ^ al;
	Mem37[eax + 0x00000000:byte] = Mem34[eax + 0x00000000:byte] + al;
	Mem39[edi_9 + 0x0000002F:byte] = Mem37[edi_9 + 0x0000002F:byte] + (byte) ebx_19;
	byte cl_12 = (byte) edx;
	bool v20_42 = (Mem39[ebx_19 + 0x00000000:word32] & 0x00000001 << cl_12) != 0x00000000;
	Mem43[ebx_19 + 0x00000000:word32] = __ror(Mem39[ebx_19 + 0x00000000:word32], cl_12);
	word32 esi_28;
	*esiOut = esi_16 + 0x00000004;
	word32 edi_29;
	*ediOut = edi_9 + 0x00000004;
	return v20_42;
}

void fn0040127F(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, word32 dwArg00)
{
	fn0040101D(eax, edx, ebx, (esi | ecx) + 0x00000001, edi, ebx);
	fn0040129D();
	return;
}

void fn00401298(byte ah, byte dh)
{
	fn0040129D();
	return;
}

void fn0040129D()
{
// def fp
	esp_1 = fp;
	__hlt();
}

void fn004012B8(word32 edx)
{
fn004012B8_entry:
l004012B8:
fn004012B8_exit:
}

void fn004012D3(word32 dwArg00)
{
fn004012D3_entry:
l004012D3:
fn004012D3_exit:
}

