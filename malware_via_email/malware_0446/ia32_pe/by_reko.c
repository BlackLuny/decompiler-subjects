// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	ptr32 esp_13;
	byte SCZO_14;
	word32 esi_15;
	byte SZO_16;
	byte C_17;
	word32 eax_18;
	byte Z_19;
	word32 ebx_20;
	word32 ebp_21;
	word32 edi_22;
	word32 edx_23;
	byte cl_24;
	byte dl_25;
	word32 ecx_26;
	word16 ax_27;
	byte S_28;
	SHLWAPI.dll!StrChrA();
	if (eax_18 == 0x00)
	{
		*(esp_13 - 0x04) = ebx_20;
		*(esp_13 - 0x08) = ebp_21;
		*(esp_13 - 0x0C) = edi_22;
		*(esp_13 - 0x10) = 0x0040406C;
		*(esp_13 - 0x14) = 0x00404074;
		*(esp_13 - 0x14) = (HMODULE *) LoadLibraryA(*(esp_13 - 0x14));
		Eq_62 eax_52 = GetProcAddress(*(esp_13 - 0x14), *(esp_13 - 0x10));
		*(esp_13 - 0x10) = 0x00;
		*(esp_13 - 0x14) = 0x00;
		*(esp_13 - 0x18) = 0x00;
		*(esp_13 - 0x1C) = 0x00;
		*(esp_13 - 0x20) = 0x00;
		int32 eax_69 = eax_52();
		*(esp_13 - 0x24) = ~0x00;
		*(esp_13 - 0x28) = ~0x00;
		struct Eq_121 * edi_354 = eax_69 + 0x1C;
		if (AreAllAccessesGranted(*(esp_13 - 0x28), *(esp_13 - 0x24)) == 0x00)
			edi_354 = eax_69 + 0x1C ^ 0x0E;
		*(esp_13 - 0x24) = esp_13 - 0x10;
		*(esp_13 - 0x28) = 0x40;
		*(esp_13 - 44) = 0x3000;
		*(esp_13 - 0x30) = 0x00401000;
		VirtualProtect(*(esp_13 - 0x30), *(esp_13 - 44), *(esp_13 - 0x28), *(esp_13 - 0x24));
		struct Eq_192 * eax_105 = null;
		do
		{
			struct Eq_121 * esi_116;
			if (esi_116 == edi_354)
				esi_116 = null;
			eax_105[1051014] = (struct Eq_192) (esi_116[0x00405000] ^ eax_105[1051014] ^ ~0x01);
			struct Eq_121 * esi_124 = esi_116 + 0x01;
			if (esi_124 == edi_354)
				esi_124 = null;
			eax_105->b402619 = esi_124[0x00405000] ^ eax_105->b402619 ^ ~0x01;
			struct Eq_121 * esi_134 = esi_124 + 0x01;
			if (esi_134 == edi_354)
				esi_134 = null;
			eax_105->b40261A = esi_134[0x00405000] ^ eax_105->b40261A ^ ~0x01;
			struct Eq_121 * esi_144 = esi_134 + 0x01;
			if (esi_144 == edi_354)
				esi_144 = null;
			eax_105 = eax_105 + 0x01;
			eax_105->b402617 = esi_144[0x00405000] ^ eax_105->b40261B ^ ~0x01;
			esi_116 = esi_144 + 0x01;
		} while (eax_105 < (struct Eq_192 *) 5152);
		*(esp_13 - 0x0C) = 0x00;
		struct Eq_275 * edi_162 = &globals->t4038F8;
		uint32 ebx_164 = 0x00;
		do
		{
			Eq_281 eax_175 = edi_162->t0004;
			cui16 * ecx_181 = (char *) &edi_162->t0004 + 0x04;
			if (eax_175 - 0x08 >> 0x01 > 0x00)
			{
				uint32 esi_316 = eax_175 - 0x08 >> 0x01;
				do
				{
					if ((*ecx_181 & 0xF000) == 0x3000)
					{
						struct Eq_307 * eax_337 = ((word32) *ecx_181 & 0x0FFF) + edi_162->dw0000;
						eax_337->dw402398 = eax_337->dw402398 + 0xF0402398;
					}
					ecx_181 = ecx_181 + 0x01;
					esi_316 = esi_316 - 0x01;
				} while (esi_316 != 0x00);
				ebx_164 = *(esp_13 - 0x0C);
			}
			ebx_164 = (word32) edi_162->t0004 + ebx_164;
			*(esp_13 - 0x0C) = ebx_164;
			edi_162 = edi_162 + Mem191[edi_162 + 0x04:word32];
		} while (ebx_164 < 228);
		*(esp_13 - 0x08) = 0x004030F4;
		struct Eq_340 * ebx_196 = &globals->t4030F4;
		ebx_225 = ebx_196;
		if (globals->dw403104 != 0x00)
		{
			do
			{
				struct Eq_340 * ebx_225;
				*(esp_13 - 0x24) = ebx_225->dw000C + 0x00402398;
				Eq_56 eax_234 = LoadLibraryA(*(esp_13 - 0x24));
				*(esp_13 - 0x0C) = (HMODULE *) eax_234;
				if (eax_234 != null)
				{
					word32 edi_258 = ebx_225->dw0000;
					if (edi_258 == 0x00)
						edi_258 = ebx_225->dw0010;
					word32 * edi_263 = edi_258 + 0x00402398;
					word32 * esi_267 = ebx_225->dw0010 + 0x00402398;
					if (*edi_263 != 0x00)
					{
						do
						{
							int32 eax_281 = *edi_263;
							word16 ax_282 = (word16) eax_281;
							if (eax_281 < 0x00)
							{
								word32 eax_302 = *(esp_13 - 0x0C);
								*(esp_13 - 0x24) = (word32) ax_282;
								*(esp_13 - 0x28) = eax_302;
							}
							else
							{
								word32 edx_307 = *(esp_13 - 0x0C);
								*(esp_13 - 0x24) = eax_281 + 0x0040239A;
								*(esp_13 - 0x28) = edx_307;
							}
							*esi_267 = (word32) GetProcAddress(*(esp_13 - 0x28), *(esp_13 - 0x24));
							edi_263 = edi_263 + 0x01;
							esi_267 = esi_267 + 0x01;
						} while (*edi_263 != 0x00);
						ebx_225 = (struct Eq_340 *) *(esp_13 - 0x08);
					}
				}
				ebx_225 = ebx_225 + 0x01;
				*(esp_13 - 0x08) = (struct Eq_340 **) ebx_225;
			} while (ebx_225->dw0010 != 0x00);
		}
		ptr32 esp_203;
		byte SCZO_204;
		word32 esi_205;
		byte SZO_206;
		byte C_207;
		word32 eax_208;
		byte Z_209;
		word32 ebx_210;
		word32 ebp_211;
		word32 edi_212;
		word32 edx_213;
		byte cl_214;
		byte dl_215;
		word32 ecx_216;
		word16 ax_217;
		byte S_218;
		globals->t402DE8();
		*(esp_203 - 0x04) = 0x00;
		ExitProcess(*(esp_203 - 0x04));
	}
	else
		return 0x00;
}

