int global8 = 0x67f18764;
void global10;
void global12;
void global14;
__size32 global23 = 0xe4b71e64;// 4 bytes

// address: 0x401000
void _start() {
    int ax; 		// r0
    __size16 ax_1; 		// r0
    unsigned int ax_2; 		// r0{205}
    unsigned char cl; 		// r9
    unsigned char cl_1; 		// r9{105}
    unsigned char dl; 		// r10
    unsigned char dl_1; 		// r10{122}
    __size32 eax; 		// r24
    __size32 eax_1; 		// r24{15}
    __size32 eax_2; 		// r24{63}
    unsigned int eax_3; 		// r24{367}
    unsigned int eax_4; 		// r24{189}
    int eax_5; 		// r24{220}
    int eax_6; 		// r24{292}
    __size32 ebp; 		// r29
    __size32 ebx; 		// r27
    unsigned int ebx_1; 		// r27{182}
    __size32 *ebx_2; 		// r27{474}
    int ecx; 		// r25
    union { unsigned int x1; unsigned int * x2; } ecx_1; 		// r25{406}
    union { unsigned int x1; void * x2; } ecx_2; 		// r25{268}
    __size32 edi; 		// r31
    int edi_1; 		// r31{66}
    __size32 edi_2; 		// r31{446}
    int *edi_3; 		// r31{456}
    int edx; 		// r26
    __size32 esi; 		// r30
    union { unsigned int x1; void * x2; } esi_1; 		// r30{375}
    union { unsigned int x1; void * x2; } esi_2; 		// r30{379}
    union { unsigned int x1; void * x2; } esi_3; 		// r30{383}
    unsigned int esi_4; 		// r30{408}
    int esp; 		// r28
    __size32 *esp_1; 		// r28{63}
    void *esp_2; 		// r28{95}
    void *esp_3; 		// r28{439}
    void *esp_4; 		// r28{489}
    void *esp_5; 		// r28{475}
    LPCSTR local0; 		// m[esp - 44]
    char *local1; 		// m[esp - 40]
    int local10; 		// m[esp - 20]
    __size32 local11; 		// m[esp - 16]
    unsigned int local12; 		// m[esp_1 - 12]{74}
    void *local13; 		// m[esp_1 - 12]{84}
    unsigned int local14; 		// ebx_1{407}
    unsigned int local15; 		// ebx{416}
    unsigned int local16; 		// ebx_1{425}
    void *local17; 		// esp_3{439}
    union { unsigned int x1; void * x2; } local18; 		// ecx_2{486}
    void *local19; 		// esp_4{489}
    unsigned int local2; 		// m[esp - 60]
    int local3; 		// m[esp - 56]
    int local4; 		// m[esp - 52]
    int local5; 		// m[esp - 48]
    __size32 local6; 		// m[esp - 36]
    __size32 local7; 		// m[esp - 32]
    __size32 local8; 		// m[esp - 28]
    int local9; 		// m[esp - 24]

    eax_1 = StrChrA();
    if (eax_1 == 0) {
        eax = LoadLibraryA("advapi32.dll");
        eax = GetProcAddress(eax, "AddAce"); /* Warning: also results in ecx, edx */
        (*eax)(pc, 0, 0, 0, 0, 0, edi, ebp, ebx, 0x404064, 0, esi, eax, ecx, edx, ebx, ebp, 0, edi, LOGICALFLAGS32(eax_1), LOGICALFLAGS32(eax_1), LOGICALFLAGS32(eax_1));
        edi_1 = eax_2 + 28;
        *(__size32*)(esp_1 - 4) = -1;
        *(__size32*)(esp_1 - 8) = -1;
        eax = AreAllAccessesGranted();
        if (eax == 0) {
            edi_1 = eax_2 + 28 ^ 14;
        }
        local13 = esp_1 + 8;
        *(__size32*)(esp_1 - 16) = 64;
        *(__size32*)(esp_1 - 20) = 0x3000;
        *(__size32*)(esp_1 - 24) = 0x401000;
        ecx = VirtualProtect(); /* Warning: also results in edx, esp_2 */
        local17 = esp_2;
        local19 = esp_2;
        eax = 0;
        do {
            eax_3 = eax;
            if (esi == edi_1) {
                esi = 0;
            }
            esi_1 = esi;
            cl_1 = *(esi_1 + 0x405000);
            cl = (cl_1 ^ global8[eax_3]);
            esi = esi_1 + 1;
            global8[eax_3] = cl ^ -2;
            if (esi_1 + 1 == edi_1) {
                esi = 0;
            }
            esi_2 = esi;
            dl_1 = *(esi_2 + 0x405000);
            dl = (dl_1 ^ global10[eax_3]);
            esi = esi_2 + 1;
            global10[eax_3] = dl ^ -2;
            if (esi_2 + 1 == edi_1) {
                esi = 0;
            }
            esi_3 = esi;
            cl = *(esi_3 + 0x405000);
            cl = (cl ^ global12[eax_3]);
            esi = esi_3 + 1;
            ecx = (((((ecx >> 8 & 0xffffff | (cl_1)) >> 8 & 0xffffff | (cl)) >> 8 & 0xffffff | (cl ^ -2)) >> 8 & 0xffffff | (cl)) >> 8 & 0xffffff | (cl)) >> 8 & 0xffffff | (cl ^ -2);
            global12[eax_3] = cl ^ -2;
            if (esi_3 + 1 == edi_1) {
                esi = 0;
            }
            dl = *(esi + 0x405000);
            dl = (dl ^ global14[eax_3]);
            eax = eax_3 + 1;
            edx = (((((edx >> 8 & 0xffffff | (dl_1)) >> 8 & 0xffffff | (dl)) >> 8 & 0xffffff | (dl ^ -2)) >> 8 & 0xffffff | (dl)) >> 8 & 0xffffff | (dl)) >> 8 & 0xffffff | (dl ^ -2);
            global14[eax_3] = dl ^ -2;
            esi++;
        } while ((eax_3 + 1) * 4 < 0x1420);
        edi = 0x4038f8;
        ebx_1 = 0;
        *(__size32*)(esp_1 - 4) = 0;
        do {
            eax_4 = *(edi + 4);
            eax = (eax_4 - 8) / 2;
            ax = (unsigned short) (eax_4 - 8) / 2;
            ecx = edi + 8;
            cl = (unsigned char) edi + 8;
            local14 = ebx_1;
            local16 = ebx_1;
            if ((int)((eax_4 - 8) / 2) > 0) {
                esi = (eax_4 - 8) / 2;
                do {
                    ecx_1 = ecx;
                    ebx_1 = local14;
                    esi_4 = esi;
                    ax_2 = *ecx_1;
                    ax = ax_2 & 0xfffff000;
                    eax = (eax >> 16 & 0xffff | (ax_2)) >> 16 & 0xffff | (ax_2 & 0xfffff000);
                    tmph = (ax_2 & 0xfffff000) - 0x3000;
                    local15 = ebx_1;
                    if ((ax_2 & 0xfffff000) == 0x3000) {
                        ebx = ebx_1 + ebx_1;
                        eax = *(unsigned short*)ecx_1;
                        eax_5 = (eax & 0xfff) + *edi;
                        eax = eax_5 + 0x402398;
                        ax = (unsigned short) eax_5 + 0x402398;
                        *(__size32*)(eax_5 + 0x402398) = *(eax_5 + 0x402398) - 0xfbfdc68;
                        local15 = ebx;
                    }
                    ebx = local15;
                    ecx = ecx_1 + 2;
                    cl = (unsigned char) ecx_1 + 2;
                    esi = esi_4 - 1;
                    local14 = ebx;
                } while (esi_4 != 1);
                ebx = *(esp_1 - 4);
                local16 = ebx;
            }
            ebx_1 = local16;
            ebx_1 += *(edi + 4);
            *(unsigned int*)(esp_1 - 4) = ebx_1;
            esi = ecx + esi * 8;
            edi += *(edi + 4);
            local18 = ecx;
        } while (ebx_1 < 228);
        ebx = 0x4030f4;
        *(__size32*)esp_1 = 0x4030f4;
        edx = (unsigned int)0xb140b1f8;
        dl = 248;
        flags = SUBFLAGS32(*0x403104, 0, global23);
        if (*0x403104 != 0) {
            do {
                esp_3 = local17;
                ecx = *(ebx + 12);
                cl = (unsigned char) ecx + 0x402398;
                *(__size32*)(esp_3 - 4) = ecx + 0x402398;
                eax = LoadLibraryA(*(esp_3 - 4)); /* Warning: also results in ecx_2, edx */
                *(unsigned int*)(esp_3 + 20) = eax;
                if (eax != 0) {
                    edi = *ebx;
                    if (edi == 0) {
                        edi = *(ebx + 16);
                    }
                    edi_2 = edi;
                    edi = edi_2 + 0x402398;
                    ecx_2 = eax + ecx_2 * 8;
                    cl = (unsigned char) eax + ecx_2 * 8;
                    esi = *(ebx + 16);
                    esi += 0x402398;
                    if (*(edi_2 + 0x402398) != 0) {
                        do {
                            edi_3 = edi;
                            eax_6 = *edi_3;
                            ax = (unsigned short) eax_6;
                            if (eax_6 < 0) {
                                dl = (unsigned char) ((unsigned short) eax_6);
                                eax = *(esp_3 + 20);
                                ax = (unsigned short) eax;
                                *(unsigned int*)(esp_3 - 4) = ((unsigned short) eax_6);
                                *(int*)(esp_3 - 8) = eax;
L5:
                                eax = GetProcAddress(*(esp_3 - 8), *(esp_3 - 4)); /* Warning: also results in ecx_2, edx */
                                goto L4;
                            }
                            edx = *(esp_3 + 20);
                            dl = (unsigned char) edx;
                            cl = (unsigned char) eax_6 + 0x40239a;
                            *(__size32*)(esp_3 - 4) = eax_6 + 0x40239a;
                            *(unsigned int*)(esp_3 - 8) = edx;
                            goto L5;
L4:
                            *(unsigned int*)esi = eax;
                            edi = edi_3 + 4;
                            ebx = edi_3 + ebx * 2 + 4;
                            esi += 4;
                        } while (*(edi_3 + 4) != 0);
                        ebx = *(esp_3 + 24);
                    }
                }
                ebx_2 = ebx;
                esp_5 = esp_3;
                ebx = ebx_2 + 20;
                tmp1 = *(ebx_2 + 36);
                flags = SUBFLAGS32(*(ebx_2 + 36), 0, tmp1);
                *(void **)(esp_3 + 24) = ebx_2 + 20;
                local17 = esp_5;
                local18 = ecx_2;
                local19 = esp_5;
            } while (*(ebx_2 + 36) != 0);
        }
        ecx_2 = local18;
        esp_4 = local19;
        (*0x402de8)(local2, local3, local4, local5, local0, local1, local6, local7, local8, local9, local10, local11, 0x2de8, cl, dl, 0x402de8, ecx_2, edx, ebx, 0x402398, esi, edi, <all>, flags, ZF, CF);
        *(__size32*)(esp - 4) = 0;
        ExitProcess(*(esp - 4));
    }
    return;
}

