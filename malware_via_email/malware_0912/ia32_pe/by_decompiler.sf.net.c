// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0912/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401004(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, selector fs)
{
	word32 edx_39 = edx + esi + esi + (fp + 0x00000010) + (fp + 0x00000010);
	word32 ebx_102;
	word32 ebp_103;
	word32 edi_104;
	word32 ecx_105 = fn004010D0(edx_39 + 0x0B753B38, 0x00000000, ebx, ebp, edi, fs, dwLoc2C, 0x00000000, esi, out ebx_102, out ebp_103, out edi_104);
	word32 ebx_109;
	word32 ebp_110;
	word32 edi_111;
	fn004010D0(edx_39 + 0x0B753B38, ecx_105, ebx_102, ebp_103, edi_104, fs, dwArg00, dwArg18, dwArg24, out ebx_109, out ebp_110, out edi_111);
	return;
}

word32 fn004010D0(word32 eax, word32 ecx, word32 ebx, word32 ebp, word32 edi, selector fs, word32 dwArg00, word32 dwArg18, word32 dwArg24, ptr32 ebxOut, ptr32 ebpOut, ptr32 ediOut)
{
	esp = fp;
	eax = eax + 0x00000001;
	ax = (word16) eax;
	al = (byte) eax;
	SZO = cond(eax);
	esp = fp - 0x00000004;
	dwLoc04 = ebp;
	edx = 0x0000A5B2;
	eax = eax + 0x00000000;
	eax = 0x00000000;
	eax = 0x00000000;
	dwArg24 = 0x00000000;
	eax = dwArg00;
	eax = eax + 0x00000000;
	esp = fp - 0x00000006;
	wLoc06 = 0x0000;
	eax = eax + 0x00000000;
	ax = wLoc06;
	eax = DPB(eax, ax, 0, 16);
	esp = fp - 0x00000004;
	eax = eax + 0x00000000;
	cx = Mem0[eax + 0x00000000:word16];
	ecx = DPB(ecx, cx, 0, 16);
	eax = eax + 0x00000000;
	ecx = ecx + 0x0000A5B2;
	cx = (word16) ecx;
	cl = (byte) ecx;
	eax = eax + 0x00000000;
	ax = (word16) eax;
	al = (byte) eax;
	esp = fp + 0x00000004;
	SCZO = cond(fp + 0x00000004);
	dwArg18 = 0xB53898FA;
	ax = 0x0000;
	eax = DPB(eax, ax, 0, 16);
	eax = eax + 0x00000000;
	edx = eax + 0x00006030;
	eax = eax + 0x00000000;
	eax = eax + 0x00006C7C;
	eax = eax + 0x00000000;
	esp = fp;
	dwArg00 = edx;
	eax = eax + 0x00000000;
	esp = fp - 0x00000004;
	dwLoc04 = eax;
	eax = eax + 0x00000000;
	esp = fp - 0x00000008;
	dwLoc08 = edx;
	eax = eax + 0x00000000;
	esp = fp - 0x0000000C;
	dwLoc0C = esi;
	eax = eax + 0x00000000;
	ecx = -ecx;
	cx = (word16) ecx;
	cl = (byte) ecx;
	SCZO = cond(ecx);
	C = ecx == 0x00000000;
	eax = eax + 0x00000000;
	ax = (word16) eax;
	al = (byte) eax;
	esp = fp - 0x00000010;
	dwLoc10 = ebx;
	esp = fp - 0x00000014;
	dwLoc14 = edi;
	esi = 0x00000000;
	SZO = cond(0x00000000);
	C = false;
	eax = eax + 0x00000000;
	esp = fp - 0x00000018;
	dwLoc18 = 0x00000000;
	eax = eax + 0x00000000;
	ax = (word16) eax;
	al = (byte) eax;
	esp = fp - 0x0000001C;
	dwLoc1C = 0x00000000;
	esi = 0x00000001;
	SZO = cond(0x00000001);
	esp = fp - 0x00000020;
	dwLoc20 = 0x00000001;
	bLoc1E = SLICE(dwLoc20, byte, 16);
	eax = eax + 0x00000000;
	esi = ecx;
	eax = eax + 0x00000000;
	esi = esi + edi;
	SCZO = cond(esi);
	eax = eax + 0x00000000;
	v15 = bLoc1E - 0x01;
	bLoc1E = v15;
	eax = eax + 0x00000000;
	ax = (word16) eax;
	al = (byte) eax;
	esi = esi + 0x00000001;
	si = (word16) esi;
	SZO = cond(esi);
	esi = esi + 0x00000001;
	SZO = cond(esi);
	esp = fp - 0x00000024;
	dwLoc24 = esi;
	eax = eax + 0x00000000;
	esi = 0x00000001;
	eax = eax + 0x00000000;
	esi = 0x00000006;
	SCZO = cond(0x00000006);
	eax = eax + 0x00000000;
	esp = fp - 0x00000028;
	dwLoc28 = 0x00000006;
	eax = eax + 0x00000000;
	esi = 0x0000000A;
	eax = eax + 0x00000000;
	ax = (word16) eax;
	al = (byte) eax;
	esp = fp - 0x0000002C;
	dwLoc2C = 0x00000002;
	esi = 0x00000002;
	si = (word16) esi;
	esp = fp - 0x00000028;
	ebp = ebp + 0x00000001;
	SZO = cond(ebp);
	eax = eax + 0x00000000;
	edi = fp - 0x00000028;
	esp = fp - 0x0000002C;
	Mem0[esp + 0x00000000:word32] = fp - 0x00000028;
	eax = fn0040169A(ebx, ebp, esi, edi, cl, dwLoc30, out ecx, out ebx, out ebp, out esi, out edi);
	eax = eax + 0x00000000;
	esp = esp + 0x00000014;
	SCZO = cond(esp);
	eax = eax + 0x00000000;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = edi;
	eax = eax + 0x00000000;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	eax = eax + 0x00000000;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	eax = eax + 0x00000000;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	eax = eax + 0x00000000;
	Mem0[ebx + 0x00000018:word32]();
	eax = eax + 0x00000000;
	Mem0[ebx + 0x0000001C:word32]();
	eax = eax + 0x00000000;
	eax = eax + 0x00000006;
	ax = (word16) eax;
	al = (byte) eax;
	SCZO = cond(eax);
	si = si + SEQ(fs, eax - 0x00000002)[eax * 0x0008];
	esi = DPB(esi, si, 0, 16);
	SCZO = cond(si);
	esi = esi - 0x00000001;
	SZO = cond(esi);
	eax = eax + 0x00000000;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	eax = eax + 0x00000000;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	eax = eax + 0x00000000;
	Mem0[ebx + 0x00000000:word32]();
	eax = eax + 0x00000000;
	Mem0[esp + 0x00000038:word32] = ebx;
	eax = eax + 0x00000000;
	Mem0[esp + 0x0000003C:word32] = esi;
	eax = eax + 0x00000000;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = ebx;
	eax = eax + 0x00000000;
	v18 = Mem0[esp + 0x00000000:word32] - 0x00000004;
	Mem0[esp + 0x00000000:word32] = v18;
	SCZO = cond(v18);
	eax = eax + 0x00000000;
	ax = (word16) eax;
	al = (byte) eax;
	edi = Mem0[esp + 0x00000000:word32];
	edi = Mem0[edi + 0x00000000:word32];
	edi = Mem0[esp + 0x00000000:word32];
	esp = esp + 0x00000004;
	eax = eax + 0x00000000;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	eax = eax + 0x00000000;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = ecx;
	eax = eax + 0x00000000;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = esp;
	eax = eax + 0x00000000;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = 0x00000040;
	eax = eax + 0x00000000;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = Mem0[esp + 0x00000030:word32];
	eax = eax + 0x00000000;
	ax = (word16) eax;
	al = (byte) eax;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = Mem0[esp + 0x00000028:word32];
	eax = eax;
	ax = (word16) eax;
	al = (byte) eax;
	Mem0[esp + 0x00000030:word32] = 0x00000000;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = 0xFFFFFFFF;
	Mem0[edi + 0x00000010:word32]();
	eax = eax + 0x00000000;
	eax = eax + Mem0[fs:eax + 0x0000002F:word32];
	SCZO = cond(eax);
	eax = eax + 0x00000000;
	ax = (word16) eax;
	al = (byte) eax;
	ecx = Mem0[eax + 0x00000003:word32];
	cx = (word16) ecx;
	cl = (byte) ecx;
	v19 = Mem0[esp + 0x00000030:word32] + ecx;
	Mem0[esp + 0x00000030:word32] = v19;
	SCZO = cond(v19);
	edi = Mem0[esp + 0x00000000:word32];
	esp = esp + 0x00000004;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	eax = Mem0[esp + 0x00000000:word32];
	esp = esp + 0x00000004;
	edi = Mem0[esp + 0x00000000:word32];
	esp = esp + 0x00000004;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	eax = Mem0[esp + 0x00000000:word32];
	esp = esp + 0x00000004;
	edi = Mem0[esp + 0x00000000:word32];
	esp = esp + 0x00000004;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	eax = Mem0[esp + 0x00000000:word32];
	esp = esp + 0x00000004;
	ebx = Mem0[esp + 0x00000000:word32];
	esp = esp + 0x00000004;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	ax = eax;
	eax = Mem0[esp + 0x00000000:word32];
	ax = (word16) eax;
	al = (byte) eax;
	esp = esp + 0x00000004;
	esi = Mem0[esp + 0x00000000:word32];
	si = (word16) esi;
	esp = esp + 0x00000004;
	eax = eax + 0x00000002;
	ax = (word16) eax;
	al = (byte) eax;
	eax = eax + 0x00000001;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	eax = Mem0[esp + 0x00000000:word32];
	esp = esp + 0x00000004;
	ecx = Mem0[eax + 0x00000000:word32];
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	eax = Mem0[esp + 0x00000000:word32];
	esp = esp + 0x00000004;
	v20 = Mem0[esp + 0x00000028:word32] ^ ecx;
	Mem0[esp + 0x00000028:word32] = v20;
	SZO = cond(Mem0[esp + 0x00000028:word32]);
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	eax = Mem0[esp + 0x00000000:word32];
	esp = esp + 0x00000004;
	eax = Mem0[esp + 0x00000008:word32];
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	eax = Mem0[esp + 0x00000000:word32];
	esp = esp + 0x00000004;
	ecx = Mem0[esp + 0x00000018:word32];
	cx = (word16) ecx;
	cl = (byte) ecx;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	eax = Mem0[esp + 0x00000000:word32];
	esp = esp + 0x00000004;
	esp = esp - 0x00000108;
	SCZO = cond(esp);
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	eax = Mem0[esp + 0x00000000:word32];
	esp = esp + 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	eax = Mem0[esp + 0x00000000:word32];
	esp = esp + 0x00000004;
	Mem0[esp + 0x00000004:word32] = ecx;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	ax = eax;
	eax = Mem0[esp + 0x00000000:word32];
	esp = esp + 0x00000004;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = edi;
	eax = 0x00000000;
	ax = (word16) eax;
	al = (byte) eax;
	SZO = cond(0x00000000);
	C = false;
	do
	{
		edi = esp + 0x0000000C + eax;
		esp = esp - 0x00000004;
		Mem0[esp + 0x00000000:word32] = eax;
		eax = Mem0[esp + 0x00000000:word32];
		al = (byte) eax;
		esp = esp + 0x00000004;
		Mem0[edi + 0x00000000:byte] = al;
		edi = edi + 0x00000001;
		esp = esp - 0x00000004;
		Mem0[esp + 0x00000000:word32] = eax;
		eax = Mem0[esp + 0x00000000:word32];
		esp = esp + 0x00000004;
		eax = eax + 0x00000001;
		esp = esp - 0x00000004;
		Mem0[esp + 0x00000000:word32] = eax;
		eax = Mem0[esp + 0x00000000:word32];
		esp = esp + 0x00000004;
		SCZO = cond(eax - 0x00000100);
		C = SCZO;
		esp = esp - 0x00000004;
		Mem0[esp + 0x00000000:word32] = eax;
		ax = eax;
		eax = Mem0[esp + 0x00000000:word32];
		ax = (word16) eax;
		al = (byte) eax;
		esp = esp + 0x00000004;
	} while (Test(ULT,C));
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	eax = Mem0[esp + 0x00000000:word32];
	esp = esp + 0x00000004;
	edi = Mem0[esp + 0x00000000:word32];
	esp = esp + 0x00000004;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	eax = Mem0[esp + 0x00000000:word32];
	esp = esp + 0x00000004;
	eax = esp + 0x00000138;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	eax = Mem0[esp + 0x00000000:word32];
	esp = esp + 0x00000004;
	SCZO = cond(Mem0[eax + 0x00000000:byte] - 0x79);
	Z = SCZO;
	esp = esp - 0x00000004;
	Mem0[esp + 0x00000000:word32] = eax;
	ax = eax;
	eax = Mem0[esp + 0x00000000:word32];
	ax = (word16) eax;
	al = (byte) eax;
	esp = esp + 0x00000004;
	if (Test(NE,Z))
	{
		edi = Mem0[eax - 0x00000004:word32];
		fn004013D4(ebp, esi, edi, ax, cx);
		return ecx;
	}
	else
	{
		ecx = fn0040143B(ebp, esi, edi, dwArg00, dwArg04, dwArg0118, out ebx, out ebp, out edi);
		cx = (word16) ecx;
		cl = (byte) ecx;
		return ecx;
	}
}

void fn004012DF(word32 eax, word32 ebp, word32 esi, word32 edi, byte cl)
{
	ebx = 0x00000000;
	bl = (byte) ebx;
	SZO = cond(0x00000000);
	C = false;
	bl = cl;
	ebx = DPB(ebx, bl, 0, 8);
	eax = fn004016BF(eax, ebx, ebp, esi, edi, cl, out ecx, out ebx, out ebp, out esi, out edi);
	return ecx;
}

void fn004013D4(word32 ebp, word32 esi, word32 edi, word16 ax, word16 cx)
{
	Mem0[edi + 0x00000018:word32]();
	esp = fp - 0x00000004;
	dwLoc04 = eax;
	ax = eax;
	eax = dwLoc04;
	ax = (word16) eax;
	esp = fp;
	Mem0[edi + 0x00000010:word32]();
	ecx = fn00401727(ebp, esi, edi, ax, cx, out ebx, out ebp, out edi);
	cx = (word16) ecx;
	cl = (byte) ecx;
	return ecx;
}

word32 fn0040143B(word32 ebp, word32 esi, word32 edi, word32 dwArg00, word32 dwArg04, word32 dwArg0118, ptr32 ebxOut, ptr32 ebpOut, ptr32 ediOut)
{
	eax = eax;
	esp = fp - 0x00000004;
	dwLoc04 = ebp;
	esp = fp - 0x00000008;
	dwLoc08 = esi;
	esp = fp - 0x0000000C;
	dwLoc0C = eax;
	eax = dwLoc0C;
	esp = fp - 0x00000008;
	esp = fp - 0x0000000C;
	dwLoc0C = edi;
	esp = fp - 0x00000010;
	dwLoc10 = eax;
	eax = dwLoc10;
	esp = fp - 0x0000000C;
	edi = fp + 0x00000116;
	esp = fp - 0x00000010;
	dwLoc10 = eax;
	ax = eax;
	eax = dwLoc10;
	esp = fp - 0x0000000C;
	edi = dwArg0118;
	eax = 0x00000000;
	SZO = cond(0x00000000);
	C = false;
	esi = 0x00000000;
	esp = fp - 0x00000010;
	dwLoc10 = 0x00000000;
	eax = dwLoc10;
	esp = fp - 0x0000000C;
	ebp = 0x00000000;
	SZO = cond(0x00000000);
	C = false;
	esp = fp - 0x00000010;
	dwLoc10 = eax;
	eax = dwLoc10;
	esp = fp - 0x0000000C;
	esp = fp - 0x00000010;
	dwLoc10 = ebx;
	esp = fp - 0x00000014;
	dwLoc14 = eax;
	ax = eax;
	eax = dwLoc14;
	ax = (word16) eax;
	ah = SLICE(eax, byte, 8);
	esp = fp - 0x00000010;
	do
	{
		ebx = (word32) Mem0[fp + 0x00000008 + ebp:byte];
		bx = (word16) ebx;
		bl = (byte) ebx;
		esp = fp - 0x00000014;
		dwLoc14 = eax;
		eax = dwLoc14;
		esp = fp - 0x00000010;
		edx = dwArg04;
		esp = fp - 0x00000014;
		dwLoc14 = eax;
		eax = dwLoc14;
		esp = fp - 0x00000010;
		edx = (word32) Mem0[edx + eax:byte];
		esp = fp - 0x00000014;
		dwLoc14 = eax;
		eax = dwLoc14;
		esp = fp - 0x00000010;
		ecx = ebx;
		esp = fp - 0x00000014;
		dwLoc14 = eax;
		eax = dwLoc14;
		esp = fp - 0x00000010;
		ecx = ecx + esi;
		cl = (byte) ecx;
		esp = fp - 0x00000014;
		dwLoc14 = eax;
		ax = eax;
		eax = dwLoc14;
		ax = (word16) eax;
		ah = SLICE(eax, byte, 8);
		esp = fp - 0x00000010;
		edx = edx + ecx;
		dh = SLICE(edx, byte, 8);
		dl = (byte) edx;
		SCZO = cond(edx);
		dh = 0x00;
		edx = DPB(edx, dh, 8, 8);
		SZO = cond(0x00);
		C = false;
		eax = eax + 0x00000001;
		esp = fp - 0x00000014;
		dwLoc14 = eax;
		eax = dwLoc14;
		esp = fp - 0x00000010;
		esi = edx;
		esp = fp - 0x00000014;
		dwLoc14 = eax;
		eax = dwLoc14;
		esp = fp - 0x00000010;
		SCZO = cond(eax - edi);
		C = SCZO;
		esp = fp - 0x00000014;
		dwLoc14 = eax;
		ax = eax;
		eax = dwLoc14;
		ax = (word16) eax;
		ah = SLICE(eax, byte, 8);
		esp = fp - 0x00000010;
		if (Test(UGE,C))
		{
			esp = fp - 0x00000014;
			dwLoc14 = eax;
			ax = eax;
			eax = dwLoc14;
			esp = fp - 0x00000010;
			eax = 0x00000000;
			ax = (word16) eax;
			ah = SLICE(eax, byte, 8);
			SZO = cond(0x00000000);
			C = false;
		}
		dl = Mem0[fp + 0x00000008 + esi:byte];
		edx = DPB(edx, dl, 0, 8);
		Mem0[fp + 0x00000008 + ebp:byte] = dl;
		esp = fp - 0x00000014;
		dwLoc14 = eax;
		eax = dwLoc14;
		esp = fp - 0x00000010;
		ebp = ebp + 0x00000001;
		SZO = cond(ebp);
		esp = fp - 0x00000014;
		dwLoc14 = eax;
		ax = eax;
		eax = dwLoc14;
		ax = (word16) eax;
		ah = SLICE(eax, byte, 8);
		esp = fp - 0x00000010;
		edx = fp + 0x00000008 + esi;
		dh = SLICE(edx, byte, 8);
		dl = (byte) edx;
		edx = edx - eax;
		dh = SLICE(edx, byte, 8);
		dl = (byte) edx;
		SCZO = cond(edx);
		bh = Mem0[eax + 0x00000001 + edx:byte];
		bx = DPB(bx, bh, 8, 8);
		esp = fp - 0x00000014;
		dwLoc14 = eax;
		ax = eax;
		eax = dwLoc14;
		ax = (word16) eax;
		ah = SLICE(eax, byte, 8);
		esp = fp - 0x00000010;
		Mem0[eax + edx:word16] = bx;
		ebx = ebp + 0x00000000;
		bh = SLICE(ebx, byte, 8);
		bx = (word16) ebx;
		bh = bh - 0x01;
		SZO = cond(bh);
		Z = SZO;
		SCZO = SZO;
		CZ = SZO;
		eax = eax;
		ax = (word16) eax;
		ah = SLICE(eax, byte, 8);
	} while (Test(NE,Z));
	esp = fp - 0x00000014;
	dwLoc14 = eax;
	eax = dwLoc14;
	esp = fp - 0x00000010;
	esi = 0x00000000;
	esp = fp - 0x00000014;
	dwLoc14 = eax;
	eax = dwLoc14;
	esp = fp - 0x00000010;
	eax = 0x00000000;
	SZO = cond(0x00000000);
	C = false;
	esp = fp - 0x00000014;
	dwLoc14 = 0x00000000;
	ax = 0x00000000;
	eax = dwLoc14;
	ax = (word16) eax;
	ah = SLICE(eax, byte, 8);
	esp = fp - 0x00000010;
	ebx = dwLoc10;
	bh = SLICE(ebx, byte, 8);
	bx = (word16) ebx;
	bl = (byte) ebx;
	esp = fp - 0x0000000C;
	ebp = Mem0[fp + 0x0000011C + esi:word32];
	edi = dwArg00;
	esp = fp - 0x00000010;
	dwLoc10 = eax;
	eax = dwLoc10;
	esp = fp - 0x0000000C;
	edx = ebx;
	esp = fp - 0x00000010;
	dwLoc10 = eax;
	eax = dwLoc10;
	esp = fp - 0x0000000C;
	SZO = cond(ebp & ebp);
	C = false;
	CZ = C;
	esp = fp - 0x00000010;
	dwLoc10 = eax;
	ax = eax;
	eax = dwLoc10;
	ax = (word16) eax;
	ah = SLICE(eax, byte, 8);
	esp = fp - 0x0000000C;
	if (Test(UGT,CZ))
	{
		esp = fp - 0x00000010;
		dwLoc10 = eax;
		ax = eax;
		eax = dwLoc10;
		ax = (word16) eax;
		ah = SLICE(eax, byte, 8);
		esp = fp - 0x0000000C;
		fn0040157A(eax, ebp, esi, edi);
		return ecx;
	}
	else
	{
		eax = fn0040163E(dwLoc0C, dwLoc08, dwLoc04, dwArg0108, dwArg010C, dwArg0130, dwArg0134, out ebx, out ebp, out esi, out edi);
		return ecx;
	}
}

void fn0040157A(word32 eax, word32 ebp, word32 esi, word32 edi)
{
	esp = fp;
	eax = eax + 0x00000001;
	esp = fp - 0x00000004;
	dwLoc04 = eax;
	eax = dwLoc04;
	esp = fp;
	ah = 0x00;
	eax = DPB(eax, ah, 8, 8);
	SCZO = cond(0x00);
	esp = fp - 0x00000004;
	dwLoc04 = eax;
	ax = eax;
	eax = dwLoc04;
	ax = (word16) eax;
	ah = SLICE(eax, byte, 8);
	esp = fp;
	cl = Mem0[fp + 0x00000014 + eax:byte];
	fn004012DF(eax, ebp, esi, edi, cl);
	return;
}

word32 fn0040163E(word32 dwArg00, word32 dwArg04, word32 dwArg08, word32 dwArg0114, word32 dwArg0118, word32 dwArg013C, word32 dwArg0140, ptr32 ebxOut, ptr32 ebpOut, ptr32 esiOut, ptr32 ediOut)
{
	word32 edi_1;
	*ediOut = dwArg00;
	word32 esi_5;
	*esiOut = dwArg04;
	word32 ebp_8;
	*ebpOut = dwArg08;
	word32 ebx_40;
	*ebxOut = edx;
	return dwArg0118;
}

word32 fn0040169A(word32 ebx, word32 ebp, word32 esi, word32 edi, byte cl, word32 dwArg00, ptr32 ecxOut, ptr32 ebxOut, ptr32 ebpOut, ptr32 esiOut, ptr32 ediOut)
{
	word32 ecx_27;
	word32 ebx_28;
	word32 ebp_29;
	word32 esi_30;
	word32 edi_31;
	return fn004016BF(dwArg00, ebx, ebp, esi, edi, cl, out ecx_27, out ebx_28, out ebp_29, out esi_30, out edi_31);
}

word32 fn004016BF(word32 eax, word32 ebx, word32 ebp, word32 esi, word32 edi, byte cl, ptr32 ecxOut, ptr32 ebxOut, ptr32 ebpOut, ptr32 esiOut, ptr32 ediOut)
{
// def fp
// def ebx
// def esi
// def Mem0
// def edx
// def eax
// def cl
// def edi
// def ebp
// def ecxOut
// def ebxOut
// def ebpOut
// def esiOut
// def ediOut
// def dwArg00
// def dwArg04
// def dwArg08
// def dwArg0114
// def dwArg0118
// def dwArg013C
// def dwArg0140
	esp_1 = fp;
	ebx_4 = ebx + esi;
	bh_5 = SLICE(ebx_4, byte, 8);
	SCZO_6 = cond(ebx_4);
	bh_7 = 0x00;
	ebx_8 = DPB(ebx_4, bh_7, 8, 8);
	SZO_9 = cond(0x00);
	C_10 = false;
	esi_11 = ebx_8 + 0x00000014;
	dh_13 = Mem0[fp + esi_11:byte];
	edx_15 = DPB(edx, dh_13, 8, 8);
	esp_16 = fp - 0x00000004;
	dwLoc04_18 = eax;
	eax_19 = dwLoc04_18;
	esp_20 = fp;
	Mem21[fp + 0x00000014 + eax_19:byte] = dh_13;
	esp_22 = fp - 0x00000004;
	dwLoc04_23 = eax_19;
	ax_24 = eax_19;
	eax_25 = dwLoc04_23;
	esp_26 = fp;
	esp_27 = fp - 0x00000004;
	dwLoc04_28 = eax_25;
	eax_29 = fp + esi_11;
	ax_30 = (word16) eax_29;
	Mem32[eax_29 + 0x00000000:byte] = cl;
	eax_33 = dwLoc04_28;
	esp_34 = fp;
	esp_35 = fp - 0x00000004;
	dwLoc04_36 = eax_33;
	ax_37 = eax_33;
	eax_38 = dwLoc04_36;
	ax_39 = (word16) eax_38;
	esp_40 = fp;
	edx_41 = (word32) dh_13;
	dh_42 = SLICE(edx_41, byte, 8);
	dl_43 = (byte) edx_41;
	dl_44 = dl_43 + cl;
	edx_45 = DPB(edx_41, dl_44, 0, 8);
	SCZO_46 = cond(dl_44);
	edx_47 = edx_45 + 0x00000014;
	esp_48 = fp - 0x00000004;
	dwLoc04_49 = eax_38;
	eax_50 = dwLoc04_49;
	esp_51 = fp;
	ecx_52 = Mem32[fp + (edx_47 + 0x00000014):word32];
	esp_53 = fp - 0x00000004;
	dwLoc04_54 = eax_50;
	eax_55 = dwLoc04_54;
	esp_56 = fp;
	ecx_57 = ecx_52 << 0x00000008;
	cl_58 = (byte) ecx_57;
	cx_59 = (word16) ecx_57;
	esp_60 = fp - 0x00000004;
	dwLoc04_61 = eax_55;
	eax_62 = dwLoc04_61;
	esp_63 = fp;
	esi_64 = esi_11 + 0xFFFFFFEC;
	esp_65 = fp - 0x00000004;
	dwLoc04_66 = eax_62;
	eax_67 = dwLoc04_66;
	esp_68 = fp;
	v18_70 = Mem32[edi - 0x00000001:word16] ^ cx_59;
	Mem71[edi - 0x00000001:word16] = v18_70;
	SZO_72 = cond(Mem71[edi - 0x00000001:word16]);
	C_73 = false;
	esp_74 = fp - 0x00000004;
	dwLoc04_75 = eax_67;
	ax_76 = eax_67;
	eax_77 = dwLoc04_75;
	ax_78 = (word16) eax_77;
	esp_79 = fp;
	edi_80 = edi + 0x00000001;
	SZO_81 = cond(edi_80);
	ebp_83 = ebp - 0x00000001;
	SZO_84 = cond(ebp_83);
	SCZO_85 = SZO_84;
	Z_86 = SZO_84;
	if (ebp_83 == 0x00000000)
	{
		esp_100 = fp - 0x00000004;
		dwLoc04_101 = eax_77;
		ax_102 = eax_77;
		eax_103 = dwLoc04_101;
		esp_104 = fp;
		eax_116 = fn0040163E(dwArg00, dwArg04, dwArg08, dwArg0114, dwArg0118, dwArg013C, dwArg0140, out ebx_112, out ebp_113, out esi_114, out edi_115);
		ax_117 = (word16) eax_116;
		return eax_116;
	}
	else
	{
		fn0040157A(eax_77, ebp_83, esi_64, edi_80);
		return eax_77;
	}
// dwLoc04_87 = PHI(dwLoc04_75, dwLoc04_101)
// esp_88 = PHI(esp_79, esp_104)
// ebx_89 = PHI(ebx_8, ebx_112)
// ebp_90 = PHI(ebp_83, ebp_113)
// esi_91 = PHI(esi_64, esi_114)
// edi_92 = PHI(edi_80, edi_115)
// eax_93 = PHI(eax_77, eax_116)
// ax_94 = PHI(ax_78, ax_117)
}

word32 fn00401727(word32 ebp, word32 esi, word32 edi, word16 ax, word16 cx, ptr32 ebxOut, ptr32 ebpOut, ptr32 ediOut)
{
	*ediOut = edi;
	*ebpOut = ebp;
	*ebxOut = ebx;
	Mem0[edi + 0x00000018:word32]();
	Mem0[edi + 0x00000018:word32]();
	Mem0[edi + 0x00000018:word32]();
	Mem0[edi + 0x00000018:word32]();
	Mem0[edi + 0x00000018:word32]();
	Mem0[edi + 0x00000010:word32]();
	word16 ax_31 = (word16) (eax + 0x00000001) - cx;
	word16 ax_39 = (word16) DPB(eax + 0x00000001, ax_31, 0, 16);
	if (ax_31 >=u 0x0000)
	{
		word32 ebx_61;
		word32 ebp_62;
		word32 edi_63;
		return fn0040143B(ebp, esi, edi, dwArg00, dwArg04, dwArg0118, out ebx_61, out ebp_62, out edi_63);
	}
	else
	{
		fn004013D4(ebp, esi, edi, ax_39, cx);
		return ecx;
	}
}

