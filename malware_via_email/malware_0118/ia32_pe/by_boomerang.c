unsigned int global6;
__size32 global10;// 4 bytes
__size32 global18;// 4 bytes
__size32 global36;// 4 bytes
__size32 global37;// 4 bytes
__size16 global38;// 2 bytes

__size8 proc2();
__size32 proc3(__size32 param1);
__size32 proc4(LPCSTR param1, __size32 param2);
void _start(__size32 param1);
void proc5(__size32 param1);
void proc7();

// address: 0x40298d
void proc1(__size32 param1) {
    __size32 eax; 		// r24
    __size32 eax_1; 		// r24{14}
    __size32 ecx; 		// r25
    __size32 edx; 		// r26
    int local3; 		// m[esp - 12]
    int local4; 		// m[esp - 8]
    int local5; 		// m[esp - 4]

    eax_1 = proc4("advapi32", param1); /* Warning: also results in ecx, edx */
    eax = eax_1;
    if (eax_1 != 0) {
        (*eax_1)(pc, 0x40168a, pc, 0, 0, 0xf003f, eax_1, ecx, edx, LOGICALFLAGS32(eax_1), LOGICALFLAGS32(eax_1), LOGICALFLAGS32(eax_1));
    }
    if (eax != 0) {
        global18 = eax;
        local5 = 0x40297a;
        local4 = 0x4029cb;
        local3 = 0x401266;
    }
    return;
}

// address: 0x40161d
__size8 proc2() {
    return 72;
}

// address: 0x402764
__size32 proc3(__size32 param1) {
    __size32 eax; 		// r24
    __size32 ecx; 		// r25
    __size32 edx; 		// r26
    int local6; 		// m[esp - 12]
    int local7; 		// m[esp - 8]
    int local8; 		// m[esp - 4]

    eax = proc4("kernel32", param1); /* Warning: also results in ecx, edx */
    if (eax != 0) {
        (*eax)(pc, 0x40112b, pc, 0, 0, 0x4026d2, 0, 0, 0x406b1d, eax, ecx, edx, LOGICALFLAGS32(eax), LOGICALFLAGS32(eax), LOGICALFLAGS32(eax));
    }
    local8 = 0x5f3acb51;
    local7 = 0x4027aa;
    local6 = 0x401370;
    return 0x5f3acb51;
}

// address: 0x401000
__size32 proc4(LPCSTR param1, __size32 param2) {
    __size32 eax; 		// r24
    __size32 ecx; 		// r25
    __size32 edx; 		// r26
    __size32 local2; 		// param2{50}

    local2 = param2;
    if (*0x405000 == 0) {
        eax = LoadLibraryA("ntdll");
        local2 = eax;
        global6 = eax;
    }
    param2 = local2;
    if (*0x405004 == 0) {
        proc5(global6);
        global10 = param2;
    }
    eax = LoadLibraryA(param1); /* Warning: also results in ecx, edx */
    proc5(eax);
    if (eax == 0) {
    }
    return eax; /* WARNING: Also returning: ecx := ecx, edx := edx */
}

// address: 0x40306f
void _start(__size32 param1) {
    __size8 al; 		// r8
    __size32 eax; 		// r24
    __size32 ecx; 		// r25
    __size32 edx; 		// r26
    void *esp; 		// r28
    void *esp_1; 		// r28{20}
    unsigned int local0; 		// m[esp - 4]

    esp = proc1(param1);
    local0 = 0;
    al = proc2(); /* Warning: also results in esp */
    local0 = 1;
    eax = *(esp - 4);
    eax = proc3(eax); /* Warning: also results in esp_1 */
    *(__size32*)(esp_1 - 4) = 1024;
    *(__size32*)(esp_1 - 8) = 0x406ee0;
    *(__size32*)(esp_1 - 12) = 0;
    *(__size32*)(esp_1 - 16) = 0xc09edcd;
    *(__size32*)(esp_1 - 20) = 0x40112b;
    eax = proc4(*(esp_1 - 20), eax); /* Warning: also results in ecx, edx, esp */
    if (eax != 0) {
        (*eax)(pc, al, eax, ecx, edx, LOGICALFLAGS32(eax), LOGICALFLAGS32(eax), LOGICALFLAGS32(eax));
    }
    global36 = 68;
    global37 = 1;
    global38 = 2;
    local0 = 0x402ab8;
    *(__size32*)(esp - 8) = 0x4030d5;
    *(__size32*)(esp - 12) = 0x401266;
    return;
}

// address: 0x401091
void proc5(__size32 param1) {
    __size32 ecx; 		// r25
    __size32 local0; 		// m[esp - 28]

    if (param1 != 0) {
        local0 = *(param1 + 60);
        if (*(local0 + param1) == 0x4550) {
            ecx = *(local0 + param1 + 120);
            if (ecx != 0) {
                *(__size32*)(esp - 4) = ecx;
                proc7();
            }
        }
    } else {
    }
    return;
}

// address: 0x40105b
void proc7() {
}

