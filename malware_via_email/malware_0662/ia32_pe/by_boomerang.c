__size32 global13 = 0x7acfc3f3;// 4 bytes

// address: 0x401000
void _start(unsigned int param1, unsigned int param2, unsigned int param3) {
    unsigned char cl; 		// r9
    unsigned char cl_1; 		// r9{69}
    __size32 eax; 		// r24
    unsigned int eax_1; 		// r24{23}
    int eax_2; 		// r24{267}
    unsigned int eax_3; 		// r24{336}
    unsigned int eax_4; 		// r24{169}
    int eax_5; 		// r24{142}
    unsigned int ebp; 		// r29
    unsigned short *ebp_1; 		// r29
    unsigned int ebp_2; 		// r29{19}
    unsigned int ebp_3; 		// r29{42}
    void *ebp_4; 		// r29{334}
    unsigned short *ebp_5; 		// r29{340}
    unsigned int ebp_6; 		// r29{265}
    unsigned int ebx; 		// r27
    void **ebx_1; 		// r27
    unsigned int ebx_10; 		// r27{292}
    unsigned int ebx_11; 		// r27{284}
    unsigned int ebx_2; 		// r27{12}
    unsigned int ebx_3; 		// r27{270}
    unsigned int ebx_4; 		// r27{83}
    unsigned int ebx_5; 		// r27{115}
    unsigned int ebx_6; 		// r27{139}
    void **ebx_7; 		// r27{369}
    unsigned int ebx_8; 		// r27{67}
    unsigned int ebx_9; 		// r27{305}
    int ecx; 		// r25
    void *ecx_1; 		// r25
    __size32 *ecx_2; 		// r25{282}
    unsigned int edi; 		// r31
    void *edi_1; 		// r31
    int edx; 		// r26
    unsigned short *edx_1; 		// r26
    unsigned int edx_2; 		// r26{269}
    unsigned int esi; 		// r30
    int esp; 		// r28
    int local0; 		// m[esp - 44]
    __size32 *local1; 		// m[esp - 44]
    unsigned int local11; 		// m[esp - 40]
    __size32 *local17; 		// m[esp - 44]{419}
    int local18; 		// m[esp - 44]{399}
    unsigned int local19; 		// m[esp - 80]{422}
    unsigned int local2; 		// m[esp - 80]
    unsigned int local20; 		// ebp_6{265}
    unsigned int local21; 		// ebx_3{270}
    unsigned int local22; 		// ebx_8{276}
    unsigned int local23; 		// ebx_11{284}
    unsigned int local24; 		// ebx_10{292}
    unsigned int local25; 		// ebx_9{305}
    unsigned int local26; 		// param1{405}
    unsigned int local27; 		// local2{414}
    unsigned int local28; 		// local2{417}
    unsigned int local29; 		// eax_4{379}
    union { void * x11; unsigned int x12; } local4; 		// m[esp - 76]

    ebx_2 = 0;
    ebp_2 = 40;
    eax_1 = AddUsersToEncryptedFile();
    local20 = ebp_2;
    local21 = ebx_2;
    local26 = param1;
    if (eax_1 != 0) {
        esi = eax_1 + param2 * 4;
        eax = AreAllAccessesGranted();
        if (eax == 0) {
            ebp_3 = eax + 38;
            local20 = ebp_3;
        }
        ebp_6 = local20;
        ecx = VirtualProtect(); /* Warning: also results in edx */
        edi = eax_1 + param2 * 4 + param3 * 2;
        eax = 0;
        do {
            eax_2 = eax;
            edx_2 = edx;
            ebx_3 = local21;
            edx = ebx_3 + edx_2 * 4;
            local22 = ebx_3;
            if (ebx_3 == ebp_6) {
                ebx_8 = 0;
                local22 = ebx_8;
            }
            ebx_8 = local22;
            cl_1 = *(ebx_8 + 0x404000);
            cl = (cl_1 ^ *(eax_2 + 0x4015d8));
            ecx = ((ecx >> 8 & 0xffffff | (cl_1)) >> 8 & 0xffffff | (cl)) >> 8 & 0xffffff | (cl ^ 84);
            *(char*)(eax_2 + 0x4015d8) = cl ^ 84;
            esi = ebx_3 + edx_2 * 4 + esi * 8;
            eax = eax_2 + 1;
            ebx_4 = ebx_8 + 1;
            local21 = ebx_4;
            local23 = ebx_4;
        } while (eax_2 + 1 < 0x1440);
        esi = 0x401358;
        ecx_1 = 0x4028d8;
        ebp_1 = 0xf0401358;
        local0 = 0;
        do {
            ecx_2 = ecx_1;
            ebx_11 = local23;
            local18 = local0;
            eax = *(ecx_2 + 4);
            edx_1 = ecx_2 + 8;
            local25 = ebx_11;
            if ((int)((eax - 8) / 2) > 0) {
                ebx_5 = (eax - 8) / 2;
                local24 = ebx_5;
                do {
                    ebx_10 = local24;
                    eax = *(unsigned short*)edx_1;
                    edi = eax & 0xf000;
                    if ((eax & 0xf000) == 0x3000) {
                        eax = (eax & 0xfff) + *ecx_2;
                        *(__size32*)(eax + 0x401358) = *(eax + 0x401358) - 0xfbfeca8;
                    }
                    edx_1++;
                    ebx_6 = ebx_10 - 1;
                    local24 = ebx_6;
                    local25 = ebx_6;
                } while (ebx_10 != 1);
            }
            ebx_9 = local25;
            eax_5 = *(ecx_2 + 4);
            ecx_1 = ecx_2 + eax_5;
            local0 = local18 + eax_5;
            local23 = ebx_9;
        } while ((unsigned int)(local18 + eax_5) < (unsigned int)-1);
        cl = (unsigned char) ecx_2 + eax_5;
        eax = *(ecx_2 + 4);
        edx = local18 + eax_5;
        flags = SUBFLAGS32(*0x4020d4, 0, global13);
        ebx_1 = 0x4020c4;
        local1 = 0x4020c4;
        local29 = eax;
        if (*0x4020d4 != 0) {
            do {
                param1 = local26;
                edx = *(ebx_1 + 12);
                eax_4 = LoadLibraryA(edx + esi); /* Warning: also results in ecx_1 */
                local27 = param1;
                local28 = param1;
                edx = eax_4;
                edi = ebx_1 + edi * 2;
                if (eax_4 != 0) {
                    ebp_1 = *ebx_1;
                    if (ebp_1 == 0) {
                        ebp_1 = *(ebx_1 + 16);
                    }
                    ebp_4 = ebp_1;
                    ebp_1 = ebp_4 + esi;
                    edi_1 = *(local1 + 16);
                    eax = *(ebp_4 + esi);
                    edi_1 += esi;
                    if (eax != 0) {
L9:
                        eax_3 = eax;
                        ebp_5 = ebp_1;
                        if ((int)eax_3 >= 0) {
                            cl = (unsigned char) ecx_1 + ecx_1;
                            eax = GetProcAddress(eax_4, eax_3 + esi + 2); /* Warning: also results in ecx_1, edx */
                            goto L5;
                        }
                        ecx = *(unsigned short*)ebp_5;
                        cl = (unsigned char) ecx;
                        eax = GetProcAddress(eax_4, ecx); /* Warning: also results in ecx_1, edx */
                        esi = 0x401358;
L5:
                        ebp_1 = ebp_5 + 4;
                        *(__size32*)edi_1 = eax;
                        eax = *(ebp_5 + 4);
                        edi_1++;
                        local27 = local2;
                        if (eax != 0) {
                            goto L9;
                        }
                    }
                    eax_4 = eax;
                    edi = edi_1;
                    local2 = local27;
                    ebx_1 = local1;
                    local28 = local2;
                }
                ebx_7 = ebx_1;
                local2 = local28;
                ebx_1 = ebx_7 + 20;
                tmp1 = *(ebx_7 + 36);
                flags = SUBFLAGS32(*(ebx_7 + 36), 0, tmp1);
                local1 = ebx_7 + 20;
                local26 = local2;
                local29 = eax_4;
            } while (*(ebx_7 + 36) != 0);
        }
        eax_4 = local29;
        (*0x401db8)(local19, local4, pc, 0x401000, 0x3000, 64, esp - 32, -1, -1, local17, local11, 0x401358, param2, ebp, ebx, 228, 184, eax_4, 0x401db8, edx, ebx_1, ebp_1, esi, edi, flags, ZF, CF);
        *(__size32*)(esp - 4) = 0;
        ExitProcess(*(esp - 4));
    }
    return;
}

