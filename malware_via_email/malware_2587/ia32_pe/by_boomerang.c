void proc1(unsigned int param1, unsigned int *param2);

// address: 0x4151c1
void _start(__size32 param1) {
    __size32 eax; 		// r24
    unsigned int eax_1; 		// r24{292}
    void *ebp; 		// r29
    int ecx; 		// r25
    int edx; 		// r26
    int esp; 		// r28
    void *esp_1; 		// r28{18}
    void *esp_10; 		// r28{469}
    void *esp_11; 		// r28{106}
    void *esp_12; 		// r28{190}
    union { int x41; void * x42; } esp_13; 		// r28{501}
    void *esp_14; 		// r28{231}
    void *esp_15; 		// r28{292}
    void *esp_16; 		// r28{369}
    void *esp_2; 		// r28{49}
    union { void * x79; int x80; } esp_3; 		// r28{79}
    void *esp_4; 		// r28{87}
    void *esp_5; 		// r28{510}
    void *esp_6; 		// r28{310}
    void *esp_7; 		// r28{340}
    void *esp_8; 		// r28{348}
    void *esp_9; 		// r28{399}
    __size32 local0; 		// m[esp - 4]
    unsigned int local1; 		// m[esp - 80]
    void *local10; 		// esp_11{483}
    void *local11; 		// esp_12{492}
    union { int x41; void * x42; } local12; 		// esp_13{501}
    __size32 local13; 		// local2{546}
    unsigned int local14; 		// local6{547}
    void *local15; 		// esp_5{510}
    void *local16; 		// esp_15{518}
    __size32 local17; 		// local0{548}
    unsigned int local18; 		// local1{549}
    void *local19; 		// esp_16{527}
    __size32 local2; 		// m[esp - 4]{1}
    __size32 local20; 		// local0{550}
    unsigned int local21; 		// local1{551}
    void *local22; 		// esp_14{536}
    int local3; 		// m[esp - 4]{310}
    int local4; 		// m[esp - 4]{348}
    __size32 local5; 		// m[esp - 4]{552}
    unsigned int local6; 		// m[esp - 80]{16}
    int local7; 		// m[esp - 80]{310}
    int local8; 		// m[esp - 80]{348}
    unsigned int local9; 		// m[esp - 80]{553}

    local2 = param1;
    ebp = esp - 4;
    GetCommandLineA();
    GetLastError();
    esp_1 = GetCommandLineA();
    local10 = esp_1;
    do {
        esp_11 = local10;
        GetCommandLineA();
        *(__size32*)(esp_11 - 4) = 0;
        *(__size32*)(esp_11 - 8) = 32;
        *(__size32*)(esp_11 - 12) = 3;
        *(__size32*)(esp_11 - 16) = 0;
        *(__size32*)(esp_11 - 20) = 4;
        *(__size32*)(esp_11 - 24) = 0x80000000;
        *(__size32*)(esp_11 - 28) = 0x42fc8d;
        eax = CreateFileA();
        *(__size32*)(ebp - 20) = eax;
        *(__size32*)(esp_11 - 32) = 0;
        *(__size32*)(esp_11 - 36) = *(ebp - 20);
        esp_2 = GetFileSize();
        local11 = esp_2;
L48:
        esp_12 = local11;
        GetLastError();
        local13 = local2;
        local14 = local6;
        *(__size32*)(esp_12 - 4) = *(ebp - 20);
        CloseHandle(*(esp_12 - 4));
        GetLastError();
        *(__size32*)(esp_12 - 4) = *(ebp - 20);
        GetFileType();
        *(__size32*)(esp_12 - 8) = 0;
        *(__size32*)(esp_12 - 12) = 167;
        *(__size32*)(esp_12 - 16) = 3;
        *(__size32*)(esp_12 - 20) = 0;
        *(__size32*)(esp_12 - 24) = 7;
        esp_3 = esp_12 - 24;
        local12 = esp_3;
L43:
        esp_13 = local12;
        local2 = local13;
        local6 = local14;
        *(__size32*)(esp_13 - 4) = 0x80000000;
        *(__size32*)(esp_13 - 8) = 0x42fc53;
        eax = CreateFileA(); /* Warning: also results in esp_4 */
        local15 = esp_4;
        local17 = local2;
        local18 = local6;
        *(__size32*)(ebp - 40) = eax;
L41:
        esp_5 = local15;
        *(__size32*)(esp_5 - 4) = 0;
        *(__size32*)(esp_5 - 8) = 417;
        *(__size32*)(esp_5 - 12) = 3;
        *(__size32*)(esp_5 - 16) = 0;
        *(__size32*)(esp_5 - 20) = 6;
        *(__size32*)(esp_5 - 24) = 0;
        *(__size32*)(esp_5 - 28) = 0x42fce9;
        eax = CreateFileA(); /* Warning: also results in esp_11 */
        local10 = esp_11;
        *(__size32*)(ebp - 48) = eax;
    } while (eax != -1);
    GetCommandLineA();
    *(__size32*)(esp_5 - 32) = 0;
    *(__size32*)(esp_5 - 36) = 163;
    *(__size32*)(esp_5 - 40) = 3;
    *(__size32*)(esp_5 - 44) = 0;
    *(__size32*)(esp_5 - 48) = 7;
    *(__size32*)(esp_5 - 52) = 0x20000000;
    *(__size32*)(esp_5 - 56) = 0x42fc4b;
    eax = CreateFileW();
    *(__size32*)(ebp - 44) = eax;
    *(__size32*)(esp_5 - 60) = 0x42fc2e;
    eax = GetModuleHandleA();
    *(__size32*)(ebp - 36) = eax;
    *(__size32*)(esp_5 - 64) = 0;
    *(__size32*)(esp_5 - 68) = 130;
    *(__size32*)(esp_5 - 72) = 3;
    *(__size32*)(esp_5 - 76) = 0;
    *(__size32*)(esp_5 - 80) = 4;
    *(__size32*)(esp_5 - 84) = 0xc0000000;
    *(__size32*)(esp_5 - 88) = 0x42fc67;
    eax = CreateFileW(); /* Warning: also results in esp */
    local15 = esp;
    *(__size32*)(ebp - 4) = eax;
    if (eax != -1) {
        goto L41;
    }
    *(__size32*)(esp_5 - 92) = 0;
    *(__size32*)(esp_5 - 96) = *(ebp - 40);
    GetFileSize();
    *(__size32*)(esp_5 - 100) = 0x42fcf4;
    *(__size32*)(esp_5 - 104) = 0;
    *(__size32*)(esp_5 - 108) = 257;
    *(__size32*)(esp_5 - 112) = 3;
    *(__size32*)(esp_5 - 116) = 0;
    *(__size32*)(esp_5 - 120) = 3;
    *(__size32*)(esp_5 - 124) = 0xc0000000;
    *(__size32*)(esp_5 - 128) = 0x42fc72;
    eax = CreateFileW(); /* Warning: also results in esp_12 */
    local11 = esp_12;
    *(__size32*)(ebp - 64) = eax;
    if (eax != -1) {
        goto L48;
    }
    *(__size32*)(esp_5 - 132) = *(ebp - 40);
    CloseHandle(*(esp_5 - 132));
    *(__size32*)(esp_5 - 132) = *(ebp - 36);
    *(__size32*)(esp_5 - 136) = *(ebp - 64);
    CloseHandle(*(esp_5 - 136));
    eax = GetProcAddress(*(esp_5 - 132), *(esp_5 - 128));
    *(__size32*)(ebp - 56) = eax;
    *(__size32*)(esp_5 - 128) = 0;
    *(__size32*)(esp_5 - 132) = 5;
    *(__size32*)(esp_5 - 136) = 3;
    *(__size32*)(esp_5 - 140) = 0;
    *(__size32*)(esp_5 - 144) = 2;
    *(__size32*)(esp_5 - 148) = 0x20000000;
    *(__size32*)(esp_5 - 152) = 0x42fcbe;
    eax = CreateFileW(); /* Warning: also results in esp_14 */
    local22 = esp_14;
    *(__size32*)(ebp - 8) = eax;
    if (eax == -1) {
        GetLastError();
        *(__size32*)(esp_5 - 156) = 0;
        *(__size32*)(esp_5 - 160) = 295;
        *(__size32*)(esp_5 - 164) = 3;
        *(__size32*)(esp_5 - 168) = 0;
        *(__size32*)(esp_5 - 172) = 7;
        *(__size32*)(esp_5 - 176) = 0xe0000000;
        *(__size32*)(esp_5 - 180) = 0x42fcdb;
        eax = CreateFileW();
        *(__size32*)(ebp - 72) = eax;
        *(__size32*)(esp_5 - 184) = 0;
        *(__size32*)(esp_5 - 188) = *(ebp - 72);
        GetFileSize();
        *(__size32*)(esp_5 - 192) = *(ebp - 8);
        GetFileType();
        *(__size32*)(esp_5 - 196) = 0;
        *(__size32*)(esp_5 - 200) = 0;
        *(__size32*)(esp_5 - 204) = 289;
        *(__size32*)(esp_5 - 208) = 3;
        *(__size32*)(esp_5 - 212) = 0;
        *(__size32*)(esp_5 - 216) = 6;
        *(__size32*)(esp_5 - 220) = 0xe0000000;
        *(__size32*)(esp_5 - 224) = 0x42fc92;
        eax_1 = CreateFileA(); /* Warning: also results in esp_15 */
        local16 = esp_15;
        *(unsigned int*)(ebp - 24) = eax_1;
        if (eax_1 == -1) {
            *(__size32*)(esp_5 - 228) = 0;
            *(__size32*)(esp_5 - 232) = 0;
            *(__size32*)(esp_5 - 236) = *(ebp - 64);
            eax = GetFileSize(); /* Warning: also results in ecx, edx */
            (**(ebp - 56))(local6, local2, eax, ecx, edx, ebp, SUBFLAGS32(eax_1, -1, eax_1 + 1), eax_1 + 1 == 0, eax_1 < (unsigned int)-1);
            local16 = esp_6;
            local17 = local3;
            local18 = local7;
            *(unsigned int*)(ebp - 52) = eax;
        }
        esp_15 = local16;
        local0 = local17;
        local1 = local18;
        eax = *(ebp - 52);
        *(__size32*)(ebp - 68) = eax;
        GetCommandLineA();
        local20 = local0;
        local21 = local1;
        *(int*)(ebp - 68) = *(ebp - 68) ^ 0xc0000008;
        *(__size32*)(ebp - 68) += 0x4154ab;
        *(__size32*)(esp_15 - 4) = 0;
        *(__size32*)(esp_15 - 8) = 37;
        *(__size32*)(esp_15 - 12) = 3;
        *(__size32*)(esp_15 - 16) = 0;
        *(__size32*)(esp_15 - 20) = 5;
        *(__size32*)(esp_15 - 24) = 0x40000000;
        *(__size32*)(esp_15 - 28) = 0x42fc38;
        eax = CreateFileA(); /* Warning: also results in ecx, edx, esp_7 */
        local19 = esp_7;
        do {
            esp_16 = local19;
            local0 = local20;
            local1 = local21;
            *(unsigned int*)(ebp - 28) = eax;
            local12 = esp_16;
            local13 = local0;
            local14 = local1;
            if (eax != -1) {
                goto L43;
            } else {
                (**(ebp - 68))(local1, local0, eax, ecx, edx, ebp, SUBFLAGS32(eax, -1, eax + 1), eax + 1 == 0, eax < (unsigned int)-1);
                local20 = local4;
                local21 = local8;
                *(union { void * x83; int x84; }*)(esp_8 - 4) = ebp - 32;
                *(__size32*)(esp_8 - 8) = 0;
                *(__size32*)(esp_8 - 12) = 390;
                *(__size32*)(esp_8 - 16) = 3;
                *(__size32*)(esp_8 - 20) = 0;
                *(__size32*)(esp_8 - 24) = 2;
                *(__size32*)(esp_8 - 28) = 0xe0000000;
                *(__size32*)(esp_8 - 32) = 0x42fca0;
                eax = CreateFileW(); /* Warning: also results in ecx, edx, esp_16 */
                local19 = esp_16;
                goto L12;
            }
L12:
            *(unsigned int*)(ebp - 60) = eax;
        } while (eax != -1);
        *(__size32*)(esp_8 - 36) = 64;
        GetLastError();
        *(__size32*)(esp_8 - 40) = 0x141a9;
        *(__size32*)(esp_8 - 44) = 0x401000;
        *(__size32*)(esp_8 - 48) = *(ebp - 24);
        GetFileType();
        *(__size32*)(esp_8 - 52) = *(ebp - 72);
        CloseHandle(*(esp_8 - 52));
        esp_9 = VirtualProtect();
        local22 = esp_9;
    }
    esp_14 = local22;
    *(__size32*)(esp_14 - 4) = 0x401000;
    *(__size32*)(esp_14 - 8) = *(ebp - 52);
    *(__size32*)(esp_14 - 12) = 0x141a9;
    GetCommandLineA();
    *(__size32*)(esp_14 - 16) = 0;
    *(__size32*)(esp_14 - 20) = 166;
    *(__size32*)(esp_14 - 24) = 3;
    *(__size32*)(esp_14 - 28) = 0;
    *(__size32*)(esp_14 - 32) = 4;
    *(__size32*)(esp_14 - 36) = 0x20000000;
    *(__size32*)(esp_14 - 40) = 0x42fd08;
    eax = CreateFileA();
    *(__size32*)(ebp - 16) = eax;
    eax = *(ebp - 52);
    *(__size32*)(ebp - 68) = eax;
    GetCommandLineA();
    *(__size32*)(ebp - 68) += 0x3ffffff8;
    *(__size32*)(esp_14 - 44) = *(ebp - 4);
    CloseHandle(*(esp_14 - 44));
    tmp1 = *(ebp - 68);
    *(__size32*)(ebp - 68) += 0x4155e8;
    *(__size32*)(esp_14 - 44) = 0;
    *(__size32*)(esp_14 - 48) = 164;
    *(__size32*)(esp_14 - 52) = 3;
    *(__size32*)(esp_14 - 56) = 0;
    *(__size32*)(esp_14 - 60) = 5;
    *(__size32*)(esp_14 - 64) = 0xc0000000;
    *(__size32*)(esp_14 - 68) = 0x42fc59;
    eax = CreateFileW(); /* Warning: also results in ecx, edx */
    *(__size32*)(ebp - 12) = eax;
    (**(ebp - 68))(local9, local5, eax, ecx, edx, ebp, ADDFLAGS32(tmp1, 0x4155e8, *(ebp - 68)), ADDFLAGS32(tmp1, 0x4155e8, *(ebp - 68)), ADDFLAGS32(tmp1, 0x4155e8, *(ebp - 68)));
    proc1(local1, local0, eax, ecx, edx, ebp, <all>, flags, ZF, CF);
    return;
}

// address: 0x401024
void proc1(unsigned int param1, unsigned int *param2) {
    tmp1 = *param2;
    *(unsigned int*)param2 = tmp1 - param1 + CF;
}

