// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1160/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn0040116C(word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, selector fs)
{
fn0040116C_entry:
l0040116C:
	word32 esp_15 = fp - 0x00000008
l00401175:
	Mem16[fs:0x00000000:word32] = esp_15
	Mem19[0x00000000:word32] = ecx
	esp_15 = esp_15 - 0x00000004
	Mem21[esp_15 + 0x00000000:word32] = 0x00000000
	ebx = ebx + 0x00000001
	byte al_26 = Mem21[0x00000000:byte] ^ 0x00
	ebp = ebp + 0x00000001
	byte bh_24 = SLICE(ebx, byte, 8)
	byte bl_25 = (byte) ebx
	word32 eax_27 = (word32) al_26
	branch !OVERFLOW(al_26) l0040119C
l0040118B:
	Mem38[esp_15 - 0x00000004:word32] = esp_15 - 0x00000004
l0040119C:
	ecx = ecx - 0x00000001
	branch al_26 != 0x00 && ecx != 0x00000000 l00401175
l0040119E:
	byte bh_40 = bh_24 - al_26
	word32 ebx_41 = DPB(ebx, bh_40, 8, 8)
	word32 ebp_42 = ebp + Mem21[(esp_15 + 0x463F0021) + eax_27:word32]
	branch ebp_42 < 0x00000000 l004011D6
l004011A9:
	byte al_68 = al_26 + 0x40 + (ebp_42 <u 0x00000000)
	byte al_106 = al_68 + 0x74 + (DPB(eax_27, al_68, 0, 8) <u 0x6C1F0F8B)
	word32 esp_121 = Mem21[esp_15 + 0x00000000:word32] + 0x00000004
	word32 eax_107 = DPB(eax_27, al_106, 0, 8)
	byte C_112 = cond(al_106)
l004011B2:
	byte al_95 = al_106 + 0x70 + C_112
	edx = DPB(edx, 0xE7, 8, 8) (alias)
	word32 v19_102 = Mem21[esp_121 + 0x778E3CB0 + edx:word32] + ebx_41
	Mem103[esp_121 + 0x778E3CB0 + edx:word32] = v19_102
	byte al_98 = al_95 - 0x3A - (al_95 <u 0x00)
	branch v19_102 == 0x00000000 l00401226
l004011C2:
	Mem115[edi + 0x00000000:byte] = Mem103[esi + 0x00000000:byte]
	word32 esp_119 = esp_121 + 0x00000002
	al_106 = al_98 & 0x84
	eax_107 = DPB(eax_107, al_98 & 0x84, 0, 8) (alias)
	C_112 = false
	esi = esi + 0x00000001
	edi = edi + 0x00000001
	esp_121 = esp_119 + 0x00000004
	branch ecx == 0x00000000 l004011B2
l004011CA:
	Mem123[esp_119 + 0x00000000:word32] = eax_107
	byte al_126
	__daa(al_98 & 0x84, &al_126)
l004011D6:
	word32 eax_160 = DPB(eax_27, __inb(0xB8), 0, 8)
	(eax_160 + 0x333D6692)[eax_160 * 0x04] = (eax_160 + 0x333D6692)[eax_160 * 0x04] - bl_25
	Mem164[edx + 0x53678868:byte] = Mem162[edx + 0x53678868:byte] >> 0x5B
	return
l00401226:
	byte v26_130 = Mem103[esi + 0xE3ACC410:byte] + bh_40
	Mem131[esi + 0xE3ACC410:byte] = v26_130
	word32 esp_128 = esp_121 & ebx_41
	branch OVERFLOW(v26_130) l00401268
l00401230:
l00401246:
	Mem151[esp_128 - 0x00000004:word32] = cs
l00401268:
	branch v26_130 == 0x00 && ecx != 0x00000001 l004012E2
l0040126A:
	word32 eax_141 = __indw(0x60)
	byte al_142 = (byte) eax_141
	__outb(0xF6, al_142)
	__outb(edx, al_142)
	branch eax_141 >= esp_128 l00401246
l0040127A:
l004012E2:
	return
fn0040116C_exit:
}

