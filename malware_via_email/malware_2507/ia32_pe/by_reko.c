// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00414B7B: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 edi_3 = edi;
	word32 ebp_34 = dwArg04;
	word32 eax_12 = IsWindowEnabled(dwArg04);
	word32 esp_17 = fp;
	if ((eax_12 | 0x04) == 0x04)
	{
		eax_12 = fn00414BD8((byte) GetProfileIntA(fp - 0x04, fp - 0x04, 0xF3), ecx, out ecx, out edx, out ebp_34, out esi, out edi_3);
		esp_17 = fp + 0x24;
	}
	word32 esp_38 = esp_17 - 0x04;
	Mem39[esp_38 + 0x00:word32] = ecx;
	Mem41[esp_38 - 0x04 + 0x00:word32] = eax_12;
	byte bl_43 = (byte) Mem41[esp_38 - 0x04 + 0x00:word32];
	Mem46[esp_38 - 0x04 + 0x00:word32] = edi_3;
	word32 ecx_47 = ecx + 48707;
	if (edi_3 != esi)
	{
		word32 ecx_57;
		word32 edx_58;
		word32 ebp_59;
		word32 esi_60;
		word32 edi_61;
		return fn00414C1E(ecx_47, edx, bl_43, ebp_34, esi, edi_3, out ecx_57, out edx_58, out ebp_59, out esi_60, out edi_61);
	}
	else
		return esp_38 - 0x04;
}

// 00414BD8: Register word32 fn00414BD8(Register byte bl, Stack word32 dwArg00, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn00414BD8(byte bl, word32 dwArg00, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	esp = fp;
	esp = fp - 0x04;
	dwLoc04 = eax;
	esp = fp - 0x08;
	dwLoc08 = 0x40;
	esp = fp - 0x0C;
	dwLoc0C = 0x3000;
	esp = fp - 0x10;
	dwLoc10 = 95331;
	esp = fp - 0x14;
	dwLoc14 = 0x00;
	eax = VirtualAlloc(0x00, 95331, 0x3000, 0x40);
	esp = fp - 0x04;
	ecx = dwLoc04;
	esp = fp;
	edi = dwArg00;
	esp = fp + 0x04;
	esp = fp;
	dwArg00 = edi;
	edi = edi + 0xC9;
	esi = eax;
	ecx = 0x0262;
	cl = (byte) ecx;
	esp = fp - 0x04;
	dwLoc04 = eax;
	v8 = esi;
	esi = edi;
	edi = v8;
	edx = 1772192074;
	dl = (byte) edx;
	dl = dl + bl;
	edx = DPB(edx, dl, 0);
	ebp = 0x00;
	SZO = cond(0x00);
	C = false;
	eax = fn00414C1E(ecx, edx, bl, ebp, esi, edi, out ecx, out edx, out ebp, out esi, out edi);
	return eax;
}

// 00414C1E: Register word32 fn00414C1E(Register word32 ecx, Register word32 edx, Register byte bl, Register word32 ebp, Register word32 esi, Register word32 edi, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn00414C1E(word32 ecx, word32 edx, byte bl, word32 ebp, word32 esi, word32 edi, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
fn00414C1E_entry:
	def ebp
	def C
	def SZO
	def edi
	def esi
	def ecx
	def edx
	def v3
	def bl
	def ecxOut
	def edxOut
	def ebpOut
	def esiOut
	def ediOut
l00414C1E:
	ebp_7 = PHI(ebp_43, ebp)
	C_8 = PHI(C_54, C)
	SZO_9 = PHI(SZO_52, SZO)
	edi_10 = PHI(edi_33, edi)
	esi_11 = PHI(esi_32, esi)
	ecx_12 = PHI(ecx_50, ecx)
	edx_13 = PHI(edx_48, edx)
	esp_15 = v3
	esp_16 = esp_15 - 0x04
	Mem17[esp_16 + 0x00:word32] = edx_13
	esp_18 = esp_16 - 0x04
	Mem19[esp_18 + 0x00:word32] = ecx_12
	edx_20 = esp_18
	edx_21 = edx_20 + 0x77
	ecx_22 = Mem19[esi_11 + 0x00:word32]
	ecx_23 = ecx_22 + Mem19[(edx_21 - 115) + 0x00:word32]
	cl_24 = (byte) ecx_23 (alias)
	v10_25 = Mem19[edi_10 + 0x00:byte] + cl_24
	Mem26[edi_10 + 0x00:byte] = v10_25
	ecx_27 = Mem26[esp_18 + 0x00:word32]
	cl_28 = (byte) ecx_27 (alias)
	esp_29 = esp_18 + 0x04
	edx_30 = Mem26[esp_29 + 0x00:word32]
	esp_31 = esp_29 + 0x04
	esi_32 = esi_11 + 0x01
	edi_33 = edi_10 + 0x01
	eax_34 = 0x00
	eax_35 = 0x04
	ebp_36 = ebp_7 + 0x0009676A
	ebp_37 = ebp_36 - 0x00096769
	edx_38 = edx_30 >>u 0x08
	dl_39 = (byte) edx_38 (alias)
	SCZO_40 = cond(0x04 - ebp_37)
	Z_41 = SCZO_40 (alias)
	branch 0x04 != ebp_37 l00414C59
l00414C51:
	esp_113 = esp_31 - 0x04
	Mem114[esp_113 + 0x00:word32] = 1772192074
	edx_115 = Mem114[esp_113 + 0x00:word32]
	dl_116 = (byte) edx_115 (alias)
	esp_117 = esp_113 + 0x04
	ebp_118 = 0x00
	SZO_119 = cond(0x00)
	C_120 = false
l00414C59:
	dl_42 = PHI(dl_116, dl_39)
	ebp_43 = PHI(ebp_118, ebp_37)
	edx_44 = PHI(edx_115, edx_38)
	esp_45 = PHI(esp_117, esp_31)
	dl_47 = dl_42 + bl
	edx_48 = DPB(edx_44, dl_47, 0) (alias)
	ecx_49 = ecx_27 - 0x000437B7
	ecx_50 = ecx_49 + 276406
	cl_51 = (byte) ecx_50 (alias)
	SZO_52 = cond(ecx_50 & ecx_50)
	Z_53 = SZO_52 (alias)
	C_54 = false
	branch (ecx_50 & ecx_50) != 0x00 l00414C1E
l00414C6B:
	edx_55 = Mem26[esp_45 + 0x00:word32]
	dl_56 = (byte) edx_55 (alias)
	esp_57 = esp_45 + 0x04
	SCZO_58 = cond(edx_55 - esp_57)
	Z_59 = SCZO_58 (alias)
	branch edx_55 == esp_57 l00414C77
l00414C75:
	call edx_55 (retsize: 4; depth: 4)
		uses: bl,C_54,cl_51,dl_56,eax_35,ebp_43,ecx_50,edi_33,edx_55,esi_32,esp_57,SCZO_58,SZO_52,Z_59
		defs: bl_112,C_108,cl_105,dl_111,eax_106,ebp_109,ecx_101,edi_104,edx_100,esi_103,esp_99,SCZO_102,SZO_107,Z_110
l00414C77:
	bl_60 = PHI(bl, bl_112)
	dl_61 = PHI(dl_56, dl_111)
	ebp_62 = PHI(ebp_43, ebp_109)
	eax_63 = PHI(eax_35, eax_106)
	cl_64 = PHI(cl_51, cl_105)
	edi_65 = PHI(edi_33, edi_104)
	esi_66 = PHI(esi_32, esi_103)
	SCZO_67 = PHI(SCZO_58, SCZO_102)
	ecx_68 = PHI(ecx_50, ecx_101)
	edx_69 = PHI(edx_55, edx_100)
	esp_70 = PHI(esp_57, esp_99)
	SZO_71 = cond(eax_63 & edx_69)
	Z_72 = SZO_71 (alias)
	C_73 = false
	branch (eax_63 & edx_69) == 0x00 l00414BD8
	goto l00414C7F
l00414C79_thunk_fn00414BD8:
	eax = fn00414BD8(bl, dwLoc04, out ecx, out edx, out ebp, out esi, out edi)
	return eax
l00414C7F:
	call ecx_68 (retsize: 4; depth: 4)
		uses: bl_60,C_73,cl_64,dl_61,eax_63,ebp_62,ecx_68,edi_65,edx_69,esi_66,esp_70,SCZO_67,SZO_71,Z_72
		defs: bl_87,C_83,cl_80,dl_86,eax_81,ebp_84,ecx_76,edi_79,edx_75,esi_78,esp_74,SCZO_77,SZO_82,Z_85
	return eax_81
fn00414C1E_exit:
	ebp_88 = PHI(ebp, ebp_84)
	eax_89 = PHI(eax, eax_81)
	edi_90 = PHI(edi, edi_79)
	esi_91 = PHI(esi, esi_78)
	ecx_92 = PHI(ecx, ecx_76)
	edx_93 = PHI(edx, edx_75)
	use ecx_92 (=> ecxOut)
	use edx_93 (=> edxOut)
	use ebp_88 (=> ebpOut)
	use esi_91 (=> esiOut)
	use edi_90 (=> ediOut)
}

