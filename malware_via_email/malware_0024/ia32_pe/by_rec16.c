/*	This file was automatically created by
 *	Reverse Engineering Compiler 1.6 (C) Giampiero Caprino (Mar 31 2002)
 *	Input file: './malware_via_email/malware_0024/ia32_pe/subject.exe'
 */

/*	Procedure: 0x004016C4 - 0x004016CF
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004016C4()
{



    goto ( *__imp__GetCommandLineW);
    goto ( *__imp__SetConsoleCP);
}

/* DEST BLOCK NOT FOUND: 004016d0 -> 004016b8 */
/*	Procedure: 0x004016D0 - 0x004016D5
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

CreateSemaphoreW()
{



    goto ( *__imp__CreateSemaphoreW);
}

/* DEST BLOCK NOT FOUND: 004016d6 -> 004016b8 */
/*	Procedure: 0x004016D6 - 0x004016DB
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

Sleep()
{



    goto ( *__imp__Sleep);
}

/* DEST BLOCK NOT FOUND: 004016dc -> 004016b8 */
/*	Procedure: 0x004016DC - 0x004016E1
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

ExitProcess()
{



    goto ( *__imp__ExitProcess);
}

/* DEST BLOCK NOT FOUND: 004016e2 -> 004016b8 */
/*	Procedure: 0x004016E2 - 0x004016E7
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

FindResourceW()
{



    goto ( *__imp__FindResourceW);
}

/* DEST BLOCK NOT FOUND: 004016e8 -> 004016b8 */
/*	Procedure: 0x004016E8 - 0x004016ED
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

GetEnvironmentVariableW()
{



    goto ( *__imp__GetEnvironmentVariableW);
}

/* DEST BLOCK NOT FOUND: 004016ee -> 004016b8 */
/*	Procedure: 0x004016EE - 0x004016F3
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

SetStdHandle()
{



    goto ( *__imp__SetStdHandle);
}

/* DEST BLOCK NOT FOUND: 004016f4 -> 004016b8 */
/*	Procedure: 0x004016F4 - 0x004016F9
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

GetTickCount()
{



    goto ( *__imp__GetTickCount);
}

/* DEST BLOCK NOT FOUND: 004016fa -> 004016b8 */
/*	Procedure: 0x004016FA - 0x004016FF
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

GetLocaleInfoA()
{



    goto ( *__imp__GetLocaleInfoA);
}

/* DEST BLOCK NOT FOUND: 00401700 -> 004016b8 */
/*	Procedure: 0x00401700 - 0x00401705
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

GetOEMCP()
{



    goto ( *__imp__GetOEMCP);
}

/* DEST BLOCK NOT FOUND: 00401706 -> 004016b8 */
/*	Procedure: 0x00401706 - 0x0040170B
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

GetFileType()
{



    goto ( *__imp__GetFileType);
}

/* DEST BLOCK NOT FOUND: 0040170c -> 004016b8 */
/*	Procedure: 0x0040170C - 0x00401711
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

GetStartupInfoA()
{



    goto ( *__imp__GetStartupInfoA);
}

/* DEST BLOCK NOT FOUND: 00401712 -> 004016b8 */
/*	Procedure: 0x00401712 - 0x00401717
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

VirtualProtect()
{



    goto ( *__imp__VirtualProtect);
}

/* DEST BLOCK NOT FOUND: 00401718 -> 004016b8 */
/*	Procedure: 0x00401718 - 0x0040171D
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

GetModuleHandleA()
{



    goto ( *__imp__GetModuleHandleA);
}

/* DEST BLOCK NOT FOUND: 0040171e -> 004016b8 */
/*	Procedure: 0x0040171E - 0x00401723
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

HeapAlloc()
{



    goto ( *__imp__HeapAlloc);
}

/* DEST BLOCK NOT FOUND: 00401724 -> 004016b8 */
/*	Procedure: 0x00401724 - 0x00401729
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

GetACP()
{



    goto ( *__imp__GetACP);
}

/* DEST BLOCK NOT FOUND: 0040172a -> 004016b8 */
/*	Procedure: 0x0040172A - 0x0040172F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

?what()
{



    goto ( *__imp__?what);
}

/* DEST BLOCK NOT FOUND: 00401730 -> 004016b8 */
/*	Procedure: 0x00401730 - 0x00401735
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

__p__fmode()
{



    goto ( *__imp____p__fmode);
}

/* DEST BLOCK NOT FOUND: 00401736 -> 004016b8 */
/*	Procedure: 0x00401736 - 0x0040173B
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

RegOpenKeyExA()
{



    goto ( *__imp__RegOpenKeyExA);
}

/* DEST BLOCK NOT FOUND: 0040173c -> 004016b8 */
/*	Procedure: 0x0040173C - 0x00401741
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

RegEnumKeyExA()
{



    goto ( *__imp__RegEnumKeyExA);
}

/* DEST BLOCK NOT FOUND: 00401742 -> 004016b8 */
/*	Procedure: 0x00401742 - 0x00401747
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

CombineRgn()
{



    goto ( *__imp__CombineRgn);
}

/* DEST BLOCK NOT FOUND: 00401748 -> 004016b8 */
/*	Procedure: 0x00401748 - 0x0040174D
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

I_RpcBCacheFree()
{



    goto ( *__imp__I_RpcBCacheFree);
}

/* DEST BLOCK NOT FOUND: 004018de -> 00401001 */
stack space not deallocated on return
/*	Procedure: 0x0040174E - 0x004018E2
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

__entry_point__()
{



    (save)ebp;
    ebp = esp;
    esp = esp - 24;
    edx = edx + eax - edi;
    esp = ebp;
    (restore)ebp;
    edx = edx & -871418602;
    (save)0x401779;
    ecx = (2003887152 ^ esi) + edx;
    return;
    ecx = ecx - esi;
    eax = eax + 1;
    (save)ebx;
    edx = edx ^ ecx;
    eax = eax & 119;
    ecx = ecx + -41;
    (save)edi;
    eax = ((eax & ebx | 35) ^ ecx) - -118;
    (save)esi;
    ecx = ecx & 87;
    eax = eax & -106;
    edx = 3;
    edx = 7;
    L004016C4();
    eax = edx;
    ecx = ecx - 1108018850 & esi;
    edx = edx - -72;
    eax = eax - 1;
    eax = I_RpcBCacheFree(0);
    if(!(edx = edx + ebx)) {
        edx = edx & 1645989738 & 37203724;
        ecx = ecx + 34881470;
        ecx = edi;
        goto ( *eax);
        ecx = ecx & -2005273757;
        edx = edx + 1214809679;
        ecx = ecx | 1376182772;
        return;
    }
    (save)0;
    ecx = ecx - edi;
    edi = (edi | 121) - 270121021;
    (save)esp;
    edx = edx & eax;
    ecx = ecx ^ -1337421346 | 840195272;
    edx = edx & edi;
    ecx = ecx ^ 841016074;
    (save)64;
    eax = eax ^ 283276991;
    (save)1732;
    edx = edx - 104;
    eax = VirtualProtect(0x401000);
    edx = (edx | 55) + eax;
    edi = edi ^ ebx;
    edx = edx - -1534843576 + 6;
    eax = (eax | 6) + 1;
    edx = -101 ^ ebx;
    esi = 0x401000;
    eax = eax | -269087141;
    eax = eax - 1;
    ecx = -269087141;
    ebx = 1732 >> 2;
L00401874:
    edx = (edx | 139785376) & ecx;
    edi = edi + 309652123;
    ecx = ecx - 1;
    edx = edx - 414156403;
    asm("lodsd");
    edx = edx - esi;
    eax = eax - 1645060490 ^ 1645060490;
    *(esi - 4) = eax;
    edx = edx + 86;
    edi = edi | -13;
    edi = 2;
    if(ebx = ebx - 1) {
        goto L00401874;
    }
    esi = esi | 43;
    eax = eax - 1644860795 ^ 2;
    esi = esi | -767935827;
    (restore)esi;
    (restore)edi;
    ecx = ecx | 1376590951;
    edx = 271387519;
    (restore)ebx;
    ecx = ecx + -527713007 | 77;
    eax = eax - -125 | 85;
    goto L00401001;
}

/* address  size  */
/* 0x004016d0       0 */ /* unknown */ void 	CreateSemaphoreW;
/* 0x004016d6       0 */ /* unknown */ void 	Sleep;
/* 0x004016dc       0 */ /* unknown */ void 	ExitProcess;
/* 0x004016e2       0 */ /* unknown */ void 	FindResourceW;
/* 0x004016e8       0 */ /* unknown */ void 	GetEnvironmentVariableW;
/* 0x004016ee       0 */ /* unknown */ void 	SetStdHandle;
/* 0x004016f4       0 */ /* unknown */ void 	GetTickCount;
/* 0x004016fa       0 */ /* unknown */ void 	GetLocaleInfoA;
/* 0x00401700       0 */ /* unknown */ void 	GetOEMCP;
/* 0x00401706       0 */ /* unknown */ void 	GetFileType;
/* 0x0040170c       0 */ /* unknown */ void 	GetStartupInfoA;
/* 0x00401712       0 */ /* unknown */ void 	VirtualProtect;
/* 0x00401718       0 */ /* unknown */ void 	GetModuleHandleA;
/* 0x0040171e       0 */ /* unknown */ void 	HeapAlloc;
/* 0x00401724       0 */ /* unknown */ void 	GetACP;
/* 0x0040172a       0 */ /* unknown */ void 	?what;
/* 0x00401730       0 */ /* unknown */ void 	__p__fmode;
/* 0x00401736       0 */ /* unknown */ void 	RegOpenKeyExA;
/* 0x0040173c       0 */ /* unknown */ void 	RegEnumKeyExA;
/* 0x00401742       0 */ /* unknown */ void 	CombineRgn;
/* 0x00401748       0 */ /* unknown */ void 	I_RpcBCacheFree;
/* 0x0040174e       0 */ /* unknown */ void 	__entry_point__;
/* 0x004020e8       0 */ /* unknown */ void 	__imp__GetCommandLineW;
/* 0x004020ec       0 */ /* unknown */ void 	__imp__SetConsoleCP;
/* 0x004020f0       0 */ /* unknown */ void 	__imp__CreateSemaphoreW;
/* 0x004020f4       0 */ /* unknown */ void 	__imp__Sleep;
/* 0x004020f8       0 */ /* unknown */ void 	__imp__ExitProcess;
/* 0x004020fc       0 */ /* unknown */ void 	__imp__FindResourceW;
/* 0x00402100       0 */ /* unknown */ void 	__imp__GetEnvironmentVariableW;
/* 0x00402104       0 */ /* unknown */ void 	__imp__SetStdHandle;
/* 0x00402108       0 */ /* unknown */ void 	__imp__GetTickCount;
/* 0x0040210c       0 */ /* unknown */ void 	__imp__GetLocaleInfoA;
/* 0x00402110       0 */ /* unknown */ void 	__imp__GetOEMCP;
/* 0x00402114       0 */ /* unknown */ void 	__imp__GetFileType;
/* 0x00402118       0 */ /* unknown */ void 	__imp__GetStartupInfoA;
/* 0x0040211c       0 */ /* unknown */ void 	__imp__VirtualProtect;
/* 0x00402120       0 */ /* unknown */ void 	__imp__GetModuleHandleA;
/* 0x00402124       0 */ /* unknown */ void 	__imp__HeapAlloc;
/* 0x00402128       0 */ /* unknown */ void 	__imp__GetACP;
/* 0x00402130       0 */ /* unknown */ void 	__imp__?what;
/* 0x00402134       0 */ /* unknown */ void 	__imp____p__fmode;
/* 0x0040213c       0 */ /* unknown */ void 	__imp__RegOpenKeyExA;
/* 0x00402140       0 */ /* unknown */ void 	__imp__RegEnumKeyExA;
/* 0x00402148       0 */ /* unknown */ void 	__imp__CombineRgn;
/* 0x00402150       0 */ /* unknown */ void 	__imp__I_RpcBCacheFree;
#if 0 /* auxiliary information */
# Current option values:
option: +asmflush
option: -compactcalls
option: +compactexprs
option: +compactifs
option: +compset
option: -dfoproc
option: -disasmonly
option: -displaylabels
option: +doblocks
option: +docase
option: +dofor
option: +doifs
option: +dointrinsics
option: +doloops
option: +donullgotos
option: +dopackloops
option: +dopackstmt
option: +doremlabs
option: +dosimplify
option: -dosort
option: +dostmts
option: +doswitch
option: +dowhile
option: -dumpaddrs
option: -dumpcall
option: -dumpcomments
option: -dumpdfo
option: +dumpdoms
option: -dumpsblocks
option: -dumpsets
option: -dumpsizes
option: -dumpstmtid
option: +fatcase
option: -flag16
option: +fullscreen
option: -genpattern
option: -help
option: -hexconst
option: -html
option: +insertlabels
option: -int16
option: +int32
option: -interactive
option: -isvb5
option: +locals
option: -nohtmltabs
option: -nostackoffs
option: -objdump
option: -okclone
option: -outprocs
option: -outrefs
option: -overrule
option: +rdonly
option: -showblocks
option: -showjump
option: -showlabel
option: -showprotosym
option: -showreg
option: -showstring
option: -silent
option: +simplifyexprs
option: -stackalign16
option: -stackalign4
option: -stackalign8
option: -strallregions
option: -traceall
option: -tracesets
option: +types
option: -usesymtab
option: -validatebr
option: -validatereg
option: +validatestr
#endif
