__size32 global2 = 0;// 4 bytes

void _start(__size8 param1);
void proc6();
void proc8();
void proc9();
void proc12();
void proc14();
void proc16();
void proc17(__size32 param1);
void proc20();
void proc21();

// address: 0x4014ec
void proc4() {
    GetCommandLineA();
    proc6();
    GetFocus();
    return;
}

// address: 0x4010d4
void _start(__size8 param1) {
    GetCommandLineA();
    if ((param1 & 0x3) == 0) {
        GetLogicalDrives();
        if ((param1 & 0x4) != 0) {
        }
    }
    return;
}

// address: 0x401234
void proc6() {
    proc8();
    GetCurrentThread();
    GetCommandLineA();
    return;
}

// address: 0x4013b0
void proc8() {
    GetCurrentThreadId();
    proc9();
    Sleep(15);
    return;
}

// address: 0x401544
void proc9() {
    GetCurrentProcess();
    proc12();
    GetCommandLineA();
    return;
}

// address: 0x4015e8
void proc12() {
    GetDriveTypeA();
    proc14();
    GetForegroundWindow();
    return;
}

// address: 0x401308
void proc14() {
    GetCurrentThreadId();
    proc16();
    GetLogicalDrives();
    return;
}

// address: 0x401618
void proc16() {
    proc17(0x403248);
    GetSystemDefaultLangID();
    GetDriveTypeA();
    return;
}

// address: 0x401438
void proc17(__size32 param1) {
    __size32 eax; 		// r24
    int esp; 		// r28
    void *esp_1; 		// r28{51}

    eax = param1 - 240;
    esp = (esp - 84);
    do {
        esp_1 = esp;
        *(__size32*)(esp_1 - 4) = eax - 344;
        eax = GetModuleHandleA(); /* Warning: also results in esp */
    } while (eax != 0);
    eax = *(esp_1 - 4);
    *(__size32*)(esp_1 - 4) = eax;
    *(__size32*)(esp_1 - 8) = param1;
    *(__size32*)(esp_1 - 12) = param1;
    proc20();
    eax = *(esp_1 - 4);
    *(__size32*)(esp_1 - 4) = eax;
    GetCurrentThreadId();
    return;
}

// address: 0x401028
void proc20() {
    proc21();
    GetCurrentProcess();
    GetACP();
    return;
}

// address: 0x401144
void proc21() {
    __size32 eax; 		// r24
    __size32 *eax_1; 		// r24{52}
    __size32 ecx; 		// r25
    __size32 ecx_1; 		// r25{53}
    __size32 edi; 		// r31
    void *esi; 		// r30
    void *esi_1; 		// r30{54}

    eax = VirtualAlloc(0, 1488, 0x1000, 64);
    global2 = eax;
    esi = eax + 183;
    eax = 0x403310;
    ecx = 0;
    do {
        eax_1 = eax;
        ecx_1 = ecx;
        esi_1 = esi;
        eax = eax_1 + 4;
        edi = *eax_1;
        *(__size32*)(esi_1 - 183) = edi;
        esi = esi_1 + 4;
        *(int*)(esi_1 - 183) = *(esi_1 - 183) ^ 0x81932acc;
        ecx = ecx_1 + 1;
    } while ((ecx_1 + 1) * 4 != 1488);
    GetCurrentThread();
    return;
}

