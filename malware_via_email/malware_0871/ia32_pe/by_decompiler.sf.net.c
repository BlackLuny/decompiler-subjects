// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0871/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn004010C4(bcu8 * eax, Eq_3 * edx, ui32 ebx, word32 ebp, word32 esi, Eq_3 * edi, word16 cx, Eq_12 * fs)
{
	real64 rArg0_11;
	Eq_3 * edi_12 = fn004010D4(eax, edx, ebx, ebp, edi, cx, fs, rArg0, rArg5, out rArg0_11);
	bcu8 v5_16 = *eax + al;
	*eax = v5_16;
	Eq_36 al_20 = al - (v5_16 <u 0x00);
	edx->bC166DE00 = edx->bC166DE00 + (byte) ((0xFFFFFF90 - (fp + 0x00000008)) - (al_20 <u 0x00));
	bcu8 * eax_21 = DPB(eax, al_20, 0, 8);
	fn004010D6(eax_21, edx, ebx, ebp, edi_12, fs, dwArg00);
	return;
}

Eq_3 * fn004010D4(bcu8 * eax, Eq_3 * edx, ui32 ebx, word32 ebp, Eq_3 * edi, word16 cx, Eq_12 * fs, real64 rArg0, real64 rArg5, real64 * rArg0Out)
{
	__rol(cx, 0x04);
	return fn004010D6(eax, edx, ebx, ebp, edi, fs, dwArg00);
}

Eq_3 * fn004010D6(bcu8 * eax, Eq_3 * edx, ui32 ebx, word32 ebp, Eq_3 * edi, Eq_12 * fs, word32 dwArg00)
{
	esp = fp;
	v3 = (edx[ebx * 0x00000002] & 0x04000000) != 0x00000000;
	edx[ebx * 0x00000002] = __rol(edx[ebx * 0x00000002], 0x66);
	edi = edi - 0xFFFFFFC1;
	edi = dwArg00;
	edi = edi - 0xFFFFFFF8;
	di = (word16) edi;
	ecx = 0x00000000;
	ecx = 0xFFFFFF90;
	cl = (byte) ecx;
	SCZO = cond(edi->a0000[0] - cl);
	Z = SCZO;
	if (Test(NE,Z))
		;
}

real64 fn0040110D(bcu8 * eax, word32 ecx, word32 ebp, Eq_3 * edi, word16 dx, Eq_12 * fs, real64 rArg0, real64 rArg5)
{
	fn00401123(eax, ecx, ebp, edi, dx, fs, dwLoc04, dwArg00);
}

void fn00401123(bcu8 * eax, word32 ecx, word32 ebp, Eq_3 * edi, word16 dx, Eq_12 * fs, word32 dwArg00, word32 dwArg04)
{
// def fp
// def ecx
// def dx
// def Mem0
// def ebp
// def fs
	eax_18 = DPB(0x00128D58, dx, 0, 16);
	edx_29 = globals->dw4010BF;
	edi_22 = *eax_18;
	ecx_27 = -DPB(ecx + 0xD877CA15, (word16) (ecx + 0xD877CA15) - 0x005D, 0, 16);
	ax_32 = (word16) (eax_18 & edx_29);
	do
	{
// ax_35 = PHI(ax_32, ax_50)
// ecx_37 = PHI(ecx_27, ecx_46)
// edi_38 = PHI(edi_22, edi_40)
		edi_40 = edi_38 + 0x00000001;
		esi_48 = ~edi_40->dw0000 + edx_29;
		ecx_46 = ~ecx_37;
		ax_50 = __ror(ax_35 + 0x007F, 0x01);
	} while (esi_48 != 0x00000001);
	__rol(ecx_46, 0x01);
	eax_66 = Mem0[edi_40 - 0x00000005:word32];
	edi_78 = *fp;
	__ror((edx_29 ^ ebp) + 0xEE7C189D, 0x02);
	ecx_74 = fp;
	eax_81 = edi_78;
	edi_86 = globals->dw401029;
// eax_92 = PHI(eax_81, eax_99)
// ecx_93 = PHI(ecx_74, ecx_104)
	esi_96 = *eax_92;
	__rol(ecx_93, 0x06);
	eax_99 = eax_92 - 0xFFFFFFFF;
	ecx_104 = esi_96 ^ edi_86;
	while (ecx_104 != null)
	{
// eax_92 = PHI(eax_81, eax_99)
// ecx_93 = PHI(ecx_74, ecx_104)
		esi_96 = *eax_92;
		__rol(ecx_93, 0x06);
		eax_99 = eax_92 - 0xFFFFFFFF;
		ecx_104 = esi_96 ^ edi_86;
	}
	edi_113 = edi_86 ^ eax_66;
	cx_137 = (word16) ((eax_66 + 0xAA40869C ^ DPB(edi_113, (word16) edi_113 | 0xFFCA, 0, 16)) + fs->dw0000);
	fs->dw0000 = eax_66 + 0xAA408698;
	__rol(cx_137, 0x07);
	return;
}

