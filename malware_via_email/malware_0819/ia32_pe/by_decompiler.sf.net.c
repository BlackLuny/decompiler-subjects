// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0819/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn004011B9(word32 eax, word32 ecx, word32 edx, word32 ebp, word32 esi, word32 edi, selector fs)
{
	word32 ecx_9;
	word32 edx_10;
	word32 ebp_11;
	word32 esi_12;
	word32 edi_13;
	byte bl_14;
	word32 eax_15 = fn004011CA(eax, ecx, edx, ebp, esi, edi, fs, out ecx_9, out edx_10, out ebp_11, out esi_12, out edi_13, out bl_14);
	Mem19[edx_10 + 0x00000012:byte] = Mem0[edx_10 + 0x00000012:byte] + dl;
	Mem21[eax_15 - 0x0000006C + eax_15:byte] = Mem19[eax_15 - 0x0000006C + eax_15:byte] + dl;
	Mem23[edx_10 + 0x8100C200:byte] = Mem21[edx_10 + 0x8100C200:byte] + bl_14;
	word32 ecx_26;
	word32 edx_27;
	word32 ebp_28;
	word32 esi_29;
	word32 edi_30;
	byte bl_31;
	fn004011CB(eax_15, ecx_9, edx_10, ebp_11, esi_12, edi_13, fs, dwArg00, out ecx_26, out edx_27, out ebp_28, out esi_29, out edi_30, out bl_31);
	return;
}

word32 fn004011CA(word32 eax, word32 ecx, word32 edx, word32 ebp, word32 esi, word32 edi, selector fs, ptr32 ecxOut, ptr32 edxOut, ptr32 ebpOut, ptr32 esiOut, ptr32 ediOut, ptr32 blOut)
{
	word32 ecx_17;
	word32 edx_18;
	word32 ebp_19;
	word32 esi_20;
	word32 edi_21;
	byte bl_22;
	return fn004011CB(eax & 0xA0920F26, ecx, edx, ebp, esi, edi, fs, dwArg00, out ecx_17, out edx_18, out ebp_19, out esi_20, out edi_21, out bl_22);
}

word32 fn004011CB(word32 eax, word32 ecx, word32 edx, word32 ebp, word32 esi, word32 edi, selector fs, word32 dwArg00, ptr32 ecxOut, ptr32 edxOut, ptr32 ebpOut, ptr32 esiOut, ptr32 ediOut, ptr32 blOut)
{
	esp = fp;
	ecx = ecx - 0x00000001;
	cx = (word16) ecx;
	if (Test(EQ,Z) || ecx == 0x00000000)
	{
		Mem0[eax + 0x8BF1315F:byte] = Test(ULT,C);
		al = al ^ 0x24;
		edi = edi << 0x00000011;
		di = (word16) edi;
		esi = esi + 0x00000008;
		si = (word16) esi;
		edx = edx - ebp;
		eax = 0x00000000;
		edx = edx + dwArg00;
		al = Mem0[esi + 0x00000000:byte];
		eax = DPB(eax, al, 0, 8);
		edx = edx + 0x00000001;
		dx = (word16) edx;
		ecx = 0x00000000;
		ecx = 0x00000090;
		cx = (word16) ecx;
		SCZO = cond(0x00000090);
		edi = edi ^ 0x4F5D446D;
		di = (word16) edi;
		SZO = cond(edi);
		C = false;
	}
	else
	{
		v14 = Mem0[ecx + 0x5D446DF7:byte] + al;
		Mem0[ecx + 0x5D446DF7:byte] = v14;
		SCZO = cond(v14);
		edi = edi - 0x00000001;
		di = (word16) edi;
		SZO = cond(edi);
	}
	ecx = ecx ^ eax;
	cx = (word16) ecx;
	v15 = (di & 0x0004) != 0x0000;
	di = __ror(di, 0x02);
	edi = DPB(edi, di, 0, 16);
	SZO = cond(ecx & ecx);
	Z = SZO;
	C = false;
	if (Test(NE,Z))
		fn00401208(eax, si);
}

void fn00401208(word32 eax, word16 si)
{
	__rol(eax, 0x1E);
}

word32 fn00401237(word32 ebp, word32 esi, word32 edi, word16 cx, word16 dx, selector fs, ptr32 ecxOut, ptr32 edxOut, ptr32 ebpOut, ptr32 esiOut, ptr32 ediOut, ptr32 blOut)
{
// def fp
// def Mem0
// def ebp
// def fs
	esi_21 = Mem0[DPB(0x00123EB7, (word16) fp, 0, 16):word32];
	__rol(fp, 0x19);
	ecx_29 = Mem0[0x004010C8:word32];
	do
	{
// esi_36 = PHI(esi_21, esi_37)
		esi_37 = esi_36 + 0x00000001;
		eax_43 = Mem0[esi_37 + 0x00000000:word32] - ecx_29;
	} while (eax_43 != 0x00000000);
	ecx_58 = (word32) Mem0[esi_37 + 0xFFFFFFFD:word16];
	__ror(-eax_43, 0x0F);
	di_73 = (word16) (__rol(esi_37 + 0xFFFFFFFD, 0x16) + 0xF98207D5);
	edx_74 = Mem0[fp - 0x00000004:word32];
	__rol(edx_74, 0x12);
	edx_83 = Mem0[0x00401024:word32];
	__ror(di_73, 0x04);
	bl_64 = (byte) ecx_58;
	ecx_77 = edx_74;
	eax_79 = 0x0040100A;
	do
	{
// eax_88 = PHI(eax_79, eax_98)
// ecx_89 = PHI(ecx_77, ecx_94)
		edi_91 = Mem0[ecx_89 + 0x00000000:word32];
		__rol((word16) edi_91, 0x06);
		ecx_94 = ecx_89 - 0xFFFFFFFF;
		eax_98 = eax_88 & ebp;
	} while ((edi_91 ^ edx_83) != 0x00000000);
	eax_116 = eax_98 - ecx_58;
	eax_124 = DPB(eax_116, __ror((word16) eax_116, 0x0F), 0, 16);
	ecx_126 = Mem0[fs:0x00000000:word32];
	Mem138[fs:0x00000000:word32] = fp - 0x0000000C;
	edx_144 = DPB(fp - 0x0000000C, __rol((word16) (fp - 0x0000000C), 0x02), 0, 16);
	ecx_146 = ecx_94;
	ebp_148 = ecx_126 - (fp - 0x0000000C);
	edi_149 = DPB(ecx_58 + 0x003F87B2, (word16) (ecx_58 + 0x003F87B2) | 0x0030, 0, 16) + ecx_94 + 0x0153727D;
	esi_154 = 0x00000001;
	return eax_124;
}

