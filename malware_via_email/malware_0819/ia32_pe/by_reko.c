// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 004011B9: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 ecx_8;
	word32 edx_9;
	byte bl_10;
	word32 ebp_11;
	word32 esi_12;
	word32 edi_13;
	word32 eax_14 = fn004011CA(eax, ecx, edx, ebp, esi, edi, out ecx_8, out edx_9, out bl_10, out ebp_11, out esi_12, out edi_13);
	Mem18[edx_9 + 0x12:byte] = Mem0[edx_9 + 0x12:byte] + dl;
	Mem20[eax_14 - 0x6C + eax_14:byte] = Mem18[eax_14 - 0x6C + eax_14:byte] + dl;
	Mem22[edx_9 + 0x8100C200:byte] = Mem20[edx_9 + 0x8100C200:byte] + bl_10;
	word32 ecx_25;
	word32 edx_26;
	byte bl_27;
	word32 ebp_28;
	word32 esi_29;
	word32 edi_30;
	return fn004011CB(eax_14, ecx_8, edx_9, ebp_11, esi_12, edi_13, dwArg00, out ecx_25, out edx_26, out bl_27, out ebp_28, out esi_29, out edi_30);
}

// 004011CA: Register word32 fn004011CA(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebp, Register word32 esi, Register word32 edi, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 blOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn004011CA(word32 eax, word32 ecx, word32 edx, word32 ebp, word32 esi, word32 edi, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & blOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
	word32 ecx_16;
	word32 edx_17;
	byte bl_18;
	word32 ebp_19;
	word32 esi_20;
	word32 edi_21;
	return fn004011CB(eax & 2693926694, ecx, edx, ebp, esi, edi, dwArg00, out ecx_16, out edx_17, out bl_18, out ebp_19, out esi_20, out edi_21);
}

// 004011CB: Register word32 fn004011CB(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebp, Register word32 esi, Register word32 edi, Stack word32 dwArg00, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 blOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn004011CB(word32 eax, word32 ecx, word32 edx, word32 ebp, word32 esi, word32 edi, word32 dwArg00, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & blOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
fn004011CB_entry:
	def fp
	def ecx
	def Z
	def ecxOut
	def edxOut
	def blOut
	def ebpOut
	def esiOut
	def ediOut
	def bl
	def ebp
	def C
	def eax
	def al
	def edi
	def esi
	def edx
	def dwArg00
	def Mem0
	def si
	def dx
	esp_1 = fp
	ecx_3 = ecx - 0x01
	cx_4 = (word16) ecx_3 (alias)
	branch Z && ecx_3 != 0x00 l004011F3
	goto l004011CD
l004011CB:
l004011CB:
	edi = Mem0[esp + 0x00:word32]
	esp = esp + 0x04
	ecx = ecx ^ esi
	esi = Mem0[esp + 0x00:word32]
	edi = edi << 0x11
	esi = esi + 0x08
	si = (word16) esi (alias)
	edx = edx - ebp
	eax = 0x00
	edx = edx + Mem0[esp + 0x00:word32]
	al = Mem0[esi + 0x00:byte]
	eax = DPB(eax, al, 0) (alias)
	edx = edx + 0x01
	dx = (word16) edx (alias)
	ecx = 0x00
	ecx = 0x90
	edi = edi ^ 0x4F5D446D
	di = (word16) edi (alias)
	ecx = 0x90 ^ eax
	cx = (word16) ecx (alias)
	v17 = (di & 0x04) != 0x00
	di = __ror(di, 0x02)
	edi = DPB(edi, di, 0) (alias)
	SZO = cond(ecx & ecx)
	Z = SZO (alias)
	C = false
	branch Test(EQ,Z) l00401237
	goto l004011FD_thunk_fn00401208
l004011CD:
	Mem49[eax + 2347839839:byte] = C
	al_52 = al ^ 0x24
	edi_54 = edi << 0x11
	di_55 = (word16) edi_54 (alias)
	esi_57 = esi + 0x08
	si_58 = (word16) esi_57 (alias)
	edx_60 = edx - ebp
	eax_61 = 0x00
	edx_63 = edx_60 + dwArg00
	al_64 = Mem49[esi_57 + 0x00:byte]
	eax_65 = DPB(eax_61, al_64, 0) (alias)
	edx_66 = edx_63 + 0x01
	dx_67 = (word16) edx_66 (alias)
	ecx_68 = 0x00
	ecx_69 = 0x90
	cx_70 = (word16) ecx_69 (alias)
	SCZO_71 = cond(0x90)
	edi_72 = edi_54 ^ 0x4F5D446D
	di_73 = (word16) edi_72 (alias)
	SZO_74 = cond(edi_72)
	C_75 = false
	goto l004011FA
l004011F3:
	v14_77 = Mem0[ecx_3 + 1564765687:byte] + al
	Mem78[ecx_3 + 1564765687:byte] = v14_77
	SCZO_79 = cond(v14_77)
	edi_80 = edi - 0x01
	di_81 = (word16) edi_80 (alias)
	SZO_82 = cond(edi_80)
	goto l004011FA
l004011F4:
l004011F9:
l004011FA:
	si_6 = PHI(si_58, si)
	dx_7 = PHI(dx_67, dx)
	SCZO_8 = PHI(SCZO_71, SCZO_79)
	di_9 = PHI(di_73, di_81)
	ecx_10 = PHI(ecx_69, ecx_3)
	edx_11 = PHI(edx_66, edx)
	esi_12 = PHI(esi_57, esi)
	edi_13 = PHI(edi_72, edi_80)
	eax_14 = PHI(eax_65, eax)
	al_15 = PHI(al_64, al)
	ecx_16 = ecx_10 ^ eax_14
	cx_17 = (word16) ecx_16 (alias)
	v15_18 = (di_9 & 0x04) != 0x00
	di_19 = __ror(di_9, 0x02)
	edi_20 = DPB(edi_13, di_19, 0) (alias)
	SZO_21 = cond(ecx_16 & ecx_16)
	Z_22 = SZO_21 (alias)
	C_23 = false
	branch (ecx_16 & ecx_16) == 0x00 l00401202_thunk_fn00401237
	goto l00401202_thunk_fn00401208
l004011FD_thunk_fn00401208:
	fn00401208(eax, si)
	return eax
l004011FD_thunk_fn00401237:
	eax = fn00401237(cx, dx, ebp, esi, di, out ecx, out edx, out bl, out ebp, out esi, out edi)
	al = (byte) eax (alias)
	return eax
l00401202_thunk_fn00401208:
	fn00401208(eax_14, si_6)
	return eax_14
l00401202_thunk_fn00401208:
	fn00401208(eax_14, si_6)
	return eax_14
l00401202_thunk_fn00401237:
	eax_46 = fn00401237(cx_17, dx_7, ebp, esi_12, di_19, out ecx_40, out edx_41, out bl_42, out ebp_43, out esi_44, out edi_45)
	al_47 = (byte) eax_46 (alias)
	return eax_46
fn004011CB_exit:
	ecx_24 = PHI(ecx_40, ecx_16, ecx_16, ecx, ecx)
	edx_25 = PHI(edx_41, edx_11, edx_11, edx, edx)
	bl_26 = PHI(bl_42, bl, bl, bl, bl)
	ebp_27 = PHI(ebp_43, ebp, ebp, ebp, ebp)
	esi_28 = PHI(esi_44, esi_12, esi_12, esi, esi)
	edi_29 = PHI(edi_45, edi_20, edi_20, edi, edi)
	eax_30 = PHI(eax_46, eax_14, eax_14, eax, eax)
	al_31 = PHI(al_47, al_15, al_15, al, al)
	use ecx_24 (=> ecxOut)
	use edx_25 (=> edxOut)
	use bl_26 (=> blOut)
	use ebp_27 (=> ebpOut)
	use esi_28 (=> esiOut)
	use edi_29 (=> ediOut)
}

// 00401208: void fn00401208(Register word32 eax, Register word16 si)
void fn00401208(word32 eax, word16 si)
{
	__rol(eax, 0x1E);
}

// 00401237: Register word32 fn00401237(Register word16 cx, Register word16 dx, Register word32 ebp, Register word32 esi, Register word16 di, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 blOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn00401237(word16 cx, word16 dx, word32 ebp, word32 esi, word16 di, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & blOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
fn00401237_entry:
	def v3
	def Mem0
	def ebp
	def fs
	esi_22 = Mem0[DPB(1195703, (word16) v3, 0) + 0x00:word32]
	__rol(v3, 0x19)
	ecx_30 = Mem0[0x004010C8:word32]
	goto l00401270
l00401237:
l00401270:
	esi_37 = PHI(esi_22, esi_38)
	esi_38 = esi_37 + 0x01
	eax_44 = Mem0[esi_38 + 0x00:word32] - ecx_30
	branch eax_44 != 0x00 l00401270
l00401280:
	ecx_59 = (word32) Mem0[esi_38 + ~0x02:word16] (alias)
	__ror(-eax_44, 0x0F)
	edi_68 = __rol(esi_38 + ~0x02, 22)
	Mem71[v3 - 0x04 + 0x00:word32] = v3
	edx_76 = Mem71[Mem71[v3 - 0x04 + 0x00:word32] + 0x00:word32]
	__rol(edx_76, 0x12)
	edx_85 = Mem71[0x00401024:word32]
	__ror((word16) (edi_68 + 4186048469), 0x04)
	bl_65 = (byte) ecx_59 (alias)
	ecx_79 = edx_76
	eax_81 = 0x0040100A
l004012C6:
	eax_90 = PHI(eax_81, eax_100)
	ecx_91 = PHI(ecx_79, ecx_96)
	edi_93 = Mem71[ecx_91 + 0x00:word32]
	__rol((word16) edi_93, 0x06)
	ecx_96 = ecx_91 - ~0x00
	eax_100 = eax_90 & ebp
	branch (edi_93 ^ edx_85) != 0x00 l004012C6
l004012DD:
	Mem121[v3 - 0x04 + 0x00:word32] = ecx_59 + 4163506
	eax_118 = eax_100 - ecx_59
	eax_126 = DPB(eax_118, __ror((word16) eax_118, 0x0F), 0) (alias)
	ecx_128 = Mem121[fs:0x00:word32]
	Mem131[v3 - 0x08 + 0x00:word32] = ecx_128
	Mem136[v3 - 0x0C + 0x00:word32] = v3 - 0x08
	edx_137 = Mem136[v3 - 0x0C + 0x00:word32]
	Mem141[fs:0x00:word32] = edx_137
	Mem144[v3 - 0x0C + 0x00:word32] = 0x00
	edx_147 = DPB(edx_137, __rol((word16) edx_137, 0x02), 0) (alias)
	Mem156[v3 - 0x10 + 0x00:word32] = ecx_96
	ecx_149 = ecx_96
	ebp_151 = ecx_128 - edx_137
	edi_152 = DPB(ecx_59 + 4163506, (word16) (ecx_59 + 4163506) | 0x30, 0) + ecx_96 + 22246013
	esi_157 = 0x01
	return eax_126
fn00401237_exit:
	use ecx_149 (=> ecxOut)
	use edx_147 (=> edxOut)
	use bl_65 (=> blOut)
	use ebp_151 (=> ebpOut)
	use esi_157 (=> esiOut)
	use edi_152 (=> ediOut)
}

