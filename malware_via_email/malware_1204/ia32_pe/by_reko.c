// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401020: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 edx_11 = fn00401130();
	word32 eax_19 = 206336032 - (edx_11 << 11) & 0x0C0B6000 - (edx_11 << 11);
	word32 edx_29 = fp + ~0x0001819F + dwLoc20;
	Mem30[edx_29 + 0x00:word32] = (eax_19 + 4244441164)[edx_11 * 0x0200] - 0x28;
	word32 eax_34 = eax_19 + Mem30[(((eax_19 + 4244441164) + (edx_11 << 0x09)) - 0x04) + 0x00:word32] + 0x000181B4 - dwLoc20;
	Mem39[fp - 0x5C + 0x00:word32] = dwLoc20;
	word32 esi_41;
	word32 ecx_42 = fn00401180(dwArg00, out esi_41);
	Mem46[fp - 0x5C + 0x00:word32] = fp - 0x08;
	Mem48[fp - 0x60 + 0x00:word32] = 0x04;
	Mem50[fp - 100 + 0x00:word32] = ecx_42;
	Mem52[fp - 0x68 + 0x00:word32] = esi_41;
	word32 eax_54 = 0x0041918C - dwLoc20;
	word32 esp_56;
	word32 ebp_57;
	byte SCZO_58;
	word32 eax_59;
	word32 ecx_60;
	word32 edx_61;
	word32 ebx_62;
	byte SZO_63;
	byte C_64;
	word32 esi_65;
	Mem52[eax_54 + 0x00:word32]();
	Mem68[esp_56 - 0x04 + 0x00:word32] = dwLoc20;
	Mem75[esp_56 - 0x08 + 0x00:word32] = dwLoc14;
	Mem78[esp_56 - 0x0C + 0x00:word32] = eax_34;
	word32 esp_79;
	word32 ebp_80;
	byte SCZO_81;
	word32 eax_82;
	word32 ecx_83;
	word32 edx_84;
	word32 ebx_85;
	byte SZO_86;
	byte C_87;
	word32 esi_88;
	(dwLoc20 + 4099908)();
	Mem96[esp_79 - 0x04 + 0x00:word32] = 0x00;
	word32 v17_93 = eax_34 + 0x000181BC - dwLoc20;
	Mem101[esp_79 - 0x08 + 0x00:word32] = v17_93 + 1164;
	word32 esp_102;
	word32 ebp_103;
	byte SCZO_104;
	word32 eax_105;
	word32 ecx_106;
	word32 edx_107;
	word32 ebx_108;
	byte SZO_109;
	byte C_110;
	word32 esi_111;
	v17_93();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	Mem113[esp_102 - 0x04 + 0x00:word32] = fp - 0x04;
	word32 edx_116 = Mem113[esp_102 + 0x0C:word32];
	word32 ecx_119 = Mem113[esp_102 + ~0x00018183 + edx_116:word32];
	word32 ebx_121 = (esp_102 + ~0x00030313)[edx_116 * 0x02];
	Mem123[esp_102 - 0x10 + 0x00:word32] = 0x181900A0;
	word32 eax_126 = Mem123[esp_102 - 0x10 + 0x00:word32] - (edx_116 << 0x01);
	Mem128[esp_102 - 0x10 + 0x00:word32] = 158735475;
	Mem129[esp_102 - 0x08 + 0x00:word32] = 0x01;
	Mem130[esp_102 - 0x0C + 0x00:word32] = Mem129[esp_102 - 0x10 + 0x00:word32];
	Mem133[esp_102 - 0x0C + 0x00:word32] = Mem130[esp_102 - 0x0C + 0x00:word32] + (edx_116 << 0x01);
	while (true)
	{
		Mem140[ebx_121 + 0x00:word32] = Mem133[ebx_121 + 0x00:word32] ^ eax_126;
		ecx_119 = ecx_119 - 0x04;
		if (ecx_119 <= 0x00)
			break;
		eax_126 = eax_126 + Mem140[(esp_102 - 0x0C) + 0x00:word32] + Mem140[(esp_102 - 0x08) + 0x00:word32];
		ebx_121 = ebx_121 + 0x00018190 - Mem140[esp_102 + 0x0C:word32];
		Mem150[esp_102 - 0x08 + 0x00:word32] = -Mem140[esp_102 - 0x08 + 0x00:word32];
	}
	return eax_126;
}

// 00401130: Register word32 fn00401130()
word32 fn00401130()
{
	word32 eax_8 = RequestDeviceWakeup + ~0x00;
	word32 esp_13;
	word32 eax_14;
	byte SZO_15;
	byte C_16;
	word32 ecx_17;
	word32 ebx_18;
	selector fs_19;
	byte SCZO_20;
	byte Z_21;
	word32 edx_22;
	eax_8();
	word32 eax_28 = ((Mem0[ebx_18 + 3060:word32] >>u 0x10 | 0x24) ^ 0x55) << 0x01;
	Mem34[Mem0[esp_13 + ~0x00018187 + (eax_28 + 0xAA):word32] + 0x00:word32] = eax_28 + 0xAA;
	return eax_28 + 0xAA;
}

// 00401180: Register word32 fn00401180(Stack word32 dwArg04, Register out ptr32 esiOut)
word32 fn00401180(word32 dwArg04, ptr32 & esiOut)
{
	word32 eax_14 = (dwArg04 << 11) + 4097028480 & 0x06053000 - (dwArg04 << 0x0A);
	word32 eax_18 = eax_14 + 0x0C0C603C - (dwArg04 << 11);
	word32 esi_15;
	*esiOut = eax_14;
	return Mem0[Mem0[eax_18 + 0x00:word32] + 0x14 + eax_18:word32];
}

