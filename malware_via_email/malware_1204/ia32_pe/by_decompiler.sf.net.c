// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1204/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401020(word32 ebp, selector fs)
{
	word32 edx_12 = fn00401130(fs);
	Mem31[fp + 0xFFFE7E60 + dwLoc20:word32] = ((0x0C4C7020 - (edx_12 << 0x0000000B) & 0x0C0B6000 - (edx_12 << 0x0000000B)) + 0xFCFD084C)[edx_12 * 0x00000200] - 0x00000028;
	Mem39[fp - 0x0000005C:word32] = dwLoc20;
	word32 esi_41;
	word32 ecx_42 = fn00401180(dwArg00, out esi_41);
	Mem46[fp - 0x0000005C:word32] = fp - 0x00000008;
	Mem48[fp - 0x00000060:word32] = 0x00000004;
	Mem50[fp - 0x00000064:word32] = ecx_42;
	Mem52[fp - 0x00000068:word32] = esi_41;
}

word32 fn00401130(selector fs)
{
	word32 ebx_7 = Mem0[fs:0x00000018:word32];
	word32 eax_8 = Mem0[0x00401008:word32] + 0xFFFFFFFF;
	if (Mem0[eax_8 + 0x00000000:byte] != 0x90)
		;
	eax_8();
	word32 eax_21 = ((Mem0[ebx_7 + 0x00000BF4:word32] >>u 0x00000010 | 0x00000024) ^ 0x00000055) << 0x00000001;
	Mem27[Mem0[fp + 0xFFFE7E74 + (eax_21 + 0x000000AA):word32]:word32] = eax_21 + 0x000000AA;
	return eax_21 + 0x000000AA;
}

word32 fn00401180(word32 dwArg04, ptr32 esiOut)
{
	word32 eax_14 = (dwArg04 << 0x0000000B) + 0xF433B180 & 0x06053000 - (dwArg04 << 0x0000000A);
	word32 eax_18 = eax_14 + 0x0C0C603C - (dwArg04 << 0x0000000B);
	word32 esi_15;
	*esiOut = eax_14;
	return Mem0[Mem0[eax_18 + 0x00000000:word32] + 0x00000014 + eax_18:word32];
}

