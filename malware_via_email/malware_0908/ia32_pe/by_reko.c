// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 004010CE: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 edx_6;
	word32 ebp_7;
	word32 esi_8;
	word32 edi_9;
	fn004010DF(edx, ebp, dwLoc04, dwArg00, out edx_6, out ebp_7, out esi_8, out edi_9);
	Mem16[edi_9 + 11052065:byte] = Mem0[edi_9 + 11052065:byte] + dl;
	Mem18[ebp_7 + 0x00:word16] = (word16) FPUF << 0x08;
	Mem20[fp - 0x02 + 0x00:word32] = edi_9;
	word32 edx_24;
	word32 ebp_25;
	word32 esi_26;
	word32 edi_27;
	return fn004010DF(edx_6, ebp_7, dwLoc04, dwArg00, out edx_24, out ebp_25, out esi_26, out edi_27);
}

// 004010DF: Register word32 fn004010DF(Register word32 edx, Register word32 ebp, Stack word32 dwArg00, Stack word32 dwArg04, Register out ptr32 edxOut, Register out ptr32 ebpOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn004010DF(word32 edx, word32 ebp, word32 dwArg00, word32 dwArg04, ptr32 & edxOut, ptr32 & ebpOut, ptr32 & esiOut, ptr32 & ediOut)
{
fn004010DF_entry:
	def fp
	def dwArg04
	def Mem0
	def dwArg00
	def ebp
	def fs
	si_5 = (word16) (dwArg04 + 0x08) (alias)
	branch Mem0[dwArg04 + 0x08:byte] == 0x90 l00401111
	goto l004010EF
l004010DF:
l004010EF:
l00401111:
	__ror(si_5, 0x04)
	__rol((word16) ((dwArg00 >> 0x06) + 0x01 >> 0x10), 0x09)
	esi_28 = Mem0[DPB(1201891, (word16) (fp + 0x04), 0) + 0x00:word32]
	ecx_33 = Mem0[0x004010C8:word32]
l00401147:
	esi_38 = PHI(esi_28, esi_39)
	esi_39 = esi_38 - ~0x00
	branch Mem0[esi_39 + 0x00:word32] - ecx_33 != 0x00 l00401147
l00401156:
	eax_56 = Mem0[esi_39 + ~0x04:word32]
	edx_64 = fp + 0x04
	edi_72 = dwArg04
	ecx_74 = 0x00401018
	esi_77 = Mem0[0x0040101D:word32]
l00401192:
	edi_81 = PHI(edi_72, edi_88)
	edx_82 = PHI(edx_64, edx_92)
	ecx_83 = PHI(ecx_74, ecx_90)
	eax_85 = Mem0[edi_81 + 0x00:word32]
	__rol(edx_82, 0x15)
	edi_88 = edi_81 + 0x01
	ecx_90 = ecx_83 + esi_77
	edx_92 = eax_85 ^ esi_77
	branch edx_92 == 0x00 l004011AF
	goto l00401192
l004011AF:
	__rol(esi_77, 0x15)
	edi_120 = __rol(ebp & ecx_90 + dwArg04, 0x17)
	edx_122 = Mem0[fs:0x00:word32]
	Mem130[fs:0x00:word32] = fp - 0x04
	__rol(0x00, 0x09)
	esi_135 = fp - 0x04 >> 0x0E
	edx_138 = edi_88
	ebp_140 = DPB(edx_122, (word16) edx_122 + ~0x75, 0)
	return (-(eax_56 + 2856355455) & 0x00) - 3506075533
fn004010DF_exit:
	use edx_138 (=> edxOut)
	use ebp_140 (=> ebpOut)
	use esi_135 (=> esiOut)
	use edi_120 (=> ediOut)
}

