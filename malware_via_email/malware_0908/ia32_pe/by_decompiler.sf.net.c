// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0908/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn004010CE(word32 edx, ui16 * ebp, Eq_10 * fs)
{
	ui16 * ebp_7;
	word32 esi_8;
	Eq_4 * edi_9;
	word32 edx_10 = fn004010DF(edx, ebp, fs, dwLoc04, dwArg00, out ebp_7, out esi_8, out edi_9);
	edi_9->bA8A421 = edi_9->bA8A421 + (byte) edx_10;
	*ebp_7 = (word16) FPUF << 8;
	fp->ptrFFFFFFFE = edi_9;
	word32 ebp_24;
	word32 esi_25;
	word32 edi_26;
	fn004010DF(edx_10, ebp_7, fs, dwLoc04, dwArg00, out ebp_24, out esi_25, out edi_26);
	return;
}

word32 fn004010DF(word32 edx, ui16 * ebp, Eq_10 * fs, word32 dwArg00, word32 dwArg04, word32 * ebpOut, word32 * esiOut, word32 * ediOut)
{
fn004010DF_entry:
	def fp
	def dwArg04
	def Mem0
	def dwArg00
	def ebp
	def fs
l004010DF:
	si_5 = (word16) &dwArg04->b0008;
	branch dwArg04->b0008 == 0x90 l00401111
l004010EF:
l00401111:
	__ror(si_5, 0x04)
	__rol((word16) ((dwArg00 >> 0x00000006) + 0x00000001 >> 0x00000010), 0x09)
	esi_28 = Mem0[DPB(0x001256E3, (word16) (fp + 0x00000004), 0, 16):word32]
	ecx_33 = globals->dw4010C8;
l00401147:
	esi_38 = PHI(esi_28, esi_39)
	esi_39 = esi_38 - 0xFFFFFFFF;
	branch esi_39->dw0000 - ecx_33 != 0x00000000 l00401147
l00401156:
	eax_56 = esi_39->dwFFFFFFFB;
	edx_63 = fp;
	edi_71 = *fp;
	ecx_73 = 0x00401018;
	esi_76 = globals->dw40101D;
l00401192:
	edi_80 = PHI(edi_71, edi_87)
	edx_81 = PHI(edx_63, edx_91)
	ecx_82 = PHI(ecx_73, ecx_89)
	eax_84 = edi_80->dw0000;
	__rol(edx_81, 0x15)
	edi_87 = edi_80 + 0x00000001
	ecx_89 = ecx_82 + esi_76;
	edx_91 = eax_84 ^ esi_76;
	branch edx_91 == null l004011AF
l004011A5:
	goto l00401192
l004011AF:
	__rol(esi_76, 0x15)
	edi_119 = __rol(ebp & ecx_89 + dwArg04, 0x17);
	edx_121 = fs->dw0000;
	fs->dw0000 = eax_56 + 0xAA40867B;
	__rol(0x00000000, 0x09)
	esi_134 = eax_56 + 0xAA40867B >> 0x0000000E;
	ebp_139 = DPB(edx_121, (word16) edx_121 + 0xFF8A, 0, 16);
	return edi_87
fn004010DF_exit:
	use ebp_139 (=> ebpOut)
	use esi_134 (=> esiOut)
	use edi_119 (=> ediOut)
}

