// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0043F000: Register word32 fn0043F000(Register word32 ebx, Register word32 ebp, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C, Stack word32 dwArg10)
word32 fn0043F000(word32 ebx, word32 ebp, word32 dwArg04, word32 dwArg08, word32 dwArg0C, word32 dwArg10)
{
fn0043F000_entry:
	def ebp
	def ebx
	def dwArg0C
	def Mem0
	def dwArg08
	def dwArg10
	def dwArg04
	dwLoc08_13 = ebx & 0x00
	dwLoc0C_16 = 0x00
	goto l0043F024
l0043F000:
l0043F01A:
	dwLoc0C_111 = dwLoc0C_37 - ~0x00
l0043F024:
	dwLoc08_31 = PHI(dwLoc08_13, dwLoc08_99)
	dwLoc0C_37 = PHI(dwLoc0C_16, dwLoc0C_111)
	branch dwLoc0C_37 >=u dwArg0C l0043F08C
l0043F02C:
	cl_85 = (byte) (((Mem0[dwArg08 + dwLoc0C_37:word32] ^ 0x00) & ~0x00 & 0xFF) + ((Mem0[dwArg10 + dwLoc08_31:word32] & 0xFF ^ ~0x00) + 0x01)) (alias)
	eax_88 = dwArg04 + dwLoc0C_37
	Mem89[eax_88 + 0x00:byte] = 0x00
	Mem91[eax_88 + 0x00:byte] = Mem89[eax_88 + 0x00:byte] - cl_85
	Mem93[eax_88 + 0x00:byte] = -Mem91[eax_88 + 0x00:byte]
	edi_95 = dwLoc08_31 + 0x01
	dwLoc08_96 = edi_95
	branch edi_95 != 0x01 l0043F081
l0043F07D:
	dwLoc08_113 = edi_95 & 0x00
l0043F081:
	dwLoc08_99 = PHI(dwLoc08_96, dwLoc08_113)
	branch dwLoc08_99 <=u 0xD6000000 l0043F01A
l0043F08C:
	return ebp
	return Mem0[ebp + 0x00:word32]
fn0043F000_exit:
}

// 0043F092: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 eax_108 = WSAStartup(0x0000, fp - 488);
	if (0x00 != 0x00)
	{
		word32 eax_101 = CoCreateInstanceEx(fp - 0x04, 0x00, 0x00, 0x00, 0x00, 0x00);
		eax_108 = eax_101 - 0x800401F0;
		if (eax_101 == 0x800401F0)
		{
			word32 eax_118 = WriteFmtUserTypeStg(0x00, 0x0000, 0x00);
			eax_108 = eax_118 - 0x80070057;
			if (eax_118 == 0x80070057)
			{
				word32 ebp_158 = fn0043F000(fp - 0x019C, fp - 0x04, fp - 0x01AC, 0x00401000 - (ecx & 0x00), dwLoc08 & eax_118 - 0x80070057 ^ 0x38, 4452882);
				Mem164[ebp_158 - 0x24 + 0x00:word32] = Mem0[Mem0[ebp_158 - 0x10 + 0x00:word32] + 0x04:word32] + Mem0[Mem0[(ebp_158 - 0x10) + 0x00:word32] + 0x00:word32];
				Mem167[fp - 0x01DC + 0x00:word32] = 0x40;
				Mem169[fp - 0x01E0 + 0x00:word32] = 0x3000;
				Mem172[fp - 484 + 0x00:word32] = Mem169[ebp_158 - 0x24 + 0x00:word32];
				Mem174[fp - 488 + 0x00:word32] = 0x00;
				Mem177[ebp_158 - 0x08 + 0x00:word32] = VirtualAlloc(Mem174[fp - 488 + 0x00:LPVOID], Mem174[fp - 484 + 0x00:SIZE_T], Mem174[fp - 0x01E0 + 0x00:DWORD], Mem174[fp - 0x01DC + 0x00:DWORD]);
				Mem178[ebp_158 - 0x20 + 0x00:word32] = 0x00400000;
				Mem180[ebp_158 - 0x18 + 0x00:word32] = Mem178[ebp_158 - 0x18 + 0x00:word32] & 0x00;
				Mem183[ebp_158 - 0x01AC + 0x00:word32] = Mem180[ebp_158 - 0x01AC + 0x00:word32] & 0x00;
				while (true)
				{
					word32 edi_191 = Mem183[ebp_158 - 0x10 + 0x00:word32];
					word32 eax_193 = Mem183[edi_191 + 0x08:word32];
					if (Mem183[ebp_158 - 0x01AC + 0x00:word32] >=u eax_193)
						break;
					Mem198[fp - 0x01DC + 0x00:word32] = Mem183[ebp_158 - 0x28 + 0x00:word32];
					Mem202[fp - 0x01E0 + 0x00:word32] = Mem198[Mem198[ebp_158 - 0x1C + 0x00:word32] + 0x04:word32];
					word32 ebx_205 = Mem202[ebp_158 - 0x20 + 0x00:word32] + Mem202[Mem202[(ebp_158 - 0x1C) + 0x00:word32] + 0x00:word32];
					Mem207[fp - 484 + 0x00:word32] = ebx_205;
					Mem212[fp - 488 + 0x00:word32] = Mem207[ebp_158 - 0x08 + 0x00:word32] + Mem207[(ebp_158 - 0x18) + 0x00:word32];
					ebp_158 = fn0043F000(ebx_205, ebp_158, dwArg00, dwArg04, dwArg08, dwArg0C);
					Mem223[ebp_158 - 0x18 + 0x00:word32] = Mem212[ebp_158 - 0x18 + 0x00:word32] + Mem212[Mem212[(ebp_158 - 0x1C) + 0x00:word32] + 0x04:word32];
					Mem226[ebp_158 - 0x01AC + 0x00:word32] = Mem223[ebp_158 - 0x01AC + 0x00:word32] + 0x01;
					Mem230[ebp_158 - 0x1C + 0x00:word32] = Mem226[ebp_158 - 0x1C + 0x00:word32] + 0x08;
				}
				word32 edx_231 = Mem183[ebp_158 - 0x20 + 0x00:word32];
				Mem233[fp - 0x01DC + 0x00:word32] = edx_231;
				Mem236[ebp_158 - 0x14 + 0x00:word32] = Mem233[ebp_158 - 0x08 + 0x00:word32] + 5776;
				word32 ebx_237 = Mem236[ebp_158 - 0x019C + 0x00:word32];
				Mem239[fp - 0x01E0 + 0x00:word32] = ebx_237;
				word32 esi_240 = Mem239[ebp_158 - 0x10 + 0x00:word32];
				Mem244[fp - 484 + 0x00:word32] = Mem239[ebp_158 - 0x08 + 0x00:word32] + Mem239[esi_240 + 0x04:word32];
				word32 esp_248;
				word32 ebp_249;
				byte SCZO_250;
				word32 edi_251;
				word32 esi_252;
				byte SZO_253;
				byte C_254;
				word32 ebx_255;
				word32 eax_256;
				byte Z_257;
				word32 ecx_258;
				word32 edx_259;
				Mem244[ebp_158 - 0x14 + 0x00:word32]();
				return eax_256;
			}
		}
	}
	int3();
	return eax_108;
}

