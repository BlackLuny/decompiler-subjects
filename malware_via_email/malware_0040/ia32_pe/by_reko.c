// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	byte al_17;
	byte ah_18;
	word32 ecx_19;
	word32 edx_20;
	word32 ebp_21;
	fn00401078(out al_17, out ah_18, out ecx_19, out edx_20, out ebp_21);
	Mem29[fp - 0x18 + 0x00:word32] = Mem0[0x00404400:word32];
	Mem31[fp - 0x1C + 0x00:word32] = 0x00402000;
	fn0040111D(al_17, ah_18, ecx_19, edx_20, ebx, ebp_21, esi, edi, es, ebp, dwArg00, rArg0);
	Mem48[fp - 0x12 + 0x00:word32] = 0x062E;
	Mem50[fp - 22 + 0x00:word32] = 0x0040111D;
	byte al_51;
	byte ah_52;
	word32 ecx_53;
	word32 edx_54;
	word32 ebp_55;
	fn00401078(out al_51, out ah_52, out ecx_53, out edx_54, out ebp_55);
	if (false)
	{
		Mem68[fp - 0x12 + 0x00:word32] = 0x00405000;
		Mem70[fp - 22 + 0x00:word32] = 0x00401000;
		lstrcpyA(Mem70[fp - 22 + 0x00:LPSTR], Mem70[fp - 0x12 + 0x00:LPCSTR]);
	}
	return 0x00;
}

// 00401078: FlagGroup bool fn00401078(Register out ptr32 alOut, Register out ptr32 ahOut, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebpOut)
bool fn00401078(ptr32 & alOut, ptr32 & ahOut, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebpOut)
{
	byte al_9;
	byte ah_10;
	word32 ecx_11;
	word32 edx_12;
	word32 ebp_13;
	return fn004010D4(fp - 0x04, out al_9, out ah_10, out ecx_11, out edx_12, out ebp_13);
}

// 004010B4: FlagGroup byte fn004010B4(Register word32 eax, Register word32 ebp, Register out ptr32 alOut, Register out ptr32 ahOut, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebpOut)
byte fn004010B4(word32 eax, word32 ebp, ptr32 & alOut, ptr32 & ahOut, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebpOut)
{
fn004010B4_entry:
	def fp
	def ebp
	def eax
	def alOut
	def ahOut
	def ecxOut
	def edxOut
	def ebpOut
	esp_1 = fp
	ebp_3 = ebp + 0x01
	D_4 = false
	eax_6 = eax - 0x01
	eax_7 = eax_6 & 0x03
	SZO_8 = cond(eax_7 & eax_7)
	Z_9 = SZO_8 (alias)
	C_10 = false
	branch (eax_7 & eax_7) != 0x00 l004010BC_thunk_fn004010D4
	goto l004010BC_thunk_fn004010BE
l004010B4:
l004010B4:
	eax = eax - 0x01
	eax = eax & 0x03
	SZO = cond(eax & eax)
	Z = SZO (alias)
	C = false
	branch Test(NE,Z) l004010D4
l004010BA_thunk_fn004010BE:
	D = fn004010BE(ebp, out al, out ah, out ecx, out edx, out ebp)
	return D
l004010BA_thunk_fn004010D4:
	D = fn004010D4(ebp, out al, out ah, out ecx, out edx, out ebp)
	return D
l004010BC_thunk_fn004010BE:
	D_27 = fn004010BE(ebp_3, out al_22, out ah_23, out ecx_24, out edx_25, out ebp_26)
	return D_27
l004010BC_thunk_fn004010BE:
	D_33 = fn004010BE(ebp_26, out al_28, out ah_29, out ecx_30, out edx_31, out ebp_32)
	return D_33
l004010BC_thunk_fn004010D4:
	D_39 = fn004010D4(ebp_3, out al_34, out ah_35, out ecx_36, out edx_37, out ebp_38)
	return D_39
fn004010B4_exit:
	al_11 = PHI(al_34, al_22, al_28, al, al)
	ah_12 = PHI(ah_35, ah_23, ah_29, ah, ah)
	ecx_13 = PHI(ecx_36, ecx_24, ecx_30, ecx, ecx)
	edx_14 = PHI(edx_37, edx_25, edx_31, edx, edx)
	ebp_15 = PHI(ebp_38, ebp_26, ebp_32, ebp, ebp)
	D_16 = PHI(D_39, D_27, D_33, D, D)
	use al_11 (=> alOut)
	use ah_12 (=> ahOut)
	use ecx_13 (=> ecxOut)
	use edx_14 (=> edxOut)
	use ebp_15 (=> ebpOut)
}

// 004010BE: FlagGroup bool fn004010BE(Register word32 ebp, Register out ptr32 alOut, Register out ptr32 ahOut, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebpOut)
bool fn004010BE(word32 ebp, ptr32 & alOut, ptr32 & ahOut, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebpOut)
{
fn004010BE_entry:
	D = fn004010D4(ebp, out al, out ah, out ecx, out edx, out ebp)
	return D
l004010BE:
	esp = v3
	eax = Mem0[ebp - 0x04 + 0x00:word32]
	al = (byte) eax (alias)
	ah = SLICE(eax, byte, 8) (alias)
	ecx = Mem0[ebp + 0x08:word32]
	ecx = ecx + eax
	SCZO = cond(ecx)
l004010C4_thunk_fn004010C5:
	D = fn004010C5(eax, ecx, edx, ebx, ebp, out al, out ah, out ecx, out edx, out ebp)
	return D
fn004010BE_exit:
	use al (=> alOut)
	use ah (=> ahOut)
	use ecx (=> ecxOut)
	use edx (=> edxOut)
	use ebp (=> ebpOut)
}

// 004010C5: FlagGroup bool fn004010C5(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 ebp, Register out ptr32 alOut, Register out ptr32 ahOut, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebpOut)
bool fn004010C5(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, ptr32 & alOut, ptr32 & ahOut, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebpOut)
{
fn004010C5_entry:
	def fp
	def ebx
	def Mem0
	def edx
	def eax
	def ecx
	def ebp
	def alOut
	def ahOut
	def ecxOut
	def edxOut
	def ebpOut
	esp_1 = fp
	v3_4 = (Mem0[ebx + 1435237445:word32] & 0x0100) != 0x00
	Mem5[ebx + 1435237445:word32] = __ror(Mem0[ebx + 1435237445:word32], 0x08)
	edx_8 = edx + eax
	al_9 = 188
	al_10 = 188 + Mem5[edx_8 + 0x00:byte]
	SCZO_11 = cond(al_10)
	Mem12[ecx + 0x00:byte] = al_10
	D_20 = fn004010D4(ebp, out al_15, out ah_16, out ecx_17, out edx_18, out ebp_19)
	return D_20
l004010C5:
l004010C5:
	eax = Mem0[ebp - 0x04 + 0x00:word32]
	edx = Mem0[ebp + 0x08:word32]
	edx = edx + eax
	al = 188
	al = 188 + Mem0[edx + 0x00:byte]
	SCZO = cond(al)
	Mem0[ecx + 0x00:byte] = al
	D = fn004010D4(ebp, out al, out ah, out ecx, out edx, out ebp)
	return D
l004010D2_thunk_fn004010D4:
l004010D2_thunk_fn004010D4:
fn004010C5_exit:
	al_21 = PHI(al_15, al)
	ah_22 = PHI(ah_16, ah)
	ecx_23 = PHI(ecx_17, ecx)
	edx_24 = PHI(edx_18, edx)
	ebp_25 = PHI(ebp_19, ebp)
	D_26 = PHI(D_20, D)
	use al_21 (=> alOut)
	use ah_22 (=> ahOut)
	use ecx_23 (=> ecxOut)
	use edx_24 (=> edxOut)
	use ebp_25 (=> ebpOut)
}

// 004010D4: FlagGroup bool fn004010D4(Register word32 ebp, Register out ptr32 alOut, Register out ptr32 ahOut, Register out ptr32 ecxOut, Register out ptr32 edxOut, Register out ptr32 ebpOut)
bool fn004010D4(word32 ebp, ptr32 & alOut, ptr32 & ahOut, ptr32 & ecxOut, ptr32 & edxOut, ptr32 & ebpOut)
{
l004010D4:
	esp = v3;
	SCZO = cond(Mem0[ebp - 0x04 + 0x00:word32] - 0x03);
	SZO = SCZO;
	if (Test(GT,SZO))
	{
		eax = Mem0[ebp - 0x04 + 0x00:word32];
		ecx = Mem0[ebp + 0x08:word32];
		ecx = ecx + eax;
		eax = Mem0[ebp - 0x04 + 0x00:word32];
		eax = eax + Mem0[ebp + 0x08:word32];
		dl = 212;
		edx = DPB(edx, dl, 0);
		al = Mem0[eax + 0x00:byte];
		al = al - 212;
		SCZO = cond(al);
		Mem0[ecx + 0x00:byte] = al;
	}
	eax = Mem0[ebp - 0x04 + 0x00:word32];
	eax = eax & 0x01;
	SZO = cond(eax & eax);
	Z = SZO;
	C = false;
	if (Test(EQ,Z))
	{
		eax = Mem0[ebp - 0x04 + 0x00:word32];
		ecx = Mem0[ebp + 0x08:word32];
		ecx = ecx + eax;
		eax = Mem0[ebp - 0x04 + 0x00:word32];
		eax = eax + Mem0[ebp + 0x08:word32];
		edx = Mem0[ebp - 0x04 + 0x00:word32];
		dl = (byte) edx;
		al = Mem0[eax + 0x00:byte];
		al = al - dl;
		SCZO = cond(al);
		Mem0[ecx + 0x00:byte] = al;
	}
	eax = ebp - 0x04;
	v14 = Mem0[eax + 0x00:word32] + 0x01;
	Mem0[eax + 0x00:word32] = v14;
	SZO = cond(v14);
	eax = Mem0[ebp - 0x04 + 0x00:word32];
	al = (byte) eax;
	ah = SLICE(eax, byte, 8);
	SCZO = cond(eax - Mem0[ebp + 0x0C:word32]);
	SO = SCZO;
	if (Test(GE,SO))
	{
		esp = ebp;
		ebp = Mem0[esp + 0x00:word32];
		esp = esp + 0x04;
		return D;
	}
	else
	{
		SCZO = cond(Mem0[ebp - 0x04 + 0x00:word32] - 0x01);
		SZO = SCZO;
		if (Test(GT,SZO))
		{
			eax = Mem0[ebp - 0x04 + 0x00:word32];
			ecx = Mem0[ebp + 0x08:word32];
			ecx = ecx + eax;
			eax = Mem0[ebp - 0x04 + 0x00:word32];
			edx = Mem0[ebp + 0x08:word32];
			edx = edx + eax;
			dl = (byte) edx;
			al = 0x99;
			al = 0x99 ^ Mem0[edx + 0x00:byte];
			SZO = cond(al);
			C = false;
			Mem0[ecx + 0x00:byte] = al;
		}
		SCZO = cond(Mem0[ebp - 0x04 + 0x00:word32] - 0x01);
		SZO = SCZO;
		if (Test(LE,SZO))
			goto l004010D4;
		eax = Mem0[ebp - 0x04 + 0x00:word32];
		al = (byte) eax;
		ah = SLICE(eax, byte, 8);
		D = fn004010B4(eax, ebp, out al, out ah, out ecx, out edx, out ebp);
		return D;
	}
}

// 0040111D: FpuStack real64 fn0040111D(Register byte al, Register byte ah, Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi, Register selector es, Stack word32 dwArg00, Stack word32 dwArg04, FpuStack real64 rArg0)
real64 fn0040111D(byte al, byte ah, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, selector es, word32 dwArg00, word32 dwArg04, real64 rArg0)
{
	Mem6[esi + 0x18:word32] = edi;
	byte al_15 = al + dl;
	word32 eax_110 = DPB(eax, al_15, 0);
	if (al_15 >= 0x00)
	{
		word32 ecx_226 = DPB(ecx, cl + Mem6[esi + 0xC48ECCCD:byte], 0);
		Mem230[ecx_226 - 0x78 + 0x00:byte] = Mem6[ecx_226 - 0x78 + 0x00:byte] | dh;
		__lock();
		word32 v27_237 = Mem230[ecx_226 + 1055280631:word32] + 0x01;
		Mem238[ecx_226 + 1055280631:word32] = v27_237;
		word16 dx_235 = (word16) (edx - 0x01);
		if (v27_237 <= 0x00)
			;
		else
		{
			__indw(dx_235);
			Mem243[ebp + 0xE08FF9C0:word32] = Mem238[ebp + 0xE08FF9C0:word32] & 0x9A47414A;
		}
	}
	word32 esp_113 = fp - 0x04;
	if (al_15 > 0x00)
	{
		if (al_15 <= 0x00)
		{
			byte al_219;
			byte ah_220;
			word32 ecx_221;
			word32 edx_222;
			word32 ebp_223;
			fn004010B4(eax_110, ebp + 0x01, out al_219, out ah_220, out ecx_221, out edx_222, out ebp_223);
			return rArg0;
		}
		if (al_15 > 0x00)
		{
l0040117F:
			Mem88[edi + 0x00:word32] = Mem6[esi + 0x00:word32];
			return rArg0 * (real64) Mem88[esi + 0x876A2507:word16];
		}
		byte al_163;
		byte ah_164;
		__aaa(al_15, ah, &al_163, &ah_164);
		word32 eax_167 = DPB(eax, al_163 + 0x4B, 0);
		if (al_163 <u 0x4B)
		{
			byte al_204;
			byte ah_205;
			word32 ecx_206;
			word32 edx_207;
			word32 ebp_208;
			fn004010C5(eax_167, ecx, edx, ebx - 0x01, ebp + 0x01, out al_204, out ah_205, out ecx_206, out edx_207, out ebp_208);
			return rArg0;
		}
		rArg0 = rArg0 + Mem6[(ebx - 0x01) + 0x00:real32];
		word32 eax_182 = (int32) DPB(ax, __inb(dx), 0);
		ecx = Mem6[edx + 0x6A:word32] *s 0x7BC02508;
		Mem187[eax_182 + 0x4A:word32] = cs;
		esp_113 = fp;
		eax_110 = DPB(eax_182, (byte) eax_182 + 0x6B, 0);
		ebx = ebx - 0x02;
	}
	word32 ecx_116 = ecx + Mem6[eax_110 + 0x00:word32];
	word32 esp_120 = esp_113 - 0x04;
	Mem121[esp_120 + 0x00:word32] = cond(ecx_116);
	Mem138[ebx + ~0x0CB57370:byte] = __rcr(Mem121[ebx + ~0x0CB57370:byte], 0x47, cond((byte) esi - 0x41 - (ecx_116 <u 0x00)));
	Mem141[esp_120 - 0x04 + 0x00:word32] = es;
	Mem145[ebp + 75487877:word32] = Mem141[ebp + 75487877:word32] | ~0x74;
	Mem158[edi + 0x00:word32] = __in(0x34030C15);
	word32 ebx_147 = ebx - 0x01;
	Mem161[ebx_147 + 0xAD4AA88F:byte] = Mem158[ebx_147 + 0xAD4AA88F:byte] >> 0x02;
	esi = ebp + 0x01;
	edi = edi + 0x04;
	goto l0040117F;
}

