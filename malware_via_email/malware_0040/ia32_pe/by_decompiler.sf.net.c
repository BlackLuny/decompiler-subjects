// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0040/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(word32 ebx, word32 ebp, word32 esi, word32 edi, selector es)
{
	word32 eax_15;
	word32 ecx_16;
	word32 edx_17;
	word32 ebp_18;
	fn00401078(out eax_15, out ecx_16, out edx_17, out ebp_18);
	Mem25[fp - 0x00000018:word32] = Mem0[0x00404400:word32];
	Mem27[fp - 0x0000001C:word32] = 0x00402000;
	fn0040111D(eax_15, ecx_16, edx_17, ebx, ebp_18, esi, edi, es, ebp, dwArg00, rArg0);
	Mem42[fp - 0x00000012:word32] = 0x0000062E;
	Mem44[fp - 0x00000016:word32] = 0x0040111D;
	word32 eax_45;
	word32 ecx_46;
	word32 edx_47;
	word32 ebp_48;
	fn00401078(out eax_45, out ecx_46, out edx_47, out ebp_48);
	if (false)
	{
		Mem61[fp - 0x00000012:word32] = 0x00405000;
		Mem63[fp - 0x00000016:word32] = 0x00401000;
		lstrcpyA(Mem63[fp - 0x00000016:LPSTR], Mem63[fp - 18:LPCSTR]);
	}
	return;
}

bool fn00401078(ptr32 eaxOut, ptr32 ecxOut, ptr32 edxOut, ptr32 ebpOut)
{
	word32 eax_9;
	word32 ecx_10;
	word32 edx_11;
	word32 ebp_12;
	return fn004010D4(fp - 0x00000004, out eax_9, out ecx_10, out edx_11, out ebp_12);
}

byte fn004010B4(word32 eax, word32 ebp, ptr32 eaxOut, ptr32 ecxOut, ptr32 edxOut, ptr32 ebpOut)
{
	esp = fp;
	ebp = ebp + 0x00000001;
	D = false;
	eax = eax - 0x00000001;
	eax = eax & 0x00000003;
	SZO = cond(eax & eax);
	Z = SZO;
	C = false;
	if (Test(EQ,Z))
		D = fn004010BE(ebp, out eax, out ecx, out edx, out ebp);
}

bool fn004010BE(word32 ebp, ptr32 eaxOut, ptr32 ecxOut, ptr32 edxOut, ptr32 ebpOut)
{
fn004010BE_entry:
	D = fn004010D4(ebp, out eax, out ecx, out edx, out ebp)
	return D
l004010BE:
	eax = Mem0[ebp - 0x00000004:word32]
	al = (byte) eax (alias)
	ecx = Mem0[ebp + 0x00000008:word32]
	ecx = ecx + eax
	SCZO = cond(ecx)
l004010C4_thunk_fn004010C5:
	D = fn004010C5(eax, ecx, edx, ebx, ebp, out eax, out ecx, out edx, out ebp)
	return D
fn004010BE_exit:
	use eax (=> eaxOut)
	use ecx (=> ecxOut)
	use edx (=> edxOut)
	use ebp (=> ebpOut)
}

bool fn004010C5(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, ptr32 eaxOut, ptr32 ecxOut, ptr32 edxOut, ptr32 ebpOut)
{
	esp = fp;
	v3 = (Mem0[ebx + 0x558BFC45:word32] & 0x00000100) != 0x00000000;
	Mem0[ebx + 0x558BFC45:word32] = __ror(Mem0[ebx + 0x558BFC45:word32], 0x08);
	edx = edx + eax;
	al = 0xBC;
	al = 0xBC + Mem0[edx + 0x00000000:byte];
	SCZO = cond(al);
	Mem0[ecx + 0x00000000:byte] = al;
	D = fn004010D4(ebp, out eax, out ecx, out edx, out ebp);
	return D;
}

bool fn004010D4(word32 ebp, ptr32 eaxOut, ptr32 ecxOut, ptr32 edxOut, ptr32 ebpOut)
{
	do
	{
		SCZO = cond(Mem0[ebp - 0x00000004:word32] - 0x00000003);
		SZO = SCZO;
		if (Test(GT,SZO))
		{
			eax = Mem0[ebp - 0x00000004:word32];
			ecx = Mem0[ebp + 0x00000008:word32];
			ecx = ecx + eax;
			eax = Mem0[ebp - 0x00000004:word32];
			eax = eax + Mem0[ebp + 0x00000008:word32];
			dl = 0xD4;
			edx = DPB(edx, dl, 0, 8);
			al = Mem0[eax + 0x00000000:byte];
			al = al - 0xD4;
			SCZO = cond(al);
			Mem0[ecx + 0x00000000:byte] = al;
		}
		eax = Mem0[ebp - 0x00000004:word32];
		eax = eax & 0x00000001;
		SZO = cond(eax & eax);
		Z = SZO;
		C = false;
		if (Test(EQ,Z))
		{
			eax = Mem0[ebp - 0x00000004:word32];
			ecx = Mem0[ebp + 0x00000008:word32];
			ecx = ecx + eax;
			eax = Mem0[ebp - 0x00000004:word32];
			eax = eax + Mem0[ebp + 0x00000008:word32];
			edx = Mem0[ebp - 0x00000004:word32];
			dl = (byte) edx;
			al = Mem0[eax + 0x00000000:byte];
			al = al - dl;
			SCZO = cond(al);
			Mem0[ecx + 0x00000000:byte] = al;
		}
		eax = ebp - 0x00000004;
		v12 = Mem0[eax + 0x00000000:word32] + 0x00000001;
		Mem0[eax + 0x00000000:word32] = v12;
		SZO = cond(v12);
		eax = Mem0[ebp - 0x00000004:word32];
		al = (byte) eax;
		SCZO = cond(eax - Mem0[ebp + 0x0000000C:word32]);
		SO = SCZO;
		if (Test(GE,SO))
		{
			esp = ebp;
			ebp = Mem0[esp + 0x00000000:word32];
			esp = esp + 0x00000004;
			return D;
		}
		SCZO = cond(Mem0[ebp - 0x00000004:word32] - 0x00000001);
		SZO = SCZO;
		if (Test(GT,SZO))
		{
			eax = Mem0[ebp - 0x00000004:word32];
			ecx = Mem0[ebp + 0x00000008:word32];
			ecx = ecx + eax;
			eax = Mem0[ebp - 0x00000004:word32];
			edx = Mem0[ebp + 0x00000008:word32];
			edx = edx + eax;
			dl = (byte) edx;
			al = 0x99;
			al = 0x99 ^ Mem0[edx + 0x00000000:byte];
			SZO = cond(al);
			C = false;
			Mem0[ecx + 0x00000000:byte] = al;
		}
		SCZO = cond(Mem0[ebp - 0x00000004:word32] - 0x00000001);
		SZO = SCZO;
	} while (Test(LE,SZO));
	eax = Mem0[ebp - 0x00000004:word32];
	al = (byte) eax;
	D = fn004010B4(eax, ebp, out eax, out ecx, out edx, out ebp);
	return D;
}

real64 fn0040111D(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, selector es, word32 dwArg00, word32 dwArg04, real64 rArg0)
{
fn0040111D_entry:
l0040111D:
	Mem6[esi + 0x00000018:word32] = edi
	byte al_15 = al + dl
	word32 eax_110 = DPB(eax, al_15, 0, 8)
	branch al_15 >= 0x00 l004011A2
l0040112A:
	word32 esp_113 = fp - 0x00000004
	branch al_15 <= 0x00 l00401151
l0040112D:
	branch al_15 <= 0x00 l0040112D_thunk_fn004010B4
	goto l0040112F
l0040112D_thunk_fn004010B4:
	word32 eax_218
	word32 ecx_219
	word32 edx_220
	word32 ebp_221
	fn004010B4(eax_110, ebp + 0x00000001, out eax_218, out ecx_219, out edx_220, out ebp_221)
	return rArg0
l0040112F:
	branch al_15 > 0x00 l0040117E
l00401131:
	byte al_163
	byte ah_164
	__aaa(al_15, ah, &al_163, &ah_164)
	word32 eax_167 = DPB(eax, al_163 + 0x4B, 0, 8)
	branch al_163 <u 0x4B l00401135_thunk_fn004010C5
	goto l00401137
l00401135_thunk_fn004010C5:
	word32 eax_204
	word32 ecx_205
	word32 edx_206
	word32 ebp_207
	fn004010C5(eax_167, ecx, edx, ebx - 0x00000001, ebp + 0x00000001, out eax_204, out ecx_205, out edx_206, out ebp_207)
	return rArg0
l00401137:
	rArg0 = rArg0 + Mem6[ebx - 0x00000001:real32]
	word32 eax_182 = (int32) DPB(ax, __inb(dx), 0, 8)
	ecx = Mem6[edx + 0x0000006A:word32] *s 0x7BC02508
	Mem187[eax_182 + 0x0000004A:word32] = cs
	esp_113 = fp
	eax_110 = DPB(eax_182, (byte) eax_182 + 0x6B, 0, 8) (alias)
	ebx = ebx - 0x00000002
l00401151:
	word32 ecx_116 = ecx + Mem6[eax_110 + 0x00000000:word32]
	word32 esp_120 = esp_113 - 0x00000004
	Mem121[esp_120 + 0x00000000:word32] = cond(ecx_116)
	Mem138[ebx + 0xF34A8C8F:byte] = __rcr(Mem121[ebx + 0xF34A8C8F:byte], 0x47, cond((byte) esi - 0x41 - (ecx_116 <u 0x00000000)))
	Mem141[esp_120 - 0x00000004:word32] = es
	Mem145[ebp + 0x047FDA85:word32] = Mem141[ebp + 0x047FDA85:word32] | 0xFFFFFF8B
	Mem158[edi + 0x00000000:word32] = __in(0x34030C15)
	word32 ebx_147 = ebx - 0x00000001
	Mem161[ebx_147 + 0xAD4AA88F:byte] = Mem158[ebx_147 + 0xAD4AA88F:byte] >> 0x02
	esi = ebp + 0x00000001
	edi = edi + 0x00000004
	goto l0040117F
l0040117E:
l0040117F:
	Mem88[edi + 0x00000000:word32] = Mem6[esi + 0x00000000:word32]
	return rArg0 * (real64) Mem88[(esi + 0x00000004) + 0x876A2503:word16]
l004011A2:
	word32 ecx_224 = DPB(ecx, cl + Mem6[esi + 0xC48ECCCD:byte], 0, 8)
	Mem228[ecx_224 - 0x00000078:byte] = Mem6[ecx_224 - 0x00000078:byte] | dh
	__lock()
	word32 v27_235 = Mem228[ecx_224 + 0x3EE64DF7:word32] + 0x00000001
	Mem236[ecx_224 + 0x3EE64DF7:word32] = v27_235
	word16 dx_233 = (word16) (edx - 0x00000001)
	branch v27_235 <= 0x00000000 l0040120B
l004011BD:
	__indw(dx_233)
	Mem241[ebp + 0xE08FF9C0:word32] = Mem236[ebp + 0xE08FF9C0:word32] & 0x9A47414A
l0040120B:
fn0040111D_exit:
}

