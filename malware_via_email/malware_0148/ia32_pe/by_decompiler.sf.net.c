// subject.c
// Generated on 5/4/2015 12:45:00 AM by decompiling malware_via_email/malware_0148/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000(word32 eax, word32 ecx, word32 ebx, word32 dwArg0100)
{
	word128 xmm2_10 = (word128) eax;
	word128 xmm2_11 = __pshufd(xmm2_10, xmm2_10, 0x44);
	if ((word32) xmm2_11 != eax)
	{
		fn0040104F();
		return;
	}
	else if ((word32) xmm2_11 != 0x00002710 && (word32) (dwArg0100 *u 0x0000DEAD) <= 0x4FFC2432)
	{
		fn00401816(dwLoc04);
		fn0040104F();
		return;
	}
	else
		return;
}

void fn0040104F()
{
fn0040104F_entry:
l0040104F:
fn0040104F_exit:
}

void fn00401816(word32 dwArg00)
{
fn00401816_entry:
	def fp
	def esi
	def edx
	def dwArg00
	def Mem0
l00401816:
	esp_1 = fp
	v3_3 = esi
	esi_5 = edx
	edx_7 = dwArg00
	esp_8 = fp + 0x00000004
	dx_9 = 0x0000
	edx_10 = DPB(edx_7, dx_9, 0, 16) (alias)
	SZO_11 = cond(0x0000)
	C_12 = false
l0040181C:
	edx_13 = PHI(edx_10, edx_20)
	dx_14 = PHI(dx_9, dx_21)
	SCZO_16 = cond(Mem0[edx_13 + 0x00000000:byte] - 0x4D)
	Z_17 = SCZO_16 (alias)
	branch Mem0[edx_13 + 0x00000000:byte] != 0x4D l00401827
l00401821:
	SCZO_22 = cond(Mem0[edx_13 + 0x00000001:byte] - 0x5A)
	Z_23 = SCZO_22 (alias)
	branch Mem0[edx_13 + 0x00000001:byte] == 0x5A l0040182F
l00401827:
	Z_18 = PHI(Z_23, Z_17)
	SCZO_19 = PHI(SCZO_22, SCZO_16)
	edx_20 = edx_13 + 0xFFFFF000
	dx_21 = (word16) edx_20 (alias)
	goto l0040181C
l0040182F:
	ebx_24 = edx_13
	ecx_25 = 0x0326BF37
	ecx_26 = 0x00000434
	esp_27 = fp
	dwArg00_28 = 0xFFFFAC00
	esi_29 = dwArg00_28
	esp_30 = fp + 0x00000004
	D_31 = false
	esi_32 = -esi_29
	esi_33 = esi_32 + edx_13
	SCZO_34 = cond(esi_33)
	edx_35 = esi_33
	edi_36 = edx_35
	esp_37 = fp
	dwArg00_38 = edx_35
l00401853:
	goto l00401870
l00401855:
	eax = eax - 0x02304D3E
	SCZO = cond(eax)
	fn0040104F()
	ecx = ecx - 0x00487F6A
	ecx = ecx + 0x00487F69
	SZO = cond(ecx & ecx)
	Z = SZO (alias)
	C = false
	branch Test(NE,Z) l00401853
l0040186F:
	return
l00401870:
	eax = Mem0[esi + 0x00000000:word32]
	esi = esi + 0x00000004
	goto l00401855
fn00401816_exit:
}

