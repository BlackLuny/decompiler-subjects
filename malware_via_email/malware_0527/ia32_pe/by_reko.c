// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401006: FlagGroup byte fn00401006(Register word32 eax, Register word32 ecx, Register byte dl, Register byte dh, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi, Register selector es, Register out ptr32 eaxOut, Register out ptr32 edxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
byte fn00401006(word32 eax, word32 ecx, byte dl, byte dh, word32 ebx, word32 ebp, word32 esi, word32 edi, selector es, ptr32 & eaxOut, ptr32 & edxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	byte dl_6 = dl + al;
	word32 edx_18 = DPB(edx, dl_6 + bh, 0);
	word32 esi_10 = esi | DPB(edx, dl_6, 0);
	word32 edi_20 = edi - 0x01 - ecx | eax;
	word32 edx_25 = DPB(edx_18 - 0x01, SLICE(edx_18 - 0x01, byte, 8) ^ al, 8);
	word32 eax_31;
	word32 edx_32;
	word32 esi_33;
	word32 edi_34;
	return fn00401125(eax, ecx, edx_25, ebx, ebp, esi_10, edi_20, es, out eax_31, out edx_32, out esi_33, out edi_34);
}

// 0040103E: void fn0040103E(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi, Register selector es)
void fn0040103E(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, selector es)
{
	word32 edx_6 = edx | ecx;
	word32 esi_8 = esi - eax;
	word32 ebp_17 = Mem0[ebp + 0x00:word32];
	fn004010D9(eax, edx_6 + 0x01, ebx, ebp_17, esi_8, eax, es);
	return;
}

// 00401052: FlagGroup byte fn00401052(Register word32 eax, Register word32 ecx, Register word16 dx, Register word32 ebx, Register word32 ebp, Register selector es, Stack word32 dwArg00, FpuStack real64 rArg0, Register out ptr32 edxOut, Register out ptr32 esiOut, Register out ptr32 ediOut, FpuStack out ptr32 rArg0Out)
byte fn00401052(word32 eax, word32 ecx, word16 dx, word32 ebx, word32 ebp, selector es, word32 dwArg00, real64 rArg0, ptr32 & edxOut, ptr32 & esiOut, ptr32 & ediOut, ptr32 & rArg0Out)
{
	word32 edx_5 = edx | eax;
	byte dh_14 = SLICE(edx_5, byte, 8) ^ ah ^ al;
	word32 edx_21 = DPB(edx_5, cl, 8);
	if (dh_14 == 0x00 || dh_14 != 0x00)
	{
		word32 edx_49 = DPB(edx_5, cl + ch - ah, 8);
		word32 edx_56 = DPB(edx_49 + 0x01, SLICE(edx_49 + 0x01, byte, 8) | bh, 8);
		word32 esi_61 = (ecx ^ eax) - 0x01 + edx_56;
		word32 edi_64 = edx_56 - esi_61;
		word32 esi_73;
		word32 edi_74;
		word32 edx_75 = fn00401072(eax, ecx, ebx | edi_64, ebx, ebp, esi_61, edi_64, es, out esi_73, out edi_74);
		*edxOut = edx_75;
		byte v25_87 = Mem0[edx_75 - 117 + 0x00:byte] + ~0x07;
		Mem88[edx_75 - 117 + 0x00:byte] = v25_87;
		word32 eax_83 = DPB(eax, al ^ ~0x0A, 0);
		byte SCZO_89 = cond(v25_87);
		fn004010D9(eax_83, edx_75, ebx, ebp, esi_73, edi_74, es);
		return SCZO_89;
	}
	else
	{
		word32 edx_99 = edx_21 - ecx;
		*edxOut = edx_99;
		word32 esi_106;
		*esiOut = eax;
		word32 edi_107;
		*ediOut = edx_99 + 0x01;
		if (edx_99 <= 0x01)
		{
			fn0040103E(eax, ecx, edx_99, ebx, ebp, eax, edx_99 + 0x01, es);
			return false;
		}
		else
		{
			fn00401082(eax, ecx, edx_99, ebx, ebp, eax, edx_99 + 0x01, es);
			return false;
		}
	}
}

// 00401072: Register word32 fn00401072(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi, Register selector es, Register out ptr32 esiOut, Register out ptr32 ediOut)
word32 fn00401072(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, selector es, ptr32 & esiOut, ptr32 & ediOut)
{
	word32 edx_7 = edx - ecx;
	word32 esi_13;
	*esiOut = eax;
	word32 edi_14;
	*ediOut = edx_7 + 0x01;
	if (edx_7 <= 0x01)
	{
		fn0040103E(eax, ecx, edx_7, ebx, ebp, eax, edx_7 + 0x01, es);
		return edx_7;
	}
	else
	{
		fn00401082(eax, ecx, edx_7, ebx, ebp, eax, edx_7 + 0x01, es);
		return edx_7;
	}
}

// 00401082: void fn00401082(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi, Register selector es)
void fn00401082(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, selector es)
{
	if (SZO)
	{
		fn0040103E(eax, ecx, edx, ebx, ebp, esi, edi, es);
		return;
	}
	else
	{
		fn004010A6(ecx, edx, ebx, esi, edi + 0x01, dwLoc04);
		fn004010A6(ecx + 0x01, edx, ebx, esi, 1302111254, dwArg00);
		return;
	}
}

// 00401090: void fn00401090(Register word16 ax, Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 esi, Register word32 edi)
void fn00401090(word16 ax, word32 ecx, word32 edx, word32 ebx, word32 esi, word32 edi)
{
	fn004010A6(ecx, edx, ebx, esi, edi + 0x01, dwArg00);
	fn004010A6(ecx + 0x01, edx, ebx, esi, 1302111254, dwArg00);
	return;
}

// 004010A6: void fn004010A6(Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 esi, Register word32 edi, Stack word32 dwArg00)
void fn004010A6(word32 ecx, word32 edx, word32 ebx, word32 esi, word32 edi, word32 dwArg00)
{
	fn0040115D(ecx - 0x02, edx, (ebx | edi) + edx, esi, edi, dwArg00);
}

// 004010D9: void fn004010D9(Register word32 eax, Register word32 edx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi, Register selector es)
void fn004010D9(word32 eax, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, selector es)
{
	fn00401090(ax, edi, edx + 0x01, edi, esi - 0x01, edi * 0x02);
	word32 edx_27 = DPB(edx + 0x01, SLICE(edx + 0x01, byte, 8) + Mem0[esi + 0x0A:byte], 8);
	word32 eax_31;
	word32 edx_32;
	word32 esi_33;
	word32 edi_34;
	fn004010EF(eax | 1093593349, edi, edx_27, edi, ebp, esi - 0x01, edi * 0x02, es, out eax_31, out edx_32, out esi_33, out edi_34);
	return;
}

// 004010EF: FlagGroup byte fn004010EF(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi, Register selector es, Register out ptr32 eaxOut, Register out ptr32 edxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
byte fn004010EF(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, selector es, ptr32 & eaxOut, ptr32 & edxOut, ptr32 & esiOut, ptr32 & ediOut)
{
fn004010EF_entry:
	def fp
	def edi
	def ecx
	def esi
	def edx
	def ebx
	def eaxOut
	def edxOut
	def esiOut
	def ediOut
	def eax
	def ebp
	def es
	esp_1 = fp
	edi_4 = edi | ecx
	esi_7 = esi + edx
	esi_9 = esi_7 - ebx
	edi_10 = edi_4 - ecx
	edi_11 = edi_10 - 0x01
	esi_12 = edi_11
	edx_13 = edx | esi_12
	dl_14 = (byte) edx_13 (alias)
	dh_15 = SLICE(edx_13, byte, 8) (alias)
	C_16 = false
	edi_17 = edi_11 - 0x01
	SZO_18 = cond(edi_17)
	SCZO_19 = SZO_18 (alias)
	S_20 = SZO_18 (alias)
	branch edi_17 < 0x00 l004010FD_thunk_fn00401006
	goto l004010FD_thunk_fn00401103
l004010EF:
l004010EF:
	esi = esi + edx
	esi = esi - ebx
	edi = edi - ecx
	edi = edi - 0x01
	esi = edi
	edx = edx | esi
	dl = (byte) edx (alias)
	dh = SLICE(edx, byte, 8) (alias)
	C = false
	edi = edi - 0x01
	SZO = cond(edi)
	SCZO = SZO (alias)
	S = SZO (alias)
	branch Test(SG,S) l00401006
	goto l004010FC_thunk_fn00401103
l004010FC_thunk_fn00401006:
	SCZO = fn00401006(eax, ecx, dl, dh, ebx, ebp, esi, edi, es, out eax, out edx, out esi, out edi)
	C = SCZO (alias)
	SZO = SCZO (alias)
	S = SCZO (alias)
	return SCZO
l004010FC_thunk_fn00401103:
	SCZO = fn00401103(eax, ecx, dl, dh, ebx, ebp, esi, edi, es, out eax, out edx, out esi, out edi)
	C = SCZO (alias)
	SZO = SCZO (alias)
	S = SCZO (alias)
	return SCZO
l004010FD_thunk_fn00401006:
	SCZO_56 = fn00401006(eax, ecx, dl_14, dh_15, ebx, ebp, esi_12, edi_17, es, out eax_52, out edx_53, out esi_54, out edi_55)
	C_57 = SCZO_56 (alias)
	SZO_58 = SCZO_56 (alias)
	S_59 = SCZO_56 (alias)
	return SCZO_56
l004010FD_thunk_fn00401103:
	SCZO_40 = fn00401103(eax, ecx, dl_14, dh_15, ebx, ebp, esi_12, edi_17, es, out eax_36, out edx_37, out esi_38, out edi_39)
	C_41 = SCZO_40 (alias)
	SZO_42 = SCZO_40 (alias)
	S_43 = SCZO_40 (alias)
	return SCZO_40
l004010FD_thunk_fn00401103:
	SCZO_48 = fn00401103(eax_36, ecx, dl_14, dh_15, ebx, ebp, esi_38, edi_39, es, out eax_44, out edx_45, out esi_46, out edi_47)
	C_49 = SCZO_48 (alias)
	SZO_50 = SCZO_48 (alias)
	S_51 = SCZO_48 (alias)
	return SCZO_48
fn004010EF_exit:
	eax_21 = PHI(eax_52, eax_36, eax_44, eax, eax)
	edx_22 = PHI(edx_53, edx_37, edx_45, edx, edx)
	esi_23 = PHI(esi_54, esi_38, esi_46, esi, esi)
	edi_24 = PHI(edi_55, edi_39, edi_47, edi, edi)
	SCZO_25 = PHI(SCZO_56, SCZO_40, SCZO_48, SCZO, SCZO)
	C_26 = PHI(C_57, C_41, C_49, C, C)
	SZO_27 = PHI(SZO_58, SZO_42, SZO_50, SZO, SZO)
	S_28 = PHI(S_59, S_43, S_51, S, S)
	use eax_21 (=> eaxOut)
	use edx_22 (=> edxOut)
	use esi_23 (=> esiOut)
	use edi_24 (=> ediOut)
}

// 00401103: FlagGroup byte fn00401103(Register word32 eax, Register word32 ecx, Register byte dl, Register byte dh, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi, Register selector es, Register out ptr32 eaxOut, Register out ptr32 edxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
byte fn00401103(word32 eax, word32 ecx, byte dl, byte dh, word32 ebx, word32 ebp, word32 esi, word32 edi, selector es, ptr32 & eaxOut, ptr32 & edxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	*esiOut = esi;
	*ediOut = edi;
	if (S)
	{
		word32 eax_41;
		word32 edx_42;
		word32 esi_43;
		word32 edi_44;
		return fn00401006(eax, ecx, dl, dh, ebx, ebp, esi, edi, es, out eax_41, out edx_42, out esi_43, out edi_44);
	}
	else
	{
		byte al_19;
		byte ah_20;
		byte C_21 = __aaa(al, ah, &al_19, &ah_20);
		word32 v10_26 = (ecx + 0x1C)[eax * 0x02];
		(ecx + 0x1C)[eax * 0x02] = eax;
		word32 eax_28;
		*eaxOut = v10_26;
		word32 edx_33;
		*edxOut = DPB(edx, 0x03, 8);
		fn00401112();
		return C_21;
	}
}

// 00401112: void fn00401112()
void fn00401112()
{
	esp = fp;
}

// 00401125: FlagGroup byte fn00401125(Register word32 eax, Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi, Register selector es, Register out ptr32 eaxOut, Register out ptr32 edxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
byte fn00401125(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, selector es, ptr32 & eaxOut, ptr32 & edxOut, ptr32 & esiOut, ptr32 & ediOut)
{
	word32 edx_27;
	word32 esi_28;
	word32 edi_29;
	real64 rArg0_30;
	byte C_31 = fn00401052(eax, ecx, DPB(dx, ((byte) ebx ^ al) - bl, 0), ebx, ebp, es, dwLoc04, rArg0, out edx_27, out esi_28, out edi_29, out rArg0_30);
	word32 eax_35 = DPB(eax, Mem0[esi_28 + 0x00:byte], 0);
	Mem38[fp - 0x04 + 0x00:word32] = es;
	word32 eax_39 = eax_35 - 0x50E33534 - C_31;
	*eaxOut = eax_39;
	word32 esi_36;
	*esiOut = esi_28 + 0x01;
	return cond(eax_39);
}

// 0040113E: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 edx_18 = (esi - 0x01 | (esi - ecx ^ ecx) + 0x01) - eax;
	if (P || P)
	{
		fn00401112();
		return eax;
	}
	else
	{
		Mem39[edx_18 + 0x373A9963:word32] = 0x24448FAA;
		word32 eax_41 = DPB(eax, __aam(al), 0);
		fn00401181();
		return eax_41;
	}
}

// 0040115D: void fn0040115D(Register word32 ecx, Register word32 edx, Register word32 ebx, Register word32 esi, Register word32 edi, Stack word32 dwArg00)
void fn0040115D(word32 ecx, word32 edx, word32 ebx, word32 esi, word32 edi, word32 dwArg00)
{
	fn00401181();
	return;
}

// 00401181: void fn00401181()
void fn00401181()
{
fn00401181_entry:
l00401181:
fn00401181_exit:
}

