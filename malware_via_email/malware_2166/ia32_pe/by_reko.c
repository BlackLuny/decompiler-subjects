// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401005: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 eax_26 = 0x00 - ecx + edi - ecx + edi - ecx + edi - ecx + edi;
	Mem57[fp - 44 + 0x00:word32] = fn0040105F(eax_26, eax_26, 81267607, 0x00, eax);
	word32 eax_58 = Mem57[fp - 44 + 0x00:word32];
	return fn0040105F(eax_58, dwArg00, dwArg14, dwArg18, dwArg24);
}

// 0040105F: Register word32 fn0040105F(Register word32 eax, Stack word32 dwArg00, Stack word32 dwArg14, Stack word32 dwArg18, Stack word32 dwArg24)
word32 fn0040105F(word32 eax, word32 dwArg00, word32 dwArg14, word32 dwArg18, word32 dwArg24)
{
	word32 eax_14 = dwArg00;
	word16 ax_15 = (word16) dwArg00;
l0040107A:
	word32 eax_25 = DPB(eax_14, ax_15 & 0x00, 0);
	word32 ecx_33 = DPB(ecx, Mem0[eax_25 + 0x00:word16], 0);
	ecx = ecx_33 + 42418;
	word16 cx_43 = (word16) (ecx_33 + 42418);
	if (cx_43 != 0x01)
	{
		eax_14 = eax_25 - 0x00010000;
		ax_15 = (word16) (eax_25 - 0x00010000);
		if (eax_25 != 0x00010000)
			goto l0040107A;
	}
	word32 ebx_225;
	word32 ecx_226 = fn0040164A(dwArg24, fp - 0x28, out ebx_225);
	word32 esp_272;
	word32 eax_273;
	byte SZO_274;
	word32 ecx_275;
	selector cs_276;
	word32 ebp_277;
	word32 edx_278;
	word16 ax_279;
	byte C_280;
	word16 cx_281;
	byte SCZO_282;
	byte Z_283;
	word32 esi_284;
	word32 ebx_285;
	word32 edi_286;
	selector fs_287;
	Mem0[ebx_225 + 0x20:word32]();
	Mem289[esp_272 - 0x04 + 0x00:word32] = eax_273;
	word32 eax_292 = Mem289[esi_284 - 0x02 + 0x00:word32];
	Mem297[esp_272 + 0x38:word32] = eax_292 >>u 0x08;
	Mem299[esp_272 - 0x04 + 0x00:word32] = eax_292 >>u 0x08;
	word32 eax_300 = Mem299[esp_272 - 0x04 + 0x00:word32];
	Mem306[esp_272 - 0x04 + 0x00:word32] = ebx_285;
	Mem308[esp_272 - 0x04 + 0x00:word32] = Mem306[esp_272 - 0x04 + 0x00:word32] - 0x04;
	Mem311[esp_272 - 0x08 + 0x00:word32] = eax_300 + 0x01;
	Mem316[esp_272 - 0x08 + 0x00:word32] = Mem311[esp_272 - 0x08 + 0x00:word32];
	Mem321[esp_272 - 0x08 + 0x00:word32] = Mem316[esp_272 - 0x08 + 0x00:word32];
	word32 eax_322 = Mem321[esp_272 - 0x08 + 0x00:word32];
	Mem324[esp_272 + 0x3C:word32] = ebx_285;
	Mem326[esp_272 - 0x08 + 0x00:word32] = eax_322;
	word32 eax_327 = Mem326[esp_272 - 0x08 + 0x00:word32];
	word32 edi_330 = Mem326[esp_272 - 0x04 + 0x00:word32];
	Mem333[esp_272 - 0x04 + 0x00:word32] = eax_327;
	Mem335[esp_272 - 0x08 + 0x00:word32] = ecx_275;
	Mem337[esp_272 - 0x0C + 0x00:word32] = eax_327;
	word32 eax_338 = Mem337[esp_272 - 0x0C + 0x00:word32];
	Mem342[esp_272 - 0x0C + 0x00:word32] = esp_272 - 0x08;
	Mem344[esp_272 - 0x10 + 0x00:word32] = eax_338;
	word32 eax_345 = Mem344[esp_272 - 0x10 + 0x00:word32];
	Mem348[esp_272 - 0x10 + 0x00:word32] = 0x40;
	Mem350[esp_272 - 0x14 + 0x00:word32] = eax_345;
	word32 eax_351 = Mem350[esp_272 - 0x14 + 0x00:word32];
	Mem355[esp_272 - 0x14 + 0x00:word32] = Mem350[esp_272 + 0x20:word32];
	Mem357[esp_272 - 0x18 + 0x00:word32] = eax_351;
	word32 eax_358 = Mem357[esp_272 - 0x18 + 0x00:word32];
	Mem362[esp_272 - 0x18 + 0x00:word32] = Mem357[esp_272 + 0x14:word32];
	Mem364[esp_272 - 0x1C + 0x00:word32] = eax_358;
	Mem369[esp_272 - 0x1C + 0x00:word32] = Mem364[esp_272 - 0x1C + 0x00:word32];
	word32 esp_376;
	word32 eax_377;
	byte SZO_378;
	word32 ecx_379;
	selector cs_380;
	word32 ebp_381;
	word32 edx_382;
	word16 ax_383;
	byte C_384;
	word16 cx_385;
	byte SCZO_386;
	byte Z_387;
	word32 esi_388;
	word32 ebx_389;
	word32 edi_390;
	selector fs_391;
	Mem369[edi_330 + 0x0C:word32]();
	Mem393[esp_376 - 0x04 + 0x00:word32] = eax_377;
	Mem399[esp_376 + 0x00:word32] = Mem393[esp_376 - 0x04 + 0x00:word32];
	Mem405[esp_376 + 0x04:word32] = Mem399[esp_376 + 0x00:word32];
	Mem411[esp_376 + 0x08:word32] = Mem405[esp_376 + 0x04:word32];
	Mem417[esp_376 + 0x0C:word32] = Mem411[esp_376 + 0x08:word32];
	Mem423[esp_376 + 0x10:word32] = Mem417[esp_376 + 0x0C:word32];
	Mem428[esp_376 + 0x10:word32] = Mem423[esp_376 + 0x10:word32] + 0x2F;
	Mem433[esp_376 + 0x10:word32] = Mem428[fs_391:Mem428[esp_376 + 0x10:word32] + 0x00:word32];
	word32 eax_434 = Mem433[esp_376 + 0x10:word32];
	word32 ecx_439 = Mem433[eax_434 + 0x04:word32];
	Mem442[esp_376 + 0x3C:word32] = Mem433[esp_376 + 0x3C:word32] ^ ecx_439;
	Mem445[esp_376 + 0x10:word32] = eax_434 + 0x04;
	Mem450[esp_376 + 0x10:word32] = Mem445[esp_376 + 0x1C:word32];
	word32 ecx_453 = Mem450[esp_376 + 44:word32];
	Mem455[esp_376 + 0x10:word32] = Mem450[esp_376 + 0x10:word32];
	Mem461[esp_376 - 0xF8 + 0x00:word32] = Mem455[esp_376 + 0x10:word32];
	Mem466[esp_376 - 0xF8 + 0x00:word32] = Mem461[esp_376 - 0xF8 + 0x00:word32];
	word32 eax_467 = Mem466[esp_376 - 0xF8 + 0x00:word32];
	Mem473[esp_376 - 244 + 0x00:word32] = eax_467;
	Mem475[esp_376 - 0xF8 + 0x00:word32] = eax_467;
	word32 eax_476 = Mem475[esp_376 - 0xF8 + 0x00:word32];
	Mem478[esp_376 - 0xF0 + 0x00:word32] = ecx_453;
	Mem480[esp_376 - 0xF8 + 0x00:word32] = eax_476;
	Mem487[esp_376 - 0xF8 + 0x00:word32] = 0x00;
	word32 eax_488 = Mem487[esp_376 - 0xF8 + 0x00:word32];
	return fn0040133E(eax_488);
}

// 0040133E: Register word32 fn0040133E(Register word32 eax)
word32 fn0040133E(word32 eax)
{
fn0040133E_entry:
	def fp
	def eax
	esp_1 = fp
	ecx_3 = fp + 0x08 + eax
	esp_4 = fp - 0x04
	dwLoc04_5 = eax
	eax_6 = ecx_3
	eax_7 = Hgomiqdjr(ecx_3, dwLoc04_5)
	return eax_7
l0040133E:
l0040133E:
	ecx = esp + 0x08 + eax
	esp = esp - 0x04
	Mem0[esp + 0x00:word32] = eax
	eax = ecx
	eax = Hgomiqdjr(ecx, dwArg00)
	return eax
l00401343_thunk_Hgomiqdjr:
l00401343_thunk_Hgomiqdjr:
fn0040133E_exit:
	eax_8 = PHI(eax_7, eax)
}

// 00401346: Register word32 Hgomiqdjr(Register word32 ecx, Stack word32 dwArg00)
word32 Hgomiqdjr(word32 ecx, word32 dwArg00)
{
	Mem6[ecx + 0x00:byte] = (byte) dwArg00;
	return Nckurdj(dwArg00 + 0x01, dwArg04, dwArg08, dwArg0110, dwArg011C, dwArg0120, dwArg0134, dwArg0138, dwArg013C);
}

// 00401363: Register word32 Nckurdj(Stack word32 dwArg00, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0110, Stack word32 dwArg011C, Stack word32 dwArg0120, Stack word32 dwArg0134, Stack word32 dwArg0138, Stack word32 dwArg013C)
word32 Nckurdj(word32 dwArg00, word32 dwArg04, word32 dwArg08, word32 dwArg0110, word32 dwArg011C, word32 dwArg0120, word32 dwArg0134, word32 dwArg0138, word32 dwArg013C)
{
	if (Z)
		return fn0040133E(dwArg00);
	else
	{
		word32 ecx_108 = 0x00;
		word32 esi_106 = 0x00;
		word32 ebp_107 = 0x00;
		word32 eax_110 = dwArg00;
		do
		{
			word32 eax_113 = DPB(eax_110, Mem0[fp + 0x0C + ebp_107:byte], 8);
			byte dl_141 = (byte) ((word32) Mem0[ecx_108 + dwArg08:byte] + ((word32) SLICE(eax_113, byte, 8) + esi_106));
			word32 edx_146 = (word32) dl_141;
			ecx_108 = ecx_108 + 0x01;
			if (ecx_108 >=u dwArg011C)
				ecx_108 = 0x00;
			byte al_175 = Mem0[fp + 0x0C + edx_146:byte];
			word32 eax_176 = DPB(eax_113, al_175, 0);
			word32 esi_184 = fp + 0x0C + ebp_107;
			Mem185[esi_184 + 0x00:byte] = 0x00;
			Mem192[esi_184 + 0x00:byte] = Mem185[esi_184 + 0x00:byte] + al_175;
			Mem225[fp - 0x0C + (edx_146 + 0x18):byte] = SLICE(eax_176, byte, 8);
			ebp_107 = ebp_107 + 0x01;
			eax_110 = eax_176;
			esi_106 = edx_146;
		} while (ebp_107 <u 0x0100);
		word32 ecx_253 = dwArg0138;
		byte ch_254 = SLICE(dwArg0138, byte, 8);
		if (ch_254 == ~0x05)
		{
			word32 esi_376 = 0x00;
			word32 ebp_395 = dwArg0120;
			word32 edi_402 = dwArg04;
			if (true)
			{
				word32 eax_462 = 0x00;
				do
				{
					word32 eax_481 = (word32) (byte) (eax_462 + 0x01);
					byte cl_486 = Mem225[fp + 0x0C + eax_481:byte];
					word32 edx_503 = (word32) (byte) ((word32) cl_486 + esi_376);
					word32 ecx_487 = DPB(ecx_253, cl_486, 0);
					byte dl_513 = Mem225[fp + 0x0C + edx_503:byte];
					Mem523[fp + 0x0C + eax_481:byte] = dl_513;
					Mem541[fp + 0x0C + edx_503:byte] = cl_486;
					esi_376 = edx_503;
					Mem596[edi_402 + 0x00:byte] = Mem541[edi_402 + 0x00:byte] ^ Mem541[(fp - 0x08) + ((word32) ((byte) (Mem541[(fp + 0x0C) + eax_481:word32] + ecx_487)) + 0x14):byte];
					ecx_253 = 0x00;
					edi_402 = edi_402 + 0x01;
					ebp_395 = ebp_395 - 0x01;
					eax_462 = eax_481;
				} while (ebp_395 != 0x00);
			}
			return dwArg0110;
		}
		else
		{
			word32 esp_278;
			word32 eax_279;
			byte Z_280;
			word32 ecx_281;
			selector cs_282;
			word32 ebp_283;
			word32 esi_284;
			word32 edi_285;
			byte SZO_286;
			byte C_287;
			word32 ebx_288;
			byte ah_289;
			word32 edx_290;
			byte SCZO_291;
			byte dl_292;
			byte al_293;
			byte bh_294;
			byte ch_295;
			byte CZ_296;
			byte cl_297;
			Mem225[dwArg013C - 0x04 + 0x00:word32]();
			Mem299[esp_278 - 0x04 + 0x00:word32] = eax_279;
			do
			{
				word32 esp_304;
				word32 eax_305;
				byte Z_306;
				word32 ecx_307;
				selector cs_308;
				word32 ebp_309;
				word32 esi_310;
				word32 edi_311;
				byte SZO_312;
				byte C_313;
				word32 ebx_314;
				byte ah_315;
				word32 edx_316;
				byte SCZO_317;
				byte dl_318;
				byte al_319;
				byte bh_320;
				byte ch_321;
				byte CZ_322;
				byte cl_323;
				Mem299[ebx_288 + 0x08:word32]();
				Mem325[esp_304 - 0x04 + 0x00:word32] = eax_305;
				Mem330[esp_304 - 0x04 + 0x00:word32] = Mem325[esp_304 - 0x04 + 0x00:word32];
				word32 eax_331 = Mem330[esp_304 - 0x04 + 0x00:word32];
				Mem336[esp_304 + 0x00:word32] = Mem330[esp_304 + 0x00:word32] | eax_331;
			} while (ebp_309 != 0x01);
			Mem345[esp_304 - 0x04 + 0x00:word32] = eax_331;
			Mem349[esp_304 - 0x04 + 0x00:word32] = Mem345[esp_304 - 0x04 + 0x00:word32];
			word32 esp_352;
			word32 eax_353;
			byte Z_354;
			word32 ecx_355;
			selector cs_356;
			word32 ebp_357;
			word32 esi_358;
			word32 edi_359;
			byte SZO_360;
			byte C_361;
			word32 ebx_362;
			byte ah_363;
			word32 edx_364;
			byte SCZO_365;
			byte dl_366;
			byte al_367;
			byte bh_368;
			byte ch_369;
			byte CZ_370;
			byte cl_371;
			Mem349[ebx_314 + 0x14:word32]();
			Mem373[esp_352 - 0x04 + 0x00:word32] = eax_353;
		}
	}
}

// 0040164A: Register word32 fn0040164A(Stack word32 dwArg00, Stack word32 dwArg04, Register out ptr32 ebxOut)
word32 fn0040164A(word32 dwArg00, word32 dwArg04, ptr32 & ebxOut)
{
	word32 eax_117 = dwArg00;
	do
	{
		word16 ax_31 = Mem0[DPB(eax_117, 0x00, 0) + 0x00:word16];
		word32 eax_39 = DPB(eax_117, ax_31 + 42421, 0);
		word32 eax_121 = eax_39;
		if (ax_31 == 42419)
			goto l004016AA;
		eax_117 = eax_39 - 0x00010000;
	} while (eax_39 != 0x00010000);
	eax_121 = eax_39 - 0x00010000;
l004016AA:
	word32 eax_56 = DPB(eax_121, 0x00, 0);
	word32 ecx_64 = Mem0[eax_56 + 0x3C:word32];
	word32 ecx_65 = eax_56 + ecx_64;
	word32 ecx_76 = Mem0[eax_56 + Mem0[ecx_65 + 0x80:word32]:word32];
	word32 ebx_91;
	*ebxOut = eax_56 + ecx_76 + 0x04;
	return ecx_76;
}

