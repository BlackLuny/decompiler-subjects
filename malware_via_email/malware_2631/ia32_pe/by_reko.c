// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0040100E: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	Eq_3 eax_23 = CreateFileA(&globals->t435F0A, 0x40000000, 0x06, null, 0x03, 0x0105, 0x00);
	if (eax_23 != ~0x00)
	{
		GetFileSize(dwLoc08, null);
		CloseHandle(eax_23);
		GetVersion();
		GetCurrentThreadId();
		CloseHandle(eax_23);
		GetCurrentProcessId();
		VirtualProtect(&globals->v40125D, 60080, 0x40, eax_23);
		GetCommandLineW();
		GetCommandLineW();
		GetCurrentProcessId();
		GetCurrentProcessId();
		word32 esp_184;
		word32 ebp_185;
		byte SCZO_186;
		word32 eax_187;
		byte Z_188;
		byte SZO_189;
		byte C_190;
		bcuiposr0 None_191;
		struct Eq_72 * edx_192;
		ui32 esi_193;
		byte D_194;
		byte al_195;
		word32 ecx_196;
		byte dh_197;
		byte bl_198;
		(dwLoc1C - ~0x40401204)();
		GetOEMCP();
		*(ebp - 0x24) = (uint32) GetVersion();
		Eq_33 eax_208 = CloseHandle(*(ebp - 0x1C));
		byte al_209 = (byte) eax_208;
		edx_192->dw7B8412FD = edx_192->dw7B8412FD & esi_193;
		byte al_215;
		__das(al_209, &al_215);
		edx_192->dwB1C12FFD = edx_192->dwB1C12FFD & esi_193;
		if (edx_192->dwB1C12FFD != 0x00 && ecx_196 != 0x01)
		{
			byte al_233;
			__das(al_215, &al_233);
			edx_192->b0000 = edx_192->b0000 & bl_198;
			__outdw(edx_192, eax_208);
		}
		else
		{
			(eax_208 - (struct <anonymous> *) 0x14)->dw0000 = (eax_208 - (struct <anonymous> *) 0x14)->dw0000 + 3696836911;
			byte al_226;
			__das(al_215, &al_226);
			edx_192->b0000 = -edx_192->b0000;
		}
	}
	else
	{
		GetFileType(dwLoc18);
		Eq_3 eax_35 = GetModuleHandleA(&globals->t435EED);
		GetACP();
		Eq_117 eax_44 = GetProcAddress(eax_35, &globals->t435EF7);
		GetFileSize(eax_35, null);
		GetFileSize(eax_23, null);
		GetCurrentThreadId();
		CreateFileA(&globals->t435EE7, 0x40000000, 0x02, null, 0x03, 0x00, 0x00);
		GetCurrentThreadId();
		GetCommandLineA();
		int32 eax_91 = eax_44();
		GetProcessHeap();
		<anonymous> * eax_107 = (eax_91 ^ 0xC0000005) + 0x00401117;
		word32 esp_109;
		word32 ebp_110;
		byte SCZO_111;
		Eq_2 eax_112;
		byte Z_113;
		byte SZO_114;
		byte C_115;
		bcuiposr0 None_116;
		word32 edx_117;
		word32 esi_118;
		byte D_119;
		byte al_120;
		word32 ecx_121;
		byte dh_122;
		byte bl_123;
		eax_107();
		return eax_112;
	}
}

