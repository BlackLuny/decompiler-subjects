__size32 proc1(__size32 param1, __size8 *param2, __size8 *param3);

// address: 0x40103a
void _start(__size32 param1, __size32 param2, __size32 param3) {
    __size32 eax; 		// r24
    HANDLE eax_2; 		// r24{55}
    __size32 ebp; 		// r29
    __size32 ebx; 		// r27
    __size32 ecx; 		// r25
    __size32 edi; 		// r31
    int edx; 		// r26
    __size32 esi; 		// r30
    int esp; 		// r28
    char *local1; 		// m[esp - 36]
    int local4; 		// m[esp - 32]
    __size32 local5; 		// m[esp - 8]
    __size32 local6; 		// m[esp - 4]

L-1:
L-1:
    eax_2 = GetModuleHandleA();
L-1:
    eax = GetProcAddress(eax_2, "ZwFsControlFile"); /* Warning: also results in ecx, edx */
L-1:
    (*eax)(pc, pc, eax_2, 0x40102a, 0x401020, eax, ebp, 42, eax, ecx, edx, param1, esp - 4, param2, param3, SUBFLAGS32(esp - 32, 40, (esp - 72)), esp - 72 == 0, (unsigned int)(esp - 32) < 40);
L-1:
    *(int*)(ebp - 4) = eax & 0xf;
    local6 = esi;
    local6 = eax & 0xf;
    eax = *24;
L-1:
    eax = *(eax + 48);
    eax = *(eax + 8);
    *(__size32*)(ebp - 8) = eax;
    eax += *(eax + 60);
    *(__size32*)(ebp - 20) = eax;
L-1:
    edx = *(eax + 136);
L-1:
    edx += *(ebp - 8);
    eax = *(edx + 116);
    *(__size32*)(ebp - 12) = eax;
    local6 = ebx;
    ebx = *(esp - 4);
    *(__size32*)(ebp - 16) = edx + 136;
L-1:
    local5 = esp - 4;
    *(__size32*)(esp - 12) = 4;
    eax = *(ebp - 12);
    *(__size32*)(esp - 16) = eax;
L-1:
    eax = *(ebp - 16);
    *(__size32*)(esp - 20) = edx + 136;
    edx = *(esp - 20);
    *(__size32*)(esp - 20) = eax;
L-1:
    *(__size32*)(esp - 24) = edx;
    *(__size32*)(esp - 24) = ebx;
    ebx = *(esp - 24);
    *(__size32*)(esp - 24) = ebx;
    ebx = *(esp - 24);
    edx = VirtualProtect();
L-1:
    eax = *(ebp - 4);
    edi = *(ebp - 16);
L-1:
    *(char*)edi = *edi ^ (unsigned char) eax;
L-1:
    *(void **)(esp - 20) = edi + 1;
    edi = *(esp - 20);
    *(__size32*)(esp - 20) = 64;
    *(__size32*)(esp - 24) = edx;
    edx = *(esp - 24);
    *(__size32*)(esp - 24) = eax;
    *(__size32*)(esp - 24) = 0x3000;
    eax = *(ebp - 16);
    eax += *(eax + 60);
    *(__size32*)(esp - 28) = *(eax + 80);
    local4 = *(eax + 52);
    local1 = edi;
    edi = *(esp - 36);
    local1 = edx;
L-1:
    eax = VirtualAlloc(*(esp - 32), *(esp - 28), *(esp - 24), *(esp - 20)); /* Warning: also results in ecx */
L-1:
    *(__size32*)(ebp - 24) = eax;
    *(__size32*)(esp - 20) = eax;
    eax = *(ebp - 16);
    *(__size32*)(esp - 20) = eax;
    eax = *(esp - 20);
    *(__size32*)(esp - 20) = ecx;
    eax += *(eax + 60);
L-1:
    ecx = *(eax + 84);
    *(__size32*)(esp - 20) = edi;
    edi = *(esp - 20);
    *(__size32*)(esp - 20) = edi;
    edi = *(ebp - 24);
L-1:
    esi = *(ebp - 16);
L-1:
    ecx = proc1(ecx, esi, edi); /* Warning: also results in edi */
L-1:
    edx = *(ebp - 16);
    *(__size32*)(esp - 20) = edi;
    *(__size32*)(esp - 20) = eax;
    edx += *(edx + 60);
    *(__size32*)(esp - 20) = ecx;
    *(__size32*)(esp - 20) = ebx;
    edx += 248;
L-1:
L-1:
    edi = *(ebp - 24);
    edi += *(edx + 12);
    esi = *(ebp - 16);
    esi += *(edx + 20);
L-1:
    ecx = *(edx + 16);
    if (ecx == 0) {
L-1:
        *(__size8 **)(esp - 20) = esi;
        esi = *(esp - 20);
        ebx = *(ebp - 16);
L-1:
        ebx += *(ebx + 60);
        ebx = *(ebx + 40);
        *(__size32*)(esp - 20) = ecx;
        *(__size32*)(esp - 20) = esi;
        ebx += *(ebp - 24);
/* goto ebx*/
    }
L-1:
    proc1(ecx, esi, edi);
L-1:
    edx += 40;
    goto L-1;
}

// address: 0x40125f
__size32 proc1(__size32 param1, __size8 *param2, __size8 *param3) {
    __size8 al; 		// r8

    al = *param2;
    *(__size8*)param3 = al;
    return param1 - 1; /* WARNING: Also returning: edi := param3 + ( (DF == 0) ? 1 : -1) */
}

