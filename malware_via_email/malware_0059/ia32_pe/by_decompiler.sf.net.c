// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0059/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn004016FD()
{
	word32 eax_20 = CreateFileMappingA(0xFFFFFFFF, 0x00000000, 0x00000004, 0x00000000, 0x00004000, 0x00000000);
	if (eax_20 != 0x00000000)
	{
		fp->dwFFFFFFF8 = eax_20;
		GetCurrentProcessId();
		fp->dwFFFFFFF8 = 0x00000000;
		fp->dwFFFFFFF8 = 0x00000000;
		fp->dwFFFFFFF8 = 0x00000000;
		fp->dwFFFFFFF8 = 0x00000006;
		fp->dwFFFFFFF8 = 0x00000000;
		word32 eax_57 = MapViewOfFile(0x00000000, 0x00000004, 0x00000000, 0x00004000, 0x00000000);
		if (eax_57 != 0x00000000)
		{
			fp->dwFFFFFFF8 = eax_57;
			fn0040174D(0x00000000);
			return;
		}
		else
		{
l00401747:
			return;
		}
	}
	else
		goto l00401747;
}

void fn0040174D(word32 dwArg04)
{
	VirtualQuery(dwArg04, fp - 0x00000020, 0x0000001C);
	(fp - 0x00000004)[dwLoc14 >>u 0x0000000C] = (fp - 0x00000004)[dwLoc14 >>u 0x0000000C] + (dwLoc14 >>u 0x0000000C);
	return;
}

