void proc1(__size32 param1, __size32 param2, __size32 param3, __size32 param4, unsigned int param5);

// address: 0x41582b
void _start(__size32 param1) {
    __size32 eax; 		// r24
    void *ebp; 		// r29
    int ecx; 		// r25
    int edx; 		// r26
    int esp; 		// r28
    void *esp_1; 		// r28{35}
    void *esp_10; 		// r28{334}
    union { void * x1; int x2; } esp_11; 		// r28{213}
    void *esp_2; 		// r28{235}
    union { void * x5; int x6; } esp_3; 		// r28{85}
    void *esp_4; 		// r28{134}
    void *esp_5; 		// r28{178}
    void *esp_6; 		// r28{251}
    union { void * x9; int x10; } esp_7; 		// r28{303}
    union { void * x3; int x4; } esp_8; 		// r28{72}
    void *esp_9; 		// r28{364}
    __size32 local0; 		// m[esp - 4]
    __size32 local1; 		// m[esp - 64]
    unsigned int local10; 		// m[esp - 96]
    __size32 local100; 		// local40{444}
    __size32 local101; 		// local45{445}
    __size32 local102; 		// local50{446}
    __size32 local103; 		// local55{447}
    __size32 local104; 		// local60{448}
    unsigned int local105; 		// local65{449}
    union { void * x3; int x4; } local106; 		// esp_8{411}
    __size32 local107; 		// local14{450}
    __size32 local108; 		// local19{451}
    __size32 local109; 		// local24{452}
    __size32 local11; 		// m[esp - 4]{1}
    __size32 local110; 		// local29{453}
    __size32 local111; 		// local34{454}
    __size32 local112; 		// local39{455}
    __size32 local113; 		// local44{456}
    __size32 local114; 		// local49{457}
    __size32 local115; 		// local54{458}
    __size32 local116; 		// local59{459}
    unsigned int local117; 		// local64{460}
    int local12; 		// m[esp - 4]{134}
    int local13; 		// m[esp - 4]{178}
    __size32 local14; 		// m[esp - 4]{450}
    __size32 local15; 		// m[esp - 4]{439}
    __size32 local16; 		// m[esp - 36]{31}
    int local17; 		// m[esp - 36]{134}
    int local18; 		// m[esp - 36]{178}
    __size32 local19; 		// m[esp - 36]{451}
    __size32 local2; 		// m[esp - 68]
    __size32 local20; 		// m[esp - 36]{440}
    __size32 local21; 		// m[esp - 64]{7}
    int local22; 		// m[esp - 64]{134}
    int local23; 		// m[esp - 64]{178}
    __size32 local24; 		// m[esp - 64]{452}
    __size32 local25; 		// m[esp - 64]{441}
    __size32 local26; 		// m[esp - 68]{13}
    int local27; 		// m[esp - 68]{134}
    int local28; 		// m[esp - 68]{178}
    __size32 local29; 		// m[esp - 68]{453}
    __size32 local3; 		// m[esp - 72]
    __size32 local30; 		// m[esp - 68]{442}
    __size32 local31; 		// m[esp - 72]{15}
    int local32; 		// m[esp - 72]{134}
    int local33; 		// m[esp - 72]{178}
    __size32 local34; 		// m[esp - 72]{454}
    __size32 local35; 		// m[esp - 72]{443}
    __size32 local36; 		// m[esp - 76]{17}
    int local37; 		// m[esp - 76]{134}
    int local38; 		// m[esp - 76]{178}
    __size32 local39; 		// m[esp - 76]{455}
    __size32 local4; 		// m[esp - 76]
    __size32 local40; 		// m[esp - 76]{444}
    __size32 local41; 		// m[esp - 80]{19}
    int local42; 		// m[esp - 80]{134}
    int local43; 		// m[esp - 80]{178}
    __size32 local44; 		// m[esp - 80]{456}
    __size32 local45; 		// m[esp - 80]{445}
    __size32 local46; 		// m[esp - 84]{21}
    int local47; 		// m[esp - 84]{134}
    int local48; 		// m[esp - 84]{178}
    __size32 local49; 		// m[esp - 84]{457}
    __size32 local5; 		// m[esp - 80]
    __size32 local50; 		// m[esp - 84]{446}
    __size32 local51; 		// m[esp - 88]{23}
    int local52; 		// m[esp - 88]{134}
    int local53; 		// m[esp - 88]{178}
    __size32 local54; 		// m[esp - 88]{458}
    __size32 local55; 		// m[esp - 88]{447}
    __size32 local56; 		// m[esp - 92]{25}
    int local57; 		// m[esp - 92]{134}
    int local58; 		// m[esp - 92]{178}
    __size32 local59; 		// m[esp - 92]{459}
    __size32 local6; 		// m[esp - 84]
    __size32 local60; 		// m[esp - 92]{448}
    unsigned int local61; 		// m[esp - 96]{33}
    int local62; 		// m[esp - 96]{134}
    int local63; 		// m[esp - 96]{178}
    unsigned int local64; 		// m[esp - 96]{460}
    unsigned int local65; 		// m[esp - 96]{449}
    int local66; 		// %flags{75}
    int local67; 		// %flags{216}
    int local68; 		// %flags{364}
    int local69; 		// %flags{396}
    __size32 local7; 		// m[esp - 88]
    int local70; 		// %ZF{75}
    int local71; 		// %ZF{216}
    int local72; 		// %ZF{364}
    int local73; 		// %ZF{397}
    int local74; 		// %CF{75}
    int local75; 		// %CF{216}
    int local76; 		// %CF{364}
    int local77; 		// %CF{398}
    void *local78; 		// esp_2{384}
    __size32 local79; 		// local11{417}
    __size32 local8; 		// m[esp - 92]
    __size32 local80; 		// local16{418}
    __size32 local81; 		// local21{419}
    __size32 local82; 		// local26{420}
    __size32 local83; 		// local31{421}
    __size32 local84; 		// local36{422}
    __size32 local85; 		// local41{423}
    __size32 local86; 		// local46{424}
    __size32 local87; 		// local51{425}
    __size32 local88; 		// local56{426}
    unsigned int local89; 		// local61{427}
    __size32 local9; 		// m[esp - 36]
    union { void * x1; int x2; } local90; 		// esp_11{393}
    int local91; 		// local69{396}
    int local92; 		// local73{397}
    int local93; 		// local77{398}
    void *local94; 		// esp_10{402}
    __size32 local95; 		// local15{439}
    __size32 local96; 		// local20{440}
    __size32 local97; 		// local25{441}
    __size32 local98; 		// local30{442}
    __size32 local99; 		// local35{443}

    local11 = param1;
    ebp = esp - 4;
    local21 = 0x42f14a;
    GetCommandLineA();
    local79 = local11;
    local81 = local21;
    local26 = 0;
    local31 = 36;
    local36 = 3;
    local41 = 0;
    local46 = 1;
    local51 = 0x40000000;
    local56 = 0x42f132;
    eax = CreateFileW();
    local82 = local26;
    local83 = local31;
    local84 = local36;
    local85 = local41;
    local86 = local46;
    local87 = local51;
    local88 = local56;
    local16 = eax;
    eax = GetModuleHandleA(); /* Warning: also results in esp_1 */
    local78 = esp_1;
    local80 = local16;
    local89 = local61;
    do {
        esp_2 = local78;
        local11 = local79;
        local16 = local80;
        local21 = local81;
        local26 = local82;
        local31 = local83;
        local36 = local84;
        local41 = local85;
        local46 = local86;
        local51 = local87;
        local56 = local88;
        local61 = local89;
        *(__size32*)(ebp - 48) = eax;
        GetCommandLineA();
        local107 = local11;
        local108 = local16;
        local109 = local21;
        local110 = local26;
        local111 = local31;
        local112 = local36;
        local113 = local41;
        local114 = local46;
        local115 = local51;
        local116 = local56;
        local117 = local61;
        *(__size32*)(esp_2 - 4) = 0x42f0f2;
        GetCommandLineA();
        *(__size32*)(esp_2 - 8) = *(ebp - 32);
        GetFileType();
        *(__size32*)(esp_2 - 12) = *(ebp - 48);
        *(__size32*)(esp_2 - 16) = 0;
        *(__size32*)(esp_2 - 20) = 0;
        *(__size32*)(esp_2 - 24) = 3;
        *(__size32*)(esp_2 - 28) = 0;
        *(__size32*)(esp_2 - 32) = 5;
        *(__size32*)(esp_2 - 36) = 0x40000000;
        *(__size32*)(esp_2 - 40) = 0x42f185;
        eax = CreateFileW(); /* Warning: also results in esp_8 */
        local106 = esp_8;
        *(__size32*)(ebp - 40) = eax;
        local66 = SUBFLAGS32(eax, -1, eax + 1);
        local91 = local66;
        local92 = local70;
        local93 = local74;
        if (eax != -1) {
            for(;;) {
                esp_8 = local106;
                local14 = local107;
                local19 = local108;
                local24 = local109;
                local29 = local110;
                local34 = local111;
                local39 = local112;
                local44 = local113;
                local49 = local114;
                local54 = local115;
                local59 = local116;
                local64 = local117;
                *(__size32*)(esp_8 - 4) = 0;
                *(__size32*)(esp_8 - 8) = *(ebp - 56);
                GetFileSize();
                local95 = local14;
                local96 = local19;
                local97 = local24;
                local98 = local29;
                local99 = local34;
                local100 = local39;
                local101 = local44;
                local102 = local49;
                local103 = local54;
                local104 = local59;
                local105 = local64;
                *(__size32*)(ebp - 24) += 0x3ffffffb;
                *(__size32*)(esp_8 - 12) = 0;
                *(__size32*)(esp_8 - 16) = 3;
                *(__size32*)(esp_8 - 20) = 3;
                *(__size32*)(esp_8 - 24) = 0;
                *(__size32*)(esp_8 - 28) = 7;
                *(__size32*)(esp_8 - 32) = 0x60000000;
                *(__size32*)(esp_8 - 36) = 0x42f154;
                eax = CreateFileW(); /* Warning: also results in esp_10 */
                local94 = esp_10;
                *(__size32*)(ebp - 12) = eax;
                if (eax != -1) {
                    do {
L4:
                        esp_10 = local94;
                        local15 = local95;
                        local20 = local96;
                        local25 = local97;
                        local30 = local98;
                        local35 = local99;
                        local40 = local100;
                        local45 = local101;
                        local50 = local102;
                        local55 = local103;
                        local60 = local104;
                        local65 = local105;
                        GetCommandLineA();
                        local107 = local15;
                        local108 = local20;
                        local109 = local25;
                        local110 = local30;
                        local111 = local35;
                        local112 = local40;
                        local113 = local45;
                        local114 = local50;
                        local115 = local55;
                        local116 = local60;
                        local117 = local65;
                        VirtualProtect();
                        *(__size32*)(esp_10 - 4) = *(ebp - 8);
                        *(__size32*)(esp_10 - 8) = 0;
                        *(__size32*)(esp_10 - 12) = 419;
                        *(__size32*)(esp_10 - 16) = 3;
                        *(__size32*)(esp_10 - 20) = 0;
                        *(__size32*)(esp_10 - 24) = 0;
                        *(__size32*)(esp_10 - 28) = 0x40000000;
                        *(__size32*)(esp_10 - 32) = 0x42f171;
                        eax = CreateFileW();
                        *(__size32*)(ebp - 56) = eax;
                        *(__size32*)(esp_10 - 36) = 0x1181e;
                        *(__size32*)(esp_10 - 40) = 0;
                        *(__size32*)(esp_10 - 44) = 39;
                        *(__size32*)(esp_10 - 48) = 3;
                        *(__size32*)(esp_10 - 52) = 0;
                        *(__size32*)(esp_10 - 56) = 1;
                        *(__size32*)(esp_10 - 60) = 0x60000000;
                        *(__size32*)(esp_10 - 64) = 0x42f120;
                        eax = CreateFileA();
                        goto L0;
                    } while (eax != -1);
L9:
                    tmp1 = *(ebp - 24);
                    *(__size32*)(ebp - 24) += 0x415b50;
                    *(__size32*)(esp_8 - 40) = 0;
                    *(__size32*)(esp_8 - 44) = 288;
                    *(__size32*)(esp_8 - 48) = 3;
                    *(__size32*)(esp_8 - 52) = 0;
                    *(__size32*)(esp_8 - 56) = 5;
                    *(__size32*)(esp_8 - 60) = 0x20000000;
                    *(__size32*)(esp_8 - 64) = 0x42f104;
                    eax = CreateFileA(); /* Warning: also results in ecx, edx */
                    *(__size32*)(ebp - 52) = eax;
                    (**(ebp - 24))(local64, local59, local54, local49, local44, local39, local34, local29, local24, local19, local14, eax, ecx, edx, ebp, ADDFLAGS32(tmp1, 0x415b50, *(ebp - 24)), ADDFLAGS32(tmp1, 0x415b50, *(ebp - 24)), ADDFLAGS32(tmp1, 0x415b50, *(ebp - 24)));
                    *(__size32*)(esp_9 - 4) = *(ebp - 12);
                    eax = CloseHandle(*(esp_9 - 4)); /* Warning: also results in ecx, edx */
                    proc1(local10, local8, local7, local6, local5, local4, local3, local2, local1, local9, local0, eax, ecx, edx, ebp, <all>, local68, local72, local76);
                    return;
                }
                goto L9;
L0:
                *(__size32*)(ebp - 36) = eax;
                *(__size32*)(esp_10 - 68) = 0x404000;
                esp_7 = esp_10 - 68;
                eax = *(ebp - 8);
                *(__size32*)(ebp - 24) = eax;
                local106 = esp_7;
            }
        }
        eax = GetProcAddress(*(esp_2 - 40), *(esp_2 - 36));
        *(__size32*)(ebp - 20) = eax;
        *(__size32*)(esp_2 - 36) = 0;
        *(__size32*)(esp_2 - 40) = *(ebp - 32);
        esp_3 = esp_2 - 40;
        local90 = esp_3;
        do {
            esp_11 = local90;
            local69 = local91;
            local73 = local92;
            local77 = local93;
            GetFileSize();
            *(__size32*)(esp_11 - 4) = 0;
            *(__size32*)(esp_11 - 8) = 261;
            *(__size32*)(esp_11 - 12) = 3;
            *(__size32*)(esp_11 - 16) = 0;
            *(__size32*)(esp_11 - 20) = 7;
            *(__size32*)(esp_11 - 24) = 0x80000000;
            *(__size32*)(esp_11 - 28) = 0x42f12d;
            eax = CreateFileA();
            *(__size32*)(ebp - 16) = eax;
            *(__size32*)(esp_11 - 32) = 0;
            *(__size32*)(esp_11 - 36) = 0;
            *(__size32*)(esp_11 - 40) = *(ebp - 40);
            CloseHandle(*(esp_11 - 40));
            *(__size32*)(esp_11 - 40) = 0;
            GetLastError();
            *(__size32*)(esp_11 - 44) = *(ebp - 16);
            eax = GetFileType(); /* Warning: also results in ecx, edx */
            (**(ebp - 20))(local10, local8, local7, local6, local5, local4, local3, local2, local1, local9, local0, eax, ecx, edx, ebp, local69, local73, local77);
            *(__size32*)(ebp - 8) = eax;
            *(__size32*)(esp_4 - 4) = 0;
            *(__size32*)(esp_4 - 8) = *(ebp - 32);
            GetFileSize();
            eax = *(ebp - 8);
            *(__size32*)(ebp - 24) = eax;
            *(__size32*)(esp_4 - 12) = *(ebp - 32);
            CloseHandle(*(esp_4 - 12));
            *(int*)(ebp - 24) = *(ebp - 24) ^ 0xc0000005;
            *(__size32*)(esp_4 - 12) = 0;
            *(__size32*)(esp_4 - 16) = *(ebp - 40);
            GetFileSize();
            GetLastError();
            tmp1 = *(ebp - 24);
            *(__size32*)(ebp - 24) += 0x41599b;
            *(__size32*)(esp_4 - 20) = *(ebp - 32);
            eax = CloseHandle(*(esp_4 - 20)); /* Warning: also results in ecx, edx */
            (**(ebp - 24))(local62, local57, local52, local47, local42, local37, local32, local27, local22, local17, local12, eax, ecx, edx, ebp, <all>, ADDFLAGS32(tmp1, 0x41599b, *(ebp - 24)), ADDFLAGS32(tmp1, 0x41599b, *(ebp - 24)), ADDFLAGS32(tmp1, 0x41599b, *(ebp - 24)));
            local79 = local13;
            local80 = local18;
            local81 = local23;
            local82 = local28;
            local83 = local33;
            local84 = local38;
            local85 = local43;
            local86 = local48;
            local87 = local53;
            local88 = local58;
            local89 = local63;
            local95 = local13;
            local96 = local18;
            local97 = local23;
            local98 = local28;
            local99 = local33;
            local100 = local38;
            local101 = local43;
            local102 = local48;
            local103 = local53;
            local104 = local58;
            local105 = local63;
            *(__size32*)(esp_5 - 4) = *(ebp - 40);
            GetFileType();
            *(union { void * x7; int x8; }*)(esp_5 - 8) = ebp - 4;
            *(__size32*)(esp_5 - 12) = *(ebp - 40);
            CloseHandle(*(esp_5 - 12));
            *(__size32*)(esp_5 - 12) = 64;
            *(__size32*)(esp_5 - 16) = 0;
            *(__size32*)(esp_5 - 20) = 262;
            *(__size32*)(esp_5 - 24) = 3;
            *(__size32*)(esp_5 - 28) = 0;
            *(__size32*)(esp_5 - 32) = 7;
            *(__size32*)(esp_5 - 36) = 0x60000000;
            *(__size32*)(esp_5 - 40) = 0x42f109;
            eax = CreateFileA(); /* Warning: also results in esp_11 */
            local90 = esp_11;
            *(__size32*)(ebp - 28) = eax;
            local67 = SUBFLAGS32(eax, -1, eax + 1);
            local91 = local67;
            local92 = local71;
            local93 = local75;
        } while (eax != -1);
        *(__size32*)(esp_5 - 44) = 0;
        *(__size32*)(esp_5 - 48) = 165;
        *(__size32*)(esp_5 - 52) = 3;
        *(__size32*)(esp_5 - 56) = 0;
        *(__size32*)(esp_5 - 60) = 0;
        *(__size32*)(esp_5 - 64) = 0x20000000;
        *(__size32*)(esp_5 - 68) = 0x42f0e0;
        eax = CreateFileW(); /* Warning: also results in esp_2 */
        local78 = esp_2;
        *(__size32*)(ebp - 44) = eax;
    } while (eax != -1);
    *(__size32*)(esp_5 - 72) = 0x1181e;
    GetLastError();
    *(__size32*)(esp_5 - 76) = 0x404000;
    esp_6 = GetLastError();
    local94 = esp_6;
    goto L4;
}

// address: 0x404028
void proc1(__size32 param1, __size32 param2, __size32 param3, __size32 param4, unsigned int param5) {
    unsigned char bl; 		// r11
    unsigned int ebx; 		// r27
    void *esp; 		// r28

    *(int*)(param4 + 4) = param5 - 1;
    if ((unsigned int)(param5 - 1) > 0) {
    }
    bl = *(param3 + param1 + 0x64d6bfbb);
    ebx = param3 >> 8 & 0xffffff | (bl);
    *(char*)(param1 + ebx * 2 + 0x64d6bf79) = *(param1 + ebx * 2 + 0x64d6bf79) | -26;
    if (SUBFLAGS8((unsigned char) esp, 73, (unsigned char) esp - 73)) {
        *(__size32*)(param1 + 0x64d6bf79) = param2 - 1;
    }
}

