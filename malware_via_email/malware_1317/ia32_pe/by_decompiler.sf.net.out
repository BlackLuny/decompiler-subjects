Using options:
00405A68: warning: Unable to resolve imported reference SHLWAPI.dll!StrSpnA.
l004047C3: error: An error occurred while rewriting at linear address 4047C3.
    The given key was not present in the dictionary.
       at System.Collections.Generic.Dictionary`2.get_Item(TKey key)
   at Decompiler.Analysis.ExpressionPropagator.GetStackDepthBeforeCall()
   at Decompiler.Analysis.ExpressionPropagator.VisitCallInstruction(CallInstruction ci)
   at Decompiler.Core.Code.CallInstruction.Accept[T](InstructionVisitor`1 visitor)
   at Decompiler.Analysis.TrashedRegisterFinder.RewriteBlock(Block block)
fn00404724: error: An error occurred during data flow analysis.
    The given key was not present in the dictionary.
       at System.Collections.Generic.Dictionary`2.get_Item(TKey key)
   at Decompiler.Core.Lib.DominatorGraph`1.BuildDominanceFrontiers(DirectedGraph`1 graph, Dictionary`2 idoms)
   at Decompiler.Core.Lib.DominatorGraph`1..ctor(DirectedGraph`1 graph, T entryNode)
   at Decompiler.Analysis.DataFlowAnalysis.BuildExpressionTrees()
fn00405182: error: An error occurred during data flow analysis.
    The method or operation is not implemented.
       at Decompiler.Core.Operators.GtOperator.ApplyConstants(Constant c1, Constant c2)
   at Decompiler.Evaluation.ExpressionSimplifier.VisitBinaryExpression(BinaryExpression binExp)
   at Decompiler.Core.Expressions.BinaryExpression.Accept[T](ExpressionVisitor`1 v)
   at Decompiler.Analysis.ValuePropagator.VisitBranch(Branch b)
   at Decompiler.Core.Code.Branch.Accept[T](InstructionVisitor`1 visitor)
   at Decompiler.Analysis.ValuePropagator.Transform(Statement stm)
   at Decompiler.Analysis.ValuePropagator.Transform()
   at Decompiler.Analysis.DataFlowAnalysis.BuildExpressionTrees()
fn00405A58: error: An error occurred during data flow analysis.
    The method or operation is not implemented.
       at Decompiler.Core.Operators.GtOperator.ApplyConstants(Constant c1, Constant c2)
   at Decompiler.Evaluation.ExpressionSimplifier.VisitBinaryExpression(BinaryExpression binExp)
   at Decompiler.Core.Expressions.BinaryExpression.Accept[T](ExpressionVisitor`1 v)
   at Decompiler.Analysis.ValuePropagator.VisitBranch(Branch b)
   at Decompiler.Core.Code.Branch.Accept[T](InstructionVisitor`1 visitor)
   at Decompiler.Analysis.ValuePropagator.Transform(Statement stm)
   at Decompiler.Analysis.ValuePropagator.Transform()
   at Decompiler.Analysis.DataFlowAnalysis.BuildExpressionTrees()
: error: Error when reconstructing types.
    Invalid pointer size.
Parameter name: byteSize
       at Decompiler.Core.Types.Pointer..ctor(DataType pointee, Int32 byteSize)
   at Decompiler.Typing.DataTypeBuilder.MemoryAccessCommon(Expression tBase, Expression tStruct, Int32 offset, DataType tField, Int32 structPtrSize)
   at Decompiler.Typing.DataTypeBuilder.MemAccessTrait(Expression tBase, Expression tStruct, Int32 structPtrSize, Expression tField, Int32 offset)
   at Decompiler.Typing.TraitCollector.VisitDereference(Dereference deref)
   at Decompiler.Core.Expressions.Dereference.Accept[T](ExpressionVisitor`1 v)
   at Decompiler.Typing.TraitCollector.VisitStore(Store store)
   at Decompiler.Core.Code.Store.Accept[T](InstructionVisitor`1 visitor)
   at Decompiler.Typing.TraitCollector.CollectProgramTraits(Program prog)
   at Decompiler.Typing.TypeAnalyzer.RewriteProgram(Program prog)
   at Decompiler.DecompilerDriver.ReconstructTypes()
rewriting: void ?aBO_D_h@@YGGI@Z()
rewriting: void ?qv_cxblcr_z_bPXUUW_J_x@@YGXH@Z()
rewriting: void ?err_woz_x_xs_vKZ@@YGJI@Z(Register word32 edx)
rewriting: void ?GAEWL_bvqo@@YGKI@Z()
rewriting: Register word32 fn004039C6(Register word32 esi, Stack word32 dwArg04, Stack byte bArg07, Stack word32 dwArg08, Register out ptr32 edxOut)
fn004039C6: error: An error occurred while rewriting procedure to high-level language.
    Index was out of range. Must be non-negative and less than the size of the collection.
Parameter name: index
       at System.ThrowHelper.ThrowArgumentOutOfRangeException()
   at Decompiler.Structure.CompoundConditionCoalescer.MaybeCoalesce(Block block)
   at Decompiler.Structure.CompoundConditionCoalescer.Transform()
   at Decompiler.Structure.StructureAnalysis.Structure()
   at Decompiler.DecompilerDriver.StructureProgram()
rewriting: Register word32 fn00403BAF(Register word32 ebx, Register word32 esi, Register word32 edi, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C)
rewriting: void fn00403D7A(Register word32 eax)
rewriting: void ?__AR__NMK__EOKZm@@YGHM@Z(Register word32 ecx, Register word32 edi)
rewriting: Register word32 fn00403DDE(Register word32 esi, Register out ptr32 edxOut)
rewriting: void fn00403F25(Register word32 edi)
fn00403F25: error: An error occurred while rewriting procedure to high-level language.
    The given key was not present in the dictionary.
       at System.Collections.Generic.Dictionary`2.get_Item(TKey key)
   at Decompiler.Core.Lib.DominatorGraph`1.BuildDominanceFrontiers(DirectedGraph`1 graph, Dictionary`2 idoms)
   at Decompiler.Core.Lib.DominatorGraph`1..ctor(DirectedGraph`1 graph, T entryNode)
   at Decompiler.Structure.ProcedureStructureBuilder.AnalyzeGraph()
   at Decompiler.Structure.StructureAnalysis.BuildProcedureStructure()
   at Decompiler.Structure.StructureAnalysis.Structure()
   at Decompiler.DecompilerDriver.StructureProgram()
rewriting: Register word32 fn0040408D(Register word32 edi)
rewriting: Register word32 fn00404306(Register word32 edx, Register word32 edi)
fn00404306: error: An error occurred while rewriting procedure to high-level language.
    Expression of type ConstantUInt32 doesn't support Invert.
       at Decompiler.Core.Expressions.Expression.Invert()
   at Decompiler.Structure.IfConditional.EmitIfCondition(Expression exp, Conditional cond, AbsynStatementEmitter emitter)
   at Decompiler.Structure.IfConditional.GenerateCode(AbsynCodeGenerator codeGen, StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(ProcedureStructure proc, List`1 stms)
   at Decompiler.Structure.StructureAnalysis.GenerateStructuredCode()
   at Decompiler.Structure.StructureAnalysis.Structure()
   at Decompiler.DecompilerDriver.StructureProgram()
rewriting: void fn00404724()
rewriting: Register word32 fn00404917(Register word32 ebp, Register word32 esi, Register word32 edi, Stack word32 dwArg00)
fn00404917: error: An error occurred while rewriting procedure to high-level language.
    Unable to cast object of type 'Decompiler.Core.Code.ReturnInstruction' to type 'Decompiler.Core.Code.Branch'.
       at Decompiler.Structure.AbsynCodeGenerator.BranchCondition(StructureNode node)
   at Decompiler.Structure.IfConditional.GenerateCode(AbsynCodeGenerator codeGen, StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(ProcedureStructure proc, List`1 stms)
   at Decompiler.Structure.StructureAnalysis.GenerateStructuredCode()
   at Decompiler.Structure.StructureAnalysis.Structure()
   at Decompiler.DecompilerDriver.StructureProgram()
rewriting: Register word32 fn004049DB(Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi)
rewriting: Register word32 fn00404A85(Register word32 edx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi, Register out ptr32 ecxOut, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
fn00404A85: error: An error occurred while rewriting procedure to high-level language.
    Expression of type ConstantUInt32 doesn't support Invert.
       at Decompiler.Core.Expressions.Expression.Invert()
   at Decompiler.Structure.IfConditional.EmitIfCondition(Expression exp, Conditional cond, AbsynStatementEmitter emitter)
   at Decompiler.Structure.IfConditional.GenerateCode(AbsynCodeGenerator codeGen, StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(ProcedureStructure proc, List`1 stms)
   at Decompiler.Structure.StructureAnalysis.GenerateStructuredCode()
   at Decompiler.Structure.StructureAnalysis.Structure()
   at Decompiler.DecompilerDriver.StructureProgram()
rewriting: void fn00404BCB(Register word32 ebp)
rewriting: Register word32 fn00404F8F(Register word32 edx, Register word32 edi, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C, Stack word32 dwArg10, Register out ptr32 ediOut)
rewriting: void fn00405182(Stack word32 dwArg04, Stack word32 dwArg08)
fn00405182: error: An error occurred while rewriting procedure to high-level language.
    Expression of type ConstantUInt32 doesn't support Invert.
       at Decompiler.Core.Expressions.Expression.Invert()
   at Decompiler.Structure.IfConditional.EmitIfCondition(Expression exp, Conditional cond, AbsynStatementEmitter emitter)
   at Decompiler.Structure.IfConditional.GenerateCode(AbsynCodeGenerator codeGen, StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(StructureNode node, StructureNode latchNode, AbsynStatementEmitter emitter)
   at Decompiler.Structure.AbsynCodeGenerator.GenerateCode(ProcedureStructure proc, List`1 stms)
   at Decompiler.Structure.StructureAnalysis.GenerateStructuredCode()
   at Decompiler.Structure.StructureAnalysis.Structure()
   at Decompiler.DecompilerDriver.StructureProgram()
rewriting: Register word32 fn004056BA(Register word32 eax, Register word32 esi, Register word32 edi, Register out ptr32 ecxOut)
rewriting: void fn00405A58(Register word32 eax, Register word32 ebp)
rewriting: void fn00405CF0(Register word32 ecx, Register word32 ebx, Register word32 ebp, Register word32 esi, Register word32 edi)
rewriting: Register word32 fn00405E99(Register word32 ecx, Register word32 ebx, Register word32 esi, Register word32 edi, Stack word32 dwArg00, Register out ptr32 ebxOut, Register out ptr32 esiOut, Register out ptr32 ediOut)
rewriting: Register word32 fn0040666F(Register out ptr32 ecxOut)
rewriting: void ?WDS_D_Ikxn_ZP_@@YGFKPA_N@Z(Register word32 ebx)
rewriting: void ?PRTptodxbmblwu_kti@@YGPAEE@Z()
rewriting: void ?Tdqkjh_g_hqcqjh__CRHXU@@YGHPADPAM@Z()
rewriting: void ?_df_eLGQD__Yaavzfmm@@YG_NF@Z(Register word32 eax)
malware_via_email/malware_1317/ia32_pe/subject.exe: error: An internal error occurred while decompiling.
    Unable to cast object of type 'Decompiler.Core.Types.StructureType' to type 'Decompiler.Core.Types.EquivalenceClass'.
       at Decompiler.Core.Output.GlobalDataWriter.WriteGlobals(Formatter formatter)
   at Decompiler.DecompilerDriver.WriteGlobals(Program program, TextWriter w)
   at Decompiler.DecompilerDriver.<>c__DisplayClass1b.<WriteDecompilerProducts>b__17(TextWriter w)
   at Decompiler.CmdLine.CmdLineHost.WriteGlobals(Program program, Action`1 writer)
   at Decompiler.DecompilerDriver.WriteDecompilerProducts()
   at Decompiler.DecompilerDriver.StructureProgram()
   at Decompiler.DecompilerDriver.Decompile(String filename)
