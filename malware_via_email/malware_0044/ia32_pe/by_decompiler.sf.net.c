// subject.c
// Generated on 5/4/2015 12:14:40 AM by decompiling malware_via_email/malware_0044/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000(word32 ebx, word32 esi, word32 edi)
{
	word16 ax_16;
	word32 edx_17 = fn00401078(0x0040112A, 0x0000062E, out ax_16);
	fn0040112A(edx_17, ebx, fp - 0x00000004, esi, edi, ax_16);
	word16 ax_39;
	fn00401078(0x0040112A, 0x0000062E, out ax_39);
	if (false)
	{
		Mem52[fp - 0x00000018:word32] = 0x00405000;
		Mem54[fp - 0x0000001C:word32] = 0x00401000;
		lstrcpyA(Mem54[fp - 0x0000001C:LPSTR], Mem54[fp - 24:LPCSTR]);
	}
	return;
}

word32 fn00401078(word32 dwArg04, word32 dwArg08, ptr32 axOut)
{
	word32 dwLoc08_20 = 0x00000000;
	word16 ax_25;
	*axOut = (word16) dwLoc08_20;
	while (dwLoc08_20 < dwArg08)
	{
		if (dwLoc08_20 > 0x00000001)
		{
			edx = dwArg04 + dwLoc08_20;
			Mem134[dwArg04 + dwLoc08_20:byte] = Mem0[edx + 0x00000000:byte] ^ 0xC9;
		}
		if (dwLoc08_20 > 0x00000002)
		{
			edx = dwArg04 + dwLoc08_20;
			Mem121[dwArg04 + dwLoc08_20:byte] = Mem0[edx + 0x00000000:byte] + 0xF1;
		}
		if (dwLoc08_20 > 0x00000002)
		{
			word32 edx_84 = dwLoc08_20 - 0x00000002;
			word64 edx_eax_89 = SEQ(edx_84 >> 0x0000001F, edx_84);
			edx = edx_eax_89 % 0x00000003;
			if (edx_eax_89 % 0x00000003 == 0x00000000)
			{
				Mem109[dwArg04 + dwLoc08_20:byte] = Mem0[dwLoc08_20 + dwArg04:byte] - 0xBA;
				edx = DPB(edx_eax_89 % 0x00000003, 0xBA, 0, 8);
			}
		}
		if ((dwLoc08_20 & 0x00000001) == 0x00000000)
		{
			Mem82[dwArg04 + dwLoc08_20:byte] = Mem0[dwLoc08_20 + dwArg04:byte] - (byte) dwLoc08_20;
			edx = dwLoc08_20;
		}
		dwLoc08_20 = dwLoc08_20 + 0x00000001;
		*axOut = (word16) dwLoc08_20;
	}
	return edx;
}

void fn0040112A(word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, word16 ax)
{
	Mem5[esi + 0x00000000:word32] = ebp;
	byte cl_8 = (byte) ebp;
	byte dh_15 = __rol(dh, cl_8);
	byte v14_23 = Mem5[ebx + 0x0000005F:byte] - bl - ((dh & 0x01 << 0x08 - cl_8) != 0x00);
	Mem24[ebx + 0x0000005F:byte] = v14_23;
	word32 eax_11 = (int32) ax;
	Mem37[DPB(edx, dh_15, 8, 8) + 0x0000005D:byte] = 0xC4;
	byte al_27 = (byte) eax_11 - 0xD5 - (v14_23 <u 0x00);
	__outw(DPB(dx, dh_15, 8, 8), (word16) (DPB(eax_11, al_27, 0, 8) + 0xE804EB31 + (al_27 <u 0x00)));
	Mem42[ebp + 0x00000000:word32] = 0xD4873E41;
	Mem44[ebx + 0x00000046:word32] = 0xC73A3377;
	__hlt();
}

