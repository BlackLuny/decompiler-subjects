/*	This file was automatically created by
 *	Reverse Engineering Compiler 1.6 (C) Giampiero Caprino (Mar 31 2002)
 *	Input file: './malware_via_email/malware_0627/ia32_pe/subject.exe'
 */

/* DEST BLOCK NOT FOUND: 00412017 -> 0041201e */
/*	Procedure: 0x00412000 - 0x0041201E
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

__entry_point__()
{



    ebx = 4194768;
    edi = 4198400;
    esi = 0x411c2c;
    L0041201F(ebx);
    if(!(dl = dl + dl)) {
        dl = *esi;
        esi = esi + 1;
        asm("adc dl,dl");
    }
}

/* DEST BLOCK NOT FOUND: 0041205d -> 004120a0 */
/*	Procedure: 0x0041201F - 0x0041208F
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L0041201F()
{



    asm("cld");
    dl = 128;
L00412022:
    *edi = *esi;
    edi = edi + 1;
    ebx = 2;
L00412026:
    *esp();
    if(esi = esi + 1) {
        goto L00412022;
    }
    ecx = 0;
    *esp();
    >= ? L0041204a : ;
    eax = 0;
    eax = *esp();
    >= ? L0041205a : ;
    bl = 2;
    al = 16;
L0041203e:
    eax = *esp();
    asm("adc al,al");
    if(ecx = ecx + 1) {
        goto L0041203e;
    }
    != ? 0x412086 : ;
    *edi = al;
    edi = edi + 1;
    goto L00412026;
    eax = L00412092();
    if(!(ecx = ecx - ebx)) {
        L00412090();
        goto L00412082;
        al = *esi;
        eax = eax >> 1;
        if(esi = esi + 1) {
            goto L004120a0;
        }
        asm("adc ecx,ecx");
    } else {
        asm("xchg eax,ecx");
        eax = eax - 1 << 8;
        al = *esi;
        esi = esi + 1;
        eax = L00412090();
        if(eax < 32000) {
            if(ah >= 5) {
                goto L00412080;
            }
            if(eax > 127) {
                goto L00412081;
            }
        }
    }
    ecx = ecx + 1;
L00412080:
    ecx = ecx + 1;
L00412081:
    asm("xchg eax,ebp");
L00412082:
    eax = ebp;
    bl = 1;
    (save)esi;
    esi = edi - eax;
    asm("rep movsb");
    (restore)esi;
    goto L00412026;
}

/*	Procedure: 0x00412090 - 0x00412091
 *	Argument size: 0
 *	Local size: 0
 *	Save regs size: 0
 */

L00412090()
{



    ecx = 0;
}

/* DEST BLOCK NOT FOUND: 004120b9 -> 0041200f */
/* DEST BLOCK NOT FOUND: 004120e1 -> 00401189 */
/*	Procedure: 0x00412092 - 0x004120F3
 *	Argument size: -580
 *	Local size: 0
 *	Save regs size: 0
 */

L00412092(A4)
/* unknown */ void  A4;
{



L00412093:
    A4();
    asm("adc ecx,ecx");
    eax = A4();
    if(ecx = ecx + 1) {
        goto L00412093;
    }
    return;
    (restore)edi;
    (restore)ebx;
    if(!(edi = ( *ebx & 65535) - 1)) {
        if(edi = edi - 1) {
            goto L004120be;
        }
        edi = edi << 12;
    } else {
        edi = *(ebx + 2);
        (save)edi;
        ebx = ebx + 4;
    }
    ebx = ebx + 1 + 1;
    goto L0041200f;
L004120be:
    (restore)edi;
    ebx = __imp__LoadLibraryA;
L004120c4:
    esi = *edi;
    asm("scasd");
    (save)edi;
    *ebx();
    asm("xchg eax,ebp");
L004120cc:
    eax = 0;
L004120ce:
    asm("scasb");
    if(edi = edi + 1) {
        goto L004120ce;
    }
    if(*edi = *edi - 1) {
        goto L004120c4;
    }
    if(!( *edi = *edi - 1)) {
        edi = edi + 1;
        (save) *edi;
        asm("scasd");
    } else {
        if(*edi = *edi - 1) {
            goto L00401189;
        }
        (save)edi;
    }
    eax = *(ebx + 4)(ebp);
    asm("lodsd");
    if(*esi = *esi | eax) {
        goto L004120cc;
    }
    ebp = esp;
}

/* address  size  */
/* 0x00412000       0 */ /* unknown */ void 	__entry_point__;
/* 0x00412128       0 */ /* unknown */ void 	__imp__LoadLibraryA;
/* 0x0041212c       0 */ /* unknown */ void 	__imp__GetProcAddress;
#if 0 /* auxiliary information */
# Current option values:
option: +asmflush
option: -compactcalls
option: +compactexprs
option: +compactifs
option: +compset
option: -dfoproc
option: -disasmonly
option: -displaylabels
option: +doblocks
option: +docase
option: +dofor
option: +doifs
option: +dointrinsics
option: +doloops
option: +donullgotos
option: +dopackloops
option: +dopackstmt
option: +doremlabs
option: +dosimplify
option: -dosort
option: +dostmts
option: +doswitch
option: +dowhile
option: -dumpaddrs
option: -dumpcall
option: -dumpcomments
option: -dumpdfo
option: +dumpdoms
option: -dumpsblocks
option: -dumpsets
option: -dumpsizes
option: -dumpstmtid
option: +fatcase
option: -flag16
option: +fullscreen
option: -genpattern
option: -help
option: -hexconst
option: -html
option: +insertlabels
option: -int16
option: +int32
option: -interactive
option: -isvb5
option: +locals
option: -nohtmltabs
option: -nostackoffs
option: -objdump
option: -okclone
option: -outprocs
option: -outrefs
option: -overrule
option: +rdonly
option: -showblocks
option: -showjump
option: -showlabel
option: -showprotosym
option: -showreg
option: -showstring
option: -silent
option: +simplifyexprs
option: -stackalign16
option: -stackalign4
option: -stackalign8
option: -strallregions
option: -traceall
option: -tracesets
option: +types
option: -usesymtab
option: -validatebr
option: -validatereg
option: +validatestr
#endif
