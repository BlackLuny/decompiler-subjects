// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 esi_1058 = AddAce(null, 0x00, 0x00, null, 0x00) + 0x23 + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00) + AddAce(0x00, 0x00, 0x00, 0x00, 0x00);
	Eq_3 ebp_1099 = null;
	if (AreAnyAccessesGranted(~0x00, ~0x00) == 0x00)
		esi_1058 = esi_1058 - 0x22;
	CloseHandle((void *) 0x59);
	VirtualProtect(&globals->v401000, 0x3000, 0x40, fp - 0x08);
	struct Eq_680 * edx_1089 = null;
	do
	{
		if (ebp_1099 == esi_1058)
			ebp_1099 = null;
		edx_1089[0x00401480] = (struct Eq_680) (edx_1089[0x00401480] ^ ebp_1099[0x00404000]);
		edx_1089 = edx_1089 + 0x01;
		ebp_1099 = (Eq_3) (ebp_1099 + 0x01);
	} while (edx_1089 < (struct Eq_680 *) 5152);
	struct Eq_702 * esi_1117 = &globals->t402760;
	uint32 edi_1121 = 0x00;
	uint32 dwLoc04_1125 = 0x00;
	do
	{
		Eq_708 eax_1134 = esi_1117->t0004 - 0x08 >> 0x01;
		word16 * ecx_1137 = (char *) &esi_1117->t0004 + 0x04;
		if (eax_1134 > 0x00)
		{
			Eq_708 ebx_1287 = eax_1134;
			do
			{
				ui32 eax_1291 = (word32) *ecx_1137;
				if ((eax_1291 & 0xF000) == 0x3000)
				{
					struct Eq_738 * eax_1304 = (eax_1291 & 0x0FFF) + esi_1117->dw0000;
					eax_1304->dw401200 = eax_1304->dw401200 + 0xF0401200;
				}
				ecx_1137 = ecx_1137 + 0x01;
				ebx_1287 = ebx_1287 - 0x01;
			} while (ebx_1287 != 0x00);
			edi_1121 = dwLoc04_1125;
		}
		edi_1121 = (word32) esi_1117->t0004 + edi_1121;
		dwLoc04_1125 = edi_1121;
		esi_1117 = esi_1117 + Mem1110[esi_1117 + 0x04:word32];
	} while (edi_1121 < 228);
	struct Eq_753 * esi_1153 = &globals->t401F5C;
	struct Eq_753 * dwLoc04_1154 = &globals->t401F5C;
	esi_1182 = esi_1153;
	if (globals->dw401F6C != 0x00)
	{
		do
		{
			struct Eq_753 * esi_1182;
			Eq_791 eax_1188 = LoadLibraryA(esi_1182->dw000C + 0x00401200);
			if (eax_1188 != null)
			{
				struct Eq_810 * edi_1211 = esi_1182->dw0000;
				if (edi_1211 == null)
					edi_1211 = esi_1182->dw0010;
				Eq_816 eax_1217 = edi_1211->t401200;
				union Eq_820 * edi_1218 = &edi_1211->t401200;
				word32 * esi_1219 = esi_1182->dw0010 + 0x00401200;
				bool S_1222 = cond(eax_1217);
				if (eax_1217 != 0x00)
				{
					do
					{
						Eq_844 eax_1257;
						if (!S_1222)
							eax_1257 = GetProcAddress(eax_1188, (word32) *edi_1218);
						else
							eax_1257 = GetProcAddress(eax_1188, (word32) eax_1217 + 0x00401202);
						*esi_1219 = (word32) eax_1257;
						edi_1218 = (union Eq_820 *) ((char *) edi_1218 + 0x04);
						eax_1217 = *edi_1218;
						esi_1219 = esi_1219 + 0x01;
						S_1222 = cond(eax_1217);
					} while (eax_1217 != 0x00);
				}
				esi_1182 = dwLoc04_1154;
			}
			esi_1182 = esi_1182 + 0x01;
			dwLoc04_1154 = esi_1182;
		} while (esi_1182->dw0010 != 0x00);
	}
	ptr32 esp_1160;
	byte SCZO_1161;
	word32 ebx_1162;
	word32 ebp_1163;
	word32 esi_1164;
	word32 edi_1165;
	byte SZO_1166;
	byte C_1167;
	word32 eax_1168;
	word32 ecx_1169;
	byte Z_1170;
	word32 edx_1171;
	byte cl_1172;
	byte S_1173;
	globals->t401C50();
	*(esp_1160 - 0x04) = 0x00;
	ExitProcess(*(esp_1160 - 0x04));
}

