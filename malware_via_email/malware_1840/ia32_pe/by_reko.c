// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401128: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
Win32CrtStartup_entry:
	call 0x0040102D (retsize: 4; depth: 4)
		uses: C_7,dh_5,dx_4,edx_3,esp_1,SZO_6
		defs: ah_25,al_18,ax_16,bh_26,C_11,ch_28,cl_22,cx_29,dh_27,di_21,dx_23,eax_17,ebp_20,ebx_15,ecx_12,edi_14,edx_9,esi_19,esp_8,fs_31,SCZO_13,si_30,SZO_10,Z_24
	Mem38[esp_8 - 0x04 + 0x00:word32] = ebx_15
	eax_39 = Mem38[esp_8 - 0x04 + 0x00:word32]
	al_40 = (byte) eax_39 (alias)
	Mem44[eax_39 + 0x00:byte] = Mem38[eax_39 + 0x00:byte] + al_40
	Mem46[eax_39 + 0x00:byte] = Mem44[eax_39 + 0x00:byte] + al_40
	Mem48[eax_39 + 0x00:byte] = Mem46[eax_39 + 0x00:byte] + al_40
	Mem50[eax_39 + 0x00:byte] = Mem48[eax_39 + 0x00:byte] + al_40
	Mem52[eax_39 + 0x00:byte] = Mem50[eax_39 + 0x00:byte] + al_40
	Mem54[eax_39 + 0x00:byte] = Mem52[eax_39 + 0x00:byte] + al_40
	Mem56[eax_39 + 0x00:byte] = Mem54[eax_39 + 0x00:byte] + al_40
	Mem58[eax_39 + 0x00:byte] = Mem56[eax_39 + 0x00:byte] + al_40
	Mem60[eax_39 + 0x00:byte] = Mem58[eax_39 + 0x00:byte] + al_40
	Mem62[eax_39 + 0x00:byte] = Mem60[eax_39 + 0x00:byte] + al_40
	Mem64[eax_39 + 0x00:byte] = Mem62[eax_39 + 0x00:byte] + al_40
	Mem66[eax_39 + 0x00:byte] = Mem64[eax_39 + 0x00:byte] + al_40
	Mem68[eax_39 + 0x00:byte] = Mem66[eax_39 + 0x00:byte] + al_40
	Mem70[eax_39 + 0x00:byte] = Mem68[eax_39 + 0x00:byte] + al_40
	Mem72[eax_39 + 0x00:byte] = Mem70[eax_39 + 0x00:byte] + al_40
	Mem74[eax_39 + 0x00:byte] = Mem72[eax_39 + 0x00:byte] + al_40
	ecx_88 = (word32) Mem74[ebp_20 + 0x07:byte] (alias)
	__ror((word16) ((edx_9 | 52820389) >> 0x09 | 0x3044764D), 0x0F)
	di_35 = (word16) ebx_15 (alias)
	esp_41 = esp_8
	edi_86 = DPB(ebx_15, di_35 - ~0x28, 0) (alias)
	branch ecx_88 == 0x90 l004011E7
	goto l004011BF
l00401128:
l00401161:
l004011BF:
	Mem244[esp_8 - 0x04 + 0x00:word32] = 3963125073
	Mem246[esp_8 - 0x08 + 0x00:word32] = 0x90
	eax_247 = CopyFileExA(Mem246[esp_8 - 0x08 + 0x00:LPCSTR], Mem246[esp_8 - 0x04 + 0x00:LPCSTR], Mem246[esp_8 + 0x00:LPPROGRESS_ROUTINE], Mem246[esp_8 + 0x04:LPVOID], Mem246[esp_8 + 0x08:LPBOOL], Mem246[esp_8 + 0x0C:DWORD])
	eax_258 = DPB(eax_247, bh_26, 8) (alias)
	Mem261[eax_258 + 0x006C00E0:byte] = Mem246[eax_258 + 0x006C00E0:byte] + bh_26
	Mem263[eax_258 + 0x00:byte] = Mem261[eax_258 + 0x00:byte] + (byte) eax_247
	Mem265[0x66008500:word32] = Mem263[0x66008500:word32] ^ edi_86
	esp_249 = esp_8 + 0x10
	goto l004011EB
l004011E8:
l004011EB:
	esp_100 = PHI(esp_41, esp_249)
	dx_102 = (word16) esp_100 (alias)
	ecx_110 = Mem74[DPB(1194964, dx_102, 0) + 0x00:word32]
	__ror(dx_102, 0x06)
	__ror(DPB(ebx_15, di_35 - ~0x28 | ~0x5C, 0) + 1194964, 0x02)
	eax_117 = 0x004010DB
	esi_123 = Mem74[0x0040111D:word32]
l00401212:
	eax_128 = PHI(eax_117, eax_137)
	ecx_129 = PHI(ecx_110, ecx_130)
	ecx_130 = ecx_129 + 0x01
	edx_135 = Mem74[ecx_130 + 0x00:word32]
	eax_137 = __rol(-eax_128, 0x1E)
	branch edx_135 - esi_123 != 0x00 l00401212
l00401220:
	ecx_156 = DPB(ecx_130, Mem74[ecx_130 - 0x03 + 0x00:word16], 0) (alias)
	__ror((word16) (esi_123 * 0x02), 0x02)
	esi_165 = Mem74[esp_100 + 0x00:word32]
	edi_171 = Mem74[4198494:word32]
l00401250:
	esi_175 = PHI(esi_165, esi_181)
	ecx_177 = PHI(ecx_156, ecx_187)
	eax_178 = Mem74[esi_175 + 0x00:word32]
	__ror(ecx_177, 0x11)
	esi_181 = esi_175 - ~0x00
	ecx_187 = eax_178 ^ edi_171
	branch ecx_187 != 0x00 l00401250
l00401269:
	esp_215 = esp_100 - 0x04
	Mem216[esp_215 + 0x00:word32] = (ecx_156 << 0x10 >>u 0x10) + 4177108
	Mem222[esp_215 - 0x04 + 0x00:word32] = Mem216[fs_31:0x00:word32]
	Mem227[fs_31:0x00:word32] = esp_215 - 0x04
	Mem230[esp_215 - 0x08 + 0x00:word32] = 0x00
	__rol((word16) (esp_215 - 0x04), 0x0E)
	Mem239[esp_215 - 0x0C + 0x00:word32] = esi_181
	__ror(0x00, 0x12)
	eax_202 = eax_178 - 382895693 << 0x1E
	return DPB(eax_202 + 0x01, (word16) (eax_202 + 0x01) - 0x2A, 0) + 0x01
Win32CrtStartup_exit:
}

