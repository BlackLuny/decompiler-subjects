//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2017 Retargetable Decompiler <info@retdec.com>
//

#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

// ------------------------ Structures ------------------------

struct _IO_FILE {
    int32_t e0;
};

// ------------------- Function Prototypes --------------------

int32_t chomp(char * str2, int32_t size, struct _IO_FILE * stream);

// ------------------------ Functions -------------------------

// Address range: 0x8048454 - 0x80484a2
int32_t chomp(char * str2, int32_t size, struct _IO_FILE * stream) {
    char * str = fgets(str2, size, stream); // 0x804846e
    int32_t result = (int32_t)str; // 0x804846e_6
    if (str == NULL) {
        // 0x804849e
        return result;
    }
    char * found_char_pos = strchr(str, 10); // 0x804848a
    if (found_char_pos != NULL) {
        // 0x8048498
        *found_char_pos = 0;
        // branch -> 0x804849e
    }
    // 0x804849e
    return result;
}

// Address range: 0x80484a3 - 0x804853f
int main(int argc, char ** argv) {
    if (argc <= 1) {
        // 0x8048537
        return 1;
    }
    struct _IO_FILE * file = fopen((char *)*(int32_t *)((int32_t)argv + 4), "r"); // 0x80484db
    int32_t result;
    if (file != NULL) {
        // 0x80484f5
        int32_t v1;
        if (chomp((char *)&v1, 1024, file) != 0) {
            // 0x8048516
            printf("%s\n", &v1);
            // branch -> 0x804852c
        }
        // 0x804852c
        fclose(file);
        // branch -> 0x8048537
    } else {
        result = 1;
    }
    // 0x8048537
    return result;
}

// --------------- Dynamically Linked Functions ---------------

// int fclose(FILE * stream);
// char * fgets(char * restrict s, int n, FILE * restrict stream);
// FILE * fopen(const char * restrict filename, const char * restrict modes);
// int printf(const char * restrict format, ...);
// char * strchr(char * s, int c);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: gcc (3.3.4)
// Detected language: C
// Detected functions: 2
// Decompiler release: VERSION
// Decompilation date: DATE
