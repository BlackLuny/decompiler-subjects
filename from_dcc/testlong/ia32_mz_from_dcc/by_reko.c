// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0800:01FA: void main(Register ui16 bx, Register word16 di, Register (ptr Eq_5) ds)
void main(ui16 bx, word16 di, Eq_5 * ds)
{
	word16 di_17;
	ui16 bx_18 = fn0800_1655(bx, di, ds, 404, out di_17);
	word16 di_29;
	ui16 bx_30 = fn0800_1655(bx_18, di_17, ds, 0x0197, out di_29);
	word16 di_44;
	fn0800_1655(bx_30, di_29, ds, 0x019A, out di_44);
	fn0800_0DCC(ds, 0x01A0);
	return;
}

// 0800:0DCC: void fn0800_0DCC(Register (ptr Eq_5) ds, Stack word16 wArg02)
void fn0800_0DCC(Eq_5 * ds, word16 wArg02)
{
	fn0800_0FF4(ds, fp + 0x04, wArg02);
	return;
}

// 0800:0FF4: void fn0800_0FF4(Register (ptr Eq_5) ds, Stack mp16 wArg02, Stack word16 wArg04)
void fn0800_0FF4(Eq_5 * ds, mp16 wArg02, word16 wArg04)
{
	ci8 bLoc57_100 = 0x50;
	byte Eq_5::* di_102 = fp - 0x56;
	byte Eq_5::* si_106 = wArg04;
l0800_105E:
	byte al_36 = ds->*si_106;
	si_106 = si_106 + 0x01;
	byte al_104 = al_36;
	ax = DPB(ax, al_36, 0);
	if (al_36 == 0x00)
	{
		if (bLoc57_100 < 0x50)
			fn0800_1022(fp - 0x02, fn0800_1022(fp - 0x02, di_102));
		return;
	}
	if (al_36 != 0x25)
	{
l0800_1067:
		ds->*di_102 = al_104;
		ci8 v15_99 = bLoc57_100 - 0x01;
		di_102 = di_102 + 0x01;
		bLoc57_100 = v15_99;
		if (v15_99 <= 0x00)
			di_102 = fn0800_1022(fp - 0x02, di_102);
		goto l0800_105E;
	}
	al_104 = ds->*si_106;
	ax = DPB(ax, al_104, 0);
	si_106 = si_106 + 0x01;
	if (al_104 == 0x25)
		goto l0800_1067;
	cu8 ch_112 = 0x00;
	byte bLoc8F_117 = 0x00;
l0800_10A1:
	word16 ax_137 = DPB(ax, 0x00, 8);
	cu8 bl_141 = (byte) ax_137;
	byte dl_139 = (byte) ax_137;
	struct Eq_115 Eq_5::* bx_143 = DPB(ax_137, bl_141 - 0x20, 0);
	if (bl_141 < 0x80)
	{
		cu16 bx_181 = DPB(ax_137, (ds->*bx_143).b04C9, 0);
		cu16 ax_182 = bx_181;
		if (bx_181 > 0x17)
		{
l0800_14E1:
			byte Eq_5::* si_155 = si_106;
			byte al_157 = 0x25;
			do
			{
				di_102 = fn0800_101A(al_157, fp - 0x02, di_102, ds);
				byte al_166 = ds->*si_155;
				si_155 = si_155 + 0x01;
				al_157 = al_166;
			} while (al_166 != 0x00);
			break;
		}
		switch (fp - 0xA0)
		{
		case 0x00:
			if (ch_112 <= 0x00)
				goto l0800_1116;
			break;
		case 0x01:
			if (ch_112 <= 0x00)
				goto l0800_10A0;
			break;
		case 0x02:
			ax_182 = ds->*wArg02;
			wArg02 = wArg02 + 0x01;
			if (ch_112 < 0x02)
				goto l0800_1160;
			goto l0800_1169;
		case 0x03:
			if (ch_112 <= 0x00)
				goto l0800_10A0;
			break;
		}
	}
	goto l0800_14E1;
}

// 0800:101A: Register (memptr (ptr Eq_5) byte) fn0800_101A(Register byte al, Register (memptr (ptr Eq_181) Eq_86) bp, Register (memptr (ptr Eq_5) byte) di, Register (ptr Eq_5) ds)
byte Eq_5::*fn0800_101A(byte al, Eq_86 Eq_181::*bp, byte Eq_5::*di, Eq_5 * ds)
{
	ds->*di = al;
	ci8 v9_9 = ss->*(bp - 0x55) - 0x01;
	ss->*(bp - 0x55) = v9_9;
	if (v9_9 <= 0x00)
		return di + 0x01;
	else
	{
		byte Eq_5::* di_13 = fn0800_1022(bp, di + 0x01);
		return di_13;
	}
}

// 0800:1022: Register (memptr (ptr Eq_5) byte) fn0800_1022(Register (memptr (ptr Eq_181) Eq_86) bp, Register (memptr (ptr Eq_5) byte) di)
byte Eq_5::*fn0800_1022(Eq_86 Eq_181::*bp, byte Eq_5::*di)
{
	word16 sp_30;
	word16 bx_31;
	struct Eq_5 * ss_32;
	word16 cx_33;
	word16 dx_34;
	struct Eq_209 * es_35;
	union Eq_226 Eq_5::* bp_36;
	word16 ax_37;
	word16 di_38;
	byte SCZO_39;
	struct Eq_214 * cs_40;
	byte SZO_41;
	byte C_42;
	byte Z_43;
	(cs->*(ss->*bp).ptr000A)();
	if (ax_37 == 0x00)
		(ss_32->*(bp_36 - 0x02)).u1 = 0x01;
	(ss_32->*(bp_36 - 0x55)).u0 = 0x50;
	(ss_32->*(bp_36 - 88)).u1 = (word16) (ss_32->*(bp_36 - 88)).u1 + di_38;
	return bp_36 - 0x54;
}

// 0800:1655: Register ui16 fn0800_1655(Register ui16 bx, Register word16 di, Register (ptr Eq_5) ds, Stack word16 wArg02, Register out ptr16 diOut)
ui16 fn0800_1655(ui16 bx, word16 di, Eq_5 * ds, word16 wArg02, ptr16 & diOut)
{
	*diOut = di;
	ui16 bx_25 = fn0800_1674(bx, di, ds, 0x0312, wArg02);
	return bx_25;
}

// 0800:1674: Register ui16 fn0800_1674(Register ui16 bx, Register word16 di, Register (ptr Eq_5) ds, Stack word16 wArg06, Stack word16 wArg08)
ui16 fn0800_1674(ui16 bx, word16 di, Eq_5 * ds, word16 wArg06, word16 wArg08)
{
	struct Eq_263 Eq_287::* bp_153 = fp - 0x02;
	mp16 sp_101 = fp - 0x32;
	byte Eq_5::* si_156 = wArg08;
l0800_16A7:
	byte al_53 = ds->*si_156;
	byte Eq_5::* si_54 = si_156 + 0x01;
	if (al_53 == 0x00)
		return bx;
	if (al_53 != 0x25)
	{
		union Eq_286 Eq_287::* sp_148 = sp_101 - 0x02;
		ss->*sp_148 = wArg06;
		union Eq_286 Eq_287::* sp_152;
		byte SCZO_155;
		Eq_286 di_157;
		struct Eq_294 * es_158;
		byte D_159;
		byte al_160;
		byte SZO_162;
		byte C_163;
		byte Z_164;
		Eq_286 ax_165;
		word16 cx_167;
		byte SO_168;
		byte S_169;
		byte bl_171;
		byte bh_172;
		byte CZ_173;
		(cs->*bp_153[0x02])();
		sp_101 = (char *) sp_152 + 0x02;
		Eq_286 ax_176 = ax_165;
		if (ax_165 >= 0x00)
		{
			if (di_157 < 0x00 || ds->*((word16) di_157 + 1322) != 0x01)
			{
				if (ax_165 == di_157)
					goto l0800_16A7;
				ss->*sp_152 = wArg06;
				ss->*(sp_152 - 0x02) = ax_165;
				word16 sp_215;
				word16 bp_216;
				struct Eq_455 * ss_217;
				byte SCZO_218;
				word16 si_219;
				word16 di_220;
				struct Eq_459 * es_221;
				byte D_222;
				byte al_223;
				struct Eq_462 * ds_224;
				byte SZO_225;
				byte C_226;
				byte Z_227;
				word16 ax_228;
				struct Eq_467 * cs_229;
				word16 cx_230;
				byte SO_231;
				byte S_232;
				byte bl_234;
				byte bh_235;
				byte CZ_236;
				(cs->*bp_153[0x03])();
				return bx;
			}
			do
			{
				ci8 bl_267 = (byte) ax_176;
				Eq_286 bx_270 = DPB(ax_176, bl_267, 0);
				if (bl_267 < 0x00 || ds->*((word16) bx_270 + 1322) != 0x01)
				{
					union Eq_286 Eq_287::* sp_275 = sp_101 - 0x02;
					ss->*sp_275 = wArg06;
					ss->*(sp_275 - 0x02) = bx_270;
					word16 sp_279;
					byte SCZO_282;
					word16 di_284;
					struct Eq_345 * es_285;
					byte D_286;
					byte al_287;
					byte SZO_289;
					byte C_290;
					byte Z_291;
					word16 ax_292;
					word16 cx_294;
					byte SO_295;
					byte S_296;
					byte bl_298;
					byte bh_299;
					byte CZ_300;
					(cs->*bp_153[0x03])();
					sp_101 = sp_279 + 0x04;
					goto l0800_16A7;
				}
				union Eq_286 Eq_287::* sp_314 = sp_101 - 0x02;
				ss->*sp_314 = wArg06;
				word16 sp_316;
				byte SCZO_319;
				word16 si_320;
				word16 di_321;
				struct Eq_379 * es_322;
				byte D_323;
				byte al_324;
				byte SZO_326;
				byte C_327;
				byte Z_328;
				Eq_286 ax_329;
				word16 cx_331;
				byte SO_332;
				byte S_333;
				word16 bx_334;
				byte bl_335;
				byte bh_336;
				byte CZ_337;
				(cs->*bp_153[0x02])();
				sp_101 = sp_316 + 0x02;
				ax_176 = ax_329;
			} while (ax_329 > 0x00);
		}
	}
	else
	{
		int16 ax_348 = (int16) (ds->*si_54);
		if (ax_348 < 0x00)
			goto l0800_1767;
		cu16 bx_366 = DPB(bx, 0x00, 8);
		if (bx_366 <= 0x15)
		{
			bx = bx_366 << 0x01;
			switch (ax_348)
			{
			case 0x00:
				break;
			}
			return bx;
		}
	}
	union Eq_286 Eq_287::* sp_104 = sp_101 - 0x02;
	ss->*sp_104 = wArg06;
	(ss->*(sp_104 - 0x02)).u0 = ~0x00;
	word16 sp_109;
	word16 bp_110;
	struct Eq_415 * ss_111;
	byte SCZO_112;
	word16 si_113;
	word16 di_114;
	struct Eq_419 * es_115;
	byte D_116;
	byte al_117;
	struct Eq_422 * ds_118;
	byte SZO_119;
	byte C_120;
	byte Z_121;
	word16 ax_122;
	struct Eq_427 * cs_123;
	word16 cx_124;
	byte SO_125;
	byte S_126;
	byte bl_128;
	byte bh_129;
	byte CZ_130;
	(cs->*bp_153[0x03])();
	return bx;
}

