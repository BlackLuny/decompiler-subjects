// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0800:0121: void fn0800_0121()
void fn0800_0121()
{
	struct Eq_3 * ds_3 = 0x0800->ptr01F8;
	fn0800_01A5(ds_3);
	struct Eq_11 Eq_26::* sp_6;
	struct Eq_12 * ds_7;
	struct Eq_13 * cs_8;
	word16 ax_9;
	byte SZO_10;
	byte C_11;
	word16 si_12;
	word16 cx_13;
	byte D_14;
	byte al_15;
	byte SCZO_16;
	byte ah_17;
	byte Z_18;
	word16 dx_19;
	word16 bp_20;
	struct Eq_26 * ss_21;
	(cs->*ds_3->ptr05DE)();
	word16 ax_22 = 0x00;
	cu8 al_23 = 0x00;
	byte ah_24 = 0x00;
	byte Eq_12::* si_28 = Eq_12::a0000;
	word16 cx_29 = 0x2F;
	do
	{
		al_23 = al_23 + ds_7->*si_28;
		ah_24 = ah_24 + (al_23 < 0x00);
		ax_22 = DPB(ax_22, ah_24, 8);
		si_28 = si_28 + 0x01;
		cx_29 = cx_29 - 0x01;
	} while (cx_29 != 0x00);
	byte al_47 = (byte) (ax_22 - 3383);
	if (ax_22 != 3383)
		fn0800_01DA(al_47, 0x19, 0x2F, ds_7);
	msdos_terminate((ss_21->*sp_6).b0002);
}

// 0800:01A5: void fn0800_01A5(Register (ptr Eq_3) ds)
void fn0800_01A5(Eq_3 * ds)
{
	msdos_set_interrupt_vector(0x00, ds->ptr0074);
	msdos_set_interrupt_vector(0x04, ds->ptr0078);
	msdos_set_interrupt_vector(0x05, ds->ptr007C);
	msdos_set_interrupt_vector(0x06, ds->ptr0080);
	return;
}

// 0800:01DA: void fn0800_01DA(Register byte al, Register word16 cx, Register word16 dx, Register (ptr Eq_12) ds)
void fn0800_01DA(byte al, word16 cx, word16 dx, Eq_12 * ds)
{
	word16 ax_8;
	msdos_write_file(0x02, cx, ds_dx, out ax_8);
	return;
}

// 0800:01FA: void main(Register (ptr Eq_120) ds)
void main(Eq_120 * ds)
{
	word16 si_18;
	word16 di_19;
	word16 bx_20 = fn0800_0E11(ds, 404, out si_18, out di_19);
	fn0800_169A(bx_20, di_19, ds, 0x01B1);
	ci16 si_33 = 0x01;
	while (si_33 <= wLoc06)
	{
		word16 si_63;
		word16 di_64;
		word16 bx_65 = fn0800_0E11(ds, 0x01B4, out si_63, out di_64);
		fn0800_169A(bx_65, di_64, ds, 0x01C3);
		fn0800_025B(wLoc04);
		word16 si_94;
		word16 di_95;
		fn0800_0E11(ds, 454, out si_94, out di_95);
		si_33 = si_94 + 0x01;
	}
	fn0800_02C7(ds, 0x00);
	return;
}

// 0800:025B: Register word16 fn0800_025B(Stack ci16 wArg02)
word16 fn0800_025B(ci16 wArg02)
{
	word16 ax_18;
	if (wArg02 > 0x02)
		ax_18 = fn0800_025B(wArg02 - 0x01) + fn0800_025B(wArg02 + ~0x01);
	else
		ax_18 = 0x01;
	return ax_18;
}

// 0800:02C7: void fn0800_02C7(Register (ptr Eq_120) ds, Stack word16 wArg02)
void fn0800_02C7(Eq_120 * ds, word16 wArg02)
{
	while (true)
	{
		ui16 ax_21 = ds->w0240;
		ds->w0240 = ds->w0240 - 0x01;
		if (ax_21 == 0x00)
			break;
		word16 sp_75;
		word16 bp_76;
		struct Eq_204 * ss_77;
		word16 ax_78;
		byte SZO_80;
		byte C_81;
		byte Z_82;
		word16 cx_84;
		word16 bx_85;
		byte SCZO_86;
		(cs->*(ds->a05EA)[ds->w0240])();
	}
	word16 sp_28;
	word16 bp_29;
	struct Eq_223 * ss_30;
	word16 ax_31;
	struct Eq_225 * ds_32;
	byte SZO_33;
	byte C_34;
	byte Z_35;
	struct Eq_229 * cs_36;
	word16 cx_37;
	word16 bx_38;
	byte SCZO_39;
	(cs->*ds->ptr0236)();
	word16 sp_40;
	word16 bp_41;
	struct Eq_238 * ss_42;
	word16 ax_43;
	struct Eq_240 * ds_44;
	byte SZO_45;
	byte C_46;
	byte Z_47;
	struct Eq_244 * cs_48;
	word16 cx_49;
	word16 bx_50;
	byte SCZO_51;
	(cs_36->*ds_32->ptr0238)();
	word16 Eq_253::* sp_52;
	word16 bp_53;
	struct Eq_253 * ss_54;
	word16 ax_55;
	struct Eq_255 * ds_56;
	byte SZO_57;
	byte C_58;
	byte Z_59;
	struct Eq_259 * cs_60;
	word16 cx_61;
	word16 bx_62;
	byte SCZO_63;
	(cs_48->*ds_44->ptr023A)();
	ss_54->*(sp_52 - 0x02) = wArg02;
	fn0800_0121();
	return;
}

// 0800:0E11: Register word16 fn0800_0E11(Register (ptr Eq_120) ds, Stack word16 wArg02, Register out ptr16 siOut, Register out ptr16 diOut)
word16 fn0800_0E11(Eq_120 * ds, word16 wArg02, ptr16 & siOut, ptr16 & diOut)
{
	word16 si_20;
	word16 di_21;
	word16 bx_22 = fn0800_1039(ds, fp + 0x04, wArg02, out si_20, out di_21);
	return bx_22;
}

// 0800:1039: Register word16 fn0800_1039(Register (ptr Eq_120) ds, Stack mp16 wArg02, Stack word16 wArg04, Register out ptr16 siOut, Register out ptr16 diOut)
word16 fn0800_1039(Eq_120 * ds, mp16 wArg02, word16 wArg04, ptr16 & siOut, ptr16 & diOut)
{
	ci8 bLoc57_111 = 0x50;
	mp16 sp_17 = fp - 0xA0;
	byte Eq_120::* di_109 = fp - 0x56;
	byte Eq_120::* si_107 = wArg04;
l0800_10A3:
	byte al_40 = ds->*si_107;
	si_107 = si_107 + 0x01;
	byte al_103 = al_40;
	ax = DPB(ax, al_40, 0);
	if (al_40 == 0x00)
	{
		if (bLoc57_111 < 0x50)
		{
			byte Eq_120::* di_95;
			fn0800_1067(fp - 0x02, di_109, out di_95);
			word16 di_97;
			bx = fn0800_1067(fp - 0x02, di_95, out di_97);
		}
		struct Eq_349 Eq_383::* sp_81 = sp_17 + 0x02;
		word16 di_85;
		*diOut = (ss->*sp_81).w0000;
		word16 si_87;
		*siOut = (ss->*sp_81).w0002;
		return bx;
	}
	if (al_40 != 0x25)
	{
l0800_10AC:
		ds->*di_109 = al_103;
		ci8 v15_110 = bLoc57_111 - 0x01;
		di_109 = di_109 + 0x01;
		bLoc57_111 = v15_110;
		if (v15_110 <= 0x00)
			bx = fn0800_1067(fp - 0x02, di_109, out di_109);
		goto l0800_10A3;
	}
	al_103 = ds->*si_107;
	ax = DPB(ax, al_103, 0);
	si_107 = si_107 + 0x01;
	if (al_103 == 0x25)
		goto l0800_10AC;
	cu8 ch_125 = 0x00;
	byte bLoc8F_130 = 0x00;
l0800_10E6:
	word16 ax_150 = DPB(ax, 0x00, 8);
	cu8 bl_154 = (byte) ax_150;
	byte dl_152 = (byte) ax_150;
	struct Eq_376 Eq_120::* bx_156 = DPB(ax_150, bl_154 - 0x20, 0);
	if (bl_154 < 0x80)
	{
		cu16 bx_196 = DPB(ax_150, (ds->*bx_156).b04FB, 0);
		cu16 ax_197 = bx_196;
		if (bx_196 > 0x17)
		{
l0800_1526:
			byte Eq_120::* si_168 = si_107;
			byte al_170 = 0x25;
			do
			{
				bx = fn0800_105F(al_170, fp - 0x02, di_109, ds, out di_109);
				byte al_181 = ds->*si_168;
				sp_17 = sp_17 + ~0x01;
				si_168 = si_168 + 0x01;
				al_170 = al_181;
			} while (al_181 != 0x00);
			break;
		}
		switch (fp - 0xA0)
		{
		case 0x00:
			if (ch_125 <= 0x00)
				goto l0800_115B;
			break;
		case 0x01:
			if (ch_125 <= 0x00)
				goto l0800_10E5;
			break;
		case 0x02:
			ax_197 = ds->*wArg02;
			wArg02 = wArg02 + 0x01;
			if (ch_125 < 0x02)
				goto l0800_11A5;
			goto l0800_11AE;
		case 0x03:
			if (ch_125 <= 0x00)
				goto l0800_10E5;
			break;
		}
	}
	goto l0800_1526;
}

// 0800:105F: Register word16 fn0800_105F(Register byte al, Register (memptr (ptr Eq_457) Eq_338) bp, Register (memptr (ptr Eq_120) byte) di, Register (ptr Eq_120) ds, Register out Eq_411 diOut)
word16 fn0800_105F(byte al, Eq_338 Eq_457::*bp, byte Eq_120::*di, Eq_120 * ds, Eq_411 & diOut)
{
	ds->*di = al;
	ci8 v9_9 = ss->*(bp - 0x55) - 0x01;
	ss->*(bp - 0x55) = v9_9;
	word16 di_6;
	*diOut = di + 0x01;
	if (v9_9 <= 0x00)
		return bx;
	else
	{
		byte Eq_120::* di_15;
		return fn0800_1067(bp, di + 0x01, out di_15);
	}
}

// 0800:1067: Register word16 fn0800_1067(Register (memptr (ptr Eq_457) Eq_338) bp, Register (memptr (ptr Eq_120) byte) di, Register out Eq_340 diOut)
word16 fn0800_1067(Eq_338 Eq_457::*bp, byte Eq_120::*di, Eq_340 & diOut)
{
	struct Eq_486 Eq_488::* sp_30;
	word16 bx_31;
	struct Eq_488 * ss_32;
	word16 cx_33;
	word16 dx_34;
	struct Eq_491 * es_35;
	union Eq_508 Eq_488::* bp_36;
	word16 ax_37;
	word16 di_38;
	byte SCZO_39;
	struct Eq_496 * cs_40;
	byte SZO_41;
	byte C_42;
	byte Z_43;
	(cs->*(ss->*bp).ptr000A)();
	if (ax_37 == 0x00)
		(ss_32->*(bp_36 - 0x02)).u1 = 0x01;
	(ss_32->*(bp_36 - 0x55)).u0 = 0x50;
	(ss_32->*(bp_36 - 88)).u1 = (word16) (ss_32->*(bp_36 - 88)).u1 + di_38;
	word16 di_52;
	*diOut = bp_36 - 0x54;
	word16 bx_59 = (ss_32->*sp_30).w0006;
	return bx_59;
}

// 0800:169A: void fn0800_169A(Register word16 bx, Register word16 di, Register (ptr Eq_120) ds, Stack word16 wArg02)
void fn0800_169A(word16 bx, word16 di, Eq_120 * ds, word16 wArg02)
{
	fn0800_16B9(bx, di, ds, 0x0344, wArg02);
	return;
}

// 0800:16B9: void fn0800_16B9(Register word16 bx, Register word16 di, Register (ptr Eq_120) ds, Stack word16 wArg06, Stack word16 wArg08)
void fn0800_16B9(word16 bx, word16 di, Eq_120 * ds, word16 wArg06, word16 wArg08)
{
	struct Eq_549 Eq_573::* bp_153 = fp - 0x02;
	mp16 sp_101 = fp - 0x32;
	byte Eq_120::* si_156 = wArg08;
l0800_16EC:
	byte al_53 = ds->*si_156;
	byte Eq_120::* si_54 = si_156 + 0x01;
	if (al_53 == 0x00)
		return;
	if (al_53 != 0x25)
	{
		union Eq_572 Eq_573::* sp_148 = sp_101 - 0x02;
		ss->*sp_148 = wArg06;
		union Eq_572 Eq_573::* sp_152;
		byte SCZO_155;
		Eq_572 di_157;
		struct Eq_580 * es_158;
		byte D_159;
		byte al_160;
		byte SZO_162;
		byte C_163;
		byte Z_164;
		Eq_572 ax_165;
		word16 cx_167;
		byte SO_168;
		byte S_169;
		byte bl_171;
		byte bh_172;
		byte CZ_173;
		(cs->*bp_153[0x02])();
		sp_101 = (char *) sp_152 + 0x02;
		Eq_572 ax_176 = ax_165;
		if (ax_165 >= 0x00)
		{
			if (di_157 < 0x00 || ds->*((word16) di_157 + 0x055C) != 0x01)
			{
				if (ax_165 == di_157)
					goto l0800_16EC;
				ss->*sp_152 = wArg06;
				ss->*(sp_152 - 0x02) = ax_165;
				word16 sp_215;
				word16 bp_216;
				struct Eq_742 * ss_217;
				byte SCZO_218;
				word16 si_219;
				word16 di_220;
				struct Eq_746 * es_221;
				byte D_222;
				byte al_223;
				struct Eq_749 * ds_224;
				byte SZO_225;
				byte C_226;
				byte Z_227;
				word16 ax_228;
				struct Eq_754 * cs_229;
				word16 cx_230;
				byte SO_231;
				byte S_232;
				word16 bx_233;
				byte bl_234;
				byte bh_235;
				byte CZ_236;
				(cs->*bp_153[0x03])();
				return;
			}
			do
			{
				ci8 bl_267 = (byte) ax_176;
				Eq_572 bx_270 = DPB(ax_176, bl_267, 0);
				if (bl_267 < 0x00 || ds->*((word16) bx_270 + 0x055C) != 0x01)
				{
					union Eq_572 Eq_573::* sp_275 = sp_101 - 0x02;
					ss->*sp_275 = wArg06;
					ss->*(sp_275 - 0x02) = bx_270;
					word16 sp_279;
					byte SCZO_282;
					word16 di_284;
					struct Eq_631 * es_285;
					byte D_286;
					byte al_287;
					byte SZO_289;
					byte C_290;
					byte Z_291;
					word16 ax_292;
					word16 cx_294;
					byte SO_295;
					byte S_296;
					byte bl_298;
					byte bh_299;
					byte CZ_300;
					(cs->*bp_153[0x03])();
					sp_101 = sp_279 + 0x04;
					goto l0800_16EC;
				}
				union Eq_572 Eq_573::* sp_314 = sp_101 - 0x02;
				ss->*sp_314 = wArg06;
				word16 sp_316;
				byte SCZO_319;
				word16 si_320;
				word16 di_321;
				struct Eq_665 * es_322;
				byte D_323;
				byte al_324;
				byte SZO_326;
				byte C_327;
				byte Z_328;
				Eq_572 ax_329;
				word16 cx_331;
				byte SO_332;
				byte S_333;
				word16 bx_334;
				byte bl_335;
				byte bh_336;
				byte CZ_337;
				(cs->*bp_153[0x02])();
				sp_101 = sp_316 + 0x02;
				ax_176 = ax_329;
			} while (ax_329 > 0x00);
		}
	}
	else
	{
		int16 ax_348 = (int16) (ds->*si_54);
		if (ax_348 < 0x00)
			goto l0800_17AC;
		if (DPB(bx, 0x00, 8) <= 0x15)
		{
			switch (ax_348)
			{
			case 0x00:
				break;
			}
			return;
		}
	}
	union Eq_572 Eq_573::* sp_104 = sp_101 - 0x02;
	ss->*sp_104 = wArg06;
	(ss->*(sp_104 - 0x02)).u0 = ~0x00;
	word16 sp_109;
	word16 bp_110;
	struct Eq_701 * ss_111;
	byte SCZO_112;
	word16 si_113;
	word16 di_114;
	struct Eq_705 * es_115;
	byte D_116;
	byte al_117;
	struct Eq_708 * ds_118;
	byte SZO_119;
	byte C_120;
	byte Z_121;
	word16 ax_122;
	struct Eq_713 * cs_123;
	word16 cx_124;
	byte SO_125;
	byte S_126;
	word16 bx_127;
	byte bl_128;
	byte bh_129;
	byte CZ_130;
	(cs->*bp_153[0x03])();
	return;
}

